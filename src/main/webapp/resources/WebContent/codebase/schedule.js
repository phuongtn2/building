/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/*!*********************!*\
  !*** ./schedule.js ***!
  \*********************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! dhtmlxvault */ 1);
	__webpack_require__(/*! dhxScheduler */ 6);
	__webpack_require__(/*! script!../../codebase/locale/locale_en.js */ 8);
	__webpack_require__(/*! script!../../codebase/ext/dhtmlxscheduler_tooltip.js */ 10);
	//require('script!../../codebase/dhtmlxscheduler.js');
	__webpack_require__(/*! script!../../codebase/ext/dhtmlxscheduler_agenda_view.js */ 12);
	__webpack_require__(/*! script!../../codebase/scheduler.api.js */ 14);
	__webpack_require__(/*! script!../../codebase/dhtmlxscheduler_minical.js */ 16);
	__webpack_require__(/*! script!../../codebase/dhtmlxscheduler_timeline.js */ 18);
	__webpack_require__(/*! script!./class/SFAClassIF.js */ 20);
	__webpack_require__(/*! gh_wins */ 22);
	__webpack_require__(/*! gh_data */ 24);
	//require('services_asset');
	var ServicesAssetsWindow = __webpack_require__(/*! ./class/window/ServicesAssetsWindow.js */ 48);
	
	function ohgHIREScheduleObject() {
	    "use strict";
	    var that = this;
	    var _CONST = _GH.S07F010Sche;
	
	    window.onerror = function (msg, file, line, column, err) {
	        return true;
	    };
	
	    var URI = {
	            SELF : "request_booking/list/self",
	            DIVEMP : "request_booking/list/divemp?",
	            ALL : "request_booking/list/dept",
	            REGIST : "request_booking/regist",
	            UPDATE : "request_booking/update"
	    };
	    var mappingArray = [];
	    var FILTER_DELIMITER = "/";
	    var miniCalendar = null;
	    var schdForm = null;
	    var dateFormat=scheduler.date.date_to_str("%Y/%m/%d %H:%i");
	
	    // ハッシュ変更のイベントリスナーの登録
	    this.locationHashChanged = function() {
	    };
	    window.onhashchange = this.locationHashChanged;
	
	    // 絞込ウィンドウのフォーム設定
	    var FILTER_WIN_FORM = null;
	
	    // インターバルID（定期実行を止めるときは clearInterval メソッドに渡すこと）
	    var intervalID;
	    // インターバル時間（ 分 * 秒 * ミリ秒）
	    var INTERVAL_TIME = 5 * 60 * 1000;
	
	    /** ----------------------------------------------------------- */
	    /** 初期化 */
	    /** ----------------------------------------------------------- */
	    /**
	     * 画面の初期化
	     */
	    this.init = function() {
	        // setting timeout for binding channels
	        // this._bindTM = window.setTimeout(function(){that._bindChannels();}, 1000);
	        // テストモードを変える
	        //if (!_ghUser.checkConnect()) {
	            //_ghWins.doGoogleLoginWin(_ohgHire);
	        //    return;
	        //}
	        // スケジュールの設定
	        var def = that.setConfig();
	        // Lightboxの設定
	        //scheduler.init('scheduler_here',new Date(),"agenda");
	        scheduler.showLightbox = function(id) {
	            that.setEvent();
	            var ev = scheduler.getEvent(id);
	            that.doScheduleWindow(ev);
	        };
	
	        // インターバル（定期実行）処理
	        def.done(function(){
	            intervalID = setInterval(that.refresh, INTERVAL_TIME);
	            //resetDhxFormItemValues(schdForm);
	        });
	
	        //var sentTokenToServer = window.localStorage.getItem('sentFCMTokenToServer');
	        //console.log('sentTokenToServer = ' + sentTokenToServer);
	        //if(!(sentTokenToServer == 1)){
	            //console.log('call sendFCMTokenToServer()');
	            sendFCMTokenToServer();
	        //}
	    };
	    /**
	     * スケジュールをロードする。
	     */
	    this.loadSchedule = function() {
	        scheduler.load(_GHAPI.SERVER + URI.SELF, "json");
	    };
	    /**
	     * 表示リセット処理
	     */
	    this.refresh = function() {
	        console.log("リセット処理！", new Date());
	        scheduler.clearAll();
	        that.loadSchedule();
	    };
	    /**
	     * 絞り込みウィンドウ用のFormテンプレートを初期化する。
	     */
	    this.initFilterWinForm = function() {
	        FILTER_WIN_FORM = null;
	        FILTER_WIN_FORM = _.cloneDeep(_CONST.FILTER_WIN_FORM);
	    };
	    /**
	     * Dhtmlx Schedulerの設定を行う。
	     */
	    this.setConfig = function() {
	        // 複数日にまたがるイベントは禁止
	        scheduler.config.multi_day = true;
	
	        scheduler.config.event_duration = _GH.FORMAT.SCHD_INTERVAL * 60;
	        scheduler.config.auto_end_date = true;
	        scheduler.config.details_on_create = true;
	        scheduler.config.details_on_dblclick = true;
	
	        // サーバから来る日付型フォーマット
	        scheduler.config.xml_date="%Y/%m/%d %H:%i";
	        // Dynamic Loding時にリクエストに付与する日付フォーマット
	        scheduler.config.load_date = "%Y/%m/%d";
	
	        // カレンダーの表示日付の設定
	        scheduler.config.scroll_hour = 9; // 朝の9時を一番上にする。
	        scheduler.config.month_date = "%Y%F"; // 年月表示
	        scheduler.config.week_date = "%D"; // 日付表示
	        scheduler.config.day_date = "%M%j"; // 年月表示のデフォルト
	        scheduler.config.default_date = "%Y %M %j"; // 年月日表示のデフォルト
	        scheduler.config.api_date="%Y/%m/%d %H:%i";
	        scheduler.config.dblclick_create = true;
	
	        //scheduler.locale.labels.agenda_tab="My Agenda";
	
	        // イベントの編集バーは詳細ウィンドウだけ必要
	        scheduler.config.icons_select = ["icon_details"];
	        // レイアウトの設定
	        var def = that.setLayout();
	        def.done(function(){
	            // ビュー変更イベントの設定
	            that.setEvent();
	            // イベントのフィルタリング設定
	           // that.setEventFilter();
	        });
	        // ツールチップの設定
	        scheduler.templates.tooltip_text = function(start, end, event) {
	            //return that.getEventText(_CONST.VIEW_MODE.DAY, event);
	            return event.text;
	        };
	        return def;
	    };
	    /**
	     * イベントの設定を行います。
	     */
	    this.setEvent = function() {
	        // ビュー変更前イベント
	        scheduler.attachEvent("onBeforeViewChange", function(old_mode, old_date, mode, date){
	            // 表示内容をリフレッシュする。
	            console.log("onBeforeViewChange", old_mode, old_date, mode, date);
	            return true;
	        });
	
	        // ビューの変更イベント。それぞれで異なる表示をするように設定する。
	        scheduler.attachEvent("onViewChange", function (new_mode , new_date){
	            console.log("onViewChange", new_mode , new_date);
	            switch(new_mode) {
	                case "day":
	                    scheduler.templates.event_text = function(start, end, event){
	                        return event.text;
	                    };
	                    break;
	                case "week": // 「週」表示
	                    scheduler.templates.event_text = function(start, end, event){
	                        return event.text;
	                    };
	                    break;
	                case "month":
	                    scheduler.templates.event_text = function(start, end, event){
	                        return event.text;
	                    };
	                    break;
	            }
	            scheduler.updateView();
	        });
	
	        // イベントロード時
	        scheduler.attachEvent("onEventLoading", function(ev){
	            // すでに同じイベントが存在するかをチェックする。
	            if (_.find(scheduler.getEvents(), function(e) { return e.t_bookServiceCode === ev.t_bookServiceCode})) {
	                // 同じイベントが存在するため、画面にセットしない。
	                scheduler.updateView();
	                return false;
	            } else {
	                // 表示テキストの設定（月表示用）
	                //ev.text = that.getEventText(_CONST.VIEW_MODE.DAY, ev);
	                // イベントのカラー設定
	                that.setEventColor(ev, mappingArray);
	                // 色ラベルを作る
	                that.showEventLabel(schdForm, mappingArray);
	                // 表示内容をリフレッシュする。
	                scheduler.updateView();
	                return true;
	            }
	        });
	
	        // ロードエラー時
	        scheduler.attachEvent("onLoadError", function(resp){
	            console.log("onLoadError", resp);
	            dhtmlx.message("Failed to load data");
	        });
	
	        // イベント変更前（ドラッグ＆ドロップ完了前）。
	        scheduler.attachEvent("onBeforeEventChanged", function(event, mouseEvent, is_new, original){
	            console.log("onBeforeEventChanged", event, mouseEvent, is_new, original);
	            event.is_new = is_new;
	            if (is_new) {
	                //TODO ６月リリースには不要。次回検討
	                // 新規イベントの場合、独自にウィンドウを呼び出す。
	//                event.scheduleTimeFrom = event.start_date;
	//                event.scheduleTimeTo = event.end_date;
	//                event.organizer = _ghUser.getGhId();
	//                event.organizerFullName = _ghUser.getName();
	                return false;
	            } else {
	                // 変更後の日時を設定する。
	                event.bookFrom = getStrDate(event.start_date, _GH.FORMAT.YMD_HMS);
	                event.bookTo = getStrDate(event.end_date, _GH.FORMAT.YMD_HMS);
	                postSyncURL(URI.UPDATE, event);
	                scheduler.updateEvent(event.id);
	                return true;
	            }
	        });
	        scheduler.attachEvent("onDblClick", function (id, e){
	            that.doScheduleWindow(e);
	        });
	
	        scheduler.attachEvent("onEmptyClick", function (date, e){
	            that.doScheduleWindow(e);
	        });
	        // イベントをドラッグする前に、操作できるかどうかチェックする。
	        //scheduler.attachEvent("onBeforeDrag", that.canOperate);
	    };
	    /**
	     * 該当イベントが操作可能かどうかを返す。
	     */
	    /*this.canOperate = function(eventId) {
	        var event = scheduler.getEvent(eventId);
	        if (!event) {
	            // イベントがなければ、別段問題なしとして、trueを返す。（操作対象がないため）
	            that.doScheduleWindow(event);
	            return true;
	        }else {
	            //dhtmlx.message("イベントを操作する権限がありません。");
	            //event.readonly = true;
	            that.doScheduleWindow(event);
	            return false;
	        }
	    };*/
	    /**
	     * イベントのフィルタリング設定を行います。
	     */
	    this.setEventFilter = function() {
	        scheduler.filter_month = scheduler.filter_day = scheduler.filter_week = function(id, event) {
	            // フォームを更新する
	            schdForm.updateValues();
	            // 絞込フォームから必要な物を取得する。
	            var fd = schdForm.getFormData();
	            if (fd.buildingCode) {
	                // 入力欄をデリミタで分割し、その中に対象となる物件が含まれているかをチェック
	                var preSelectArea = fd.buildingCode.split(FILTER_DELIMITER);
	                var targetValue = event.buildingName;
	                if (_.indexOf(preSelectArea, targetValue) == -1) {
	                    return false;
	                }
	            }
	            // ランクの絞込
	            if (fd.statusFrom != "" || fd.statusTo != "") {
	                var recruit = parseInt(event.recruitStatus);
	                var recruitFrom = (fd.statusFrom == "")? -1: parseInt(fd.statusFrom);
	                var recruitTo = (fd.statusTo == "")? -1: parseInt(fd.statusTo);
	                // from / toが逆の場合は逆にする
	                if (recruitFrom > recruitTo) {
	                    recruitTo = [recruitFrom, recruitFrom = recruitTo][0];
	                }
	                if (recruit < recruitFrom || recruitTo < recruit) {
	                    return false;
	                }
	            }
	            return true;
	        };
	    };
	    /**
	     * ミニカレンダーの設定を行います。
	     * @param {Object} baseObject ミニカレンダーを配置するタグのIDまたはオブジェクト
	     */
	    this.setMiniCalendar = function(baseObject) {
	        miniCalendar = scheduler.renderCalendar({
	            container : baseObject,
	            navigation : true,
	            handler : function(date) {
	                scheduler.setCurrentView(date, scheduler._mode);
	            }
	        });
	        scheduler.templates.calendar_month = scheduler.date.date_to_str("%Y%F"); // ミニカレンダーの年月フォーマット
	        scheduler.linkCalendar(miniCalendar); // カレンダーとミニカレンダーを連携させる。
	        scheduler.setCurrentView(scheduler._date, scheduler._mode);
	    };
	    /**
	     * レイアウトの設定を行います。
	     */
	    this.setLayout = function() {
	        console.log("スケジュール画面を初期化");
	        // レイアウトの初期化
	        if (this.dhxLayout != null) {
	            this.dhxLayout.unload();
	        }
	        this.dhxLayout = new dhtmlXLayoutObject("schedule", _GH.SCREEN_TYPE.SCHEDULE['pattern']);
	        this.dhxLayout.setOffsets({top : 8, left : 8, right : 8, bottom : 8});
	        this.dhxLayout.cells("a").setHeight(250);
	        // ダブルクリックで開いたり、閉じたりさせる。
	        this.dhxLayout.attachEvent("onDblClick", function(name){
	            if (this.cells(name).isCollapsed()) {
	                this.cells(name).expand();
	            } else {
	                this.cells(name).collapse();
	            }
	        });
	        // スケジュール操作画面（左）
	        var def = that.setFilteringArea(this.dhxLayout.cells("a"));
	        // カレンダー画面（右）
	        that.setCalendarArea(this.dhxLayout.cells("b"));
	        return def;
	    };
	    /**
	     * 左側のカレンダーと絞込エリアの設定を行います。
	     * @param {Object} layoutCell 絞込エリアを設定するレイアウトのセル。
	     */
	    this.setFilteringArea = function(layoutCell) {
	        layoutCell.setText("Filter Request Booking");
	        //layoutCell.setWidth(330);
	        schdForm = layoutCell.attachForm();
	        var def = $.Deferred();
	        schdForm.loadStruct(getTemplatePath(_GH.DATA_PATH.SCHD_FORM_JSON), "json", function() {
	            schdForm.reloadOptions("status", _prop.getOptionsWithEmpty(_GH.CODE_DEF.STATUS));
	            that.setMiniCalendar(schdForm.getContainer("miniCalendarContainer"));
	            def.resolve();
	        });
	        // ボタンクリックイベント
	        schdForm.attachEvent('onButtonClick', function(name, command){
	            switch(name) {
	                case "reset": // 絞り込みリセットボタン
	                    // 検索内容をリセットする。
	                    resetDhxFormItemValues(schdForm);
	                    scheduler.updateView();
	                    break;
	                case "filter": // 全案内・来場予約表示ボタン
	                    scheduler.clearAll();
	                    resetDhxFormItemValues(schdForm);
	                    scheduler.load(_GHAPI.SERVER + URI.ALL, "json");
	                    scheduler.updateView();
	                    break;
	                case "printPDFBtn":
	                    var filename = "Request Booking" + getStrDate(new Date()) + ".pdf";
	                    var minDate = scheduler.getState().min_date;
	                    var maxDate = scheduler.getState().max_date;
	                    maxDate.setHours(maxDate.getHours() - 1);
	                    var format = _GH.FORMAT.YMD;
	                    scheduler.exportToPDF({
	                        name: filename,
	                        format:"A4",
	                        orientation:"portrait",
	                        zoom:1,
	                        header:"<h1>Building " + getStrDate(minDate, format) + " - " + getStrDate(maxDate, format) + "</h1>",
	                        footer:"<h4>" + _ghUser.getName() + " " + getStrDate(new Date(), format) + "</h4>"
	                    });
	                    break;
	            }
	        });
	        schdForm.attachEvent('onFocus', function(name, command){
	            switch(name) {
	                //phuongtn2
	                case "buildingName":
	                    _ghWins.doBuilding(schdForm.getInput("buildingCode"), schdForm.getInput("buildingName"), schdForm)
	
	                    break;
	            }
	        });
	        schdForm.attachEvent("onChange", function (name, value){
	            scheduler.updateView();
	       });
	        return def;
	    };
	    /**
	     * 画面右のカレンダー表示エリアの設定を行います。
	     * @param {Object} layoutCell 絞込エリアを設定するレイアウトのセル。
	     */
	    this.setCalendarArea = function(layoutCell) {
	        //layoutCell.setWidth(1100);
	        layoutCell.hideHeader();
	        layoutCell.attachScheduler(new Date(), "agenda", _CONST.HTML.CAL_BTN);
	        // Dynamic Loadingの設定を行う。
	        scheduler.config.show_loading = false; // ロード時のスピナー設定
	        //scheduler.init(_CONST.HTML.CAL_BTN, new Date(),  "agenda");
	        scheduler.setLoadMode("agenda");
	        // イベントのロード
	        that.loadSchedule();
	    };
	    /**
	     * イベント表示用のテキストを取得します。
	     * @param {String} viewMode 表示するViewの種類[day, week, month]
	     * @param {Object} event Dhtmlx SchedulerのEventオブジェクト
	     */
	    this.getEventText = function (viewMode, event) {
	        var text = "";
	        switch(viewMode) {
	            case _CONST.VIEW_MODE.DAY: // 「日」表示
	            case _CONST.VIEW_MODE.WEEK: // 「週」表示
	                text = event.status + " " + event.memo;
	                break;
	            case _CONST.VIEW_MODE.MONTH: // 「月」表示
	            default:
	                text = event.status + " " + event.memo;
	                break;
	        }
	        text = text.split("null").join("");
	        text = text.split("undefined").join("");
	        return text;
	    };
	    this.setEventColor = function(event, mappingArray) {
	        that.initFilterWinForm(); // 絞り込みウィンドウの初期化
	
	        var colorDense = event.status;
	        var colorSet = _GH.S07F010Sche.EVENT_COLOR.NORMAL[colorDense];
	        if (mappingArray.indexOf(event.status) < 0) {
	            mappingArray.push(event.status);
	        }
	        event.color = colorSet.back;
	        event.textColor = colorSet.text;
	    };
	    this.showEventLabel = function(schdForm, mappingArray) {
	        var tableHtml = "<table border=1 rules='rows'><thead>";
	        tableHtml += "<tr><th>採用ステータス</th><th>色</th></tr>";
	        tableHtml += "</thead><tbody>";
	        for (var i=0; i<mappingArray.length; i++) {
	            var mapArr = mappingArray[i];
	            var colorSets = _GH.S07F010Sche.EVENT_COLOR.NORMAL[mapArr];
	            tableHtml += "<tr><td width='150px' height='20px'>" + _prop.getPropName(_GH.CODE_DEF.STATUS, mapArr) + "</td>"
	                + "<td width='100px' bgcolor='" + colorSets.back + "' style='color:" + colorSets.text + "'></td>" + "</tr>";
	        }
	        tableHtml += "</tbody></table>";
	        schdForm.getContainer("eventLabelContainer").innerHTML = tableHtml;
	    };
	    this.doBuildingWin = function(targetInput) {
	        var win = _ghWins.ghWins.createWindow("buildingWin", 30, 100, 350, 450);
	        win.setText("Select building");
	        win.button("park").hide();
	        win.button("minmax1").hide();
	        win.button("close").attachEvent("onClick", function(){
	            win.setModal(false);
	            win.close();
	        });
	        win.attachEvent("onClose", function(win){
	            scheduler.updateView();
	            return true;
	        });
	        var buildingForm = win.attachForm();
	        buildingForm.loadStruct(FILTER_WIN_FORM, "json", function() {
	            var inpVal = targetInput.value;
	            if (_.isString(inpVal) && inpVal.length > 0) {
	                var preSelectArea = inpVal.split(FILTER_DELIMITER);
	                var dataset = {};
	                _.forEach(buildingForm.getFormData(), function(value, key, object) {
	                    if (_.indexOf(preSelectArea, buildingForm.getItemValue(key)) >= 0) {
	                        dataset[key] = true;
	                    } else {
	                        dataset[key] = false;
	                    }
	                });
	                buildingForm.setFormData(dataset);
	            }
	        });
	        buildingForm.attachEvent("onButtonClick", function(name){
	            if (name == "selectBtn") {
	                var text = "";
	                _.forEach(buildingForm.getFormData(), function(value, key, object) {
	                    if (value != 0) {
	                        text += value + FILTER_DELIMITER;
	                    }
	                });
	                text = text.substring(0, text.length - 1);
	                targetInput.value = text;
	                win.setModal(false);
	                win.close();
	            } else if (name == "allCheck") {
	                var dataset = {};
	                _.forEach(buildingForm.getFormData(), function(value, key, object) {
	                    dataset[key] = true;
	                });
	                buildingForm.setFormData(dataset);
	            } else if (name == "allUncheck") {
	                var dataset = {};
	                _.forEach(buildingForm.getFormData(), function(value, key, object) {
	                    dataset[key] = false;
	                });
	                buildingForm.setFormData(dataset);
	            }
	       });
	        win.setModal(true);
	        win.show();
	    };
	    this.doScheduleWindow = function(event) {
	        if (_ghWins.ghWins.window("scheduleWin") == null) {
	            var win = _ghWins.ghWins.createWindow("scheduleWin", 20, 30, 625, 660);
	            win.setText("Request Booking");
	            win.hide();
	            win.button("park").hide();
	            win.button("minmax1").hide();
	            win.button("close").attachEvent("onClick", function(){
	                if (event.is_new) {
	                    scheduler.deleteEvent(event.id);
	                }
	                win.setModal(false);
	                win.close();
	            });
	        }
	        var win = _ghWins.ghWins.window("scheduleWin");
	        var scheduleForm = win.attachForm();
	        scheduleForm.loadStruct(getTemplatePath(_GH.DATA_PATH.SCHD_LIGHT_FORM_JSON), "json", function() {
	            scheduleForm.setFormData(event);
	            //if (!that.canOperate(event.id)) {
	            //    scheduleForm.lock();
	            //}
	        });
	        scheduleForm.attachEvent('onButtonClick', function(name, command){
	            scheduleForm.updateValues();
	            switch(name) {
	                case "saveBookBtn":
	                    event.t_bookServiceCode = scheduleForm.getItemValue("t_bookServiceCode"); // スケジュールID
	                    event.serviceCode = scheduleForm.getItemValue("serviceCode"); // スケジュールID
	                    event.assetCode = scheduleForm.getItemValue("assetCode"); // 顧客ID
	                    event.start_date = scheduleForm.getItemValue("bookFrom");
	                    event.end_date = scheduleForm.getItemValue("bookTo");
	                    event.status = scheduleForm.getCheckedValue("status");
	                    event.memo = scheduleForm.getItemValue("memo"); //
	                    var uri = (event.t_bookServiceCode)? URI.UPDATE: URI.REGIST;
	                    if (scheduleForm.validate()) {
	                        if (!isDateInRange(scheduleForm.getItemValue("bookFrom"), 7)) {
	                            if (!confirm(_MSG.S07F020.M_001)) return;
	                        }
	                        saveForm(scheduleForm, uri);
	                        scheduler.updateEvent(event.id);
	                        scheduler.updateView();
	                        if(event.status === 1) {
	                            scheduler.deleteEvent(event.id);
	                        }
	                        that.refresh();
	                        win.close();
	                    }
	                    break;
	                case "deleteBookBtn":
	                    window.open(encodeURI(_GH.PATH_TYPE.CS_MAIN + scheduleForm.getItemValue("personalId")));
	                    break;
	            }
	        });
	
	        scheduleForm.attachEvent("onInputChange", function(name, value, form){
	            switch(name) {
	                case "bookFrom": // 案内日時（開始）
	                    // 案内日時（終了）に2時間後の値を入れる。
	                    var fromTime = scheduleForm.getItemValue("bookFrom");
	                    fromTime.setHours(fromTime.getHours() + _GH.FORMAT.SCHD_INTERVAL);
	                    scheduleForm.setItemValue("bookTo", fromTime);
	                    break;
	                case "bookTo":
	                    var fromTime = scheduleForm.getItemValue("bookFrom");
	                    var toTime = scheduleForm.getItemValue("bookTo");
	                    fromTime.setFullYear(toTime.getFullYear());
	                    fromTime.setMonth(toTime.getMonth());
	                    fromTime.setDate(toTime.getDate());
	                    scheduleForm.setItemValue("bookFrom", fromTime);
	                    break;
	            };
	        });
	        scheduleForm.attachEvent("onFocus", function(name){
	            switch(name) {
	                case "services":
	                    var servicesAssets = new ServicesAssetsWindow(
	                        scheduleForm.getInput("serviceCode")
	                        ,scheduleForm.getInput("serviceName")
	                        ,scheduleForm.getInput("assetCode")
	                        ,scheduleForm.getInput("assetName")
	                        ,scheduleForm.getInput("assetPrice")
	                        , null
	                    );
	                    servicesAssets.init();
	                    break;
	            }
	        });
	        scheduleForm.attachEvent("onValidateError", function (name, value, result){
	            dhtmlx.message({
	                type:"error",
	                text: scheduleForm.getItemLabel(name) + "input error!"
	            });
	        });
	        win.setModal(true);
	        win.show();
	    };
	
	    this.initWins = function() {
	        _ghWins = null;
	        _ghWins = new CommonWindows();
	    };
	    this.initWins();
	}
	var _ohgHire;
	function init() {
	    _ohgHire = new ohgHIREScheduleObject();
	    _ohgHire._unreadTMTime = 1;
	    _ohgHire.init();
	}
	window.addEventListener("load",function(){
	    init();
	}, false);

/***/ },
/* 1 */
/*!********************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxvault.js ***!
  \********************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var dhtmlx = __webpack_require__(/*! dhtmlx */ 2);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxvault.js */ 5)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxvault.js")


/***/ },
/* 2 */
/*!***************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlx.js ***!
  \***************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlx.js */ 4)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlx.js")

/***/ },
/* 3 */
/*!**************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader/addScript.js ***!
  \**************************************************************************/
/***/ function(module, exports) {

	/*
		MIT License http://www.opensource.org/licenses/mit-license.php
		Author Tobias Koppers @sokra
	*/
	module.exports = function(src) {
		if (typeof execScript === "function")
			execScript(src);
		else
			eval.call(null, src);
	}

/***/ },
/* 4 */
/*!******************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlx.js ***!
  \******************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\nProduct Name: dhtmlxSuite \r\nVersion: 4.6 \r\nEdition: Professional \r\nLicense: content of this file is covered by DHTMLX Commercial or Enterprise license. Usage without proper license is prohibited. To obtain it contact sales@dhtmlx.com\r\nCopyright UAB Dinamenta http://www.dhtmlx.com\r\n*/\r\n\r\nif (typeof (window.dhx4) == \"undefined\") {\r\n    window.dhx4 = {\r\n        version: \"4.6\",\r\n        skin: null ,\r\n        skinDetect: function(a) {\r\n            return {\r\n                10: \"dhx_skyblue\",\r\n                20: \"dhx_web\",\r\n                30: \"dhx_terrace\"\r\n            }[this.readFromCss(a + \"_skin_detect\")] || null \r\n        },\r\n        readFromCss: function(e, g) {\r\n            var c = document.createElement(\"DIV\");\r\n            c.className = e;\r\n            if (document.body.firstChild != null ) {\r\n                document.body.insertBefore(c, document.body.firstChild)\r\n            } else {\r\n                document.body.appendChild(c)\r\n            }\r\n            var a = c[g || \"offsetWidth\"];\r\n            c.parentNode.removeChild(c);\r\n            c = null ;\r\n            return a\r\n        },\r\n        lastId: 1,\r\n        newId: function() {\r\n            return this.lastId++\r\n        },\r\n        zim: {\r\n            data: {},\r\n            step: 5,\r\n            first: function() {\r\n                return 100\r\n            },\r\n            last: function() {\r\n                var e = this.first();\r\n                for (var c in this.data) {\r\n                    e = Math.max(e, this.data[c])\r\n                }\r\n                return e\r\n            },\r\n            reserve: function(a) {\r\n                this.data[a] = this.last() + this.step;\r\n                return this.data[a]\r\n            },\r\n            clear: function(a) {\r\n                if (this.data[a] != null ) {\r\n                    this.data[a] = null ;\r\n                    delete this.data[a]\r\n                }\r\n            }\r\n        },\r\n        s2b: function(a) {\r\n            if (typeof (a) == \"string\") {\r\n                a = a.toLowerCase()\r\n            }\r\n            return ( a == true || a == 1 || a == \"true\" || a == \"1\" || a == \"yes\" || a == \"y\" || a == \"on\") \r\n        },\r\n        s2j: function(s) {\r\n            var obj = null ;\r\n            dhx4.temp = null ;\r\n            try {\r\n                eval(\"dhx4.temp=\" + s)\r\n            } catch (e) {\r\n                dhx4.temp = null \r\n            }\r\n            obj = dhx4.temp;\r\n            dhx4.temp = null ;\r\n            return obj\r\n        },\r\n        absLeft: function(a) {\r\n            if (typeof (a) == \"string\") {\r\n                a = document.getElementById(a)\r\n            }\r\n            return this.getOffset(a).left\r\n        },\r\n        absTop: function(a) {\r\n            if (typeof (a) == \"string\") {\r\n                a = document.getElementById(a)\r\n            }\r\n            return this.getOffset(a).top\r\n        },\r\n        _aOfs: function(a) {\r\n            var e = 0\r\n              , c = 0;\r\n            while (a) {\r\n                e = e + parseInt(a.offsetTop);\r\n                c = c + parseInt(a.offsetLeft);\r\n                a = a.offsetParent\r\n            }\r\n            return {\r\n                top: e,\r\n                left: c\r\n            }\r\n        },\r\n        _aOfsRect: function(g) {\r\n            var m = g.getBoundingClientRect();\r\n            var n = document.body;\r\n            var c = document.documentElement;\r\n            var a = window.pageYOffset || c.scrollTop || n.scrollTop;\r\n            var h = window.pageXOffset || c.scrollLeft || n.scrollLeft;\r\n            var l = c.clientTop || n.clientTop || 0;\r\n            var o = c.clientLeft || n.clientLeft || 0;\r\n            var r = m.top + a - l;\r\n            var e = m.left + h - o;\r\n            return {\r\n                top: Math.round(r),\r\n                left: Math.round(e)\r\n            }\r\n        },\r\n        getOffset: function(a) {\r\n            if (a.getBoundingClientRect) {\r\n                return this._aOfsRect(a)\r\n            } else {\r\n                return this._aOfs(a)\r\n            }\r\n        },\r\n        _isObj: function(a) {\r\n            return ( a != null  && typeof (a) == \"object\" && typeof (a.length) == \"undefined\") \r\n        },\r\n        _copyObj: function(g) {\r\n            if (this._isObj(g)) {\r\n                var e = {};\r\n                for (var c in g) {\r\n                    if (typeof (g[c]) == \"object\" && g[c] != null ) {\r\n                        e[c] = this._copyObj(g[c])\r\n                    } else {\r\n                        e[c] = g[c]\r\n                    }\r\n                }\r\n            } else {\r\n                var e = [];\r\n                for (var c = 0; c < g.length; c++) {\r\n                    if (typeof (g[c]) == \"object\" && g[c] != null ) {\r\n                        e[c] = this._copyObj(g[c])\r\n                    } else {\r\n                        e[c] = g[c]\r\n                    }\r\n                }\r\n            }\r\n            return e\r\n        },\r\n        screenDim: function() {\r\n            var a = (navigator.userAgent.indexOf(\"MSIE\") >= 0);\r\n            var c = {};\r\n            c.left = document.body.scrollLeft;\r\n            c.right = c.left + (window.innerWidth || document.body.clientWidth);\r\n            c.top = Math.max((a ? document.documentElement : document.getElementsByTagName(\"html\")[0]).scrollTop, document.body.scrollTop);\r\n            c.bottom = c.top + (a ? Math.max(document.documentElement.clientHeight || 0, document.documentElement.offsetHeight || 0) : window.innerHeight);\r\n            return c\r\n        },\r\n        selectTextRange: function(h, m, c) {\r\n            h = (typeof (h) == \"string\" ? document.getElementById(h) : h);\r\n            var a = h.value.length;\r\n            m = Math.max(Math.min(m, a), 0);\r\n            c = Math.min(c, a);\r\n            if (h.setSelectionRange) {\r\n                try {\r\n                    h.setSelectionRange(m, c)\r\n                } catch (l) {}\r\n            } else {\r\n                if (h.createTextRange) {\r\n                    var g = h.createTextRange();\r\n                    g.moveStart(\"character\", m);\r\n                    g.moveEnd(\"character\", c - a);\r\n                    try {\r\n                        g.select()\r\n                    } catch (l) {}\r\n                }\r\n            }\r\n        },\r\n        transData: null ,\r\n        transDetect: function() {\r\n            if (this.transData == null ) {\r\n                this.transData = {\r\n                    transProp: false,\r\n                    transEv: null \r\n                };\r\n                var e = {\r\n                    MozTransition: \"transitionend\",\r\n                    WebkitTransition: \"webkitTransitionEnd\",\r\n                    OTransition: \"oTransitionEnd\",\r\n                    msTransition: \"transitionend\",\r\n                    transition: \"transitionend\"\r\n                };\r\n                for (var c in e) {\r\n                    if (this.transData.transProp == false && document.documentElement.style[c] != null ) {\r\n                        this.transData.transProp = c;\r\n                        this.transData.transEv = e[c]\r\n                    }\r\n                }\r\n                e = null \r\n            }\r\n            return this.transData\r\n        },\r\n        _xmlNodeValue: function(a) {\r\n            var e = \"\";\r\n            for (var c = 0; c < a.childNodes.length; c++) {\r\n                e += (a.childNodes[c].nodeValue != null  ? a.childNodes[c].nodeValue.toString().replace(/^[\\n\\r\\s]{0,}/, \"\").replace(/[\\n\\r\\s]{0,}$/, \"\") : \"\")\r\n            }\r\n            return e\r\n        }\r\n    };\r\n    window.dhx4.isIE = (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0);\r\n    window.dhx4.isIE6 = (window.XMLHttpRequest == null  && navigator.userAgent.indexOf(\"MSIE\") >= 0);\r\n    window.dhx4.isIE7 = (navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") < 0);\r\n    window.dhx4.isIE8 = (navigator.userAgent.indexOf(\"MSIE 8.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0);\r\n    window.dhx4.isIE9 = (navigator.userAgent.indexOf(\"MSIE 9.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0);\r\n    window.dhx4.isIE10 = (navigator.userAgent.indexOf(\"MSIE 10.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0 && window.navigator.pointerEnabled != true);\r\n    window.dhx4.isIE11 = (navigator.userAgent.indexOf(\"Trident\") >= 0 && window.navigator.pointerEnabled == true);\r\n    window.dhx4.isEdge = (navigator.userAgent.indexOf(\"Edge\") >= 0);\r\n    window.dhx4.isOpera = (navigator.userAgent.indexOf(\"Opera\") >= 0);\r\n    window.dhx4.isChrome = (navigator.userAgent.indexOf(\"Chrome\") >= 0) && !window.dhx4.isEdge;\r\n    window.dhx4.isKHTML = (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0) && !window.dhx4.isEdge;\r\n    window.dhx4.isFF = (navigator.userAgent.indexOf(\"Firefox\") >= 0);\r\n    window.dhx4.isIPad = (navigator.userAgent.search(/iPad/gi) >= 0);\r\n    window.dhx4.dnd = {\r\n        evs: {},\r\n        p_en: ((window.dhx4.isIE || window.dhx4.isEdge) && (window.navigator.pointerEnabled || window.navigator.msPointerEnabled)),\r\n        _mTouch: function(a) {\r\n            return ( window.dhx4.isIE10 && a.pointerType == a.MSPOINTER_TYPE_MOUSE || window.dhx4.isIE11 && a.pointerType == \"mouse\" || window.dhx4.isEdge && a.pointerType == \"mouse\") \r\n        },\r\n        _touchOn: function(a) {\r\n            if (a == null ) {\r\n                a = document.body\r\n            }\r\n            a.style.touchAction = a.style.msTouchAction = \"\";\r\n            a = null \r\n        },\r\n        _touchOff: function(a) {\r\n            if (a == null ) {\r\n                a = document.body\r\n            }\r\n            a.style.touchAction = a.style.msTouchAction = \"none\";\r\n            a = null \r\n        }\r\n    };\r\n    if (window.navigator.pointerEnabled == true) {\r\n        window.dhx4.dnd.evs = {\r\n            start: \"pointerdown\",\r\n            move: \"pointermove\",\r\n            end: \"pointerup\"\r\n        }\r\n    } else {\r\n        if (window.navigator.msPointerEnabled == true) {\r\n            window.dhx4.dnd.evs = {\r\n                start: \"MSPointerDown\",\r\n                move: \"MSPointerMove\",\r\n                end: \"MSPointerUp\"\r\n            }\r\n        } else {\r\n            if (typeof (window.addEventListener) != \"undefined\") {\r\n                window.dhx4.dnd.evs = {\r\n                    start: \"touchstart\",\r\n                    move: \"touchmove\",\r\n                    end: \"touchend\"\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nif (typeof (window.dhx4.template) == \"undefined\") {\r\n    window.dhx4.trim = function(a) {\r\n        return String(a).replace(/^\\s{1,}/, \"\").replace(/\\s{1,}$/, \"\")\r\n    }\r\n    ;\r\n    window.dhx4.template = function(c, e, a) {\r\n        return c.replace(/#([a-z0-9_-]{1,})(\\|([^#]*))?#/gi, function() {\r\n            var m = arguments[1];\r\n            var l = window.dhx4.trim(arguments[3]);\r\n            var n = null ;\r\n            var h = [e[m]];\r\n            if (l.length > 0) {\r\n                l = l.split(\":\");\r\n                var g = [];\r\n                for (var o = 0; o < l.length; o++) {\r\n                    if (o > 0 && g[g.length - 1].match(/\\\\$/) != null ) {\r\n                        g[g.length - 1] = g[g.length - 1].replace(/\\\\$/, \"\") + \":\" + l[o]\r\n                    } else {\r\n                        g.push(l[o])\r\n                    }\r\n                }\r\n                n = g[0];\r\n                for (var o = 1; o < g.length; o++) {\r\n                    h.push(g[o])\r\n                }\r\n            }\r\n            if (typeof (n) == \"string\" && typeof (window.dhx4.template[n]) == \"function\") {\r\n                return window.dhx4.template[n].apply(window.dhx4.template, h)\r\n            }\r\n            if (m.length > 0 && typeof (e[m]) != \"undefined\") {\r\n                if (a == true) {\r\n                    return window.dhx4.trim(e[m])\r\n                }\r\n                return String(e[m])\r\n            }\r\n            return \"\"\r\n        })\r\n    }\r\n    ;\r\n    window.dhx4.template.date = function(a, c) {\r\n        if (a != null ) {\r\n            if (a instanceof Date) {\r\n                return window.dhx4.date2str(a, c)\r\n            } else {\r\n                a = a.toString();\r\n                if (a.match(/^\\d*$/) != null ) {\r\n                    return window.dhx4.date2str(new Date(parseInt(a)), c)\r\n                }\r\n                return a\r\n            }\r\n        }\r\n        return \"\"\r\n    }\r\n    ;\r\n    window.dhx4.template.maxlength = function(c, a) {\r\n        return String(c).substr(0, a)\r\n    }\r\n    ;\r\n    window.dhx4.template.number_format = function(g, h, e, a) {\r\n        var c = window.dhx4.template._parseFmt(h, e, a);\r\n        if (c == false) {\r\n            return g\r\n        }\r\n        return window.dhx4.template._getFmtValue(g, c)\r\n    }\r\n    ;\r\n    window.dhx4.template.lowercase = function(a) {\r\n        if (typeof (a) == \"undefined\" || a == null ) {\r\n            a = \"\"\r\n        }\r\n        return String(a).toLowerCase()\r\n    }\r\n    ;\r\n    window.dhx4.template.uppercase = function(a) {\r\n        if (typeof (a) == \"undefined\" || a == null ) {\r\n            a = \"\"\r\n        }\r\n        return String(a).toUpperCase()\r\n    }\r\n    ;\r\n    window.dhx4.template._parseFmt = function(m, e, a) {\r\n        var g = m.match(/^([^\\.\\,0-9]*)([0\\.\\,]*)([^\\.\\,0-9]*)/);\r\n        if (g == null  || g.length != 4) {\r\n            return false\r\n        }\r\n        var c = {\r\n            i_len: false,\r\n            i_sep: (typeof (e) == \"string\" ? e : \",\"),\r\n            d_len: false,\r\n            d_sep: (typeof (a) == \"string\" ? a : \".\"),\r\n            s_bef: (typeof (g[1]) == \"string\" ? g[1] : \"\"),\r\n            s_aft: (typeof (g[3]) == \"string\" ? g[3] : \"\")\r\n        };\r\n        var l = g[2].split(\".\");\r\n        if (l[1] != null ) {\r\n            c.d_len = l[1].length\r\n        }\r\n        var h = l[0].split(\",\");\r\n        if (h.length > 1) {\r\n            c.i_len = h[h.length - 1].length\r\n        }\r\n        return c\r\n    }\r\n    ;\r\n    window.dhx4.template._getFmtValue = function(value, fmt) {\r\n        var r = String(value).match(/^(-)?([0-9]{1,})(\\.([0-9]{1,}))?$/);\r\n        if (r != null  && r.length == 5) {\r\n            var v0 = \"\";\r\n            if (r[1] != null ) {\r\n                v0 += r[1]\r\n            }\r\n            v0 += fmt.s_bef;\r\n            if (fmt.i_len !== false) {\r\n                var i = 0;\r\n                var v1 = \"\";\r\n                for (var q = r[2].length - 1; q >= 0; q--) {\r\n                    v1 = \"\" + r[2].charAt(q) + v1;\r\n                    if (++i == fmt.i_len && q > 0) {\r\n                        v1 = fmt.i_sep + v1;\r\n                        i = 0\r\n                    }\r\n                }\r\n                v0 += v1\r\n            } else {\r\n                v0 += r[2]\r\n            }\r\n            if (fmt.d_len !== false) {\r\n                if (r[4] == null ) {\r\n                    r[4] = \"\"\r\n                }\r\n                while (r[4].length < fmt.d_len) {\r\n                    r[4] += \"0\"\r\n                }\r\n                eval(\"dhx4.temp = new RegExp(/\\\\d{\" + fmt.d_len + \"}/);\");\r\n                var t1 = (r[4]).match(dhx4.temp);\r\n                if (t1 != null ) {\r\n                    v0 += fmt.d_sep + t1\r\n                }\r\n                dhx4.temp = t1 = null \r\n            }\r\n            v0 += fmt.s_aft;\r\n            return v0\r\n        }\r\n        return value\r\n    }\r\n}\r\nif (typeof (window.dhx4.dateLang) == \"undefined\") {\r\n    window.dhx4.dateLang = \"en\";\r\n    window.dhx4.dateStrings = {\r\n        en: {\r\n            monthFullName: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n            monthShortName: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n            dayFullName: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n            dayShortName: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"]\r\n        }\r\n    };\r\n    window.dhx4.dateFormat = {\r\n        en: \"%Y-%m-%d\"\r\n    };\r\n    window.dhx4.date2str = function(l, g, a) {\r\n        if (g == null  || typeof (g) == \"undefined\") {\r\n            g = window.dhx4.dateFormat[window.dhx4.dateLang]\r\n        }\r\n        if (a == null  || typeof (a) == \"undefined\") {\r\n            a = window.dhx4.dateStrings[window.dhx4.dateLang]\r\n        }\r\n        if (l instanceof Date) {\r\n            var h = function(m) {\r\n                return ( String(m).length == 1 ? \"0\" + String(m) : m) \r\n            }\r\n            ;\r\n            var c = function(o) {\r\n                switch (o) {\r\n                case \"%d\":\r\n                    return h(l.getDate());\r\n                case \"%j\":\r\n                    return l.getDate();\r\n                case \"%D\":\r\n                    return a.dayShortName[l.getDay()];\r\n                case \"%l\":\r\n                    return a.dayFullName[l.getDay()];\r\n                case \"%m\":\r\n                    return h(l.getMonth() + 1);\r\n                case \"%n\":\r\n                    return l.getMonth() + 1;\r\n                case \"%M\":\r\n                    return a.monthShortName[l.getMonth()];\r\n                case \"%F\":\r\n                    return a.monthFullName[l.getMonth()];\r\n                case \"%y\":\r\n                    return h(l.getYear() % 100);\r\n                case \"%Y\":\r\n                    return l.getFullYear();\r\n                case \"%g\":\r\n                    return (l.getHours() + 11) % 12 + 1;\r\n                case \"%h\":\r\n                    return h((l.getHours() + 11) % 12 + 1);\r\n                case \"%G\":\r\n                    return l.getHours();\r\n                case \"%H\":\r\n                    return h(l.getHours());\r\n                case \"%i\":\r\n                    return h(l.getMinutes());\r\n                case \"%s\":\r\n                    return h(l.getSeconds());\r\n                case \"%a\":\r\n                    return ( l.getHours() > 11 ? \"pm\" : \"am\") ;\r\n                case \"%A\":\r\n                    return ( l.getHours() > 11 ? \"PM\" : \"AM\") ;\r\n                case \"%%\":\r\n                    return \"%\";\r\n                case \"%u\":\r\n                    return l.getMilliseconds();\r\n                case \"%P\":\r\n                    if (window.dhx4.temp_calendar != null  && window.dhx4.temp_calendar.tz != null ) {\r\n                        return window.dhx4.temp_calendar.tz\r\n                    }\r\n                    var s = l.getTimezoneOffset();\r\n                    var r = Math.abs(Math.floor(s / 60));\r\n                    var n = Math.abs(s) - r * 60;\r\n                    return (s > 0 ? \"-\" : \"+\") + h(r) + \":\" + h(n);\r\n                default:\r\n                    return o\r\n                }\r\n            }\r\n            ;\r\n            var e = String(g || window.dhx4.dateFormat).replace(/%[a-zA-Z]/g, c)\r\n        }\r\n        return ( e || String(l)) \r\n    }\r\n    ;\r\n    window.dhx4.str2date = function(l, A, E) {\r\n        if (A == null  || typeof (A) == \"undefined\") {\r\n            A = window.dhx4.dateFormat[window.dhx4.dateLang]\r\n        }\r\n        if (E == null  || typeof (E) == \"undefined\") {\r\n            E = window.dhx4.dateStrings[window.dhx4.dateLang]\r\n        }\r\n        A = A.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\\\:|]/g, \"\\\\$&\");\r\n        var D = [];\r\n        var o = [];\r\n        A = A.replace(/%[a-z]/gi, function(e) {\r\n            switch (e) {\r\n            case \"%d\":\r\n            case \"%m\":\r\n            case \"%y\":\r\n            case \"%h\":\r\n            case \"%H\":\r\n            case \"%i\":\r\n            case \"%s\":\r\n                o.push(e);\r\n                return \"(\\\\d{2})\";\r\n            case \"%D\":\r\n            case \"%l\":\r\n            case \"%M\":\r\n            case \"%F\":\r\n                o.push(e);\r\n                return \"([a-zéûä\\u0430-\\u044F\\u0451]{1,})\";\r\n            case \"%j\":\r\n            case \"%n\":\r\n            case \"%g\":\r\n            case \"%G\":\r\n                o.push(e);\r\n                return \"(\\\\d{1,2})\";\r\n            case \"%Y\":\r\n                o.push(e);\r\n                return \"(\\\\d{4})\";\r\n            case \"%a\":\r\n                o.push(e);\r\n                return \"([a|p]m)\";\r\n            case \"%A\":\r\n                o.push(e);\r\n                return \"([A|P]M)\";\r\n            case \"%u\":\r\n                o.push(e);\r\n                return \"(\\\\d{1,6})\";\r\n            case \"%P\":\r\n                o.push(e);\r\n                return \"([+-]\\\\d{1,2}:\\\\d{1,2})\"\r\n            }\r\n            return e\r\n        });\r\n        var F = new RegExp(A,\"i\");\r\n        var s = l.match(F);\r\n        if (s == null  || s.length - 1 != o.length) {\r\n            return \"Invalid Date\"\r\n        }\r\n        for (var c = 1; c < s.length; c++) {\r\n            D.push(s[c])\r\n        }\r\n        var g = {\r\n            \"%y\": 1,\r\n            \"%Y\": 1,\r\n            \"%n\": 2,\r\n            \"%m\": 2,\r\n            \"%M\": 2,\r\n            \"%F\": 2,\r\n            \"%d\": 3,\r\n            \"%j\": 3,\r\n            \"%a\": 4,\r\n            \"%A\": 4,\r\n            \"%H\": 5,\r\n            \"%G\": 5,\r\n            \"%h\": 5,\r\n            \"%g\": 5,\r\n            \"%i\": 6,\r\n            \"%s\": 7,\r\n            \"%u\": 7,\r\n            \"%P\": 7\r\n        };\r\n        var u = {};\r\n        var n = {};\r\n        for (var c = 0; c < o.length; c++) {\r\n            if (typeof (g[o[c]]) != \"undefined\") {\r\n                var h = g[o[c]];\r\n                if (!u[h]) {\r\n                    u[h] = [];\r\n                    n[h] = []\r\n                }\r\n                u[h].push(D[c]);\r\n                n[h].push(o[c])\r\n            }\r\n        }\r\n        D = [];\r\n        o = [];\r\n        for (var c = 1; c <= 7; c++) {\r\n            if (u[c] != null ) {\r\n                for (var y = 0; y < u[c].length; y++) {\r\n                    D.push(u[c][y]);\r\n                    o.push(n[c][y])\r\n                }\r\n            }\r\n        }\r\n        var a = new Date();\r\n        a.setDate(1);\r\n        a.setHours(0);\r\n        a.setMinutes(0);\r\n        a.setSeconds(0);\r\n        a.setMilliseconds(0);\r\n        var x = function(v, e) {\r\n            for (var r = 0; r < e.length; r++) {\r\n                if (e[r].toLowerCase() == v) {\r\n                    return r\r\n                }\r\n            }\r\n            return -1\r\n        }\r\n        ;\r\n        for (var c = 0; c < D.length; c++) {\r\n            switch (o[c]) {\r\n            case \"%d\":\r\n            case \"%j\":\r\n            case \"%n\":\r\n            case \"%m\":\r\n            case \"%Y\":\r\n            case \"%H\":\r\n            case \"%G\":\r\n            case \"%i\":\r\n            case \"%s\":\r\n            case \"%u\":\r\n                if (!isNaN(D[c])) {\r\n                    a[{\r\n                        \"%d\": \"setDate\",\r\n                        \"%j\": \"setDate\",\r\n                        \"%n\": \"setMonth\",\r\n                        \"%m\": \"setMonth\",\r\n                        \"%Y\": \"setFullYear\",\r\n                        \"%H\": \"setHours\",\r\n                        \"%G\": \"setHours\",\r\n                        \"%i\": \"setMinutes\",\r\n                        \"%s\": \"setSeconds\",\r\n                        \"%u\": \"setMilliseconds\"\r\n                    }[o[c]]](Number(D[c]) + (o[c] == \"%m\" || o[c] == \"%n\" ? -1 : 0))\r\n                }\r\n                break;\r\n            case \"%M\":\r\n            case \"%F\":\r\n                var m = x(D[c].toLowerCase(), E[{\r\n                    \"%M\": \"monthShortName\",\r\n                    \"%F\": \"monthFullName\"\r\n                }[o[c]]]);\r\n                if (m >= 0) {\r\n                    a.setMonth(m)\r\n                }\r\n                break;\r\n            case \"%y\":\r\n                if (!isNaN(D[c])) {\r\n                    var C = Number(D[c]);\r\n                    a.setFullYear(C + (C > 50 ? 1900 : 2000))\r\n                }\r\n                break;\r\n            case \"%g\":\r\n            case \"%h\":\r\n                if (!isNaN(D[c])) {\r\n                    var C = Number(D[c]);\r\n                    if (C <= 12 && C >= 0) {\r\n                        a.setHours(C + (x(\"pm\", D) >= 0 ? (C == 12 ? 0 : 12) : (C == 12 ? -12 : 0)))\r\n                    }\r\n                }\r\n                break;\r\n            case \"%P\":\r\n                if (window.dhx4.temp_calendar != null ) {\r\n                    window.dhx4.temp_calendar.tz = D[c]\r\n                }\r\n                break\r\n            }\r\n        }\r\n        return a\r\n    }\r\n}\r\nif (typeof (window.dhx4.ajax) == \"undefined\") {\r\n    window.dhx4.ajax = {\r\n        cache: false,\r\n        method: \"get\",\r\n        parse: function(a) {\r\n            if (typeof a !== \"string\") {\r\n                return a\r\n            }\r\n            a = a.replace(/^[\\s]+/, \"\");\r\n            if (window.DOMParser && !dhx4.isIE) {\r\n                var c = (new window.DOMParser()).parseFromString(a, \"text/xml\")\r\n            } else {\r\n                if (window.ActiveXObject !== window.undefined) {\r\n                    var c = new window.ActiveXObject(\"Microsoft.XMLDOM\");\r\n                    c.async = \"false\";\r\n                    c.loadXML(a)\r\n                }\r\n            }\r\n            return c\r\n        },\r\n        xmltop: function(a, h, g) {\r\n            if (typeof h.status == \"undefined\" || h.status < 400) {\r\n                xml = (!h.responseXML) ? dhx4.ajax.parse(h.responseText || h) : (h.responseXML || h);\r\n                if (xml && xml.documentElement !== null ) {\r\n                    try {\r\n                        if (!xml.getElementsByTagName(\"parsererror\").length) {\r\n                            return xml.getElementsByTagName(a)[0]\r\n                        }\r\n                    } catch (c) {}\r\n                }\r\n            }\r\n            if (g !== -1) {\r\n                dhx4.callEvent(\"onLoadXMLError\", [\"Incorrect XML\", arguments[1], g])\r\n            }\r\n            return document.createElement(\"DIV\")\r\n        },\r\n        xpath: function(g, a) {\r\n            if (!a.nodeName) {\r\n                a = a.responseXML || a\r\n            }\r\n            if (dhx4.isIE) {\r\n                try {\r\n                    return a.selectNodes(g) || []\r\n                } catch (l) {\r\n                    return []\r\n                }\r\n            } else {\r\n                var h = [];\r\n                var m;\r\n                var c = (a.ownerDocument || a).evaluate(g, a, null , XPathResult.ANY_TYPE, null );\r\n                while (m = c.iterateNext()) {\r\n                    h.push(m)\r\n                }\r\n                return h\r\n            }\r\n        },\r\n        query: function(a) {\r\n            dhx4.ajax._call((a.method || \"GET\"), a.url, a.data || \"\", (a.async || true), a.callback, null , a.headers)\r\n        },\r\n        get: function(a, c) {\r\n            return this._call(\"GET\", a, null , true, c)\r\n        },\r\n        getSync: function(a) {\r\n            return this._call(\"GET\", a, null , false)\r\n        },\r\n        put: function(c, a, e) {\r\n            return this._call(\"PUT\", c, a, true, e)\r\n        },\r\n        del: function(c, a, e) {\r\n            return this._call(\"DELETE\", c, a, true, e)\r\n        },\r\n        post: function(c, a, e) {\r\n            if (arguments.length == 1) {\r\n                a = \"\"\r\n            } else {\r\n                if (arguments.length == 2 && (typeof (a) == \"function\" || typeof (window[a]) == \"function\")) {\r\n                    e = a;\r\n                    a = \"\"\r\n                } else {\r\n                    a = String(a)\r\n                }\r\n            }\r\n            return this._call(\"POST\", c, a, true, e)\r\n        },\r\n        postSync: function(c, a) {\r\n            a = (a == null  ? \"\" : String(a));\r\n            return this._call(\"POST\", c, a, false)\r\n        },\r\n        getLong: function(a, c) {\r\n            this._call(\"GET\", a, null , true, c, {\r\n                url: a\r\n            })\r\n        },\r\n        postLong: function(c, a, e) {\r\n            if (arguments.length == 2 && (typeof (a) == \"function\" || typeof (window[a]))) {\r\n                e = a;\r\n                a = \"\"\r\n            }\r\n            this._call(\"POST\", c, a, true, e, {\r\n                url: c,\r\n                postData: a\r\n            })\r\n        },\r\n        _call: function(a, c, e, h, m, r, g) {\r\n            var o = (window.XMLHttpRequest && !dhx4.isIE ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\"));\r\n            var l = (navigator.userAgent.match(/AppleWebKit/) != null  && navigator.userAgent.match(/Qt/) != null  && navigator.userAgent.match(/Safari/) != null );\r\n            if (h == true) {\r\n                o.onreadystatechange = function() {\r\n                    if ((o.readyState == 4) || (l == true && o.readyState == 3)) {\r\n                        if (o.status == 200 || o.status == 204) {} else {\r\n                            if (o.status >= 300 || o.responseText == \"\") {\r\n                                if (!dhx4.callEvent(\"onAjaxError\", [{\r\n                                    xmlDoc: o,\r\n                                    filePath: c,\r\n                                    async: h\r\n                                }])) {\r\n                                    return\r\n                                }\r\n                            }\r\n                        }\r\n                        window.setTimeout(function() {\r\n                            if (typeof (m) == \"function\") {\r\n                                m.apply(window, [{\r\n                                    xmlDoc: o,\r\n                                    filePath: c,\r\n                                    async: h\r\n                                }])\r\n                            }\r\n                            if (r != null ) {\r\n                                if (typeof (r.postData) != \"undefined\") {\r\n                                    dhx4.ajax.postLong(r.url, r.postData, m)\r\n                                } else {\r\n                                    dhx4.ajax.getLong(r.url, m)\r\n                                }\r\n                            }\r\n                            m = null ;\r\n                            o = null \r\n                        }, 1)\r\n                    }\r\n                }\r\n            }\r\n            if (a == \"GET\") {\r\n                c += this._dhxr(c)\r\n            }\r\n            o.open(a, c, h);\r\n            if (g != null ) {\r\n                for (var n in g) {\r\n                    o.setRequestHeader(n, g[n])\r\n                }\r\n            } else {\r\n                if (a == \"POST\" || a == \"PUT\" || a == \"DELETE\") {\r\n                    o.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\")\r\n                } else {\r\n                    if (a == \"GET\") {\r\n                        e = null \r\n                    }\r\n                }\r\n            }\r\n            o.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n            if (_ghUser) {\r\n                o.setRequestHeader(\"AUTHORIZED_TOKEN\", _ghUser.getAuthToken());\r\n                o.setRequestHeader(\"LOGIN_TYPE\", _ghUser.getLoginType())\r\n            }\r\n            o.send(e);\r\n            if (h != true) {\r\n                if ((o.readyState == 4) || (l == true && o.readyState == 3)) {\r\n                    if (o.status == 200 || o.status == 204) {} else {\r\n                        if (o.status != 200 || o.responseText == \"\") {\r\n                            dhx4.callEvent(\"onAjaxError\", [{\r\n                                xmlDoc: o,\r\n                                filePath: c,\r\n                                async: h\r\n                            }])\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return {\r\n                xmlDoc: o,\r\n                filePath: c,\r\n                async: h\r\n            }\r\n        },\r\n        _dhxr: function(a, c) {\r\n            if (this.cache != true) {\r\n                if (a.match(/^[\\?\\&]$/) == null ) {\r\n                    a = (a.indexOf(\"?\") >= 0 ? \"&\" : \"?\")\r\n                }\r\n                if (typeof (c) == \"undefined\") {\r\n                    c = true\r\n                }\r\n                return a + \"dhxr\" + new Date().getTime() + (c == true ? \"=1\" : \"\")\r\n            }\r\n            return \"\"\r\n        }\r\n    }\r\n}\r\nif (typeof (window.dhx4._enableDataLoading) == \"undefined\") {\r\n    window.dhx4._enableDataLoading = function(m, e, l, h, n) {\r\n        if (n == \"clear\") {\r\n            for (var c in m._dhxdataload) {\r\n                m._dhxdataload[c] = null ;\r\n                delete m._dhxdataload[c]\r\n            }\r\n            m._loadData = null ;\r\n            m._dhxdataload = null ;\r\n            m.load = null ;\r\n            m.loadStruct = null ;\r\n            m = null ;\r\n            return\r\n        }\r\n        m._dhxdataload = {\r\n            initObj: e,\r\n            xmlToJson: l,\r\n            xmlRootTag: h,\r\n            onBeforeXLS: null \r\n        };\r\n        m._loadData = function(v, w, x) {\r\n            if (arguments.length == 2) {\r\n                x = w;\r\n                w = null \r\n            }\r\n            var u = null ;\r\n            if (arguments.length == 3) {\r\n                x = arguments[2]\r\n            }\r\n            if (typeof (v) == \"string\") {\r\n                var s = v.replace(/^\\s{1,}/, \"\").replace(/\\s{1,}$/, \"\");\r\n                var C = new RegExp(\"^<\" + this._dhxdataload.xmlRootTag);\r\n                if (C.test(s.replace(/^<\\?xml[^\\?]*\\?>\\s*/, \"\"))) {\r\n                    u = dhx4.ajax.parse(v);\r\n                    if (u != null ) {\r\n                        u = this[this._dhxdataload.xmlToJson].apply(this, [u])\r\n                    }\r\n                }\r\n                if (u == null  && (s.match(/^[\\s\\S]*{[.\\s\\S]*}[\\s\\S]*$/) != null  || s.match(/^[\\s\\S]*\\[[.\\s\\S]*\\][\\s\\S]*$/) != null )) {\r\n                    u = dhx4.s2j(s)\r\n                }\r\n                if (u == null ) {\r\n                    this.callEvent(\"onXLS\", []);\r\n                    var r = [];\r\n                    if (typeof (this._dhxdataload.onBeforeXLS) == \"function\") {\r\n                        var s = this._dhxdataload.onBeforeXLS.apply(this, [v]);\r\n                        if (s != null  && typeof (s) == \"object\") {\r\n                            if (s.url != null ) {\r\n                                v = s.url\r\n                            }\r\n                            if (s.params != null ) {\r\n                                for (var y in s.params) {\r\n                                    r.push(y + \"=\" + encodeURIComponent(s.params[y]))\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    var A = this;\r\n                    var o = function(a) {\r\n                        var D = null ;\r\n                        if ((a.xmlDoc.getResponseHeader(\"Content-Type\") || \"\").search(/xml/gi) >= 0 || (a.xmlDoc.responseText.replace(/^\\s{1,}/, \"\")).match(/^</) != null ) {\r\n                            D = A[A._dhxdataload.xmlToJson].apply(A, [a.xmlDoc.responseXML])\r\n                        } else {\r\n                            D = dhx4.s2j(a.xmlDoc.responseText)\r\n                        }\r\n                        if (D != null ) {\r\n                            A[A._dhxdataload.initObj].apply(A, [D, v])\r\n                        }\r\n                        A.callEvent(\"onXLE\", []);\r\n                        if (x != null ) {\r\n                            if (typeof (x) == \"function\") {\r\n                                x.apply(A, [])\r\n                            } else {\r\n                                if (typeof (window[x]) == \"function\") {\r\n                                    window[x].apply(A, [])\r\n                                }\r\n                            }\r\n                        }\r\n                        o = x = null ;\r\n                        D = a = A = null \r\n                    }\r\n                    ;\r\n                    r = r.join(\"&\") + (typeof (w) == \"string\" ? \"&\" + w : \"\");\r\n                    if (dhx4.ajax.method == \"post\") {\r\n                        dhx4.ajax.post(v, r, o)\r\n                    } else {\r\n                        if (dhx4.ajax.method == \"get\") {\r\n                            dhx4.ajax.get(v + (r.length > 0 ? (v.indexOf(\"?\") > 0 ? \"&\" : \"?\") + r : \"\"), o)\r\n                        }\r\n                    }\r\n                    return\r\n                }\r\n            } else {\r\n                if (typeof (v.documentElement) == \"object\" || (typeof (v.tagName) != \"undefined\" && typeof (v.getElementsByTagName) != \"undefined\" && v.getElementsByTagName(this._dhxdataload.xmlRootTag).length > 0)) {\r\n                    u = this[this._dhxdataload.xmlToJson].apply(this, [v])\r\n                } else {\r\n                    u = window.dhx4._copyObj(v)\r\n                }\r\n            }\r\n            if (u != null ) {\r\n                this[this._dhxdataload.initObj].apply(this, [u])\r\n            }\r\n            if (x != null ) {\r\n                if (typeof (x) == \"function\") {\r\n                    x.apply(this, [])\r\n                } else {\r\n                    if (typeof (window[x]) == \"function\") {\r\n                        window[x].apply(this, [])\r\n                    }\r\n                }\r\n                x = null \r\n            }\r\n        }\r\n        ;\r\n        if (n != null ) {\r\n            var g = {\r\n                struct: \"loadStruct\",\r\n                data: \"load\"\r\n            };\r\n            for (var c in n) {\r\n                if (n[c] == true) {\r\n                    m[g[c]] = function() {\r\n                        return this._loadData.apply(this, arguments)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        m = null \r\n    }\r\n}\r\nif (typeof (window.dhx4._eventable) == \"undefined\") {\r\n    window.dhx4._eventable = function(a, c) {\r\n        if (c == \"clear\") {\r\n            a.detachAllEvents();\r\n            a.dhxevs = null ;\r\n            a.attachEvent = null ;\r\n            a.detachEvent = null ;\r\n            a.checkEvent = null ;\r\n            a.callEvent = null ;\r\n            a.detachAllEvents = null ;\r\n            a = null ;\r\n            return\r\n        }\r\n        a.dhxevs = {\r\n            data: {}\r\n        };\r\n        a.attachEvent = function(e, h) {\r\n            e = String(e).toLowerCase();\r\n            if (!this.dhxevs.data[e]) {\r\n                this.dhxevs.data[e] = {}\r\n            }\r\n            var g = window.dhx4.newId();\r\n            this.dhxevs.data[e][g] = h;\r\n            return g\r\n        }\r\n        ;\r\n        a.detachEvent = function(l) {\r\n            for (var g in this.dhxevs.data) {\r\n                var h = 0;\r\n                for (var e in this.dhxevs.data[g]) {\r\n                    if (e == l) {\r\n                        this.dhxevs.data[g][e] = null ;\r\n                        delete this.dhxevs.data[g][e]\r\n                    } else {\r\n                        h++\r\n                    }\r\n                }\r\n                if (h == 0) {\r\n                    this.dhxevs.data[g] = null ;\r\n                    delete this.dhxevs.data[g]\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        a.checkEvent = function(e) {\r\n            e = String(e).toLowerCase();\r\n            return ( this.dhxevs.data[e] != null ) \r\n        }\r\n        ;\r\n        a.callEvent = function(g, l) {\r\n            g = String(g).toLowerCase();\r\n            if (this.dhxevs.data[g] == null ) {\r\n                return true\r\n            }\r\n            var h = true;\r\n            for (var e in this.dhxevs.data[g]) {\r\n                h = this.dhxevs.data[g][e].apply(this, l) && h\r\n            }\r\n            return h\r\n        }\r\n        ;\r\n        a.detachAllEvents = function() {\r\n            for (var g in this.dhxevs.data) {\r\n                for (var e in this.dhxevs.data[g]) {\r\n                    this.dhxevs.data[g][e] = null ;\r\n                    delete this.dhxevs.data[g][e]\r\n                }\r\n                this.dhxevs.data[g] = null ;\r\n                delete this.dhxevs.data[g]\r\n            }\r\n        }\r\n        ;\r\n        a = null \r\n    }\r\n    ;\r\n    dhx4._eventable(dhx4)\r\n}\r\nif (!window.dhtmlxValidation) {\r\n    dhtmlxValidation = function() {}\r\n    ;\r\n    dhtmlxValidation.prototype = {\r\n        isEmpty: function(a) {\r\n            return a == \"\"\r\n        },\r\n        isNotEmpty: function(a) {\r\n            return ( a instanceof Array ? a.length > 0 : !a == \"\") \r\n        },\r\n        isValidBoolean: function(a) {\r\n            return !!a.toString().match(/^(0|1|true|false)$/)\r\n        },\r\n        isValidEmail: function(a) {\r\n            return !!a.toString().match(/(^[a-z0-9]([0-9a-z\\-_\\.]*)@([0-9a-z_\\-\\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\\.\\-]*)@([0-9a-z_\\-\\.]*)(\\.[a-z]{2,4})$)/i)\r\n        },\r\n        isValidInteger: function(a) {\r\n            return !!a.toString().match(/(^-?\\d+$)/)\r\n        },\r\n        isValidNumeric: function(a) {\r\n            return !!a.toString().match(/(^-?\\d\\d*[\\.|,]\\d*$)|(^-?\\d\\d*$)|(^-?[\\.|,]\\d\\d*$)/)\r\n        },\r\n        isValidAplhaNumeric: function(a) {\r\n            return !!a.toString().match(/^[_\\-a-z0-9]+$/gi)\r\n        },\r\n        isValidDatetime: function(c) {\r\n            var a = c.toString().match(/^(\\d{4})-(\\d{2})-(\\d{2})\\s(\\d{2}):(\\d{2}):(\\d{2})$/);\r\n            return a && !!(a[1] <= 9999 && a[2] <= 12 && a[3] <= 31 && a[4] <= 59 && a[5] <= 59 && a[6] <= 59) || false\r\n        },\r\n        isValidDate: function(a) {\r\n            var c = a.toString().match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\r\n            return c && !!(c[1] <= 9999 && c[2] <= 12 && c[3] <= 31) || false\r\n        },\r\n        isValidTime: function(c) {\r\n            var a = c.toString().match(/^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})$/);\r\n            return a && !!(a[1] <= 24 && a[2] <= 59 && a[3] <= 59) || false\r\n        },\r\n        isValidIPv4: function(a) {\r\n            var c = a.toString().match(/^(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})$/);\r\n            return c && !!(c[1] <= 255 && c[2] <= 255 && c[3] <= 255 && c[4] <= 255) || false\r\n        },\r\n        isValidCurrency: function(a) {\r\n            return a.toString().match(/^\\$?\\s?\\d+?([\\.,\\,]?\\d+)?\\s?\\$?$/) && true || false\r\n        },\r\n        isValidSSN: function(a) {\r\n            return a.toString().match(/^\\d{3}\\-?\\d{2}\\-?\\d{4}$/) && true || false\r\n        },\r\n        isValidSIN: function(a) {\r\n            return a.toString().match(/^\\d{9}$/) && true || false\r\n        }\r\n    };\r\n    dhtmlxValidation = new dhtmlxValidation()\r\n}\r\nif (typeof (window.dhtmlx) == \"undefined\") {\r\n    window.dhtmlx = {\r\n        extend: function(e, c) {\r\n            for (var g in c) {\r\n                if (!e[g]) {\r\n                    e[g] = c[g]\r\n                }\r\n            }\r\n            return e\r\n        },\r\n        extend_api: function(a, g, e) {\r\n            var c = window[a];\r\n            if (!c) {\r\n                return\r\n            }\r\n            window[a] = function(m) {\r\n                if (m && typeof m == \"object\" && !m.tagName) {\r\n                    var l = c.apply(this, (g._init ? g._init(m) : arguments));\r\n                    for (var h in dhtmlx) {\r\n                        if (g[h]) {\r\n                            this[g[h]](dhtmlx[h])\r\n                        }\r\n                    }\r\n                    for (var h in m) {\r\n                        if (g[h]) {\r\n                            this[g[h]](m[h])\r\n                        } else {\r\n                            if (h.indexOf(\"on\") === 0) {\r\n                                this.attachEvent(h, m[h])\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    var l = c.apply(this, arguments)\r\n                }\r\n                if (g._patch) {\r\n                    g._patch(this)\r\n                }\r\n                return l || this\r\n            }\r\n            ;\r\n            window[a].prototype = c.prototype;\r\n            if (e) {\r\n                dhtmlx.extend(window[a].prototype, e)\r\n            }\r\n        },\r\n        url: function(a) {\r\n            if (a.indexOf(\"?\") != -1) {\r\n                return \"&\"\r\n            } else {\r\n                return \"?\"\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction dhtmlDragAndDropObject() {\r\n    if (window.dhtmlDragAndDrop) {\r\n        return window.dhtmlDragAndDrop\r\n    }\r\n    this.lastLanding = 0;\r\n    this.dragNode = 0;\r\n    this.dragStartNode = 0;\r\n    this.dragStartObject = 0;\r\n    this.tempDOMU = null ;\r\n    this.tempDOMM = null ;\r\n    this.waitDrag = 0;\r\n    window.dhtmlDragAndDrop = this;\r\n    return this\r\n}\r\ndhtmlDragAndDropObject.prototype.removeDraggableItem = function(a) {\r\n    a.onmousedown = null ;\r\n    a.dragStarter = null ;\r\n    a.dragLanding = null \r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.addDraggableItem = function(a, c) {\r\n    a.onmousedown = this.preCreateDragCopy;\r\n    a.dragStarter = c;\r\n    this.addDragLanding(a, c)\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.addDragLanding = function(a, c) {\r\n    a.dragLanding = c\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.preCreateDragCopy = function(a) {\r\n    if ((a || window.event) && (a || event).button == 2) {\r\n        return\r\n    }\r\n    if (window.dhtmlDragAndDrop.waitDrag) {\r\n        window.dhtmlDragAndDrop.waitDrag = 0;\r\n        document.body.onmouseup = window.dhtmlDragAndDrop.tempDOMU;\r\n        document.body.onmousemove = window.dhtmlDragAndDrop.tempDOMM;\r\n        return false\r\n    }\r\n    if (window.dhtmlDragAndDrop.dragNode) {\r\n        window.dhtmlDragAndDrop.stopDrag(a)\r\n    }\r\n    window.dhtmlDragAndDrop.waitDrag = 1;\r\n    window.dhtmlDragAndDrop.tempDOMU = document.body.onmouseup;\r\n    window.dhtmlDragAndDrop.tempDOMM = document.body.onmousemove;\r\n    window.dhtmlDragAndDrop.dragStartNode = this;\r\n    window.dhtmlDragAndDrop.dragStartObject = this.dragStarter;\r\n    document.body.onmouseup = window.dhtmlDragAndDrop.preCreateDragCopy;\r\n    document.body.onmousemove = window.dhtmlDragAndDrop.callDrag;\r\n    window.dhtmlDragAndDrop.downtime = new Date().valueOf();\r\n    if ((a) && (a.preventDefault)) {\r\n        a.preventDefault();\r\n        return false\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.callDrag = function(g) {\r\n    if (!g) {\r\n        g = window.event\r\n    }\r\n    dragger = window.dhtmlDragAndDrop;\r\n    if ((new Date()).valueOf() - dragger.downtime < 100) {\r\n        return\r\n    }\r\n    if (!dragger.dragNode) {\r\n        if (dragger.waitDrag) {\r\n            dragger.dragNode = dragger.dragStartObject._createDragNode(dragger.dragStartNode, g);\r\n            if (!dragger.dragNode) {\r\n                return dragger.stopDrag()\r\n            }\r\n            dragger.dragNode.onselectstart = function() {\r\n                return false\r\n            }\r\n            ;\r\n            dragger.gldragNode = dragger.dragNode;\r\n            document.body.appendChild(dragger.dragNode);\r\n            document.body.onmouseup = dragger.stopDrag;\r\n            dragger.waitDrag = 0;\r\n            dragger.dragNode.pWindow = window;\r\n            dragger.initFrameRoute()\r\n        } else {\r\n            return dragger.stopDrag(g, true)\r\n        }\r\n    }\r\n    if (dragger.dragNode.parentNode != window.document.body && dragger.gldragNode) {\r\n        var a = dragger.gldragNode;\r\n        if (dragger.gldragNode.old) {\r\n            a = dragger.gldragNode.old\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        var c = dragger.dragNode.pWindow;\r\n        if (a.pWindow && a.pWindow.dhtmlDragAndDrop.lastLanding) {\r\n            a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding)\r\n        }\r\n        if (_isIE) {\r\n            var l = document.createElement(\"Div\");\r\n            l.innerHTML = dragger.dragNode.outerHTML;\r\n            dragger.dragNode = l.childNodes[0]\r\n        } else {\r\n            dragger.dragNode = dragger.dragNode.cloneNode(true)\r\n        }\r\n        dragger.dragNode.pWindow = window;\r\n        dragger.gldragNode.old = dragger.dragNode;\r\n        document.body.appendChild(dragger.dragNode);\r\n        c.dhtmlDragAndDrop.dragNode = dragger.dragNode\r\n    }\r\n    dragger.dragNode.style.left = g.clientX + 15 + (dragger.fx ? dragger.fx * (-1) : 0) + (document.body.scrollLeft || document.documentElement.scrollLeft) + \"px\";\r\n    dragger.dragNode.style.top = g.clientY + 3 + (dragger.fy ? dragger.fy * (-1) : 0) + (document.body.scrollTop || document.documentElement.scrollTop) + \"px\";\r\n    if (!g.srcElement) {\r\n        var h = g.target\r\n    } else {\r\n        h = g.srcElement\r\n    }\r\n    dragger.checkLanding(h, g)\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.calculateFramePosition = function(h) {\r\n    if (window.name) {\r\n        var e = parent.frames[window.name].frameElement.offsetParent;\r\n        var g = 0;\r\n        var c = 0;\r\n        while (e) {\r\n            g += e.offsetLeft;\r\n            c += e.offsetTop;\r\n            e = e.offsetParent\r\n        }\r\n        if ((parent.dhtmlDragAndDrop) ) {\r\n            var a = parent.dhtmlDragAndDrop.calculateFramePosition(1);\r\n            g += a.split(\"_\")[0] * 1;\r\n            c += a.split(\"_\")[1] * 1\r\n        }\r\n        if (h) {\r\n            return g + \"_\" + c\r\n        } else {\r\n            this.fx = g\r\n        }\r\n        this.fy = c\r\n    }\r\n    return \"0_0\"\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.checkLanding = function(c, a) {\r\n    if ((c) && (c.dragLanding)) {\r\n        if (this.lastLanding) {\r\n            this.lastLanding.dragLanding._dragOut(this.lastLanding)\r\n        }\r\n        this.lastLanding = c;\r\n        this.lastLanding = this.lastLanding.dragLanding._dragIn(this.lastLanding, this.dragStartNode, a.clientX, a.clientY, a);\r\n        this.lastLanding_scr = (_isIE ? a.srcElement : a.target)\r\n    } else {\r\n        if ((c) && (c.tagName != \"BODY\")) {\r\n            this.checkLanding(c.parentNode, a)\r\n        } else {\r\n            if (this.lastLanding) {\r\n                this.lastLanding.dragLanding._dragOut(this.lastLanding, a.clientX, a.clientY, a)\r\n            }\r\n            this.lastLanding = 0;\r\n            if (this._onNotFound) {\r\n                this._onNotFound()\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.stopDrag = function(c, g) {\r\n    dragger = window.dhtmlDragAndDrop;\r\n    if (!g) {\r\n        dragger.stopFrameRoute();\r\n        var a = dragger.lastLanding;\r\n        dragger.lastLanding = null ;\r\n        if (a) {\r\n            a.dragLanding._drag(dragger.dragStartNode, dragger.dragStartObject, a, (_isIE ? event.srcElement : c.target))\r\n        }\r\n    }\r\n    dragger.lastLanding = null ;\r\n    if ((dragger.dragNode) && (dragger.dragNode.parentNode == document.body)) {\r\n        dragger.dragNode.parentNode.removeChild(dragger.dragNode)\r\n    }\r\n    dragger.dragNode = 0;\r\n    dragger.gldragNode = 0;\r\n    dragger.fx = 0;\r\n    dragger.fy = 0;\r\n    dragger.dragStartNode = 0;\r\n    dragger.dragStartObject = 0;\r\n    document.body.onmouseup = dragger.tempDOMU;\r\n    document.body.onmousemove = dragger.tempDOMM;\r\n    dragger.tempDOMU = null ;\r\n    dragger.tempDOMM = null ;\r\n    dragger.waitDrag = 0\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.stopFrameRoute = function(g) {\r\n    if (g) {\r\n        window.dhtmlDragAndDrop.stopDrag(1, 1)\r\n    }\r\n    for (var a = 0; a < window.frames.length; a++) {\r\n        try {\r\n            if ((window.frames[a] != g) && (window.frames[a].dhtmlDragAndDrop)) {\r\n                window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)\r\n            }\r\n        } catch (c) {}\r\n    }\r\n    try {\r\n        if ((parent.dhtmlDragAndDrop) && (parent != window) && (parent != g)) {\r\n            parent.dhtmlDragAndDrop.stopFrameRoute(window)\r\n        }\r\n    } catch (c) {}\r\n}\r\n;\r\ndhtmlDragAndDropObject.prototype.initFrameRoute = function(g, h) {\r\n    if (g) {\r\n        window.dhtmlDragAndDrop.preCreateDragCopy();\r\n        window.dhtmlDragAndDrop.dragStartNode = g.dhtmlDragAndDrop.dragStartNode;\r\n        window.dhtmlDragAndDrop.dragStartObject = g.dhtmlDragAndDrop.dragStartObject;\r\n        window.dhtmlDragAndDrop.dragNode = g.dhtmlDragAndDrop.dragNode;\r\n        window.dhtmlDragAndDrop.gldragNode = g.dhtmlDragAndDrop.dragNode;\r\n        window.document.body.onmouseup = window.dhtmlDragAndDrop.stopDrag;\r\n        window.waitDrag = 0;\r\n        if (((!_isIE) && (h)) && ((!_isFF) || (_FFrv < 1.8))) {\r\n            window.dhtmlDragAndDrop.calculateFramePosition()\r\n        }\r\n    }\r\n    try {\r\n        if ((parent.dhtmlDragAndDrop) && (parent != window) && (parent != g)) {\r\n            parent.dhtmlDragAndDrop.initFrameRoute(window)\r\n        }\r\n    } catch (c) {}\r\n    for (var a = 0; a < window.frames.length; a++) {\r\n        try {\r\n            if ((window.frames[a] != g) && (window.frames[a].dhtmlDragAndDrop)) {\r\n                window.frames[a].dhtmlDragAndDrop.initFrameRoute(window, ((!g || h) ? 1 : 0))\r\n            }\r\n        } catch (c) {}\r\n    }\r\n}\r\n;\r\n_isFF = false;\r\n_isIE = false;\r\n_isOpera = false;\r\n_isKHTML = false;\r\n_isMacOS = false;\r\n_isChrome = false;\r\n_FFrv = false;\r\n_KHTMLrv = false;\r\n_OperaRv = false;\r\nif (navigator.userAgent.indexOf(\"Macintosh\") != -1) {\r\n    _isMacOS = true\r\n}\r\nif (navigator.userAgent.toLowerCase().indexOf(\"chrome\") > -1) {\r\n    _isChrome = true\r\n}\r\nif ((navigator.userAgent.indexOf(\"Safari\") != -1) || (navigator.userAgent.indexOf(\"Konqueror\") != -1)) {\r\n    _KHTMLrv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf(\"Safari\") + 7, 5));\r\n    if (_KHTMLrv > 525) {\r\n        _isFF = true;\r\n        _FFrv = 1.9\r\n    } else {\r\n        _isKHTML = true\r\n    }\r\n} else {\r\n    if (navigator.userAgent.indexOf(\"Opera\") != -1) {\r\n        _isOpera = true;\r\n        _OperaRv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf(\"Opera\") + 6, 3))\r\n    } else {\r\n        if (navigator.appName.indexOf(\"Microsoft\") != -1) {\r\n            _isIE = true;\r\n            if ((navigator.appVersion.indexOf(\"MSIE 8.0\") != -1 || navigator.appVersion.indexOf(\"MSIE 9.0\") != -1 || navigator.appVersion.indexOf(\"MSIE 10.0\") != -1 || document.documentMode > 7) && document.compatMode != \"BackCompat\") {\r\n                _isIE = 8\r\n            }\r\n        } else {\r\n            if (navigator.appName == \"Netscape\" && navigator.userAgent.indexOf(\"Trident\") != -1) {\r\n                _isIE = 8\r\n            } else {\r\n                _isFF = true;\r\n                _FFrv = parseFloat(navigator.userAgent.split(\"rv:\")[1])\r\n            }\r\n        }\r\n    }\r\n}\r\nif (typeof (window.dhtmlxEvent) == \"undefined\") {\r\n    function dhtmlxEvent(c, e, a) {\r\n        if (c.addEventListener) {\r\n            c.addEventListener(e, a, false)\r\n        } else {\r\n            if (c.attachEvent) {\r\n                c.attachEvent(\"on\" + e, a)\r\n            }\r\n        }\r\n    }\r\n}\r\nif (dhtmlxEvent.touchDelay == null ) {\r\n    dhtmlxEvent.touchDelay = 2000\r\n}\r\nif (typeof (dhtmlxEvent.initTouch) == \"undefined\") {\r\n    dhtmlxEvent.initTouch = function() {\r\n        var g;\r\n        var h;\r\n        var c, a;\r\n        dhtmlxEvent(document.body, \"touchstart\", function(l) {\r\n            h = l.touches[0].target;\r\n            c = l.touches[0].clientX;\r\n            a = l.touches[0].clientY;\r\n            g = window.setTimeout(e, dhtmlxEvent.touchDelay)\r\n        });\r\n        function e() {\r\n            if (h) {\r\n                var l = document.createEvent(\"HTMLEvents\");\r\n                l.initEvent(\"dblclick\", true, true);\r\n                h.dispatchEvent(l);\r\n                g = h = null \r\n            }\r\n        }\r\n        dhtmlxEvent(document.body, \"touchmove\", function(l) {\r\n            if (g) {\r\n                if (Math.abs(l.touches[0].clientX - c) > 50 || Math.abs(l.touches[0].clientY - a) > 50) {\r\n                    window.clearTimeout(g);\r\n                    g = h = false\r\n                }\r\n            }\r\n        });\r\n        dhtmlxEvent(document.body, \"touchend\", function(l) {\r\n            if (g) {\r\n                window.clearTimeout(g);\r\n                g = h = false\r\n            }\r\n        });\r\n        dhtmlxEvent.initTouch = function() {}\r\n    }\r\n}\r\nif (!window.dhtmlx) {\r\n    dhtmlx = {}\r\n}\r\ndhtmlx.assert = function(c, a) {\r\n    if (!c) {\r\n        dhtmlx.error(a)\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_enabled = function() {\r\n    return false\r\n}\r\n;\r\ndhtmlx.assert_event = function(l, e) {\r\n    if (!l._event_check) {\r\n        l._event_check = {};\r\n        l._event_check_size = {}\r\n    }\r\n    for (var c in e) {\r\n        l._event_check[c.toLowerCase()] = e[c];\r\n        var h = -1;\r\n        for (var g in e[c]) {\r\n            h++\r\n        }\r\n        l._event_check_size[c.toLowerCase()] = h\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_method_info = function(h, c, g, l) {\r\n    var a = [];\r\n    for (var e = 0; e < l.length; e++) {\r\n        a.push(l[e][0] + \" : \" + l[e][1] + \"\\n   \" + l[e][2].describe() + (l[e][3] ? \"; optional\" : \"\"))\r\n    }\r\n    return h.name + \".\" + c + \"\\n\" + g + \"\\n Arguments:\\n - \" + a.join(\"\\n - \")\r\n}\r\n;\r\ndhtmlx.assert_method = function(e, a) {\r\n    for (var c in a) {\r\n        dhtmlx.assert_method_process(e, c, a[c].descr, a[c].args, (a[c].min || 99), a[c].skip)\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_method_process = function(l, c, h, m, e, g) {\r\n    var a = l[c];\r\n    if (!g) {\r\n        l[c] = function() {\r\n            if (arguments.length != m.length && arguments.length < e) {\r\n                dhtmlx.log(\"warn\", \"Incorrect count of parameters\\n\" + l[c].describe() + \"\\n\\nExpecting \" + m.length + \" but have only \" + arguments.length)\r\n            } else {\r\n                for (var n = 0; n < m.length; n++) {\r\n                    if (!m[n][3] && !m[n][2](arguments[n])) {\r\n                        dhtmlx.log(\"warn\", \"Incorrect method call\\n\" + l[c].describe() + \"\\n\\nActual value of \" + (n + 1) + \" parameter: {\" + (typeof arguments[n]) + \"} \" + arguments[n])\r\n                    }\r\n                }\r\n            }\r\n            return a.apply(this, arguments)\r\n        }\r\n    }\r\n    l[c].describe = function() {\r\n        return dhtmlx.assert_method_info(l, c, h, m)\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_event_call = function(e, c, a) {\r\n    if (e._event_check) {\r\n        if (!e._event_check[c]) {\r\n            dhtmlx.log(\"warn\", \"Not expected event call :\" + c)\r\n        } else {\r\n            if (dhtmlx.isNotDefined(a)) {\r\n                dhtmlx.log(\"warn\", \"Event without parameters :\" + c)\r\n            } else {\r\n                if (e._event_check_size[c] != a.length) {\r\n                    dhtmlx.log(\"warn\", \"Incorrect event call, expected \" + e._event_check_size[c] + \" parameter(s), but have \" + a.length + \" parameter(s), for \" + c + \" event\")\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_event_attach = function(c, a) {\r\n    if (c._event_check && !c._event_check[a]) {\r\n        dhtmlx.log(\"warn\", \"Unknown event name: \" + a)\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_property = function(c, a) {\r\n    if (!c._settings_check) {\r\n        c._settings_check = {}\r\n    }\r\n    dhtmlx.extend(c._settings_check, a)\r\n}\r\n;\r\ndhtmlx.assert_check = function(e, c) {\r\n    if (typeof e == \"object\") {\r\n        for (var a in e) {\r\n            dhtmlx.assert_settings(a, e[a], c)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_settings = function(n, h, g) {\r\n    g = g || this._settings_check;\r\n    if (g) {\r\n        if (!g[n]) {\r\n            return dhtmlx.log(\"warn\", \"Unknown propery: \" + n)\r\n        }\r\n        var m = \"\";\r\n        var c = \"\";\r\n        var a = false;\r\n        for (var e = 0; e < g[n].length; e++) {\r\n            var l = g[n][e];\r\n            if (typeof l == \"string\") {\r\n                continue\r\n            }\r\n            if (typeof l == \"function\") {\r\n                a = a || l(h)\r\n            } else {\r\n                if (typeof l == \"object\" && typeof l[1] == \"function\") {\r\n                    a = a || l[1](h);\r\n                    if (a && l[2]) {\r\n                        dhtmlx.assert_check(h, l[2])\r\n                    }\r\n                }\r\n            }\r\n            if (a) {\r\n                break\r\n            }\r\n        }\r\n        if (!a) {\r\n            dhtmlx.log(\"warn\", \"Invalid configuration\\n\" + dhtmlx.assert_info(n, g) + \"\\nActual value: {\" + (typeof h) + \"} \" + h)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlx.assert_info = function(c, l) {\r\n    var a = l[c];\r\n    var h = \"\";\r\n    var g = [];\r\n    for (var e = 0; e < a.length; e++) {\r\n        if (typeof rule == \"string\") {\r\n            h = a[e]\r\n        } else {\r\n            if (a[e].describe) {\r\n                g.push(a[e].describe())\r\n            } else {\r\n                if (a[e][1] && a[e][1].describe) {\r\n                    g.push(a[e][1].describe())\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return \"Property: \" + c + \", \" + h + \" \\nExpected value: \\n - \" + g.join(\"\\n - \")\r\n}\r\n;\r\nif (dhtmlx.assert_enabled()) {\r\n    dhtmlx.assert_rule_color = function(a) {\r\n        if (typeof a != \"string\") {\r\n            return false\r\n        }\r\n        if (a.indexOf(\"#\") !== 0) {\r\n            return false\r\n        }\r\n        if (a.substr(1).replace(/[0-9A-F]/gi, \"\") !== \"\") {\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_color.describe = function() {\r\n        return \"{String} Value must start from # and contain hexadecimal code of color\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_template = function(a) {\r\n        if (typeof a == \"function\") {\r\n            return true\r\n        }\r\n        if (typeof a == \"string\") {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_template.describe = function() {\r\n        return \"{Function},{String} Value must be a function which accepts data object and return text string, or a sting with optional template markers\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_boolean = function(a) {\r\n        if (typeof a == \"boolean\") {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_boolean.describe = function() {\r\n        return \"{Boolean} true or false\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_object = function(a, c) {\r\n        if (typeof a == \"object\") {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_object.describe = function() {\r\n        return \"{Object} Configuration object\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_string = function(a) {\r\n        if (typeof a == \"string\") {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_string.describe = function() {\r\n        return \"{String} Plain string\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_htmlpt = function(a) {\r\n        return !!dhtmlx.toNode(a)\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_htmlpt.describe = function() {\r\n        return \"{Object},{String} HTML node or ID of HTML Node\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_notdocumented = function(a) {\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_notdocumented.describe = function() {\r\n        return \"This options wasn't documented\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_key = function(c) {\r\n        var a = function(e) {\r\n            return c[e]\r\n        }\r\n        ;\r\n        a.describe = function() {\r\n            var g = [];\r\n            for (var e in c) {\r\n                g.push(e)\r\n            }\r\n            return \"{String} can take one of next values: \" + g.join(\", \")\r\n        }\r\n        ;\r\n        return a\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_dimension = function(a) {\r\n        if (a * 1 == a && !isNaN(a) && a >= 0) {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_dimension.describe = function() {\r\n        return \"{Integer} value must be a positive number\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_number = function(a) {\r\n        if (typeof a == \"number\") {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_number.describe = function() {\r\n        return \"{Integer} value must be a number\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_function = function(a) {\r\n        if (typeof a == \"function\") {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_function.describe = function() {\r\n        return \"{Function} value must be a custom function\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_any = function(a) {\r\n        return true\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_any.describe = function() {\r\n        return \"Any value\"\r\n    }\r\n    ;\r\n    dhtmlx.assert_rule_mix = function(e, c) {\r\n        var g = function(a) {\r\n            if (e(a) || c(a)) {\r\n                return true\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        g.describe = function() {\r\n            return e.describe()\r\n        }\r\n        ;\r\n        return g\r\n    }\r\n}\r\ndhtmlx.codebase = \"./\";\r\ndhtmlx.copy = function(c) {\r\n    var a = dhtmlx.copy._function;\r\n    a.prototype = c;\r\n    return new a()\r\n}\r\n;\r\ndhtmlx.copy._function = function() {}\r\n;\r\ndhtmlx.extend = function(c, a) {\r\n    for (var e in a) {\r\n        c[e] = a[e]\r\n    }\r\n    if (dhtmlx.assert_enabled() && a._assert) {\r\n        c._assert();\r\n        c._assert = null \r\n    }\r\n    dhtmlx.assert(c, \"Invalid nesting target\");\r\n    dhtmlx.assert(a, \"Invalid nesting source\");\r\n    if (a._init) {\r\n        c._init()\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlx.proto_extend = function() {\r\n    var l = arguments;\r\n    var e = l[0];\r\n    var c = [];\r\n    for (var h = l.length - 1; h > 0; h--) {\r\n        if (typeof l[h] == \"function\") {\r\n            l[h] = l[h].prototype\r\n        }\r\n        for (var g in l[h]) {\r\n            if (g == \"_init\") {\r\n                c.push(l[h][g])\r\n            } else {\r\n                if (!e[g]) {\r\n                    e[g] = l[h][g]\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (l[0]._init) {\r\n        c.push(l[0]._init)\r\n    }\r\n    e._init = function() {\r\n        for (var m = 0; m < c.length; m++) {\r\n            c[m].apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    e.base = l[1];\r\n    var a = function(m) {\r\n        this._init(m);\r\n        if (this._parseSettings) {\r\n            this._parseSettings(m, this.defaults)\r\n        }\r\n    }\r\n    ;\r\n    a.prototype = e;\r\n    e = l = null ;\r\n    return a\r\n}\r\n;\r\ndhtmlx.bind = function(c, a) {\r\n    return function() {\r\n        return c.apply(a, arguments)\r\n    }\r\n}\r\n;\r\ndhtmlx.require = function(a) {\r\n    if (!dhtmlx._modules[a]) {\r\n        dhtmlx.assert(dhtmlx.ajax, \"load module is required\");\r\n        dhtmlx.exec(dhtmlx.ajax().sync().get(dhtmlx.codebase + a).responseText);\r\n        dhtmlx._modules[a] = true\r\n    }\r\n}\r\n;\r\ndhtmlx._modules = {};\r\ndhtmlx.exec = function(code) {\r\n    if (window.execScript) {\r\n        window.execScript(code)\r\n    } else {\r\n        window.eval(code)\r\n    }\r\n}\r\n;\r\ndhtmlx.methodPush = function(a, e, c) {\r\n    return function() {\r\n        var g = false;\r\n        g = a[e].apply(a, arguments);\r\n        return g\r\n    }\r\n}\r\n;\r\ndhtmlx.isNotDefined = function(c) {\r\n    return typeof c == \"undefined\"\r\n}\r\n;\r\ndhtmlx.delay = function(g, c, e, a) {\r\n    setTimeout(function() {\r\n        var h = g.apply(c, e);\r\n        g = c = e = null ;\r\n        return h\r\n    }, a || 1)\r\n}\r\n;\r\ndhtmlx.uid = function() {\r\n    if (!this._seed) {\r\n        this._seed = (new Date).valueOf()\r\n    }\r\n    this._seed++;\r\n    return this._seed\r\n}\r\n;\r\ndhtmlx.toNode = function(a) {\r\n    if (typeof a == \"string\") {\r\n        return document.getElementById(a)\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlx.toArray = function(a) {\r\n    return dhtmlx.extend((a || []), dhtmlx.PowerArray)\r\n}\r\n;\r\ndhtmlx.toFunctor = function(str) {\r\n    return (typeof (str) == \"string\") ? eval(str) : str\r\n}\r\n;\r\ndhtmlx._events = {};\r\ndhtmlx.event = function(g, e, a, c) {\r\n    g = dhtmlx.toNode(g);\r\n    var h = dhtmlx.uid();\r\n    dhtmlx._events[h] = [g, e, a];\r\n    if (c) {\r\n        a = dhtmlx.bind(a, c)\r\n    }\r\n    if (g.addEventListener) {\r\n        g.addEventListener(e, a, false)\r\n    } else {\r\n        if (g.attachEvent) {\r\n            g.attachEvent(\"on\" + e, a)\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlx.eventRemove = function(c) {\r\n    if (!c) {\r\n        return\r\n    }\r\n    dhtmlx.assert(this._events[c], \"Removing non-existing event\");\r\n    var a = dhtmlx._events[c];\r\n    if (a[0].removeEventListener) {\r\n        a[0].removeEventListener(a[1], a[2], false)\r\n    } else {\r\n        if (a[0].detachEvent) {\r\n            a[0].detachEvent(\"on\" + a[1], a[2])\r\n        }\r\n    }\r\n    delete this._events[c]\r\n}\r\n;\r\ndhtmlx.log = function(c, e, a) {\r\n    if (window.console && console.log) {\r\n        c = c.toLowerCase();\r\n        if (window.console[c]) {\r\n            window.console[c](e || \"unknown error\")\r\n        } else {\r\n            window.console.log(c + \": \" + e)\r\n        }\r\n        if (a) {\r\n            window.console.log(a)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlx.log_full_time = function(a) {\r\n    dhtmlx._start_time_log = new Date();\r\n    dhtmlx.log(\"Info\", \"Timing start [\" + a + \"]\");\r\n    window.setTimeout(function() {\r\n        var c = new Date();\r\n        dhtmlx.log(\"Info\", \"Timing end [\" + a + \"]:\" + (c.valueOf() - dhtmlx._start_time_log.valueOf()) / 1000 + \"s\")\r\n    }, 1)\r\n}\r\n;\r\ndhtmlx.log_time = function(a) {\r\n    var e = \"_start_time_log\" + a;\r\n    if (!dhtmlx[e]) {\r\n        dhtmlx[e] = new Date();\r\n        dhtmlx.log(\"Info\", \"Timing start [\" + a + \"]\")\r\n    } else {\r\n        var c = new Date();\r\n        dhtmlx.log(\"Info\", \"Timing end [\" + a + \"]:\" + (c.valueOf() - dhtmlx[e].valueOf()) / 1000 + \"s\");\r\n        dhtmlx[e] = null \r\n    }\r\n}\r\n;\r\ndhtmlx.error = function(c, a) {\r\n    dhtmlx.log(\"error\", c, a)\r\n}\r\n;\r\ndhtmlx.EventSystem = {\r\n    _init: function() {\r\n        this._events = {};\r\n        this._handlers = {};\r\n        this._map = {}\r\n    },\r\n    block: function() {\r\n        this._events._block = true\r\n    },\r\n    unblock: function() {\r\n        this._events._block = false\r\n    },\r\n    mapEvent: function(a) {\r\n        dhtmlx.extend(this._map, a)\r\n    },\r\n    callEvent: function(e, h) {\r\n        if (this._events._block) {\r\n            return true\r\n        }\r\n        e = e.toLowerCase();\r\n        dhtmlx.assert_event_call(this, e, h);\r\n        var g = this._events[e.toLowerCase()];\r\n        var a = true;\r\n        if (dhtmlx.debug) {\r\n            dhtmlx.log(\"info\", \"[\" + this.name + \"] event:\" + e, h)\r\n        }\r\n        if (g) {\r\n            for (var c = 0; c < g.length; c++) {\r\n                if (g[c].apply(this, (h || [])) === false) {\r\n                    a = false\r\n                }\r\n            }\r\n        }\r\n        if (this._map[e] && !this._map[e].callEvent(e, h)) {\r\n            a = false\r\n        }\r\n        return a\r\n    },\r\n    attachEvent: function(c, a, g) {\r\n        c = c.toLowerCase();\r\n        dhtmlx.assert_event_attach(this, c);\r\n        g = g || dhtmlx.uid();\r\n        a = dhtmlx.toFunctor(a);\r\n        var e = this._events[c] || dhtmlx.toArray();\r\n        e.push(a);\r\n        this._events[c] = e;\r\n        this._handlers[g] = {\r\n            f: a,\r\n            t: c\r\n        };\r\n        return g\r\n    },\r\n    detachEvent: function(g) {\r\n        if (this._handlers[g]) {\r\n            var c = this._handlers[g].t;\r\n            var a = this._handlers[g].f;\r\n            var e = this._events[c];\r\n            e.remove(a);\r\n            delete this._handlers[g]\r\n        }\r\n    }\r\n};\r\ndhtmlx.PowerArray = {\r\n    removeAt: function(c, a) {\r\n        if (c >= 0) {\r\n            this.splice(c, (a || 1))\r\n        }\r\n    },\r\n    remove: function(a) {\r\n        this.removeAt(this.find(a))\r\n    },\r\n    insertAt: function(c, e) {\r\n        if (!e && e !== 0) {\r\n            this.push(c)\r\n        } else {\r\n            var a = this.splice(e, (this.length - e));\r\n            this[e] = c;\r\n            this.push.apply(this, a)\r\n        }\r\n    },\r\n    find: function(a) {\r\n        for (i = 0; i < this.length; i++) {\r\n            if (a == this[i]) {\r\n                return i\r\n            }\r\n        }\r\n        return -1\r\n    },\r\n    each: function(a, e) {\r\n        for (var c = 0; c < this.length; c++) {\r\n            a.call((e || this), this[c])\r\n        }\r\n    },\r\n    map: function(a, e) {\r\n        for (var c = 0; c < this.length; c++) {\r\n            this[c] = a.call((e || this), this[c])\r\n        }\r\n        return this\r\n    }\r\n};\r\ndhtmlx.env = {};\r\nif (navigator.userAgent.indexOf(\"Opera\") != -1) {\r\n    dhtmlx._isOpera = true\r\n} else {\r\n    dhtmlx._isIE = !!document.all;\r\n    dhtmlx._isFF = !document.all;\r\n    dhtmlx._isWebKit = (navigator.userAgent.indexOf(\"KHTML\") != -1);\r\n    if (navigator.appVersion.indexOf(\"MSIE 8.0\") != -1 && document.compatMode != \"BackCompat\") {\r\n        dhtmlx._isIE = 8\r\n    }\r\n    if (navigator.appVersion.indexOf(\"MSIE 9.0\") != -1 && document.compatMode != \"BackCompat\") {\r\n        dhtmlx._isIE = 9\r\n    }\r\n}\r\ndhtmlx.env = {};\r\n(function() {\r\n    dhtmlx.env.transform = false;\r\n    dhtmlx.env.transition = false;\r\n    var a = {};\r\n    a.names = [\"transform\", \"transition\"];\r\n    a.transform = [\"transform\", \"WebkitTransform\", \"MozTransform\", \"oTransform\", \"msTransform\"];\r\n    a.transition = [\"transition\", \"WebkitTransition\", \"MozTransition\", \"oTransition\"];\r\n    var g = document.createElement(\"DIV\");\r\n    var e;\r\n    for (var c = 0; c < a.names.length; c++) {\r\n        while (p = a[a.names[c]].pop()) {\r\n            if (typeof g.style[p] != \"undefined\") {\r\n                dhtmlx.env[a.names[c]] = true\r\n            }\r\n        }\r\n    }\r\n})();\r\ndhtmlx.env.transform_prefix = (function() {\r\n    var a;\r\n    if (dhtmlx._isOpera) {\r\n        a = \"-o-\"\r\n    } else {\r\n        a = \"\";\r\n        if (dhtmlx._isFF) {\r\n            a = \"-moz-\"\r\n        }\r\n        if (dhtmlx._isWebKit) {\r\n            a = \"-webkit-\"\r\n        }\r\n    }\r\n    return a\r\n})();\r\ndhtmlx.env.svg = (function() {\r\n    return document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\")\r\n})();\r\ndhtmlx.zIndex = {\r\n    drag: 10000\r\n};\r\ndhtmlx.html = {\r\n    create: function(c, a, e) {\r\n        a = a || {};\r\n        var g = document.createElement(c);\r\n        for (var h in a) {\r\n            g.setAttribute(h, a[h])\r\n        }\r\n        if (a.style) {\r\n            g.style.cssText = a.style\r\n        }\r\n        if (a[\"class\"]) {\r\n            g.className = a[\"class\"]\r\n        }\r\n        if (e) {\r\n            g.innerHTML = e\r\n        }\r\n        return g\r\n    },\r\n    getValue: function(a) {\r\n        a = dhtmlx.toNode(a);\r\n        if (!a) {\r\n            return \"\"\r\n        }\r\n        return dhtmlx.isNotDefined(a.value) ? a.innerHTML : a.value\r\n    },\r\n    remove: function(c) {\r\n        if (c instanceof Array) {\r\n            for (var a = 0; a < c.length; a++) {\r\n                this.remove(c[a])\r\n            }\r\n        } else {\r\n            if (c && c.parentNode) {\r\n                c.parentNode.removeChild(c)\r\n            }\r\n        }\r\n    },\r\n    insertBefore: function(c, e, a) {\r\n        if (!c) {\r\n            return\r\n        }\r\n        if (e) {\r\n            e.parentNode.insertBefore(c, e)\r\n        } else {\r\n            a.appendChild(c)\r\n        }\r\n    },\r\n    locate: function(c, h) {\r\n        c = c || event;\r\n        var a = c.target || c.srcElement;\r\n        while (a) {\r\n            if (a.getAttribute) {\r\n                var g = a.getAttribute(h);\r\n                if (g) {\r\n                    return g\r\n                }\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        return null \r\n    },\r\n    offset: function(g) {\r\n        if (g.getBoundingClientRect) {\r\n            var m = g.getBoundingClientRect();\r\n            var n = document.body;\r\n            var c = document.documentElement;\r\n            var a = window.pageYOffset || c.scrollTop || n.scrollTop;\r\n            var h = window.pageXOffset || c.scrollLeft || n.scrollLeft;\r\n            var l = c.clientTop || n.clientTop || 0;\r\n            var o = c.clientLeft || n.clientLeft || 0;\r\n            var r = m.top + a - l;\r\n            var e = m.left + h - o;\r\n            return {\r\n                y: Math.round(r),\r\n                x: Math.round(e)\r\n            }\r\n        } else {\r\n            var r = 0\r\n              , e = 0;\r\n            while (g) {\r\n                r = r + parseInt(g.offsetTop, 10);\r\n                e = e + parseInt(g.offsetLeft, 10);\r\n                g = g.offsetParent\r\n            }\r\n            return {\r\n                y: r,\r\n                x: e\r\n            }\r\n        }\r\n    },\r\n    pos: function(a) {\r\n        a = a || event;\r\n        if (a.pageX || a.pageY) {\r\n            return {\r\n                x: a.pageX,\r\n                y: a.pageY\r\n            }\r\n        }\r\n        var c = ((dhtmlx._isIE) && (document.compatMode != \"BackCompat\")) ? document.documentElement : document.body;\r\n        return {\r\n            x: a.clientX + c.scrollLeft - c.clientLeft,\r\n            y: a.clientY + c.scrollTop - c.clientTop\r\n        }\r\n    },\r\n    preventEvent: function(a) {\r\n        if (a && a.preventDefault) {\r\n            a.preventDefault()\r\n        }\r\n        dhtmlx.html.stopEvent(a)\r\n    },\r\n    stopEvent: function(a) {\r\n        (a || event).cancelBubble = true;\r\n        return false\r\n    },\r\n    addCss: function(c, a) {\r\n        c.className += \" \" + a\r\n    },\r\n    removeCss: function(c, a) {\r\n        c.className = c.className.replace(RegExp(a, \"g\"), \"\")\r\n    }\r\n};\r\n(function() {\r\n    var a = document.getElementsByTagName(\"SCRIPT\");\r\n    dhtmlx.assert(a.length, \"Can't locate codebase\");\r\n    if (a.length) {\r\n        a = (a[a.length - 1].getAttribute(\"src\") || \"\").split(\"/\");\r\n        a.splice(a.length - 1, 1);\r\n        dhtmlx.codebase = a.slice(0, a.length).join(\"/\") + \"/\"\r\n    }\r\n})();\r\nif (!dhtmlx.ui) {\r\n    dhtmlx.ui = {}\r\n}\r\ndhtmlx.Destruction = {\r\n    _init: function() {\r\n        dhtmlx.destructors.push(this)\r\n    },\r\n    destructor: function() {\r\n        this.destructor = function() {}\r\n        ;\r\n        this._htmlmap = null ;\r\n        this._htmlrows = null ;\r\n        if (this._html) {\r\n            document.body.appendChild(this._html)\r\n        }\r\n        this._html = null ;\r\n        if (this._obj) {\r\n            this._obj.innerHTML = \"\";\r\n            this._obj._htmlmap = null \r\n        }\r\n        this._obj = this._dataobj = null ;\r\n        this.data = null ;\r\n        this._events = this._handlers = {};\r\n        if (this.render) {\r\n            this.render = function() {}\r\n        }\r\n    }\r\n};\r\ndhtmlx.destructors = [];\r\ndhtmlx.event(window, \"unload\", function() {\r\n    if (dhtmlx.destructors) {\r\n        for (var e = 0; e < dhtmlx.destructors.length; e++) {\r\n            dhtmlx.destructors[e].destructor()\r\n        }\r\n        dhtmlx.destructors = []\r\n    }\r\n    for (var c in dhtmlx._events) {\r\n        var g = dhtmlx._events[c];\r\n        if (g[0].removeEventListener) {\r\n            g[0].removeEventListener(g[1], g[2], false)\r\n        } else {\r\n            if (g[0].detachEvent) {\r\n                g[0].detachEvent(\"on\" + g[1], g[2])\r\n            }\r\n        }\r\n        delete dhtmlx._events[c]\r\n    }\r\n});\r\ndhtmlx.ajax = function(a, c, e) {\r\n    if (arguments.length !== 0) {\r\n        var g = new dhtmlx.ajax();\r\n        if (e) {\r\n            g.master = e\r\n        }\r\n        g.get(a, null , c)\r\n    }\r\n    if (!this.getXHR) {\r\n        return new dhtmlx.ajax()\r\n    }\r\n    return this\r\n}\r\n;\r\ndhtmlx.ajax.prototype = {\r\n    getXHR: function() {\r\n        if (dhtmlx._isIE) {\r\n            return new ActiveXObject(\"Microsoft.xmlHTTP\")\r\n        } else {\r\n            return new XMLHttpRequest()\r\n        }\r\n    },\r\n    send: function(h, o, m) {\r\n        var c = this.getXHR();\r\n        if (typeof m == \"function\") {\r\n            m = [m]\r\n        }\r\n        if (typeof o == \"object\") {\r\n            var l = [];\r\n            for (var e in o) {\r\n                var n = o[e];\r\n                if (n === null  || n === dhtmlx.undefined) {\r\n                    n = \"\"\r\n                }\r\n                l.push(e + \"=\" + encodeURIComponent(n))\r\n            }\r\n            o = l.join(\"&\")\r\n        }\r\n        if (o && !this.post) {\r\n            h = h + (h.indexOf(\"?\") != -1 ? \"&\" : \"?\") + o;\r\n            o = null \r\n        }\r\n        c.open(this.post ? \"POST\" : \"GET\", h, !this._sync);\r\n        if (this.post) {\r\n            c.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\")\r\n        }\r\n        var g = this;\r\n        c.onreadystatechange = function() {\r\n            if (!c.readyState || c.readyState == 4) {\r\n                if (m && g) {\r\n                    for (var a = 0; a < m.length; a++) {\r\n                        if (m[a]) {\r\n                            m[a].call((g.master || g), c.responseText, c.responseXML, c)\r\n                        }\r\n                    }\r\n                }\r\n                g.master = null ;\r\n                m = g = null \r\n            }\r\n        }\r\n        ;\r\n        c.send(o || null );\r\n        return c\r\n    },\r\n    get: function(a, e, c) {\r\n        this.post = false;\r\n        return this.send(a, e, c)\r\n    },\r\n    post: function(a, e, c) {\r\n        this.post = true;\r\n        return this.send(a, e, c)\r\n    },\r\n    sync: function() {\r\n        this._sync = true;\r\n        return this\r\n    }\r\n};\r\ndhtmlx.AtomDataLoader = {\r\n    _init: function(a) {\r\n        this.data = {};\r\n        if (a) {\r\n            this._settings.datatype = a.datatype || \"json\";\r\n            this._after_init.push(this._load_when_ready)\r\n        }\r\n    },\r\n    _load_when_ready: function() {\r\n        this._ready_for_data = true;\r\n        if (this._settings.url) {\r\n            this.url_setter(this._settings.url)\r\n        }\r\n        if (this._settings.data) {\r\n            this.data_setter(this._settings.data)\r\n        }\r\n    },\r\n    url_setter: function(a) {\r\n        if (!this._ready_for_data) {\r\n            return a\r\n        }\r\n        this.load(a, this._settings.datatype);\r\n        return a\r\n    },\r\n    data_setter: function(a) {\r\n        if (!this._ready_for_data) {\r\n            return a\r\n        }\r\n        this.parse(a, this._settings.datatype);\r\n        return true\r\n    },\r\n    load: function(a, c) {\r\n        this.callEvent(\"onXLS\", []);\r\n        if (typeof c == \"string\") {\r\n            this.data.driver = dhtmlx.DataDriver[c];\r\n            c = arguments[2]\r\n        } else {\r\n            this.data.driver = dhtmlx.DataDriver[this._settings.datatype || \"xml\"]\r\n        }\r\n        if (window.dhx4) {\r\n            dhx4.ajax.get(a, dhtmlx.bind(function(g) {\r\n                var e = g.xmlDoc;\r\n                var l = e.responseText;\r\n                var h = e.responseXML;\r\n                if (this._onLoad) {\r\n                    this._onLoad.call(this, l, h, e)\r\n                }\r\n                if (c) {\r\n                    c.call(this, l, h, e)\r\n                }\r\n            }, this))\r\n        } else {\r\n            dhtmlx.ajax(a, [this._onLoad, c], this)\r\n        }\r\n    },\r\n    parse: function(c, a) {\r\n        this.callEvent(\"onXLS\", []);\r\n        this.data.driver = dhtmlx.DataDriver[a || \"xml\"];\r\n        this._onLoad(c, null )\r\n    },\r\n    _onLoad: function(h, c, a) {\r\n        var e = this.data.driver;\r\n        var g = e.getRecords(e.toObject(h, c))[0];\r\n        this.data = (e ? e.getDetails(g) : h);\r\n        this.callEvent(\"onXLE\", [])\r\n    },\r\n    _check_data_feed: function(c) {\r\n        if (!this._settings.dataFeed || this._ignore_feed || !c) {\r\n            return true\r\n        }\r\n        var a = this._settings.dataFeed;\r\n        if (typeof a == \"function\") {\r\n            return a.call(this, (c.id || c), c)\r\n        }\r\n        a = a + (a.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"action=get&id=\" + encodeURIComponent(c.id || c);\r\n        this.callEvent(\"onXLS\", []);\r\n        dhtmlx.ajax(a, function(g, e) {\r\n            this._ignore_feed = true;\r\n            this.setValues(dhtmlx.DataDriver.json.toObject(g)[0]);\r\n            this._ignore_feed = false;\r\n            this.callEvent(\"onXLE\", [])\r\n        }, this);\r\n        return false\r\n    }\r\n};\r\ndhtmlx.DataDriver = {};\r\ndhtmlx.DataDriver.json = {\r\n    toObject: function(data) {\r\n        if (!data) {\r\n            data = \"[]\"\r\n        }\r\n        if (typeof data == \"string\") {\r\n            eval(\"dhtmlx.temp=\" + data);\r\n            return dhtmlx.temp\r\n        }\r\n        return data\r\n    },\r\n    getRecords: function(a) {\r\n        if (a && a.data) {\r\n            a = a.data\r\n        }\r\n        if (a && !(a instanceof Array)) {\r\n            return [a]\r\n        }\r\n        return a\r\n    },\r\n    getDetails: function(a) {\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: (a.total_count || 0),\r\n            _from: (a.pos || 0),\r\n            _key: (a.dhx_security)\r\n        }\r\n    }\r\n};\r\ndhtmlx.DataDriver.json_ext = {\r\n    toObject: function(data) {\r\n        if (!data) {\r\n            data = \"[]\"\r\n        }\r\n        if (typeof data == \"string\") {\r\n            var temp;\r\n            eval(\"temp=\" + data);\r\n            dhtmlx.temp = [];\r\n            var header = temp.header;\r\n            for (var i = 0; i < temp.data.length; i++) {\r\n                var item = {};\r\n                for (var j = 0; j < header.length; j++) {\r\n                    if (typeof (temp.data[i][j]) != \"undefined\") {\r\n                        item[header[j]] = temp.data[i][j]\r\n                    }\r\n                }\r\n                dhtmlx.temp.push(item)\r\n            }\r\n            return dhtmlx.temp\r\n        }\r\n        return data\r\n    },\r\n    getRecords: function(a) {\r\n        if (a && !(a instanceof Array)) {\r\n            return [a]\r\n        }\r\n        return a\r\n    },\r\n    getDetails: function(a) {\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: (a.total_count || 0),\r\n            _from: (a.pos || 0)\r\n        }\r\n    }\r\n};\r\ndhtmlx.DataDriver.html = {\r\n    toObject: function(c) {\r\n        if (typeof c == \"string\") {\r\n            var a = null ;\r\n            if (c.indexOf(\"<\") == -1) {\r\n                a = dhtmlx.toNode(c)\r\n            }\r\n            if (!a) {\r\n                a = document.createElement(\"DIV\");\r\n                a.innerHTML = c\r\n            }\r\n            return a.getElementsByTagName(this.tag)\r\n        }\r\n        return c\r\n    },\r\n    getRecords: function(a) {\r\n        if (a.tagName) {\r\n            return a.childNodes\r\n        }\r\n        return a\r\n    },\r\n    getDetails: function(a) {\r\n        return dhtmlx.DataDriver.xml.tagToObject(a)\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    },\r\n    tag: \"LI\"\r\n};\r\ndhtmlx.DataDriver.jsarray = {\r\n    toObject: function(data) {\r\n        if (typeof data == \"string\") {\r\n            eval(\"dhtmlx.temp=\" + data);\r\n            return dhtmlx.temp\r\n        }\r\n        return data\r\n    },\r\n    getRecords: function(a) {\r\n        return a\r\n    },\r\n    getDetails: function(e) {\r\n        var a = {};\r\n        for (var c = 0; c < e.length; c++) {\r\n            a[\"data\" + c] = e[c]\r\n        }\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    }\r\n};\r\ndhtmlx.DataDriver.csv = {\r\n    toObject: function(a) {\r\n        return a\r\n    },\r\n    getRecords: function(a) {\r\n        return a.split(this.row)\r\n    },\r\n    getDetails: function(e) {\r\n        e = this.stringToArray(e);\r\n        var a = {};\r\n        for (var c = 0; c < e.length; c++) {\r\n            a[\"data\" + c] = e[c]\r\n        }\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    },\r\n    stringToArray: function(c) {\r\n        c = c.split(this.cell);\r\n        for (var a = 0; a < c.length; a++) {\r\n            c[a] = c[a].replace(/^[ \\t\\n\\r]*(\\\"|)/g, \"\").replace(/(\\\"|)[ \\t\\n\\r]*$/g, \"\")\r\n        }\r\n        return c\r\n    },\r\n    row: \"\\n\",\r\n    cell: \",\"\r\n};\r\ndhtmlx.DataDriver.xml = {\r\n    toObject: function(c, a) {\r\n        if (a && (a = this.checkResponse(c, a))) {\r\n            return a\r\n        }\r\n        if (typeof c == \"string\") {\r\n            return this.fromString(c)\r\n        }\r\n        return c\r\n    },\r\n    getRecords: function(a) {\r\n        return this.xpath(a, this.records)\r\n    },\r\n    records: \"/*/item\",\r\n    getDetails: function(a) {\r\n        return this.tagToObject(a, {})\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: (a.documentElement.getAttribute(\"total_count\") || 0),\r\n            _from: (a.documentElement.getAttribute(\"pos\") || 0),\r\n            _key: (a.documentElement.getAttribute(\"dhx_security\"))\r\n        }\r\n    },\r\n    xpath: function(h, r) {\r\n        if (window.XPathResult) {\r\n            var g = h;\r\n            if (h.nodeName.indexOf(\"document\") == -1) {\r\n                h = h.ownerDocument\r\n            }\r\n            var n = [];\r\n            var c = h.evaluate(r, g, null , XPathResult.ANY_TYPE, null );\r\n            var o = c.iterateNext();\r\n            while (o) {\r\n                n.push(o);\r\n                o = c.iterateNext()\r\n            }\r\n            return n\r\n        } else {\r\n            var m = true;\r\n            try {\r\n                if (typeof (h.selectNodes) == \"undefined\") {\r\n                    m = false\r\n                }\r\n            } catch (l) {}\r\n            if (m) {\r\n                return h.selectNodes(r)\r\n            } else {\r\n                var a = r.split(\"/\").pop();\r\n                return h.getElementsByTagName(a)\r\n            }\r\n        }\r\n    },\r\n    tagToObject: function(e, o) {\r\n        o = o || {};\r\n        var h = false;\r\n        var g = e.attributes;\r\n        if (g && g.length) {\r\n            for (var m = 0; m < g.length; m++) {\r\n                o[g[m].name] = g[m].value\r\n            }\r\n            h = true\r\n        }\r\n        var c = e.childNodes;\r\n        var n = {};\r\n        for (var m = 0; m < c.length; m++) {\r\n            if (c[m].nodeType == 1) {\r\n                var l = c[m].tagName;\r\n                if (typeof o[l] != \"undefined\") {\r\n                    if (!(o[l] instanceof Array)) {\r\n                        o[l] = [o[l]]\r\n                    }\r\n                    o[l].push(this.tagToObject(c[m], {}))\r\n                } else {\r\n                    o[c[m].tagName] = this.tagToObject(c[m], {})\r\n                }\r\n                h = true\r\n            }\r\n        }\r\n        if (!h) {\r\n            return this.nodeValue(e)\r\n        }\r\n        o.value = this.nodeValue(e);\r\n        return o\r\n    },\r\n    nodeValue: function(a) {\r\n        if (a.firstChild) {\r\n            return a.firstChild.wholeText || a.firstChild.data\r\n        }\r\n        return \"\"\r\n    },\r\n    fromString: function(c) {\r\n        if (window.DOMParser && !dhtmlx._isIE) {\r\n            return (new DOMParser()).parseFromString(c, \"text/xml\")\r\n        }\r\n        if (window.ActiveXObject) {\r\n            var a = new ActiveXObject(\"Microsoft.xmlDOM\");\r\n            a.loadXML(c);\r\n            return a\r\n        }\r\n        dhtmlx.error(\"Load from xml string is not supported\")\r\n    },\r\n    checkResponse: function(g, e) {\r\n        if (e && (e.firstChild && e.firstChild.tagName != \"parsererror\")) {\r\n            return e\r\n        }\r\n        var c = this.fromString(g.replace(/^[\\s]+/, \"\"));\r\n        if (c) {\r\n            return c\r\n        }\r\n        dhtmlx.error(\"xml can't be parsed\", g)\r\n    }\r\n};\r\ndhtmlx.DataLoader = {\r\n    _init: function(a) {\r\n        a = a || \"\";\r\n        this.name = \"DataStore\";\r\n        this.data = (a.datastore) || (new dhtmlx.DataStore());\r\n        this._readyHandler = this.data.attachEvent(\"onStoreLoad\", dhtmlx.bind(this._call_onready, this))\r\n    },\r\n    load: function(a, c) {\r\n        dhtmlx.AtomDataLoader.load.apply(this, arguments);\r\n        if (!this.data.feed) {\r\n            this.data.feed = function(g, e) {\r\n                if (this._load_count) {\r\n                    return this._load_count = [g, e]\r\n                } else {\r\n                    this._load_count = true\r\n                }\r\n                this.load(a + ((a.indexOf(\"?\") == -1) ? \"?\" : \"&\") + \"posStart=\" + g + \"&count=\" + e, function() {\r\n                    var h = this._load_count;\r\n                    this._load_count = false;\r\n                    if (typeof h == \"object\") {\r\n                        this.data.feed.apply(this, h)\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    },\r\n    _onLoad: function(e, c, a) {\r\n        this.data._parse(this.data.driver.toObject(e, c));\r\n        this.callEvent(\"onXLE\", []);\r\n        if (this._readyHandler) {\r\n            this.data.detachEvent(this._readyHandler);\r\n            this._readyHandler = null \r\n        }\r\n    },\r\n    dataFeed_setter: function(a) {\r\n        this.data.attachEvent(\"onBeforeFilter\", dhtmlx.bind(function(m, l) {\r\n            if (this._settings.dataFeed) {\r\n                var h = {};\r\n                if (!m && !h) {\r\n                    return\r\n                }\r\n                if (typeof m == \"function\") {\r\n                    if (!l) {\r\n                        return\r\n                    }\r\n                    m(l, h)\r\n                } else {\r\n                    h = {\r\n                        text: l\r\n                    }\r\n                }\r\n                this.clearAll();\r\n                var c = this._settings.dataFeed;\r\n                if (typeof c == \"function\") {\r\n                    return c.call(this, l, h)\r\n                }\r\n                var g = [];\r\n                for (var e in h) {\r\n                    g.push(\"dhx_filter[\" + e + \"]=\" + encodeURIComponent(h[e]))\r\n                }\r\n                this.load(c + (c.indexOf(\"?\") < 0 ? \"?\" : \"&\") + g.join(\"&\"), this._settings.datatype);\r\n                return false\r\n            }\r\n        }, this));\r\n        return a\r\n    },\r\n    _call_onready: function() {\r\n        if (this._settings.ready) {\r\n            var a = dhtmlx.toFunctor(this._settings.ready);\r\n            if (a && a.call) {\r\n                a.apply(this, arguments)\r\n            }\r\n        }\r\n    }\r\n};\r\ndhtmlx.DataStore = function() {\r\n    this.name = \"DataStore\";\r\n    dhtmlx.extend(this, dhtmlx.EventSystem);\r\n    this.setDriver(\"xml\");\r\n    this.pull = {};\r\n    this.order = dhtmlx.toArray()\r\n}\r\n;\r\ndhtmlx.DataStore.prototype = {\r\n    setDriver: function(a) {\r\n        dhtmlx.assert(dhtmlx.DataDriver[a], \"incorrect DataDriver\");\r\n        this.driver = dhtmlx.DataDriver[a]\r\n    },\r\n    _parse: function(h) {\r\n        this.callEvent(\"onParse\", [this.driver, h]);\r\n        if (this._filter_order) {\r\n            this.filter()\r\n        }\r\n        var l = this.driver.getInfo(h);\r\n        if (l._key) {\r\n            dhtmlx.security_key = l._key\r\n        }\r\n        var g = this.driver.getRecords(h);\r\n        var n = (l._from || 0) * 1;\r\n        if (n === 0 && this.order[0]) {\r\n            n = this.order.length\r\n        }\r\n        var c = 0;\r\n        for (var e = 0; e < g.length; e++) {\r\n            var a = this.driver.getDetails(g[e]);\r\n            var m = this.id(a);\r\n            if (!this.pull[m]) {\r\n                this.order[c + n] = m;\r\n                c++\r\n            }\r\n            this.pull[m] = a;\r\n            if (this.extraParser) {\r\n                this.extraParser(a)\r\n            }\r\n            if (this._scheme) {\r\n                if (this._scheme.$init) {\r\n                    this._scheme.$update(a)\r\n                } else {\r\n                    if (this._scheme.$update) {\r\n                        this._scheme.$update(a)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (var e = 0; e < l._size; e++) {\r\n            if (!this.order[e]) {\r\n                var m = dhtmlx.uid();\r\n                var a = {\r\n                    id: m,\r\n                    $template: \"loading\"\r\n                };\r\n                this.pull[m] = a;\r\n                this.order[e] = m\r\n            }\r\n        }\r\n        this.callEvent(\"onStoreLoad\", [this.driver, h]);\r\n        this.refresh()\r\n    },\r\n    id: function(a) {\r\n        return a.id || (a.id = dhtmlx.uid())\r\n    },\r\n    changeId: function(c, a) {\r\n        dhtmlx.assert(this.pull[c], \"Can't change id, for non existing item: \" + c);\r\n        this.pull[a] = this.pull[c];\r\n        this.pull[a].id = a;\r\n        this.order[this.order.find(c)] = a;\r\n        if (this._filter_order) {\r\n            this._filter_order[this._filter_order.find(c)] = a\r\n        }\r\n        this.callEvent(\"onIdChange\", [c, a]);\r\n        if (this._render_change_id) {\r\n            this._render_change_id(c, a)\r\n        }\r\n    },\r\n    get: function(a) {\r\n        return this.item(a)\r\n    },\r\n    set: function(c, a) {\r\n        return this.update(c, a)\r\n    },\r\n    item: function(a) {\r\n        return this.pull[a]\r\n    },\r\n    update: function(c, a) {\r\n        if (this._scheme && this._scheme.$update) {\r\n            this._scheme.$update(a)\r\n        }\r\n        if (this.callEvent(\"onBeforeUpdate\", [c, a]) === false) {\r\n            return false\r\n        }\r\n        this.pull[c] = a;\r\n        this.refresh(c)\r\n    },\r\n    refresh: function(a) {\r\n        if (this._skip_refresh) {\r\n            return\r\n        }\r\n        if (a) {\r\n            this.callEvent(\"onStoreUpdated\", [a, this.pull[a], \"update\"])\r\n        } else {\r\n            this.callEvent(\"onStoreUpdated\", [null , null , null ])\r\n        }\r\n    },\r\n    silent: function(a) {\r\n        this._skip_refresh = true;\r\n        a.call(this);\r\n        this._skip_refresh = false\r\n    },\r\n    getRange: function(g, e) {\r\n        if (g) {\r\n            g = this.indexById(g)\r\n        } else {\r\n            g = this.startOffset || 0\r\n        }\r\n        if (e) {\r\n            e = this.indexById(e)\r\n        } else {\r\n            e = Math.min((this.endOffset || Infinity), (this.dataCount() - 1));\r\n            if (e < 0) {\r\n                e = 0\r\n            }\r\n        }\r\n        if (g > e) {\r\n            var c = e;\r\n            e = g;\r\n            g = c\r\n        }\r\n        return this.getIndexRange(g, e)\r\n    },\r\n    getIndexRange: function(g, e) {\r\n        e = Math.min((e || Infinity), this.dataCount() - 1);\r\n        var a = dhtmlx.toArray();\r\n        for (var c = (g || 0); c <= e; c++) {\r\n            a.push(this.item(this.order[c]))\r\n        }\r\n        return a\r\n    },\r\n    dataCount: function() {\r\n        return this.order.length\r\n    },\r\n    exists: function(a) {\r\n        return !!(this.pull[a])\r\n    },\r\n    move: function(a, g) {\r\n        if (a < 0 || g < 0) {\r\n            dhtmlx.error(\"DataStore::move\", \"Incorrect indexes\");\r\n            return\r\n        }\r\n        var e = this.idByIndex(a);\r\n        var c = this.item(e);\r\n        this.order.removeAt(a);\r\n        this.order.insertAt(e, Math.min(this.order.length, g));\r\n        this.callEvent(\"onStoreUpdated\", [e, c, \"move\"])\r\n    },\r\n    scheme: function(a) {\r\n        this._scheme = a\r\n    },\r\n    sync: function(h, g, a) {\r\n        if (typeof g != \"function\") {\r\n            a = g;\r\n            g = null \r\n        }\r\n        if (dhtmlx.debug_bind) {\r\n            this.debug_sync_master = h;\r\n            dhtmlx.log(\"[sync] \" + this.debug_bind_master.name + \"@\" + this.debug_bind_master._settings.id + \" <= \" + this.debug_sync_master.name + \"@\" + this.debug_sync_master._settings.id)\r\n        }\r\n        var e = h;\r\n        if (h.name != \"DataStore\") {\r\n            h = h.data\r\n        }\r\n        var c = dhtmlx.bind(function(n, l, m) {\r\n            if (m != \"update\" || g) {\r\n                n = null \r\n            }\r\n            if (!n) {\r\n                this.order = dhtmlx.toArray([].concat(h.order));\r\n                this._filter_order = null ;\r\n                this.pull = h.pull;\r\n                if (g) {\r\n                    this.silent(g)\r\n                }\r\n                if (this._on_sync) {\r\n                    this._on_sync()\r\n                }\r\n            }\r\n            if (dhtmlx.debug_bind) {\r\n                dhtmlx.log(\"[sync:request] \" + this.debug_sync_master.name + \"@\" + this.debug_sync_master._settings.id + \" <= \" + this.debug_bind_master.name + \"@\" + this.debug_bind_master._settings.id)\r\n            }\r\n            if (!a) {\r\n                this.refresh(n)\r\n            } else {\r\n                a = false\r\n            }\r\n        }, this);\r\n        h.attachEvent(\"onStoreUpdated\", c);\r\n        this.feed = function(m, l) {\r\n            e.loadNext(l, m)\r\n        }\r\n        ;\r\n        c()\r\n    },\r\n    add: function(h, a) {\r\n        if (this._scheme) {\r\n            h = h || {};\r\n            for (var c in this._scheme) {\r\n                h[c] = h[c] || this._scheme[c]\r\n            }\r\n            if (this._scheme) {\r\n                if (this._scheme.$init) {\r\n                    this._scheme.$update(h)\r\n                } else {\r\n                    if (this._scheme.$update) {\r\n                        this._scheme.$update(h)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var l = this.id(h);\r\n        var g = this.dataCount();\r\n        if (dhtmlx.isNotDefined(a) || a < 0) {\r\n            a = g\r\n        }\r\n        if (a > g) {\r\n            dhtmlx.log(\"Warning\", \"DataStore:add\", \"Index of out of bounds\");\r\n            a = Math.min(this.order.length, a)\r\n        }\r\n        if (this.callEvent(\"onBeforeAdd\", [l, h, a]) === false) {\r\n            return false\r\n        }\r\n        if (this.exists(l)) {\r\n            return dhtmlx.error(\"Not unique ID\")\r\n        }\r\n        this.pull[l] = h;\r\n        this.order.insertAt(l, a);\r\n        if (this._filter_order) {\r\n            var e = this._filter_order.length;\r\n            if (!a && this.order.length) {\r\n                e = 0\r\n            }\r\n            this._filter_order.insertAt(l, e)\r\n        }\r\n        this.callEvent(\"onafterAdd\", [l, a]);\r\n        this.callEvent(\"onStoreUpdated\", [l, h, \"add\"]);\r\n        return l\r\n    },\r\n    remove: function(e) {\r\n        if (e instanceof Array) {\r\n            for (var a = 0; a < e.length; a++) {\r\n                this.remove(e[a])\r\n            }\r\n            return\r\n        }\r\n        if (this.callEvent(\"onBeforeDelete\", [e]) === false) {\r\n            return false\r\n        }\r\n        if (!this.exists(e)) {\r\n            return dhtmlx.error(\"Not existing ID\", e)\r\n        }\r\n        var c = this.item(e);\r\n        this.order.remove(e);\r\n        if (this._filter_order) {\r\n            this._filter_order.remove(e)\r\n        }\r\n        delete this.pull[e];\r\n        this.callEvent(\"onafterdelete\", [e]);\r\n        this.callEvent(\"onStoreUpdated\", [e, c, \"delete\"])\r\n    },\r\n    clearAll: function() {\r\n        this.pull = {};\r\n        this.order = dhtmlx.toArray();\r\n        this.feed = null ;\r\n        this._filter_order = null ;\r\n        this.callEvent(\"onClearAll\", []);\r\n        this.refresh()\r\n    },\r\n    idByIndex: function(a) {\r\n        if (a >= this.order.length || a < 0) {\r\n            dhtmlx.log(\"Warning\", \"DataStore::idByIndex Incorrect index\")\r\n        }\r\n        return this.order[a]\r\n    },\r\n    indexById: function(c) {\r\n        var a = this.order.find(c);\r\n        return a\r\n    },\r\n    next: function(c, a) {\r\n        return this.order[this.indexById(c) + (a || 1)]\r\n    },\r\n    first: function() {\r\n        return this.order[0]\r\n    },\r\n    last: function() {\r\n        return this.order[this.order.length - 1]\r\n    },\r\n    previous: function(c, a) {\r\n        return this.order[this.indexById(c) - (a || 1)]\r\n    },\r\n    sort: function(l, c, a) {\r\n        var e = l;\r\n        if (typeof l == \"function\") {\r\n            e = {\r\n                as: l,\r\n                dir: c\r\n            }\r\n        } else {\r\n            if (typeof l == \"string\") {\r\n                e = {\r\n                    by: l,\r\n                    dir: c,\r\n                    as: a\r\n                }\r\n            }\r\n        }\r\n        var h = [e.by, e.dir, e.as];\r\n        if (!this.callEvent(\"onbeforesort\", h)) {\r\n            return\r\n        }\r\n        if (this.order.length) {\r\n            var m = dhtmlx.sort.create(e);\r\n            var g = this.getRange(this.first(), this.last());\r\n            g.sort(m);\r\n            this.order = g.map(function(n) {\r\n                return this.id(n)\r\n            }, this)\r\n        }\r\n        this.refresh();\r\n        this.callEvent(\"onaftersort\", h)\r\n    },\r\n    filter: function(h, g) {\r\n        if (!this.callEvent(\"onBeforeFilter\", [h, g])) {\r\n            return\r\n        }\r\n        if (this._filter_order) {\r\n            this.order = this._filter_order;\r\n            delete this._filter_order\r\n        }\r\n        if (!this.order.length) {\r\n            return\r\n        }\r\n        if (h) {\r\n            var c = h;\r\n            g = g || \"\";\r\n            if (typeof h == \"string\") {\r\n                h = dhtmlx.Template.fromHTML(h);\r\n                g = g.toString().toLowerCase();\r\n                c = function(n, m) {\r\n                    return h(n).toLowerCase().indexOf(m) != -1\r\n                }\r\n            }\r\n            var e = dhtmlx.toArray();\r\n            for (var a = 0; a < this.order.length; a++) {\r\n                var l = this.order[a];\r\n                if (c(this.item(l), g)) {\r\n                    e.push(l)\r\n                }\r\n            }\r\n            this._filter_order = this.order;\r\n            this.order = e\r\n        }\r\n        this.refresh();\r\n        this.callEvent(\"onAfterFilter\", [])\r\n    },\r\n    each: function(e, c) {\r\n        for (var a = 0; a < this.order.length; a++) {\r\n            e.call((c || this), this.item(this.order[a]))\r\n        }\r\n    },\r\n    provideApi: function(g, c) {\r\n        this.debug_bind_master = g;\r\n        if (c) {\r\n            this.mapEvent({\r\n                onbeforesort: g,\r\n                onaftersort: g,\r\n                onbeforeadd: g,\r\n                onafteradd: g,\r\n                onbeforedelete: g,\r\n                onafterdelete: g,\r\n                onbeforeupdate: g\r\n            })\r\n        }\r\n        var e = [\"get\", \"set\", \"sort\", \"add\", \"remove\", \"exists\", \"idByIndex\", \"indexById\", \"item\", \"update\", \"refresh\", \"dataCount\", \"filter\", \"next\", \"previous\", \"clearAll\", \"first\", \"last\", \"serialize\"];\r\n        for (var a = 0; a < e.length; a++) {\r\n            g[e[a]] = dhtmlx.methodPush(this, e[a])\r\n        }\r\n        if (dhtmlx.assert_enabled()) {\r\n            this.assert_event(g)\r\n        }\r\n    },\r\n    serialize: function() {\r\n        var e = this.order;\r\n        var a = [];\r\n        for (var c = 0; c < e.length; c++) {\r\n            a.push(this.pull[e[c]])\r\n        }\r\n        return a\r\n    }\r\n};\r\ndhtmlx.sort = {\r\n    create: function(a) {\r\n        return dhtmlx.sort.dir(a.dir, dhtmlx.sort.by(a.by, a.as))\r\n    },\r\n    as: {\r\n        \"int\": function(e, c) {\r\n            e = e * 1;\r\n            c = c * 1;\r\n            return e > c ? 1 : (e < c ? -1 : 0)\r\n        },\r\n        string_strict: function(e, c) {\r\n            e = e.toString();\r\n            c = c.toString();\r\n            return e > c ? 1 : (e < c ? -1 : 0)\r\n        },\r\n        string: function(e, c) {\r\n            e = e.toString().toLowerCase();\r\n            c = c.toString().toLowerCase();\r\n            return e > c ? 1 : (e < c ? -1 : 0)\r\n        }\r\n    },\r\n    by: function(c, a) {\r\n        if (!c) {\r\n            return a\r\n        }\r\n        if (typeof a != \"function\") {\r\n            a = dhtmlx.sort.as[a || \"string\"]\r\n        }\r\n        c = dhtmlx.Template.fromHTML(c);\r\n        return function(g, e) {\r\n            return a(c(g), c(e))\r\n        }\r\n    },\r\n    dir: function(c, a) {\r\n        if (c == \"asc\") {\r\n            return a\r\n        }\r\n        return function(g, e) {\r\n            return a(g, e) * -1\r\n        }\r\n    }\r\n};\r\ndhtmlx.KeyEvents = {\r\n    _init: function() {\r\n        dhtmlx.event(this._obj, \"keypress\", this._onKeyPress, this)\r\n    },\r\n    _onKeyPress: function(c) {\r\n        c = c || event;\r\n        var a = c.which || c.keyCode;\r\n        this.callEvent((this._edit_id ? \"onEditKeyPress\" : \"onKeyPress\"), [a, c.ctrlKey, c.shiftKey, c])\r\n    }\r\n};\r\ndhtmlx.MouseEvents = {\r\n    _init: function() {\r\n        if (this.on_click) {\r\n            dhtmlx.event(this._obj, \"click\", this._onClick, this);\r\n            dhtmlx.event(this._obj, \"contextmenu\", this._onContext, this)\r\n        }\r\n        if (this.on_dblclick) {\r\n            dhtmlx.event(this._obj, \"dblclick\", this._onDblClick, this)\r\n        }\r\n        if (this.on_mouse_move) {\r\n            dhtmlx.event(this._obj, \"mousemove\", this._onMouse, this);\r\n            dhtmlx.event(this._obj, (dhtmlx._isIE ? \"mouseleave\" : \"mouseout\"), this._onMouse, this)\r\n        }\r\n    },\r\n    _onClick: function(a) {\r\n        return this._mouseEvent(a, this.on_click, \"ItemClick\")\r\n    },\r\n    _onDblClick: function(a) {\r\n        return this._mouseEvent(a, this.on_dblclick, \"ItemDblClick\")\r\n    },\r\n    _onContext: function(a) {\r\n        var c = dhtmlx.html.locate(a, this._id);\r\n        if (c && !this.callEvent(\"onBeforeContextMenu\", [c, a])) {\r\n            return dhtmlx.html.preventEvent(a)\r\n        }\r\n    },\r\n    _onMouse: function(a) {\r\n        if (dhtmlx._isIE) {\r\n            a = document.createEventObject(event)\r\n        }\r\n        if (this._mouse_move_timer) {\r\n            window.clearTimeout(this._mouse_move_timer)\r\n        }\r\n        this.callEvent(\"onMouseMoving\", [a]);\r\n        this._mouse_move_timer = window.setTimeout(dhtmlx.bind(function() {\r\n            if (a.type == \"mousemove\") {\r\n                this._onMouseMove(a)\r\n            } else {\r\n                this._onMouseOut(a)\r\n            }\r\n        }, this), 500)\r\n    },\r\n    _onMouseMove: function(a) {\r\n        if (!this._mouseEvent(a, this.on_mouse_move, \"MouseMove\")) {\r\n            this.callEvent(\"onMouseOut\", [a || event])\r\n        }\r\n    },\r\n    _onMouseOut: function(a) {\r\n        this.callEvent(\"onMouseOut\", [a || event])\r\n    },\r\n    _mouseEvent: function(m, l, c) {\r\n        m = m || event;\r\n        var a = m.target || m.srcElement;\r\n        var g = \"\";\r\n        var n = null ;\r\n        var h = false;\r\n        while (a && a.parentNode) {\r\n            if (!h && a.getAttribute) {\r\n                n = a.getAttribute(this._id);\r\n                if (n) {\r\n                    if (a.getAttribute(\"userdata\")) {\r\n                        this.callEvent(\"onLocateData\", [n, a, m])\r\n                    }\r\n                    if (!this.callEvent(\"on\" + c, [n, m, a])) {\r\n                        return\r\n                    }\r\n                    h = true\r\n                }\r\n            }\r\n            g = a.className;\r\n            if (g) {\r\n                g = g.split(\" \");\r\n                g = g[0] || g[1];\r\n                if (l[g]) {\r\n                    return l[g].call(this, m, n || dhtmlx.html.locate(m, this._id), a)\r\n                }\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        return h\r\n    }\r\n};\r\ndhtmlx.Settings = {\r\n    _init: function() {\r\n        this._settings = this.config = {}\r\n    },\r\n    define: function(c, a) {\r\n        if (typeof c == \"object\") {\r\n            return this._parseSeetingColl(c)\r\n        }\r\n        return this._define(c, a)\r\n    },\r\n    _define: function(c, a) {\r\n        dhtmlx.assert_settings.call(this, c, a);\r\n        var e = this[c + \"_setter\"];\r\n        return this._settings[c] = e ? e.call(this, a) : a\r\n    },\r\n    _parseSeetingColl: function(e) {\r\n        if (e) {\r\n            for (var c in e) {\r\n                this._define(c, e[c])\r\n            }\r\n        }\r\n    },\r\n    _parseSettings: function(e, a) {\r\n        var c = dhtmlx.extend({}, a);\r\n        if (typeof e == \"object\" && !e.tagName) {\r\n            dhtmlx.extend(c, e)\r\n        }\r\n        this._parseSeetingColl(c)\r\n    },\r\n    _mergeSettings: function(a, e) {\r\n        for (var c in e) {\r\n            switch (typeof a[c]) {\r\n            case \"object\":\r\n                a[c] = this._mergeSettings((a[c] || {}), e[c]);\r\n                break;\r\n            case \"undefined\":\r\n                a[c] = e[c];\r\n                break;\r\n            default:\r\n                break\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    _parseContainer: function(c, a, e) {\r\n        if (typeof c == \"object\" && !c.tagName) {\r\n            c = c.container\r\n        }\r\n        this._obj = this.$view = dhtmlx.toNode(c);\r\n        if (!this._obj && e) {\r\n            this._obj = e(c)\r\n        }\r\n        dhtmlx.assert(this._obj, \"Incorrect html container\");\r\n        this._obj.className += \" \" + a;\r\n        this._obj.onselectstart = function() {\r\n            return false\r\n        }\r\n        ;\r\n        this._dataobj = this._obj\r\n    },\r\n    _set_type: function(a) {\r\n        if (typeof a == \"object\") {\r\n            return this.type_setter(a)\r\n        }\r\n        dhtmlx.assert(this.types, \"RenderStack :: Types are not defined\");\r\n        dhtmlx.assert(this.types[a], \"RenderStack :: Inccorect type name\", a);\r\n        this.type = dhtmlx.extend({}, this.types[a]);\r\n        this.customize()\r\n    },\r\n    customize: function(a) {\r\n        if (a) {\r\n            dhtmlx.extend(this.type, a)\r\n        }\r\n        this.type._item_start = dhtmlx.Template.fromHTML(this.template_item_start(this.type));\r\n        this.type._item_end = this.template_item_end(this.type);\r\n        this.render()\r\n    },\r\n    type_setter: function(a) {\r\n        this._set_type(typeof a == \"object\" ? dhtmlx.Type.add(this, a) : a);\r\n        return a\r\n    },\r\n    template_setter: function(a) {\r\n        return this.type_setter({\r\n            template: a\r\n        })\r\n    },\r\n    css_setter: function(a) {\r\n        this._obj.className += \" \" + a;\r\n        return a\r\n    }\r\n};\r\ndhtmlx.Template = {\r\n    _cache: {},\r\n    empty: function() {\r\n        return \"\"\r\n    },\r\n    setter: function(a) {\r\n        return dhtmlx.Template.fromHTML(a)\r\n    },\r\n    obj_setter: function(c) {\r\n        var a = dhtmlx.Template.setter(c);\r\n        var e = this;\r\n        return function() {\r\n            return a.apply(e, arguments)\r\n        }\r\n    },\r\n    fromHTML: function(a) {\r\n        if (typeof a == \"function\") {\r\n            return a\r\n        }\r\n        if (this._cache[a]) {\r\n            return this._cache[a]\r\n        }\r\n        a = (a || \"\").toString();\r\n        a = a.replace(/[\\r\\n]+/g, \"\\\\n\");\r\n        a = a.replace(/\\{obj\\.([^}?]+)\\?([^:]*):([^}]*)\\}/g, '\"+(obj.$1?\"$2\":\"$3\")+\"');\r\n        a = a.replace(/\\{common\\.([^}\\(]*)\\}/g, '\"+common.$1+\"');\r\n        a = a.replace(/\\{common\\.([^\\}\\(]*)\\(\\)\\}/g, '\"+(common.$1?common.$1(obj):\"\")+\"');\r\n        a = a.replace(/\\{obj\\.([^}]*)\\}/g, '\"+obj.$1+\"');\r\n        a = a.replace(/#([a-z0-9_]+)#/gi, '\"+obj.$1+\"');\r\n        a = a.replace(/\\{obj\\}/g, '\"+obj+\"');\r\n        a = a.replace(/\\{-obj/g, \"{obj\");\r\n        a = a.replace(/\\{-common/g, \"{common\");\r\n        a = 'return \"' + a + '\";';\r\n        return this._cache[a] = Function(\"obj\", \"common\", a)\r\n    }\r\n};\r\ndhtmlx.Type = {\r\n    add: function(e, c) {\r\n        if (!e.types && e.prototype.types) {\r\n            e = e.prototype\r\n        }\r\n        if (dhtmlx.assert_enabled()) {\r\n            this.assert_event(c)\r\n        }\r\n        var a = c.name || \"default\";\r\n        this._template(c);\r\n        this._template(c, \"edit\");\r\n        this._template(c, \"loading\");\r\n        e.types[a] = dhtmlx.extend(dhtmlx.extend({}, (e.types[a] || this._default)), c);\r\n        return a\r\n    },\r\n    _default: {\r\n        css: \"default\",\r\n        template: function() {\r\n            return \"\"\r\n        },\r\n        template_edit: function() {\r\n            return \"\"\r\n        },\r\n        template_loading: function() {\r\n            return \"...\"\r\n        },\r\n        width: 150,\r\n        height: 80,\r\n        margin: 5,\r\n        padding: 0\r\n    },\r\n    _template: function(e, a) {\r\n        a = \"template\" + (a ? (\"_\" + a) : \"\");\r\n        var c = e[a];\r\n        if (c && (typeof c == \"string\")) {\r\n            if (c.indexOf(\"->\") != -1) {\r\n                c = c.split(\"->\");\r\n                switch (c[0]) {\r\n                case \"html\":\r\n                    c = dhtmlx.html.getValue(c[1]).replace(/\\\"/g, '\\\\\"');\r\n                    break;\r\n                case \"http\":\r\n                    c = new dhtmlx.ajax().sync().get(c[1], {\r\n                        uid: (new Date()).valueOf()\r\n                    }).responseText;\r\n                    break;\r\n                default:\r\n                    break\r\n                }\r\n            }\r\n            e[a] = dhtmlx.Template.fromHTML(c)\r\n        }\r\n    }\r\n};\r\ndhtmlx.SingleRender = {\r\n    _init: function() {},\r\n    _toHTML: function(a) {\r\n        return this.type._item_start(a, this.type) + this.type.template(a, this.type) + this.type._item_end\r\n    },\r\n    render: function() {\r\n        if (!this.callEvent || this.callEvent(\"onBeforeRender\", [this.data])) {\r\n            if (this.data) {\r\n                this._dataobj.innerHTML = this._toHTML(this.data)\r\n            }\r\n            if (this.callEvent) {\r\n                this.callEvent(\"onAfterRender\", [])\r\n            }\r\n        }\r\n    }\r\n};\r\ndhtmlx.ui.Tooltip = function(a) {\r\n    this.name = \"Tooltip\";\r\n    if (dhtmlx.assert_enabled()) {\r\n        this._assert()\r\n    }\r\n    if (typeof a == \"string\") {\r\n        a = {\r\n            template: a\r\n        }\r\n    }\r\n    dhtmlx.extend(this, dhtmlx.Settings);\r\n    dhtmlx.extend(this, dhtmlx.SingleRender);\r\n    this._parseSettings(a, {\r\n        type: \"default\",\r\n        dy: 0,\r\n        dx: 20\r\n    });\r\n    this._dataobj = this._obj = document.createElement(\"DIV\");\r\n    this._obj.className = \"dhx_tooltip\";\r\n    dhtmlx.html.insertBefore(this._obj, document.body.firstChild)\r\n}\r\n;\r\ndhtmlx.ui.Tooltip.prototype = {\r\n    show: function(a, c) {\r\n        if (this._disabled) {\r\n            return\r\n        }\r\n        if (this.data != a) {\r\n            this.data = a;\r\n            this.render(a)\r\n        }\r\n        this._obj.style.top = c.y + this._settings.dy + \"px\";\r\n        this._obj.style.left = c.x + this._settings.dx + \"px\";\r\n        this._obj.style.display = \"block\"\r\n    },\r\n    hide: function() {\r\n        this.data = null ;\r\n        this._obj.style.display = \"none\"\r\n    },\r\n    disable: function() {\r\n        this._disabled = true\r\n    },\r\n    enable: function() {\r\n        this._disabled = false\r\n    },\r\n    types: {\r\n        \"default\": dhtmlx.Template.fromHTML(\"{obj.id}\")\r\n    },\r\n    template_item_start: dhtmlx.Template.empty,\r\n    template_item_end: dhtmlx.Template.empty\r\n};\r\ndhtmlx.AutoTooltip = {\r\n    tooltip_setter: function(c) {\r\n        var a = new dhtmlx.ui.Tooltip(c);\r\n        this.attachEvent(\"onMouseMove\", function(h, g) {\r\n            a.show(this.get(h), dhtmlx.html.pos(g))\r\n        });\r\n        this.attachEvent(\"onMouseOut\", function(h, g) {\r\n            a.hide()\r\n        });\r\n        this.attachEvent(\"onMouseMoving\", function(h, g) {\r\n            a.hide()\r\n        });\r\n        return a\r\n    }\r\n};\r\ndhtmlx.compat = function(a, c) {\r\n    if (dhtmlx.compat[a]) {\r\n        dhtmlx.compat[a](c)\r\n    }\r\n}\r\n;\r\nif (!dhtmlx.attaches) {\r\n    dhtmlx.attaches = {}\r\n}\r\ndhtmlx.attaches.attachAbstract = function(c, a) {\r\n    var h = document.createElement(\"DIV\");\r\n    h.id = \"CustomObject_\" + dhtmlx.uid();\r\n    h.style.width = \"100%\";\r\n    h.style.height = \"100%\";\r\n    h.cmp = \"grid\";\r\n    document.body.appendChild(h);\r\n    this.attachObject(h.id);\r\n    a.container = h.id;\r\n    var g = this.vs[this.av];\r\n    g.grid = new window[c](a);\r\n    g.gridId = h.id;\r\n    g.gridObj = h;\r\n    g.grid.setSizes = function() {\r\n        if (this.resize) {\r\n            this.resize()\r\n        } else {\r\n            this.render()\r\n        }\r\n    }\r\n    ;\r\n    var e = \"_viewRestore\";\r\n    return this.vs[this[e]()].grid\r\n}\r\n;\r\ndhtmlx.attaches.attachDataView = function(a) {\r\n    return this.attachAbstract(\"dhtmlXDataView\", a)\r\n}\r\n;\r\ndhtmlx.attaches.attachChart = function(a) {\r\n    return this.attachAbstract(\"dhtmlXChart\", a)\r\n}\r\n;\r\ndhtmlx.compat.layout = function() {}\r\n;\r\nfunction dhtmlXCellObject(e, a) {\r\n    this.cell = document.createElement(\"DIV\");\r\n    this.cell.className = \"dhx_cell\" + (a || \"\");\r\n    this._idd = e;\r\n    this._isCell = true;\r\n    this.conf = {\r\n        borders: true,\r\n        idx: {},\r\n        css: a || \"\",\r\n        idx_data: {\r\n            cont: \"dhx_cell_cont\",\r\n            pr1: \"dhx_cell_progress_bar\",\r\n            pr2: \"dhx_cell_progress_img\",\r\n            menu: \"dhx_cell_menu\",\r\n            toolbar: \"dhx_cell_toolbar\",\r\n            ribbon: \"dhx_cell_ribbon\",\r\n            sb: \"dhx_cell_statusbar\",\r\n            cover: \"dhx_cell_cover\"\r\n        },\r\n        ofs_nodes: {\r\n            t: {},\r\n            b: {}\r\n        }\r\n    };\r\n    this.dataNodes = {};\r\n    this.views = {};\r\n    var c = document.createElement(\"DIV\");\r\n    c.className = \"dhx_cell_cont\" + this.conf.css;\r\n    this.cell.appendChild(c);\r\n    c = null ;\r\n    this._updateIdx = function() {\r\n        for (var g in this.conf.idx) {\r\n            this.conf.idx[g] = null ;\r\n            delete this.conf.idx[g]\r\n        }\r\n        for (var m = 0; m < this.cell.childNodes.length; m++) {\r\n            var h = this.cell.childNodes[m].className;\r\n            for (var g in this.conf.idx_data) {\r\n                var l = new RegExp(this.conf.idx_data[g]);\r\n                if (h.match(l) != null ) {\r\n                    this.conf.idx[g] = m\r\n                }\r\n            }\r\n        }\r\n        this.callEvent(\"_onIdxUpdated\", [])\r\n    }\r\n    ;\r\n    this._adjustAttached = function() {\r\n        for (var g in this.dataNodes) {\r\n            if (this.dataNodes[g] != null  && typeof (this.dataNodes[g].setSizes) == \"function\") {\r\n                this.dataNodes[g].setSizes()\r\n            }\r\n        }\r\n        if (this.dataObj != null  && typeof (this.dataObj.setSizes) == \"function\") {\r\n            if (this.dataType == \"layout\" && typeof (window.dhtmlXLayoutCell) == \"function\" && this instanceof window.dhtmlXLayoutCell && this.dataObj._getMainInst() != this.layout._getMainInst()) {\r\n                this.dataObj.setSizes();\r\n                return\r\n            }\r\n            this.dataObj.setSizes.apply(this.dataObj, arguments)\r\n        }\r\n    }\r\n    ;\r\n    this._setSize = function(v, s, A, n, o, r, l, m) {\r\n        if (this.conf.size == null ) {\r\n            this.conf.size = {}\r\n        }\r\n        if (m == null ) {\r\n            m = {}\r\n        }\r\n        var C = {\r\n            left: \"x\",\r\n            top: \"y\",\r\n            width: \"w\",\r\n            height: \"h\"\r\n        };\r\n        this.conf.size.x = v;\r\n        this.conf.size.y = s;\r\n        this.conf.size.w = Math.max(A, 0);\r\n        this.conf.size.h = Math.max(n, 0);\r\n        for (var u in C) {\r\n            var g = (m[u] || u);\r\n            this.cell.style[g] = this.conf.size[C[u]] + \"px\"\r\n        }\r\n        this.callEvent(\"_onSetSize\", []);\r\n        if (r !== true) {\r\n            this._adjustCont(o, l)\r\n        } else {\r\n            this._adjustAttached(o)\r\n        }\r\n        this._adjustProgress()\r\n    }\r\n    ;\r\n    this._adjustCont = function(o, m) {\r\n        var n = this.cell.childNodes[this.conf.idx.cont];\r\n        if (typeof (window.dhtmlXLayoutCell) == \"function\" && this instanceof window.dhtmlXLayoutCell && this.conf.collapsed == true) {\r\n            n.style.left = n.style.top = \"0px\";\r\n            n.style.width = n.style.height = \"200px\";\r\n            n = null ;\r\n            return\r\n        }\r\n        var l = 0;\r\n        for (var g in this.conf.ofs_nodes.t) {\r\n            var h = this.conf.ofs_nodes.t[g];\r\n            l += (h == \"func\" ? this[g]() : (h == true ? this.cell.childNodes[this.conf.idx[g]].offsetHeight : 0))\r\n        }\r\n        var r = 0;\r\n        for (var g in this.conf.ofs_nodes.b) {\r\n            var h = this.conf.ofs_nodes.b[g];\r\n            r += (h == \"func\" ? this[g]() : (h == true ? this.cell.childNodes[this.conf.idx[g]].offsetHeight : 0))\r\n        }\r\n        n.style.left = \"0px\";\r\n        n.style.top = l + \"px\";\r\n        if (this.conf.cells_cont == null ) {\r\n            this.conf.cells_cont = {};\r\n            n.style.width = this.cell.offsetWidth + \"px\";\r\n            n.style.height = Math.max(this.cell.offsetHeight - l - r, 0) + \"px\";\r\n            this.conf.cells_cont.w = parseInt(n.style.width) - n.offsetWidth;\r\n            this.conf.cells_cont.h = parseInt(n.style.height) - n.offsetHeight\r\n        }\r\n        n.style.left = \"0px\";\r\n        n.style.top = l + \"px\";\r\n        n.style.width = Math.max(this.cell.offsetWidth + this.conf.cells_cont.w, 0) + \"px\";\r\n        n.style.height = Math.max(this.conf.size.h - l - r + this.conf.cells_cont.h, 0) + \"px\";\r\n        n = null ;\r\n        this._adjustAttached(o);\r\n        if (m == \"expand\" && this.dataType == \"editor\" && this.dataObj != null ) {\r\n            this.dataObj._prepareContent(true)\r\n        }\r\n    }\r\n    ;\r\n    this._mtbUpdBorder = function() {\r\n        var h = [\"menu\", \"toolbar\", \"ribbon\"];\r\n        for (var m = 0; m < h.length; m++) {\r\n            if (this.conf.idx[h[m]] != null ) {\r\n                var n = this.cell.childNodes[this.conf.idx[h[m]]];\r\n                var l = \"dhx_cell_\" + h[m] + \"_no_borders\";\r\n                var g = \"dhx_cell_\" + h[m] + \"_def\";\r\n                n.className = n.className.replace(new RegExp(this.conf.borders ? l : g), this.conf.borders ? g : l);\r\n                n = null \r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._resetSizeState = function() {\r\n        this.conf.cells_cont = null \r\n    }\r\n    ;\r\n    this.conf.view = \"def\";\r\n    this.conf.views_loaded = {};\r\n    this.conf.views_loaded[this.conf.view] = true;\r\n    this._viewSave = function(l) {\r\n        this.views[l] = {\r\n            borders: this.conf.borders,\r\n            ofs_nodes: {\r\n                t: {},\r\n                b: {}\r\n            },\r\n            url_data: this.conf.url_data,\r\n            dataType: this.dataType,\r\n            dataObj: this.dataObj,\r\n            cellCont: [],\r\n            dataNodes: {},\r\n            dataNodesCont: {}\r\n        };\r\n        var m = this.cell.childNodes[this.conf.idx.cont];\r\n        while (m.childNodes.length > 0) {\r\n            this.views[l].cellCont.push(m.firstChild);\r\n            m.removeChild(m.firstChild)\r\n        }\r\n        m = null ;\r\n        this.dataType = null ;\r\n        this.dataObj = null ;\r\n        this.conf.url_data = null ;\r\n        for (var h in this.dataNodes) {\r\n            for (var g in this.conf.ofs_nodes) {\r\n                if (typeof (this.conf.ofs_nodes[g][h]) != \"undefined\") {\r\n                    this.views[l].ofs_nodes[g][h] = this.conf.ofs_nodes[g][h];\r\n                    this.conf.ofs_nodes[g][h] = null ;\r\n                    delete this.conf.ofs_nodes[g][h]\r\n                }\r\n            }\r\n            this.views[l].dataNodesCont[h] = this.cell.childNodes[this.conf.idx[h]];\r\n            this.cell.removeChild(this.cell.childNodes[this.conf.idx[h]]);\r\n            this.views[l].dataNodes[h] = this.dataNodes[h];\r\n            this.dataNodes[h] = null ;\r\n            delete this.dataNodes[h];\r\n            this._updateIdx()\r\n        }\r\n        this.callEvent(\"_onViewSave\", [l])\r\n    }\r\n    ;\r\n    this._viewRestore = function(l) {\r\n        if (this.views[l] == null ) {\r\n            return\r\n        }\r\n        this.dataObj = this.views[l].dataObj;\r\n        this.dataType = this.views[l].dataType;\r\n        this.conf.url_data = this.views[l].url_data;\r\n        for (var m = 0; m < this.views[l].cellCont.length; m++) {\r\n            this.cell.childNodes[this.conf.idx.cont].appendChild(this.views[l].cellCont[m])\r\n        }\r\n        for (var h in this.views[l].dataNodes) {\r\n            this.dataNodes[h] = this.views[l].dataNodes[h];\r\n            if (h == \"menu\") {\r\n                this.cell.insertBefore(this.views[l].dataNodesCont[h], this.cell.childNodes[this.conf.idx.toolbar || this.conf.idx.cont])\r\n            }\r\n            if (h == \"toolbar\") {\r\n                this.cell.insertBefore(this.views[l].dataNodesCont[h], this.cell.childNodes[this.conf.idx.cont])\r\n            }\r\n            if (h == \"ribbon\") {\r\n                this.cell.insertBefore(this.views[l].dataNodesCont[h], this.cell.childNodes[this.conf.idx.cont])\r\n            }\r\n            if (h == \"sb\") {\r\n                this.cell.appendChild(this.views[l].dataNodesCont[h])\r\n            }\r\n            this._updateIdx()\r\n        }\r\n        for (var h in this.views[l].ofs_nodes) {\r\n            for (var g in this.views[l].ofs_nodes[h]) {\r\n                this.conf.ofs_nodes[h][g] = this.views[l].ofs_nodes[h][g]\r\n            }\r\n        }\r\n        if (this.conf.borders != this.views[l].borders) {\r\n            this[this.views[l].borders ? \"_showBorders\" : \"_hideBorders\"](true)\r\n        }\r\n        if (this.dataType == \"url\" && this.conf.url_data != null  && this.conf.url_data.ajax == false && this.conf.url_data.post_data != null ) {\r\n            this.reloadURL()\r\n        }\r\n        this.callEvent(\"_onViewRestore\", [l]);\r\n        this._viewDelete(l)\r\n    }\r\n    ;\r\n    this._viewDelete = function(l) {\r\n        if (this.views[l] == null ) {\r\n            return\r\n        }\r\n        this.views[l].borders = null ;\r\n        for (var h in this.views[l].ofs_nodes) {\r\n            for (var g in this.views[l].ofs_nodes[h]) {\r\n                this.views[l].ofs_nodes[h][g] = null \r\n            }\r\n            this.views[l].ofs_nodes[h] = null \r\n        }\r\n        this.views[l].dataType = null ;\r\n        this.views[l].dataObj = null ;\r\n        this.views[l].url_data = null ;\r\n        for (var m = 0; m < this.views[l].cellCont.length; m++) {\r\n            this.views[l].cellCont[m] = null \r\n        }\r\n        this.views[l].cellCont = null ;\r\n        for (var h in this.views[l].dataNodes) {\r\n            this.views[l].dataNodes[h] = null ;\r\n            this.views[l].dataNodesCont[h] = null \r\n        }\r\n        this.views[l].dataNodes = this.views[l].dataNodesCont = null ;\r\n        this.views[l] = null ;\r\n        delete this.views[l]\r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    this._updateIdx();\r\n    return this\r\n}\r\ndhtmlXCellObject.prototype.showView = function(a) {\r\n    if (this.conf.view == a) {\r\n        return false\r\n    }\r\n    this._viewSave(this.conf.view);\r\n    this._viewRestore(a);\r\n    this._updateIdx();\r\n    this._adjustCont();\r\n    this.conf.view = a;\r\n    var c = (typeof (this.conf.views_loaded[this.conf.view]) == \"undefined\");\r\n    this.conf.views_loaded[this.conf.view] = true;\r\n    return c\r\n}\r\n;\r\ndhtmlXCellObject.prototype.getViewName = function() {\r\n    return this.conf.view\r\n}\r\n;\r\ndhtmlXCellObject.prototype.unloadView = function(g) {\r\n    if (g == this.conf.view) {\r\n        var h = this.conf.unloading;\r\n        this.conf.unloading = true;\r\n        if (typeof (this.detachMenu) == \"function\") {\r\n            this.detachMenu()\r\n        }\r\n        if (typeof (this.detachToolbar) == \"function\") {\r\n            this.detachToolbar()\r\n        }\r\n        if (typeof (this.detachRibbon) == \"function\") {\r\n            this.detachRibbon()\r\n        }\r\n        this.detachStatusBar();\r\n        this._detachObject(null , true);\r\n        this.conf.unloading = h;\r\n        if (!this.conf.unloading) {\r\n            this._adjustCont(this._idd)\r\n        }\r\n        return\r\n    }\r\n    if (this.views[g] == null ) {\r\n        return\r\n    }\r\n    var e = this.views[g];\r\n    for (var c in e.dataNodes) {\r\n        if (typeof (e.dataNodes[c].unload) == \"function\") {\r\n            e.dataNodes[c].unload()\r\n        }\r\n        e.dataNodes[c] = null ;\r\n        e.dataNodesCont[c] = null \r\n    }\r\n    if (e.dataType == \"url\") {\r\n        if (e.cellCont != null  && e.cellCont[0] != \"null\") {\r\n            this._detachURLEvents(e.cellCont[0])\r\n        }\r\n    } else {\r\n        if (e.dataObj != null ) {\r\n            if (typeof (e.dataObj.unload) == \"function\") {\r\n                e.dataObj.unload()\r\n            } else {\r\n                if (typeof (e.dataObj.destructor) == \"function\") {\r\n                    e.dataObj.destructor()\r\n                }\r\n            }\r\n            e.dataObj = null \r\n        }\r\n    }\r\n    e = null ;\r\n    this._viewDelete(g);\r\n    if (typeof (this.conf.views_loaded[g]) != \"undefined\") {\r\n        delete this.conf.views_loaded[g]\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype.getId = function() {\r\n    return this._idd\r\n}\r\n;\r\ndhtmlXCellObject.prototype.progressOn = function() {\r\n    if (this.conf.progress == true) {\r\n        return\r\n    }\r\n    this.conf.progress = true;\r\n    var c = document.createElement(\"DIV\");\r\n    c.className = this.conf.idx_data.pr1;\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = this.conf.idx_data.pr2;\r\n    if (this.conf.idx.cover != null ) {\r\n        this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cover])\r\n    } else {\r\n        this.cell.appendChild(a)\r\n    }\r\n    this.cell.insertBefore(c, a);\r\n    c = a = null ;\r\n    this._updateIdx();\r\n    this._adjustProgress()\r\n}\r\n;\r\ndhtmlXCellObject.prototype.progressOff = function() {\r\n    if (this.conf.progress != true) {\r\n        return\r\n    }\r\n    this.cell.childNodes[this.conf.idx.pr2].parentNode.removeChild(this.cell.childNodes[this.conf.idx.pr2]);\r\n    this.cell.childNodes[this.conf.idx.pr1].parentNode.removeChild(this.cell.childNodes[this.conf.idx.pr1]);\r\n    this.conf.progress = false;\r\n    this._updateIdx()\r\n}\r\n;\r\ndhtmlXCellObject.prototype._adjustProgress = function() {\r\n    if (this.conf.idx.pr1 == null ) {\r\n        return\r\n    }\r\n    if (!this.conf.pr) {\r\n        this.conf.pr = {}\r\n    }\r\n    var c = this.cell.childNodes[this.conf.idx.pr1];\r\n    var a = this.cell.childNodes[this.conf.idx.pr2];\r\n    if (!this.conf.pr.ofs) {\r\n        a.style.width = c.offsetWidth + \"px\";\r\n        a.style.height = c.offsetHeight + \"px\";\r\n        this.conf.pr.ofs = {\r\n            w: a.offsetWidth - a.clientWidth,\r\n            h: a.offsetHeight - a.clientHeight\r\n        }\r\n    }\r\n    a.style.width = c.offsetWidth - this.conf.pr.ofs.w + \"px\";\r\n    a.style.height = c.offsetHeight - this.conf.pr.ofs.h + \"px\";\r\n    c = a = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype._showCellCover = function() {\r\n    if (this.conf.cover == true) {\r\n        return\r\n    }\r\n    this.conf.cover = true;\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = this.conf.idx_data.cover;\r\n    this.cell.appendChild(a);\r\n    a = null ;\r\n    this._updateIdx()\r\n}\r\n;\r\ndhtmlXCellObject.prototype._hideCellCover = function() {\r\n    if (this.conf.cover != true) {\r\n        return\r\n    }\r\n    this.cell.removeChild(this.cell.childNodes[this.conf.idx.cover]);\r\n    this._updateIdx();\r\n    this.conf.cover = false\r\n}\r\n;\r\ndhtmlXCellObject.prototype._showBorders = function(a) {\r\n    if (this.conf.borders) {\r\n        return\r\n    }\r\n    this.conf.borders = true;\r\n    this.cell.childNodes[this.conf.idx.cont].className = \"dhx_cell_cont\" + this.conf.css;\r\n    this.conf.cells_cont = null ;\r\n    this._mtbUpdBorder();\r\n    this.callEvent(\"_onBorderChange\", [true]);\r\n    if (a !== true) {\r\n        this._adjustCont(this._idd)\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype._hideBorders = function(a) {\r\n    if (!this.conf.borders) {\r\n        return\r\n    }\r\n    this.conf.borders = false;\r\n    this.cell.childNodes[this.conf.idx.cont].className = \"dhx_cell_cont\" + this.conf.css + \" dhx_cell_cont_no_borders\";\r\n    this.conf.cells_cont = null ;\r\n    this._mtbUpdBorder();\r\n    this.callEvent(\"_onBorderChange\", [false]);\r\n    if (a !== true) {\r\n        this._adjustCont(this._idd)\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype._getWidth = function() {\r\n    return this.cell.offsetWidth\r\n}\r\n;\r\ndhtmlXCellObject.prototype._getHeight = function() {\r\n    return this.cell.offsetHeight\r\n}\r\n;\r\ndhtmlXCellObject.prototype.showInnerScroll = function() {\r\n    this.cell.childNodes[this.conf.idx.cont].style.overflow = \"auto\"\r\n}\r\n;\r\ndhtmlXCellObject.prototype._unload = function() {\r\n    this.conf.unloading = true;\r\n    this.callEvent(\"_onCellUnload\", []);\r\n    this.progressOff();\r\n    this.unloadView(this.conf.view);\r\n    this.dataNodes = null ;\r\n    this.cell.parentNode.removeChild(this.cell);\r\n    this.cell = null ;\r\n    window.dhx4._eventable(this, \"clear\");\r\n    for (var c in this.views) {\r\n        this.unloadView(c)\r\n    }\r\n    this.conf = null ;\r\n    for (var c in this) {\r\n        this[c] = null \r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachObject = function(g, e) {\r\n    if (window.dhx4.s2b(e) && !(typeof (window.dhtmlXWindowsCell) == \"function\" && this instanceof window.dhtmlXWindowsCell)) {\r\n        e = false\r\n    }\r\n    if (typeof (g) == \"string\") {\r\n        g = document.getElementById(g)\r\n    }\r\n    if (g.parentNode == this.cell.childNodes[this.conf.idx.cont]) {\r\n        g = null ;\r\n        return\r\n    }\r\n    if (e) {\r\n        g.style.display = \"\";\r\n        var a = g.offsetWidth;\r\n        var c = g.offsetHeight\r\n    }\r\n    this._attachObject(g);\r\n    this.dataType = \"obj\";\r\n    g.style.display = \"\";\r\n    g = null ;\r\n    if (e) {\r\n        this._adjustByCont(a, c)\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype.appendObject = function(a) {\r\n    if (typeof (a) == \"string\") {\r\n        a = document.getElementById(a)\r\n    }\r\n    if (a.parentNode == this.cell.childNodes[this.conf.idx.cont]) {\r\n        a = null ;\r\n        return\r\n    }\r\n    if (!this.conf.append_mode) {\r\n        this.cell.childNodes[this.conf.idx.cont].style.overflow = \"auto\";\r\n        this.conf.append_mode = true\r\n    }\r\n    this._attachObject(a, null , null , true);\r\n    this.dataType = \"obj\";\r\n    a.style.display = \"\";\r\n    a = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype.detachObject = function(c, a) {\r\n    this._detachObject(null , c, a)\r\n}\r\n;\r\ndhtmlXCellObject.prototype.getAttachedStatusBar = function() {\r\n    return this.dataNodes.sb\r\n}\r\n;\r\ndhtmlXCellObject.prototype.getAttachedObject = function() {\r\n    if (this.dataType == \"obj\" || this.dataType == \"url\" || this.dataType == \"url-ajax\") {\r\n        return this.cell.childNodes[this.conf.idx.cont].firstChild\r\n    } else {\r\n        return this.dataObj\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachURL = function(c, r, e) {\r\n    if (e == true) {\r\n        e = {}\r\n    }\r\n    var g = (typeof (e) != \"undefined\" && e != false && e != null );\r\n    if (!this.conf.url_data) {\r\n        this.conf.url_data = {}\r\n    }\r\n    this.conf.url_data.url = c;\r\n    this.conf.url_data.ajax = (r == true);\r\n    this.conf.url_data.post_data = (e == true ? {} : (e || null ));\r\n    if (r == true) {\r\n        var o = this;\r\n        if (g) {\r\n            var h = \"\";\r\n            for (var n in e) {\r\n                h += \"&\" + encodeURIComponent(n) + \"=\" + encodeURIComponent(e[n])\r\n            }\r\n            dhx4.ajax.post(c, h, function(a) {\r\n                o.attachHTMLString(\"<div style='position:relative;width:100%;height:100%;overflow:auto;'>\" + a.xmlDoc.responseText + \"</div>\");\r\n                if (typeof (o._doOnFrameContentLoaded) == \"function\") {\r\n                    o._doOnFrameContentLoaded()\r\n                }\r\n                o.dataType = \"url-ajax\";\r\n                o = a = null \r\n            })\r\n        } else {\r\n            dhx4.ajax.get(c, function(a) {\r\n                o.attachHTMLString(\"<div style='position:relative;width:100%;height:100%;overflow:auto;'>\" + a.xmlDoc.responseText + \"</div>\");\r\n                if (typeof (o._doOnFrameContentLoaded) == \"function\") {\r\n                    o._doOnFrameContentLoaded()\r\n                }\r\n                o.dataType = \"url-ajax\";\r\n                o = a = null \r\n            })\r\n        }\r\n    } else {\r\n        if (this.dataType == \"url\") {\r\n            var l = this.getFrame()\r\n        } else {\r\n            var l = document.createElement(\"IFRAME\");\r\n            l.frameBorder = 0;\r\n            l.border = 0;\r\n            l.style.width = \"100%\";\r\n            l.style.height = \"100%\";\r\n            l.style.position = \"relative\";\r\n            this._attachObject(l);\r\n            this.dataType = \"url\";\r\n            this._attachURLEvents()\r\n        }\r\n        if (g) {\r\n            var m = (typeof (this.conf.url_data.post_ifr) == \"undefined\");\r\n            this.conf.url_data.post_ifr = true;\r\n            if (m) {\r\n                this._attachURLEvents()\r\n            }\r\n            l.src = \"about:blank\"\r\n        } else {\r\n            l.src = c + window.dhx4.ajax._dhxr(c)\r\n        }\r\n        l = null \r\n    }\r\n    l = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype.reloadURL = function() {\r\n    if (!(this.dataType == \"url\" || this.dataType == \"url-ajax\")) {\r\n        return\r\n    }\r\n    if (this.conf.url_data == null ) {\r\n        return\r\n    }\r\n    this.attachURL(this.conf.url_data.url, this.conf.url_data.ajax, this.conf.url_data.post_data)\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachHTMLString = function(str) {\r\n    this._attachObject(null , null , str);\r\n    var z = str.match(/<script[^>]*>[^\\f]*?<\\/script>/g) || [];\r\n    for (var i = 0; i < z.length; i++) {\r\n        var s = z[i].replace(/<([\\/]{0,1})script[^>]*>/gi, \"\");\r\n        if (s) {\r\n            if (window.execScript) {\r\n                window.execScript(s)\r\n            } else {\r\n                window.eval(s)\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachScheduler = function(a, m, c, g) {\r\n    g = g || window.scheduler;\r\n    var h = false;\r\n    if (c) {\r\n        var l = document.getElementById(c);\r\n        if (l) {\r\n            h = true\r\n        }\r\n    }\r\n    if (!h) {\r\n        var e = c || '<div class=\"dhx_cal_tab\" name=\"day_tab\" style=\"right:204px;\"></div><div class=\"dhx_cal_tab\" name=\"week_tab\" style=\"right:140px;\"></div><div class=\"dhx_cal_tab\" name=\"month_tab\" style=\"right:76px;\"></div>';\r\n        var l = document.createElement(\"DIV\");\r\n        l.id = \"dhxSchedObj_\" + new Date().getTime();\r\n        l.style.width = \"100%\";\r\n        l.style.height = \"100%\";\r\n        l.style.position = \"relative\";\r\n        l.style.overflow = \"hidden\";\r\n        l.className = \"dhx_cal_container\";\r\n        l.innerHTML = '<div class=\"dhx_cal_navline\"><div class=\"dhx_cal_prev_button\">&nbsp;</div><div class=\"dhx_cal_next_button\">&nbsp;</div><div class=\"dhx_cal_today_button\"></div><div class=\"dhx_cal_date\"></div>' + e + '</div><div class=\"dhx_cal_header\"></div><div class=\"dhx_cal_data\"></div>'\r\n    }\r\n    this._attachObject(l);\r\n    this.dataType = \"scheduler\";\r\n    this.dataObj = g;\r\n    this.dataObj.setSizes = function() {\r\n        this.update_view()\r\n    }\r\n    ;\r\n    g.init(l.id, a, m);\r\n    l = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachMap = function(a) {\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.width = \"100%\";\r\n    c.style.height = \"100%\";\r\n    c.style.position = \"relative\";\r\n    c.style.overflow = \"hidden\";\r\n    this._attachObject(c);\r\n    if (!a) {\r\n        a = {\r\n            center: new google.maps.LatLng(40.719837,-73.992348),\r\n            zoom: 11,\r\n            mapTypeId: google.maps.MapTypeId.ROADMAP\r\n        }\r\n    }\r\n    this.dataType = \"maps\";\r\n    this.dataObj = new google.maps.Map(c,a);\r\n    this.dataObj.setSizes = function() {\r\n        google.maps.event.trigger(this, \"resize\")\r\n    }\r\n    ;\r\n    c = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\ndhtmlXCellObject.prototype._createNode_sb = function(n, g, m, a, l) {\r\n    if (typeof (l) != \"undefined\") {\r\n        n = l\r\n    } else {\r\n        var c = g || {};\r\n        var o = (typeof (c.text) == \"string\" && c.text.length > 0 ? c.text : \"&nbsp;\");\r\n        var e = (typeof (c.height) == \"number\" ? c.height : false);\r\n        var n = document.createElement(\"DIV\");\r\n        n.className = \"dhx_cell_statusbar_def\";\r\n        n.innerHTML = \"<div class='\" + (c.paging == true ? \"dhx_cell_statusbar_paging\" : \"dhx_cell_statusbar_text\") + \"'>\" + o + \"</div>\";\r\n        if (e != false) {\r\n            n.firstChild.style.height = n.firstChild.style.lineHeight = e + \"px\"\r\n        }\r\n    }\r\n    if (this.conf.idx.pr1 != null ) {\r\n        this.cell.insertBefore(n, this.cell.childNodes[this.conf.idx.pr1])\r\n    } else {\r\n        this.cell.appendChild(n)\r\n    }\r\n    this.conf.ofs_nodes.b.sb = true;\r\n    this._updateIdx();\r\n    this._adjustCont(this._idd);\r\n    return n\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachStatusBar = function(a) {\r\n    if (this.dataNodes.sb) {\r\n        return\r\n    }\r\n    if (a != null  && window.dhx4.s2b(a.paging) == true) {\r\n        a.height = null \r\n    }\r\n    if (this.conf.skin == \"dhx_skyblue\" && typeof (window.dhtmlXWindowsCell) == \"function\" && this instanceof window.dhtmlXWindowsCell) {\r\n        this.cell.childNodes[this.conf.idx.cont].className += \" dhx_cell_statusbar_attached\"\r\n    }\r\n    this.dataNodes.sb = this._attachObject(\"sb\", a);\r\n    this.dataNodes.sb.setText = function(c) {\r\n        this.childNodes[0].innerHTML = c\r\n    }\r\n    ;\r\n    this.dataNodes.sb.getText = function() {\r\n        return this.childNodes[0].innerHTML\r\n    }\r\n    ;\r\n    this.dataNodes.sb.onselectstart = function(c) {\r\n        return false\r\n    }\r\n    ;\r\n    return this.dataNodes.sb\r\n}\r\n;\r\ndhtmlXCellObject.prototype.detachStatusBar = function() {\r\n    if (!this.dataNodes.sb) {\r\n        return\r\n    }\r\n    if (this.conf.skin == \"dhx_skyblue\" && typeof (window.dhtmlXWindowsCell) == \"function\" && this instanceof window.dhtmlXWindowsCell) {\r\n        this.cell.childNodes[this.conf.idx.cont].className = this.cell.childNodes[this.conf.idx.cont].className.replace(/\\s{0,}dhx_cell_statusbar_attached/, \"\")\r\n    }\r\n    this.dataNodes.sb.setText = this.dataNodes.sb.getText = this.dataNodes.sb.onselectstart = null ;\r\n    this.dataNodes.sb = null ;\r\n    delete this.dataNodes.sb;\r\n    this._detachObject(\"sb\")\r\n}\r\n;\r\ndhtmlXCellObject.prototype.showStatusBar = function() {\r\n    this._mtbShowHide(\"sb\", \"\")\r\n}\r\n;\r\ndhtmlXCellObject.prototype.hideStatusBar = function() {\r\n    this._mtbShowHide(\"sb\", \"none\")\r\n}\r\n;\r\ndhtmlXCellObject.prototype._mtbShowHide = function(c, a) {\r\n    if (!this.dataNodes[c]) {\r\n        return\r\n    }\r\n    this.cell.childNodes[this.conf.idx[c]].style.display = a;\r\n    this._adjustCont()\r\n}\r\n;\r\ndhtmlXCellObject.prototype.getFrame = dhtmlXCellObject.prototype._getFrame = function() {\r\n    if (this.dataType != \"url\") {\r\n        return null \r\n    }\r\n    return this.cell.childNodes[this.conf.idx.cont].firstChild\r\n}\r\n;\r\ndhtmlXCellObject.prototype._attachURLEvents = function() {\r\n    if (this.dataType != \"url\") {\r\n        return\r\n    }\r\n    var e = this;\r\n    var c = this._idd;\r\n    var a = this.cell.childNodes[this.conf.idx.cont].firstChild;\r\n    if (typeof (this._doOnFrameMouseDown) != \"function\") {\r\n        this._doOnFrameMouseDown = function(g) {\r\n            e.callEvent(\"_onContentMouseDown\", [c, g || event])\r\n        }\r\n    }\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.onload = function() {\r\n            try {\r\n                if (typeof (e._doOnFrameMouseDown) == \"function\") {\r\n                    this.contentWindow.document.body.addEventListener(\"mousedown\", e._doOnFrameMouseDown, false)\r\n                }\r\n            } catch (g) {}\r\n            try {\r\n                if (typeof (e._doOnFrameContentLoaded) == \"function\") {\r\n                    e._doOnFrameContentLoaded()\r\n                }\r\n            } catch (g) {}\r\n        }\r\n    } else {\r\n        a.onreadystatechange = function(g) {\r\n            if (this.readyState == \"complete\") {\r\n                try {\r\n                    if (typeof (e._doOnFrameMouseDown) == \"function\") {\r\n                        this.contentWindow.document.body.attachEvent(\"onmousedown\", e._doOnFrameMouseDown)\r\n                    }\r\n                } catch (h) {}\r\n                try {\r\n                    if (typeof (e._doOnFrameContentLoaded) == \"function\") {\r\n                        e._doOnFrameContentLoaded()\r\n                    }\r\n                } catch (h) {}\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype._doOnFrameContentLoaded = function() {\r\n    if (this.conf.url_data.post_ifr == true) {\r\n        var l = this.getFrame().contentWindow.document;\r\n        var h = l.createElement(\"FORM\");\r\n        h.method = \"POST\";\r\n        h.action = this.conf.url_data.url;\r\n        l.body.appendChild(h);\r\n        var e = {};\r\n        if (window.dhx4.ajax.cache != true) {\r\n            e[\"dhxr\" + new Date().getTime()] = \"1\"\r\n        }\r\n        for (var c in this.conf.url_data.post_data) {\r\n            e[c] = this.conf.url_data.post_data[c]\r\n        }\r\n        for (var c in e) {\r\n            var g = l.createElement(\"INPUT\");\r\n            g.type = \"hidden\";\r\n            g.name = c;\r\n            g.value = e[c];\r\n            h.appendChild(g);\r\n            g = null \r\n        }\r\n        this.conf.url_data.post_ifr = false;\r\n        h.submit()\r\n    } else {\r\n        this.callEvent(\"_onContentLoaded\", [this._idd])\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype._detachURLEvents = function(a) {\r\n    if (a == null ) {\r\n        if (this.dataType != \"url\") {\r\n            return\r\n        }\r\n        a = this.cell.childNodes[this.conf.idx.cont].firstChild\r\n    }\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.onload = null ;\r\n        try {\r\n            a.contentWindow.document.body.removeEventListener(\"mousedown\", this._doOnFrameMouseDown, false)\r\n        } catch (c) {}\r\n    } else {\r\n        a.onreadystatechange = null ;\r\n        try {\r\n            a.contentWindow.document.body.detachEvent(\"onmousedown\", this._doOnFrameMouseDown)\r\n        } catch (c) {}\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype._attachObject = function(h, c, g, a, e) {\r\n    if (typeof (h) == \"string\" && {\r\n        menu: 1,\r\n        toolbar: 1,\r\n        ribbon: 1,\r\n        sb: 1\r\n    }[h] == 1) {\r\n        return this[\"_createNode_\" + h].apply(this, arguments)\r\n    }\r\n    if (a != true) {\r\n        this._detachObject(null , true, null )\r\n    }\r\n    if (typeof (g) == \"string\") {\r\n        this.cell.childNodes[this.conf.idx.cont].innerHTML = g\r\n    } else {\r\n        this.cell.childNodes[this.conf.idx.cont].appendChild(h)\r\n    }\r\n    h = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype._detachObject = function(h, c, a) {\r\n    this.callEvent(\"_onBeforeContentDetach\", []);\r\n    if (h == \"menu\" || h == \"toolbar\" || h == \"ribbon\" || h == \"sb\") {\r\n        var g = this.cell.childNodes[this.conf.idx[h]];\r\n        g.parentNode.removeChild(g);\r\n        g = null ;\r\n        this.conf.ofs_nodes[h == \"sb\" ? \"b\" : \"t\"][h] = false;\r\n        this._updateIdx();\r\n        if (!this.conf.unloading) {\r\n            this._adjustCont(this._idd)\r\n        }\r\n        return\r\n    }\r\n    if (c == true) {\r\n        a = false\r\n    } else {\r\n        if (typeof (a) == \"undefined\") {\r\n            a = document.body\r\n        } else {\r\n            if (typeof (a) == \"string\") {\r\n                a = document.getElementById(a)\r\n            }\r\n        }\r\n    }\r\n    if (a === false) {\r\n        if (this.dataType == \"url\") {\r\n            this._detachURLEvents()\r\n        } else {\r\n            if (this.dataObj != null ) {\r\n                if (typeof (this.dataObj.unload) == \"function\") {\r\n                    this.dataObj.unload()\r\n                } else {\r\n                    if (typeof (this.dataObj.destructor) == \"function\") {\r\n                        this.dataObj.destructor()\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    var g = this.cell.childNodes[this.conf.idx.cont];\r\n    while (g.childNodes.length > 0) {\r\n        if (a === false) {\r\n            g.removeChild(g.lastChild)\r\n        } else {\r\n            g.firstChild.style.display = \"none\";\r\n            a.appendChild(g.firstChild)\r\n        }\r\n    }\r\n    if (this.conf.append_mode) {\r\n        g.style.overflow = \"\";\r\n        this.conf.append_mode = false\r\n    }\r\n    var e = (this.dataType == \"tabbar\");\r\n    this.dataObj = null ;\r\n    this.dataType = null ;\r\n    a = g = null ;\r\n    if (this.conf.unloading != true && e) {\r\n        this.showHeader(true);\r\n        this._showBorders()\r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype._attachFromCell = function(c) {\r\n    this.detachObject(true);\r\n    var g = \"layout\";\r\n    if (typeof (window.dhtmlXWindowsCell) == \"function\" && this instanceof window.dhtmlXWindowsCell) {\r\n        g = \"window\"\r\n    }\r\n    if (typeof (window.dhtmlXWindowsCell) == \"function\" && c instanceof window.dhtmlXWindowsCell && c.wins.w[c._idd].conf.parked == true) {\r\n        c.wins._winCellSetOpacity(c._idd, \"open\", false)\r\n    }\r\n    if (typeof (window.dhtmlXAccordionCell) == \"function\" && c instanceof window.dhtmlXAccordionCell && c.conf.opened == false) {\r\n        c._cellSetOpacity(\"open\", false)\r\n    }\r\n    for (var e in c.dataNodes) {\r\n        this._attachObject(e, null , null , null , c.cell.childNodes[c.conf.idx[e]]);\r\n        this.dataNodes[e] = c.dataNodes[e];\r\n        c.dataNodes[e] = null ;\r\n        c.conf.ofs_nodes[e == \"sb\" ? \"b\" : \"t\"][e] = false;\r\n        c._updateIdx()\r\n    }\r\n    this._mtbUpdBorder();\r\n    if (c.dataType != null  && c.dataObj != null ) {\r\n        this.dataType = c.dataType;\r\n        this.dataObj = c.dataObj;\r\n        while (c.cell.childNodes[c.conf.idx.cont].childNodes.length > 0) {\r\n            this.cell.childNodes[this.conf.idx.cont].appendChild(c.cell.childNodes[c.conf.idx.cont].firstChild)\r\n        }\r\n        c.dataType = null ;\r\n        c.dataObj = null ;\r\n        if (this.dataType == \"grid\") {\r\n            if (g == \"window\" && this.conf.skin == \"dhx_skyblue\") {\r\n                this.dataObj.entBox.style.border = \"1px solid #a4bed4\";\r\n                this.dataObj._sizeFix = 0\r\n            } else {\r\n                this.dataObj.entBox.style.border = \"0px solid white\";\r\n                this.dataObj._sizeFix = 2\r\n            }\r\n        }\r\n    } else {\r\n        while (c.cell.childNodes[c.conf.idx.cont].childNodes.length > 0) {\r\n            this.cell.childNodes[this.conf.idx.cont].appendChild(c.cell.childNodes[c.conf.idx.cont].firstChild)\r\n        }\r\n    }\r\n    this.conf.view = c.conf.view;\r\n    c.conf.view = \"def\";\r\n    for (var e in c.views) {\r\n        this.views[e] = c.views[e];\r\n        c.views[e] = null ;\r\n        delete c.views[e]\r\n    }\r\n    c._updateIdx();\r\n    c._adjustCont();\r\n    this._updateIdx();\r\n    this._adjustCont();\r\n    if (c.conf.progress == true) {\r\n        c.progressOff();\r\n        this.progressOn()\r\n    } else {\r\n        this.progressOff()\r\n    }\r\n    if (g == \"window\" && this.wins.w[this._idd].conf.parked) {\r\n        this.wins._winCellSetOpacity(this._idd, \"close\", false)\r\n    }\r\n}\r\n;\r\nfunction dhtmlXCellTop(h, c) {\r\n    if (arguments.length == 0 || typeof (h) == \"undefined\") {\r\n        return\r\n    }\r\n    var a = this;\r\n    this.dataNodes = {};\r\n    this.conf.ofs = {\r\n        t: 0,\r\n        b: 0,\r\n        l: 0,\r\n        r: 0\r\n    };\r\n    this.conf.ofs_nodes = {\r\n        t: {},\r\n        b: {}\r\n    };\r\n    this.conf.progress = false;\r\n    this.conf.fs_mode = false;\r\n    this.conf.fs_tm = null ;\r\n    this.conf.fs_resize = false;\r\n    if (h == document.body) {\r\n        this.conf.fs_mode = true;\r\n        this.base = h;\r\n        if (this.base == document.body) {\r\n            var g = {\r\n                dhx_skyblue: {\r\n                    t: 2,\r\n                    b: 2,\r\n                    l: 2,\r\n                    r: 2\r\n                },\r\n                dhx_web: {\r\n                    t: 8,\r\n                    b: 8,\r\n                    l: 8,\r\n                    r: 8\r\n                },\r\n                dhx_terrace: {\r\n                    t: 9,\r\n                    b: 9,\r\n                    l: 8,\r\n                    r: 8\r\n                }\r\n            };\r\n            this.conf.ofs = (g[this.conf.skin] != null  ? g[this.conf.skin] : g.dhx_skyblue)\r\n        }\r\n    } else {\r\n        this.base = (typeof (h) == \"string\" ? document.getElementById(h) : h)\r\n    }\r\n    this.base.className += \" \" + this.conf.css + \"_base_\" + this.conf.skin;\r\n    this.cont = document.createElement(\"DIV\");\r\n    this.cont.className = this.conf.css + \"_cont\";\r\n    this.base.appendChild(this.cont);\r\n    if (c != null ) {\r\n        this.setOffsets(c, false)\r\n    } else {\r\n        if (this.base._ofs != null ) {\r\n            this.setOffsets(this.base._ofs, false);\r\n            this.base._ofs = null ;\r\n            try {\r\n                delete this.base._ofs\r\n            } catch (l) {}\r\n        }\r\n    }\r\n    this._adjustCont = function() {\r\n        var n = this.conf.ofs.t;\r\n        for (var m in this.conf.ofs_nodes.t) {\r\n            n += (this.conf.ofs_nodes.t[m] == true ? this.dataNodes[m].offsetHeight : 0)\r\n        }\r\n        var e = this.conf.ofs.b;\r\n        for (var m in this.conf.ofs_nodes.b) {\r\n            e += (this.conf.ofs_nodes.b[m] == true ? this.dataNodes[m].offsetHeight : 0)\r\n        }\r\n        this.cont.style.left = this.conf.ofs.l + \"px\";\r\n        this.cont.style.width = this.base.clientWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\";\r\n        this.cont.style.top = n + \"px\";\r\n        this.cont.style.height = this.base.clientHeight - n - e + \"px\"\r\n    }\r\n    ;\r\n    this._setBaseSkin = function(e) {\r\n        this.base.className = this.base.className.replace(new RegExp(this.conf.css + \"_base_\" + this.conf.skin,\"gi\"), this.conf.css + \"_base_\" + e)\r\n    }\r\n    ;\r\n    this._initFSResize = function() {\r\n        if (this.conf.fs_resize == true) {\r\n            return\r\n        }\r\n        this._doOnResizeStart = function() {\r\n            window.clearTimeout(a.conf.fs_tm);\r\n            a.conf.fs_tm = window.setTimeout(a._doOnResizeEnd, 200)\r\n        }\r\n        ;\r\n        this._doOnResizeEnd = function() {\r\n            a.setSizes()\r\n        }\r\n        ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.addEventListener(\"resize\", this._doOnResizeStart, false)\r\n        } else {\r\n            window.attachEvent(\"onresize\", this._doOnResizeStart)\r\n        }\r\n        this.conf.fs_resize = true\r\n    }\r\n    ;\r\n    if (this.conf.fs_mode == true) {\r\n        this._initFSResize()\r\n    }\r\n    this._unloadTop = function() {\r\n        this._mtbUnload();\r\n        this.detachHeader();\r\n        this.detachFooter();\r\n        if (this.conf.fs_mode == true) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                window.removeEventListener(\"resize\", this._doOnResizeStart, false)\r\n            } else {\r\n                window.detachEvent(\"onresize\", this._doOnResizeStart)\r\n            }\r\n        }\r\n        this.base.removeChild(this.cont);\r\n        var e = new RegExp(\"s{0,}\" + this.conf.css + \"_base_\" + this.conf.skin,\"gi\");\r\n        this.base.className = this.base.className.replace(e, \"\");\r\n        this.cont = this.base = null ;\r\n        a = null \r\n    }\r\n    ;\r\n    h = null \r\n}\r\ndhtmlXCellTop.prototype.setOffsets = function(l, h) {\r\n    var g = false;\r\n    for (var c in l) {\r\n        var e = c.charAt(0);\r\n        if (typeof (this.conf.ofs[e]) != \"undefined\" && !isNaN(l[c])) {\r\n            this.conf.ofs[e] = parseInt(l[c]);\r\n            g = true\r\n        }\r\n    }\r\n    if (h !== false && typeof (this.setSizes) == \"function\" && g == true) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXCellTop.prototype.attachMenu = function(a) {\r\n    if (this.dataNodes.menu != null ) {\r\n        return\r\n    }\r\n    this.dataNodes.menuObj = document.createElement(\"DIV\");\r\n    this.dataNodes.menuObj.className = \"dhxcelltop_menu\";\r\n    this.base.insertBefore(this.dataNodes.menuObj, this.dataNodes.toolbarObj || this.dataNodes.ribbonObj || this.cont);\r\n    if (typeof (a) != \"object\" || a == null ) {\r\n        a = {}\r\n    }\r\n    a.skin = this.conf.skin;\r\n    a.parent = this.dataNodes.menuObj;\r\n    this.dataNodes.menu = new dhtmlXMenuObject(a);\r\n    this.dataNodes.menuEv = this.attachEvent(\"_onSetSizes\", function() {\r\n        if (this.dataNodes.menuObj.style.display == \"none\") {\r\n            return\r\n        }\r\n        this.dataNodes.menuObj.style.left = this.conf.ofs.l + \"px\";\r\n        this.dataNodes.menuObj.style.marginTop = (this.dataNodes.haObj != null  ? 0 : this.conf.ofs.t) + \"px\";\r\n        this.dataNodes.menuObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\"\r\n    });\r\n    this.conf.ofs_nodes.t.menuObj = true;\r\n    this.setSizes();\r\n    a.parnt = null ;\r\n    a = null ;\r\n    return this.dataNodes.menu\r\n}\r\n;\r\ndhtmlXCellTop.prototype.detachMenu = function() {\r\n    if (this.dataNodes.menu == null ) {\r\n        return\r\n    }\r\n    this.dataNodes.menu.unload();\r\n    this.dataNodes.menu = null ;\r\n    this.dataNodes.menuObj.parentNode.removeChild(this.dataNodes.menuObj);\r\n    this.dataNodes.menuObj = null ;\r\n    this.detachEvent(this.dataNodes.menuEv);\r\n    this.dataNodes.menuEv = null ;\r\n    delete this.dataNodes.menu;\r\n    delete this.dataNodes.menuObj;\r\n    delete this.dataNodes.menuEv;\r\n    this.conf.ofs_nodes.t.menuObj = false;\r\n    if (!this.conf.unloading) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXCellTop.prototype.attachToolbar = function(a) {\r\n    if (!(this.dataNodes.ribbon == null  && this.dataNodes.toolbar == null )) {\r\n        return\r\n    }\r\n    this.dataNodes.toolbarObj = document.createElement(\"DIV\");\r\n    this.dataNodes.toolbarObj.className = \"dhxcelltop_toolbar\";\r\n    this.base.insertBefore(this.dataNodes.toolbarObj, this.cont);\r\n    this.dataNodes.toolbarObj.appendChild(document.createElement(\"DIV\"));\r\n    if (typeof (a) != \"object\" || a == null ) {\r\n        a = {}\r\n    }\r\n    a.skin = this.conf.skin;\r\n    a.parent = this.dataNodes.toolbarObj.firstChild;\r\n    this.dataNodes.toolbar = new dhtmlXToolbarObject(a);\r\n    this.dataNodes.toolbarEv = this.attachEvent(\"_onSetSizes\", function() {\r\n        if (this.dataNodes.toolbarObj.style.display == \"none\") {\r\n            return\r\n        }\r\n        this.dataNodes.toolbarObj.style.left = this.conf.ofs.l + \"px\";\r\n        this.dataNodes.toolbarObj.style.marginTop = (this.dataNodes.haObj != null  || this.dataNodes.menuObj != null  ? 0 : this.conf.ofs.t) + \"px\";\r\n        this.dataNodes.toolbarObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\"\r\n    });\r\n    this.dataNodes.toolbar._masterCell = this;\r\n    this.dataNodes.toolbar.attachEvent(\"_onIconSizeChange\", function() {\r\n        this._masterCell.setSizes()\r\n    });\r\n    this.conf.ofs_nodes.t.toolbarObj = true;\r\n    this.setSizes();\r\n    a.parnt = null ;\r\n    a = null ;\r\n    return this.dataNodes.toolbar\r\n}\r\n;\r\ndhtmlXCellTop.prototype.detachToolbar = function() {\r\n    if (this.dataNodes.toolbar == null ) {\r\n        return\r\n    }\r\n    this.dataNodes.toolbar._masterCell = null ;\r\n    this.dataNodes.toolbar.unload();\r\n    this.dataNodes.toolbar = null ;\r\n    this.dataNodes.toolbarObj.parentNode.removeChild(this.dataNodes.toolbarObj);\r\n    this.dataNodes.toolbarObj = null ;\r\n    this.detachEvent(this.dataNodes.toolbarEv);\r\n    this.dataNodes.toolbarEv = null ;\r\n    this.conf.ofs_nodes.t.toolbarObj = false;\r\n    delete this.dataNodes.toolbar;\r\n    delete this.dataNodes.toolbarObj;\r\n    delete this.dataNodes.toolbarEv;\r\n    if (!this.conf.unloading) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXCellTop.prototype.attachRibbon = function(a) {\r\n    if (!(this.dataNodes.ribbon == null  && this.dataNodes.toolbar == null )) {\r\n        return\r\n    }\r\n    this.dataNodes.ribbonObj = document.createElement(\"DIV\");\r\n    this.dataNodes.ribbonObj.className = \"dhxcelltop_ribbon\";\r\n    this.base.insertBefore(this.dataNodes.ribbonObj, this.cont);\r\n    this.dataNodes.ribbonObj.appendChild(document.createElement(\"DIV\"));\r\n    if (typeof (a) != \"object\" || a == null ) {\r\n        a = {}\r\n    }\r\n    a.skin = this.conf.skin;\r\n    a.parent = this.dataNodes.ribbonObj.firstChild;\r\n    this.dataNodes.ribbon = new dhtmlXRibbon(a);\r\n    this.dataNodes.ribbonEv = this.attachEvent(\"_onSetSizes\", function() {\r\n        if (this.dataNodes.ribbonObj.style.display == \"none\") {\r\n            return\r\n        }\r\n        this.dataNodes.ribbonObj.style.left = this.conf.ofs.l + \"px\";\r\n        this.dataNodes.ribbonObj.style.marginTop = (this.dataNodes.haObj != null  || this.dataNodes.menuObj != null  ? 0 : this.conf.ofs.t) + \"px\";\r\n        this.dataNodes.ribbonObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\";\r\n        this.dataNodes.ribbon.setSizes()\r\n    });\r\n    this.conf.ofs_nodes.t.ribbonObj = true;\r\n    var c = this;\r\n    this.dataNodes.ribbon.attachEvent(\"_onHeightChanged\", function() {\r\n        c.setSizes()\r\n    });\r\n    this.setSizes();\r\n    a.parnt = null ;\r\n    a = null ;\r\n    return this.dataNodes.ribbon\r\n}\r\n;\r\ndhtmlXCellTop.prototype.detachRibbon = function() {\r\n    if (this.dataNodes.ribbon == null ) {\r\n        return\r\n    }\r\n    this.dataNodes.ribbon.unload();\r\n    this.dataNodes.ribbon = null ;\r\n    this.dataNodes.ribbonObj.parentNode.removeChild(this.dataNodes.ribbonObj);\r\n    this.dataNodes.ribbonObj = null ;\r\n    this.detachEvent(this.dataNodes.ribbonEv);\r\n    this.dataNodes.ribbonEv = null ;\r\n    this.conf.ofs_nodes.t.ribbonObj = false;\r\n    delete this.dataNodes.ribbon;\r\n    delete this.dataNodes.ribbonObj;\r\n    delete this.dataNodes.ribbonEv;\r\n    if (!this.conf.unloading) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXCellTop.prototype.attachStatusBar = function(a) {\r\n    if (this.dataNodes.sbObj) {\r\n        return\r\n    }\r\n    if (typeof (a) == \"undefined\") {\r\n        a = {}\r\n    }\r\n    this.dataNodes.sbObj = document.createElement(\"DIV\");\r\n    this.dataNodes.sbObj.className = \"dhxcelltop_statusbar\";\r\n    if (this.cont.nextSibling != null ) {\r\n        this.base.insertBefore(this.dataNodes.sbObj, this.cont.nextSibling)\r\n    } else {\r\n        this.base.appendChild(this.dataNodes.sbObj)\r\n    }\r\n    this.dataNodes.sbObj.innerHTML = \"<div class='dhxcont_statusbar'>\" + (typeof (a.text) == \"string\" && a.text.length > 0 ? a.text : \"&nbsp;\") + \"</div>\";\r\n    if (typeof (a.height) == \"number\") {\r\n        this.dataNodes.sbObj.firstChild.style.height = this.dataNodes.sbObj.firstChild.style.lineHeight = a.height + \"px\"\r\n    }\r\n    this.dataNodes.sbObj.setText = function(c) {\r\n        this.childNodes[0].innerHTML = c\r\n    }\r\n    ;\r\n    this.dataNodes.sbObj.getText = function() {\r\n        return this.childNodes[0].innerHTML\r\n    }\r\n    ;\r\n    this.dataNodes.sbObj.onselectstart = function(c) {\r\n        return false\r\n    }\r\n    ;\r\n    this.dataNodes.sbEv = this.attachEvent(\"_onSetSizes\", function() {\r\n        if (this.dataNodes.sbObj.style.display == \"none\") {\r\n            return\r\n        }\r\n        this.dataNodes.sbObj.style.left = this.conf.ofs.l + \"px\";\r\n        this.dataNodes.sbObj.style.bottom = (this.dataNodes.faObj != null  ? this.dataNodes.faObj.offsetHeight : 0) + this.conf.ofs.t + \"px\";\r\n        this.dataNodes.sbObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\"\r\n    });\r\n    this.conf.ofs_nodes.b.sbObj = true;\r\n    this.setSizes();\r\n    return this.dataNodes.sbObj\r\n}\r\n;\r\ndhtmlXCellTop.prototype.detachStatusBar = function() {\r\n    if (!this.dataNodes.sbObj) {\r\n        return\r\n    }\r\n    this.dataNodes.sbObj.setText = this.dataNodes.sbObj.getText = this.dataNodes.sbObj.onselectstart = null ;\r\n    this.dataNodes.sbObj.parentNode.removeChild(this.dataNodes.sbObj);\r\n    this.dataNodes.sbObj = null ;\r\n    this.detachEvent(this.dataNodes.sbEv);\r\n    this.dataNodes.sbEv = null ;\r\n    this.conf.ofs_nodes.b.sbObj = false;\r\n    delete this.dataNodes.sb;\r\n    delete this.dataNodes.sbObj;\r\n    delete this.dataNodes.sbEv;\r\n    if (!this.conf.unloading) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXCellTop.prototype.showMenu = function() {\r\n    this._mtbShowHide(\"menuObj\", \"\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.hideMenu = function() {\r\n    this._mtbShowHide(\"menuObj\", \"none\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.showToolbar = function() {\r\n    this._mtbShowHide(\"toolbarObj\", \"\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.hideToolbar = function() {\r\n    this._mtbShowHide(\"toolbarObj\", \"none\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.showRibbon = function() {\r\n    this._mtbShowHide(\"ribbonObj\", \"\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.hideRibbon = function() {\r\n    this._mtbShowHide(\"ribbonObj\", \"none\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.showStatusBar = function() {\r\n    this._mtbShowHide(\"sbObj\", \"\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype.hideStatusBar = function() {\r\n    this._mtbShowHide(\"sbObj\", \"none\")\r\n}\r\n;\r\ndhtmlXCellTop.prototype._mtbShowHide = function(c, a) {\r\n    if (this.dataNodes[c] == null ) {\r\n        return\r\n    }\r\n    this.dataNodes[c].style.display = a;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXCellTop.prototype._mtbUnload = function(c, a) {\r\n    this.detachMenu();\r\n    this.detachToolbar();\r\n    this.detachStatusBar();\r\n    this.detachRibbon()\r\n}\r\n;\r\ndhtmlXCellTop.prototype.getAttachedMenu = function() {\r\n    return this.dataNodes.menu\r\n}\r\n;\r\ndhtmlXCellTop.prototype.getAttachedToolbar = function() {\r\n    return this.dataNodes.toolbar\r\n}\r\n;\r\ndhtmlXCellTop.prototype.getAttachedRibbon = function() {\r\n    return this.dataNodes.ribbon\r\n}\r\n;\r\ndhtmlXCellTop.prototype.getAttachedStatusBar = function() {\r\n    return this.dataNodes.sbObj\r\n}\r\n;\r\ndhtmlXCellTop.prototype.progressOn = function() {\r\n    if (this.conf.progress) {\r\n        return\r\n    }\r\n    this.conf.progress = true;\r\n    var c = document.createElement(\"DIV\");\r\n    c.className = \"dhxcelltop_progress\";\r\n    this.base.appendChild(c);\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = \"dhxcelltop_progress_img\";\r\n    this.base.appendChild(a);\r\n    c = a = null \r\n}\r\n;\r\ndhtmlXCellTop.prototype.progressOff = function() {\r\n    if (!this.conf.progress) {\r\n        return\r\n    }\r\n    var g = {\r\n        dhxcelltop_progress: true,\r\n        dhxcelltop_progress_img: true\r\n    };\r\n    for (var e = 0; e < this.base.childNodes.length; e++) {\r\n        if (typeof (this.base.childNodes[e].className) != \"undefined\" && g[this.base.childNodes[e].className] == true) {\r\n            g[this.base.childNodes[e].className] = this.base.childNodes[e]\r\n        }\r\n    }\r\n    for (var c in g) {\r\n        if (g[c] != true) {\r\n            this.base.removeChild(g[c])\r\n        }\r\n        g[c] = null \r\n    }\r\n    this.conf.progress = false;\r\n    g = null \r\n}\r\n;\r\ndhtmlXCellTop.prototype.attachHeader = function(c, a) {\r\n    if (this.dataNodes.haObj != null ) {\r\n        return\r\n    }\r\n    if (typeof (c) != \"object\") {\r\n        c = document.getElementById(c)\r\n    }\r\n    this.dataNodes.haObj = document.createElement(\"DIV\");\r\n    this.dataNodes.haObj.className = \"dhxcelltop_hdr\";\r\n    this.dataNodes.haObj.style.height = (a || c.offsetHeight) + \"px\";\r\n    this.base.insertBefore(this.dataNodes.haObj, this.dataNodes.menuObj || this.dataNodes.toolbarObj || this.cont);\r\n    this.dataNodes.haObj.appendChild(c);\r\n    c.style.visibility = \"visible\";\r\n    c = null ;\r\n    this.dataNodes.haEv = this.attachEvent(\"_onSetSizes\", function() {\r\n        this.dataNodes.haObj.style.left = this.conf.ofs.l + \"px\";\r\n        this.dataNodes.haObj.style.marginTop = this.conf.ofs.t + \"px\";\r\n        this.dataNodes.haObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\"\r\n    });\r\n    this.conf.ofs_nodes.t.haObj = true;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXCellTop.prototype.detachHeader = function() {\r\n    if (!this.dataNodes.haObj) {\r\n        return\r\n    }\r\n    while (this.dataNodes.haObj.childNodes.length > 0) {\r\n        this.dataNodes.haObj.lastChild.style.visibility = \"hidden\";\r\n        document.body.appendChild(this.dataNodes.haObj.lastChild)\r\n    }\r\n    this.dataNodes.haObj.parentNode.removeChild(this.dataNodes.haObj);\r\n    this.dataNodes.haObj = null ;\r\n    this.detachEvent(this.dataNodes.haEv);\r\n    this.dataNodes.haEv = null ;\r\n    this.conf.ofs_nodes.t.haObj = false;\r\n    delete this.dataNodes.haEv;\r\n    delete this.dataNodes.haObj;\r\n    if (!this.conf.unloading) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXCellTop.prototype.attachFooter = function(e, a) {\r\n    if (this.dataNodes.faObj != null ) {\r\n        return\r\n    }\r\n    if (typeof (e) != \"object\") {\r\n        e = document.getElementById(e)\r\n    }\r\n    this.dataNodes.faObj = document.createElement(\"DIV\");\r\n    this.dataNodes.faObj.className = \"dhxcelltop_ftr\";\r\n    this.dataNodes.faObj.style.height = (a || e.offsetHeight) + \"px\";\r\n    var c = (this.dataNodes.sbObj || this.cont);\r\n    if (this.base.lastChild == c) {\r\n        this.base.appendChild(this.dataNodes.faObj)\r\n    } else {\r\n        this.base.insertBefore(this.dataNodes.faObj, c.nextSibling)\r\n    }\r\n    this.dataNodes.faEv = this.attachEvent(\"_onSetSizes\", function() {\r\n        this.dataNodes.faObj.style.left = this.conf.ofs.l + \"px\";\r\n        this.dataNodes.faObj.style.bottom = this.conf.ofs.b + \"px\";\r\n        this.dataNodes.faObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + \"px\"\r\n    });\r\n    this.dataNodes.faObj.appendChild(e);\r\n    e.style.visibility = \"visible\";\r\n    c = e = null ;\r\n    this.conf.ofs_nodes.b.faObj = true;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXCellTop.prototype.detachFooter = function() {\r\n    if (!this.dataNodes.faObj) {\r\n        return\r\n    }\r\n    while (this.dataNodes.faObj.childNodes.length > 0) {\r\n        this.dataNodes.faObj.lastChild.style.visibility = \"hidden\";\r\n        document.body.appendChild(this.dataNodes.faObj.lastChild)\r\n    }\r\n    this.dataNodes.faObj.parentNode.removeChild(this.dataNodes.faObj);\r\n    this.dataNodes.faObj = null ;\r\n    this.detachEvent(this.dataNodes.faEv);\r\n    this.dataNodes.faEv = null ;\r\n    this.conf.ofs_nodes.b.faObj = false;\r\n    delete this.dataNodes.faEv;\r\n    delete this.dataNodes.faObj;\r\n    if (!this.conf.unloading) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\nfunction dhtmlXCalendarObject(l, s) {\r\n    this.i = {};\r\n    var e = null ;\r\n    if (typeof (l) == \"string\") {\r\n        var g = document.getElementById(l)\r\n    } else {\r\n        var g = l\r\n    }\r\n    if (g && typeof (g) == \"object\" && g.tagName && String(g.tagName).toLowerCase() != \"input\") {\r\n        e = g\r\n    }\r\n    g = null ;\r\n    if (typeof (l) != \"object\" || !l.length) {\r\n        l = [l]\r\n    }\r\n    for (var c = 0; c < l.length; c++) {\r\n        if (typeof (l[c]) == \"string\") {\r\n            l[c] = (document.getElementById(l[c]) || null )\r\n        }\r\n        if (l[c] != null  && l[c].tagName && String(l[c].tagName).toLowerCase() == \"input\") {\r\n            this.i[window.dhx4.newId()] = {\r\n                input: l[c]\r\n            }\r\n        } else {\r\n            if (!(l[c] instanceof Array) && l[c] instanceof Object && (l[c].input != null  || l[c].button != null )) {\r\n                if (l[c].input != null  && typeof (l[c].input) == \"string\") {\r\n                    l[c].input = document.getElementById(l[c].input)\r\n                }\r\n                if (l[c].button != null  && typeof (l[c].button) == \"string\") {\r\n                    l[c].button = document.getElementById(l[c].button)\r\n                }\r\n                this.i[window.dhx4.newId()] = l[c]\r\n            }\r\n        }\r\n        l[c] = null \r\n    }\r\n    this.conf = {\r\n        skin: (s || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhtmlxcalendar\") || \"dhx_skyblue\"),\r\n        zi: window.dhx4.newId(),\r\n        touch: !window.dhx4.isIE,\r\n        time: true,\r\n        today: false,\r\n        ws_first: true\r\n    };\r\n    this.setSkin = function(u, a) {\r\n        if (this.conf.skin == u && !a) {\r\n            return\r\n        }\r\n        this.conf.skin = u;\r\n        this.base.className = \"dhtmlxcalendar_\" + this.conf.skin;\r\n        this._ifrSize()\r\n    }\r\n    ;\r\n    this.base = document.createElement(\"DIV\");\r\n    this.base.style.display = \"none\";\r\n    this.base.appendChild(document.createElement(\"DIV\"));\r\n    if (e != null ) {\r\n        this._hasParent = true;\r\n        e.appendChild(this.base);\r\n        e = null \r\n    } else {\r\n        document.body.appendChild(this.base)\r\n    }\r\n    this.setParent = function(a) {\r\n        if (this._hasParent) {\r\n            if (typeof (a) == \"object\") {\r\n                a.appendChild(this.base)\r\n            } else {\r\n                if (typeof (a) == \"string\") {\r\n                    document.getElementById(a).appendChild(this.base)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setSkin(this.conf.skin, true);\r\n    this.base.onclick = function(a) {\r\n        a = a || event;\r\n        if (a.preventDefault) {\r\n            a.preventDefault()\r\n        }\r\n        a.cancelBubble = true\r\n    }\r\n    ;\r\n    this.base.onmousedown = function() {\r\n        return false\r\n    }\r\n    ;\r\n    if (this.conf.touch) {\r\n        this.base.ontouchstart = this.base.onclick\r\n    }\r\n    this.loadUserLanguage = function(x) {\r\n        if (!this.langData[x]) {\r\n            return\r\n        }\r\n        this.lang = x;\r\n        this.setWeekStartDay(this.langData[this.lang].weekstart);\r\n        this.setDateFormat(this.langData[this.lang].dateformat || \"%Y-%m-%d\");\r\n        if (this.msCont) {\r\n            var v = 0;\r\n            for (var u = 0; u < this.msCont.childNodes.length; u++) {\r\n                for (var a = 0; a < this.msCont.childNodes[u].childNodes.length; a++) {\r\n                    this.msCont.childNodes[u].childNodes[a].innerHTML = this.langData[this.lang].monthesSNames[v++]\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.contMonth = document.createElement(\"DIV\");\r\n    this.contMonth.className = \"dhtmlxcalendar_month_cont\";\r\n    this.contMonth.onselectstart = function(a) {\r\n        a = a || event;\r\n        a.cancelBubble = true;\r\n        if (a.preventDefault) {\r\n            a.preventDefault()\r\n        } else {\r\n            a.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this.base.firstChild.appendChild(this.contMonth);\r\n    var m = document.createElement(\"UL\");\r\n    m.className = \"dhtmlxcalendar_line\";\r\n    this.contMonth.appendChild(m);\r\n    var r = document.createElement(\"LI\");\r\n    r.className = \"dhtmlxcalendar_cell dhtmlxcalendar_month_hdr\";\r\n    r.innerHTML = \"<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\\\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\\\";' onmouseout='this.className=\\\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\\\";'></div><span></span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\\\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\\\";' onmouseout='this.className=\\\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\\\";'></div>\";\r\n    m.appendChild(r);\r\n    var h = this;\r\n    r.onclick = function(w) {\r\n        w = w || event;\r\n        if (w.type == \"touchstart\" && w.preventDefault != null ) {\r\n            w.preventDefault()\r\n        }\r\n        var u = (w.target || w.srcElement);\r\n        if (u.className && u.className.indexOf(\"dhtmlxcalendar_month_arrow\") === 0) {\r\n            h._hideSelector();\r\n            var v = (u.parentNode.firstChild == u ? -1 : 1);\r\n            var a = new Date(h._activeMonth);\r\n            h._drawMonth(new Date(h._activeMonth.getFullYear(),h._activeMonth.getMonth() + v,1,0,0,0,0));\r\n            h._evOnArrowClick([a, new Date(h._activeMonth)]);\r\n            return\r\n        }\r\n        if (u.className && u.className == \"dhtmlxcalendar_month_label_month\") {\r\n            w.cancelBubble = true;\r\n            h._showSelector(\"month\", Math.round(u.offsetLeft + u.offsetWidth / 2), u.offsetTop + u.offsetHeight + 2, \"selector_month\", true);\r\n            return\r\n        }\r\n        if (u.className && u.className == \"dhtmlxcalendar_month_label_year\") {\r\n            w.cancelBubble = true;\r\n            h._showSelector(\"year\", Math.round(u.offsetLeft + u.offsetWidth / 2), u.offsetTop + u.offsetHeight + 2, \"selector_year\", true);\r\n            return\r\n        }\r\n        h._hideSelector()\r\n    }\r\n    ;\r\n    if (this.conf.touch == true) {\r\n        r.ontouchstart = r.onclick\r\n    }\r\n    this.contDays = document.createElement(\"DIV\");\r\n    this.contDays.className = \"dhtmlxcalendar_days_cont\";\r\n    this.base.firstChild.appendChild(this.contDays);\r\n    this.setWeekStartDay = function(a) {\r\n        if (a == 0) {\r\n            a = 7\r\n        }\r\n        this._wStart = Math.min(Math.max((isNaN(a) ? 1 : a), 1), 7);\r\n        this._drawDaysOfWeek()\r\n    }\r\n    ;\r\n    this._drawDaysOfWeek = function() {\r\n        if (this.contDays.childNodes.length == 0) {\r\n            var x = document.createElement(\"UL\");\r\n            x.className = \"dhtmlxcalendar_line\";\r\n            this.contDays.appendChild(x)\r\n        } else {\r\n            var x = this.contDays.firstChild\r\n        }\r\n        var u = this._wStart;\r\n        var v = this.langData[this.lang].daysSNames;\r\n        v.push(String(this.langData[this.lang].daysSNames[0]).valueOf());\r\n        for (var y = 0; y < 8; y++) {\r\n            if (x.childNodes[y] == null ) {\r\n                var a = document.createElement(\"LI\");\r\n                x.appendChild(a)\r\n            } else {\r\n                var a = x.childNodes[y]\r\n            }\r\n            if (y == 0) {\r\n                a.className = \"dhtmlxcalendar_cell_wn\";\r\n                a.innerHTML = \"<div class='dhtmlxcalendar_label'>\" + (this.langData[this.lang].weekname || \"w\") + \"</div>\"\r\n            } else {\r\n                a.className = \"dhtmlxcalendar_cell\" + (u >= 6 ? \" dhtmlxcalendar_day_weekday_cell\" : \"\") + (y == 1 ? \"_first\" : \"\");\r\n                a.innerHTML = v[u];\r\n                if (++u > 7) {\r\n                    u = 1\r\n                }\r\n            }\r\n        }\r\n        if (this._activeMonth != null ) {\r\n            this._drawMonth(this._activeMonth)\r\n        }\r\n    }\r\n    ;\r\n    this._wStart = this.langData[this.lang].weekstart;\r\n    this.setWeekStartDay(this._wStart);\r\n    this.contDates = document.createElement(\"DIV\");\r\n    this.contDates.className = \"dhtmlxcalendar_dates_cont\";\r\n    this.base.firstChild.appendChild(this.contDates);\r\n    this.contDates.onclick = function(y) {\r\n        y = y || event;\r\n        if (y.type == \"touchstart\" && y.preventDefault != null ) {\r\n            y.preventDefault()\r\n        }\r\n        var u = (y.target || y.srcElement);\r\n        if (u.parentNode != null  && u.parentNode._date != null ) {\r\n            u = u.parentNode\r\n        }\r\n        if (u._date != null  && !u._css_dis) {\r\n            var w = h._activeDate.getHours();\r\n            var v = h._activeDate.getMinutes();\r\n            var x = u._date;\r\n            if (h.checkEvent(\"onBeforeChange\")) {\r\n                if (!h.callEvent(\"onBeforeChange\", [new Date(u._date.getFullYear(),u._date.getMonth(),u._date.getDate(),w,v)])) {\r\n                    return\r\n                }\r\n            }\r\n            if (h._activeDateCell != null ) {\r\n                h._activeDateCell._css_date = false;\r\n                h._updateCellStyle(h._activeDateCell._q, h._activeDateCell._w)\r\n            }\r\n            var a = (h._activeDate.getFullYear() + \"_\" + h._activeDate.getMonth() != x.getFullYear() + \"_\" + x.getMonth());\r\n            h._nullDate = false;\r\n            h._activeDate = new Date(x.getFullYear(),x.getMonth(),x.getDate(),w,v);\r\n            h._activeDateCell = u;\r\n            h._activeDateCell._css_date = true;\r\n            h._activeDateCell._css_hover = false;\r\n            h._updateCellStyle(h._activeDateCell._q, h._activeDateCell._w);\r\n            if (a) {\r\n                h._drawMonth(h._activeDate)\r\n            }\r\n            if (h._activeInp && h.i[h._activeInp] && h.i[h._activeInp].input != null ) {\r\n                h.i[h._activeInp].input.value = h._dateToStr(new Date(h._activeDate.getTime()))\r\n            }\r\n            if (!h._hasParent) {\r\n                if (y.type == \"touchstart\") {\r\n                    window.setTimeout(function() {\r\n                        h._hide()\r\n                    }, 400)\r\n                } else {\r\n                    h._hide()\r\n                }\r\n            }\r\n            h._evOnClick([new Date(h._activeDate.getTime())])\r\n        }\r\n    }\r\n    ;\r\n    if (this.conf.touch == true) {\r\n        this.contDates.ontouchstart = this.contDates.onclick\r\n    }\r\n    this.contDates.onmouseover = function(u) {\r\n        u = u || event;\r\n        var a = (u.target || u.srcElement);\r\n        if (a.parentNode != null  && a.parentNode._date != null ) {\r\n            a = a.parentNode\r\n        }\r\n        if (a._date != null ) {\r\n            if (h._lastHover == a || a._css_hover) {\r\n                return\r\n            }\r\n            a._css_hover = true;\r\n            h._updateCellStyle(a._q, a._w);\r\n            h._lastHover = a;\r\n            h._evOnMouseOver([new Date(a._date.getFullYear(),a._date.getMonth(),a._date.getDate(),0,0,0,0), u]);\r\n            a = null \r\n        }\r\n    }\r\n    ;\r\n    this.contDates.onmouseout = function(a) {\r\n        h._clearDayHover(a || event)\r\n    }\r\n    ;\r\n    this._lastHover = null ;\r\n    this._clearDayHover = function(a) {\r\n        if (!this._lastHover) {\r\n            return\r\n        }\r\n        this._lastHover._css_hover = false;\r\n        this._updateCellStyle(this._lastHover._q, this._lastHover._w);\r\n        if (a != null ) {\r\n            h._evOnMouseOut([new Date(this._lastHover._date.getFullYear(),this._lastHover._date.getMonth(),this._lastHover._date.getDate(),0,0,0,0), a])\r\n        }\r\n        this._lastHover = null \r\n    }\r\n    ;\r\n    for (var c = 0; c < 6; c++) {\r\n        var m = document.createElement(\"UL\");\r\n        m.className = \"dhtmlxcalendar_line\";\r\n        this.contDates.appendChild(m);\r\n        for (var o = 0; o <= 7; o++) {\r\n            var r = document.createElement(\"LI\");\r\n            if (o == 0) {\r\n                r.className = \"dhtmlxcalendar_cell_wn\"\r\n            } else {\r\n                r.className = \"dhtmlxcalendar_cell\"\r\n            }\r\n            m.appendChild(r)\r\n        }\r\n    }\r\n    this.contTime = document.createElement(\"DIV\");\r\n    this.contTime.className = \"dhtmlxcalendar_time_cont\";\r\n    this.contTime.style.display = \"none\";\r\n    this.base.firstChild.appendChild(this.contTime);\r\n    this.showTime = function() {\r\n        if (this.conf.time != true) {\r\n            this.conf.time = true;\r\n            this._adjustTimeCont()\r\n        }\r\n    }\r\n    ;\r\n    this.hideTime = function() {\r\n        if (this.conf.time == true) {\r\n            this.conf.time = false;\r\n            this._adjustTimeCont()\r\n        }\r\n    }\r\n    ;\r\n    this.showToday = function() {\r\n        if (this.conf.today != true) {\r\n            this.conf.today = true;\r\n            this._adjustTimeCont()\r\n        }\r\n    }\r\n    ;\r\n    this.hideToday = function() {\r\n        if (this.conf.today == true) {\r\n            this.conf.today = false;\r\n            this._adjustTimeCont()\r\n        }\r\n    }\r\n    ;\r\n    this._adjustTimeCont = function() {\r\n        var a = \"\";\r\n        if (this.conf.time == true) {\r\n            a += \"_time\"\r\n        }\r\n        if (this.conf.today == true) {\r\n            a += \"_today\"\r\n        }\r\n        if (a == \"\") {\r\n            this.contTime.style.display = \"none\"\r\n        } else {\r\n            this.contTime.className = \"dhtmlxcalendar_time_cont dhtmlxcalendar_mode\" + a;\r\n            this.contTime.style.display = \"\"\r\n        }\r\n        this._ifrSize()\r\n    }\r\n    ;\r\n    this._adjustTimeCont();\r\n    var m = document.createElement(\"UL\");\r\n    m.className = \"dhtmlxcalendar_line\";\r\n    this.contTime.appendChild(m);\r\n    var r = document.createElement(\"LI\");\r\n    r.className = \"dhtmlxcalendar_cell dhtmlxcalendar_time_hdr\";\r\n    r.innerHTML = \"<div class='dhtmlxcalendar_time_img'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'> : </span><span class='dhtmlxcalendar_label_minutes'></span><span class='dhtmlxcalendar_label_clear'>Clear</span><span class='dhtmlxcalendar_label_today'>Today</span>\";\r\n    m.appendChild(r);\r\n    r.onclick = function(v) {\r\n        v = v || event;\r\n        if (v.type == \"touchstart\" && v.preventDefault != null ) {\r\n            v.preventDefault()\r\n        }\r\n        var a = (v.target || v.srcElement);\r\n        if (a.tagName != null  && a.tagName.toLowerCase() == \"span\" && a._par == true && a.parentNode != null ) {\r\n            a = a.parentNode\r\n        }\r\n        if (a.className && a.className == \"dhtmlxcalendar_label_hours\") {\r\n            v.cancelBubble = true;\r\n            var u = h.contMonth.offsetHeight + h.contDays.offsetHeight + h.contDates.offsetHeight + a.offsetTop;\r\n            h._showSelector(\"hours\", Math.round(a.offsetLeft + a.offsetWidth / 2), u - 2, \"selector_hours\", true);\r\n            return\r\n        }\r\n        if (a.className && a.className == \"dhtmlxcalendar_label_minutes\") {\r\n            v.cancelBubble = true;\r\n            if (h._minutesInterval == 1) {\r\n                var w = h.getFormatedDate(\"%i\");\r\n                a.innerHTML = \"<span class='dhtmlxcalendar_selected_date'>\" + w.charAt(0) + \"</span>\" + w.charAt(1);\r\n                a.firstChild._par = true;\r\n                h._selectorMode = 1\r\n            }\r\n            var u = h.contMonth.offsetHeight + h.contDays.offsetHeight + h.contDates.offsetHeight + a.offsetTop;\r\n            h._showSelector(\"minutes\", Math.round(a.offsetLeft + a.offsetWidth / 2), u - 2, \"selector_minutes\", true);\r\n            return\r\n        }\r\n        h._hideSelector();\r\n        if (a.className && a.className == \"dhtmlxcalendar_label_today\") {\r\n            var w = new Date();\r\n            w.setHours(h._activeDate.getHours());\r\n            w.setMinutes(h._activeDate.getMinutes());\r\n            w.setSeconds(h._activeDate.getSeconds());\r\n            h.setDate(w)\r\n        }\r\n        if (a.className && a.className == \"dhtmlxcalendar_label_clear\") {\r\n            h._nullDate = true;\r\n            h._drawMonth(new Date())\r\n        }\r\n    }\r\n    ;\r\n    if (this.conf.touch == true) {\r\n        r.ontouchstart = r.onclick\r\n    }\r\n    this._activeMonth = null ;\r\n    this._activeDate = new Date();\r\n    this._activeDateCell = null ;\r\n    this.setDate = function(u) {\r\n        window.dhx4.temp_calendar = {\r\n            tz: null \r\n        };\r\n        this._nullDate = (typeof (u) == \"undefined\" || u === \"\" || !u);\r\n        if (!(u instanceof Date)) {\r\n            u = this._strToDate(String(u || \"\"));\r\n            if (u == \"Invalid Date\") {\r\n                u = new Date()\r\n            } else {\r\n                this.conf.tz = window.dhx4.temp_calendar.tz\r\n            }\r\n            window.dhx4.temp_calendar = null \r\n        }\r\n        if (this.conf.tz == null ) {\r\n            this.conf.tz = window.dhx4.date2str(u, \"%P\")\r\n        }\r\n        var a = u.getTime();\r\n        if (this._isOutOfRange(a)) {\r\n            return\r\n        }\r\n        this._activeDate = new Date(a);\r\n        this._drawMonth(this._nullDate ? new Date() : this._activeDate);\r\n        this._updateVisibleHours();\r\n        this._updateVisibleMinutes()\r\n    }\r\n    ;\r\n    this.getDate = function(v) {\r\n        if (this._nullDate) {\r\n            return null \r\n        }\r\n        var a = new Date(this._activeDate.getTime());\r\n        if (v) {\r\n            window.dhx4.temp_calendar = {\r\n                tz: this.conf.tz\r\n            };\r\n            var u = this._dateToStr(a);\r\n            window.dhx4.temp_calendar = null ;\r\n            return u\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this._drawMonth = function(F) {\r\n        if (!(F instanceof Date)) {\r\n            return\r\n        }\r\n        if (isNaN(F.getFullYear())) {\r\n            F = new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0)\r\n        }\r\n        this._activeMonth = new Date(F.getFullYear(),F.getMonth(),1,0,0,0,0);\r\n        this._activeDateCell = null ;\r\n        var D = new Date(this._activeMonth.getTime());\r\n        var v = D.getDay();\r\n        var J = v - this._wStart;\r\n        if (J < 0) {\r\n            J = J + 7\r\n        }\r\n        D.setDate(D.getDate() - J);\r\n        var M = F.getMonth();\r\n        var N = new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0).getTime();\r\n        var A = 0;\r\n        for (var u = 0; u < 6; u++) {\r\n            var E = this._wStart;\r\n            for (var L = 0; L <= 7; L++) {\r\n                if (L == 0) {\r\n                    var K = this.getWeekNumber(new Date(D.getFullYear(),D.getMonth(),D.getDate() + A,0,0,0,0));\r\n                    if (K >= 52 && this.conf.ws_first == true && this._activeMonth.getMonth() == 0) {\r\n                        var y = this.getWeekNumber(new Date(D.getFullYear(),D.getMonth(),D.getDate() + A + 7,0,0,0,0));\r\n                        if (y < K && y > 1) {\r\n                            K = 1\r\n                        }\r\n                    }\r\n                    this.contDates.childNodes[u].childNodes[L].innerHTML = \"<div class='dhtmlxcalendar_label'>\" + K + \"</div>\"\r\n                } else {\r\n                    var a = new Date(D.getFullYear(),D.getMonth(),D.getDate() + A,0,0,0,0);\r\n                    if (a.getHours() != 0) {\r\n                        var C = (a.getHours() > 12 ? 24 - a.getHours() : a.getHours());\r\n                        a.setTime(a.getTime() + 60 * 60 * 1000 * C)\r\n                    }\r\n                    var I = a.getDay();\r\n                    var x = a.getTime();\r\n                    var H = \"dhtmlxcalendar_label\";\r\n                    if (this._tipData[x] != null ) {\r\n                        if (this._tipData[x].usePopup && typeof (window.dhtmlXPopup) == \"function\") {\r\n                            this.contDates.childNodes[u].childNodes[L].removeAttribute(\"title\");\r\n                            this._initTooltipPopup()\r\n                        } else {\r\n                            this.contDates.childNodes[u].childNodes[L].setAttribute(\"title\", this._tipData[x].text)\r\n                        }\r\n                        if (this._tipData[x].showIcon) {\r\n                            H += \" dhtmlxcalendar_label_title\"\r\n                        }\r\n                    } else {\r\n                        this.contDates.childNodes[u].childNodes[L].removeAttribute(\"title\")\r\n                    }\r\n                    this.contDates.childNodes[u].childNodes[L].innerHTML = \"<div class='\" + H + \"'>\" + a.getDate() + \"</div>\";\r\n                    this.contDates.childNodes[u].childNodes[L]._date = new Date(x);\r\n                    this.contDates.childNodes[u].childNodes[L]._q = u;\r\n                    this.contDates.childNodes[u].childNodes[L]._w = L;\r\n                    this.contDates.childNodes[u].childNodes[L]._css_month = (a.getMonth() == M);\r\n                    this.contDates.childNodes[u].childNodes[L]._css_date = (!this._nullDate && x == N);\r\n                    this.contDates.childNodes[u].childNodes[L]._css_weekend = (E >= 6);\r\n                    this.contDates.childNodes[u].childNodes[L]._css_dis = this._isOutOfRange(x);\r\n                    this.contDates.childNodes[u].childNodes[L]._css_holiday = (this._holidays[x] == true);\r\n                    this._updateCellStyle(u, L);\r\n                    if (x == N) {\r\n                        this._activeDateCell = this.contDates.childNodes[u].childNodes[L]\r\n                    }\r\n                    if (++E > 7) {\r\n                        E = 1\r\n                    }\r\n                    A++\r\n                }\r\n            }\r\n        }\r\n        this.contMonth.firstChild.firstChild.childNodes[1].innerHTML = this._buildMonthHdr(F)\r\n    }\r\n    ;\r\n    this._updateCellStyle = function(x, a) {\r\n        var v = this.contDates.childNodes[x].childNodes[a];\r\n        var u = \"dhtmlxcalendar_cell dhtmlxcalendar_cell\";\r\n        u += (v._css_month ? \"_month\" : \"\");\r\n        u += (v._css_date ? \"_date\" : \"\");\r\n        u += (v._css_weekend ? \"_weekend\" : \"\");\r\n        u += (v._css_holiday ? \"_holiday\" : \"\");\r\n        u += (v._css_dis ? \"_dis\" : \"\");\r\n        u += (v._css_hover && !v._css_dis ? \"_hover\" : \"\");\r\n        v.className = u;\r\n        v = null \r\n    }\r\n    ;\r\n    this._minutesInterval = 5;\r\n    this._initSelector = function(D, x) {\r\n        if (!this._selCover) {\r\n            this._selCover = document.createElement(\"DIV\");\r\n            this._selCover.className = \"dhtmlxcalendar_selector_cover\";\r\n            this.base.firstChild.appendChild(this._selCover)\r\n        }\r\n        if (!this._sel) {\r\n            this._sel = document.createElement(\"DIV\");\r\n            this._sel.className = \"dhtmlxcalendar_selector_obj\";\r\n            this.base.firstChild.appendChild(this._sel);\r\n            this._sel.appendChild(document.createElement(\"TABLE\"));\r\n            this._sel.firstChild.className = \"dhtmlxcalendar_selector_table\";\r\n            this._sel.firstChild.cellSpacing = 0;\r\n            this._sel.firstChild.cellPadding = 0;\r\n            this._sel.firstChild.border = 0;\r\n            this._sel.firstChild.appendChild(document.createElement(\"TBODY\"));\r\n            this._sel.firstChild.firstChild.appendChild(document.createElement(\"TR\"));\r\n            this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement(\"TD\"));\r\n            this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement(\"TD\"));\r\n            this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement(\"TD\"));\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[0].className = \"dhtmlxcalendar_selector_cell_left\";\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[1].className = \"dhtmlxcalendar_selector_cell_middle\";\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[2].className = \"dhtmlxcalendar_selector_cell_right\";\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML = \"&nbsp;\";\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML = \"&nbsp;\";\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover = function() {\r\n                this.className = \"dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover\"\r\n            }\r\n            ;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout = function() {\r\n                this.className = \"dhtmlxcalendar_selector_cell_left\"\r\n            }\r\n            ;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover = function() {\r\n                this.className = \"dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover\"\r\n            }\r\n            ;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout = function() {\r\n                this.className = \"dhtmlxcalendar_selector_cell_right\"\r\n            }\r\n            ;\r\n            this._sel.onmouseover = function(H) {\r\n                H = H || event;\r\n                var w = (H.target || H.srcElement);\r\n                if (w._cell === true) {\r\n                    if (h._selHover != w) {\r\n                        h._clearSelHover()\r\n                    }\r\n                    if (String(w.className).match(/^\\s{0,}dhtmlxcalendar_selector_cell\\s{0,}$/gi) != null ) {\r\n                        w.className += \" dhtmlxcalendar_selector_cell_hover\";\r\n                        h._selHover = w\r\n                    }\r\n                }\r\n            }\r\n            ;\r\n            this._sel.onmouseout = function() {\r\n                h._clearSelHover()\r\n            }\r\n            ;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick = function(w) {\r\n                w = w || event;\r\n                if (w.type == \"touchstart\" && w.preventDefault != null ) {\r\n                    w.preventDefault()\r\n                }\r\n                w.cancelBubble = true;\r\n                h._scrollYears(-1)\r\n            }\r\n            ;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick = function(w) {\r\n                w = w || event;\r\n                if (w.type == \"touchstart\" && w.preventDefault != null ) {\r\n                    w.preventDefault()\r\n                }\r\n                w.cancelBubble = true;\r\n                h._scrollYears(1)\r\n            }\r\n            ;\r\n            if (this.conf.touch == true) {\r\n                this._sel.firstChild.firstChild.firstChild.childNodes[0].ontouchstart = this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick;\r\n                this._sel.firstChild.firstChild.firstChild.childNodes[2].ontouchstart = this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick\r\n            }\r\n            this._sel._ta = {};\r\n            this._selHover = null ;\r\n            this._sel.appendChild(document.createElement(\"DIV\"));\r\n            this._sel.lastChild.className = \"dhtmlxcalendar_selector_obj_arrow\"\r\n        }\r\n        if (this._sel._ta[D] == true) {\r\n            return\r\n        }\r\n        if (D == \"month\") {\r\n            this._msCells = {};\r\n            this.msCont = document.createElement(\"DIV\");\r\n            this.msCont.className = \"dhtmlxcalendar_area_\" + x;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);\r\n            var u = 0;\r\n            for (var a = 0; a < 4; a++) {\r\n                var C = document.createElement(\"UL\");\r\n                C.className = \"dhtmlxcalendar_selector_line\";\r\n                this.msCont.appendChild(C);\r\n                for (var E = 0; E < 3; E++) {\r\n                    var F = document.createElement(\"LI\");\r\n                    F.innerHTML = this.langData[this.lang].monthesSNames[u];\r\n                    F.className = \"dhtmlxcalendar_selector_cell\";\r\n                    C.appendChild(F);\r\n                    F._month = u;\r\n                    F._cell = true;\r\n                    this._msCells[u++] = F\r\n                }\r\n            }\r\n            this.msCont.onclick = function(H) {\r\n                H = H || event;\r\n                if (H.type == \"touchstart\" && H.preventDefault != null ) {\r\n                    H.preventDefault()\r\n                }\r\n                H.cancelBubble = true;\r\n                var w = (H.target || H.srcElement);\r\n                if (w._month != null ) {\r\n                    h._hideSelector();\r\n                    h._updateActiveMonth();\r\n                    h._drawMonth(new Date(h._activeMonth.getFullYear(),w._month,1,0,0,0,0));\r\n                    h._doOnSelectorChange()\r\n                }\r\n            }\r\n            ;\r\n            if (this.conf.touch == true) {\r\n                this.msCont.ontouchstart = this.msCont.onclick\r\n            }\r\n        }\r\n        if (D == \"year\") {\r\n            this._ysCells = {};\r\n            this.ysCont = document.createElement(\"DIV\");\r\n            this.ysCont.className = \"dhtmlxcalendar_area_\" + x;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);\r\n            for (var a = 0; a < 4; a++) {\r\n                var C = document.createElement(\"UL\");\r\n                C.className = \"dhtmlxcalendar_selector_line\";\r\n                this.ysCont.appendChild(C);\r\n                for (var E = 0; E < 3; E++) {\r\n                    var F = document.createElement(\"LI\");\r\n                    F.className = \"dhtmlxcalendar_selector_cell\";\r\n                    F._cell = true;\r\n                    C.appendChild(F)\r\n                }\r\n            }\r\n            this.ysCont.onclick = function(H) {\r\n                H = H || event;\r\n                if (H.type == \"touchstart\" && H.preventDefault != null ) {\r\n                    H.preventDefault()\r\n                }\r\n                H.cancelBubble = true;\r\n                var w = (H.target || H.srcElement);\r\n                if (w._year != null ) {\r\n                    h._hideSelector();\r\n                    h._drawMonth(new Date(w._year,h._activeMonth.getMonth(),1,0,0,0,0));\r\n                    h._doOnSelectorChange()\r\n                }\r\n            }\r\n            ;\r\n            if (this.conf.touch == true) {\r\n                this.ysCont.ontouchstart = this.ysCont.onclick\r\n            }\r\n        }\r\n        if (D == \"hours\") {\r\n            this._hsCells = {};\r\n            this.hsCont = document.createElement(\"DIV\");\r\n            this.hsCont.className = \"dhtmlxcalendar_area_\" + x;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);\r\n            var u = 0;\r\n            for (var a = 0; a < 4; a++) {\r\n                var C = document.createElement(\"UL\");\r\n                C.className = \"dhtmlxcalendar_selector_line\";\r\n                this.hsCont.appendChild(C);\r\n                for (var E = 0; E < 6; E++) {\r\n                    var F = document.createElement(\"LI\");\r\n                    F.innerHTML = this._fixLength(u, 2);\r\n                    F.className = \"dhtmlxcalendar_selector_cell\";\r\n                    C.appendChild(F);\r\n                    F._hours = u;\r\n                    F._cell = true;\r\n                    this._hsCells[u++] = F\r\n                }\r\n            }\r\n            this.hsCont.onclick = function(H) {\r\n                H = H || event;\r\n                if (H.type == \"touchstart\" && H.preventDefault != null ) {\r\n                    H.preventDefault()\r\n                }\r\n                H.cancelBubble = true;\r\n                var w = (H.target || H.srcElement);\r\n                if (w._hours != null ) {\r\n                    h._hideSelector();\r\n                    h._activeDate.setHours(w._hours);\r\n                    h._updateActiveHours();\r\n                    h._updateVisibleHours();\r\n                    h._doOnSelectorChange();\r\n                    h.callEvent(\"onTimeChange\", [new Date(h._activeDate.getTime())])\r\n                }\r\n            }\r\n            ;\r\n            if (this.conf.touch == true) {\r\n                this.hsCont.ontouchstart = this.hsCont.onclick\r\n            }\r\n        }\r\n        if (D == \"minutes\") {\r\n            var A = 4;\r\n            var v = 3;\r\n            var y = 2;\r\n            if (this._minutesInterval == 1) {\r\n                if (this._selectorMode == 1) {\r\n                    A = 2;\r\n                    v = 3;\r\n                    y = 1\r\n                } else {\r\n                    A = 2;\r\n                    v = 5;\r\n                    y = 1;\r\n                    x += \"5\"\r\n                }\r\n            }\r\n            if (this._minutesInterval == 10) {\r\n                A = 2\r\n            }\r\n            if (this._minutesInterval == 15) {\r\n                A = 1;\r\n                v = 4;\r\n                x += \"4\"\r\n            }\r\n            this._rsCells = {};\r\n            this.rsCont = document.createElement(\"DIV\");\r\n            this.rsCont.className = \"dhtmlxcalendar_area_\" + x;\r\n            this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);\r\n            var u = 0;\r\n            for (var a = 0; a < A; a++) {\r\n                var C = document.createElement(\"UL\");\r\n                C.className = \"dhtmlxcalendar_selector_line\";\r\n                this.rsCont.appendChild(C);\r\n                for (var E = 0; E < v; E++) {\r\n                    var F = document.createElement(\"LI\");\r\n                    F.innerHTML = (y > 1 ? this._fixLength(u, y) : u);\r\n                    F.className = \"dhtmlxcalendar_selector_cell\";\r\n                    C.appendChild(F);\r\n                    F._minutes = u;\r\n                    F._cell = true;\r\n                    this._rsCells[u] = F;\r\n                    u += this._minutesInterval\r\n                }\r\n            }\r\n            this.rsCont.onclick = function(I) {\r\n                I = I || event;\r\n                if (I.type == \"touchstart\" && I.preventDefault != null ) {\r\n                    I.preventDefault()\r\n                }\r\n                I.cancelBubble = true;\r\n                var H = (I.target || I.srcElement);\r\n                if (H._minutes != null ) {\r\n                    if (h._minutesInterval == 1) {\r\n                        var w = h.getFormatedDate(\"%i\");\r\n                        if (h._selectorMode == 1) {\r\n                            w = H._minutes.toString() + w.charAt(1)\r\n                        } else {\r\n                            w = w.charAt(0) + H._minutes.toString()\r\n                        }\r\n                        h._activeDate.setMinutes(Number(w));\r\n                        h.callEvent(\"onTimeChange\", [new Date(h._activeDate.getTime())]);\r\n                        h._hideSelector();\r\n                        if (h._selectorMode == 1) {\r\n                            h._updateVisibleMinutes(true);\r\n                            h._selectorMode = 2;\r\n                            h._showSelector(\"minutes\", h._sel._x, h._sel._y, \"selector_minutes\", true);\r\n                            h._updateActiveMinutes();\r\n                            return\r\n                        } else {\r\n                            h._selectorMode = 1\r\n                        }\r\n                    } else {\r\n                        h._hideSelector();\r\n                        h._activeDate.setMinutes(H._minutes);\r\n                        h._updateActiveMinutes();\r\n                        h.callEvent(\"onTimeChange\", [new Date(h._activeDate.getTime())])\r\n                    }\r\n                    h._updateVisibleMinutes();\r\n                    h._doOnSelectorChange()\r\n                }\r\n            }\r\n            ;\r\n            if (this.conf.touch == true) {\r\n                this.rsCont.ontouchstart = this.rsCont.onclick\r\n            }\r\n        }\r\n        this._sel._ta[D] = true\r\n    }\r\n    ;\r\n    this._showSelector = function(A, u, C, w, a) {\r\n        if (a === true && this._sel != null  && this._isSelectorVisible() && A == this._sel._t) {\r\n            this._hideSelector();\r\n            return\r\n        }\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            u += 12\r\n        }\r\n        if (!this._sel || !this._sel._ta[A]) {\r\n            this._initSelector(A, w)\r\n        }\r\n        if (A != this._sel._t && this._sel._t == \"minutes\" && this._minutesInterval == 1) {\r\n            this.contTime.firstChild.firstChild.childNodes[3].innerHTML = this.getFormatedDate(\"%i\")\r\n        }\r\n        this._sel._x = u;\r\n        this._sel._y = C;\r\n        this._sel.style.visibility = \"hidden\";\r\n        this._sel.style.display = \"\";\r\n        this._selCover.style.width = this.base.offsetWidth - 2 + \"px\";\r\n        this._selCover.style.top = this.contMonth.offsetHeight + \"px\";\r\n        this._selCover.style.height = this.contDates.offsetHeight + this.contDays.offsetHeight - 1 + \"px\";\r\n        this._selCover.style.display = \"\";\r\n        this._sel._t = A;\r\n        this._sel.className = \"dhtmlxcalendar_selector_obj dhtmlxcalendar_\" + w + (A == \"hours\" && this.conf.today == true ? \"2\" : \"\");\r\n        this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display = this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display = (A == \"year\" ? \"\" : \"none\");\r\n        var v = Math.max(0, u - Math.round(this._sel.offsetWidth / 2));\r\n        if (v + this._sel.offsetWidth > this._sel.parentNode.offsetWidth) {\r\n            v = this._sel.parentNode.offsetWidth - this._sel.offsetWidth\r\n        }\r\n        this._sel.style.left = v + \"px\";\r\n        if (A == \"hours\" || A == \"minutes\") {\r\n            this._sel.style.top = C - this._sel.offsetHeight + \"px\"\r\n        } else {\r\n            this._sel.style.top = C + \"px\"\r\n        }\r\n        this._sel.childNodes[1].style.width = this._sel.childNodes[0].offsetWidth + \"px\";\r\n        this._sel.style.visibility = \"visible\";\r\n        this._doOnSelectorShow(A)\r\n    }\r\n    ;\r\n    this._doOnSelectorShow = function(a) {\r\n        if (a == \"month\") {\r\n            this._updateActiveMonth()\r\n        }\r\n        if (a == \"year\") {\r\n            this._updateYearsList(this._activeMonth)\r\n        }\r\n        if (a == \"hours\") {\r\n            this._updateActiveHours()\r\n        }\r\n        if (a == \"minutes\") {\r\n            this._updateActiveMinutes()\r\n        }\r\n    }\r\n    ;\r\n    this._hideSelector = function(a) {\r\n        if (!this._sel) {\r\n            return\r\n        }\r\n        this._sel.style.display = \"none\";\r\n        this._sel.style.visible = \"hidden\";\r\n        this._selCover.style.display = \"none\";\r\n        if (this._sel._t == \"minutes\" && this._minutesInterval == 1) {\r\n            this.contTime.firstChild.firstChild.childNodes[3].innerHTML = this.getFormatedDate(\"%i\");\r\n            this._unloadSelector(\"minutes\")\r\n        }\r\n    }\r\n    ;\r\n    this._isSelectorVisible = function() {\r\n        if (!this._sel) {\r\n            return false\r\n        }\r\n        return ( this._sel.style.display != \"none\") \r\n    }\r\n    ;\r\n    this._doOnSelectorChange = function(a) {\r\n        this.callEvent(\"onChange\", [new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()), a === true])\r\n    }\r\n    ;\r\n    this._clearSelHover = function() {\r\n        if (!this._selHover) {\r\n            return\r\n        }\r\n        this._selHover.className = String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi, \"\"));\r\n        this._selHover = null \r\n    }\r\n    ;\r\n    this._unloadSelector = function(v) {\r\n        if (!this._sel) {\r\n            return\r\n        }\r\n        if (!this._sel._ta[v]) {\r\n            return\r\n        }\r\n        if (v == \"month\") {\r\n            this.msCont.onclick = this.msCont.ontouchstart = null ;\r\n            this._msActive = null ;\r\n            for (var u in this._msCells) {\r\n                this._msCells[u]._cell = null ;\r\n                this._msCells[u]._month = null ;\r\n                this._msCells[u].parentNode.removeChild(this._msCells[u]);\r\n                this._msCells[u] = null \r\n            }\r\n            this._msCells = null ;\r\n            while (this.msCont.childNodes.length > 0) {\r\n                this.msCont.removeChild(this.msCont.lastChild)\r\n            }\r\n            this.msCont.parentNode.removeChild(this.msCont);\r\n            this.msCont = null \r\n        }\r\n        if (v == \"year\") {\r\n            this.ysCont.onclick = this.ysCont.ontouchstart = null ;\r\n            for (var u in this._ysCells) {\r\n                this._ysCells[u]._cell = null ;\r\n                this._ysCells[u]._year = null ;\r\n                this._ysCells[u].parentNode.removeChild(this._ysCells[u]);\r\n                this._ysCells[u] = null \r\n            }\r\n            this._ysCells = null ;\r\n            while (this.ysCont.childNodes.length > 0) {\r\n                this.ysCont.removeChild(this.ysCont.lastChild)\r\n            }\r\n            this.ysCont.parentNode.removeChild(this.ysCont);\r\n            this.ysCont = null \r\n        }\r\n        if (v == \"hours\") {\r\n            this.hsCont.onclick = this.hsCont.ontouchstart = null ;\r\n            this._hsActive = null ;\r\n            for (var u in this._hsCells) {\r\n                this._hsCells[u]._cell = null ;\r\n                this._hsCells[u]._hours = null ;\r\n                this._hsCells[u].parentNode.removeChild(this._hsCells[u]);\r\n                this._hsCells[u] = null \r\n            }\r\n            this._hsCells = null ;\r\n            while (this.hsCont.childNodes.length > 0) {\r\n                this.hsCont.removeChild(this.hsCont.lastChild)\r\n            }\r\n            this.hsCont.parentNode.removeChild(this.hsCont);\r\n            this.hsCont = null \r\n        }\r\n        if (v == \"minutes\") {\r\n            this.rsCont.onclick = this.rsCont.ontouchstart = null ;\r\n            this._rsActive = null ;\r\n            for (var u in this._rsCells) {\r\n                this._rsCells[u]._cell = null ;\r\n                this._rsCells[u]._minutes = null ;\r\n                this._rsCells[u].parentNode.removeChild(this._rsCells[u]);\r\n                this._rsCells[u] = null \r\n            }\r\n            this._rsCells = null ;\r\n            while (this.rsCont.childNodes.length > 0) {\r\n                this.rsCont.removeChild(this.rsCont.lastChild)\r\n            }\r\n            this.rsCont.parentNode.removeChild(this.rsCont);\r\n            this.rsCont = null \r\n        }\r\n        this._sel._ta[v] = null \r\n    }\r\n    ;\r\n    this.setMinutesInterval = function(a) {\r\n        if (!(a == 1 || a == 5 || a == 10 || a == 15)) {\r\n            return\r\n        }\r\n        this._minutesInterval = a;\r\n        this._unloadSelector(\"minutes\")\r\n    }\r\n    ;\r\n    this._updateActiveMonth = function() {\r\n        if (typeof (this._msActive) != \"undefined\" && typeof (this._msCells[this._msActive]) != \"undefined\") {\r\n            this._msCells[this._msActive].className = \"dhtmlxcalendar_selector_cell\"\r\n        }\r\n        this._msActive = this._activeMonth.getMonth();\r\n        this._msCells[this._msActive].className = \"dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active\"\r\n    }\r\n    ;\r\n    this._updateActiveYear = function() {\r\n        var a = this._activeMonth.getFullYear();\r\n        if (this._ysCells[a]) {\r\n            this._ysCells[a].className = \"dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active\"\r\n        }\r\n    }\r\n    ;\r\n    this._updateYearsList = function(A) {\r\n        for (var v in this._ysCells) {\r\n            this._ysCells[v] = null ;\r\n            delete this._ysCells[v]\r\n        }\r\n        var x = 12 * Math.floor(A.getFullYear() / 12);\r\n        for (var y = 0; y < 4; y++) {\r\n            for (var u = 0; u < 3; u++) {\r\n                this.ysCont.childNodes[y].childNodes[u].innerHTML = x;\r\n                this.ysCont.childNodes[y].childNodes[u]._year = x;\r\n                this.ysCont.childNodes[y].childNodes[u].className = \"dhtmlxcalendar_selector_cell\";\r\n                this._ysCells[x++] = this.ysCont.childNodes[y].childNodes[u]\r\n            }\r\n        }\r\n        this._updateActiveYear()\r\n    }\r\n    ;\r\n    this._scrollYears = function(a) {\r\n        var v = (a < 0 ? this.ysCont.firstChild.firstChild._year : this.ysCont.lastChild.lastChild._year) + a;\r\n        var u = new Date(v,this._activeMonth.getMonth(),1,0,0,0,0);\r\n        this._updateYearsList(u)\r\n    }\r\n    ;\r\n    this._updateActiveHours = function() {\r\n        if (typeof (this._hsActive) != \"undefined\" && typeof (this._hsCells[this._hsActive]) != \"undefined\") {\r\n            this._hsCells[this._hsActive].className = \"dhtmlxcalendar_selector_cell\"\r\n        }\r\n        this._hsActive = this._activeDate.getHours();\r\n        this._hsCells[this._hsActive].className = \"dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active\"\r\n    }\r\n    ;\r\n    this._updateVisibleHours = function() {\r\n        this.contTime.firstChild.firstChild.childNodes[1].innerHTML = this._fixLength(this._activeDate.getHours(), 2)\r\n    }\r\n    ;\r\n    this._updateActiveMinutes = function() {\r\n        if (this._rsActive != null  && typeof (this._rsActive) != \"undefined\" && typeof (this._rsCells[this._rsActive]) != \"undefined\") {\r\n            this._rsCells[this._rsActive].className = \"dhtmlxcalendar_selector_cell\"\r\n        }\r\n        if (this._minutesInterval == 1) {\r\n            this._rsActive = (this.getFormatedDate(\"%i\").toString()).charAt(this._selectorMode == 1 ? 0 : 1)\r\n        } else {\r\n            this._rsActive = this._activeDate.getMinutes()\r\n        }\r\n        if (typeof (this._rsCells[this._rsActive]) != \"undefined\") {\r\n            this._rsCells[this._rsActive].className = \"dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active\"\r\n        }\r\n    }\r\n    ;\r\n    this._updateVisibleMinutes = function(u) {\r\n        var a = this._fixLength(this._activeDate.getMinutes(), 2).toString();\r\n        if (u == true) {\r\n            a = a.charAt(0) + \"<span class='dhtmlxcalendar_selected_date'>\" + a.charAt(1) + \"</span>\"\r\n        }\r\n        this.contTime.firstChild.firstChild.childNodes[3].innerHTML = a;\r\n        if (u == true) {\r\n            this.contTime.firstChild.firstChild.childNodes[3].lastChild._par = true\r\n        }\r\n    }\r\n    ;\r\n    this._fixLength = function(a, u) {\r\n        while (String(a).length < u) {\r\n            a = \"0\" + String(a)\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this._dateFormat = \"\";\r\n    this._dateFormatRE = null ;\r\n    this.setDateFormat = function(x) {\r\n        var w = {};\r\n        if (this._strToDate != null ) {\r\n            for (var u in this.i) {\r\n                if (this.i[u].input != null  && this.i[u].input.value.length > 0) {\r\n                    var y = this._strToDate(this.i[u].input.value, this._dateFormat || this.langData[this.lang].dateformat || \"%Y-%m-%d\");\r\n                    if (y instanceof Date) {\r\n                        w[u] = y\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._dateFormat = x;\r\n        var v = String(this._dateFormat).replace(/%[a-zA-Z]+/g, function(a) {\r\n            var A = a.replace(/%/, \"\");\r\n            switch (A) {\r\n            case \"n\":\r\n            case \"h\":\r\n            case \"j\":\r\n            case \"g\":\r\n            case \"G\":\r\n                return \"\\\\d{1,2}\";\r\n            case \"m\":\r\n            case \"d\":\r\n            case \"H\":\r\n            case \"i\":\r\n            case \"s\":\r\n            case \"y\":\r\n                return \"\\\\d{2}\";\r\n            case \"Y\":\r\n                return \"\\\\d{4}\";\r\n            case \"M\":\r\n                return \"(\" + h.langData[h.lang].monthesSNames.join(\"|\").toLowerCase() + \"){1,}\";\r\n            case \"F\":\r\n                return \"(\" + h.langData[h.lang].monthesFNames.join(\"|\").toLowerCase() + \"){1,}\";\r\n            case \"D\":\r\n                return \"[a-z]{2}\";\r\n            case \"a\":\r\n            case \"A\":\r\n                return \"AM|PM\";\r\n            case \"u\":\r\n                return \"\\\\d{1,6}\";\r\n            case \"P\":\r\n                return \"[\\\\+\\\\-]\\\\d{1,2}\\\\:\\\\d{1,2}\"\r\n            }\r\n            return a\r\n        });\r\n        this._dateFormatRE = new RegExp(v,\"i\");\r\n        for (var u in w) {\r\n            this.i[u].input.value = this._dateToStr(w[u])\r\n        }\r\n        w = null \r\n    }\r\n    ;\r\n    this.setDateFormat(this.langData[this.lang].dateformat || \"%Y-%m-%d\");\r\n    this._updateDateStr = function(u) {\r\n        if (!this._dateFormatRE || !u.match(this._dateFormatRE)) {\r\n            return\r\n        }\r\n        if (u == this.getFormatedDate()) {\r\n            return\r\n        }\r\n        var a = this._strToDate(u);\r\n        if (!(a instanceof Date)) {\r\n            return\r\n        }\r\n        if (this.checkEvent(\"onBeforeChange\")) {\r\n            if (!this.callEvent(\"onBeforeChange\", [new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds())])) {\r\n                if (this.i != null  && this._activeInp != null  && this.i[this._activeInp] != null  && this.i[this._activeInp].input != null ) {\r\n                    this.i[this._activeInp].input.value = this.getFormatedDate()\r\n                }\r\n                return\r\n            }\r\n        }\r\n        this._nullDate = false;\r\n        this._activeDate = a;\r\n        this._drawMonth(this._nullDate ? new Date() : this._activeDate);\r\n        this._updateVisibleMinutes();\r\n        this._updateVisibleHours();\r\n        if (this._sel && this._isSelectorVisible()) {\r\n            this._doOnSelectorShow(this._sel._t)\r\n        }\r\n        this._doOnSelectorChange(true)\r\n    }\r\n    ;\r\n    this.showMonth = function(a) {\r\n        if (typeof (a) == \"string\") {\r\n            a = this._strToDate(a)\r\n        }\r\n        if (!(a instanceof Date)) {\r\n            return\r\n        }\r\n        this._drawMonth(a)\r\n    }\r\n    ;\r\n    this.setFormatedDate = function(x, y, u, w) {\r\n        var v = this._strToDate(y, x);\r\n        if (w) {\r\n            return v\r\n        }\r\n        this.setDate(v)\r\n    }\r\n    ;\r\n    this.getFormatedDate = function(u, a) {\r\n        if (!(a && a instanceof Date)) {\r\n            if (this._nullDate) {\r\n                return \"\"\r\n            }\r\n            a = new Date(this._activeDate)\r\n        }\r\n        return this._dateToStr(a, u)\r\n    }\r\n    ;\r\n    this.getWeekNumber = function(y) {\r\n        if (typeof (y) == \"string\") {\r\n            y = this._strToDate(y)\r\n        }\r\n        if (!(y instanceof Date)) {\r\n            return \"Invalid Date\"\r\n        }\r\n        if (typeof (this._ftDay) == \"undefined\") {\r\n            this._ftDay = 4\r\n        }\r\n        var H = this._wStart;\r\n        var x = H + 7;\r\n        var F = 4;\r\n        var v = new Date(y.getFullYear(),0,1,0,0,0,0);\r\n        var w = v.getDay();\r\n        if (w == 0) {\r\n            w = 7\r\n        }\r\n        if (F < H) {\r\n            F += 7;\r\n            w += 7\r\n        }\r\n        var D = 0;\r\n        if (w >= H && w <= F) {} else {\r\n            D = 1\r\n        }\r\n        var C = w - H;\r\n        var E = new Date(y.getFullYear(),0,1 - C + D * 7,0,0,0,0);\r\n        var J = 604800000;\r\n        var u = new Date(y.getFullYear(),y.getMonth(),y.getDate() + 1,0,0,0,0);\r\n        var I = Math.ceil((u.getTime() - E.getTime()) / J);\r\n        if (I == 0) {\r\n            var A = new Date(y.getFullYear(),y.getMonth(),y.getDate(),0,0,0,0);\r\n            var a = A.getDay() - this._wStart;\r\n            if (a < 0) {\r\n                a = a + 7\r\n            }\r\n            A.setDate(A.getDate() - a);\r\n            I = this.getWeekNumber(A)\r\n        }\r\n        return I\r\n    }\r\n    ;\r\n    this.showWeekNumbers = function() {\r\n        this.base.firstChild.className = \"dhtmlxcalendar_wn\"\r\n    }\r\n    ;\r\n    this.hideWeekNumbers = function() {\r\n        this.base.firstChild.className = \"\"\r\n    }\r\n    ;\r\n    this.show = function(v) {\r\n        if (!v && this._hasParent) {\r\n            this._show();\r\n            return\r\n        }\r\n        if (typeof (v) == \"object\" && typeof (v._dhtmlxcalendar_uid) != \"undefined\" && this.i[v._dhtmlxcalendar_uid] == v) {\r\n            this._show(v._dhtmlxcalendar_uid);\r\n            return\r\n        }\r\n        if (typeof (v) == \"undefined\") {\r\n            for (var u in this.i) {\r\n                if (!v) {\r\n                    v = u\r\n                }\r\n            }\r\n        }\r\n        if (!v) {\r\n            return\r\n        }\r\n        this._show(v)\r\n    }\r\n    ;\r\n    this.hide = function() {\r\n        if (this._isVisible()) {\r\n            this._hide()\r\n        }\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return this._isVisible()\r\n    }\r\n    ;\r\n    this._activeInp = null ;\r\n    this.pos = \"bottom\";\r\n    this.setPosition = function(a, u) {\r\n        this._px = null ;\r\n        this._py = null ;\r\n        if (a == \"right\" || a == \"bottom\") {\r\n            this.pos = a\r\n        } else {\r\n            this.pos = \"int\";\r\n            if (typeof (a) != \"undefined\" && !isNaN(a)) {\r\n                this.base.style.left = a + \"px\";\r\n                this._px = a\r\n            }\r\n            if (typeof (u) != \"undefined\" && !isNaN(u)) {\r\n                this.base.style.top = u + \"px\";\r\n                this._py = u\r\n            }\r\n            this._ifrSize()\r\n        }\r\n    }\r\n    ;\r\n    this._show = function(C, u) {\r\n        if (u === true && this._activeInp == C && this._isVisible()) {\r\n            this._hide();\r\n            return\r\n        }\r\n        this.base.style.visibility = \"hidden\";\r\n        this.base.style.display = \"\";\r\n        if (!C) {\r\n            if (this._px != null  && this._py != null ) {\r\n                this.base.style.left = this._px + \"px\";\r\n                this.base.style.top = this._py + \"px\"\r\n            } else {\r\n                this.base.style.left = \"0px\";\r\n                this.base.style.top = \"0px\"\r\n            }\r\n        } else {\r\n            if (this.base.className.indexOf(\"dhtmlxcalendar_in_input\") == -1) {\r\n                this.base.className += \" dhtmlxcalendar_in_input\"\r\n            }\r\n            var v = (this.i[C].input || this.i[C].button);\r\n            var D = window.dhx4.screenDim();\r\n            var A = {\r\n                top: window.dhx4.absTop(v),\r\n                left: window.dhx4.absLeft(v)\r\n            };\r\n            if (this.pos == \"right\") {\r\n                this.base.style.left = A.left + v.offsetWidth + \"px\";\r\n                this.base.style.top = Math.min(A.top, D.bottom - this.base.offsetHeight) + \"px\"\r\n            } else {\r\n                if (this.pos == \"bottom\") {\r\n                    var y = A.top + v.offsetHeight + 1;\r\n                    if (y + this.base.offsetHeight > D.bottom) {\r\n                        var w = A.top - this.base.offsetHeight;\r\n                        if (w >= -20) {\r\n                            y = w\r\n                        }\r\n                    }\r\n                    var a = A.left;\r\n                    if (a + this.base.offsetWidth > D.right) {\r\n                        a = Math.max(0, A.left + v.offsetWidth - this.base.offsetWidth)\r\n                    }\r\n                    this.base.style.left = a + \"px\";\r\n                    this.base.style.top = y + \"px\"\r\n                } else {\r\n                    this.base.style.left = (this._px || 0) + \"px\";\r\n                    this.base.style.top = (this._py || 0) + \"px\"\r\n                }\r\n            }\r\n            this._activeInp = C;\r\n            v = null \r\n        }\r\n        this._hideSelector();\r\n        this.base.style.visibility = \"visible\";\r\n        this.base.style.zIndex = window.dhx4.zim.reserve(this.conf.zi);\r\n        this._ifrSize();\r\n        if (this._ifr) {\r\n            this._ifr.style.display = \"\"\r\n        }\r\n        this.callEvent(\"onShow\", [])\r\n    }\r\n    ;\r\n    this._hide = function() {\r\n        if (this._lastHover != null ) {\r\n            this._clearDayHover()\r\n        }\r\n        this._hideSelector();\r\n        this.base.style.display = \"none\";\r\n        window.dhx4.zim.clear(this.conf.zi);\r\n        if (this.base.className.indexOf(\"dhtmlxcalendar_in_input\") >= 0) {\r\n            this.base.className = this.base.className.replace(/\\s{0,}dhtmlxcalendar_in_input/gi, \"\")\r\n        }\r\n        this._activeInp = null ;\r\n        if (this._ifr) {\r\n            this._ifr.style.display = \"none\"\r\n        }\r\n        this.callEvent(\"onHide\", [])\r\n    }\r\n    ;\r\n    this._isVisible = function() {\r\n        return ( this.base.style.display != \"none\") \r\n    }\r\n    ;\r\n    this._rangeActive = false;\r\n    this._rangeFrom = null ;\r\n    this._rangeTo = null ;\r\n    this._rangeSet = {};\r\n    this.setInsensitiveDays = function(v) {\r\n        var a = this._extractDates(v);\r\n        for (var u = 0; u < a.length; u++) {\r\n            this._rangeSet[new Date(a[u].getFullYear(),a[u].getMonth(),a[u].getDate(),0,0,0,0).getTime()] = true\r\n        }\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this.clearInsensitiveDays = function() {\r\n        this._clearRangeSet();\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this._holidays = {};\r\n    this.setHolidays = function(u) {\r\n        if (u == null ) {\r\n            this._clearHolidays()\r\n        } else {\r\n            if (u != null ) {\r\n                var a = this._extractDates(u);\r\n                for (var v = 0; v < a.length; v++) {\r\n                    this._holidays[new Date(a[v].getFullYear(),a[v].getMonth(),a[v].getDate(),0,0,0,0).getTime()] = true\r\n                }\r\n            }\r\n        }\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this._extractDates = function(v) {\r\n        if (typeof (v) == \"string\" || v instanceof Date) {\r\n            v = [v]\r\n        }\r\n        var u = [];\r\n        for (var x = 0; x < v.length; x++) {\r\n            if (typeof (v[x]) == \"string\") {\r\n                var y = v[x].split(\",\");\r\n                for (var a = 0; a < y.length; a++) {\r\n                    u.push(this._strToDate(y[a]))\r\n                }\r\n            } else {\r\n                if (v[x] instanceof Date) {\r\n                    u.push(v[x])\r\n                }\r\n            }\r\n        }\r\n        return u\r\n    }\r\n    ;\r\n    this._clearRange = function() {\r\n        this._rangeActive = false;\r\n        this._rangeType = null ;\r\n        this._rangeFrom = null ;\r\n        this._rangeTo = null \r\n    }\r\n    ;\r\n    this._clearRangeSet = function() {\r\n        for (var u in this._rangeSet) {\r\n            this._rangeSet[u] = null ;\r\n            delete this._rangeSet[u]\r\n        }\r\n    }\r\n    ;\r\n    this._clearHolidays = function() {\r\n        for (var u in this._holidays) {\r\n            this._holidays[u] = null ;\r\n            delete this._holidays[u]\r\n        }\r\n    }\r\n    ;\r\n    this._isOutOfRange = function(u) {\r\n        if (this._rangeSet[u] == true) {\r\n            return true\r\n        }\r\n        if (this._rangeActive) {\r\n            if (this._rangeType == \"in\" && (u < this._rangeFrom || u > this._rangeTo)) {\r\n                return true\r\n            }\r\n            if (this._rangeType == \"out\" && (u >= this._rangeFrom && u <= this._rangeTo)) {\r\n                return true\r\n            }\r\n            if (this._rangeType == \"from\" && u < this._rangeFrom) {\r\n                return true\r\n            }\r\n            if (this._rangeType == \"to\" && u > this._rangeTo) {\r\n                return true\r\n            }\r\n        }\r\n        var a = new Date(u);\r\n        if (this._rangeWeek) {\r\n            if (this._rangeWeekData[a.getDay()] === true) {\r\n                return true\r\n            }\r\n        }\r\n        if (this._rangeMonth) {\r\n            if (this._rangeMonthData[a.getDate()] === true) {\r\n                return true\r\n            }\r\n        }\r\n        if (this._rangeYear) {\r\n            if (this._rangeYearData[a.getMonth() + \"_\" + a.getDate()] === true) {\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this.clearSensitiveRange = function() {\r\n        this._clearRange();\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this.setSensitiveRange = function(w, v, a) {\r\n        var u = false;\r\n        if (w != null  && v != null ) {\r\n            if (!(w instanceof Date)) {\r\n                w = this._strToDate(w)\r\n            }\r\n            if (!(v instanceof Date)) {\r\n                v = this._strToDate(v)\r\n            }\r\n            if (w.getTime() > v.getTime()) {\r\n                return\r\n            }\r\n            this._rangeFrom = new Date(w.getFullYear(),w.getMonth(),w.getDate(),0,0,0,0).getTime();\r\n            this._rangeTo = new Date(v.getFullYear(),v.getMonth(),v.getDate(),0,0,0,0).getTime();\r\n            this._rangeActive = true;\r\n            this._rangeType = \"in\";\r\n            u = true\r\n        }\r\n        if (!u && w != null  && v == null ) {\r\n            if (!(w instanceof Date)) {\r\n                w = this._strToDate(w)\r\n            }\r\n            this._rangeFrom = new Date(w.getFullYear(),w.getMonth(),w.getDate(),0,0,0,0).getTime();\r\n            this._rangeTo = null ;\r\n            if (a === true) {\r\n                this._rangeFrom++\r\n            }\r\n            this._rangeActive = true;\r\n            this._rangeType = \"from\";\r\n            u = true\r\n        }\r\n        if (!u && w == null  && v != null ) {\r\n            if (!(v instanceof Date)) {\r\n                v = this._strToDate(v)\r\n            }\r\n            this._rangeFrom = null ;\r\n            this._rangeTo = new Date(v.getFullYear(),v.getMonth(),v.getDate(),0,0,0,0).getTime();\r\n            if (a === true) {\r\n                this._rangeTo--\r\n            }\r\n            this._rangeActive = true;\r\n            this._rangeType = \"to\";\r\n            u = true\r\n        }\r\n        if (u) {\r\n            this._drawMonth(this._activeMonth)\r\n        }\r\n    }\r\n    ;\r\n    this.setInsensitiveRange = function(u, a) {\r\n        if (u != null  && a != null ) {\r\n            if (!(u instanceof Date)) {\r\n                u = this._strToDate(u)\r\n            }\r\n            if (!(a instanceof Date)) {\r\n                a = this._strToDate(a)\r\n            }\r\n            if (u.getTime() > a.getTime()) {\r\n                return\r\n            }\r\n            this._rangeFrom = new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0).getTime();\r\n            this._rangeTo = new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0).getTime();\r\n            this._rangeActive = true;\r\n            this._rangeType = \"out\";\r\n            this._drawMonth(this._activeMonth);\r\n            return\r\n        }\r\n        if (u != null  && a == null ) {\r\n            this.setSensitiveRange(null , u, true);\r\n            return\r\n        }\r\n        if (u == null  && a != null ) {\r\n            this.setSensitiveRange(a, null , true);\r\n            return\r\n        }\r\n    }\r\n    ;\r\n    this.disableDays = function(y, x) {\r\n        if (y == \"week\") {\r\n            if (typeof (x) != \"object\" && typeof (x.length) == \"undefined\") {\r\n                x = [x]\r\n            }\r\n            if (!this._rangeWeekData) {\r\n                this._rangeWeekData = {}\r\n            }\r\n            for (var u in this._rangeWeekData) {\r\n                this._rangeWeekData[u] = false;\r\n                delete this._rangeWeekData[u]\r\n            }\r\n            for (var w = 0; w < x.length; w++) {\r\n                this._rangeWeekData[x[w]] = true;\r\n                if (x[w] == 7) {\r\n                    this._rangeWeekData[0] = true\r\n                }\r\n            }\r\n            this._rangeWeek = true\r\n        }\r\n        if (y == \"month\") {\r\n            if (typeof (x) != \"object\" && typeof (x.length) == \"undefined\") {\r\n                x = [x]\r\n            }\r\n            if (!this._rangeMonthData) {\r\n                this._rangeMonthData = {}\r\n            }\r\n            for (var u in this._rangeMonthData) {\r\n                this._rangeMonthData[u] = false;\r\n                delete this._rangeMonthData[u]\r\n            }\r\n            for (var w = 0; w < x.length; w++) {\r\n                this._rangeMonthData[x[w]] = true\r\n            }\r\n            this._rangeMonth = true\r\n        }\r\n        if (y == \"year\") {\r\n            var v = this._extractDates(x);\r\n            if (!this._rangeYearData) {\r\n                this._rangeYearData = {}\r\n            }\r\n            for (var u in this._rangeYearData) {\r\n                this._rangeYearData[u] = false;\r\n                delete this._rangeYearData[u]\r\n            }\r\n            for (var w = 0; w < v.length; w++) {\r\n                this._rangeYearData[v[w].getMonth() + \"_\" + v[w].getDate()] = true\r\n            }\r\n            this._rangeYear = true\r\n        }\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this.enableDays = function(a) {\r\n        if (a == \"week\") {\r\n            this._rangeWeek = false\r\n        }\r\n        if (a == \"month\") {\r\n            this._rangeMonth = false\r\n        }\r\n        if (a == \"year\") {\r\n            this._rangeYear = false\r\n        }\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this._tipData = {};\r\n    this._tipTM = null ;\r\n    this._tipTMTime = 400;\r\n    this._tipEvs = false;\r\n    this._tipPopup = null ;\r\n    this._tipCellDate = null ;\r\n    this._tipCellDim = null ;\r\n    this.setTooltip = function(v, y, A, a) {\r\n        var w = this._extractDates(v);\r\n        for (var x = 0; x < w.length; x++) {\r\n            var u = new Date(w[x].getFullYear(),w[x].getMonth(),w[x].getDate(),0,0,0,0).getTime();\r\n            this._tipData[u] = {\r\n                text: y,\r\n                showIcon: A,\r\n                usePopup: a\r\n            }\r\n        }\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this.clearTooltip = function(u) {\r\n        var v = this._extractDates(u);\r\n        for (var w = 0; w < v.length; w++) {\r\n            var a = new Date(v[w].getFullYear(),v[w].getMonth(),v[w].getDate(),0,0,0,0).getTime();\r\n            this._tipData[a] = null ;\r\n            delete this._tipData[a]\r\n        }\r\n        this._drawMonth(this._activeMonth)\r\n    }\r\n    ;\r\n    this._initTooltipPopup = function() {\r\n        if (this._tipEvs) {\r\n            return\r\n        }\r\n        this.attachEvent(\"onMouseOver\", function(u) {\r\n            var a = new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0).getTime();\r\n            if (this._tipData[a] != null ) {\r\n                if (this._tipTM) {\r\n                    window.clearTimeout(this._tipTM)\r\n                }\r\n                this._tipCellDate = u;\r\n                this._tipCellDim = this.getCellDimension(u);\r\n                this._tipText = this._tipData[a].text;\r\n                this._tipTM = window.setTimeout(this._showTooltipPopup, this._tipTMTime)\r\n            }\r\n        });\r\n        this.attachEvent(\"onMouseOut\", this._hideTooltipPopup);\r\n        this._tipEvs = true\r\n    }\r\n    ;\r\n    this._showTooltipPopup = function(A, a, C, u, v) {\r\n        if (!h._tipPopup) {\r\n            h._tipPopup = new dhtmlXPopup({\r\n                mode: \"top\"\r\n            })\r\n        }\r\n        h._tipPopup.attachHTML(h._tipText);\r\n        h._tipPopup.show(h._tipCellDim.x, h._tipCellDim.y, h._tipCellDim.w, h._tipCellDim.h);\r\n        h.callEvent(\"onPopupShow\", [h._tipCellDate])\r\n    }\r\n    ;\r\n    this._hideTooltipPopup = function() {\r\n        if (this._tipTM) {\r\n            window.clearTimeout(this._tipTM)\r\n        }\r\n        if (this._tipPopup != null  && this._tipPopup.isVisible()) {\r\n            this._tipPopup.hide();\r\n            this.callEvent(\"onPopupHide\", [this._tipCellDate])\r\n        }\r\n    }\r\n    ;\r\n    this.getPopup = function() {\r\n        return this._tipPopup\r\n    }\r\n    ;\r\n    this.getCellDimension = function(v) {\r\n        if (typeof (v) == \"string\") {\r\n            v = this._strToDate(v)\r\n        }\r\n        if (!(v instanceof Date)) {\r\n            return null \r\n        }\r\n        var x = new Date(v.getFullYear(),v.getMonth(),v.getDate(),0,0,0,0).getTime();\r\n        var u = null ;\r\n        for (var y = 0; y < this.contDates.childNodes.length; y++) {\r\n            for (var a = 0; a < this.contDates.childNodes[y].childNodes.length; a++) {\r\n                var A = this.contDates.childNodes[y].childNodes[a];\r\n                if (A._date != null  && A._date.getTime() == x) {\r\n                    u = {\r\n                        x: window.dhx4.absLeft(A),\r\n                        y: window.dhx4.absTop(A),\r\n                        w: A.offsetWidth,\r\n                        h: A.offsetHeight\r\n                    }\r\n                }\r\n                A = null \r\n            }\r\n        }\r\n        return u\r\n    }\r\n    ;\r\n    this._updateFromInput = function(a) {\r\n        if (this._nullInInput && ((a.value).replace(/\\s/g, \"\")).length == 0) {\r\n            if (this.checkEvent(\"onBeforeChange\")) {\r\n                if (!this.callEvent(\"onBeforeChange\", [null ])) {\r\n                    if (this.i != null  && this._activeInp != null  && this.i[this._activeInp] != null  && this.i[this._activeInp].input != null ) {\r\n                        this.i[this._activeInp].input.value = this.getFormatedDate()\r\n                    }\r\n                    return\r\n                }\r\n            }\r\n            this.setDate(null )\r\n        } else {\r\n            this._updateDateStr(a.value)\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._doOnClick = function(u) {\r\n        u = u || event;\r\n        var a = (u.target || u.srcElement);\r\n        if (a._dhtmlxcalendar_uid && a._dhtmlxcalendar_uid != h._activeInp && h._isVisible() && h._activeInp) {\r\n            h._hide();\r\n            return\r\n        }\r\n        if (!a._dhtmlxcalendar_uid || !h.i[a._dhtmlxcalendar_uid]) {\r\n            if (h._isSelectorVisible()) {\r\n                h._hideSelector()\r\n            } else {\r\n                if (!h._hasParent && h._isVisible()) {\r\n                    h._hide()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._doOnKeyDown = function(a) {\r\n        a = a || event;\r\n        if (a.keyCode == 27 || a.keyCode == 13) {\r\n            if (h._isSelectorVisible()) {\r\n                h._hideSelector()\r\n            } else {\r\n                if (h._isVisible() && !h._hasParent) {\r\n                    h._hide()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._doOnInpClick = function(u) {\r\n        u = u || event;\r\n        if (u.type == \"touchstart\" && u.preventDefault != null ) {\r\n            u.preventDefault()\r\n        }\r\n        var a = (u.target || u.srcElement);\r\n        if (!a._dhtmlxcalendar_uid) {\r\n            return\r\n        }\r\n        if (!h._listenerEnabled) {\r\n            h._updateFromInput(a)\r\n        }\r\n        h._show(a._dhtmlxcalendar_uid, true)\r\n    }\r\n    ;\r\n    this._doOnInpKeyUp = function(u) {\r\n        u = u || event;\r\n        var a = (u.target || u.srcElement);\r\n        if (u.keyCode == 13 || !a._dhtmlxcalendar_uid) {\r\n            return\r\n        }\r\n        if (!h._listenerEnabled) {\r\n            h._updateFromInput(a)\r\n        }\r\n    }\r\n    ;\r\n    this._doOnBtnClick = function(u) {\r\n        u = u || event;\r\n        if (u.type == \"touchstart\" && u.preventDefault != null ) {\r\n            u.preventDefault()\r\n        }\r\n        var a = (u.target || u.srcElement);\r\n        if (!a._dhtmlxcalendar_uid) {\r\n            return\r\n        }\r\n        if (h.i[a._dhtmlxcalendar_uid].input != null ) {\r\n            h._updateFromInput(h.i[a._dhtmlxcalendar_uid].input)\r\n        }\r\n        h._show(a._dhtmlxcalendar_uid, true)\r\n    }\r\n    ;\r\n    this._doOnUnload = function() {\r\n        if (h && h.unload) {\r\n            h.unload()\r\n        }\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        document.body.addEventListener(\"click\", h._doOnClick, false);\r\n        window.addEventListener(\"keydown\", h._doOnKeyDown, false);\r\n        window.addEventListener(\"unload\", h._doOnUnload, false);\r\n        if (this.conf.touch == true) {\r\n            document.body.addEventListener(\"touchstart\", h._doOnClick, false)\r\n        }\r\n    } else {\r\n        document.body.attachEvent(\"onclick\", h._doOnClick);\r\n        document.body.attachEvent(\"onkeydown\", h._doOnKeyDown);\r\n        window.attachEvent(\"onunload\", h._doOnUnload)\r\n    }\r\n    this.attachObj = function(v) {\r\n        var u = window.dhx4.newId();\r\n        if (typeof (v) == \"string\") {\r\n            this.i[u] = {\r\n                input: document.getElementById(v)\r\n            }\r\n        } else {\r\n            if (typeof (v.tagName) != \"undefined\") {\r\n                this.i[u] = {\r\n                    input: v\r\n                }\r\n            } else {\r\n                if (typeof (v) == \"object\" && (v.input != null  || v.button != null )) {\r\n                    this.i[u] = {};\r\n                    if (v.input != null ) {\r\n                        this.i[u].input = (typeof (v.input) == \"string\" ? document.getElementById(v.input) : v.input)\r\n                    }\r\n                    if (v.button != null ) {\r\n                        this.i[u].button = (typeof (v.button) == \"string\" ? document.getElementById(v.button) : v.button)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._attachEventsToObject(u);\r\n        return u\r\n    }\r\n    ;\r\n    this.detachObj = function(w) {\r\n        var v = null ;\r\n        if (this.i[w] != null ) {\r\n            v = w\r\n        } else {\r\n            if (typeof (w) == \"string\") {\r\n                w = document.getElementById(w);\r\n                v = w._dhtmlxcalendar_uid\r\n            } else {\r\n                if (typeof (w.tagName) != \"undefined\") {\r\n                    v = w._dhtmlxcalendar_uid\r\n                } else {\r\n                    if (typeof (w) == \"object\" && (w.input != null  || w.button != null )) {\r\n                        if (v == null  && w.input != null ) {\r\n                            v = (typeof (w.input) == \"string\" ? document.getElementById(w.input) : w.input)._dhtmlxcalendar_uid\r\n                        }\r\n                        if (v == null  && w.button != null ) {\r\n                            v = (typeof (w.button) == \"string\" ? document.getElementById(w.button) : w.button)._dhtmlxcalendar_uid\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (v != null  && this.i[v] != null ) {\r\n            this._detachEventsFromObject(v);\r\n            for (var u in this.i[u]) {\r\n                this.i[v][u]._dhtmlxcalendar_uid = null ;\r\n                this.i[v][u] = null ;\r\n                delete this.i[v][u]\r\n            }\r\n            this.i[v] = null ;\r\n            delete this.i[v];\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._attachEventsToObject = function(u) {\r\n        if (this.i[u].button != null ) {\r\n            this.i[u].button._dhtmlxcalendar_uid = u;\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                this.i[u].button.addEventListener(\"click\", h._doOnBtnClick, false);\r\n                if (this.conf.touch == true) {\r\n                    this.i[u].button.addEventListener(\"touchstart\", h._doOnBtnClick, false)\r\n                }\r\n            } else {\r\n                this.i[u].button.attachEvent(\"onclick\", h._doOnBtnClick)\r\n            }\r\n        } else {\r\n            if (this.i[u].input != null ) {\r\n                this.i[u].input._dhtmlxcalendar_uid = u;\r\n                if (typeof (window.addEventListener) == \"function\") {\r\n                    this.i[u].input.addEventListener(\"click\", h._doOnInpClick, false);\r\n                    this.i[u].input.addEventListener(\"keyup\", h._doOnInpKeyUp, false);\r\n                    if (this.conf.touch == true) {\r\n                        this.i[u].input.addEventListener(\"touchstart\", h._doOnInpClick, false)\r\n                    }\r\n                } else {\r\n                    this.i[u].input.attachEvent(\"onclick\", h._doOnInpClick);\r\n                    this.i[u].input.attachEvent(\"onkeyup\", h._doOnInpKeyUp)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._detachEventsFromObject = function(u) {\r\n        if (this.i[u].button != null ) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                this.i[u].button.removeEventListener(\"click\", h._doOnBtnClick, false);\r\n                if (this.conf.touch == true) {\r\n                    this.i[u].button.removeEventListener(\"touchstart\", h._doOnBtnClick, false)\r\n                }\r\n            } else {\r\n                this.i[u].button.detachEvent(\"onclick\", h._doOnBtnClick)\r\n            }\r\n        } else {\r\n            if (this.i[u].input != null ) {\r\n                if (typeof (window.addEventListener) == \"function\") {\r\n                    this.i[u].input.removeEventListener(\"click\", h._doOnInpClick, false);\r\n                    this.i[u].input.removeEventListener(\"keyup\", h._doOnInpKeyUp, false);\r\n                    if (this.conf.touch == true) {\r\n                        this.i[u].input.removeEventListener(\"touchstart\", h._doOnInpClick, false)\r\n                    }\r\n                } else {\r\n                    this.i[u].input.detachEvent(\"onclick\", h._doOnInpClick);\r\n                    this.i[u].input.detachEvent(\"onkeyup\", h._doOnInpKeyUp)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.enableListener = function(a) {\r\n        if (!a) {\r\n            return\r\n        }\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            a.addEventListener(\"focus\", h._listenerEvFocus, false);\r\n            a.addEventListener(\"blur\", h._listenerEvBlur, false)\r\n        } else {\r\n            a.attachEvent(\"onfocus\", h._listenerEvFocus);\r\n            a.attachEvent(\"onblur\", h._listenerEvBlur)\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this.disableListener = function(a) {\r\n        if (!a) {\r\n            return\r\n        }\r\n        a._f0 = false;\r\n        if (this._tmListener) {\r\n            window.clearTimeout(this._tmListener)\r\n        }\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            a.removeEventListener(\"focus\", h._listenerEvFocus, false);\r\n            a.removeEventListener(\"blur\", h._listenerEvBlur, false)\r\n        } else {\r\n            a.detachEvent(\"onfocus\", h._listenerEvFocus);\r\n            a.detachEvent(\"onblur\", h._listenerEvBlur)\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._startListener = function(a) {\r\n        if (this._tmListener) {\r\n            window.clearTimeout(this._tmListener)\r\n        }\r\n        if (typeof (a._v1) == \"undefined\") {\r\n            a._v1 = a.value\r\n        }\r\n        if (a._v1 != a.value) {\r\n            this._updateFromInput(a);\r\n            a._v1 = a.value\r\n        }\r\n        if (a._f0) {\r\n            this._tmListener = window.setTimeout(function() {\r\n                h._startListener(a)\r\n            }, 100)\r\n        }\r\n    }\r\n    ;\r\n    this._listenerEvFocus = function(u) {\r\n        u = u || event;\r\n        var a = u.target || u.srcElement;\r\n        a._f0 = true;\r\n        h._startListener(a);\r\n        a = null \r\n    }\r\n    ;\r\n    this._listenerEvBlur = function(u) {\r\n        u = u || event;\r\n        var a = u.target || u.srcElement;\r\n        a._f0 = false;\r\n        a = null \r\n    }\r\n    ;\r\n    for (var n in this.i) {\r\n        this._attachEventsToObject(n)\r\n    }\r\n    window.dhx4._eventable(this);\r\n    this._evOnArrowClick = function(a) {\r\n        return this.callEvent(\"onArrowClick\", a)\r\n    }\r\n    ;\r\n    this._evOnClick = function(a) {\r\n        return this.callEvent(\"onClick\", a)\r\n    }\r\n    ;\r\n    this._evOnMouseOut = function(a) {\r\n        return this.callEvent(\"onMouseOut\", a)\r\n    }\r\n    ;\r\n    this._evOnMouseOver = function(a) {\r\n        return this.callEvent(\"onMouseOver\", a)\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this._activeDate = null ;\r\n        this._activeDateCell = null ;\r\n        this._activeInp = null ;\r\n        this._activeMonth = null ;\r\n        this._dateFormat = null ;\r\n        this._dateFormatRE = null ;\r\n        this._lastHover = null ;\r\n        if (this._tmListener) {\r\n            window.clearTimeout(this._tmListener)\r\n        }\r\n        this._tmListener = null ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            document.body.removeEventListener(\"click\", h._doOnClick, false);\r\n            window.removeEventListener(\"keydown\", h._doOnKeyDown, false);\r\n            window.removeEventListener(\"unload\", h._doOnUnload, false);\r\n            if (this.conf.touch == true) {\r\n                document.body.removeEventListener(\"touchstart\", h._doOnClick, false)\r\n            }\r\n        } else {\r\n            document.body.detachEvent(\"onclick\", h._doOnClick);\r\n            document.body.detachEvent(\"onkeydown\", h._doOnKeyDown);\r\n            window.detachEvent(\"onunload\", h._doOnKeyDown)\r\n        }\r\n        this._doOnClick = null ;\r\n        this._doOnKeyDown = null ;\r\n        this._doOnUnload = null ;\r\n        for (var u in this.i) {\r\n            this.i[u]._dhtmlxcalendar_uid = null ;\r\n            this._detachEventsFromObject(u);\r\n            this.disableListener(this.i[u].input);\r\n            this.i[u] = null ;\r\n            delete this.i[u]\r\n        }\r\n        this.i = null ;\r\n        this._doOnInpClick = null ;\r\n        this._doOnInpKeyUp = null ;\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.contMonth.onselectstart = null ;\r\n        this.contMonth.firstChild.firstChild.onclick = null ;\r\n        this.contMonth.firstChild.firstChild.ontouchstart = null ;\r\n        this.contMonth.firstChild.firstChild.firstChild.onmouseover = null ;\r\n        this.contMonth.firstChild.firstChild.firstChild.onmouseout = null ;\r\n        this.contMonth.firstChild.firstChild.lastChild.onmouseover = null ;\r\n        this.contMonth.firstChild.firstChild.lastChild.onmouseout = null ;\r\n        while (this.contMonth.firstChild.firstChild.childNodes.length > 0) {\r\n            this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild)\r\n        }\r\n        this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);\r\n        this.contMonth.removeChild(this.contMonth.firstChild);\r\n        this.contMonth.parentNode.removeChild(this.contMonth);\r\n        this.contMonth = null ;\r\n        while (this.contDays.firstChild.childNodes.length > 0) {\r\n            this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild)\r\n        }\r\n        this.contDays.removeChild(this.contDays.firstChild);\r\n        this.contDays.parentNode.removeChild(this.contDays);\r\n        this.contDays = null ;\r\n        this.contDates.onclick = null ;\r\n        this.contDates.ontouchstart = null ;\r\n        this.contDates.onmouseover = null ;\r\n        this.contDates.onmouseout = null ;\r\n        while (this.contDates.childNodes.length > 0) {\r\n            while (this.contDates.lastChild.childNodes.length > 0) {\r\n                this.contDates.lastChild.lastChild._css_date = null ;\r\n                this.contDates.lastChild.lastChild._css_month = null ;\r\n                this.contDates.lastChild.lastChild._css_weekend = null ;\r\n                this.contDates.lastChild.lastChild._css_hover = null ;\r\n                this.contDates.lastChild.lastChild._date = null ;\r\n                this.contDates.lastChild.lastChild._q = null ;\r\n                this.contDates.lastChild.lastChild._w = null ;\r\n                this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild)\r\n            }\r\n            this.contDates.removeChild(this.contDates.lastChild)\r\n        }\r\n        this.contDates.parentNode.removeChild(this.contDates);\r\n        this.contDates = null ;\r\n        this.contTime.firstChild.firstChild.onclick = null ;\r\n        this.contTime.firstChild.firstChild.ontouchstart = null ;\r\n        while (this.contTime.firstChild.firstChild.childNodes.length > 0) {\r\n            this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild)\r\n        }\r\n        this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);\r\n        this.contTime.removeChild(this.contTime.firstChild);\r\n        this.contTime.parentNode.removeChild(this.contTime);\r\n        this.contTime = null ;\r\n        this._lastHover = null ;\r\n        this._unloadSelector(\"month\");\r\n        this._unloadSelector(\"year\");\r\n        this._unloadSelector(\"hours\");\r\n        this._unloadSelector(\"minutes\");\r\n        if (this._selCover) {\r\n            this._selCover.parentNode.removeChild(this._selCover);\r\n            this._selCover = null \r\n        }\r\n        if (this._sel) {\r\n            for (var u in this._sel._ta) {\r\n                this._sel._ta[u] = null \r\n            }\r\n            this._sel._ta = null ;\r\n            this._sel._t = null ;\r\n            this._sel.onmouseover = null ;\r\n            this._sel.onmouseout = null ;\r\n            while (this._sel.firstChild.firstChild.firstChild.childNodes.length > 0) {\r\n                this._sel.firstChild.firstChild.firstChild.lastChild.onclick = null ;\r\n                this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover = null ;\r\n                this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout = null ;\r\n                this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild)\r\n            }\r\n            this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);\r\n            this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);\r\n            while (this._sel.childNodes.length > 0) {\r\n                this._sel.removeChild(this._sel.lastChild)\r\n            }\r\n            this._sel.parentNode.removeChild(this._sel);\r\n            this._sel = null \r\n        }\r\n        this.base.onclick = null ;\r\n        this.base.onmousedown = null ;\r\n        this.base.ontouchstart = null ;\r\n        this.base.onmouseout = null ;\r\n        this.base.parentNode.removeChild(this.base);\r\n        this.base = null ;\r\n        this._clearDayHover = null ;\r\n        this._clearSelHover = null ;\r\n        this._doOnSelectorChange = null ;\r\n        this._doOnSelectorShow = null ;\r\n        this._drawMonth = null ;\r\n        this._fixLength = null ;\r\n        this._ifrSize = null ;\r\n        this._hide = null ;\r\n        this._hideSelector = null ;\r\n        this._initSelector = null ;\r\n        this._isSelectorVisible = null ;\r\n        this._isVisible = null ;\r\n        this._scrollYears = null ;\r\n        this._show = null ;\r\n        this._showSelector = null ;\r\n        this._strToDate = null ;\r\n        this._updateActiveHours = null ;\r\n        this._updateActiveMinutes = null ;\r\n        this._updateActiveMonth = null ;\r\n        this._updateActiveYear = null ;\r\n        this._updateCellStyle = null ;\r\n        this._updateDateStr = null ;\r\n        this._updateVisibleHours = null ;\r\n        this._updateVisibleMinutes = null ;\r\n        this._updateYearsList = null ;\r\n        this.enableIframe = null ;\r\n        this.hide = null ;\r\n        this.hideTime = null ;\r\n        this.setDate = null ;\r\n        this.setDateFormat = null ;\r\n        this.setYearsRange = null ;\r\n        this.show = null ;\r\n        this.showTime = null ;\r\n        this.unload = null ;\r\n        if (this._tipPopup != null ) {\r\n            this._tipPopup.unload();\r\n            this._tipPopup = null \r\n        }\r\n        for (var u in this) {\r\n            delete this[u]\r\n        }\r\n        u = h = null \r\n    }\r\n    ;\r\n    this.setDate(this._activeDate);\r\n    return this\r\n}\r\ndhtmlXCalendarObject.prototype.lang = \"en\";\r\ndhtmlXCalendarObject.prototype.langData = {\r\n    en: {\r\n        dateformat: \"%Y-%m-%d\",\r\n        hdrformat: \"%F %Y\",\r\n        monthesFNames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n        monthesSNames: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n        daysFNames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n        daysSNames: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"],\r\n        weekstart: 1,\r\n        weekname: \"w\"\r\n    }\r\n};\r\ndhtmlXCalendarObject.prototype._buildMonthHdr = function(h) {\r\n    var c = this;\r\n    var g = function(l) {\r\n        return ( String(l).length == 1 ? \"0\" + String(l) : l) \r\n    }\r\n    ;\r\n    var a = function(l, m) {\r\n        return \"<span class='dhtmlxcalendar_month_label_\" + l + \"'>\" + m + \"</span>\"\r\n    }\r\n    ;\r\n    var e = String(this.langData[this.lang].hdrformat || (\"%F %Y\")).replace(/%[a-z]/gi, function(l) {\r\n        switch (l) {\r\n        case \"%m\":\r\n            return a(\"month\", g(h.getMonth() + 1));\r\n        case \"%n\":\r\n            return a(\"month\", h.getMonth() + 1);\r\n        case \"%M\":\r\n            return a(\"month\", c.langData[c.lang].monthesSNames[h.getMonth()]);\r\n        case \"%F\":\r\n            return a(\"month\", c.langData[c.lang].monthesFNames[h.getMonth()]);\r\n        case \"%y\":\r\n            return a(\"year\", g(h.getYear() % 100));\r\n        case \"%Y\":\r\n            return a(\"year\", h.getFullYear());\r\n        case \"%%\":\r\n            return \"%\";\r\n        default:\r\n            return l\r\n        }\r\n    });\r\n    c = g = a = null ;\r\n    return e\r\n}\r\n;\r\ndhtmlXCalendarObject.prototype.enableIframe = function(a) {\r\n    if (a == true) {\r\n        if (!this._ifr) {\r\n            this._ifr = document.createElement(\"IFRAME\");\r\n            this._ifr.frameBorder = 0;\r\n            this._ifr.border = 0;\r\n            this._ifr.setAttribute(\"src\", \"javascript:false;\");\r\n            this._ifr.className = \"dhtmlxcalendar_ifr\";\r\n            this._ifr.onload = function() {\r\n                this.onload = null ;\r\n                this.contentWindow.document.open(\"text/html\", \"replace\");\r\n                this.contentWindow.document.write(\"<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>\")\r\n            }\r\n            ;\r\n            this.base.parentNode.insertBefore(this._ifr, this.base);\r\n            this._ifrSize()\r\n        }\r\n    } else {\r\n        if (this._ifr) {\r\n            this._ifr.parentNode.removeChild(this._ifr);\r\n            this._ifr = null \r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCalendarObject.prototype._ifrSize = function() {\r\n    if (this._ifr) {\r\n        this._ifr.style.left = this.base.style.left;\r\n        this._ifr.style.top = this.base.style.top;\r\n        this._ifr.style.width = this.base.offsetWidth + \"px\";\r\n        this._ifr.style.height = this.base.offsetHeight + \"px\"\r\n    }\r\n}\r\n;\r\ndhtmlxCalendarObject = dhtmlXCalendarObject;\r\ndhtmlXCalendarObject.prototype._dateStrings = function() {\r\n    var a = this.langData[this.lang];\r\n    return {\r\n        monthFullName: a.monthesFNames,\r\n        monthShortName: a.monthesSNames,\r\n        dayFullName: a.daysFNames,\r\n        dayShortName: a.daysSNames\r\n    }\r\n}\r\n;\r\ndhtmlXCalendarObject.prototype._strToDate = function(c, a) {\r\n    return window.dhx4.str2date(c, a || this._dateFormat, this._dateStrings())\r\n}\r\n;\r\ndhtmlXCalendarObject.prototype._dateToStr = function(c, a) {\r\n    return window.dhx4.date2str(c, a || this._dateFormat, this._dateStrings())\r\n}\r\n;\r\nwindow.dhtmlxDblCalendarObject = window.dhtmlXDoubleCalendarObject = window.dhtmlXDoubleCalendar = function(c) {\r\n    var a = this;\r\n    this.leftCalendar = new dhtmlXCalendarObject(c);\r\n    this.leftCalendar.hideTime();\r\n    this.rightCalendar = new dhtmlXCalendarObject(c);\r\n    this.rightCalendar.hideTime();\r\n    this.leftCalendar.attachEvent(\"onClick\", function(e) {\r\n        a._updateRange(\"rightCalendar\", e, null );\r\n        a._evOnClick([\"left\", e])\r\n    });\r\n    this.rightCalendar.attachEvent(\"onClick\", function(e) {\r\n        a._updateRange(\"leftCalendar\", null , e);\r\n        a._evOnClick([\"right\", e])\r\n    });\r\n    this.leftCalendar.attachEvent(\"onBeforeChange\", function(e) {\r\n        return a._evOnBeforeChange([\"left\", e])\r\n    });\r\n    this.rightCalendar.attachEvent(\"onBeforeChange\", function(e) {\r\n        return a._evOnBeforeChange([\"right\", e])\r\n    });\r\n    this.show = function() {\r\n        this.leftCalendar.show();\r\n        this.rightCalendar.base.style.marginLeft = this.leftCalendar.base.offsetWidth - 1 + \"px\";\r\n        this.rightCalendar.show()\r\n    }\r\n    ;\r\n    this.hide = function() {\r\n        this.leftCalendar.hide();\r\n        this.rightCalendar.hide()\r\n    }\r\n    ;\r\n    this.setDateFormat = function(e) {\r\n        this.leftCalendar.setDateFormat(e);\r\n        this.rightCalendar.setDateFormat(e)\r\n    }\r\n    ;\r\n    this.setDates = function(g, e) {\r\n        if (g != null ) {\r\n            this.leftCalendar.setDate(g)\r\n        }\r\n        if (e != null ) {\r\n            this.rightCalendar.setDate(e)\r\n        }\r\n        this._updateRange()\r\n    }\r\n    ;\r\n    this._updateRange = function(e, h, g) {\r\n        if (arguments.length == 3) {\r\n            (e == \"leftCalendar\" ? this.leftCalendar : this.rightCalendar).setSensitiveRange(h, g)\r\n        } else {\r\n            this.leftCalendar.setSensitiveRange(null , this.rightCalendar.getDate());\r\n            this.rightCalendar.setSensitiveRange(this.leftCalendar.getDate(), null )\r\n        }\r\n    }\r\n    ;\r\n    this.getFormatedDate = function() {\r\n        return this.leftCalendar.getFormatedDate.apply(this.leftCalendar, arguments)\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.leftCalendar.unload();\r\n        this.rightCalendar.unload();\r\n        this.leftCalendar = this.rightCalendar = null ;\r\n        this._updateRange = null ;\r\n        this._evOnClick = null ;\r\n        this._evOnBeforeChange = null ;\r\n        this.show = null ;\r\n        this.hide = null ;\r\n        this.setDateFormat = null ;\r\n        this.setDates = null ;\r\n        this.getFormatedDate = null ;\r\n        this.unload = null ;\r\n        a = null \r\n    }\r\n    ;\r\n    this._evOnClick = function(e) {\r\n        return this.callEvent(\"onClick\", e)\r\n    }\r\n    ;\r\n    this._evOnBeforeChange = function(e) {\r\n        return this.callEvent(\"onBeforeChange\", e)\r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    return this\r\n}\r\n;\r\nfunction dhtmlXCombo(l, r, e, n, h) {\r\n    var m = this;\r\n    var g = null ;\r\n    var s = null ;\r\n    if (typeof (l) == \"object\" && !l.tagName) {\r\n        g = l;\r\n        l = g.parent;\r\n        e = g.width;\r\n        r = g.name;\r\n        n = g.mode;\r\n        s = g.skin\r\n    }\r\n    this.cont = (typeof (l) == \"string\" ? document.getElementById(l) : l);\r\n    this.conf = {\r\n        skin: null ,\r\n        form_name: r || \"dhxcombo\",\r\n        combo_width: (parseInt(e) || this.cont.offsetWidth || 120) - (dhx4.isFF || dhx4.isIE || dhx4.isChrome || dhx4.isOpera ? 2 : 0),\r\n        combo_image: false,\r\n        combo_focus: false,\r\n        opts_type: (typeof (n) == \"string\" && typeof (this.modes[n]) != \"undefined\" ? n : \"option\"),\r\n        opts_count: 8,\r\n        opts_count_min: 3,\r\n        opts_width: null ,\r\n        item_h: null ,\r\n        list_zi_id: window.dhx4.newId(),\r\n        allow_free_text: true,\r\n        allow_empty_value: true,\r\n        free_text_empty: false,\r\n        enabled: true,\r\n        btn_left: ((window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8) && typeof (window.addEventListener) == \"undefined\" ? 1 : 0),\r\n        ro_mode: false,\r\n        ro_text: \"\",\r\n        ro_tm: null ,\r\n        ro_tm_time: 750,\r\n        img_path: \"\",\r\n        img_def: \"\",\r\n        img_def_dis: true,\r\n        template: {\r\n            header: true,\r\n            input: \"#text#\",\r\n            option: \"#text#\"\r\n        },\r\n        f_func: null ,\r\n        f_mode: false,\r\n        f_url: false,\r\n        f_cache: false,\r\n        f_cache_data: {},\r\n        f_dyn: false,\r\n        f_dyn_end: false,\r\n        f_mask: \"\",\r\n        f_ac: true,\r\n        f_ac_text: \"\",\r\n        f_server_tm: null ,\r\n        f_server_last: \"\",\r\n        f_loading: false,\r\n        s_tm: null ,\r\n        s_time: 200,\r\n        s_mode: \"select\",\r\n        last_hover: null ,\r\n        last_selected: null ,\r\n        last_match: null ,\r\n        last_text: \"\",\r\n        last_value: \"\",\r\n        tm_hover: null ,\r\n        tm_confirm_blur: null ,\r\n        clear_click: false,\r\n        clear_blur: false,\r\n        clear_bsp: false,\r\n        clear_key: false,\r\n        sp: {\r\n            dhx_skyblue: {\r\n                list_ofs: 1,\r\n                hdr_ofs: 1,\r\n                scr_ofs: 1\r\n            },\r\n            dhx_web: {\r\n                list_ofs: 0,\r\n                hdr_ofs: 1,\r\n                scr_ofs: 0\r\n            },\r\n            dhx_terrace: {\r\n                list_ofs: 1,\r\n                hdr_ofs: 1,\r\n                scr_ofs: 1\r\n            }\r\n        },\r\n        col_w: null \r\n    };\r\n    this.conf.combo_image = (this.modes[this.conf.opts_type].image == true);\r\n    this.t = {};\r\n    this.base = document.createElement(\"DIV\");\r\n    this.base.style.width = this.conf.combo_width + \"px\";\r\n    this.base.innerHTML = \"<input type='text' class='dhxcombo_input' style='width:\" + (this.conf.combo_width - 24 - (this.conf.combo_image ? 23 : 0)) + \"px;\" + (this.conf.combo_image ? \"margin-left:23px;\" : \"\") + \"' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>\" + (this.conf.combo_image ? \"<div class='dhxcombo_top_image'>\" + this.modes[this.conf.opts_type].getTopImage(null , this.conf.enabled) + \"</div>\" : \"\");\r\n    this.cont.appendChild(this.base);\r\n    this.list = document.createElement(\"DIV\");\r\n    this.list._listId = window.dhx4.newId();\r\n    this.list.style.display = \"none\";\r\n    document.body.insertBefore(this.list, document.body.firstChild);\r\n    this._doOnListScroll = function() {\r\n        if (m.conf.s_tm != null ) {\r\n            window.clearTimeout(m.conf.s_tm)\r\n        }\r\n        m.conf.s_tm = window.setTimeout(m._doOnListScrollAction, m.conf.s_time)\r\n    }\r\n    ;\r\n    this._doOnListScrollAction = function() {\r\n        m.conf.s_tm = null ;\r\n        if (m.conf.s_mode == \"scroll\" && m.list.scrollHeight - m.list.scrollTop - 10 < m.list.clientHeight) {\r\n            m._subloadRequest()\r\n        }\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.list.addEventListener(\"scroll\", this._doOnListScroll, false)\r\n    } else {\r\n        this.list.attachEvent(\"onscroll\", this._doOnListScroll)\r\n    }\r\n    this.setSkin(s || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxcombo\") || \"dhx_skyblue\");\r\n    this._updateTopImage = function(a) {\r\n        if (!this.conf.combo_image) {\r\n            return\r\n        }\r\n        if (a != null ) {\r\n            this.base.lastChild.innerHTML = this.t[a].obj.getTopImage(this.t[a].item, this.conf.enabled)\r\n        } else {\r\n            this.base.lastChild.innerHTML = this.modes[this.conf.opts_type].getTopImage(null , this.conf.enabled)\r\n        }\r\n    }\r\n    ;\r\n    this._filterOpts = function(A) {\r\n        if (this.conf.f_server_tm) {\r\n            window.clearTimeout(this.conf.f_server_tm)\r\n        }\r\n        var w = String(this.base.firstChild.value).replace(new RegExp(this.conf.f_ac_text + \"$\",\"i\"), \"\");\r\n        if (this.conf.f_server_last == w.toLowerCase()) {\r\n            this._checkForMatch();\r\n            return\r\n        }\r\n        if (this.conf.f_url != null  && this.checkEvent(\"onDynXLS\")) {\r\n            this.conf.f_server_last = w.toLowerCase();\r\n            this.callEvent(\"onDynXLS\", [w]);\r\n            return\r\n        }\r\n        if (this.conf.f_url != null ) {\r\n            if (w.length == 0) {\r\n                this.conf.f_server_last = w.toLowerCase();\r\n                this.clearAll();\r\n                return\r\n            }\r\n            if (this.conf.f_cache == true && this.conf.f_cache_data[w] != null ) {\r\n                this.clearAll();\r\n                this.conf.f_server_last = w.toLowerCase();\r\n                for (var v = 0; v < this.conf.f_cache_data[w].data.length; v++) {\r\n                    this.load(this.conf.f_cache_data[w].data[v])\r\n                }\r\n                if (this.conf.f_dyn) {\r\n                    this.conf.f_dyn_end = this.conf.f_cache_data[w].dyn_end;\r\n                    this.conf.f_mask = this.conf.f_cache_data[w].mask\r\n                }\r\n                if (A !== true) {\r\n                    this._showList(true);\r\n                    this._checkForMatch()\r\n                }\r\n            } else {\r\n                this.conf.f_server_tm = window.setTimeout(function() {\r\n                    m.conf.f_server_last = w.toLowerCase();\r\n                    m.conf.f_mask = w;\r\n                    var F = \"mask=\" + encodeURIComponent(w);\r\n                    if (m.conf.f_dyn) {\r\n                        F += \"&pos=0\";\r\n                        m.conf.f_dyn_end = false\r\n                    }\r\n                    var a = function(J) {\r\n                        if (m.conf.f_cache) {\r\n                            if (!m.conf.f_cache_data[w]) {\r\n                                m.conf.f_cache_data[w] = {\r\n                                    data: [],\r\n                                    dyn_end: false,\r\n                                    mask: w\r\n                                }\r\n                            }\r\n                            m.conf.f_cache_data[w].data.push(J.xmlDoc.responseXML)\r\n                        }\r\n                        m.clearAll();\r\n                        m.load(J.xmlDoc.responseXML);\r\n                        var I = (m.base.offsetWidth > 0 && m.base.offsetHeight > 0);\r\n                        if (I == true && m.conf.enabled == true && m.conf.combo_focus == true && A !== true) {\r\n                            if (m.conf.f_ac && m.conf.f_mode == \"start\" && m.conf.clear_bsp == false && m.list.firstChild != null ) {\r\n                                var H = m.list.firstChild._optId;\r\n                                var K = String(m.t[H].obj.getText(m.list.firstChild, true));\r\n                                if (w == m.base.firstChild.value && String(K).toLowerCase().indexOf(String(w).toLowerCase()) === 0) {\r\n                                    m.base.firstChild.value = K;\r\n                                    m.conf.f_ac_text = K.substr(w.length);\r\n                                    m._selectRange(w.length, K.length)\r\n                                }\r\n                            }\r\n                            m._showList(true);\r\n                            m._checkForMatch()\r\n                        }\r\n                        a = null \r\n                    }\r\n                    ;\r\n                    if (window.dhx4.ajax.method == \"post\") {\r\n                        window.dhx4.ajax.post(m.conf.f_url, F, a)\r\n                    } else {\r\n                        if (window.dhx4.ajax.method == \"get\") {\r\n                            window.dhx4.ajax.get(m.conf.f_url + (String(m.conf.f_url).indexOf(\"?\") >= 0 ? \"&\" : \"?\") + F, a)\r\n                        }\r\n                    }\r\n                }, 200)\r\n            }\r\n        } else {\r\n            this.conf.f_server_last = w.toLowerCase();\r\n            var u = (w.length == 0 ? true : new RegExp((this.conf.f_mode == \"start\" ? \"^\" : \"\") + String(w).replace(/[\\\\\\^\\$\\*\\+\\?\\.\\(\\)\\|\\{\\}\\[\\]]/gi, \"\\\\$&\"),\"i\"));\r\n            var x = null ;\r\n            for (var C in this.t) {\r\n                var E = false;\r\n                if (u !== true) {\r\n                    if (this.conf.f_func != null ) {\r\n                        var y = this._getOption(this.t[C].item._optId, v);\r\n                        E = (this.conf.f_func.apply(window, [w, y]) == true)\r\n                    } else {\r\n                        var D = this.t[C].obj.getText(this.t[C].item, true);\r\n                        E = (u.test(D) == true)\r\n                    }\r\n                }\r\n                if (u === true || E == true) {\r\n                    this.t[C].item.style.display = \"\";\r\n                    if (x == null  && w.length > 0) {\r\n                        x = String(this.t[C].obj.getText(this.t[C].item, true))\r\n                    }\r\n                } else {\r\n                    this.t[C].item.style.display = \"none\"\r\n                }\r\n            }\r\n            if (this.conf.f_ac && this.conf.f_mode == \"start\" && this.conf.clear_bsp == false && x != null ) {\r\n                this.conf.f_ac_text = x.replace(new RegExp(\"^\" + w,\"i\"), \"\");\r\n                this.base.firstChild.value = x;\r\n                this._selectRange(this.conf.f_server_last.length, this.base.firstChild.value.length)\r\n            }\r\n            if (this.conf.f_mode == \"between\" && this.conf.clear_bsp == true) {\r\n                this._checkForMatch(true)\r\n            }\r\n            if (A !== true) {\r\n                this._showList(true);\r\n                this._checkForMatch()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._searchRO = function(u) {\r\n        if (this.conf.ro_tm) {\r\n            window.clearTimeout(this.conf.ro_tm)\r\n        }\r\n        this.conf.ro_text += u;\r\n        this._showList();\r\n        for (var v = 0; v < this.list.childNodes.length; v++) {\r\n            var a = this.list.childNodes[v]._optId;\r\n            var w = String(this.t[a].obj.getText(this.list.childNodes[v], true)).toLowerCase();\r\n            if (w.indexOf(this.conf.ro_text) === 0) {\r\n                this._setSelected(a, true, true);\r\n                this._confirmSelect(\"script\", false);\r\n                break\r\n            }\r\n        }\r\n        this.conf.ro_tm = window.setTimeout(function() {\r\n            m.conf.ro_text = \"\"\r\n        }, this.conf.ro_tm_time)\r\n    }\r\n    ;\r\n    this._initObj = function(a) {\r\n        if (typeof (a.template) != \"undefined\") {\r\n            this.setTemplate(a.template)\r\n        }\r\n        if (a.add != true && this.conf.f_loading != true) {\r\n            this.clearAll(false)\r\n        }\r\n        this.addOption(a.options)\r\n    }\r\n    ;\r\n    this._xmlToObj = function(P, x, v) {\r\n        var C = {\r\n            add: false,\r\n            options: []\r\n        };\r\n        var J = (x == true ? P : P.getElementsByTagName(\"complete\"));\r\n        if (J.length > 0) {\r\n            if (window.dhx4.s2b(J[0].getAttribute(\"add\")) == true) {\r\n                C.add = true\r\n            }\r\n            var I = J[0].childNodes;\r\n            for (var F = 0; F < I.length; F++) {\r\n                if (typeof (I[F].tagName) != \"undefined\") {\r\n                    if (String(I[F].tagName).toLowerCase() == \"template\") {\r\n                        var O = {};\r\n                        for (var A = 0; A < I[F].childNodes.length; A++) {\r\n                            var H = I[F].childNodes[A];\r\n                            if (H.tagName != null ) {\r\n                                var K = H.tagName;\r\n                                if (typeof (this.conf.template[K]) != \"undefined\") {\r\n                                    O[K] = window.dhx4._xmlNodeValue(H)\r\n                                }\r\n                                if (K == \"columns\") {\r\n                                    for (var M = 0; M < H.childNodes.length; M++) {\r\n                                        var y = H.childNodes[M];\r\n                                        if (y.tagName != null  && y.tagName == \"column\") {\r\n                                            var E = {};\r\n                                            for (var N in {\r\n                                                width: 1,\r\n                                                css: 1,\r\n                                                header: 1,\r\n                                                option: 1\r\n                                            }) {\r\n                                                if (y.getAttribute(N) != null ) {\r\n                                                    E[N] = y.getAttribute(N)\r\n                                                }\r\n                                            }\r\n                                            for (var N in {\r\n                                                header: 1,\r\n                                                option: 1\r\n                                            }) {\r\n                                                var L = y.getElementsByTagName(N);\r\n                                                if (L[0] != null  && L[0].firstChild != null ) {\r\n                                                    E[N] = window.dhx4._xmlNodeValue(L[0])\r\n                                                }\r\n                                            }\r\n                                            if (O.columns == null ) {\r\n                                                O.columns = []\r\n                                            }\r\n                                            O.columns.push(E)\r\n                                        }\r\n                                        y = null \r\n                                    }\r\n                                }\r\n                            }\r\n                            H = null \r\n                        }\r\n                        this.setTemplate(O)\r\n                    }\r\n                    if (String(I[F].tagName).toLowerCase() == \"option\") {\r\n                        var D = false;\r\n                        if (x == true) {\r\n                            D = (C.options.length == v)\r\n                        } else {\r\n                            D = window.dhx4.s2b(I[F].getAttribute(\"selected\"))\r\n                        }\r\n                        var u = {\r\n                            value: I[F].getAttribute(\"value\"),\r\n                            text: window.dhx4._xmlNodeValue(I[F]),\r\n                            selected: D,\r\n                            checked: window.dhx4.s2b(I[F].getAttribute(\"checked\"))\r\n                        };\r\n                        for (var N in {\r\n                            img: 1,\r\n                            img_dis: 1,\r\n                            img_src: 1,\r\n                            img_src_dis: 1,\r\n                            css: 1\r\n                        }) {\r\n                            if (I[F].getAttribute(N) != null ) {\r\n                                u[N] = I[F].getAttribute(N)\r\n                            }\r\n                        }\r\n                        for (var A = 0; A < I[F].childNodes.length; A++) {\r\n                            if (I[F].childNodes[A].tagName != null  && String(I[F].childNodes[A].tagName).toLowerCase() == \"text\") {\r\n                                u.text = {};\r\n                                var H = I[F].childNodes[A];\r\n                                for (var M = 0; M < H.childNodes.length; M++) {\r\n                                    if (H.childNodes[M].tagName != null ) {\r\n                                        u.text[H.childNodes[M].tagName] = window.dhx4._xmlNodeValue(H.childNodes[M])\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        C.options.push(u)\r\n                    }\r\n                }\r\n            }\r\n            J = I = null \r\n        }\r\n        return C\r\n    }\r\n    ;\r\n    window.dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToObj\", \"complete\", {\r\n        data: true\r\n    });\r\n    window.dhx4._eventable(this);\r\n    this._getNearItem = function(v, u) {\r\n        var a = null ;\r\n        while (v != null ) {\r\n            v = v[u < 0 ? \"previousSibling\" : \"nextSibling\"];\r\n            if (a == null  && v != null  && v.style.display == \"\" && v._optId != null ) {\r\n                a = v;\r\n                v = null \r\n            }\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this.setName(this.conf.form_name);\r\n    this._doOnListMouseMove = function(u) {\r\n        u = u || event;\r\n        var a = u.target || u.srcElement;\r\n        while (a != null  && a != this) {\r\n            if (typeof (a._optId) != \"undefined\") {\r\n                if (m.conf.tm_hover) {\r\n                    window.clearTimeout(m.conf.tm_hover)\r\n                }\r\n                m._setSelected(a._optId, false, false, true)\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._doOnListMouseDown = function(a) {\r\n        a = a || event;\r\n        a.cancelBubble = true;\r\n        m.conf.clear_click = true;\r\n        window.setTimeout(function() {\r\n            m.base.firstChild.focus()\r\n        }, 1)\r\n    }\r\n    ;\r\n    this._doOnListMouseUp = function(v) {\r\n        v = v || event;\r\n        if (v.button != m.conf.btn_left) {\r\n            return\r\n        }\r\n        var a = v.target || v.srcElement;\r\n        while (a != null  && a != this) {\r\n            if (typeof (a._optId) != \"undefined\") {\r\n                var u = true;\r\n                if (typeof (m.t[a._optId].obj.optionClick) == \"function\" && m.t[a._optId].obj.optionClick(a, v, m) !== true) {\r\n                    u = false\r\n                }\r\n                if (u) {\r\n                    m._setSelected(a._optId, null , true);\r\n                    m._confirmSelect(\"click\")\r\n                }\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._doOnListMouseOut = function(a) {\r\n        if (m.conf.tm_hover) {\r\n            window.clearTimeout(m.conf.tm_hover)\r\n        }\r\n        m.conf.tm_hover = window.setTimeout(function() {\r\n            var u = m.conf.last_match || m.conf.last_selected;\r\n            if (m.conf.last_match == null  && m.t[u] != null ) {\r\n                if (m.base.firstChild.value != m.t[u].obj.getText(m.t[u].item, true)) {\r\n                    u = null \r\n                }\r\n            }\r\n            m._setSelected(u, null , true, true)\r\n        }, 1)\r\n    }\r\n    ;\r\n    this._doOnBaseMouseDown = function(x) {\r\n        if (!m.conf.enabled) {\r\n            return\r\n        }\r\n        m.conf.clear_click = true;\r\n        x = x || event;\r\n        if (x.button != m.conf.btn_left) {\r\n            return\r\n        }\r\n        var u = x.target || x.srcElement;\r\n        if (u != this.firstChild) {\r\n            window.setTimeout(function() {\r\n                m.base.firstChild.focus()\r\n            }, 1);\r\n            var w = u;\r\n            while (w != this && w != null ) {\r\n                if (w == this.lastChild) {\r\n                    if (typeof (m.modes[m.conf.opts_type].topImageClick) == \"function\") {\r\n                        var v = (m.conf.last_hover || m.conf.last_selected);\r\n                        var a = (v != null  ? m.t[v].item : null );\r\n                        if (m.modes[m.conf.opts_type].topImageClick(a, m) !== true) {\r\n                            v = a = null ;\r\n                            return\r\n                        }\r\n                    }\r\n                    w = null \r\n                } else {\r\n                    w = w.parentNode\r\n                }\r\n            }\r\n        }\r\n        if (m._isListVisible()) {\r\n            m._hideList()\r\n        } else {\r\n            if (u != this.firstChild) {\r\n                m.conf.clear_blur = true\r\n            }\r\n            m._showList();\r\n            m._setSelected(m.conf.last_selected, true, true)\r\n        }\r\n        u = null \r\n    }\r\n    ;\r\n    this._doOnBodyMouseDown = function() {\r\n        if (m.conf.clear_click) {\r\n            m.conf.clear_click = false;\r\n            return\r\n        }\r\n        m._confirmSelect(\"blur\")\r\n    }\r\n    ;\r\n    this._doOnInputFocus = function() {\r\n        m.conf.clear_blur = false;\r\n        if (m.conf.tm_confirm_blur) {\r\n            window.clearTimeout(m.conf.tm_confirm_blur)\r\n        }\r\n        if (m.conf.combo_focus == false) {\r\n            m.conf.combo_focus = true;\r\n            m.callEvent(\"onFocus\", [])\r\n        }\r\n    }\r\n    ;\r\n    this._doOnInputBlur = function() {\r\n        if (m.conf.clear_blur == true) {\r\n            m.conf.clear_blur = false;\r\n            return\r\n        }\r\n        if (m.conf.tm_confirm_blur) {\r\n            window.clearTimeout(m.conf.tm_confirm_blur)\r\n        }\r\n        m.conf.tm_confirm_blur = window.setTimeout(function() {\r\n            if (m.conf.clear_click == false) {\r\n                m._confirmSelect(\"blur\");\r\n                m.conf.combo_focus = false;\r\n                m.callEvent(\"onBlur\", [])\r\n            }\r\n        }, 20)\r\n    }\r\n    ;\r\n    this._doOnInputKeyUp = function(a) {\r\n        a = a || event;\r\n        if (m.conf.f_mode != false) {\r\n            m.conf.clear_bsp = (a.keyCode == 8 || a.keyCode == 46);\r\n            m._filterOpts();\r\n            return\r\n        } else {\r\n            m._checkForMatch()\r\n        }\r\n    }\r\n    ;\r\n    this._doOnInputKeyDown = function(a) {\r\n        a = a || event;\r\n        if ((a.keyCode == 38 || a.keyCode == 40) && !a.ctrlKey && !a.shiftKey && !a.altKey) {\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            } else {\r\n                a.returnValue = false\r\n            }\r\n            a.cancelBubble = true;\r\n            m._keyOnUpDown(a.keyCode == 38 ? -1 : 1)\r\n        }\r\n        if (a.keyCode == 113) {\r\n            if (!m._isListVisible()) {\r\n                m._showList();\r\n                if (m.base.firstChild.value == m.conf.last_text) {\r\n                    m._setSelected(m.conf.last_selected, true, true);\r\n                    m.base.firstChild.value = m.conf.last_text;\r\n                    m.conf.f_server_last = m.base.firstChild.value.toLowerCase()\r\n                } else {\r\n                    m.conf.f_server_last = m.base.firstChild.value.toLowerCase();\r\n                    if (m.conf.f_mode == false) {\r\n                        m._checkForMatch()\r\n                    }\r\n                }\r\n            } else {}\r\n        }\r\n        if (a.keyCode == 27) {\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            } else {\r\n                a.returnValue = false\r\n            }\r\n            a.cancelBubble = true;\r\n            m._cancelSelect()\r\n        }\r\n        if (a.keyCode == 13) {\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            }\r\n            m._confirmSelect(\"kbd\")\r\n        }\r\n        if (m.conf.ro_mode == true && ((a.keyCode >= 48 && a.keyCode <= 57) || (a.keyCode >= 65 && a.keyCode <= 90))) {\r\n            m._searchRO(String.fromCharCode(a.keyCode).toLowerCase());\r\n            a.cancelBubble = true\r\n        }\r\n        m.conf.clear_key = true;\r\n        m.callEvent(\"onKeyPressed\", [a.keyCode || a.charCode])\r\n    }\r\n    ;\r\n    this._doOnInputKeyPress = function(a) {\r\n        if (m.conf.clear_key) {\r\n            m.conf.clear_key = false;\r\n            return\r\n        }\r\n        a = a || event;\r\n        m.callEvent(\"onKeyPressed\", [a.keyCode || a.charCode])\r\n    }\r\n    ;\r\n    this._keyOnUpDown = function(a) {\r\n        var u = null ;\r\n        if (this.conf.last_hover) {\r\n            u = this.t[this.conf.last_hover].item\r\n        } else {\r\n            if (this.conf.last_selected) {\r\n                u = this.t[this.conf.last_selected].item\r\n            }\r\n        }\r\n        if (!u && this._getListVisibleCount() == 0) {\r\n            return\r\n        }\r\n        if (u != null  && u.style.display != \"\") {\r\n            u = null \r\n        }\r\n        this._showList();\r\n        if (u != null ) {\r\n            if (this.t[u._optId].obj.isSelected(u)) {\r\n                u = this._getNearItem(u, a)\r\n            }\r\n        } else {\r\n            u = this.list.firstChild;\r\n            if (u.style.display != \"\") {\r\n                u = this._getNearItem(u, 1)\r\n            }\r\n        }\r\n        if (u == null ) {\r\n            return\r\n        }\r\n        this._setSelected(u._optId, true, true);\r\n        if (this.conf.f_mode == false) {\r\n            this.base.firstChild.value = this.t[u._optId].obj.getText(u, true)\r\n        } else {\r\n            var v = String(this.t[u._optId].obj.getText(u, true));\r\n            if (this.conf.f_mode == \"start\" && this.conf.f_ac == true) {\r\n                if (v.toLowerCase().indexOf(this.conf.f_server_last) === 0) {\r\n                    this.conf.f_ac_text = v.substring(this.conf.f_server_last.length, v.length);\r\n                    this.base.firstChild.value = v;\r\n                    this._selectRange(this.conf.f_server_last.length, this.base.firstChild.value.length)\r\n                } else {\r\n                    this.base.firstChild.value = v;\r\n                    this.conf.f_server_last = this.base.firstChild.value.toLowerCase();\r\n                    this._selectRange(0, this.base.firstChild.value.length)\r\n                }\r\n            } else {\r\n                this.base.firstChild.value = v;\r\n                this.conf.f_server_last = this.base.firstChild.value.toLowerCase()\r\n            }\r\n        }\r\n        u = null \r\n    }\r\n    ;\r\n    this.conf.evs_nodes = [{\r\n        node: document.body,\r\n        evs: {\r\n            mousedown: \"_doOnBodyMouseDown\"\r\n        }\r\n    }, {\r\n        node: this.base,\r\n        evs: {\r\n            mousedown: \"_doOnBaseMouseDown\"\r\n        }\r\n    }, {\r\n        node: this.base.firstChild,\r\n        evs: {\r\n            keyup: \"_doOnInputKeyUp\",\r\n            keydown: \"_doOnInputKeyDown\",\r\n            keypress: \"_doOnInputKeyPress\",\r\n            focus: \"_doOnInputFocus\",\r\n            blur: \"_doOnInputBlur\"\r\n        }\r\n    }, {\r\n        node: this.list,\r\n        evs: {\r\n            mousemove: \"_doOnListMouseMove\",\r\n            mousedown: \"_doOnListMouseDown\",\r\n            mouseup: \"_doOnListMouseUp\",\r\n            mouseout: \"_doOnListMouseOut\"\r\n        }\r\n    }];\r\n    for (var c = 0; c < this.conf.evs_nodes.length; c++) {\r\n        for (var o in this.conf.evs_nodes[c].evs) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                this.conf.evs_nodes[c].node.addEventListener(o, this[this.conf.evs_nodes[c].evs[o]], false)\r\n            } else {\r\n                this.conf.evs_nodes[c].node.attachEvent(\"on\" + o, this[this.conf.evs_nodes[c].evs[o]])\r\n            }\r\n        }\r\n    }\r\n    this.unload = function() {\r\n        this.clearAll();\r\n        this.t = null ;\r\n        for (var v = 0; v < this.conf.evs_nodes.length; v++) {\r\n            for (var u in this.conf.evs_nodes[v].evs) {\r\n                if (typeof (window.addEventListener) == \"function\") {\r\n                    this.conf.evs_nodes[v].node.removeEventListener(u, this[this.conf.evs_nodes[v].evs[u]], false)\r\n                } else {\r\n                    this.conf.evs_nodes[v].node.detachEvent(\"on\" + u, this[this.conf.evs_nodes[v].evs[u]])\r\n                }\r\n                this.conf.evs_nodes[v].evs[u] = null ;\r\n                delete this.conf.evs_nodes[v].evs[u]\r\n            }\r\n            this.conf.evs_nodes[v].node = null ;\r\n            this.conf.evs_nodes[v].evs = null ;\r\n            delete this.conf.evs_nodes[v].node;\r\n            delete this.conf.evs_nodes[v].evs;\r\n            this.conf.evs_nodes[v] = null \r\n        }\r\n        window.dhx4._eventable(this, \"clear\");\r\n        window.dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n        this._mcDetachHeader();\r\n        this.DOMelem_input = this.DOMelem_button = this.DOMlist = this.DOMelem = this.DOMParent = null ;\r\n        for (var u in this.conf) {\r\n            this.conf[u] = null ;\r\n            delete this.conf[u]\r\n        }\r\n        this.conf = null ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.list.removeEventListener(\"scroll\", this._doOnListScroll, false)\r\n        } else {\r\n            this.list.detachEvent(\"onscroll\", this._doOnListScroll)\r\n        }\r\n        this.base.parentNode.removeChild(this.base);\r\n        this.list.parentNode.removeChild(this.list);\r\n        this.base = this.list = this.cont = null ;\r\n        this.modes = null ;\r\n        for (var u in this) {\r\n            if (typeof (this[u]) == \"function\") {\r\n                this[u] = null \r\n            }\r\n        }\r\n        m = null \r\n    }\r\n    ;\r\n    this.DOMelem_input = this.base.firstChild;\r\n    this.DOMelem_button = this.base.childNodes[this.base.childNodes.length - (this.conf.combo_image ? 2 : 1)];\r\n    this.DOMlist = this.list;\r\n    this.DOMelem = this.base;\r\n    this.DOMParent = l;\r\n    l = null ;\r\n    if (g != null ) {\r\n        if (g.filter != null ) {\r\n            if (typeof (g.filter) == \"string\") {\r\n                this.enableFilteringMode(true, g.filter, window.dhx4.s2b(g.filter_cache), window.dhx4.s2b(g.filter_sub_load))\r\n            } else {\r\n                this.enableFilteringMode(true)\r\n            }\r\n        }\r\n        if (g.image_path != null ) {\r\n            this.setImagePath(g.image_path)\r\n        }\r\n        if (g.default_image != null  || g.default_image_dis != null ) {\r\n            this.setDefaultImage(g.default_image, g.default_image_dis)\r\n        }\r\n        if (g.items || g.options) {\r\n            this.addOption(g.items || g.options)\r\n        }\r\n        if (g.xml || g.json) {\r\n            this.load(g.xml || g.json)\r\n        }\r\n        if (typeof (g.readonly) != \"undefined\") {\r\n            this.readonly(g.readonly)\r\n        }\r\n        g = null \r\n    }\r\n    return this\r\n}\r\nfunction dhtmlXComboFromSelect(e) {\r\n    if (typeof (e) == \"string\") {\r\n        e = document.getElementById(e)\r\n    }\r\n    var c = e.offsetWidth;\r\n    var r = e.getAttribute(\"name\") || null ;\r\n    var g = document.createElement(\"SPAN\");\r\n    e.parentNode.insertBefore(g, e);\r\n    var l = e.getAttribute(\"mode\") || e.getAttribute(\"opt_type\") || \"option\";\r\n    var h = new dhtmlXCombo(g,r,c,l);\r\n    g = null ;\r\n    var n = e.getAttribute(\"imagePath\");\r\n    if (n) {\r\n        h.setImagePath(n)\r\n    }\r\n    var o = e.getAttribute(\"defaultImage\");\r\n    var m = e.getAttribute(\"defaultImageDis\");\r\n    if (window.dhx4.s2b(m) == true) {\r\n        m = true\r\n    }\r\n    if (o != null  || m != null ) {\r\n        h.setDefaultImage(o, m)\r\n    }\r\n    var a = h._xmlToObj([e], true, e.selectedIndex);\r\n    if (a.options.length > 0) {\r\n        h.addOption(a.options)\r\n    }\r\n    a = null ;\r\n    e.parentNode.removeChild(e);\r\n    e = null ;\r\n    return h\r\n}\r\ndhtmlXCombo.prototype.setName = function(a) {\r\n    this.conf.form_name = a;\r\n    this.base.childNodes[1].name = a;\r\n    this.base.childNodes[2].name = a.replace(/(\\[.*)?$/, \"_new_value$1\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.readonly = function(a) {\r\n    if (window.dhx4.s2b(a)) {\r\n        this.base.firstChild.setAttribute(\"readOnly\", \"true\");\r\n        this.conf.ro_mode = true\r\n    } else {\r\n        this.base.firstChild.removeAttribute(\"readOnly\");\r\n        this.conf.ro_mode = false\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.setPlaceholder = function(a) {\r\n    if (typeof (a) == \"undefined\" || a == null ) {\r\n        a = \"\"\r\n    }\r\n    this.base.firstChild.setAttribute(\"placeholder\", String(a))\r\n}\r\n;\r\ndhtmlXCombo.prototype.setTemplate = function(e) {\r\n    for (var c in e) {\r\n        if (typeof (this.conf.template[c]) != \"undefined\") {\r\n            if (c == \"header\") {\r\n                this.conf.template[c] = window.dhx4.s2b(e[c])\r\n            } else {\r\n                this.conf.template[c] = String(e[c])\r\n            }\r\n        }\r\n    }\r\n    if (e.columns != null ) {\r\n        this._mcMakeTemplate(e.columns)\r\n    } else {\r\n        this._mcDetachHeader()\r\n    }\r\n    for (var c in this.t) {\r\n        this.t[c].obj.setText(this.t[c].item, this.t[c].item._conf.text)\r\n    }\r\n    this._confirmSelect()\r\n}\r\n;\r\ndhtmlXCombo.prototype.setSkin = function(a) {\r\n    if (a == this.conf.skin) {\r\n        return\r\n    }\r\n    this.conf.skin = a;\r\n    this.base.className = \"dhxcombo_\" + this.conf.skin + (this.conf.enabled ? \"\" : \" dhxcombo_disabled\");\r\n    this.list.className = \"dhxcombolist_\" + this.conf.skin + (this.hdr != null  ? \" dhxcombolist_multicolumn\" : \"\");\r\n    if (this.hdr != null ) {\r\n        this.hdr.className = \"dhxcombolist_\" + this.conf.skin + \" dhxcombolist_hdr\"\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.getInput = function() {\r\n    return this.base.firstChild\r\n}\r\n;\r\ndhtmlXCombo.prototype.getButton = function() {\r\n    return this.base.childNodes[this.base.childNodes.length - (this.conf.combo_image ? 2 : 1)]\r\n}\r\n;\r\ndhtmlXCombo.prototype.getList = function() {\r\n    return this.list\r\n}\r\n;\r\ndhtmlXCombo.prototype.getBase = function() {\r\n    return this.base\r\n}\r\n;\r\ndhtmlXCombo.prototype.getParent = function() {\r\n    return this.DOMParent\r\n}\r\n;\r\ndhtmlXCombo.prototype.forEachOption = function(a) {\r\n    for (var c = 0; c < this.list.childNodes.length; c++) {\r\n        a.apply(window, [this._getOption(this.list.childNodes[c]._optId, c)])\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.setFocus = function() {\r\n    if (this.conf.enabled) {\r\n        this.base.firstChild.focus()\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.setFontSize = function(a, c) {\r\n    if (a != null ) {\r\n        this.base.firstChild.style.fontSize = a\r\n    }\r\n    if (c != null ) {\r\n        this.list.style.fontSize = c\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.getOption = function(h) {\r\n    var l = null ;\r\n    var e = null ;\r\n    for (var g = 0; g < this.list.childNodes.length; g++) {\r\n        if (l == null ) {\r\n            var c = this.list.childNodes[g]._optId;\r\n            if (this.t[c].obj.getValue(this.t[c].item) == h) {\r\n                l = c;\r\n                e = g\r\n            }\r\n        }\r\n    }\r\n    return ( l == null  ? null  : this._getOption(l, e)) \r\n}\r\n;\r\ndhtmlXCombo.prototype.getOptionByIndex = function(a) {\r\n    if (a < 0) {\r\n        return null \r\n    }\r\n    if (this.list.childNodes[a] == null ) {\r\n        return null \r\n    }\r\n    return this._getOption(this.list.childNodes[a]._optId, a)\r\n}\r\n;\r\ndhtmlXCombo.prototype.getOptionByLabel = function(h) {\r\n    var l = null ;\r\n    var e = null ;\r\n    for (var g = 0; g < this.list.childNodes.length; g++) {\r\n        if (l == null ) {\r\n            var c = this.list.childNodes[g]._optId;\r\n            if (this.t[c].obj.getText(this.t[c].item, true) == h) {\r\n                l = c;\r\n                e = g\r\n            }\r\n        }\r\n    }\r\n    return ( l == null  ? null  : this._getOption(l, e)) \r\n}\r\n;\r\ndhtmlXCombo.prototype.getSelectedIndex = function() {\r\n    return this._getOptionProp(this.conf.last_selected, \"index\", -1)\r\n}\r\n;\r\ndhtmlXCombo.prototype.getSelectedText = function() {\r\n    return this._getOptionProp(this.conf.last_selected, \"text\", \"\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.getSelectedValue = function() {\r\n    return this._getOptionProp(this.conf.temp_selected || this.conf.last_selected, \"value\", null )\r\n}\r\n;\r\ndhtmlXCombo.prototype.getActualValue = function() {\r\n    return this.base.childNodes[1].value\r\n}\r\n;\r\ndhtmlXCombo.prototype.getComboText = function() {\r\n    return this.base.childNodes[0].value\r\n}\r\n;\r\ndhtmlXCombo.prototype.getIndexByValue = function(c) {\r\n    var a = this.getOption(c);\r\n    return ( a != null  ? a.index : -1) \r\n}\r\n;\r\ndhtmlXCombo.prototype.setComboText = function(a) {\r\n    if (this.conf.allow_free_text != true) {\r\n        return\r\n    }\r\n    this.unSelectOption();\r\n    this.conf.last_text = this.base.firstChild.value = a;\r\n    this.conf.f_server_last = this.base.firstChild.value.toLowerCase()\r\n}\r\n;\r\ndhtmlXCombo.prototype.setComboValue = function(c) {\r\n    var a = this.getOption(c);\r\n    if (a != null ) {\r\n        this.selectOption(a.index)\r\n    } else {\r\n        this.conf.last_value = c;\r\n        this.base.childNodes[1].value = this.conf.last_value;\r\n        this.base.childNodes[2].value = \"true\"\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.selectOption = function(c, e, a) {\r\n    if (c < 0 || c >= this.list.childNodes.length) {\r\n        return\r\n    }\r\n    var g = this.list.childNodes[c]._optId;\r\n    this._setSelected(g, this._isListVisible(), true);\r\n    this._confirmSelect(\"script\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.unSelectOption = function() {\r\n    if (this.conf.last_hover != null ) {\r\n        this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item, false);\r\n        this.conf.last_hover = null \r\n    }\r\n    this.base.firstChild.value = \"\";\r\n    if (this.conf.f_mode != false) {\r\n        this._filterOpts(true)\r\n    }\r\n    this._hideList();\r\n    this._updateTopImage(null );\r\n    this._confirmSelect(\"script\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.confirmValue = function() {\r\n    this._confirmSelect(\"script\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.enable = function(a) {\r\n    a = (typeof (a) == \"undefined\" ? true : window.dhx4.s2b(a));\r\n    if (this.conf.enabled == a) {\r\n        return\r\n    }\r\n    this.conf.enabled = a;\r\n    if (a) {\r\n        this.base.className = \"dhxcombo_\" + this.conf.skin;\r\n        this.base.firstChild.removeAttribute(\"disabled\")\r\n    } else {\r\n        this._hideList();\r\n        this.base.className = \"dhxcombo_\" + this.conf.skin + \" dhxcombo_disabled\";\r\n        this.base.firstChild.setAttribute(\"disabled\", \"true\")\r\n    }\r\n    this._updateTopImage(this.conf.last_selected)\r\n}\r\n;\r\ndhtmlXCombo.prototype.disable = function(a) {\r\n    a = (typeof (a) == \"undefined\" ? true : window.dhx4.s2b(a));\r\n    this.enable(!a)\r\n}\r\n;\r\ndhtmlXCombo.prototype.isEnabled = function() {\r\n    return ( this.conf.enabled == true) \r\n}\r\n;\r\ndhtmlXCombo.prototype.show = function(a) {\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    } else {\r\n        a = window.dhx4.s2b(a)\r\n    }\r\n    this.base.style.display = (a == true ? \"\" : \"none\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.hide = function(a) {\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    }\r\n    this.show(!a)\r\n}\r\n;\r\ndhtmlXCombo.prototype.isVisible = function() {\r\n    return ( this.base.style.display == \"\") \r\n}\r\n;\r\ndhtmlXCombo.prototype.setFilterHandler = function(a) {\r\n    if (typeof (a) == \"function\") {\r\n        this.conf.f_func = a;\r\n        this.conf.f_mode = true;\r\n        this.conf.f_dyn = this.conf.f_cache = this.conf.f_url = null \r\n    } else {\r\n        if (typeof (a) == \"string\" && typeof (window[a]) == \"function\") {\r\n            this.conf.f_func = window[a];\r\n            this.conf.f_mode = true;\r\n            this.conf.f_dyn = this.conf.f_cache = this.conf.f_url = null \r\n        } else {\r\n            this.conf.f_func = null \r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.enableFilteringMode = function(g, c, a, e) {\r\n    if (g == true || g == \"between\") {\r\n        this.conf.f_mode = (g == true ? \"start\" : \"between\");\r\n        if (c != null ) {\r\n            this.conf.f_url = c;\r\n            this.conf.f_cache = window.dhx4.s2b(a);\r\n            this.conf.f_dyn = window.dhx4.s2b(e)\r\n        } else {\r\n            this.conf.f_url = null ;\r\n            this.conf.f_cache = false;\r\n            this.conf.f_dyn = false\r\n        }\r\n    } else {\r\n        this.conf.f_mode = false;\r\n        this.conf.f_url = null ;\r\n        this.conf.f_cache = false;\r\n        this.conf.f_dyn = false\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.filter = function(e, a) {\r\n    for (var g = 0; g < this.list.childNodes.length; g++) {\r\n        var c = e.apply(window, [this._getOption(this.list.childNodes[g]._optId, g)]);\r\n        this.list.childNodes[g].style.display = (c === true ? \"\" : \"none\")\r\n    }\r\n    if (typeof (a) == \"undefined\" || a == true) {\r\n        this._showList(true)\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.sort = function(e) {\r\n    var a = [];\r\n    for (var c = 0; c < this.list.childNodes.length; c++) {\r\n        var g = this.list.childNodes[c]._optId;\r\n        a.push([g, this._getOption(g, c)])\r\n    }\r\n    if (e == \"asc\" || e == \"desc\") {\r\n        k = true;\r\n        a.sort(function(l, h) {\r\n            l = l[1].text_option.toLowerCase();\r\n            h = h[1].text_option.toLowerCase();\r\n            var m = (e == \"asc\" ? 1 : -1);\r\n            return ( l > h ? m : -1 * m) \r\n        })\r\n    } else {\r\n        if (typeof (e) == \"function\" || typeof (window[e]) == \"function\") {\r\n            if (typeof (window[e]) == \"function\") {\r\n                e = window[e]\r\n            }\r\n            a.sort(function(l, h) {\r\n                return e.apply(window, [l[1], h[1]])\r\n            })\r\n        }\r\n    }\r\n    while (this.list.childNodes.length > 0) {\r\n        this.list.removeChild(this.list.lastChild)\r\n    }\r\n    for (var c = 0; c < a.length; c++) {\r\n        this.list.appendChild(this.t[a[c][0]].item)\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.enableAutocomplete = function(a) {\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    } else {\r\n        a = window.dhx4.s2b(a)\r\n    }\r\n    this.conf.f_ac = a\r\n}\r\n;\r\ndhtmlXCombo.prototype.disableAutocomplete = function(a) {\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    } else {\r\n        a = window.dhx4.s2b(a)\r\n    }\r\n    this.enableAutocomplete(!a)\r\n}\r\n;\r\ndhtmlXCombo.prototype.allowFreeText = function(c, a) {\r\n    this.conf.allow_free_text = (typeof (c) == \"undefined\" ? true : window.dhx4.s2b(c));\r\n    this.conf.free_text_empty = (typeof (a) == \"undefined\" ? false : window.dhx4.s2b(a))\r\n}\r\n;\r\ndhtmlXCombo.prototype._checkForMatch = function(g) {\r\n    var a = window.dhx4.trim(this.base.firstChild.value).toLowerCase();\r\n    var h = null ;\r\n    var c = this.list.firstChild;\r\n    while (c != null ) {\r\n        if (c.style.display == \"\" && c._optId != null ) {\r\n            var e = window.dhx4.trim(this.t[c._optId].obj.getText(c, true)).toLowerCase();\r\n            if (a == e) {\r\n                h = c._optId;\r\n                c = null \r\n            }\r\n        }\r\n        if (c != null ) {\r\n            c = c.nextSibling\r\n        }\r\n    }\r\n    if (this.conf.last_match == null ) {\r\n        if (h != null ) {\r\n            this._setSelected(h, true, true);\r\n            this.conf.last_match = h\r\n        } else {\r\n            if (this.conf.f_mode != \"between\" || g == true) {\r\n                this._setSelected(null , true, true);\r\n                this.conf.last_match = null \r\n            }\r\n        }\r\n    } else {\r\n        if (h != null ) {\r\n            if (h != this.conf.last_match) {\r\n                this._setSelected(h, true, true);\r\n                this.conf.last_match = h\r\n            }\r\n        } else {\r\n            this._setSelected(null , true, true);\r\n            this.conf.last_match = null \r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._selectRange = function(c, a) {\r\n    if (this.conf.combo_focus == true) {\r\n        window.dhx4.selectTextRange(this.base.firstChild, c, a)\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.openSelect = function() {\r\n    if (!this._isListVisible()) {\r\n        this._showList()\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.closeAll = function() {\r\n    this._hideList()\r\n}\r\n;\r\ndhtmlXCombo.prototype._showList = function(a) {\r\n    if (this._getListVisibleCount() == 0) {\r\n        if (a && this._isListVisible()) {\r\n            this._hideList()\r\n        }\r\n        return\r\n    }\r\n    if (this._isListVisible()) {\r\n        this._checkListHeight();\r\n        return\r\n    }\r\n    this.list.style.zIndex = window.dhx4.zim.reserve(this.conf.list_zi_id);\r\n    if (this.hdr != null  && this.conf.template.header == true) {\r\n        this.hdr.style.zIndex = Number(this.list.style.zIndex) + 1\r\n    }\r\n    this.list.style.visibility = \"hidden\";\r\n    this.list.style.display = \"\";\r\n    if (this.hdr != null  && this.conf.template.header == true) {\r\n        this.hdr.style.visibility = this.list.style.visibility;\r\n        this.hdr.style.display = this.list.style.display\r\n    }\r\n    var c = (this.hdr != null  && this.conf.template.header == true ? this.hdr.offsetHeight : 0);\r\n    this.list.style.width = Math.max(this.conf.opts_width || this.conf.col_w || 0, this.conf.combo_width) + \"px\";\r\n    this.list.style.top = window.dhx4.absTop(this.base) + c + this.base.offsetHeight - 1 + \"px\";\r\n    this.list.style.left = window.dhx4.absLeft(this.base) + \"px\";\r\n    if (this.hdr != null  && this.conf.template.header == true) {\r\n        this.hdr.style.width = this.list.style.width;\r\n        this.hdr.style.left = this.list.style.left;\r\n        this.hdr.style.top = parseInt(this.list.style.top) - c + \"px\"\r\n    }\r\n    this._checkListHeight();\r\n    this.list.style.visibility = \"visible\";\r\n    if (this.hdr != null  && this.conf.template.header == true) {\r\n        this.hdr.style.visibility = \"visible\"\r\n    }\r\n    this.callEvent(\"onOpen\", [])\r\n}\r\n;\r\ndhtmlXCombo.prototype._hideList = function() {\r\n    if (!this._isListVisible()) {\r\n        return\r\n    }\r\n    window.dhx4.zim.clear(this.conf.list_zi_id);\r\n    this.list.style.display = \"none\";\r\n    if (this.hdr != null  && this.conf.template.header == true) {\r\n        this.hdr.style.display = \"none\"\r\n    }\r\n    this.conf.clear_click = false;\r\n    this.callEvent(\"onClose\", [])\r\n}\r\n;\r\ndhtmlXCombo.prototype._isListVisible = function() {\r\n    return ( this.list.style.display == \"\") \r\n}\r\n;\r\ndhtmlXCombo.prototype._getListVisibleCount = function() {\r\n    var a = 0;\r\n    for (var c = 0; c < this.list.childNodes.length; c++) {\r\n        a += (this.list.childNodes[c].style.display == \"\" ? 1 : 0)\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXCombo.prototype._checkListHeight = function() {\r\n    if (!this._isListVisible()) {\r\n        return\r\n    }\r\n    if (this.conf.item_h == null ) {\r\n        var r = this.list.firstChild;\r\n        while (r != null ) {\r\n            if (r.style.display == \"\") {\r\n                this.conf.item_h = r.offsetHeight + (this.hdr != null  ? -1 : 0);\r\n                r = null \r\n            } else {\r\n                r = r.nextSibling\r\n            }\r\n        }\r\n        r = null \r\n    }\r\n    var u = window.dhx4.screenDim();\r\n    var m = window.dhx4.absTop(this.base);\r\n    var c = this.base.offsetHeight;\r\n    var a = (this.hdr != null  && this.conf.template.header == true ? this.hdr.offsetHeight : 0);\r\n    var e = Math.max(0, Math.floor((m + a - u.top) / this.conf.item_h));\r\n    var o = Math.max(0, Math.floor((u.bottom - (m + c + a)) / this.conf.item_h));\r\n    var v = this._getListVisibleCount();\r\n    if (o < Math.min(this.conf.opts_count_min, v) && e > o) {\r\n        o = null \r\n    }\r\n    var n = Math.min((o == null  ? e : o), this.conf.opts_count, v);\r\n    var g = (n < v ? (n * this.conf.item_h) + \"px\" : \"\");\r\n    var l = this.conf.sp[this.conf.skin][this.hdr != null  && this.conf.template.header == true ? \"hdr_ofs\" : \"list_ofs\"];\r\n    this.list.style.height = g;\r\n    this.list.style.top = (o == null  ? m - this.list.offsetHeight + l : m + c + a - l) + \"px\";\r\n    if (this.hdr != null  && this.conf.template.header == true) {\r\n        this.hdr.style.top = (o == null  ? m - a - this.list.offsetHeight + l : m + c - l) + \"px\"\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._scrollToItem = function(h) {\r\n    var g = this.t[h].item.offsetTop;\r\n    var e = g + this.t[h].item.offsetHeight;\r\n    var c = this.list.scrollTop;\r\n    var a = c + this.list.clientHeight;\r\n    if (g < c) {\r\n        this.list.scrollTop = g + (this.hdr != null  && this.conf.template.header == true ? 1 : 0)\r\n    } else {\r\n        if (e > a) {\r\n            this.list.scrollTop = e - this.list.clientHeight + (this.hdr != null  && this.conf.template.header == true ? -this.conf.sp[this.conf.skin].scr_ofs : 0)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._setSelected = function(g, e, c, a) {\r\n    this.conf.temp_selected = null ;\r\n    if (c) {\r\n        this._updateTopImage(g)\r\n    }\r\n    if (g != null  && this.conf.last_hover == g) {\r\n        if (e) {\r\n            this._scrollToItem(g)\r\n        }\r\n        return\r\n    }\r\n    if (this.conf.last_hover != null ) {\r\n        this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item, false);\r\n        this.conf.last_hover = null ;\r\n        if (g == null ) {\r\n            this.callEvent(\"onSelectionChange\", [])\r\n        }\r\n    }\r\n    if (g != null ) {\r\n        this.t[g].obj.setSelected(this.t[g].item, true);\r\n        this.conf.last_hover = g;\r\n        if (a != true) {\r\n            this.conf.temp_selected = g;\r\n            this.callEvent(\"onSelectionChange\", [])\r\n        }\r\n        if (this.conf.s_mode == \"select\" && this.t[g].item == this.t[g].item.parentNode.lastChild) {\r\n            this._subloadRequest()\r\n        }\r\n        if (e) {\r\n            this._scrollToItem(g)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._subloadRequest = function() {\r\n    if (this.conf.f_url != null  && this.conf.f_dyn == true && this.conf.f_dyn_end == false) {\r\n        var e = \"mask=\" + encodeURIComponent(this.conf.f_mask) + \"&pos=\" + this.list.childNodes.length;\r\n        var a = this;\r\n        var c = function(h) {\r\n            if (a.conf.f_cache) {\r\n                a.conf.f_cache_data[a.conf.f_mask].data.push(h.xmlDoc.responseXML)\r\n            }\r\n            var g = a.list.childNodes.length;\r\n            a.conf.f_loading = true;\r\n            a.load(h.xmlDoc.responseXML);\r\n            a.conf.f_loading = false;\r\n            if (g == a.list.childNodes.length) {\r\n                a.conf.f_dyn_end = true;\r\n                if (a.conf.f_cache) {\r\n                    a.conf.f_cache_data[a.conf.f_mask].dyn_end = true\r\n                }\r\n            }\r\n            c = a = null \r\n        }\r\n        ;\r\n        if (window.dhx4.ajax.method == \"post\") {\r\n            window.dhx4.ajax.post(this.conf.f_url, e, c)\r\n        } else {\r\n            if (window.dhx4.ajax.method == \"get\") {\r\n                window.dhx4.ajax.get(this.conf.f_url + (String(this.conf.f_url).indexOf(\"?\") >= 0 ? \"&\" : \"?\") + e, c)\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.addOption = function(l, m, c, a, g) {\r\n    var e = null ;\r\n    if (!(l instanceof Array)) {\r\n        var n = this._renderOption({\r\n            value: l,\r\n            text: m,\r\n            css: c,\r\n            img: a\r\n        });\r\n        if (e == null  && window.dhx4.s2b(g) == true) {\r\n            e = n\r\n        }\r\n    } else {\r\n        for (var h = 0; h < l.length; h++) {\r\n            if (typeof (l[h]) == \"undefined\") {\r\n                continue\r\n            }\r\n            if (l[h] instanceof Array) {\r\n                n = this._renderOption({\r\n                    value: l[h][0],\r\n                    text: l[h][1],\r\n                    css: l[h][2],\r\n                    img: l[h][3]\r\n                });\r\n                if (e == null  && window.dhx4.s2b(l[h][4]) == true) {\r\n                    e = n\r\n                }\r\n            } else {\r\n                var n = this._renderOption(l[h]);\r\n                if (e == null  && window.dhx4.s2b(l[h].selected) == true) {\r\n                    e = n\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (e != null ) {\r\n        this._setSelected(e, this._isListVisible(), true);\r\n        this._confirmSelect(\"onInit\")\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.updateOption = function(a, e, c, g) {\r\n    var h = this._getOptionId(a);\r\n    if (h == null ) {\r\n        return\r\n    }\r\n    this.t[h].obj.update(this.t[h].item, {\r\n        value: e,\r\n        text: c,\r\n        css: g\r\n    });\r\n    if (this.conf.last_selected == h) {\r\n        this.conf.last_text = this.base.firstChild.value = this.t[h].obj.getText(this.t[h].item, true);\r\n        this.conf.f_server_last = this.base.firstChild.value.toLowerCase()\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.deleteOption = function(g) {\r\n    for (var c in this.t) {\r\n        var e = this.t[c].obj.getValue(this.t[c].item);\r\n        if (e == g) {\r\n            this._removeOption(c)\r\n        }\r\n    }\r\n    if (this._isListVisible()) {\r\n        this._showList(true)\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.clearAll = function(c) {\r\n    c = (typeof (c) == \"undefined\" ? true : window.dhx4.s2b(c));\r\n    for (var e in this.t) {\r\n        this._removeOption(e)\r\n    }\r\n    if (this.conf.tm_hover) {\r\n        window.clearTimeout(this.conf.tm_hover)\r\n    }\r\n    this.conf.last_hover = null ;\r\n    this.conf.last_selected = null ;\r\n    this.list.scrollTop = 0;\r\n    if (c == true) {\r\n        this._hideList()\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._renderOption = function(g) {\r\n    var h = window.dhx4.newId();\r\n    var e = document.createElement(\"DIV\");\r\n    e._optId = h;\r\n    e._tpl = this.conf.template;\r\n    if (typeof (g.img) == \"undefined\" && typeof (g.img_src) != \"undefined\") {\r\n        g.img = g.img_src;\r\n        delete g.img_src\r\n    }\r\n    if (typeof (g.img_dis) == \"undefined\" && typeof (g.img_src_dis) != \"undefined\") {\r\n        g.img_dis = g.img_src_dis;\r\n        delete g.img_src_dis\r\n    }\r\n    g.img_path = this.conf.img_path;\r\n    g.img_def = this.conf.img_def;\r\n    g.img_def_dis = this.conf.img_def_dis;\r\n    this.list.appendChild(e);\r\n    var c = (this._isListVisible() && window.dhx4.isFF == true);\r\n    if (c == true) {\r\n        var a = this.list.scrollTop;\r\n        this.list.scrollTop -= 1\r\n    }\r\n    if (this.hdr != null ) {\r\n        g.multicol = true\r\n    }\r\n    this.t[e._optId] = {\r\n        obj: this.modes[this.conf.opts_type].render(e, g),\r\n        item: e,\r\n        conf: {\r\n            type: this.conf.opts_type\r\n        }\r\n    };\r\n    e = null ;\r\n    if (c == true) {\r\n        this.list.scrollTop += 1\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXCombo.prototype._removeOption = function(a) {\r\n    this.t[a].obj.destruct(this.t[a].item);\r\n    this.t[a].obj = null ;\r\n    this.t[a].item.parentNode.removeChild(this.t[a].item);\r\n    this.t[a].item = null ;\r\n    this.t[a].conf = null ;\r\n    this.t[a] = null ;\r\n    delete this.t[a];\r\n    if (this.conf.last_hover == a) {\r\n        this.conf.last_hover = null \r\n    }\r\n    if (this.conf.last_selected == a) {\r\n        this.conf.last_selected = null ;\r\n        this._confirmSelect(\"onDelete\")\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._confirmSelect = function(e, a) {\r\n    var c = false;\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    }\r\n    if (this.conf.f_server_tm) {\r\n        window.clearTimeout(this.conf.f_server_tm)\r\n    }\r\n    if (this.conf.last_hover != null ) {\r\n        c = c || (this.conf.last_value != this._getOptionValue(this.conf.last_hover));\r\n        this.conf.last_match = this.conf.last_selected = this.conf.last_hover;\r\n        this.conf.last_value = this._getOptionValue(this.conf.last_selected);\r\n        this.conf.last_text = this.base.firstChild.value = this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item, true);\r\n        this.conf.f_server_last = this.base.firstChild.value.toLowerCase();\r\n        this.base.childNodes[1].value = this.conf.last_value;\r\n        this.base.childNodes[2].value = \"false\"\r\n    } else {\r\n        if (this.conf.allow_free_text || (this.base.firstChild.value == \"\" && this.conf.allow_empty_value)) {\r\n            c = c || (this.conf.last_text != this.base.firstChild.value);\r\n            this.conf.last_match = this.conf.last_value = this.conf.last_selected = null ;\r\n            this.conf.last_text = this.base.firstChild.value;\r\n            this.conf.f_server_last = this.base.firstChild.value.toLowerCase();\r\n            this.base.childNodes[1].value = this.conf.last_text;\r\n            this.base.childNodes[2].value = \"true\"\r\n        } else {\r\n            this._cancelSelect(true);\r\n            this._updateTopImage(this.conf.last_selected);\r\n            return\r\n        }\r\n    }\r\n    if (this.conf.f_ac && this.conf.f_mode == \"start\") {\r\n        this.conf.f_ac_text = \"\";\r\n        if (e != \"blur\") {\r\n            this._selectRange(this.base.firstChild.value.length, this.base.firstChild.value.length)\r\n        }\r\n    }\r\n    if (a) {\r\n        this._hideList()\r\n    }\r\n    if (c == true && e != \"onInit\" && e != \"onDelete\") {\r\n        this.callEvent(\"onSelectionChange\", []);\r\n        this.callEvent(\"onChange\", [this.conf.last_value, this.conf.last_text])\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._cancelSelect = function(a) {\r\n    this._hideList();\r\n    if (a == true && this.conf.allow_free_text == false && this.conf.free_text_empty == true) {\r\n        this.conf.f_server_last = this.conf.last_match = this.conf.last_value = this.conf.last_selected = null ;\r\n        this.base.childNodes[1].value = this.conf.last_text = this.base.firstChild.value = \"\";\r\n        this.base.childNodes[2].value = \"false\"\r\n    } else {\r\n        this.base.firstChild.value = this.conf.last_text\r\n    }\r\n    if (this.conf.f_mode != false) {\r\n        this._filterOpts(true)\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype._getOption = function(m, g) {\r\n    if (!this.t[m]) {\r\n        return null \r\n    }\r\n    if (typeof (g) == \"undefined\") {\r\n        g = -1\r\n    }\r\n    if (g < 0) {\r\n        for (var l = 0; l < this.list.childNodes.length; l++) {\r\n            if (g < 0 && this.list.childNodes[l]._optId == m) {\r\n                g = l\r\n            }\r\n        }\r\n    }\r\n    var h = {\r\n        value: this.t[m].obj.getValue(this.t[m].item),\r\n        text: this.t[m].obj.getText(this.t[m].item),\r\n        text_input: this.t[m].obj.getText(this.t[m].item, true),\r\n        text_option: this.t[m].obj.getText(this.t[m].item, null , true),\r\n        css: this.t[m].obj.getCss(this.t[m].item),\r\n        selected: (m == this.conf.last_selected),\r\n        index: g\r\n    };\r\n    if (typeof (this.t[m].obj.getExtraData) == \"function\") {\r\n        var e = this.t[m].obj.getExtraData(this.t[m].item);\r\n        for (var c in e) {\r\n            if (typeof (h[c]) == \"undefined\") {\r\n                h[c] = e[c]\r\n            }\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXCombo.prototype._getOptionProp = function(g, e, c) {\r\n    if (g != null ) {\r\n        var a = this._getOption(g);\r\n        if (a != null ) {\r\n            return a[e]\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXCombo.prototype._getOptionId = function(c) {\r\n    var g = null ;\r\n    for (var a = 0; a < this.list.childNodes.length; a++) {\r\n        if (g == null ) {\r\n            var e = this.list.childNodes[a]._optId;\r\n            if (c == this.t[e].obj.getValue(this.t[e].item)) {\r\n                g = e\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXCombo.prototype._getOptionValue = function(a) {\r\n    return this._getOptionProp(a, \"value\", null )\r\n}\r\n;\r\ndhtmlXCombo.prototype.setSize = function(a) {\r\n    this.conf.combo_width = parseInt(a) - (dhx4.isFF || dhx4.isIE || dhx4.isChrome || dhx4.isOpera ? 2 : 0);\r\n    this.base.style.width = Math.max(0, this.conf.combo_width) + \"px\";\r\n    this._adjustBase()\r\n}\r\n;\r\ndhtmlXCombo.prototype._adjustBase = function() {\r\n    this.base.firstChild.style.width = Math.max(0, (this.conf.combo_width - 24 - (this.conf.combo_image ? 23 : 0))) + \"px\";\r\n    this.base.firstChild.style.marginLeft = (this.conf.combo_image ? \"23px\" : \"0px\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.setOptionWidth = function(a) {\r\n    this.conf.opts_width = (parseInt(a) || null )\r\n}\r\n;\r\ndhtmlXCombo.prototype.setOptionIndex = function(e, a) {\r\n    if (isNaN(a) || a < 0) {\r\n        return\r\n    }\r\n    var g = this.getOption(e);\r\n    if (g == null ) {\r\n        return\r\n    }\r\n    if (a == g.index) {\r\n        return\r\n    }\r\n    var c = this.list.childNodes[g.index];\r\n    c.parentNode.removeChild(c);\r\n    if (this.list.childNodes[a] != null ) {\r\n        this.list.insertBefore(c, this.list.childNodes[a])\r\n    } else {\r\n        this.list.appendChild(c)\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXCombo.prototype.getOptionsCount = function() {\r\n    return this.list.childNodes.length\r\n}\r\n;\r\ndhtmlXCombo.prototype._mcMakeTemplate = function(o) {\r\n    var l = \"\";\r\n    var g = \"\";\r\n    this.conf.col_w = 0;\r\n    for (var m = 0; m < o.length; m++) {\r\n        var a = Number(parseInt(o[m].width) || 50);\r\n        var e = (o[m].css || \"\");\r\n        var n = (m == 0 && window.dhx4.isIE6 == true ? \"_first\" : \"\");\r\n        g += \"<div class='dhxcombo_cell\" + n + \" \" + e + \"' style='width:\" + a + \"px;'><div class='dhxcombo_cell_text'>\" + (o[m].option || \"&nbsp;\") + \"</div></div>\";\r\n        l += \"<div class='dhxcombo_hdrcell\" + n + \" \" + e + \"' style='width:\" + a + \"px;'><div class='dhxcombo_hdrcell_text'>\" + (o[m].header || \"&nbsp;\") + \"</div></div>\";\r\n        this.conf.col_w += a + 1\r\n    }\r\n    var a = 500;\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.position = \"absolute\";\r\n    c.style.top = \"10px\";\r\n    c.style.left = -a * 2 + \"px\";\r\n    c.style.width = a + \"px\";\r\n    c.style.height = \"50px\";\r\n    c.style.overflowY = \"scroll\";\r\n    c.innerHTML = \"<div>&nbsp;</div>\";\r\n    document.body.appendChild(c);\r\n    this.conf.col_w += a - c.firstChild.offsetWidth + 10;\r\n    c.parentNode.removeChild(c);\r\n    c = null ;\r\n    this.conf.template.option = g;\r\n    this._mcAttachHeader(l);\r\n    this.list.className += \" dhxcombolist_multicolumn\"\r\n}\r\n;\r\ndhtmlXCombo.prototype._mcAttachHeader = function(a) {\r\n    if (this.hdr == null ) {\r\n        this.hdr = document.createElement(\"DIV\");\r\n        this.hdr.className = \"dhxcombolist_\" + this.conf.skin + \" dhxcombolist_hdr\";\r\n        this.hdr.style.display = \"none\";\r\n        this.list.parentNode.insertBefore(this.hdr, this.list);\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.hdr.addEventListener(\"mousedown\", this._doOnListMouseDown, false)\r\n        } else {\r\n            this.hdr.attachEvent(\"onmousedown\", this._doOnListMouseDown)\r\n        }\r\n        if (this.conf.opts_type == \"checkbox\" && this.conf.combo_image == true) {\r\n            this.conf.combo_image = false;\r\n            if (this.base.lastChild.className.match(/dhxcombo_top_image/) != null ) {\r\n                this.base.removeChild(this.base.lastChild)\r\n            }\r\n            this._adjustBase()\r\n        }\r\n    }\r\n    this.hdr.innerHTML = \"<div class='dhxcombo_hdrtext'>\" + a + \"</div>\"\r\n}\r\n;\r\ndhtmlXCombo.prototype._mcDetachHeader = function() {\r\n    if (this.hdr != null ) {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.hdr.removeEventListener(\"mousedown\", this._doOnListMouseDown, false)\r\n        } else {\r\n            this.hdr.detachEvent(\"onmousedown\", this._doOnListMouseDown)\r\n        }\r\n        this.hdr.parentNode.removeChild(this.hdr);\r\n        this.hdr = null \r\n    }\r\n    this.conf.col_w = null ;\r\n    this.conf.item_h = null \r\n}\r\n;\r\ndhtmlXCombo.prototype.modes = {};\r\ndhtmlXCombo.prototype.doWithItem = function(a, m, h, e) {\r\n    var l = (a >= 0 && a < this.list.childNodes.length ? this.list.childNodes[a]._optId : null );\r\n    if (l == null ) {\r\n        return null \r\n    }\r\n    if (typeof (this.t[l].obj[m]) != \"function\") {\r\n        return null \r\n    }\r\n    var g = [this.t[l].item];\r\n    for (var c = 2; c < arguments.length; c++) {\r\n        g.push(arguments[c])\r\n    }\r\n    return this.t[l].obj[m].apply(this.t[l].obj, g)\r\n}\r\n;\r\nfunction dhtmlXComboExtend(g, e) {\r\n    for (var c in dhtmlXCombo.prototype.modes[e]) {\r\n        if (typeof (dhtmlXCombo.prototype.modes[g][c]) == \"undefined\") {\r\n            dhtmlXCombo.prototype.modes[g][c] = dhtmlXCombo.prototype.modes[e][c]\r\n        }\r\n    }\r\n}\r\ndhtmlXCombo.prototype.modes.option = {\r\n    image: false,\r\n    html: false,\r\n    option_css: \"dhxcombo_option_text\",\r\n    render: function(a, c) {\r\n        a._conf = {\r\n            value: c.value,\r\n            css: \"\"\r\n        };\r\n        a.className = \"dhxcombo_option\";\r\n        a.innerHTML = \"<div class='\" + this.option_css + \"'>&nbsp;</div>\";\r\n        if (c.css != null ) {\r\n            a.lastChild.style.cssText = c.css;\r\n            a._conf.css = c.css\r\n        }\r\n        this.setText(a, c.text);\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        a._conf = null \r\n    },\r\n    update: function(a, c) {\r\n        a._conf.value = c.value;\r\n        a._conf.css = c.css;\r\n        a.lastChild.style.cssText = c.css;\r\n        this.setText(a, c.text)\r\n    },\r\n    setText: function(c, e) {\r\n        c._conf.text = e;\r\n        var a = (typeof (e) == \"object\" ? window.dhx4.template(c._tpl.option, this.replaceHtml(c._conf.text), true) : window.dhx4.trim(this.replaceHtml(c._conf.text) || \"\"));\r\n        c.lastChild.innerHTML = (a.length == 0 ? \"&nbsp;\" : a)\r\n    },\r\n    getText: function(e, a, c) {\r\n        if (window.dhx4.s2b(a) && typeof (e._conf.text) == \"object\") {\r\n            return window.dhx4.template(e._tpl.input, e._conf.text, true)\r\n        }\r\n        if (window.dhx4.s2b(c) && typeof (e._conf.text) == \"object\") {\r\n            return window.dhx4.template(e._tpl.option, e._conf.text, true)\r\n        }\r\n        return e._conf.text\r\n    },\r\n    getValue: function(a) {\r\n        return a._conf.value\r\n    },\r\n    getCss: function(a) {\r\n        return a._conf.css\r\n    },\r\n    setSelected: function(a, c) {\r\n        a.className = \"dhxcombo_option\" + (c ? \" dhxcombo_option_selected\" : \"\")\r\n    },\r\n    isSelected: function(a) {\r\n        return String(a.className).indexOf(\"dhxcombo_option_selected\") >= 0\r\n    },\r\n    getExtraData: function(a) {\r\n        return {\r\n            type: \"option\"\r\n        }\r\n    },\r\n    replaceHtml: function(g) {\r\n        if (this.html == true) {\r\n            return g\r\n        }\r\n        if (typeof (g) == \"object\") {\r\n            var e = {};\r\n            for (var c in g) {\r\n                e[c] = this.replaceHtml(g[c])\r\n            }\r\n        } else {\r\n            var e = g.replace(/[\\<\\>\\&\\s]/g, function(a) {\r\n                switch (a) {\r\n                case \"<\":\r\n                    return \"&lt;\";\r\n                case \">\":\r\n                    return \"&gt;\";\r\n                case \"&\":\r\n                    return \"&amp;\";\r\n                case \" \":\r\n                    return \"&nbsp;\"\r\n                }\r\n                return a\r\n            })\r\n        }\r\n        return e\r\n    }\r\n};\r\ndhtmlXCombo.prototype.modes.checkbox = {\r\n    image: true,\r\n    html: true,\r\n    image_css: \"dhxcombo_checkbox dhxcombo_chbx_#state#\",\r\n    option_css: \"dhxcombo_option_text dhxcombo_option_text_chbx\",\r\n    render: function(a, c) {\r\n        if (this.image_css_regexp == null ) {\r\n            this.image_css_regexp = new RegExp(this.image_css.replace(\"#state#\", \"\\\\d*\"))\r\n        }\r\n        a._conf = {\r\n            value: c.value,\r\n            css: \"\",\r\n            checked: window.dhx4.s2b(c.checked)\r\n        };\r\n        a.className = \"dhxcombo_option\";\r\n        if (c.multicol == true) {\r\n            c.text.checkbox = \"<div class='\" + String(this.image_css).replace(\"#state#\", (a._conf.checked ? \"1\" : \"0\")) + \"'></div>&nbsp;\";\r\n            a.innerHTML = \"<div class='\" + dhtmlXCombo.prototype.modes.option.option_css + \"'></div>\"\r\n        } else {\r\n            a.innerHTML = \"<div class='\" + String(this.image_css).replace(\"#state#\", (a._conf.checked ? \"1\" : \"0\")) + \"'></div><div class='\" + this.option_css + \"'>&nbsp;</div>\"\r\n        }\r\n        if (c.css != null ) {\r\n            a.lastChild.style.cssText += c.css;\r\n            a._conf.css = c.css\r\n        }\r\n        this.setText(a, c.text);\r\n        return this\r\n    },\r\n    setChecked: function(c, e) {\r\n        c._conf.checked = window.dhx4.s2b(e);\r\n        var a = String(this.image_css).replace(\"#state#\", (c._conf.checked ? \"1\" : \"0\"));\r\n        this._changeChbxCss(c.childNodes, a)\r\n    },\r\n    _changeChbxCss: function(a, c) {\r\n        for (var e = 0; e < a.length; e++) {\r\n            if (a[e].tagName != null  && a[e].className != null  && a[e].className.match(this.image_css_regexp) != null ) {\r\n                a[e].className = c\r\n            } else {\r\n                if (a[e].childNodes.length > 0) {\r\n                    this._changeChbxCss(a[e].childNodes, c)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    isChecked: function(a) {\r\n        return ( a._conf.checked == true) \r\n    },\r\n    getExtraData: function(a) {\r\n        return {\r\n            type: \"checkbox\",\r\n            checked: a._conf.checked\r\n        }\r\n    },\r\n    optionClick: function(h, g, l) {\r\n        var e = true;\r\n        var c = (g.target || g.srcElement);\r\n        while (e == true && c != null  && c != h && c.className != null ) {\r\n            if (c.className.match(this.image_css_regexp) != null ) {\r\n                var a = [h._conf.value, !h._conf.checked];\r\n                if (l.callEvent(\"onBeforeCheck\", a) === true) {\r\n                    this.setChecked(h, !this.isChecked(h));\r\n                    l.callEvent(\"onCheck\", a)\r\n                }\r\n                e = false;\r\n                a = null \r\n            } else {\r\n                c = c.parentNode\r\n            }\r\n        }\r\n        c = l = h = null ;\r\n        return e\r\n    },\r\n    getTopImage: function(c, a) {\r\n        return \"\"\r\n    },\r\n    topImageClick: function(a, c) {\r\n        return true\r\n    }\r\n};\r\ndhtmlXComboExtend(\"checkbox\", \"option\");\r\ndhtmlXCombo.prototype.setChecked = function(a, c) {\r\n    this.doWithItem(a, \"setChecked\", c)\r\n}\r\n;\r\ndhtmlXCombo.prototype.getChecked = function(a) {\r\n    var c = [];\r\n    for (var e = 0; e < this.list.childNodes.length; e++) {\r\n        if (this.isChecked(e)) {\r\n            c.push(this._getOptionProp(this.list.childNodes[e]._optId, \"value\", \"\"))\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXCombo.prototype.isChecked = function(a) {\r\n    return this.doWithItem(a, \"isChecked\")\r\n}\r\n;\r\ndhtmlXCombo.prototype.modes.image = {\r\n    image: true,\r\n    html: true,\r\n    image_css: \"dhxcombo_image\",\r\n    option_css: \"dhxcombo_option_text dhxcombo_option_text_image\",\r\n    render: function(a, c) {\r\n        a._conf = {\r\n            value: c.value,\r\n            css: \"\"\r\n        };\r\n        a.className = \"dhxcombo_option\";\r\n        a.innerHTML = \"<div class='\" + this.image_css + \"'></div><div class='\" + this.option_css + \"'>&nbsp;</div>\";\r\n        if (c.css != null ) {\r\n            a.lastChild.style.cssText += c.css;\r\n            a._conf.css = c.css\r\n        }\r\n        this.setText(a, c.text);\r\n        this.setImage(a, c.img, c.img_dis, c.img_path, c.img_def, c.img_def_dis);\r\n        return this\r\n    },\r\n    update: function(a, c) {\r\n        a._conf.value = c.value;\r\n        a._conf.css = c.css;\r\n        a.lastChild.style.cssText = c.css;\r\n        this.setText(a, c.text);\r\n        this.setImage(a, c.img, c.img_dis, c.img_path, c.img_def, c.img_def_dis)\r\n    },\r\n    setImage: function(e, a, h, l, g, c) {\r\n        if (a != null  && a.length > 0) {\r\n            a = l + a\r\n        } else {\r\n            if (g != null  && g.length > 0) {\r\n                a = l + g\r\n            } else {\r\n                a = null \r\n            }\r\n        }\r\n        if (h != null  && h.length > 0) {\r\n            h = l + h\r\n        } else {\r\n            if (c != null  && c.length > 0) {\r\n                h = l + c\r\n            } else {\r\n                if (c == true) {\r\n                    h = a\r\n                } else {\r\n                    h = null \r\n                }\r\n            }\r\n        }\r\n        e._conf.img = a;\r\n        e._conf.img_dis = h;\r\n        e.firstChild.style.backgroundImage = (a != null  ? \"url(\" + a + \")\" : \"none\")\r\n    },\r\n    getExtraData: function(a) {\r\n        return {\r\n            type: \"image\"\r\n        }\r\n    },\r\n    getTopImage: function(g, e) {\r\n        var c = (e ? \"img\" : \"img_dis\");\r\n        if (g != null  && g._conf[c] != null ) {\r\n            return \"<div class='\" + this.image_css + \"' style='background-image:url(\" + g._conf[c] + \");'></div>\"\r\n        }\r\n        return \"\"\r\n    }\r\n};\r\ndhtmlXComboExtend(\"image\", \"option\");\r\ndhtmlXCombo.prototype.setDefaultImage = function(a, c) {\r\n    if (a != null ) {\r\n        this.conf.img_def = a\r\n    }\r\n    if (c != null ) {\r\n        this.conf.img_def_dis = c\r\n    }\r\n}\r\n;\r\ndhtmlXCombo.prototype.setImagePath = function(a) {\r\n    this.conf.img_path = a\r\n}\r\n;\r\nfunction dhtmlXColorPicker(n) {\r\n    if (!(this instanceof window.dhtmlXColorPicker)) {\r\n        return new dhtmlXColorPicker(n)\r\n    }\r\n    dhx4._eventable(this);\r\n    var h = this, g = undefined, m = null , e, a, c;\r\n    this._nodes = [];\r\n    this.activeNode = null ;\r\n    this._inputListenerId = null ;\r\n    this.base = null ;\r\n    this._globalNode = null ;\r\n    this.memory = null ;\r\n    this.skin = null ;\r\n    this.conf = {\r\n        cp_id: dhx4.newId(),\r\n        x: 0,\r\n        y: 0,\r\n        c: 0,\r\n        indent: 2,\r\n        position: \"right\",\r\n        customColors: false,\r\n        selectedColor: null ,\r\n        hide: false,\r\n        hideOnSelect: false,\r\n        lang: \"en\",\r\n        closeable: true\r\n    };\r\n    this.value = {\r\n        red: -1,\r\n        blue: -1,\r\n        green: -1,\r\n        hue: -1,\r\n        sat: -1,\r\n        lum: -1\r\n    };\r\n    this._initMoveSelection = function(l) {\r\n        l = l || event;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            h._controllerNodes.colorArea.addEventListener(\"mousemove\", h._setMoveSelection, false);\r\n            document.body.addEventListener(\"mouseup\", h._cleanMoveSelection, false)\r\n        } else {\r\n            h._controllerNodes.colorArea.attachEvent(\"onmousemove\", h._setMoveSelection);\r\n            document.body.attachEvent(\"onmouseup\", h._cleanMoveSelection)\r\n        }\r\n        h._setMoveSelection(l, h._controllerNodes.colorArea);\r\n        return false\r\n    }\r\n    ;\r\n    this._cleanMoveSelection = function() {\r\n        if (typeof (window.removeEventListener) == \"function\") {\r\n            h._controllerNodes.colorArea.removeEventListener(\"mousemove\", h._setMoveSelection, false);\r\n            document.body.removeEventListener(\"mouseup\", h._cleanMoveSelection, false)\r\n        } else {\r\n            h._controllerNodes.colorArea.detachEvent(\"onmousemove\", h._setMoveSelection);\r\n            document.body.detachEvent(\"onmouseup\", h._cleanMoveSelection)\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._setMoveSelection = function(l) {\r\n        l = l || event;\r\n        var o = h._getOffsetPosition(l, h._controllerNodes.colorArea);\r\n        if (h._controllerNodes.fr_cover) {\r\n            setTimeout(function() {\r\n                h._setColorAreaXY(o.x, o.y);\r\n                h._setColorByXYC()\r\n            }, 0)\r\n        } else {\r\n            h._setColorAreaXY(o.x, o.y);\r\n            h._setColorByXYC()\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._initMoveContrast = function(l) {\r\n        l = l || event;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            document.body.addEventListener(\"mousemove\", h._setMoveContrast, false);\r\n            document.body.addEventListener(\"mouseup\", h._cleanMoveContrast, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousemove\", h._setMoveContrast);\r\n            document.body.attachEvent(\"onmouseup\", h._cleanMoveContrast)\r\n        }\r\n        h._setMoveContrast(l, h._controllerNodes.contrastArea)\r\n    }\r\n    ;\r\n    this._cleanMoveContrast = function() {\r\n        if (typeof (window.removeEventListener) == \"function\") {\r\n            document.body.removeEventListener(\"mousemove\", h._setMoveContrast, false);\r\n            document.body.removeEventListener(\"mouseup\", h._cleanMoveContrast, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousemove\", h._setMoveContrast);\r\n            document.body.detachEvent(\"onmouseup\", h._cleanMoveContrast)\r\n        }\r\n    }\r\n    ;\r\n    this._setMoveContrast = function(l) {\r\n        l = l || event;\r\n        var o = h._getOffsetPosition(l, h._controllerNodes.contrastArea);\r\n        h._setContrastY(o.y);\r\n        h._setColorByXYC(true)\r\n    }\r\n    ;\r\n    this._doOnSelectColor = function() {\r\n        var l = h.colorAIP.rgb2hex({\r\n            r: h.value.red,\r\n            g: h.value.green,\r\n            b: h.value.blue\r\n        });\r\n        if (h.activeNode != null ) {\r\n            if (h.activeNode.valueCont) {\r\n                h.activeNode.valueCont.value = l\r\n            }\r\n            if (h.activeNode.valueColor) {\r\n                h.activeNode.valueColor.style.backgroundColor = l\r\n            }\r\n        }\r\n        if (h.base._dhx_remove || h.conf.hideOnSelect) {\r\n            h.hide()\r\n        }\r\n        h.callEvent(\"onSelect\", [l, ((h.activeNode) ? h.activeNode.node : null )])\r\n    }\r\n    ;\r\n    this._doOnCancel = function() {\r\n        if (h.callEvent(\"onCancel\", [((h.activeNode) ? h.activeNode.node : null )]) == true && h.conf.closeable == true) {\r\n            h.hide()\r\n        }\r\n    }\r\n    ;\r\n    this._doOnFocusByInput = function() {\r\n        var o = (this != window) ? this : event.srcElement;\r\n        var l = (h.activeNode && h.activeNode.valueCont && h.activeNode.valueCont == o) ? h.activeNode : h._getNodeByValueCont(o);\r\n        h.activeNode = l;\r\n        if (l && l == h.activeNode) {\r\n            h._initListenerInput()\r\n        }\r\n    }\r\n    ;\r\n    this._doOnBlurByInput = function() {\r\n        var o = (this != window) ? this : event.srcElement;\r\n        var l = (h.activeNode && h.activeNode.valueCont && h.activeNode.valueCont == o) ? h.activeNode : h._getNodeByValueCont(o);\r\n        if (l && l == h.activeNode) {\r\n            h._removeListenerInput()\r\n        }\r\n    }\r\n    ;\r\n    this._doOnClickByNode = function(o) {\r\n        o = o || event;\r\n        var l = (this != window) ? this : event.srcElement;\r\n        h.activeNode = (h.activeNode.node != l) ? h._getNodeByElement(l) : h.activeNode;\r\n        if (!h.isVisible()) {\r\n            h.show()\r\n        }\r\n    }\r\n    ;\r\n    this.saveColor = function() {\r\n        h.memory.setValue(h.value)\r\n    }\r\n    ;\r\n    this._onSelectMemoryEl = function(o) {\r\n        var l;\r\n        h._refreshCoordinatesByHSL(o.value.hue, o.value.sat, o.value.lum);\r\n        for (l in o.value) {\r\n            h.value[l] = o.value[l]\r\n        }\r\n        h._refreshContrast();\r\n        h._refreshInputValues();\r\n        h._refreshColorValue()\r\n    }\r\n    ;\r\n    this._doOnClickByBody = function(r) {\r\n        r = r || event;\r\n        var l = true\r\n          , o = r.target || r.srcElement;\r\n        if (h._isBaseNode(o)) {\r\n            l = false\r\n        }\r\n        if (l && h.activeNode && (h.activeNode.node == o || h.activeNode.valueCont == o)) {\r\n            l = false\r\n        }\r\n        if (l) {\r\n            h.hide()\r\n        }\r\n    }\r\n    ;\r\n    this._doOnChangeHSL = function() {\r\n        var r = parseInt(h._controllerNodes.hue.value), o = parseInt(h._controllerNodes.sat.value), l = parseInt(h._controllerNodes.lum.value), s;\r\n        if (isNaN(r) || r > 359 || r < 0) {\r\n            h._controllerNodes.hue.value = h.value.hue\r\n        } else {\r\n            h.value.hue = r\r\n        }\r\n        if (isNaN(o) || o > 100 || o < 0) {\r\n            h._controllerNodes.sat.value = h.value.sat\r\n        } else {\r\n            h.value.sat = o\r\n        }\r\n        if (isNaN(l) || l > 100 || l < 0) {\r\n            h._controllerNodes.lum.value = h.value.lum\r\n        } else {\r\n            h.value.lum = l\r\n        }\r\n        s = h.colorAIP.hsl2rgb(h.value.hue, h.value.sat / 100, h.value.lum / 100);\r\n        h.value.red = Math.round(255 * s.r);\r\n        h.value.green = Math.round(255 * s.g);\r\n        h.value.blue = Math.round(255 * s.b);\r\n        h._refreshCoordinatesByHSL(h.value.hue, h.value.sat, h.value.lum);\r\n        h._refreshContrast();\r\n        h._refreshInputValues();\r\n        h._refreshColorValue()\r\n    }\r\n    ;\r\n    this._doOnChangeRGB = function() {\r\n        var s = parseInt(h._controllerNodes.red.value), r = parseInt(h._controllerNodes.green.value), l = parseInt(h._controllerNodes.blue.value), o;\r\n        if (isNaN(s) || s > 255 || s < 0) {\r\n            h._controllerNodes.red.value = h.value.red\r\n        } else {\r\n            h.value.red = s\r\n        }\r\n        if (isNaN(r) || r > 255 || r < 0) {\r\n            h._controllerNodes.green.value = h.value.green\r\n        } else {\r\n            h.value.green = r\r\n        }\r\n        if (isNaN(l) || l > 255 || l < 0) {\r\n            h._controllerNodes.blue.value = h.value.blue\r\n        } else {\r\n            h.value.blue = l\r\n        }\r\n        o = h.colorAIP.rgb2hsl(h.value.red / 255, h.value.green / 255, h.value.blue / 255);\r\n        h.value.hue = Math.round(o.h);\r\n        h.value.sat = Math.round(o.s * 100);\r\n        h.value.lum = Math.round(o.l * 100);\r\n        h._refreshCoordinatesByHSL(h.value.hue, h.value.sat, h.value.lum);\r\n        h._refreshContrast();\r\n        h._refreshInputValues();\r\n        h._refreshColorValue()\r\n    }\r\n    ;\r\n    this._doOnChangeHSV = function() {\r\n        h._controllerNodes.hsv.value = h.setColor(h._controllerNodes.hsv.value)\r\n    }\r\n    ;\r\n    this._checkType = function(o) {\r\n        var l;\r\n        if (o instanceof Array) {\r\n            l = h._checkType(o[0]);\r\n            switch (l) {\r\n            case \"string\":\r\n                return \"array_string\";\r\n                break;\r\n            case \"input\":\r\n            case \"textarea\":\r\n                return \"array_input\";\r\n                break;\r\n            case \"object\":\r\n                return \"array_object\";\r\n                break;\r\n            default:\r\n                return undefined\r\n            }\r\n        } else {\r\n            if (o == undefined) {\r\n                return null \r\n            } else {\r\n                if (typeof (o) == \"string\") {\r\n                    return \"string\"\r\n                } else {\r\n                    if (o.tagName && o.tagName.toLowerCase() == \"input\") {\r\n                        return \"input\"\r\n                    } else {\r\n                        if (o.tagName && o.tagName.toLowerCase() == \"textarea\") {\r\n                            return \"textarea\"\r\n                        } else {\r\n                            if (o.tagName) {\r\n                                return \"container\"\r\n                            } else {\r\n                                if (typeof (o) == \"object\") {\r\n                                    return \"object\"\r\n                                } else {\r\n                                    return undefined\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._initByObject = function(l) {\r\n        if (l.parent && l.parent.tagName) {\r\n            h.base = l.parent\r\n        } else {\r\n            if (typeof (l.parent) == \"string\") {\r\n                h.base = document.getElementById(l.parent)\r\n            } else {\r\n                h.base = document.createElement(\"div\");\r\n                h.base._dhx_remove = true\r\n            }\r\n        }\r\n        if (l.color) {\r\n            h.conf.selectedColor = l.color\r\n        }\r\n        if (typeof (l.closeable) != \"undefined\") {\r\n            this.conf.closeable = dhx4.s2b(l.closeable)\r\n        }\r\n        if (l.custom_colors) {\r\n            this._tempInitCC = function() {\r\n                var s, r;\r\n                this.initMemoryColors();\r\n                this.conf.customColors = true;\r\n                if (l.custom_colors instanceof Array) {\r\n                    r = l.custom_colors.length;\r\n                    for (s = 0; s < r; s++) {\r\n                        this.setCustomColors(l.custom_colors[s])\r\n                    }\r\n                }\r\n                if (this.base.parentNode) {\r\n                    this.showMemory()\r\n                }\r\n                delete this._tempInitCC\r\n            }\r\n        }\r\n        if (l.hide) {\r\n            h.conf.hide = true\r\n        }\r\n        if (l.input) {\r\n            h._addNode(l.input, l.target_color, l.target_value)\r\n        }\r\n        var o = l.skin || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxcolorpicker\") || \"dhx_skyblue\";\r\n        h.setSkin(o);\r\n        if (l.colors) {\r\n            h.initMemoryColors();\r\n            h.conf.customColors = true\r\n        }\r\n        if (l.link) {\r\n            h._addNode(l.link)\r\n        }\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        var s, o, r;\r\n        if (this.isVisible()) {\r\n            this.hide()\r\n        }\r\n        this.destructMemory();\r\n        o = this._nodes.length;\r\n        for (s = 0; s < o; s++) {\r\n            this._detachEventsFromNode(this._nodes[s]);\r\n            for (r in this._nodes[s]) {\r\n                this._nodes[s][r] = null \r\n            }\r\n            delete this._nodes[s]\r\n        }\r\n        this._nodes = null ;\r\n        if (!this.base._dhx_remove) {\r\n            this.base.className = this.base.className.replace(/\\s?dhtmlxcp_\\S*/, \"\")\r\n        } else {\r\n            delete this.base._dhx_remove\r\n        }\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this._controllerNodes.colorArea.removeEventListener(\"mousedown\", this._initMoveSelection, false);\r\n            this._controllerNodes.colorArea.removeEventListener(\"dblclick\", this._doOnSelectColor, false);\r\n            this._controllerNodes.contrastArea.removeEventListener(\"mousedown\", this._initMoveContrast, false);\r\n            this._controllerNodes.button_save.removeEventListener(\"click\", this._doOnSelectColor, false);\r\n            this._controllerNodes.button_cancel.removeEventListener(\"click\", this._doOnCancel, false);\r\n            this._controllerNodes.hue.removeEventListener(\"change\", this._doOnChangeHSL, false);\r\n            this._controllerNodes.sat.removeEventListener(\"change\", this._doOnChangeHSL, false);\r\n            this._controllerNodes.lum.removeEventListener(\"change\", this._doOnChangeHSL, false);\r\n            this._controllerNodes.red.removeEventListener(\"change\", this._doOnChangeRGB, false);\r\n            this._controllerNodes.green.removeEventListener(\"change\", this._doOnChangeRGB, false);\r\n            this._controllerNodes.blue.removeEventListener(\"change\", this._doOnChangeRGB, false);\r\n            this._controllerNodes.hsv.removeEventListener(\"change\", this._doOnChangeHSV, false)\r\n        } else {\r\n            this._controllerNodes.colorArea.detachEvent(\"onmousedown\", this._initMoveSelection);\r\n            this._controllerNodes.colorArea.detachEvent(\"ondblclick\", this._doOnSelectColor);\r\n            this._controllerNodes.contrastArea.detachEvent(\"onmousedown\", this._initMoveContrast);\r\n            this._controllerNodes.button_save.detachEvent(\"onclick\", this._doOnSelectColor);\r\n            this._controllerNodes.button_cancel.detachEvent(\"onclick\", this._doOnCancel);\r\n            this._controllerNodes.hue.detachEvent(\"onchange\", this._doOnChangeHSL);\r\n            this._controllerNodes.sat.detachEvent(\"onchange\", this._doOnChangeHSL);\r\n            this._controllerNodes.lum.detachEvent(\"onchange\", this._doOnChangeHSL);\r\n            this._controllerNodes.red.detachEvent(\"onchange\", this._doOnChangeRGB);\r\n            this._controllerNodes.green.detachEvent(\"onchange\", this._doOnChangeRGB);\r\n            this._controllerNodes.blue.detachEvent(\"onchange\", this._doOnChangeRGB);\r\n            this._controllerNodes.hsv.detachEvent(\"onchange\", this._doOnChangeHSV)\r\n        }\r\n        if (this._controllerNodes.fr_cover) {\r\n            if (this._controllerNodes.fr_cover.parentNode) {\r\n                this._controllerNodes.fr_cover.parentNode.removeChild(this._controllerNodes.fr_cover)\r\n            }\r\n            delete this._controllerNodes.fr_cover\r\n        }\r\n        dhx4.zim.clear(this.conf.cp_id);\r\n        dhx4._eventable(this, \"clear\");\r\n        for (r in this) {\r\n            this[r] = null \r\n        }\r\n        h = null ,\r\n        m = null ,\r\n        c = null \r\n    }\r\n    ;\r\n    g = this._checkType(n);\r\n    switch (g) {\r\n    case \"object\":\r\n        h._initByObject(n);\r\n        break;\r\n    case \"input\":\r\n    case \"textarea\":\r\n        h._initByObject({});\r\n        this._addNode(n);\r\n        break;\r\n    case \"string\":\r\n        m = document.getElementById(n);\r\n        return new dhtmlXColorPicker(m);\r\n        break;\r\n    case \"container\":\r\n        h._initByObject({\r\n            parent: n\r\n        });\r\n        break;\r\n    case null :\r\n        h._initByObject({});\r\n        break;\r\n    case \"array_string\":\r\n    case \"array_input\":\r\n        h._initByObject({});\r\n        a = n.length;\r\n        for (e = 0; e < a; e++) {\r\n            this._addNode(n[e])\r\n        }\r\n        break;\r\n    case \"array_object\":\r\n        h._initByObject({});\r\n        a = n.length;\r\n        for (e = 0; e < a; e++) {\r\n            c = this._addNode(n[e].input, n[e].target_color, n[e].target_value).conf;\r\n            c.customColors = (n[e].custom_colors != undefined) ? dhx4.s2b(n[e].custom_colors) : c.customColors;\r\n            c.selectedColor = (n[e].color != undefined) ? n[e].color : c.selectedColor\r\n        }\r\n        break\r\n    }\r\n    this.base.innerHTML = \"<div class='dhxcp_g_area'><div class='dhxcp_sub_area'><div class='dhxcp_g_color_area'><div class='dhxcp_color_selector'><div class='dhxcp_v_line'></div><div class='dhxcp_h_line'></div></div><div class='dhxcp_contrast_area'><div class='dhxcp_h_line'></div></div></div><div class='dhxcp_g_input_area'><div class='dhxcp_value_cont'><div class='dhxcp_value_color'></div><input type='text' class='dhxcp_value'/></div><table class='dhxcp_inputs_cont' cellpadding='0' cellspacing='0' border='0'><tr><td class='dhxcp_label_hsl'>\" + this.i18n[this.conf.lang].labelHue + \"</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>\" + this.i18n[this.conf.lang].labelRed + \"</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr><tr><td class='dhxcp_label_hsl'>\" + this.i18n[this.conf.lang].labelSat + \"</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>\" + this.i18n[this.conf.lang].labelGreen + \"</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr><tr><td class='dhxcp_label_hsl'>\" + this.i18n[this.conf.lang].labelLum + \"</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>\" + this.i18n[this.conf.lang].labelBlue + \"</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr></table></div><div class='dhxcp_g_memory_area'></div><div class='dhxcp_buttons_area'><button class='dhx_button_save'>\" + this.i18n[this.conf.lang].btnSelect + \"</button><button class='dhx_button_cancel'>\" + this.i18n[this.conf.lang].btnCancel + \"</button></div></div>\";\r\n    \"</div>\";\r\n    this._globalNode = this.base.firstChild;\r\n    this._controllerNodes = {\r\n        colorArea: this._globalNode.firstChild.firstChild.firstChild,\r\n        v_line: this._globalNode.firstChild.firstChild.firstChild.childNodes[0],\r\n        h_line: this._globalNode.firstChild.firstChild.firstChild.childNodes[1],\r\n        contrastArea: this._globalNode.firstChild.firstChild.childNodes[1],\r\n        contrast_line: this._globalNode.firstChild.firstChild.childNodes[1].firstChild,\r\n        color: this._globalNode.firstChild.childNodes[1].childNodes[0].firstChild,\r\n        hsv: this._globalNode.firstChild.childNodes[1].childNodes[0].childNodes[1],\r\n        hue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[1].firstChild,\r\n        sat: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[1].firstChild,\r\n        lum: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[1].firstChild,\r\n        red: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[3].firstChild,\r\n        green: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[3].firstChild,\r\n        blue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[3].firstChild,\r\n        memory_block: this._globalNode.firstChild.childNodes[2],\r\n        button_save: this._globalNode.firstChild.childNodes[3].firstChild,\r\n        button_cancel: this._globalNode.firstChild.childNodes[3].childNodes[1]\r\n    };\r\n    this._labelNodes = {\r\n        labelHue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].firstChild,\r\n        labelSat: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].firstChild,\r\n        labelLum: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].firstChild,\r\n        labelRed: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[2],\r\n        labelGreen: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[2],\r\n        labelBlue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[2],\r\n        btnAddColor: null ,\r\n        btnSelect: this._globalNode.firstChild.childNodes[3].firstChild,\r\n        btnCancel: this._globalNode.firstChild.childNodes[3].childNodes[1]\r\n    };\r\n    if (typeof (this._tempInitCC) == \"function\") {\r\n        this._tempInitCC()\r\n    }\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this._controllerNodes.colorArea.addEventListener(\"mousedown\", this._initMoveSelection, false);\r\n        this._controllerNodes.colorArea.addEventListener(\"dblclick\", this._doOnSelectColor, false);\r\n        this._controllerNodes.contrastArea.addEventListener(\"mousedown\", this._initMoveContrast, false);\r\n        this._controllerNodes.button_save.addEventListener(\"click\", this._doOnSelectColor, false);\r\n        this._controllerNodes.button_cancel.addEventListener(\"click\", this._doOnCancel, false);\r\n        this._controllerNodes.hue.addEventListener(\"change\", this._doOnChangeHSL, false);\r\n        this._controllerNodes.sat.addEventListener(\"change\", this._doOnChangeHSL, false);\r\n        this._controllerNodes.lum.addEventListener(\"change\", this._doOnChangeHSL, false);\r\n        this._controllerNodes.red.addEventListener(\"change\", this._doOnChangeRGB, false);\r\n        this._controllerNodes.green.addEventListener(\"change\", this._doOnChangeRGB, false);\r\n        this._controllerNodes.blue.addEventListener(\"change\", this._doOnChangeRGB, false);\r\n        this._controllerNodes.hsv.addEventListener(\"change\", this._doOnChangeHSV, false)\r\n    } else {\r\n        this._controllerNodes.colorArea.attachEvent(\"onmousedown\", this._initMoveSelection);\r\n        this._controllerNodes.colorArea.attachEvent(\"ondblclick\", this._doOnSelectColor);\r\n        this._controllerNodes.contrastArea.attachEvent(\"onmousedown\", this._initMoveContrast);\r\n        this._controllerNodes.button_save.attachEvent(\"onclick\", this._doOnSelectColor);\r\n        this._controllerNodes.button_cancel.attachEvent(\"onclick\", this._doOnCancel);\r\n        this._controllerNodes.hue.attachEvent(\"onchange\", this._doOnChangeHSL);\r\n        this._controllerNodes.sat.attachEvent(\"onchange\", this._doOnChangeHSL);\r\n        this._controllerNodes.lum.attachEvent(\"onchange\", this._doOnChangeHSL);\r\n        this._controllerNodes.red.attachEvent(\"onchange\", this._doOnChangeRGB);\r\n        this._controllerNodes.green.attachEvent(\"onchange\", this._doOnChangeRGB);\r\n        this._controllerNodes.blue.attachEvent(\"onchange\", this._doOnChangeRGB);\r\n        this._controllerNodes.hsv.attachEvent(\"onchange\", this._doOnChangeHSV)\r\n    }\r\n    this.setColor(this.conf.selectedColor || \"#ffffff\");\r\n    if (this._nodes.length) {\r\n        for (var e = 0; e < this._nodes.length; e++) {\r\n            this._attachEventsToNode(this._nodes[e])\r\n        }\r\n    }\r\n    if (this.conf.hide) {\r\n        this.hide()\r\n    }\r\n    if (typeof (this._cpInitFRM) == \"function\") {\r\n        this._cpInitFRM()\r\n    }\r\n}\r\ndhtmlXColorPicker.prototype.linkTo = function(c, e, g) {\r\n    if (arguments.length == 1) {\r\n        e = g = c\r\n    }\r\n    var a;\r\n    c = c || null ;\r\n    g = g || null ;\r\n    if (typeof (e) == \"string\") {\r\n        e = document.getElementById(e)\r\n    }\r\n    a = this._addNode(e, c, g);\r\n    if (a) {\r\n        this._attachEventsToNode(a)\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._isBaseNode = function(a) {\r\n    if (a == this.base) {\r\n        return true\r\n    }\r\n    if (a.parentElement == document.body) {\r\n        return false\r\n    } else {\r\n        if (!a.parentElement) {\r\n            return false\r\n        } else {\r\n            return this._isBaseNode(a.parentElement)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._hasInput = function(e) {\r\n    var c, a, g = false;\r\n    a = this._nodes.length;\r\n    for (c = 0; c < a; c++) {\r\n        if (this._nodes[c].valueCont == e) {\r\n            g = true;\r\n            break\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._findNodesByArray = function(h) {\r\n    var e, a, c, g = [];\r\n    a = h.length;\r\n    for (e = 0; e < a; e++) {\r\n        if (typeof (h[e]) == \"string\") {\r\n            c = document.getElementById(h[e])\r\n        } else {\r\n            c = h[e]\r\n        }\r\n        if (c) {\r\n            this._addNode(c)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._addNode = function(h, m, l) {\r\n    var c, g, e, a;\r\n    if (typeof (h) == \"string\") {\r\n        c = document.getElementById(h)\r\n    } else {\r\n        c = h\r\n    }\r\n    if (typeof (m) == \"string\") {\r\n        m = document.getElementById(m)\r\n    }\r\n    if (typeof (l) == \"string\") {\r\n        l = document.getElementById(l)\r\n    }\r\n    if (!c) {\r\n        return null \r\n    }\r\n    if (dhx4.s2b(c.getAttribute(\"colorbox\"))) {\r\n        g = document.createElement(\"div\");\r\n        g.style.width = c.offsetWidth + \"px\";\r\n        g.style.height = c.offsetHeight + \"px\";\r\n        c.style.width = c.offsetWidth - (c.offsetHeight + 8) + \"px\";\r\n        c.parentNode.insertBefore(g, c);\r\n        g.style.position = \"relative\";\r\n        e = document.createElement(\"div\");\r\n        g.appendChild(c);\r\n        g.appendChild(e);\r\n        e.className = \"dhxcp_colorBox\";\r\n        c.className += \" dhxcp_colorInput\";\r\n        e.style.width = e.style.height = c.offsetHeight + \"px\"\r\n    }\r\n    a = {\r\n        node: c,\r\n        valueColor: (m != undefined) ? m : e || c,\r\n        valueCont: (l != undefined) ? l : c,\r\n        conf: {\r\n            customColors: (c.getAttribute(\"customcolors\") != null ) ? dhx4.s2b(c.getAttribute(\"customcolors\")) : null ,\r\n            selectedColor: c.getAttribute(\"selectedcolor\")\r\n        }\r\n    };\r\n    this._nodes.push(a);\r\n    if (!this.activeNode) {\r\n        this.activeNode = a\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.getNode = function(e) {\r\n    var a = null \r\n      , c = null ;\r\n    if (typeof (e) == \"string\") {\r\n        a = document.getElementById(e)\r\n    } else {\r\n        a = e\r\n    }\r\n    if (a.tagName != undefined) {\r\n        c = this._getNodeByElement(a)\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._getNodeByElement = function(e) {\r\n    var g = null , c, a;\r\n    a = this._nodes.length;\r\n    for (c = 0; c < a; c++) {\r\n        if (this._nodes[c].node == e) {\r\n            g = this._nodes[c]\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._getNodeByValueCont = function(e) {\r\n    var g = null , c, a;\r\n    a = this._nodes.length;\r\n    for (c = 0; c < a; c++) {\r\n        if (this._nodes[c].valueCont && this._nodes[c].valueCont == e) {\r\n            g = this._nodes[c]\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.initMemoryColors = function() {\r\n    var c = this;\r\n    this._controllerNodes.memory_block.innerHTML = \"<div class='dhxcp_memory_button_cont'><button class='dhxcp_save_to_memory'><div class='dhxcp_label_bm'>\" + this.i18n[this.conf.lang].btnAddColor + \"</div></button></div><div class='dhxcp_memory_els_cont'><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a></div>\";\r\n    this.memory = new this.Memory(this._controllerNodes.memory_block.childNodes[1]);\r\n    this.memory.onSelect = this._onSelectMemoryEl;\r\n    this.memory.onSave = function(g) {\r\n        var e = c.colorAIP.rgb2hex({\r\n            r: g.red,\r\n            g: g.green,\r\n            b: g.blue\r\n        });\r\n        c.callEvent(\"onSaveColor\", [e])\r\n    }\r\n    ;\r\n    var a = this._controllerNodes.memory_block.childNodes[0].firstChild;\r\n    this._labelNodes.btnAddColor = this._controllerNodes.memory_block.childNodes[0].firstChild.firstChild;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.addEventListener(\"click\", this.saveColor, false)\r\n    } else {\r\n        a.attachEvent(\"onclick\", this.saveColor)\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshCoordinatesByHSL = function(n, m, c) {\r\n    var a, g, e;\r\n    a = Math.round((this.configColorArea.maxX - this.configColorArea.minX) * n / 359) + this.configColorArea.minX;\r\n    g = Math.round((this.configColorArea.maxY - this.configColorArea.minY) * (100 - c) / 100) + this.configColorArea.minY;\r\n    e = Math.round((this.configColorArea.maxY - this.configColorArea.minY) * (100 - m) / 100) + this.configColorArea.minY;\r\n    this._setColorAreaXY(a, g);\r\n    this._setContrastY(e)\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._parseColor = function(e) {\r\n    if (e instanceof Array) {\r\n        var c = {\r\n            r: parseInt(e[0]),\r\n            g: parseInt(e[1]),\r\n            b: parseInt(e[2])\r\n        }\r\n    } else {\r\n        if (typeof (e) == \"string\") {\r\n            e = e.replace(/\\s/g, \"\");\r\n            if (/^rgb\\((\\d{1,3})\\,(\\d{1,3})\\,(\\d{1,3})\\)$/i.test(e)) {\r\n                var a = e.match(/^rgb\\((\\d{1,3})\\,(\\d{1,3})\\,(\\d{1,3})\\)$/i);\r\n                var c = {\r\n                    r: parseInt(a[1]),\r\n                    g: parseInt(a[2]),\r\n                    b: parseInt(a[3])\r\n                }\r\n            } else {\r\n                var c = this.colorAIP.hex2rgb(e)\r\n            }\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.setColor = function(l) {\r\n    var c = this.colorAIP.rgb2hex({\r\n        r: this.value.red,\r\n        g: this.value.green,\r\n        b: this.value.blue\r\n    });\r\n    var e = this._parseColor(l);\r\n    var h = (e instanceof Object);\r\n    h = h && (0 <= e.r && e.r <= 255);\r\n    h = h && (0 <= e.g && e.g <= 255);\r\n    h = h && (0 <= e.b && e.b <= 255);\r\n    if (!h) {\r\n        return c\r\n    }\r\n    var g = this.colorAIP.rgb2hex({\r\n        r: e.r,\r\n        g: e.g,\r\n        b: e.b\r\n    });\r\n    if (g == c) {\r\n        return c\r\n    }\r\n    this.value.red = e.r;\r\n    this.value.green = e.g;\r\n    this.value.blue = e.b;\r\n    var a = this.colorAIP.rgb2hsl(e.r / 255, e.g / 255, e.b / 255);\r\n    this.value.hue = Math.round(a.h);\r\n    this.value.sat = Math.round(a.s * 100);\r\n    this.value.lum = Math.round(a.l * 100);\r\n    this._refreshCoordinatesByHSL(this.value.hue, this.value.sat, this.value.lum);\r\n    this._refreshContrast();\r\n    this._refreshInputValues();\r\n    this._refreshColorValue();\r\n    return g\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.getSelectedColor = function() {\r\n    return [this.colorAIP.rgb2hex({\r\n        r: this.value.red,\r\n        g: this.value.green,\r\n        b: this.value.blue\r\n    }), [this.value.red, this.value.green, this.value.blue], [this.value.hue, this.value.sat, this.value.lum]]\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._attachEventsToNode = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.node.addEventListener(\"click\", this._doOnClickByNode, false)\r\n    } else {\r\n        a.node.attachEvent(\"onclick\", this._doOnClickByNode)\r\n    }\r\n    if (a.valueCont && a.valueCont.tagName.toLowerCase() == \"input\") {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            a.valueCont.addEventListener(\"focus\", this._doOnFocusByInput, false);\r\n            a.valueCont.addEventListener(\"blur\", this._doOnBlurByInput, false)\r\n        } else {\r\n            a.valueCont.attachEvent(\"onfocus\", this._doOnFocusByInput);\r\n            a.valueCont.attachEvent(\"onblur\", this._doOnBlurByInput)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._detachEventsFromNode = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.node.removeEventListener(\"click\", this._doOnClickByNode, false)\r\n    } else {\r\n        a.node.detachEvent(\"onclick\", this._doOnClickByNode)\r\n    }\r\n    if (a.valueCont && a.valueCont.tagName.toLowerCase() == \"input\") {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            a.valueCont.removeEventListener(\"focus\", this._doOnFocusByInput, false);\r\n            a.valueCont.removeEventListener(\"blur\", this._doOnBlurByInput, false)\r\n        } else {\r\n            a.valueCont.detachEvent(\"onfocus\", this._doOnFocusByInput);\r\n            a.valueCont.detachEvent(\"onblur\", this._doOnBlurByInput)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.show = function(c) {\r\n    var a = false;\r\n    if (c != undefined) {\r\n        this.activeNode = this.getNode(c) || this.activeNode\r\n    }\r\n    if (this.activeNode && this.activeNode.valueCont && this.activeNode.valueCont.value) {\r\n        this.setColor(this.activeNode.valueCont.value)\r\n    }\r\n    if (this.activeNode) {\r\n        a = (this.activeNode.conf.customColors != null  ? this.activeNode.conf.customColors : this.conf.customColors);\r\n        this.setColor(this.activeNode.conf.selectedColor)\r\n    } else {\r\n        a = this.conf.customColors\r\n    }\r\n    if (a) {\r\n        this.showMemory()\r\n    } else {\r\n        this.hideMemory()\r\n    }\r\n    if (this.base._dhx_remove) {\r\n        this.base.firstChild.style.zIndex = dhx4.zim.reserve(this.conf.cp_id);\r\n        this.base.style.visibility = \"hidden\";\r\n        if (document.body.firstChild) {\r\n            document.body.insertBefore(this.base, document.body.firstChild)\r\n        } else {\r\n            document.body.appendChild(this.base)\r\n        }\r\n        this._refreshPosition();\r\n        this.base.style.visibility = \"visible\";\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            document.body.addEventListener(\"mousedown\", this._doOnClickByBody, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousedown\", this._doOnClickByBody)\r\n        }\r\n    } else {\r\n        this.base.appendChild(this._globalNode)\r\n    }\r\n    if (this._controllerNodes.fr_cover) {\r\n        this.base.insertBefore(this._controllerNodes.fr_cover, this._globalNode)\r\n    }\r\n    this.callEvent(\"onShow\", [((this.activeNode) ? this.activeNode.node : null )])\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.setPosition = function(c, h) {\r\n    var g = null ;\r\n    var a = parseInt(c);\r\n    var e = parseInt(h);\r\n    if (isNaN(a)) {\r\n        g = ({\r\n            right: \"right\",\r\n            bottom: \"bottom\"\r\n        }[c.toLowerCase()] ? c : null )\r\n    }\r\n    if (this.base._dhx_remove) {\r\n        if (g == null ) {} else {\r\n            this.conf.position = g;\r\n            this._refreshPosition(g)\r\n        }\r\n    } else {\r\n        if (isNaN(a) || isNaN(e)) {} else {\r\n            this._globalNode.style.left = a + \"px\";\r\n            this._globalNode.style.top = e + \"px\";\r\n            if (this._controllerNodes.fr_cover) {\r\n                this._controllerNodes.fr_cover.style.left = this._globalNode.style.left;\r\n                this._controllerNodes.fr_cover.style.top = this._globalNode.style.top\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._initListenerInput = function() {\r\n    var a = this;\r\n    this._inputListenerId = this._inputListenerId || setInterval(function() {\r\n        a._refreshValueByInput()\r\n    }, 70)\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._removeListenerInput = function() {\r\n    if (this._inputListenerId) {\r\n        clearInterval(this._inputListenerId);\r\n        this._inputListenerId = null \r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshValueByInput = function() {\r\n    var c = this.activeNode.valueCont.value\r\n      , a = this.getSelectedColor()[0];\r\n    if (this._inputListenerId) {\r\n        if (/^#[\\da-f]{6}$/i.test(c) && c != a) {\r\n            this.setColor(c);\r\n            this.callEvent(\"onSelect\", [c, this.activeNode.node])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshPosition = function(c) {\r\n    if (this.activeNode == null ) {\r\n        return\r\n    }\r\n    var n = dhx4.absTop(this.activeNode.node);\r\n    var a = dhx4.absLeft(this.activeNode.node);\r\n    var g = dhx4.screenDim();\r\n    var e = this._globalNode.offsetWidth;\r\n    var h = this._globalNode.offsetHeight;\r\n    var m = 0;\r\n    c = c || this.conf.position;\r\n    switch (c) {\r\n    case \"bottom\":\r\n        var m = n + this.activeNode.node.offsetHeight + this.conf.indent;\r\n        var l = a;\r\n        if (l + e > g.left + g.right) {\r\n            l = a + this.activeNode.node.offsetWidth - e\r\n        }\r\n        if (l < g.left) {\r\n            l = a\r\n        }\r\n        if (m + h > g.top + g.bottom) {\r\n            m = n - h - this.conf.indent\r\n        }\r\n        if (m - g.top < 0) {\r\n            m = g.top + this.conf.indent\r\n        }\r\n        this._globalNode.style.top = m + \"px\";\r\n        this._globalNode.style.left = l + \"px\";\r\n        break;\r\n    default:\r\n        var l = a + this.activeNode.node.offsetWidth + this.conf.indent;\r\n        m = n;\r\n        if (c == \"right\") {\r\n            if (l + e > g.left + g.right) {\r\n                l = a - e - this.conf.indent\r\n            }\r\n            if (l < g.left) {\r\n                l = a + this.activeNode.node.offsetWidth + this.conf.indent\r\n            }\r\n        }\r\n        if (g.bottom - (m + h) <= 0) {\r\n            m = n + this.activeNode.node.offsetHeight - h\r\n        }\r\n        if (m - g.top < 0) {\r\n            m = g.top + this.conf.indent\r\n        }\r\n        this._globalNode.style.left = l + \"px\";\r\n        this._globalNode.style.top = m + \"px\"\r\n    }\r\n    if (this._controllerNodes.fr_cover) {\r\n        this._controllerNodes.fr_cover.style.left = this._globalNode.style.left;\r\n        this._controllerNodes.fr_cover.style.top = this._globalNode.style.top\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.isVisible = function() {\r\n    var a = false;\r\n    if (this.base._dhx_remove) {\r\n        a = this.base.parentNode == document.body\r\n    } else {\r\n        a = this._globalNode.parentNode == this.base\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.hide = function() {\r\n    if (this.base._dhx_remove) {\r\n        if (this.base.parentNode) {\r\n            this.base.parentNode.removeChild(this.base);\r\n            dhx4.zim.clear(this.conf.cp_id);\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                document.body.removeEventListener(\"mousedown\", this._doOnClickByBody, false)\r\n            } else {\r\n                document.body.detachEvent(\"onmousedown\", this._doOnClickByBody)\r\n            }\r\n        }\r\n    } else {\r\n        if (this.isVisible() == false) {\r\n            return\r\n        }\r\n        this.base.removeChild(this._globalNode)\r\n    }\r\n    if (this._controllerNodes.fr_cover && this._controllerNodes.fr_cover.parentNode) {\r\n        this._controllerNodes.fr_cover.parentNode.removeChild(this._controllerNodes.fr_cover)\r\n    }\r\n    if (this.callEvent != undefined) {\r\n        this.callEvent(\"onHide\", [((this.activeNode) ? this.activeNode.node : null )])\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.configColorArea = {\r\n    minX: 1,\r\n    maxX: 209,\r\n    minY: 1,\r\n    maxY: 119\r\n};\r\ndhtmlXColorPicker.prototype._skinCollection = {\r\n    dhx_skyblue: true,\r\n    dhx_web: true,\r\n    dhx_terrace: true\r\n};\r\ndhtmlXColorPicker.prototype.i18n = {\r\n    en: {\r\n        labelHue: \"Hue\",\r\n        labelSat: \"Sat\",\r\n        labelLum: \"Lum\",\r\n        labelRed: \"Red\",\r\n        labelGreen: \"Green\",\r\n        labelBlue: \"Blue\",\r\n        btnAddColor: \"Save the color\",\r\n        btnSelect: \"Select\",\r\n        btnCancel: \"Cancel\"\r\n    }\r\n};\r\ndhtmlXColorPicker.prototype.loadUserLanguage = function(a) {\r\n    if (typeof (this._mergeLangModules) == \"function\") {\r\n        this._mergeLangModules()\r\n    }\r\n    this.conf.lang = a;\r\n    this._refreshLanguage()\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshLanguage = function() {\r\n    var a, c = this.i18n[this.conf.lang];\r\n    for (a in c) {\r\n        if (this._labelNodes[a]) {\r\n            this._labelNodes[a].innerHTML = c[a]\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._setColorAreaXY = function(a, e) {\r\n    var c = this.configColorArea;\r\n    a = parseInt(a);\r\n    if (c.minX > a) {\r\n        this.conf.x = c.minX\r\n    } else {\r\n        if (a > c.maxX) {\r\n            this.conf.x = c.maxX\r\n        } else {\r\n            if (!isNaN(a)) {\r\n                this.conf.x = a\r\n            }\r\n        }\r\n    }\r\n    e = parseInt(e);\r\n    if (c.minY > e) {\r\n        this.conf.y = c.minY\r\n    } else {\r\n        if (e > c.maxY) {\r\n            this.conf.y = c.maxY\r\n        } else {\r\n            if (!isNaN(e)) {\r\n                this.conf.y = e\r\n            }\r\n        }\r\n    }\r\n    this._refreshLines()\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._setColorByXYC = function(c) {\r\n    c = c || false;\r\n    this.value.hue = Math.round((359 * (this.conf.x - this.configColorArea.minX)) / (this.configColorArea.maxX - this.configColorArea.minX));\r\n    this.value.lum = Math.round(100 - (100 * (this.conf.y - this.configColorArea.minY)) / (this.configColorArea.maxY - this.configColorArea.minY));\r\n    this.value.sat = Math.round(100 - (100 * (this.conf.c - this.configColorArea.minY)) / (this.configColorArea.maxY - this.configColorArea.minY));\r\n    var a = this.colorAIP.hsl2rgb(this.value.hue, this.value.sat / 100, this.value.lum / 100);\r\n    this.value.red = Math.round(255 * a.r);\r\n    this.value.green = Math.round(255 * a.g);\r\n    this.value.blue = Math.round(255 * a.b);\r\n    if (!c) {\r\n        this._refreshContrast()\r\n    }\r\n    this._refreshInputValues();\r\n    this._refreshColorValue()\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._setContrastY = function(c) {\r\n    var a = this.configColorArea;\r\n    c = parseInt(c);\r\n    if (!isNaN(c)) {\r\n        this.conf.c = Math.min(Math.max(a.minY, c), a.maxY)\r\n    }\r\n    this._refreshContrastLine()\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshInputValues = function() {\r\n    this._controllerNodes.hue.value = this.value.hue;\r\n    this._controllerNodes.sat.value = this.value.sat;\r\n    this._controllerNodes.lum.value = this.value.lum;\r\n    this._controllerNodes.red.value = this.value.red;\r\n    this._controllerNodes.green.value = this.value.green;\r\n    this._controllerNodes.blue.value = this.value.blue\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshColorValue = function() {\r\n    this._controllerNodes.color.style.backgroundColor = \"rgb(\" + [this.value.red, this.value.green, this.value.blue].join(\", \") + \")\";\r\n    var a = this.colorAIP.rgb2hex({\r\n        r: this.value.red,\r\n        g: this.value.green,\r\n        b: this.value.blue\r\n    });\r\n    this._controllerNodes.hsv.value = a;\r\n    this.callEvent(\"onChange\", [a])\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshContrast = function() {\r\n    var g = this.colorAIP.hsl2rgb(this.value.hue, 0, this.value.lum / 100);\r\n    var h = this.colorAIP.hsl2rgb(this.value.hue, 1, this.value.lum / 100);\r\n    var e = this._checkIeVersion();\r\n    if (e && e <= 9) {\r\n        var m = this._controllerNodes.contrastArea.firstChild;\r\n        if (m == this._controllerNodes.contrast_line) {\r\n            m = document.createElement(\"div\");\r\n            m.className += \"dhxcp_ie_gradient\";\r\n            this._controllerNodes.contrastArea.appendChild(m);\r\n            this._controllerNodes.contrastArea.appendChild(this._controllerNodes.contrast_line)\r\n        }\r\n        var c = this.colorAIP.rgb2hex({\r\n            r: Math.round(255 * g.r),\r\n            g: Math.round(255 * g.g),\r\n            b: Math.round(255 * g.b)\r\n        });\r\n        var a = this.colorAIP.rgb2hex({\r\n            r: Math.round(255 * h.r),\r\n            g: Math.round(255 * h.g),\r\n            b: Math.round(255 * h.b)\r\n        });\r\n        m.style.filter = \"progid:DXImageTransform.Microsoft.gradient(startColorstr='\" + a + \"', endColorstr='\" + c + \"', GradientType=0)\"\r\n    } else {\r\n        g = [Math.round(255 * g.r), Math.round(255 * g.g), Math.round(255 * g.b)];\r\n        h = [Math.round(255 * h.r), Math.round(255 * h.g), Math.round(255 * h.b)];\r\n        var l = \"linear-gradient(rgb(\" + h.join(\",\") + \"), rgb(\" + g.join(\",\") + \"))\";\r\n        if (window.dhx4.isKHTML == true && navigator.userAgent.match(/Windows/gi) != null ) {\r\n            l = \"-webkit-\" + l\r\n        }\r\n        this._controllerNodes.contrastArea.style.backgroundImage = l\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshLines = function() {\r\n    this._controllerNodes.v_line.style.left = this.conf.x + \"px\";\r\n    this._controllerNodes.h_line.style.top = this.conf.y + \"px\"\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._refreshContrastLine = function() {\r\n    this._controllerNodes.contrast_line.style.top = this.conf.c + \"px\"\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._getOffsetPosition = function(h, a) {\r\n    var c = {\r\n        x: NaN,\r\n        y: NaN\r\n    }\r\n      , g = h.target || h.srcElement;\r\n    if (g == a) {\r\n        c.x = (h.offsetX != undefined) ? h.offsetX : h.layerX;\r\n        c.y = (h.offsetY != undefined) ? h.offsetY : h.layerY\r\n    } else {\r\n        if (g == this._controllerNodes.v_line) {\r\n            c.y = (h.offsetY != undefined) ? h.offsetY : h.layerY\r\n        } else {\r\n            c.x = (h.offsetX != undefined) ? h.offsetX : h.layerX\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.colorAIP = {\r\n    hex2rgb: function(c) {\r\n        var a = c.match(/^(#)([\\da-f]{2})([\\da-f]{2})([\\da-f]{2})$/i);\r\n        if (a != null ) {\r\n            return {\r\n                r: parseInt(\"0x\" + a[2]),\r\n                g: parseInt(\"0x\" + a[3]),\r\n                b: parseInt(\"0x\" + a[4])\r\n            }\r\n        } else {\r\n            return null \r\n        }\r\n    },\r\n    rgb2hex: function(h) {\r\n        var e = parseInt(h.r)\r\n          , c = parseInt(h.g)\r\n          , a = parseInt(h.b);\r\n        e = e || 0,\r\n        c = c || 0,\r\n        a = a || 0;\r\n        return \"#\" + ((e) ? ((e < 16) ? \"0\" + e.toString(16) : e.toString(16)) : \"00\") + ((c) ? ((c < 16) ? \"0\" + c.toString(16) : c.toString(16)) : \"00\") + ((a) ? ((a < 16) ? \"0\" + a.toString(16) : a.toString(16)) : \"00\")\r\n    },\r\n    rgb2hsl: function(o, n, e) {\r\n        var m, l, c;\r\n        var a = Math.max(o, n, e)\r\n          , h = Math.min(o, n, e);\r\n        c = 0.5 * (a + h);\r\n        if (a == h) {\r\n            m = 0\r\n        } else {\r\n            if (a == o) {\r\n                m = 60 * (n - e) / (a - h);\r\n                if (n < e) {\r\n                    m += 360\r\n                }\r\n            } else {\r\n                if (a == n) {\r\n                    m = 60 * (e - o) / (a - h) + 120\r\n                } else {\r\n                    m = 60 * (o - n) / (a - h) + 240\r\n                }\r\n            }\r\n        }\r\n        if (c == 0 || a == h) {\r\n            l = 0\r\n        } else {\r\n            if (c <= 0.5) {\r\n                l = 0.5 * (a - h) / c\r\n            } else {\r\n                l = 0.5 * (a - h) / (1 - c)\r\n            }\r\n        }\r\n        return {\r\n            h: m,\r\n            s: l,\r\n            l: c\r\n        }\r\n    },\r\n    hsl2rgb: function(o, e, m) {\r\n        var h, l, n;\r\n        var c = []\r\n          , a = [];\r\n        if (m <= 0.5) {\r\n            h = m * (1 + e)\r\n        } else {\r\n            h = m + e - (m * e)\r\n        }\r\n        l = 2 * m - h;\r\n        n = o / 360;\r\n        c.push(n + 1 / 3);\r\n        c.push(n);\r\n        c.push(n - 1 / 3);\r\n        for (var g = 0; g < 3; g++) {\r\n            if (c[g] < 0) {\r\n                c[g] += 1\r\n            } else {\r\n                if (c[g] > 1) {\r\n                    c[g] -= 1\r\n                }\r\n            }\r\n            if (c[g] < 1 / 6) {\r\n                a.push(l + (h - l) * 6 * c[g])\r\n            } else {\r\n                if (c[g] < 0.5) {\r\n                    a.push(h)\r\n                } else {\r\n                    if (c[g] < 2 / 3) {\r\n                        a.push(l + (h - l) * (2 / 3 - c[g]) * 6)\r\n                    } else {\r\n                        a.push(l)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            r: a[0],\r\n            g: a[1],\r\n            b: a[2]\r\n        }\r\n    }\r\n};\r\ndhtmlXColorPicker.prototype._checkIeVersion = function() {\r\n    var a;\r\n    var c = navigator.userAgent.match(/(MSIE)\\s(\\d\\.\\d)/i);\r\n    a = (c && c[2]) ? parseInt(c[2]) : null ;\r\n    return a\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.setCustomColors = function() {\r\n    if (this.memory == null ) {\r\n        this.initMemoryColors();\r\n        this.conf.customColors = true\r\n    }\r\n    var g, e, m, c, h, a;\r\n    e = arguments.length;\r\n    for (g = 0; g < e; g++) {\r\n        if (arguments[g] instanceof Array) {\r\n            m = this._rgb2value(arguments[g][0], arguments[g][1], arguments[g][2]);\r\n            this.memory.setValue(m, null , false);\r\n            continue\r\n        } else {\r\n            if (typeof (arguments[g]) == \"string\") {\r\n                c = arguments[g].match(/^rgb\\((\\d{1,3})\\,(\\d{1,3})\\,(\\d{1,3})\\)$/i);\r\n                if (c instanceof Array) {\r\n                    m = this._rgb2value(c[1], c[2], c[3]);\r\n                    this.memory.setValue(m, null , false);\r\n                    continue\r\n                }\r\n                c = arguments[g].match(/(#[\\da-f]{6})/ig);\r\n                if (c instanceof Array) {\r\n                    a = c.length;\r\n                    for (h = 0; h < a; h++) {\r\n                        m = this._hex2value(c[h]);\r\n                        this.memory.setValue(m, null , false)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.getCustomColors = function() {\r\n    var c = [];\r\n    if (this.memory != null  && this.conf.customColors == true) {\r\n        for (var e = 0; e < this.memory.controllers.length; e++) {\r\n            var a = this.memory.controllers[e].value;\r\n            c.push(this.colorAIP.rgb2hex({\r\n                r: a.red,\r\n                g: a.green,\r\n                b: a.blue\r\n            }))\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._rgb2value = function(h, e, a) {\r\n    var c = this.colorAIP.rgb2hsl(h / 255, e / 255, a / 255);\r\n    return {\r\n        red: h,\r\n        green: e,\r\n        blue: a,\r\n        hue: Math.round(c.h),\r\n        sat: Math.round(c.s * 100),\r\n        lum: Math.round(c.l * 100)\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._hex2value = function(e) {\r\n    var c, a;\r\n    c = this.colorAIP.hex2rgb(e);\r\n    a = this.colorAIP.rgb2hsl(c.r / 255, c.g / 255, c.b / 255);\r\n    return {\r\n        red: c.r,\r\n        green: c.g,\r\n        blue: c.b,\r\n        hue: Math.round(a.h),\r\n        sat: Math.round(a.s * 100),\r\n        lum: Math.round(a.l * 100)\r\n    }\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.showMemory = function() {\r\n    if (this.memory == null ) {\r\n        this.initMemoryColors()\r\n    }\r\n    if (!this._globalNode.className.match(/dhxcp_add_memory/)) {\r\n        this._globalNode.className += \" dhxcp_add_memory\"\r\n    }\r\n    this.conf.customColors = true\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.hideMemory = function() {\r\n    if (this.memory != null ) {\r\n        this._globalNode.className = this._globalNode.className.replace(/\\sdhxcp_add_memory/, \"\")\r\n    }\r\n    this.conf.customColors = false\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.setSkin = function(h) {\r\n    h = h.toLowerCase();\r\n    var e, c = -1, a, g = \"dhtmlxcp\";\r\n    e = this.base.className.match(/\\S\\w+/ig);\r\n    if (e instanceof Array) {\r\n        for (a in this._skinCollection) {\r\n            if (c == -1) {\r\n                c = this._indexOf(e, g + \"_\" + a)\r\n            } else {\r\n                break\r\n            }\r\n        }\r\n        c = (c == -1) ? e.length : c\r\n    } else {\r\n        e = [];\r\n        c = 0\r\n    }\r\n    e[c] = g + \"_\" + h;\r\n    this.base.className = e.join(\" \");\r\n    this.skin = h\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.hideOnSelect = function(a) {\r\n    a = dhx4.s2b(a);\r\n    this.conf.hideOnSelect = a\r\n}\r\n;\r\ndhtmlXColorPicker.prototype._indexOf = function(a, g) {\r\n    var e, c, h = -1;\r\n    c = a.length;\r\n    for (e = c; e >= 0; e--) {\r\n        if (a[e] == g) {\r\n            h = e;\r\n            break\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXColorPicker.prototype.destructMemory = function() {\r\n    if (this.memory == null ) {\r\n        return\r\n    }\r\n    this.hideMemory();\r\n    var a = this._controllerNodes.memory_block.childNodes[0].firstChild;\r\n    this._labelNodes.btnAddColor = null ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.removeEventListener(\"click\", this.saveColor, false)\r\n    } else {\r\n        a.detachEvent(\"onclick\", this.saveColor)\r\n    }\r\n    this.memory.remove();\r\n    this._controllerNodes.memory_block.innerHTML = \"\";\r\n    this.memory = null \r\n}\r\n;\r\ndhtmlXColorPicker.prototype.Memory = function(e) {\r\n    var c = this\r\n      , a = null \r\n      , g = {\r\n        red: 255,\r\n        blue: 255,\r\n        green: 255,\r\n        hue: 0,\r\n        sat: 0,\r\n        lum: 100\r\n    };\r\n    this.select = function() {\r\n        var l = (this != window) ? this : event.srcElement;\r\n        var h = h || l.dhxpc_memory;\r\n        if (a != null ) {\r\n            c.unSelect()\r\n        }\r\n        a = h;\r\n        h.domElement.className += \" dhxcp_memory_el_select\";\r\n        if (typeof (c.onSelect) == \"function\") {\r\n            c.onSelect(h)\r\n        }\r\n    }\r\n    ;\r\n    this.onSelect = null ;\r\n    this.onSave = null ;\r\n    this._createMemoryController = function(h) {\r\n        var l = {\r\n            domElement: h,\r\n            value: dhx4._copyObj(g)\r\n        };\r\n        h.dhxpc_memory = l;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            h.addEventListener(\"click\", c.select, false)\r\n        } else {\r\n            h.attachEvent(\"onclick\", c.select)\r\n        }\r\n        return l\r\n    }\r\n    ;\r\n    this._findMemoryControllers = function(r) {\r\n        var n = r.getElementsByTagName(\"a\"), m, h, o = [];\r\n        h = n.length;\r\n        for (m = 0; m < h; m++) {\r\n            o.push(this._createMemoryController(n[m]))\r\n        }\r\n        return o\r\n    }\r\n    ;\r\n    this.controllers = this._findMemoryControllers(e);\r\n    this.unSelect = function() {\r\n        if (a) {\r\n            a.domElement.className = a.domElement.className.replace(/\\s.*$/i, \"\")\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this.setActiveNext = function() {\r\n        var m = null , h;\r\n        if (a == null ) {\r\n            a = this.controllers[0]\r\n        } else {\r\n            m = this.getIndex(a);\r\n            h = this.controllers.length;\r\n            this.unSelect();\r\n            a = (m + 1 < h) ? this.controllers[m + 1] : this.controllers[0]\r\n        }\r\n        a.domElement.className += \" dhxcp_memory_el_next\";\r\n        return a\r\n    }\r\n    ;\r\n    this.setValue = function(l, h, m) {\r\n        a = h || a;\r\n        if (a == null ) {\r\n            a = this.controllers[0]\r\n        }\r\n        a.value.red = l.red;\r\n        a.value.blue = l.blue;\r\n        a.value.green = l.green;\r\n        a.value.hue = l.hue;\r\n        a.value.sat = l.sat;\r\n        a.value.lum = l.lum;\r\n        a.domElement.style.backgroundColor = \"rgb(\" + [l.red, l.green, l.blue].join(\", \") + \")\";\r\n        this.setActiveNext();\r\n        if ((m != false) && (typeof (this.onSave) == \"function\")) {\r\n            this.onSave(l)\r\n        }\r\n    }\r\n    ;\r\n    this.clean = function() {\r\n        var h = this.controllers.length, n;\r\n        for (var m = 0; m < h; m++) {\r\n            n = this.controllers[m];\r\n            n.value = dhx4._copyObj(g);\r\n            n.domElement.style.backgroundColor = \"rgb(\" + [g.red, g.green, g.blue].join(\", \") + \")\"\r\n        }\r\n        this.unSelect();\r\n        a = this.controllers[0]\r\n    }\r\n    ;\r\n    this.getIndex = function(n) {\r\n        var m, h, o = -1;\r\n        h = this.controllers.length;\r\n        for (m = 0; m < h; m++) {\r\n            if (this.controllers[m] == n) {\r\n                o = m;\r\n                break\r\n            }\r\n        }\r\n        return o\r\n    }\r\n    ;\r\n    this.remove = function() {\r\n        var m, h;\r\n        h = this.controllers.length;\r\n        for (m = 0; m < h; m++) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                this.controllers[m].domElement.removeEventListener(\"click\", this.select, false)\r\n            } else {\r\n                this.controllers[m].domElement.detachEvent(\"onclick\", this.select)\r\n            }\r\n            delete this.controllers[m].domElement.dhxpc_memory\r\n        }\r\n        delete this.onSelect;\r\n        delete this.controllers;\r\n        delete this.onSave\r\n    }\r\n}\r\n;\r\nif (window.dhx4.isIE6) {\r\n    dhtmlXColorPicker.prototype._cpInitFRM = function() {\r\n        var a;\r\n        if (!this._controllerNodes.fr_cover) {\r\n            a = document.createElement(\"IFRAME\");\r\n            a.className = \"dhxcp_frm\";\r\n            a.border = 0;\r\n            a.frameBorder = 0;\r\n            this._controllerNodes.fr_cover = a\r\n        }\r\n        if (!this.base._dhx_remove) {\r\n            this.base.insertBefore(a, this._globalNode)\r\n        }\r\n    }\r\n}\r\nfunction dhtmlXSlider(c) {\r\n    var a = this;\r\n    this.conf = {\r\n        size: null ,\r\n        skin: null ,\r\n        vertical: false,\r\n        min: 0,\r\n        max: 99,\r\n        value: 0,\r\n        step: 1,\r\n        decimals: 0,\r\n        margin: 2,\r\n        border: 1,\r\n        inverse: false,\r\n        disabled: false,\r\n        tooltip: false,\r\n        visible: true,\r\n        linkTo: null ,\r\n        range: false,\r\n        bg: null ,\r\n        bg_mode: \"left\"\r\n    };\r\n    this._attachedNode = {};\r\n    this._movingInitialValues = null ;\r\n    this.base = null ;\r\n    if (arguments.length > 1) {\r\n        return new dhtmlXSlider(this._renderArgumets(arguments))\r\n    } else {\r\n        if (typeof (c) == \"string\" || (typeof (c) == \"object\" && c.tagName)) {\r\n            return new dhtmlXSlider({\r\n                parent: c\r\n            })\r\n        }\r\n    }\r\n    if (typeof (c.parent) == \"string\") {\r\n        this.base = document.getElementById(c.parent)\r\n    } else {\r\n        this.base = c.parent\r\n    }\r\n    this._mergeConfig(this._readAttFormNode(this.base));\r\n    this._mergeConfig(c);\r\n    if (this.conf.bg == null ) {\r\n        this.conf.bg = (this.conf.range == true)\r\n    }\r\n    if (this.conf.range == true) {\r\n        if (!(this.conf.value instanceof Array)) {\r\n            this.conf.value = [this.conf.value]\r\n        }\r\n        if (this.conf.value.length < 2) {\r\n            this.conf.value.push(this.conf.value[0])\r\n        }\r\n        if (!(this.conf.linkTo instanceof Array)) {\r\n            this.conf.linkTo = [this.conf.linkTo]\r\n        }\r\n    }\r\n    this._detectDecimals();\r\n    if (this.conf.size == null  || typeof (this.conf.size) == \"undefined\") {\r\n        if (this.conf.vertical) {\r\n            this.conf.size = this.base.offsetHeight\r\n        } else {\r\n            this.conf.size = this.base.offsetWidth\r\n        }\r\n    }\r\n    var e = this.conf.skin || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxslider\") || \"dhx_skyblue\";\r\n    this.setSkin(e);\r\n    this.base.innerHTML = \"<div class='dhxsl_container'><div class='dhxsl_track'>\" + (this.conf.bg == true ? \"<div class='dhxsl_track_bg'></div>\" : \"\") + \"</div><div class='dhxsl_runner'></div>\" + (this.conf.range == true ? \"<div class='dhxsl_runner'></div>\" : \"\") + \"</div>\";\r\n    this._nodes = {\r\n        cont: this.base.firstChild,\r\n        track: this.base.firstChild.firstChild,\r\n        runner: this.base.firstChild.childNodes[1],\r\n        runner2: this.base.firstChild.childNodes[2]\r\n    };\r\n    this._nodes.cont.onmousedown = this._nodes.track.onmousedown = this._nodes.cont.onselectstart = this._nodes.track.onselectstart = function(g) {\r\n        g = g || event;\r\n        if (typeof (g.preventDefault) == \"function\") {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._r_actv = null ;\r\n    if (this.conf.range == true) {\r\n        this.conf.value = this._normalizeRange(this.conf.value, this.conf.min, this.conf.max)\r\n    } else {\r\n        this.conf.value = this._normalize(this.conf.value, this.conf.min, this.conf.max)\r\n    }\r\n    this._setOrient(this.conf.vertical);\r\n    this.setSize(this.conf.size);\r\n    this._initMover = function(h, g) {\r\n        if (a.conf.disabled) {\r\n            return\r\n        }\r\n        h = h || event;\r\n        if (typeof (h.preventDefault) == \"function\") {\r\n            h.preventDefault()\r\n        }\r\n        if (g != null ) {\r\n            a._r_actv = a._nodes[g == 0 ? \"runner\" : \"runner2\"]\r\n        } else {\r\n            a._r_actv = h.target || h.srcElement;\r\n            if (a._r_actv.className.indexOf(\"dhxsl_runner\") == -1) {\r\n                a._r_actv = a._nodes.runner\r\n            }\r\n        }\r\n        a._r_actv.className = \"dhxsl_runner dhxsl_runner_actv\";\r\n        a._movingInitialValues = {};\r\n        if (a.conf.range == true) {\r\n            a._movingInitialValues.index = (a._r_actv == a._nodes.runner ? 0 : 1);\r\n            a._movingInitialValues.value = a.conf.value[a._movingInitialValues.index]\r\n        } else {\r\n            a._movingInitialValues.value = a.conf.value\r\n        }\r\n        a._movingInitialValues.coord = a._getTouchCoord(h);\r\n        if (a.conf.disabled == false) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                window.addEventListener(\"mousemove\", a._move, false);\r\n                window.addEventListener(\"mouseup\", a._cleanMove, false);\r\n                window.addEventListener(\"touchmove\", a._move, false);\r\n                window.addEventListener(\"touchend\", a._cleanMove, false)\r\n            } else {\r\n                document.body.attachEvent(\"onmousemove\", a._move);\r\n                document.body.attachEvent(\"onmouseup\", a._cleanMove)\r\n            }\r\n        }\r\n        a.callEvent(\"onMouseDown\", [a._r_actv == a._nodes.runner ? 0 : 1]);\r\n        return false\r\n    }\r\n    ;\r\n    this._move = function(o) {\r\n        if (a.conf.disabled) {\r\n            return\r\n        }\r\n        o = o || event;\r\n        if (typeof (o.preventDefault) == \"function\") {\r\n            o.preventDefault()\r\n        }\r\n        var n = (a.conf.vertical) ? a._r_actv.offsetHeight : a._r_actv.offsetWidth;\r\n        var l = a.conf.max - a.conf.min;\r\n        var h = a._getTouchCoord(o);\r\n        var m = a._movingInitialValues.value + (h - a._movingInitialValues.coord) * l / (a.conf.size - n) * (a.conf.inverse ? -1 : 1);\r\n        if (a.conf.range == true) {\r\n            var g = [a.conf.value[0], a.conf.value[1]];\r\n            if (a._movingInitialValues.index == 0) {\r\n                g[0] = Math.min(g[1], m)\r\n            } else {\r\n                if (a._movingInitialValues.index == 1) {\r\n                    g[1] = Math.max(g[0], m)\r\n                }\r\n            }\r\n            a.setValue(g, true)\r\n        } else {\r\n            a.setValue(m, true)\r\n        }\r\n    }\r\n    ;\r\n    this._cleanMove = function(g) {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"mousemove\", a._move, false);\r\n            window.removeEventListener(\"mouseup\", a._cleanMove, false);\r\n            window.removeEventListener(\"touchmove\", a._move, false);\r\n            window.removeEventListener(\"touchend\", a._cleanMove, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousemove\", a._move);\r\n            document.body.detachEvent(\"onmouseup\", a._cleanMove)\r\n        }\r\n        a._movingInitialValues = null ;\r\n        a._r_actv.className = a._r_actv.className.replace(/\\s{0,}dhxsl_runner_actv/gi, \"\");\r\n        a.callEvent(\"onSlideEnd\", [a.conf.value]);\r\n        a.callEvent(\"onMouseUp\", [a._r_actv == a._nodes.runner ? 0 : 1]);\r\n        a._r_actv = null \r\n    }\r\n    ;\r\n    this._doOnSetValue = function(s) {\r\n        if (a.conf.disabled) {\r\n            return\r\n        }\r\n        if (a._movingInitialValues != null ) {\r\n            return false\r\n        }\r\n        s = s || event;\r\n        if (typeof (s.preventDefault) == \"function\") {\r\n            s.preventDefault()\r\n        }\r\n        var r = 0;\r\n        var m = s.target || s.srcElement;\r\n        if (m.className.match(/dhxsl_track_bg/) != null ) {\r\n            r = parseInt(m.style[a.conf.vertical ? \"top\" : \"left\"])\r\n        }\r\n        if (s.type.match(/touch/) != null ) {\r\n            var o = a._getTouchCoord(s) + r\r\n        } else {\r\n            var o = (a.conf.vertical ? (s.offsetY || s.layerY) : (s.offsetX || s.layerX)) + r\r\n        }\r\n        var n = (a.conf.vertical ? a._nodes.runner.offsetHeight : a._nodes.runner.offsetWidth) + r;\r\n        var g = a.conf.max - a.conf.min;\r\n        var h = null ;\r\n        var l = null ;\r\n        if (a.conf.inverse == true) {\r\n            l = a.conf.max - (o * g / (a.conf.size))\r\n        } else {\r\n            l = (o * g / (a.conf.size) + a.conf.min)\r\n        }\r\n        if (a.conf.range == true) {\r\n            h = (Math.abs(a.conf.value[0] - l) <= Math.abs(a.conf.value[1] - l) ? 0 : 1);\r\n            l = [h == 0 ? l : a.conf.value[0], h == 1 ? l : a.conf.value[1]]\r\n        }\r\n        a.conf.init_index = h;\r\n        a.setValue(l, true);\r\n        a.conf.init_index = null ;\r\n        if (a._movingInitialValues == null ) {\r\n            a._initMover(s, h)\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._doOnChangeInput = function(h) {\r\n        h = h || event;\r\n        var g = h.target || h.srcElement;\r\n        a.setValue(g.value)\r\n    }\r\n    ;\r\n    this._doOnKeyDown = function(h) {\r\n        h = h || event;\r\n        var g = h.target || h.srcElement;\r\n        if (h.keyCode == 13) {\r\n            a.setValue(g.value)\r\n        }\r\n    }\r\n    ;\r\n    this._attachEvents(this._nodes);\r\n    this.unload = function() {\r\n        dhx4._eventable(this, \"clear\");\r\n        this._detachNode();\r\n        this._detachEvents(this._nodes);\r\n        this.base.removeChild(this._nodes.cont);\r\n        this._nodes.cont.onmousedown = this._nodes.track.onmousedown = this._nodes.cont.onselectstart = this._nodes.track.onselectstart = null ;\r\n        delete this._nodes.cont;\r\n        delete this._nodes.track;\r\n        delete this._nodes.max;\r\n        delete this._nodes.min;\r\n        delete this._nodes.runner;\r\n        if (this._nodes.runner2) {\r\n            delete this._nodes.runner2\r\n        }\r\n        if (/\\s?dhtmlxslider_\\S*/.test(this.base.className)) {\r\n            this.base.className = this.base.className.replace(/\\s?dhtmlxslider_\\S*/, \"\")\r\n        }\r\n        for (var g in this) {\r\n            this[g] = null \r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    dhx4._eventable(this);\r\n    if (this.conf.disabled) {\r\n        this.disable()\r\n    }\r\n    if (this.conf.tooltip) {\r\n        this.enableTooltip()\r\n    }\r\n    if (!this.conf.visible) {\r\n        this.hide()\r\n    }\r\n    if (this.conf.linkTo) {\r\n        this.linkTo(this.conf.linkTo)\r\n    }\r\n    return this\r\n}\r\ndhtmlXSlider.prototype._setOrient = function(a) {\r\n    a = a || false;\r\n    if (/\\s?dhxsl_cont_hr/i.test(this._nodes.cont.className)) {\r\n        this._nodes.cont.className = this._nodes.cont.className.replace(/\\s?dhxsl_cont_hr/i, \"\")\r\n    }\r\n    if (/\\s?dhxsl_cont_vr/i.test(this._nodes.cont.className)) {\r\n        this._nodes.cont.className = this._nodes.cont.className.replace(/\\s?dhxsl_cont_vr/i, \"\")\r\n    }\r\n    if (a) {\r\n        this._nodes.cont.className += \" dhxsl_cont_vr\"\r\n    } else {\r\n        this._nodes.cont.className += \" dhxsl_cont_hr\"\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype._getTouchCoord = function(c) {\r\n    var a = (c.type.match(/mouse/) != null  ? \"client\" : \"page\") + (this.conf.vertical == true ? \"Y\" : \"X\");\r\n    var g = (typeof (c[a]) != \"undefined\" && c[a] != 0 ? c[a] : (c.touches != null  && c.touches[0] != null  ? c.touches[0][a] || 0 : 0));\r\n    return g\r\n}\r\n;\r\ndhtmlXSlider.prototype._attachEvents = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.runner.addEventListener(\"mousedown\", this._initMover, false);\r\n        a.runner.addEventListener(\"touchstart\", this._initMover, false);\r\n        a.cont.addEventListener(\"mousedown\", this._doOnSetValue, false);\r\n        a.cont.addEventListener(\"touchstart\", this._doOnSetValue, false);\r\n        if (a.runner2) {\r\n            a.runner2.addEventListener(\"mousedown\", this._initMover, false);\r\n            a.runner2.addEventListener(\"touchstart\", this._initMover, false)\r\n        }\r\n    } else {\r\n        a.runner.attachEvent(\"onmousedown\", this._initMover);\r\n        a.cont.attachEvent(\"onmousedown\", this._doOnSetValue);\r\n        if (a.runner2) {\r\n            a.runner2.attachEvent(\"onmousedown\", this._initMover)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype._detachEvents = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.runner.removeEventListener(\"mousedown\", this._initMover, false);\r\n        a.runner.removeEventListener(\"touchstart\", this._initMover, false);\r\n        a.cont.removeEventListener(\"mousedown\", this._doOnSetValue, false);\r\n        a.cont.removeEventListener(\"touchstart\", this._doOnSetValue, false);\r\n        if (a.runner2) {\r\n            a.runner2.removeEventListener(\"mousedown\", this._initMover, false);\r\n            a.runner2.removeEventListener(\"touchstart\", this._initMover, false)\r\n        }\r\n    } else {\r\n        a.runner.detachEvent(\"onmousedown\", this._initMover);\r\n        a.cont.detachEvent(\"onmousedown\", this._doOnSetValue);\r\n        if (a.runner2) {\r\n            a.runner2.detachEvent(\"onmousedown\", this._initMover)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype._mergeConfig = function(c) {\r\n    for (var a in c) {\r\n        switch (a.toLowerCase()) {\r\n        case \"min\":\r\n        case \"max\":\r\n        case \"size\":\r\n        case \"step\":\r\n        case \"value\":\r\n        case \"inverse\":\r\n            this.conf[a] = c[a];\r\n            break;\r\n        case \"tooltip\":\r\n        case \"visible\":\r\n        case \"vertical\":\r\n        case \"disabled\":\r\n        case \"range\":\r\n        case \"bg\":\r\n            this.conf[a] = dhx4.s2b(c[a]);\r\n            break;\r\n        case \"bg_mode\":\r\n            this.conf[a] = ({\r\n                left: \"left\",\r\n                right: \"right\"\r\n            }[c[a]]) || \"left\";\r\n            break;\r\n        case \"parent\":\r\n            continue;break;\r\n        case \"skin\":\r\n            this.conf[a] = (this._skinCollection[c[a]] == true ? c[a] : null );\r\n            break;\r\n        default:\r\n            this.conf[a] = c[a]\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype._readAttFormNode = function(g) {\r\n    var m = g.attributes, a = m.length, e, h = {}, c;\r\n    for (e = 0; e < a; e++) {\r\n        c = m[e];\r\n        switch (c.name.toLowerCase()) {\r\n        case \"size\":\r\n        case \"min\":\r\n        case \"max\":\r\n        case \"value\":\r\n        case \"step\":\r\n            h[c.name] = Number(c.value);\r\n            break;\r\n        case \"skin\":\r\n            h[c.name] = c.value;\r\n            break;\r\n        case \"vertical\":\r\n        case \"disabled\":\r\n        case \"visible\":\r\n        case \"range\":\r\n        case \"bg\":\r\n            h[c.name] = dhx4.s2b(c.value);\r\n            break;\r\n        case \"linkto\":\r\n            h[c.name] = c.value;\r\n            break;\r\n        case \"tooltip\":\r\n            h[c.name] = dhx4.s2b(c.value);\r\n            break;\r\n        case \"bg_mode\":\r\n            h[c.name] = ({\r\n                left: \"left\",\r\n                right: \"right\"\r\n            }[c.value]) || \"left\";\r\n            break\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXSlider.prototype._renderArgumets = function(a) {\r\n    var g = {}, e, c;\r\n    c = a.length;\r\n    for (e = 0; e < c; e++) {\r\n        switch (e) {\r\n        case 0:\r\n            g.parent = a[e];\r\n            break;\r\n        case 1:\r\n            g.size = a[e];\r\n            break;\r\n        case 2:\r\n            g.skin = a[e];\r\n            break;\r\n        case 3:\r\n            g.vertical = a[e];\r\n            break;\r\n        case 4:\r\n            g.min = a[e];\r\n            break;\r\n        case 5:\r\n            g.max = a[e];\r\n            break;\r\n        case 6:\r\n            g.value = a[e];\r\n            break;\r\n        case 7:\r\n            g.step = a[e];\r\n            break\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXSlider.prototype._skinCollection = {\r\n    dhx_skyblue: true,\r\n    dhx_web: true,\r\n    dhx_terrace: true\r\n};\r\ndhtmlXSlider.prototype._indexOf = function(a, g) {\r\n    var e, c, h = -1;\r\n    c = a.length;\r\n    for (e = c; e >= 0; e--) {\r\n        if (a[e] == g) {\r\n            h = e;\r\n            break\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXSlider.prototype._refreshRunner = function(h) {\r\n    var g = (this.conf.vertical == true ? {\r\n        x: \"top\",\r\n        y: \"left\",\r\n        ofs_w: \"offsetHeight\",\r\n        ofs_h: \"offsetWidth\"\r\n    } : {\r\n        x: \"left\",\r\n        y: \"top\",\r\n        ofs_w: \"offsetWidth\",\r\n        ofs_h: \"offsetHeight\"\r\n    });\r\n    var a = this._nodes.cont[g.ofs_w] - this._nodes.runner[g.ofs_w];\r\n    var e = this._nodes.runner;\r\n    var c = this._nodes.runner2;\r\n    if (h == null  || h == 0) {\r\n        var l = this._getCoord(a, (this.conf.value instanceof Array ? this.conf.value[0] : this.conf.value));\r\n        e.style[g.x] = l + this.conf.border + \"px\";\r\n        e.style[g.y] = Math.round((this._nodes.cont[g.ofs_h] - e[g.ofs_h]) / 2) + \"px\"\r\n    }\r\n    if (this.conf.range == true && (h == null  || h == 1)) {\r\n        var l = this._getCoord(a, this.conf.value[1]);\r\n        c.style[g.x] = l + this.conf.border + \"px\";\r\n        c.style[g.y] = Math.round((this._nodes.cont[g.ofs_h] - e[g.ofs_h]) / 2) + \"px\"\r\n    }\r\n    if (this.conf.range == true) {\r\n        if (e.style[g.x] == c.style[g.x] && this.conf.value[1] == this.conf.max) {\r\n            if (e.style.zIndex != 2) {\r\n                e.style.zIndex = 2\r\n            }\r\n        } else {\r\n            if (e.style.zIndex == 2) {\r\n                e.style.zIndex = 1\r\n            }\r\n        }\r\n    }\r\n    e = c = null ;\r\n    this._refreshBG()\r\n}\r\n;\r\ndhtmlXSlider.prototype._setValueByCoord = function(g) {\r\n    var a = dhx4.absLeft(this._nodes.cont), h = dhx4.absTop(this._nodes.cont), e, c;\r\n    if (this.conf.vertical) {\r\n        c = (g.y - h - this._nodes.runner.offsetHeight / 2) / (this._nodes.cont.offsetHeight - this._nodes.runner.offsetHeight)\r\n    } else {\r\n        c = (g.x - a - this._nodes.runner.offsetWidth / 2) / (this._nodes.cont.offsetWidth - this._nodes.runner.offsetWidth)\r\n    }\r\n    e = (this.conf.max - this.conf.min) * c + this.conf.min;\r\n    this.setValue(e, true)\r\n}\r\n;\r\ndhtmlXSlider.prototype._getCoord = function(a, g) {\r\n    var e = (this.conf.inverse ? this._inverseValue(g) : g);\r\n    var c = (e - this.conf.min) / (this.conf.max - this.conf.min);\r\n    return Math.round(a * c)\r\n}\r\n;\r\ndhtmlXSlider.prototype._normalize = function(g, e, a) {\r\n    g = Number(g);\r\n    g = Math.round(g / this.conf.step) * this.conf.step;\r\n    var c = Math.pow(10, this.conf.decimals);\r\n    g = Math.round(g * c) / c;\r\n    g = Math.max(e, Math.min(a, g));\r\n    return g\r\n}\r\n;\r\ndhtmlXSlider.prototype._normalizeRange = function(e, c, a) {\r\n    if (e[1] < e[0]) {\r\n        e[1] = e[0]\r\n    }\r\n    e[0] = this._normalize(e[0], c, Math.min(a, e[1]));\r\n    e[1] = this._normalize(e[1], Math.max(c, e[0]), a);\r\n    return e\r\n}\r\n;\r\ndhtmlXSlider.prototype._refreshBG = function() {\r\n    if (this.conf.bg != true) {\r\n        return\r\n    }\r\n    var g = this._nodes.track.firstChild;\r\n    var e = this._nodes.runner;\r\n    var a = e.nextSibling;\r\n    var c = (this.conf.vertical == true ? {\r\n        x: \"top\",\r\n        w: \"height\",\r\n        ofs: \"offsetHeight\"\r\n    } : {\r\n        x: \"left\",\r\n        w: \"width\",\r\n        ofs: \"offsetWidth\"\r\n    });\r\n    if (this.conf.range == true) {\r\n        g.style[c.x] = Math.floor(parseInt(e.style[c.x]) + e[c.ofs] / 2) + \"px\";\r\n        g.style[c.w] = Math.max(Math.floor(parseInt(a.style[c.x]) + a[c.ofs] / 2) - parseInt(g.style[c.x]), 0) + \"px\"\r\n    } else {\r\n        var h = (this.conf.inverse == true ? {\r\n            left: \"right\",\r\n            right: \"left\"\r\n        }[this.conf.bg_mode] : this.conf.bg_mode);\r\n        g.style[c.x] = (h == \"left\" ? \"0\" : Math.floor(parseInt(e.style[c.x]) + e[c.ofs] / 2)) + \"px\";\r\n        g.style[c.w] = (h == \"left\" ? Math.floor(parseInt(e.style[c.x]) + e[c.ofs] / 2) : this._nodes.track[c.ofs] - parseInt(g.style[c.x])) + \"px\"\r\n    }\r\n    g = e = a = null \r\n}\r\n;\r\ndhtmlXSlider.prototype._attachNode = function(e, a) {\r\n    this._detachNode(a);\r\n    var c = e.tagName.toLowerCase();\r\n    if (!c) {\r\n        return\r\n    }\r\n    this._attachedNode[\"node_\" + a] = e;\r\n    switch (c) {\r\n    case \"input\":\r\n    case \"select\":\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            e.addEventListener(\"change\", this._doOnChangeInput, false);\r\n            e.addEventListener(\"keydown\", this._doOnKeyDown, false)\r\n        } else {\r\n            e.attachEvent(\"onchange\", this._doOnChangeInput);\r\n            e.attachEvent(\"onkeydown\", this._doOnKeyDown)\r\n        }\r\n        this._attachedNode.setValue = function(m, g, l) {\r\n            var h = (m instanceof Array ? m[l || 0] : m);\r\n            this[\"node_\" + (l || 0)].value = dhtmlXSlider.prototype._atatchedNodeFixDec(h, g)\r\n        }\r\n        ;\r\n        break;\r\n    default:\r\n        this._attachedNode.setValue = function(m, g, l) {\r\n            var h = (m instanceof Array ? m[l || 0] : m);\r\n            this[\"node_\" + (l || 0)].innerHTML = dhtmlXSlider.prototype._atatchedNodeFixDec(h, g)\r\n        }\r\n    }\r\n    this._attachedNode.setValue(this.conf.value, this.conf.decimals, a)\r\n}\r\n;\r\ndhtmlXSlider.prototype._detachNode = function(a) {\r\n    var e = this._attachedNode[\"node_\" + a];\r\n    if (!e) {\r\n        return\r\n    }\r\n    var c = e.tagName;\r\n    switch (c) {\r\n    case \"input\":\r\n    case \"select\":\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            e.removeEventListener(\"change\", this._doOnChangeInput, false);\r\n            e.removeEventListener(\"keydown\", this._doOnChangeInput, false)\r\n        } else {\r\n            e.detachEvent(\"change\", this._doOnChangeInput);\r\n            e.detachEvent(\"keydown\", this._doOnChangeInput)\r\n        }\r\n        break\r\n    }\r\n    delete this._attachedNode[\"node_\" + a];\r\n    delete this._attachedNode.setValue;\r\n    e = null \r\n}\r\n;\r\ndhtmlXSlider.prototype._atatchedNodeFixDec = function(g, a) {\r\n    g = String(g);\r\n    if (a > 0) {\r\n        var c = g.match(/\\.\\d{1,}$/);\r\n        if (c != null ) {\r\n            a = Math.max(a - c[0].length + 1)\r\n        }\r\n        g += (g.indexOf(\".\") < 0 ? \".\" : \"\");\r\n        for (var e = 0; e < a; e++) {\r\n            g += \"0\"\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXSlider.prototype._detectDecimals = function() {\r\n    var a = this.conf.step.toString().match(/\\.(\\d*)$/);\r\n    this.conf.decimals = (a != null  ? a[1].length : 0)\r\n}\r\n;\r\ndhtmlXSlider.prototype.setSize = function(a) {\r\n    if (!isNaN(a)) {\r\n        if (this.conf.vertical) {\r\n            if (this._nodes.cont.style.width) {\r\n                delete this._nodes.cont.style.width\r\n            }\r\n            this._nodes.cont.style.height = a - this.conf.margin + \"px\"\r\n        } else {\r\n            if (this._nodes.cont.style.height) {\r\n                delete this._nodes.cont.style.height\r\n            }\r\n            this._nodes.cont.style.width = a - this.conf.margin + \"px\"\r\n        }\r\n        this._refreshRunner()\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.setSkin = function(h) {\r\n    h = h.toLowerCase();\r\n    var e, c = -1, a, g = \"dhtmlxslider\";\r\n    e = this.base.className.match(/\\S\\w+/ig);\r\n    if (e instanceof Array) {\r\n        for (a in this._skinCollection) {\r\n            if (c == -1) {\r\n                c = this._indexOf(e, g + \"_\" + a)\r\n            } else {\r\n                break\r\n            }\r\n        }\r\n        c = (c == -1) ? e.length : c\r\n    } else {\r\n        e = [];\r\n        c = 0\r\n    }\r\n    e[c] = g + \"_\" + h;\r\n    this.base.className = e.join(\" \");\r\n    this.conf.skin = h;\r\n    if (this._nodes) {\r\n        this._refreshRunner()\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.setValue = function(g, h) {\r\n    h = h || false;\r\n    var c = null ;\r\n    var e = false;\r\n    if (this.conf.range == true) {\r\n        if (this._r_actv != null ) {\r\n            c = (this._r_actv == this._nodes.runner ? 0 : 1)\r\n        }\r\n        g = this._normalizeRange(g, this.conf.min, this.conf.max);\r\n        e = (this.conf.value[0] != g[0] || this.conf.value[1] != g[1])\r\n    } else {\r\n        g = this._normalize(g, this.conf.min, this.conf.max);\r\n        e = (this.conf.value != g)\r\n    }\r\n    if (e = true) {\r\n        this.conf.value = g;\r\n        this._refreshRunner(c);\r\n        this._refreshTooltip();\r\n        if (h) {\r\n            var a = [g, this];\r\n            if (this.conf.range == true) {\r\n                if (this._r_actv != null ) {\r\n                    a.push(this._r_actv == this._nodes.runner ? 0 : 1)\r\n                } else {\r\n                    if (this.conf.init_index != null ) {\r\n                        a.push(this.conf.init_index.valueOf())\r\n                    }\r\n                }\r\n            }\r\n            this.callEvent(\"onChange\", a)\r\n        }\r\n    }\r\n    if (typeof (this._attachedNode.setValue) == \"function\") {\r\n        if (c == null ) {\r\n            c = this.conf.init_index\r\n        }\r\n        this._attachedNode.setValue(this.conf.value, this.conf.decimals, c)\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.getValue = function() {\r\n    if (this.conf.range == true) {\r\n        return [this.conf.value[0].valueOf(), this.conf.value[1].valueOf()]\r\n    } else {\r\n        return this.conf.value.valueOf()\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype._inverseValue = function(a) {\r\n    return this.conf.max + this.conf.min - a\r\n}\r\n;\r\ndhtmlXSlider.prototype.disable = function(h) {\r\n    h = (h == false) ? false : true;\r\n    var g = null ;\r\n    if (h) {\r\n        for (var c in this._nodes) {\r\n            if (c == \"cont\") {\r\n                continue\r\n            }\r\n            var e = (c == \"runner2\" ? \"runner\" : c);\r\n            if (this._nodes[c] != null ) {\r\n                g = new RegExp(\"\\\\s?dhxsl_\" + e + \"_dis\",\"i\");\r\n                if (!g.test(this._nodes[c].className)) {\r\n                    this._nodes[c].className += \" dhxsl_\" + e + \"_dis\"\r\n                }\r\n            }\r\n        }\r\n        this.conf.disabled = true\r\n    } else {\r\n        this.enable()\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.enable = function() {\r\n    var g;\r\n    for (var c in this._nodes) {\r\n        if (c == \"cont\") {\r\n            continue\r\n        }\r\n        var e = (c == \"runner2\" ? \"runner\" : c);\r\n        if (this._nodes[c] != null ) {\r\n            g = new RegExp(\"\\\\s?dhxsl_\" + e + \"_dis\",\"i\");\r\n            if (g.test(this._nodes[c].className)) {\r\n                this._nodes[c].className = this._nodes[c].className.replace(g, \"\")\r\n            }\r\n        }\r\n    }\r\n    this.conf.disabled = false\r\n}\r\n;\r\ndhtmlXSlider.prototype.isEnabled = function() {\r\n    return !this.conf.disabled\r\n}\r\n;\r\ndhtmlXSlider.prototype.disableTooltip = function() {\r\n    this._nodes.cont.removeAttribute(\"title\");\r\n    this.conf.tooltip = false\r\n}\r\n;\r\ndhtmlXSlider.prototype.enableTooltip = function(a) {\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    } else {\r\n        a = dhx4.s2b(a)\r\n    }\r\n    if (a) {\r\n        this.conf.tooltip = true;\r\n        this._refreshTooltip()\r\n    } else {\r\n        this.disableTooltip()\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.setMax = function(a) {\r\n    if (!isNaN(a) && this.conf.min < a) {\r\n        this.conf.max = a;\r\n        this.setValue(this.conf.value)\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.getMax = function() {\r\n    return this.conf.max\r\n}\r\n;\r\ndhtmlXSlider.prototype.setMin = function(a) {\r\n    if (!isNaN(a) && this.conf.max > a) {\r\n        this.conf.min = a;\r\n        this.setValue(this.conf.value)\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.getMin = function() {\r\n    return this.conf.min\r\n}\r\n;\r\ndhtmlXSlider.prototype.setStep = function(a) {\r\n    var c = this.conf.max - this.conf.min;\r\n    if (!isNaN(a) && a < c) {\r\n        this.conf.step = a;\r\n        this._detectDecimals();\r\n        this.setValue(this.conf.value)\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.getStep = function() {\r\n    return this.conf.step\r\n}\r\n;\r\ndhtmlXSlider.prototype.show = function() {\r\n    if (/\\s?dhxsl_hidden/i.test(this._nodes.cont.className)) {\r\n        this._nodes.cont.className = this._nodes.cont.className.replace(/\\s?dhxsl_hidden/i, \"\")\r\n    }\r\n    this.conf.visible = true\r\n}\r\n;\r\ndhtmlXSlider.prototype.hide = function() {\r\n    if (!/\\s?dhxsl_hidden/i.test(this._nodes.cont.className)) {\r\n        this._nodes.cont.className += \" dhxsl_hidden\"\r\n    }\r\n    this.conf.visible = false\r\n}\r\n;\r\ndhtmlXSlider.prototype.isVisible = function() {\r\n    return this.conf.visible\r\n}\r\n;\r\ndhtmlXSlider.prototype.linkTo = function(a) {\r\n    if (!(a instanceof Array)) {\r\n        a = [a]\r\n    }\r\n    for (var c = 0; c < a.length && c < 2; c++) {\r\n        if (a[c] != null ) {\r\n            if (typeof (a[c]) == \"string\") {\r\n                a[c] = document.getElementById(a[c])\r\n            }\r\n            this._attachNode(a[c], c)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype._refreshTooltip = function() {\r\n    if (this.conf.tooltip == true) {\r\n        if (this.conf.value instanceof Array) {\r\n            this._nodes.cont.title = this.conf.value.join(\", \")\r\n        } else {\r\n            this._nodes.cont.title = this.conf.value\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSlider.prototype.getRunnerIndex = function() {\r\n    if (this._r_actv == null ) {\r\n        return -1\r\n    }\r\n    return ( this._r_actv == this._nodes.runner ? 0 : 1) \r\n}\r\n;\r\nfunction dhtmlXPopup(e) {\r\n    var g = this;\r\n    this.conf = e || {};\r\n    e = null ;\r\n    this.mode = (this.conf.mode || \"bottom\");\r\n    this.conf.zi = window.dhx4.newId();\r\n    this.conf.context = (this.conf.context == null  ? true : window.dhx4.s2b(this.conf.context));\r\n    this.conf.IE6_display_fix = (this.conf.IE6_display_fix == null  ? false : window.dhx4.s2b(this.conf.IE6_display_fix));\r\n    this.conf.last_p_click = this.conf.last_body_click = null ;\r\n    this.p = document.createElement(\"DIV\");\r\n    this.p.style.display = \"none\";\r\n    this.p.innerHTML = \"<div class='dhx_popup_area\" + (window.dhx4.isIE ? \" dhx_popup_area_ie\" : \"\") + \"'><table cellspacing='0' cellpadding='0' border='0' class='dhx_popup_table'><tbody></tbody></table></div><div class='dhx_popup_arrow dhx_popup_arrow_\" + this.mode + \"'></div>\";\r\n    document.body.appendChild(this.p);\r\n    this.p.oncontextmenu = function(a) {\r\n        if (g.conf.context == false) {\r\n            a = a || event;\r\n            a.returnValue = false;\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.skinParams = {\r\n        dhx_terrace: {\r\n            t0: 19,\r\n            t1: 9,\r\n            t2: 19,\r\n            t3: 9\r\n        },\r\n        dhx_skyblue: {\r\n            t0: 12,\r\n            t1: 9,\r\n            t2: 12,\r\n            t3: 9\r\n        },\r\n        dhx_web: {\r\n            t0: 12,\r\n            t1: 9,\r\n            t2: 12,\r\n            t3: 9\r\n        }\r\n    };\r\n    this.p.ontouchstart = this.p.onclick = function(l) {\r\n        l = l || event;\r\n        var h = (g.conf.last_p_click != null  && g.conf.last_p_click != l.type);\r\n        g.conf.last_p_click = l.type;\r\n        if (h == true) {\r\n            return\r\n        }\r\n        g._clearClick = true;\r\n        if (g._nodeObj != null ) {\r\n            g.callEvent(\"onContentClick\", []);\r\n            return true\r\n        }\r\n        var a = (l.target || l.srcElement);\r\n        var m = null ;\r\n        while (a != g.p && a != null ) {\r\n            if (typeof (a._idd) != \"undefined\" && !a._isSeparator) {\r\n                m = a._idd;\r\n                a = null \r\n            } else {\r\n                a = a.parentNode\r\n            }\r\n        }\r\n        a = null ;\r\n        if (m != null ) {\r\n            g.callEvent(\"onClick\", [m]);\r\n            if (g != null  && g.isVisible != null  && g.isVisible() && g.callEvent(\"onBeforeHide\", [\"select\", l, m]) === true) {\r\n                l.cancelBubble = true;\r\n                g.hide()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.separator = \"DHXSEP_\" + window.dhx4.newId();\r\n    this.tpl = [];\r\n    this._setTemplate = function(a) {\r\n        this.tpl = a.split(\",\")\r\n    }\r\n    ;\r\n    this.show = function(h) {\r\n        var a = null ;\r\n        if (arguments.length == 1) {\r\n            if (!h) {\r\n                h = this.conf.id[0]\r\n            } else {\r\n                if (!this._idExists(h)) {\r\n                    return\r\n                }\r\n            }\r\n            if (this.conf.toolbar) {\r\n                a = this.conf.toolbar._getItemDim(h)\r\n            }\r\n            if (this.conf.ribbon) {\r\n                a = this.conf.ribbon._getItemDim(h)\r\n            }\r\n            if (this.conf.form) {\r\n                a = this.conf.form._getItemDim(h)\r\n            }\r\n        } else {\r\n            if (arguments.length == 4) {\r\n                this._clearClick = true;\r\n                a = {\r\n                    left: arguments[0],\r\n                    top: arguments[1],\r\n                    width: arguments[2],\r\n                    height: arguments[3]\r\n                };\r\n                h = null \r\n            }\r\n        }\r\n        if (!a) {\r\n            return\r\n        }\r\n        this.p.style.visibility = \"hidden\";\r\n        this.p.style.display = \"\";\r\n        this._setPos(a);\r\n        this.p.style.zIndex = window.dhx4.zim.reserve(this.conf.zi);\r\n        this.p.style.visibility = \"visible\";\r\n        this._lastId = h;\r\n        this.callEvent(\"onShow\", [h])\r\n    }\r\n    ;\r\n    this._setPos = function(J, n) {\r\n        var A = J.left;\r\n        var u = J.top;\r\n        var D = J.width;\r\n        var M = J.height;\r\n        this._posData = {\r\n            left: A,\r\n            top: u,\r\n            width: D,\r\n            height: M\r\n        };\r\n        var O = window.dhx4.screenDim();\r\n        var H = n || this.mode;\r\n        if (typeof (n) == \"undefined\") {\r\n            n = false\r\n        }\r\n        var Q = {\r\n            top: (u - this.p.offsetHeight) - O.top,\r\n            bottom: O.bottom - (u + M + this.p.offsetHeight),\r\n            left: A - this.p.offsetWidth - O.left,\r\n            right: O.right - (A + D + this.p.offsetWidth)\r\n        };\r\n        if (!n && Q[H] < 0) {\r\n            var K = this._getAvailPos(H, Q);\r\n            if (K !== false) {\r\n                this._setPos(J, K);\r\n                return\r\n            }\r\n        }\r\n        if (H == \"top\" || H == \"bottom\") {\r\n            var E = this.skinParams[this.conf.skin].t2;\r\n            var C = this.skinParams[this.conf.skin].t3;\r\n            var s = Math.round(this.p.offsetWidth / 2);\r\n            var a = Math.round(this.p.lastChild.offsetWidth / 2);\r\n            if (A < O.left) {\r\n                var N = Math.min(A + D, O.left);\r\n                D = A + D - N;\r\n                A = N\r\n            }\r\n            if (A + D > O.right) {\r\n                D = O.right - A\r\n            }\r\n            var v = Math.round(A + D / 2);\r\n            var m = v - s;\r\n            var L = v - E - a;\r\n            var r = v + a + E - this.p.offsetWidth;\r\n            if (m < O.left - C) {\r\n                m = Math.min(O.left - C, L)\r\n            } else {\r\n                if (m + this.p.offsetWidth > O.right + C) {\r\n                    m = Math.max(r, O.right + C - this.p.offsetWidth)\r\n                }\r\n            }\r\n            this.p.style.left = m + \"px\";\r\n            this.p.style.top = (H == \"top\" ? u - this.p.offsetHeight : u + M) + \"px\";\r\n            v = v - m - a;\r\n            this.p.lastChild.className = \"dhx_popup_arrow dhx_popup_arrow_\" + H;\r\n            this.p.lastChild.style.top = (H == \"top\" ? this.p.offsetHeight - this.p.lastChild.offsetHeight : 0) + \"px\";\r\n            this.p.lastChild.style.left = v + \"px\"\r\n        }\r\n        if (H == \"left\" || H == \"right\") {\r\n            var E = this.skinParams[this.conf.skin].t0;\r\n            var C = this.skinParams[this.conf.skin].t1;\r\n            var o = Math.round(this.p.offsetHeight / 2);\r\n            var T = Math.round(this.p.lastChild.offsetHeight / 2);\r\n            if (u < O.top) {\r\n                var l = Math.min(u + M, O.top);\r\n                M = u + M - l;\r\n                u = l\r\n            }\r\n            if (u + M > O.bottom) {\r\n                M = O.bottom - u\r\n            }\r\n            var v = Math.round(u + M / 2);\r\n            var I = v - o;\r\n            var S = v - E - T;\r\n            var P = v + T + E - this.p.offsetHeight;\r\n            if (I < O.top - C) {\r\n                I = Math.min(O.top - C, S)\r\n            } else {\r\n                if (I + this.p.offsetHeight > O.bottom + C) {\r\n                    I = Math.max(P, O.bottom + C - this.p.offsetHeight)\r\n                }\r\n            }\r\n            this.p.style.left = (H == \"left\" ? A - this.p.offsetWidth : A + D) + \"px\";\r\n            this.p.style.top = I + \"px\";\r\n            v = v - I - T;\r\n            this.p.lastChild.className = \"dhx_popup_arrow dhx_popup_arrow_\" + H;\r\n            this.p.lastChild.style.left = (H == \"left\" ? this.p.offsetWidth - this.p.lastChild.offsetWidth : 0) + \"px\";\r\n            this.p.lastChild.style.top = v + \"px\"\r\n        }\r\n        if (this._IEDisp && this._nodeId != null ) {\r\n            var F = document.getElementById(this._nodeId);\r\n            if (this.conf.IE6_display_fix == true) {\r\n                F.style.visibility = \"hidden\"\r\n            }\r\n            window.setTimeout(function() {\r\n                F.style.visibility = \"visible\";\r\n                F = null \r\n            }, 1)\r\n        }\r\n    }\r\n    ;\r\n    this._getAvailPos = function(r, o) {\r\n        var l = {\r\n            top: [\"bottom\", \"right\", \"left\"],\r\n            bottom: [\"top\", \"right\", \"left\"],\r\n            left: [\"right\", \"bottom\", \"top\"],\r\n            right: [\"left\", \"bottom\", \"top\"]\r\n        };\r\n        var m = null ;\r\n        for (var n = 0; n < l[r].length; n++) {\r\n            if (m == null  && o[l[r][n]] > 0) {\r\n                m = l[r][n]\r\n            }\r\n        }\r\n        if (m == null ) {\r\n            m = \"bottom\";\r\n            for (var h in o) {\r\n                if (o[h] > o[m]) {\r\n                    m = h\r\n                }\r\n            }\r\n        }\r\n        if (m == r) {\r\n            return false\r\n        }\r\n        return m\r\n    }\r\n    ;\r\n    this._repaint = function() {\r\n        if (this.isVisible()) {\r\n            this._setPos(this._posData)\r\n        }\r\n    }\r\n    ;\r\n    this.clear = function() {\r\n        if (this._nodeObj) {\r\n            if (window.dhx4.isIE && typeof (window.dhtmlXLayoutObject) == \"function\" && this._nodeObj instanceof window.dhtmlXLayoutObject) {\r\n                this.p.onmousedown = null \r\n            }\r\n            if (this._nodeObj.unload) {\r\n                this._nodeObj.unload()\r\n            } else {\r\n                if (this._nodeObj.destruct) {\r\n                    this._nodeObj.destruct()\r\n                }\r\n            }\r\n            this._nodeObj = this._nodeId = null ;\r\n            if (this._nodeObjEv != null ) {\r\n                for (var h = 0; h < this._nodeObjEv.length; h++) {\r\n                    this.detachEvent(this._nodeObjEv[h])\r\n                }\r\n                this._nodeObjEv = null \r\n            }\r\n        }\r\n        if (this._IEHoverInited) {\r\n            this._IEHoverClear()\r\n        }\r\n        var a = this.p.firstChild.firstChild.firstChild;\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.lastChild)\r\n        }\r\n        a = null ;\r\n        this.itemData = {}\r\n    }\r\n    ;\r\n    this.hide = function() {\r\n        if (this.p.style.display != \"none\") {\r\n            this.p.style.display = \"none\";\r\n            window.dhx4.zim.clear(this.conf.zi);\r\n            var a = this._lastId;\r\n            this._lastId = null ;\r\n            this.callEvent(\"onHide\", [a]);\r\n            this.conf.last_p_click = this.conf.last_body_click = null \r\n        }\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.p.style.display == \"\") \r\n    }\r\n    ;\r\n    this.itemData = {};\r\n    this.getItemData = function(a) {\r\n        if (!a) {\r\n            return this.itemData\r\n        }\r\n        if (this.itemData[a]) {\r\n            return this.itemData[a]\r\n        }\r\n        return {}\r\n    }\r\n    ;\r\n    this.setSkin = function(a) {\r\n        this.conf.skin = a;\r\n        this.p.className = \"dhx_popup_\" + this.conf.skin;\r\n        if (this._nodeObj != null  && typeof (this._nodeObj.setSkin) == \"function\") {\r\n            this._nodeObj.setSkin(this.conf.skin)\r\n        }\r\n        this._repaint()\r\n    }\r\n    ;\r\n    this.attachList = function(l, s) {\r\n        this._setTemplate(l);\r\n        this.clear();\r\n        var m = this.p.firstChild.firstChild.firstChild;\r\n        for (var o = 0; o < s.length; o++) {\r\n            var n = document.createElement(\"TR\");\r\n            if (s[o] != this.separator) {\r\n                if (typeof (s[o].id) == \"undefined\" || s[o].id == null ) {\r\n                    n._idd = window.dhx4.newId();\r\n                    while (this.itemData[n._idd] != null ) {\r\n                        n._idd = window.dhx4.newId()\r\n                    }\r\n                } else {\r\n                    n._idd = s[o].id\r\n                }\r\n                this.itemData[n._idd] = s[o]\r\n            }\r\n            m.appendChild(n);\r\n            if (s[o] == this.separator) {\r\n                n.className = \"dhx_popup_sep\";\r\n                n._isSeparator = true;\r\n                var u = document.createElement(\"TD\");\r\n                u.className = \"dhx_popup_sep\";\r\n                u.colSpan = this.tpl.length;\r\n                u.innerHTML = \"<div class='dhx_popup_sep'>&nbsp;</div>\";\r\n                n.appendChild(u);\r\n                u = null \r\n            } else {\r\n                for (var a = 0; a < this.tpl.length; a++) {\r\n                    var h = \"dhx_popup_td\";\r\n                    if (this._IEFirstLast && (this.tpl.length == 1 || a == 0 || a == this.tpl.length - 1)) {\r\n                        if (this.tpl.length == 1) {\r\n                            h += \" dhx_popup_td_single\"\r\n                        } else {\r\n                            h += (a == 0 ? \" dhx_popup_td_first\" : \" dhx_popup_td_last\")\r\n                        }\r\n                    }\r\n                    var u = document.createElement(\"TD\");\r\n                    u.className = h;\r\n                    u.innerHTML = s[o][this.tpl[a]] || \"&nbsp;\";\r\n                    n.appendChild(u);\r\n                    u = null \r\n                }\r\n                if (this._IEHover) {\r\n                    n._IEHover = true;\r\n                    if (!this._IEHoverInited) {\r\n                        this._IEHoverInit()\r\n                    }\r\n                }\r\n            }\r\n            n = null \r\n        }\r\n        m = null ;\r\n        this._repaint()\r\n    }\r\n    ;\r\n    this._attachNode = function(m, l) {\r\n        this.clear();\r\n        this._nodeId = \"dhxpopup_node_\" + window.dhx4.newId();\r\n        var a = this.p.firstChild.firstChild.firstChild;\r\n        var h = document.createElement(\"TR\");\r\n        h.className = \"dhxnode\";\r\n        a.appendChild(h);\r\n        var n = document.createElement(\"TD\");\r\n        n.className = \"dhx_popup_td\";\r\n        n.innerHTML = \"<div id='\" + this._nodeId + \"' style='position:relative;'></div>\";\r\n        if (l.width) {\r\n            n.firstChild.style.width = l.width + \"px\"\r\n        }\r\n        if (l.height) {\r\n            n.firstChild.style.height = l.height + \"px\"\r\n        }\r\n        h.appendChild(n);\r\n        n = h = a = null ;\r\n        if (typeof (this[\"_attach_init_\" + m]) == \"function\") {\r\n            this[\"_attach_init_\" + m](l);\r\n            this._enableIEVFix()\r\n        }\r\n        this._repaint();\r\n        return this._nodeObj\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"touchstart\", this._doOnClick, false);\r\n            window.removeEventListener(\"click\", this._doOnClick, false);\r\n            window.removeEventListener(\"keyup\", this._doOnKeyUp, false);\r\n            window.removeEventListener(\"unload\", this._doOnUnload, false)\r\n        } else {\r\n            document.body.detachEvent(\"onclick\", this._doOnClick, false);\r\n            document.body.detachEvent(\"onkeyup\", this._doOnKeyUp, false);\r\n            document.body.detachEvent(\"onunload\", this._doOnUnload, false)\r\n        }\r\n        window.dhx4.detachEvent(this.conf.ev_grid_click);\r\n        this.clear();\r\n        if (this.conf.toolbarEvent != null  && this.conf.toolbar != null ) {\r\n            if (this.conf.toolbar.detachEvent != null ) {\r\n                this.conf.toolbar.detachEvent(this.conf.toolbarEvent)\r\n            } else {\r\n                this.conf.toolbar._getItemDim = null \r\n            }\r\n        }\r\n        if (this.conf.ribbonEvent != null  && this.conf.ribbon != null ) {\r\n            if (this.conf.ribbon.detachEvent != null ) {\r\n                this.conf.ribbon.detachEvent(this.conf.ribbonEvent)\r\n            } else {\r\n                this.conf.ribbon._getItemDim = null \r\n            }\r\n        }\r\n        if (this.conf.slider != null ) {\r\n            for (var l = 0; l < this.conf.slider_events.length; l++) {\r\n                this.conf.slider.detachEvent(this.conf.slider_events[l])\r\n            }\r\n            this.conf.slider_events = null ;\r\n            this._sliderShow = this._sliderHide = null ;\r\n            this.conf.slider = null \r\n        }\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.p.onclick = this.p.ontouchstart = this.p.oncontextmenu = null ;\r\n        this.p.parentNode.removeChild(this.p);\r\n        this.p = null ;\r\n        for (var h in this.conf) {\r\n            this.conf[h] = null \r\n        }\r\n        for (var h in this) {\r\n            this[h] = null \r\n        }\r\n        g = null \r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    this._doOnClick = function(s) {\r\n        s = s || event;\r\n        var a = (g.conf.last_body_click != null  && g.conf.last_body_click != s.type);\r\n        g.conf.last_body_click = s.type;\r\n        if (a == true) {\r\n            return\r\n        }\r\n        if (g._clearClick == true) {\r\n            g._clearClick = false;\r\n            return\r\n        }\r\n        if (g.conf.form != null ) {\r\n            var l;\r\n            var u = (s.target || s.srcElement);\r\n            if ((u.tagName || \"\").toLowerCase() == \"option\") {\r\n                u = u.parentNode\r\n            }\r\n            if (u.className != null  && u.className.search(\"dhxform\") >= 0) {\r\n                if (u.parentNode != null  && u.parentNode.parentNode != null  && u.parentNode.parentNode._idd != null ) {\r\n                    l = u.parentNode.parentNode._idd;\r\n                    if (u.parentNode.parentNode._type == \"ra\") {\r\n                        l = [u.parentNode.parentNode._group, u.parentNode.parentNode._value]\r\n                    }\r\n                }\r\n            } else {\r\n                var n = true;\r\n                var o = false;\r\n                while (n && !o) {\r\n                    var m = (u.className || \"\").toLowerCase();\r\n                    if (m.length > 0) {\r\n                        o = (m == \"dhxform_btn\" || m.search(/dhxeditor_inside/gi) >= 0 || m == \"dhxcombo_input\" || m.search(/dhxcombolist/gi) >= 0)\r\n                    }\r\n                    u = u.parentNode;\r\n                    n = (u != null )\r\n                }\r\n                if (o) {\r\n                    return\r\n                }\r\n            }\r\n            u = null ;\r\n            if (l != null  && g._idExists(l)) {\r\n                return\r\n            }\r\n        }\r\n        if (typeof (window.dhtmlXForm) == \"function\" && g._nodeObj instanceof window.dhtmlXForm) {\r\n            var v = {};\r\n            var m = 0;\r\n            var h = g._nodeObj;\r\n            h.forEachItem(function(r) {\r\n                if (h.getItemType(r) == \"combo\") {\r\n                    v[h.getCombo(r).list._listId] = true;\r\n                    m++\r\n                }\r\n            });\r\n            h = null ;\r\n            if (m > 0) {\r\n                var u = (s.target || s.srcElement);\r\n                var n = true;\r\n                var o = false;\r\n                while (n == true && o != true) {\r\n                    var m = (u.className || \"\").toLowerCase();\r\n                    if (m.length > 0 && m.search(/^dhxcombolist/gi) >= 0 && u._listId != null  && v[u._listId] == true) {\r\n                        o = true;\r\n                        u = null \r\n                    } else {\r\n                        u = u.parentNode;\r\n                        n = (u != null )\r\n                    }\r\n                }\r\n                if (o == true) {\r\n                    return\r\n                }\r\n            }\r\n        }\r\n        if (g.isVisible() && g.callEvent(\"onBeforeHide\", [\"click\", s]) === true) {\r\n            g.hide()\r\n        }\r\n    }\r\n    ;\r\n    this._doOnKeyUp = function(a) {\r\n        a = a || event;\r\n        if (a.keyCode == 27) {\r\n            if (g.isVisible() && g.callEvent(\"onBeforeHide\", [\"esc\", a]) === true) {\r\n                g.hide()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._doOnUnload = function() {\r\n        g.unload()\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        window.addEventListener(\"touchstart\", this._doOnClick, false);\r\n        window.addEventListener(\"click\", this._doOnClick, false);\r\n        window.addEventListener(\"keyup\", this._doOnKeyUp, false);\r\n        window.addEventListener(\"unload\", this._doOnUnload, false)\r\n    } else {\r\n        document.body.attachEvent(\"onclick\", this._doOnClick, false);\r\n        document.body.attachEvent(\"onkeyup\", this._doOnKeyUp, false);\r\n        document.body.attachEvent(\"onunload\", this._doOnUnload, false)\r\n    }\r\n    this.conf.ev_grid_click = window.dhx4.attachEvent(\"_onGridClick\", function(h, a) {\r\n        if (g._nodeObj != null  && (g._nodeObj == a || g._findGrid(g._nodeObj, a) == true)) {} else {\r\n            g._clearClick = false;\r\n            g._doOnClick(h)\r\n        }\r\n        a = null \r\n    });\r\n    this._findGrid = function(h, a) {\r\n        var l = false;\r\n        if (typeof (window.dhtmlXTabBar) == \"function\" && h instanceof window.dhtmlXTabBar) {\r\n            h.forEachTab(function(m) {\r\n                var n = m.getAttachedObject();\r\n                if (l == false && n != null ) {\r\n                    l = l || (n == a) || this._findGrid(n);\r\n                    n = null \r\n                }\r\n            })\r\n        }\r\n        return l\r\n    }\r\n    ;\r\n    this._idExists = function(l) {\r\n        var a = false;\r\n        for (var h = 0; h < this.conf.id.length; h++) {\r\n            if (this.conf.id[h] instanceof Array) {\r\n                a = a || (this.conf.id[h][0] == l[0] && this.conf.id[h][1] == l[1])\r\n            } else {\r\n                a = a || this.conf.id[h] == l\r\n            }\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this._IEDisp = (window.dhx4.isIE6 || document.compatMode != \"CSS1Compat\");\r\n    this._IEHover = (window.dhx4.isIE6 == true);\r\n    if (this._IEHover) {\r\n        this._IEHoverInit = function() {\r\n            this.p.onmouseover = function() {\r\n                var a = event.srcElement;\r\n                while (a != this && a._IEHover != true) {\r\n                    a = a.parentNode\r\n                }\r\n                if (a._IEHover) {\r\n                    if (g._IEHoverTM) {\r\n                        window.clearTimeout(g._IEHoverTM)\r\n                    }\r\n                    if (g._lastIEHover == a) {\r\n                        return\r\n                    }\r\n                    g._IEHoverRender(a);\r\n                    a = null \r\n                }\r\n            }\r\n            ;\r\n            this.p.onmouseout = function() {\r\n                if (g._IEHoverTM) {\r\n                    window.clearTimeout(g._IEHoverTM)\r\n                }\r\n                g._IEHoverTM = window.setTimeout(function() {\r\n                    g._IEHoverRender(null )\r\n                }, 1)\r\n            }\r\n            ;\r\n            this._IEHoverRender = function(a) {\r\n                if (this._lastIEHover != null ) {\r\n                    if (this._lastIEHover.className.search(/tr_hover/gi) >= 0) {\r\n                        this._lastIEHover.className = this._lastIEHover.className.replace(/\\s{0,}tr_hover/gi, \"\");\r\n                        this._lastIEHover = null \r\n                    }\r\n                }\r\n                if (a != null  && a.className.search(/tr_hover/gi) < 0) {\r\n                    a.className += \" tr_hover\";\r\n                    g._lastIEHover = a\r\n                }\r\n            }\r\n            ;\r\n            this._IEHoverInited = true\r\n        }\r\n        ;\r\n        this._IEHoverClear = function() {\r\n            this.p.onmouseover = null ;\r\n            this.p.onmouseout = null ;\r\n            this._IEHoverInited = false\r\n        }\r\n    }\r\n    this._IEFirstLast = (window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8);\r\n    this._enableIEVFix = function() {\r\n        if (window.dhx4.isIE6 || window.dhx4.isIE7) {\r\n            var h = this.attachEvent(\"onHide\", function() {\r\n                document.getElementById(this._nodeId).style.visibility = \"hidden\"\r\n            });\r\n            var a = this.attachEvent(\"onShow\", function() {\r\n                document.getElementById(this._nodeId).style.visibility = \"visible\"\r\n            });\r\n            if (this._nodeObjEv == null ) {\r\n                this._nodeObjEv = []\r\n            }\r\n            this._nodeObjEv.push(h, a)\r\n        }\r\n    }\r\n    ;\r\n    if (typeof (window.dhtmlXToolbarObject) == \"function\" && this.conf.toolbar != null  && this.conf.toolbar instanceof window.dhtmlXToolbarObject && this.conf.id != null ) {\r\n        if (!(this.conf.id instanceof Array)) {\r\n            this.conf.id = [this.conf.id]\r\n        }\r\n        this.skinParent = this.conf.toolbar.conf.skin;\r\n        this._doOnToolbarClick = function(h) {\r\n            for (var a = 0; a < g.conf.id.length; a++) {\r\n                if (h == g.conf.id[a]) {\r\n                    if (h != g._lastId) {\r\n                        g.show(h);\r\n                        g._clearClick = true\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        if (typeof (dhtmlXToolbarObject.prototype._getItemDim) == \"undefined\") {\r\n            dhtmlXToolbarObject.prototype._getItemDim = function(l) {\r\n                var a = this.objPull[this.idPrefix + l];\r\n                var h = {\r\n                    left: window.dhx4.absLeft(a.obj),\r\n                    top: window.dhx4.absTop(a.obj),\r\n                    width: a.obj.offsetWidth + (a.arw ? a.arw.offsetWidth : 0),\r\n                    height: a.obj.offsetHeight\r\n                };\r\n                a = null ;\r\n                return h\r\n            }\r\n        }\r\n        this.conf.toolbarEvent = this.conf.toolbar.attachEvent(\"onClick\", this._doOnToolbarClick)\r\n    }\r\n    if (typeof (window.dhtmlXRibbon) == \"function\" && this.conf.ribbon != null  && this.conf.ribbon instanceof window.dhtmlXRibbon && this.conf.id != null ) {\r\n        if (!(this.conf.id instanceof Array)) {\r\n            this.conf.id = [this.conf.id]\r\n        }\r\n        this.skinParent = this.conf.ribbon.conf.skin;\r\n        this._doOnRibbonClick = function(h) {\r\n            for (var a = 0; a < g.conf.id.length; a++) {\r\n                if (h == g.conf.id[a]) {\r\n                    if (h != g._lastId) {\r\n                        g.show(h);\r\n                        g._clearClick = true\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        if (typeof (dhtmlXRibbon.prototype._getItemDim) == \"undefined\") {\r\n            dhtmlXRibbon.prototype._getItemDim = function(l) {\r\n                var a = this._items[l].base;\r\n                var h = {\r\n                    left: window.dhx4.absLeft(a),\r\n                    top: window.dhx4.absTop(a),\r\n                    width: a.offsetWidth,\r\n                    height: a.offsetHeight\r\n                };\r\n                a = null ;\r\n                return h\r\n            }\r\n        }\r\n        this.conf.ribbonEvent = this.conf.ribbon.attachEvent(\"_showPopup\", this._doOnRibbonClick)\r\n    }\r\n    if (typeof (window.dhtmlXForm) == \"function\" && this.conf.form != null  && this.conf.form instanceof window.dhtmlXForm && this.conf.id != null ) {\r\n        if (!(this.conf.id instanceof Array)) {\r\n            this.conf.id = [this.conf.id]\r\n        }\r\n        if (!this.conf.mode) {\r\n            this.mode = \"right\"\r\n        }\r\n        this.skinParent = this.conf.form.skin;\r\n        if (typeof (dhtmlXForm.prototype._getItemDim) == \"undefined\") {\r\n            dhtmlXForm.prototype._getItemDim = function(a, h) {\r\n                return this.doWithItem(a, \"_getDim\")\r\n            }\r\n            ;\r\n            for (var c in {\r\n                input: 1,\r\n                password: 1,\r\n                select: 1,\r\n                multiselect: 1,\r\n                checkbox: 1,\r\n                radio: 1,\r\n                button: 1,\r\n                combo: 1,\r\n                btn2state: 1,\r\n                calendar: 1,\r\n                colorpicker: 1,\r\n                editor: 1\r\n            }) {\r\n                if (dhtmlXForm.prototype.items[c] != null ) {\r\n                    dhtmlXForm.prototype.items[c]._getDim = function(h) {\r\n                        var a = h;\r\n                        if ({\r\n                            ta: true,\r\n                            pw: true,\r\n                            se: true,\r\n                            calendar: true,\r\n                            colorpicker: 1,\r\n                            editor: true\r\n                        }[h._type]) {\r\n                            a = h.childNodes[h._ll ? 1 : 0].childNodes[0]\r\n                        }\r\n                        if ({\r\n                            ch: true,\r\n                            ra: true,\r\n                            btn2state: true\r\n                        }[h._type]) {\r\n                            a = h.childNodes[h._ll ? 1 : 0].childNodes[1]\r\n                        }\r\n                        if ({\r\n                            bt: true\r\n                        }[h._type]) {\r\n                            a = h.firstChild\r\n                        }\r\n                        if ({\r\n                            combo: true\r\n                        }[h._type]) {\r\n                            a = h._combo.DOMParent.firstChild\r\n                        }\r\n                        var l = {\r\n                            left: window.dhx4.absLeft(a),\r\n                            top: window.dhx4.absTop(a),\r\n                            width: a.offsetWidth,\r\n                            height: a.offsetHeight\r\n                        };\r\n                        a = null ;\r\n                        return l\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXSlider) == \"function\" && this.conf.slider != null  && this.conf.slider instanceof window.dhtmlXSlider) {\r\n        if (!this.conf.mode) {\r\n            this.mode = \"top\"\r\n        }\r\n        this.conf.slider_tm = null ;\r\n        this._sliderShow = function() {\r\n            if (g.conf.slider_tm) {\r\n                window.clearTimeout(g.conf.slider_tm)\r\n            }\r\n            var a = g.conf.slider._r_actv;\r\n            if (a != null ) {\r\n                var h = {\r\n                    left: window.dhx4.absLeft(a),\r\n                    top: window.dhx4.absTop(a),\r\n                    width: a.offsetWidth,\r\n                    height: a.offsetHeight\r\n                };\r\n                g.show(h.left, h.top, h.width, h.height);\r\n                a = null \r\n            }\r\n        }\r\n        ;\r\n        this._sliderHide = function() {\r\n            g.conf.slider_tm = window.setTimeout(function() {\r\n                g.hide()\r\n            }, 200)\r\n        }\r\n        ;\r\n        this.conf.slider_events = [this.conf.slider.attachEvent(\"onMouseDown\", this._sliderShow), this.conf.slider.attachEvent(\"onMouseUp\", this._sliderHide), this.conf.slider.attachEvent(\"onChange\", this._sliderShow)]\r\n    }\r\n    this.setSkin(this.skinParent || this.conf.skin || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhx_popup\") || \"dhx_skyblue\");\r\n    return this\r\n}\r\ndhtmlXPopup.prototype.attachObject = function(a) {\r\n    return this._attachNode(\"object\", {\r\n        obj: a\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_object = function(a) {\r\n    this._nodeObj = (typeof (a.obj) == \"string\" ? document.getElementById(a.obj) : a.obj);\r\n    a.obj = null ;\r\n    document.getElementById(this._nodeId).appendChild(this._nodeObj);\r\n    this._nodeObj.style.display = \"\";\r\n    this._nodeObj.style.visibility = \"visible\"\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachHTML = function(a) {\r\n    return this._attachNode(\"html\", {\r\n        html: a\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_html = function(a) {\r\n    document.getElementById(this._nodeId).innerHTML = a.html;\r\n    this._nodeObj = {\r\n        text: a.html\r\n    }\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachForm = function(c, a) {\r\n    return this._attachNode(\"form\", {\r\n        struct: c,\r\n        width: a\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_form = function(c) {\r\n    var a = this;\r\n    this._nodeObj = new dhtmlXForm(this._nodeId,c.struct);\r\n    this._nodeObj.setSkin(this.conf.skin);\r\n    this._nodeObj.attachEvent(\"_onBeforeEditorAccess\", function() {\r\n        a._clearClick = true\r\n    });\r\n    if (this.conf.editorEv != null  && this.checkEvent(this.conf.editorEv) == false) {\r\n        this.conf.editorEv = null \r\n    }\r\n    if (dhtmlXForm.prototype.items.editor != null  && this.conf.editorEv == null ) {\r\n        this.conf.editorEv = this.attachEvent(\"onShow\", function() {\r\n            var h = dhtmlXForm.prototype.items.editor.editor;\r\n            for (var e in h) {\r\n                var l = h[e].base;\r\n                var g = false;\r\n                while (l != null ) {\r\n                    if (l == this.p) {\r\n                        g = true;\r\n                        l = null \r\n                    } else {\r\n                        l = l.parentNode\r\n                    }\r\n                }\r\n                l = null ;\r\n                if (g == true) {\r\n                    h[e].cell.conf.cells_cont = null ;\r\n                    h[e].setSizes()\r\n                }\r\n            }\r\n            h = null ;\r\n            this.detachEvent(this.conf.editorEv);\r\n            this.conf.editorEv = null \r\n        });\r\n        if (this._nodeObjEv == null ) {\r\n            this._nodeObjEv = []\r\n        }\r\n        this._nodeObjEv.push(this.conf.editorEv)\r\n    }\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachCalendar = function(a) {\r\n    return this._attachNode(\"calendar\", a || {})\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_calendar = function(a) {\r\n    if (a[\"double\"] == true) {\r\n        this._nodeObj = new dhtmlXDoubleCalendarObject(this._nodeId);\r\n        this._nodeObj.leftCalendar.setSkin(this.conf.skin);\r\n        this._nodeObj.rightCalendar.setSkin(this.conf.skin)\r\n    } else {\r\n        this._nodeObj = new dhtmlXCalendarObject(this._nodeId);\r\n        this._nodeObj.setSkin(this.conf.skin)\r\n    }\r\n    this._nodeObj.show()\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachGrid = function(c, a) {\r\n    return this._attachNode(\"grid\", {\r\n        width: c || 400,\r\n        height: a || 200\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_grid = function() {\r\n    this._nodeObj = new dhtmlXGridObject(this._nodeId);\r\n    this._nodeObj.setSkin(this.conf.skin)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachTree = function(e, c, a) {\r\n    return this._attachNode(\"tree\", {\r\n        width: e || 400,\r\n        height: c || 200,\r\n        rootId: a || 0\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_tree = function(a) {\r\n    this._nodeObj = new dhtmlXTreeObject(this._nodeId,\"100%\",\"100%\",(a.rootId))\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachLayout = function(c, a, e) {\r\n    return this._attachNode(\"layout\", {\r\n        width: c || 400,\r\n        height: a || 200,\r\n        pattern: e || \"3L\"\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_layout = function(a) {\r\n    this._nodeObj = new dhtmlXLayoutObject(this._nodeId,a.pattern,this.conf.skin)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachAccordion = function(e, a, c) {\r\n    return this._attachNode(\"accordion\", {\r\n        width: e || 400,\r\n        height: a || 200,\r\n        conf: c || {}\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_accordion = function(a) {\r\n    a.conf.parent = this._nodeId;\r\n    a.conf.skin = this.conf.skin;\r\n    this._nodeObj = new dhtmlXAccordion(a.conf)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachTabbar = function(e, a, c) {\r\n    if (typeof (c) == \"string\") {\r\n        c = {\r\n            mode: c\r\n        }\r\n    } else {\r\n        if (typeof (c) != \"object\" || c == null ) {\r\n            c = {}\r\n        }\r\n    }\r\n    return this._attachNode(\"tabbar\", {\r\n        width: e || 400,\r\n        height: a || 200,\r\n        conf: c\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_tabbar = function(a) {\r\n    a.conf.parent = this._nodeId;\r\n    a.conf.skin = this.conf.skin;\r\n    this._nodeObj = new dhtmlXTabBar(a.conf)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachSidebar = function(e, a, c) {\r\n    if (c == null ) {\r\n        c = {}\r\n    }\r\n    return this._attachNode(\"sidebar\", {\r\n        width: e || 400,\r\n        height: a || 200,\r\n        conf: c\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_sidebar = function(a) {\r\n    a.conf.parent = this._nodeId;\r\n    a.conf.skin = this.conf.skin;\r\n    this._nodeObj = new dhtmlXSideBar(a.conf)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachEditor = function(e, a, c) {\r\n    return this._attachNode(\"editor\", {\r\n        width: e || 400,\r\n        height: a || 200,\r\n        conf: c || {}\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_editor = function(c) {\r\n    document.getElementById(this._nodeId).className = \"dhxeditor_\" + this.conf.skin;\r\n    c.conf.parent = this._nodeId;\r\n    if (c.conf.skin == null ) {\r\n        c.conf.skin = this.conf.skin\r\n    }\r\n    this._nodeObj = new dhtmlXEditor(c.conf);\r\n    var a = this.attachEvent(\"onShow\", function() {\r\n        if (this._nodeObj instanceof window.dhtmlXEditor) {\r\n            this._nodeObj.setSizes()\r\n        }\r\n    });\r\n    if (this._nodeObjEv == null ) {\r\n        this._nodeObjEv = []\r\n    }\r\n    this._nodeObjEv.push(a)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachColorPicker = function(a) {\r\n    if (typeof (a) != \"object\" || a == null ) {\r\n        a = {}\r\n    }\r\n    return this._attachNode(\"colorpicker\", {\r\n        conf: a\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_colorpicker = function(a) {\r\n    a.conf.skin = this.conf.skin;\r\n    a.conf.parent = this._nodeId;\r\n    this._nodeObj = new dhtmlXColorPicker(a.conf)\r\n}\r\n;\r\ndhtmlXPopup.prototype.attachCarousel = function(e, a, c) {\r\n    if (c == null ) {\r\n        c = {}\r\n    }\r\n    return this._attachNode(\"carousel\", {\r\n        width: e || 400,\r\n        height: a || 300,\r\n        conf: c\r\n    })\r\n}\r\n;\r\ndhtmlXPopup.prototype._attach_init_carousel = function(a) {\r\n    a.conf.parent = this._nodeId;\r\n    a.conf.skin = this.conf.skin;\r\n    this._nodeObj = new dhtmlXCarousel(a.conf)\r\n}\r\n;\r\nfunction dhtmlXMenuObject(h, l) {\r\n    var g = this;\r\n    this.conf = {\r\n        skin: (l || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxmenu\") || \"dhx_skyblue\"),\r\n        mode: \"web\",\r\n        align: \"left\",\r\n        is_touched: false,\r\n        selected: -1,\r\n        last_click: -1,\r\n        fixed_pos: false,\r\n        rtl: false,\r\n        icons_path: \"\",\r\n        arrow_ff_fix: (navigator.userAgent.indexOf(\"MSIE\") >= 0 && document.compatMode == \"BackCompat\"),\r\n        live_id: window.dhx4.newId(),\r\n        tags: {\r\n            root: \"menu\",\r\n            item: \"item\",\r\n            text_ext: \"itemtext\",\r\n            userdata: \"userdata\",\r\n            tooltip: \"tooltip\",\r\n            hotkey: \"hotkey\",\r\n            href: \"href\"\r\n        },\r\n        autoload: {},\r\n        hide_tm: {},\r\n        top_mode: true,\r\n        top_tmtime: 200,\r\n        v_enabled: false,\r\n        v: {\r\n            x1: null ,\r\n            x2: null ,\r\n            y1: null ,\r\n            y2: null \r\n        },\r\n        dir_toplv: \"bottom\",\r\n        dir_sublv: \"right\",\r\n        auto_overflow: false,\r\n        overflow_limit: 0,\r\n        of_utm: null ,\r\n        of_utime: 20,\r\n        of_ustep: 3,\r\n        of_dtm: null ,\r\n        of_dtime: 20,\r\n        of_dstep: 3,\r\n        of_ah: {\r\n            dhx_skyblue: 24,\r\n            dhx_web: 25,\r\n            dhx_terrace: 27\r\n        },\r\n        of_ih: {\r\n            dhx_skyblue: 24,\r\n            dhx_web: 24,\r\n            dhx_terrace: 24\r\n        },\r\n        tm_sec: 400,\r\n        tm_handler: null ,\r\n        dload: false,\r\n        dload_url: \"\",\r\n        dload_icon: false,\r\n        dload_params: {\r\n            action: \"loadMenu\"\r\n        },\r\n        dload_pid: \"parentId\",\r\n        tl_botmarg: 1,\r\n        tl_rmarg: 0,\r\n        tl_ofsleft: 1,\r\n        context: false,\r\n        ctx_zoneid: false,\r\n        ctx_autoshow: true,\r\n        ctx_autohide: true,\r\n        ctx_hideall: true,\r\n        ctx_zones: {},\r\n        ctx_baseid: null ,\r\n        selected_sub: [],\r\n        opened_poly: []\r\n    };\r\n    if (typeof (h) == \"object\" && h != null  && typeof (h.tagName) == \"undefined\") {\r\n        if (h.icons_path != null  || h.icon_path != null ) {\r\n            this.conf.icons_path = (h.icons_path || h.icon_path)\r\n        }\r\n        if (h.skin != null ) {\r\n            this.conf.skin = h.skin\r\n        }\r\n        if (h.visible_area) {\r\n            this.conf.v_enabled = true;\r\n            this.conf.v = {\r\n                x1: h.visible_area.x1,\r\n                x2: h.visible_area.x2,\r\n                y1: h.visible_area.y1,\r\n                y2: h.visible_area.y2\r\n            }\r\n        }\r\n        for (var e in {\r\n            json: 1,\r\n            xml: 1,\r\n            items: 1,\r\n            top_text: 1,\r\n            align: 1,\r\n            open_mode: 1,\r\n            overflow: 1,\r\n            dynamic: 1,\r\n            dynamic_icon: 1,\r\n            context: 1,\r\n            onload: 1,\r\n            onclick: 1,\r\n            oncheckboxclick: 1,\r\n            onradioclick: 1\r\n        }) {\r\n            if (h[e] != null ) {\r\n                this.conf.autoload[e] = h[e]\r\n            }\r\n        }\r\n        h = h.parent\r\n    }\r\n    if (h == null ) {\r\n        this.base = document.body\r\n    } else {\r\n        var c = (typeof (h) == \"string\" ? document.getElementById(h) : h);\r\n        if (c != null ) {\r\n            this.base = c;\r\n            if (!this.base.id) {\r\n                this.base.id = \"menuBaseId_\" + new Date().getTime()\r\n            }\r\n            this.base.className += \" dhtmlxMenu_\" + this.conf.skin + \"_Middle dir_left\";\r\n            this.base._autoSkinUpdate = true;\r\n            if (this.base.oncontextmenu) {\r\n                this.base._oldContextMenuHandler = this.base.oncontextmenu\r\n            }\r\n            this.conf.ctx_baseid = this.base.id;\r\n            this.base.onselectstart = function(a) {\r\n                a = a || event;\r\n                if (a.preventDefault) {\r\n                    a.preventDefault()\r\n                } else {\r\n                    a.returnValue = false\r\n                }\r\n                return false\r\n            }\r\n            ;\r\n            this.base.oncontextmenu = function(a) {\r\n                a = a || event;\r\n                if (a.preventDefault) {\r\n                    a.preventDefault()\r\n                } else {\r\n                    a.returnValue = false\r\n                }\r\n                return false\r\n            }\r\n        } else {\r\n            this.base = document.body\r\n        }\r\n    }\r\n    this.idPrefix = \"\";\r\n    this.topId = \"dhxWebMenuTopId\";\r\n    this.idPull = {};\r\n    this.itemPull = {};\r\n    this.userData = {};\r\n    this.radio = {};\r\n    this.setSkin = function(n) {\r\n        var o = this.conf.skin;\r\n        this.conf.skin = n;\r\n        switch (this.conf.skin) {\r\n        case \"dhx_skyblue\":\r\n        case \"dhx_web\":\r\n            this.conf.tl_botmarg = 2;\r\n            this.conf.tl_rmarg = 1;\r\n            this.conf.tl_ofsleft = 1;\r\n            break;\r\n        case \"dhx_terrace\":\r\n            this.conf.tl_botmarg = 0;\r\n            this.conf.tl_rmarg = 0;\r\n            this.conf.tl_ofsleft = 0;\r\n            break\r\n        }\r\n        if (this.base._autoSkinUpdate) {\r\n            this.base.className = this.base.className.replace(\"dhtmlxMenu_\" + o + \"_Middle\", \"\") + \" dhtmlxMenu_\" + this.conf.skin + \"_Middle\"\r\n        }\r\n        for (var m in this.idPull) {\r\n            this.idPull[m].className = String(this.idPull[m].className).replace(o, this.conf.skin)\r\n        }\r\n    }\r\n    ;\r\n    this.setSkin(this.conf.skin);\r\n    this._addSubItemToSelected = function(n, m) {\r\n        var a = true;\r\n        for (var o = 0; o < this.conf.selected_sub.length; o++) {\r\n            if ((this.conf.selected_sub[o][0] == n) && (this.conf.selected_sub[o][1] == m)) {\r\n                a = false\r\n            }\r\n        }\r\n        if (a == true) {\r\n            this.conf.selected_sub.push(new Array(n,m))\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this._removeSubItemFromSelected = function(r, o) {\r\n        var a = new Array();\r\n        var n = false;\r\n        for (var s = 0; s < this.conf.selected_sub.length; s++) {\r\n            if ((this.conf.selected_sub[s][0] == r) && (this.conf.selected_sub[s][1] == o)) {\r\n                n = true\r\n            } else {\r\n                a[a.length] = this.conf.selected_sub[s]\r\n            }\r\n        }\r\n        if (n == true) {\r\n            this.conf.selected_sub = a\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    this._getSubItemToDeselectByPolygon = function(r) {\r\n        var a = new Array();\r\n        for (var s = 0; s < this.conf.selected_sub.length; s++) {\r\n            if (this.conf.selected_sub[s][1] == r) {\r\n                a[a.length] = this.conf.selected_sub[s][0];\r\n                a = a.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[s][0]));\r\n                var o = true;\r\n                for (var n = 0; n < this.conf.opened_poly.length; n++) {\r\n                    if (this.conf.opened_poly[n] == this.conf.selected_sub[s][0]) {\r\n                        o = false\r\n                    }\r\n                }\r\n                if (o == true) {\r\n                    this.conf.opened_poly[this.conf.opened_poly.length] = this.conf.selected_sub[s][0]\r\n                }\r\n                this.conf.selected_sub[s][0] = -1;\r\n                this.conf.selected_sub[s][1] = -1\r\n            }\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this._hidePolygon = function(a) {\r\n        if (this.idPull[\"polygon_\" + a] != null ) {\r\n            if (this.idPull[\"polygon_\" + a]._zId != null ) {\r\n                window.dhx4.zim.clear(this.idPull[\"polygon_\" + a]._zId)\r\n            }\r\n            if (typeof (this._menuEffect) != \"undefined\" && this._menuEffect !== false) {\r\n                this._hidePolygonEffect(\"polygon_\" + a)\r\n            } else {\r\n                if (this.idPull[\"polygon_\" + a].style.display == \"none\") {\r\n                    return\r\n                }\r\n                this.idPull[\"polygon_\" + a].style.display = \"none\";\r\n                if (this.idPull[\"arrowup_\" + a] != null ) {\r\n                    this.idPull[\"arrowup_\" + a].style.display = \"none\"\r\n                }\r\n                if (this.idPull[\"arrowdown_\" + a] != null ) {\r\n                    this.idPull[\"arrowdown_\" + a].style.display = \"none\"\r\n                }\r\n                this._updateItemComplexState(a, true, false);\r\n                if (window.dhx4.isIE6 && this.idPull[\"polygon_\" + a + \"_ie6cover\"] != null ) {\r\n                    this.idPull[\"polygon_\" + a + \"_ie6cover\"].style.display = \"none\"\r\n                }\r\n            }\r\n            a = String(a).replace(this.idPrefix, \"\");\r\n            if (a == this.topId) {\r\n                a = null \r\n            }\r\n            this.callEvent(\"onHide\", [a]);\r\n            if (a != null  && this.conf.skin == \"dhx_terrace\" && this.itemPull[this.idPrefix + a].parent == this.idPrefix + this.topId) {\r\n                this._improveTerraceButton(this.idPrefix + a, true)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._showPolygon = function(I, n) {\r\n        var N = this._countVisiblePolygonItems(I);\r\n        if (N == 0) {\r\n            return\r\n        }\r\n        var J = \"polygon_\" + I;\r\n        if ((this.idPull[J] != null ) && (this.idPull[I] != null )) {\r\n            if (this.conf.top_mode && this.conf.mode == \"web\" && !this.conf.context) {\r\n                if (!this.idPull[I]._mouseOver && n == this.conf.dir_toplv) {\r\n                    return\r\n                }\r\n            }\r\n            if (!this.conf.fixed_pos) {\r\n                this._autoDetectVisibleArea()\r\n            }\r\n            var K = 0;\r\n            var M = 0;\r\n            var P = null ;\r\n            var E = null ;\r\n            if (this.idPull[J]._zId == null ) {\r\n                this.idPull[J]._zId = window.dhx4.newId()\r\n            }\r\n            this.idPull[J]._zInd = window.dhx4.zim.reserve(this.idPull[J]._zId);\r\n            this.idPull[J].style.visibility = \"hidden\";\r\n            this.idPull[J].style.left = \"0px\";\r\n            this.idPull[J].style.top = \"0px\";\r\n            this.idPull[J].style.display = \"\";\r\n            this.idPull[J].style.zIndex = this.idPull[J]._zInd;\r\n            if (this.conf.auto_overflow) {\r\n                if (this.idPull[J].childNodes[1].childNodes[0].offsetHeight > this.conf.v.y2 - this.conf.v.y1) {\r\n                    var D = Math.max(Math.floor((this.conf.v.y2 - this.conf.v.y1 - this.conf.of_ah[this.conf.skin] * 2) / this.conf.of_ih[this.conf.skin]), 1);\r\n                    this.conf.overflow_limit = D\r\n                } else {\r\n                    this.conf.overflow_limit = 0;\r\n                    if (this.idPull[\"arrowup_\" + I] != null ) {\r\n                        this._removeUpArrow(String(I).replace(this.idPrefix, \"\"))\r\n                    }\r\n                    if (this.idPull[\"arrowdown_\" + I] != null ) {\r\n                        this._removeDownArrow(String(I).replace(this.idPrefix, \"\"))\r\n                    }\r\n                }\r\n            }\r\n            if (this.conf.overflow_limit > 0 && this.conf.overflow_limit < N) {\r\n                if (this.idPull[\"arrowup_\" + I] == null ) {\r\n                    this._addUpArrow(String(I).replace(this.idPrefix, \"\"))\r\n                }\r\n                if (this.idPull[\"arrowdown_\" + I] == null ) {\r\n                    this._addDownArrow(String(I).replace(this.idPrefix, \"\"))\r\n                }\r\n                P = this.idPull[\"arrowup_\" + I];\r\n                P.style.display = \"none\";\r\n                E = this.idPull[\"arrowdown_\" + I];\r\n                E.style.display = \"none\"\r\n            }\r\n            if (this.conf.overflow_limit > 0 && this.conf.overflow_limit < N) {\r\n                this.idPull[J].childNodes[1].style.height = this.conf.of_ih[this.conf.skin] * this.conf.overflow_limit + \"px\";\r\n                P.style.width = E.style.width = this.idPull[J].childNodes[1].style.width = this.idPull[J].childNodes[1].childNodes[0].offsetWidth + \"px\";\r\n                this.idPull[J].childNodes[1].scrollTop = 0;\r\n                P.style.display = \"\";\r\n                K = P.offsetHeight;\r\n                E.style.display = \"\";\r\n                M = E.offsetHeight\r\n            } else {\r\n                this.idPull[J].childNodes[1].style.height = \"\";\r\n                this.idPull[J].childNodes[1].style.width = \"\"\r\n            }\r\n            if (this.itemPull[I] != null ) {\r\n                var A = \"polygon_\" + this.itemPull[I][\"parent\"]\r\n            } else {\r\n                if (this.conf.context) {\r\n                    var A = this.idPull[this.idPrefix + this.topId]\r\n                }\r\n            }\r\n            var a = (this.idPull[I].tagName != null  ? window.dhx4.absLeft(this.idPull[I]) : this.idPull[I][0]);\r\n            var O = (this.idPull[I].tagName != null  ? window.dhx4.absTop(this.idPull[I]) : this.idPull[I][1]);\r\n            var m = (this.idPull[I].tagName != null  ? this.idPull[I].offsetWidth : 0);\r\n            var o = (this.idPull[I].tagName != null  ? this.idPull[I].offsetHeight : 0);\r\n            var v = 0;\r\n            var u = 0;\r\n            var C = this.idPull[J].offsetWidth;\r\n            var L = this.idPull[J].offsetHeight;\r\n            if (n == \"bottom\") {\r\n                if (this.conf.rtl) {\r\n                    v = a + (m != null  ? m : 0) - C\r\n                } else {\r\n                    if (this.conf.align == \"right\") {\r\n                        v = a + m - C\r\n                    } else {\r\n                        v = a - 1 + (n == this.conf.dir_toplv ? this.conf.tl_rmarg : 0)\r\n                    }\r\n                }\r\n                u = O - 1 + o + this.conf.tl_botmarg\r\n            }\r\n            if (n == \"right\") {\r\n                v = a + m - 1;\r\n                u = O + 2\r\n            }\r\n            if (n == \"left\") {\r\n                v = a - this.idPull[J].offsetWidth + 2;\r\n                u = O + 2\r\n            }\r\n            if (n == \"top\") {\r\n                v = a - 1;\r\n                u = O - L + 2\r\n            }\r\n            if (this.conf.fixed_pos) {\r\n                var H = 65536;\r\n                var F = 65536\r\n            } else {\r\n                var H = (this.conf.v.x2 != null  ? this.conf.v.x2 : 0);\r\n                var F = (this.conf.v.y2 != null  ? this.conf.v.y2 : 0);\r\n                if (H == 0) {\r\n                    if (window.innerWidth) {\r\n                        H = window.innerWidth;\r\n                        F = window.innerHeight\r\n                    } else {\r\n                        H = document.body.offsetWidth;\r\n                        F = document.body.scrollHeight\r\n                    }\r\n                }\r\n            }\r\n            if (v + C > H && !this.conf.rtl) {\r\n                v = a - C + 2\r\n            }\r\n            if (v < this.conf.v.x1 && this.conf.rtl) {\r\n                v = a + m - 2\r\n            }\r\n            if (v < 0) {\r\n                v = 0\r\n            }\r\n            if (u + L > F && this.conf.v.y2 != null ) {\r\n                u = Math.max(O + o - L + 2, (this.conf.v_enabled ? this.conf.v.y1 + 2 : 2));\r\n                if (this.conf.context && this.idPrefix + this.topId == I && E != null ) {\r\n                    u = u - 2\r\n                }\r\n                if (this.itemPull[I] != null  && !this.conf.context) {\r\n                    if (this.itemPull[I][\"parent\"] == this.idPrefix + this.topId) {\r\n                        u = u - this.base.offsetHeight\r\n                    }\r\n                }\r\n            }\r\n            this.idPull[J].style.left = v + \"px\";\r\n            this.idPull[J].style.top = u + \"px\";\r\n            if (typeof (this._menuEffect) != \"undefined\" && this._menuEffect !== false) {\r\n                this._showPolygonEffect(J)\r\n            } else {\r\n                this.idPull[J].style.visibility = \"\";\r\n                if (this.conf.overflow_limit > 0 && this.conf.overflow_limit < N) {\r\n                    this.idPull[J].childNodes[1].scrollTop = 0;\r\n                    this._checkArrowsState(I)\r\n                }\r\n                if (window.dhx4.isIE6) {\r\n                    var s = J + \"_ie6cover\";\r\n                    if (this.idPull[s] == null ) {\r\n                        var r = document.createElement(\"IFRAME\");\r\n                        r.className = \"dhtmlxMenu_IE6CoverFix_\" + this.conf.skin;\r\n                        r.frameBorder = 0;\r\n                        r.setAttribute(\"src\", \"javascript:false;\");\r\n                        document.body.insertBefore(r, document.body.firstChild);\r\n                        this.idPull[s] = r\r\n                    }\r\n                    this.idPull[s].style.left = v + \"px\";\r\n                    this.idPull[s].style.top = u + \"px\";\r\n                    this.idPull[s].style.width = this.idPull[J].offsetWidth + \"px\";\r\n                    this.idPull[s].style.height = this.idPull[J].offsetHeight + \"px\";\r\n                    this.idPull[s].style.zIndex = this.idPull[J].style.zIndex - 1;\r\n                    this.idPull[s].style.display = \"\"\r\n                }\r\n            }\r\n            I = String(I).replace(this.idPrefix, \"\");\r\n            if (I == this.topId) {\r\n                I = null \r\n            }\r\n            this.callEvent(\"onShow\", [I]);\r\n            if (I != null  && this.conf.skin == \"dhx_terrace\" && this.itemPull[this.idPrefix + I].parent == this.idPrefix + this.topId) {\r\n                this._improveTerraceButton(this.idPrefix + I, false)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._redistribSubLevelSelection = function(r, o) {\r\n        while (this.conf.opened_poly.length > 0) {\r\n            this.conf.opened_poly.pop()\r\n        }\r\n        var a = this._getSubItemToDeselectByPolygon(o);\r\n        this._removeSubItemFromSelected(-1, -1);\r\n        for (var m = 0; m < a.length; m++) {\r\n            if ((this.idPull[a[m]] != null ) && (a[m] != r)) {\r\n                if (this.itemPull[a[m]][\"state\"] == \"enabled\") {\r\n                    this.idPull[a[m]].className = \"sub_item\"\r\n                }\r\n            }\r\n        }\r\n        for (var m = 0; m < this.conf.opened_poly.length; m++) {\r\n            if (this.conf.opened_poly[m] != o) {\r\n                this._hidePolygon(this.conf.opened_poly[m])\r\n            }\r\n        }\r\n        if (this.itemPull[r][\"state\"] == \"enabled\") {\r\n            this.idPull[r].className = \"sub_item_selected\";\r\n            if (this.itemPull[r][\"complex\"] && this.conf.dload && (this.itemPull[r][\"loaded\"] == \"no\")) {\r\n                if (this.conf.dload_icon == true) {\r\n                    this._updateLoaderIcon(r, true)\r\n                }\r\n                this.itemPull[r].loaded = \"get\";\r\n                var n = r.replace(this.idPrefix, \"\");\r\n                this._dhxdataload.onBeforeXLS = function() {\r\n                    var u = {\r\n                        params: {}\r\n                    };\r\n                    u.params[this.conf.dload_pid] = n;\r\n                    for (var s in this.conf.dload_params) {\r\n                        u.params[s] = this.conf.dload_params[s]\r\n                    }\r\n                    return u\r\n                }\r\n                ;\r\n                this.loadStruct(this.conf.dload_url)\r\n            }\r\n            if (this.itemPull[r][\"complex\"] || (this.conf.dload && (this.itemPull[r][\"loaded\"] == \"yes\"))) {\r\n                if ((this.itemPull[r][\"complex\"]) && (this.idPull[\"polygon_\" + r] != null )) {\r\n                    this._updateItemComplexState(r, true, true);\r\n                    this._showPolygon(r, this.conf.dir_sublv)\r\n                }\r\n            }\r\n            this._addSubItemToSelected(r, o);\r\n            this.conf.selected = r\r\n        }\r\n    }\r\n    ;\r\n    this._doOnClick = function(n, x, r) {\r\n        this.conf.last_click = n;\r\n        if (this.itemPull[this.idPrefix + n][\"href_link\"] != null  && this.itemPull[this.idPrefix + n].state == \"enabled\") {\r\n            var s = document.createElement(\"FORM\");\r\n            var v = String(this.itemPull[this.idPrefix + n][\"href_link\"]).split(\"?\");\r\n            s.action = v[0];\r\n            if (v[1] != null ) {\r\n                var o = String(v[1]).split(\"&\");\r\n                for (var a = 0; a < o.length; a++) {\r\n                    var w = String(o[a]).split(\"=\");\r\n                    var u = document.createElement(\"INPUT\");\r\n                    u.type = \"hidden\";\r\n                    u.name = (w[0] || \"\");\r\n                    u.value = (w[1] || \"\");\r\n                    s.appendChild(u)\r\n                }\r\n            }\r\n            if (this.itemPull[this.idPrefix + n][\"href_target\"] != null ) {\r\n                s.target = this.itemPull[this.idPrefix + n][\"href_target\"]\r\n            }\r\n            s.style.display = \"none\";\r\n            document.body.appendChild(s);\r\n            s.submit();\r\n            if (s != null ) {\r\n                document.body.removeChild(s);\r\n                s = null \r\n            }\r\n            return\r\n        }\r\n        if (x.charAt(0) == \"c\") {\r\n            return\r\n        }\r\n        if (x.charAt(1) == \"d\") {\r\n            return\r\n        }\r\n        if (x.charAt(2) == \"s\") {\r\n            return\r\n        }\r\n        if (this.checkEvent(\"onClick\")) {\r\n            this.callEvent(\"onClick\", [n, this.conf.ctx_zoneid, r])\r\n        } else {\r\n            if ((x.charAt(1) == \"d\") || (this.conf.mode == \"win\" && x.charAt(2) == \"t\")) {\r\n                return\r\n            }\r\n        }\r\n        if (this.conf.context && this._isContextMenuVisible() && this.conf.ctx_autohide) {\r\n            this._hideContextMenu()\r\n        } else {\r\n            if (this._clearAndHide) {\r\n                this._clearAndHide()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._doOnTouchMenu = function(a) {\r\n        if (this.conf.is_touched == false) {\r\n            this.conf.is_touched = true;\r\n            if (this.checkEvent(\"onTouch\")) {\r\n                this.callEvent(\"onTouch\", [a])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._searchMenuNode = function(o, s) {\r\n        var a = new Array();\r\n        for (var r = 0; r < s.length; r++) {\r\n            if (typeof (s[r]) == \"object\") {\r\n                if (s[r].length == 5) {\r\n                    if (typeof (s[r][0]) != \"object\") {\r\n                        if ((s[r][0].replace(this.idPrefix, \"\") == o) && (r == 0)) {\r\n                            a = s\r\n                        }\r\n                    }\r\n                }\r\n                var n = this._searchMenuNode(o, s[r]);\r\n                if (n.length > 0) {\r\n                    a = n\r\n                }\r\n            }\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this._getMenuNodes = function(r) {\r\n        var n = new Array;\r\n        for (var o in this.itemPull) {\r\n            if (this.itemPull[o][\"parent\"] == r) {\r\n                n[n.length] = o\r\n            }\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    this._genStr = function(a) {\r\n        var m = \"dhxId_\";\r\n        var o = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\r\n        for (var n = 0; n < a; n++) {\r\n            m += o.charAt(Math.round(Math.random() * (o.length - 1)))\r\n        }\r\n        return m\r\n    }\r\n    ;\r\n    this.getItemType = function(a) {\r\n        a = this.idPrefix + a;\r\n        if (this.itemPull[a] == null ) {\r\n            return null \r\n        }\r\n        return this.itemPull[a][\"type\"]\r\n    }\r\n    ;\r\n    this.forEachItem = function(n) {\r\n        for (var m in this.itemPull) {\r\n            n(String(m).replace(this.idPrefix, \"\"))\r\n        }\r\n    }\r\n    ;\r\n    this._clearAndHide = function() {\r\n        g.conf.selected = -1;\r\n        g.conf.last_click = -1;\r\n        while (g.conf.opened_poly.length > 0) {\r\n            g.conf.opened_poly.pop()\r\n        }\r\n        for (var a = 0; a < g.conf.selected_sub.length; a++) {\r\n            var m = g.conf.selected_sub[a][0];\r\n            if (g.idPull[m] != null ) {\r\n                if (g.itemPull[m][\"state\"] == \"enabled\") {\r\n                    if (g.idPull[m].className == \"sub_item_selected\") {\r\n                        g.idPull[m].className = \"sub_item\"\r\n                    }\r\n                    if (g.idPull[m].className == \"dhtmlxMenu_\" + g.conf.skin + \"_TopLevel_Item_Selected\") {\r\n                        if (g.itemPull[m][\"cssNormal\"] != null ) {\r\n                            g.idPull[m].className = g.itemPull[m][\"cssNormal\"]\r\n                        } else {\r\n                            g.idPull[m].className = \"dhtmlxMenu_\" + g.conf.skin + \"_TopLevel_Item_Normal\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            g._hidePolygon(m)\r\n        }\r\n        g.conf.is_touched = false;\r\n        if (g.conf.context && g.conf.ctx_hideall) {\r\n            g._hidePolygon(g.idPrefix + g.topId)\r\n        }\r\n    }\r\n    ;\r\n    this._showSubLevelItem = function(m, a) {\r\n        if (document.getElementById(\"arrow_\" + this.idPrefix + m) != null ) {\r\n            document.getElementById(\"arrow_\" + this.idPrefix + m).style.display = (a ? \"none\" : \"\")\r\n        }\r\n        if (document.getElementById(\"image_\" + this.idPrefix + m) != null ) {\r\n            document.getElementById(\"image_\" + this.idPrefix + m).style.display = (a ? \"none\" : \"\")\r\n        }\r\n        if (document.getElementById(this.idPrefix + m) != null ) {\r\n            document.getElementById(this.idPrefix + m).style.display = (a ? \"\" : \"none\")\r\n        }\r\n    }\r\n    ;\r\n    this._hideSubLevelItem = function(a) {\r\n        this._showSubLevelItem(a, true)\r\n    }\r\n    ;\r\n    this.idPrefix = this._genStr(12) + \"_\";\r\n    this._bodyClick = function(a) {\r\n        a = a || event;\r\n        if (a.button == 2 || (window.dhx4.isOpera && a.ctrlKey == true)) {\r\n            return\r\n        }\r\n        if (g.conf.context) {\r\n            if (g.conf.ctx_autohide && (!window.dhx4.isOpera || (g._isContextMenuVisible() && window.dhx4.isOpera))) {\r\n                g._hideContextMenu()\r\n            }\r\n        } else {\r\n            if (g._clearAndHide) {\r\n                g._clearAndHide()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._bodyContext = function(n) {\r\n        n = n || event;\r\n        var m = String((n.srcElement || n.target).className);\r\n        if (m.search(\"dhtmlxMenu\") != -1 && m.search(\"SubLevelArea\") != -1) {\r\n            return\r\n        }\r\n        var a = true;\r\n        var o = n.target || n.srcElement;\r\n        while (o != null ) {\r\n            if (o.id != null ) {\r\n                if (g.isContextZone(o.id)) {\r\n                    a = false\r\n                }\r\n            }\r\n            if (o == document.body) {\r\n                a = false\r\n            }\r\n            o = o.parentNode\r\n        }\r\n        if (a) {\r\n            g.hideContextMenu()\r\n        }\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) != \"undefined\") {\r\n        window.addEventListener(\"click\", this._bodyClick, false);\r\n        window.addEventListener(\"contextmenu\", this._bodyContext, false)\r\n    } else {\r\n        document.body.attachEvent(\"onclick\", this._bodyClick);\r\n        document.body.attachEvent(\"oncontextmenu\", this._bodyContext)\r\n    }\r\n    this.unload = function() {\r\n        window.dhx4._eventable(this, \"clear\");\r\n        dhtmlXMenuObject.prototype.liveInst[this.conf.live_id] = null ;\r\n        try {\r\n            delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]\r\n        } catch (n) {}\r\n        this.conf.live_id = null ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"click\", this._bodyClick, false);\r\n            window.removeEventListener(\"contextmenu\", this._bodyContext, false)\r\n        } else {\r\n            document.body.detachEvent(\"onclick\", this._bodyClick);\r\n            document.body.detachEvent(\"oncontextmenu\", this._bodyContext)\r\n        }\r\n        this._bodyClick = null ;\r\n        this._bodyContext = null ;\r\n        this.removeItem(this.idPrefix + this.topId, true);\r\n        this.itemPull = null ;\r\n        this.idPull = null ;\r\n        if (this.conf.context) {\r\n            for (var m in this.conf.ctx_zones) {\r\n                this.removeContextZone(m)\r\n            }\r\n        }\r\n        if (this.cont != null ) {\r\n            this.cont.className = \"\";\r\n            this.cont.parentNode.removeChild(this.cont);\r\n            this.cont = null \r\n        }\r\n        if (this.base != null ) {\r\n            if (!this.conf.context) {\r\n                this.base.className = \"\"\r\n            }\r\n            if (!this.conf.context) {\r\n                this.base.oncontextmenu = (this.base._oldContextMenuHandler || null )\r\n            }\r\n            this.base.onselectstart = null ;\r\n            this.base = null \r\n        }\r\n        for (var m in this) {\r\n            this[m] = null \r\n        }\r\n        g = null \r\n    }\r\n    ;\r\n    dhtmlXMenuObject.prototype.liveInst[this.conf.live_id] = this;\r\n    window.dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToJson\", this.conf.tags.root, {\r\n        struct: true\r\n    });\r\n    window.dhx4._eventable(this);\r\n    if (window.dhx4.s2b(this.conf.autoload.context) == true) {\r\n        this.renderAsContextMenu()\r\n    }\r\n    if (this.conf.autoload.dynamic != null ) {\r\n        this.enableDynamicLoading(this.conf.autoload.dynamic, window.dhx4.s2b(this.conf.autoload.dynamic_icon))\r\n    } else {\r\n        if (this.conf.autoload.items != null ) {\r\n            this.loadStruct(this.conf.autoload.items, this.conf.autoload.onload)\r\n        } else {\r\n            if (this.conf.autoload.json != null ) {\r\n                this.loadStruct(this.conf.autoload.json, this.conf.autoload.onload)\r\n            } else {\r\n                if (this.conf.autoload.xml != null ) {\r\n                    this.loadStruct(this.conf.autoload.xml, this.conf.autoload.onload)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    for (var e in {\r\n        onclick: 1,\r\n        oncheckboxclick: 1,\r\n        onradioclick: 1\r\n    }) {\r\n        if (this.conf.autoload[e] != null ) {\r\n            if (typeof (this.conf.autoload[e]) == \"function\") {\r\n                this.attachEvent(e, this.conf.autoload[e])\r\n            } else {\r\n                if (typeof (window[this.conf.autoload[e]]) == \"function\") {\r\n                    this.attachEvent(e, window[this.conf.autoload[e]])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (this.conf.autoload.top_text != null ) {\r\n        this.setTopText(this.conf.autoload.top_text)\r\n    }\r\n    if (this.conf.autoload.align != null ) {\r\n        this.setAlign(this.conf.autoload.align)\r\n    }\r\n    if (this.conf.autoload.open_mode != null ) {\r\n        this.setOpenMode(this.conf.autoload.open_mode)\r\n    }\r\n    if (this.conf.autoload.overflow != null ) {\r\n        this.setOverflowHeight(this.conf.autoload.overflow)\r\n    }\r\n    for (var e in this.conf.autoload) {\r\n        this.conf.autoload[e] = null ;\r\n        delete this.conf.autoload[e]\r\n    }\r\n    this.conf.autoload = null ;\r\n    return this\r\n}\r\ndhtmlXMenuObject.prototype._init = function() {\r\n    if (this._isInited == true) {\r\n        return\r\n    }\r\n    if (this.conf.dload) {\r\n        this._dhxdataload.onBeforeXLS = function() {\r\n            var e = {\r\n                params: {}\r\n            };\r\n            for (var c in this.conf.dload_params) {\r\n                e.params[c] = this.conf.dload_params[c]\r\n            }\r\n            return e\r\n        }\r\n        ;\r\n        this.loadStruct(this.conf.dload_url)\r\n    } else {\r\n        this._initTopLevelMenu();\r\n        this._isInited = true\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._countVisiblePolygonItems = function(l) {\r\n    var g = 0;\r\n    for (var c in this.itemPull) {\r\n        var e = this.itemPull[c][\"parent\"];\r\n        var h = this.itemPull[c][\"type\"];\r\n        if (this.idPull[c] != null ) {\r\n            if (e == l && (h == \"item\" || h == \"radio\" || h == \"checkbox\") && this.idPull[c].style.display != \"none\") {\r\n                g++\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._redefineComplexState = function(c) {\r\n    if (this.idPrefix + this.topId == c) {\r\n        return\r\n    }\r\n    if ((this.idPull[\"polygon_\" + c] != null ) && (this.idPull[c] != null )) {\r\n        var a = this._countVisiblePolygonItems(c);\r\n        if ((a > 0) && (!this.itemPull[c][\"complex\"])) {\r\n            this._updateItemComplexState(c, true, false)\r\n        }\r\n        if ((a == 0) && (this.itemPull[c][\"complex\"])) {\r\n            this._updateItemComplexState(c, false, false)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._updateItemComplexState = function(h, e, g) {\r\n    if ((!this.conf.context) && (this._getItemLevelType(h.replace(this.idPrefix, \"\")) == \"TopLevel\")) {\r\n        this.itemPull[h][\"complex\"] = e;\r\n        return\r\n    }\r\n    if ((this.idPull[h] == null ) || (this.itemPull[h] == null )) {\r\n        return\r\n    }\r\n    this.itemPull[h][\"complex\"] = e;\r\n    if (h == this.idPrefix + this.topId) {\r\n        return\r\n    }\r\n    var a = null ;\r\n    var c = this.idPull[h].childNodes[this.conf.rtl ? 0 : 2];\r\n    if (c.childNodes[0]) {\r\n        if (String(c.childNodes[0].className).search(\"complex_arrow\") === 0) {\r\n            a = c.childNodes[0]\r\n        }\r\n    }\r\n    if (this.itemPull[h][\"complex\"]) {\r\n        if (a == null ) {\r\n            a = document.createElement(\"DIV\");\r\n            a.className = \"complex_arrow\";\r\n            a.id = \"arrow_\" + h;\r\n            while (c.childNodes.length > 0) {\r\n                c.removeChild(c.childNodes[0])\r\n            }\r\n            c.appendChild(a)\r\n        }\r\n        if (this.conf.dload && (this.itemPull[h].loaded == \"get\") && this.conf.dload_icon) {\r\n            if (a.className != \"complex_arrow_loading\") {\r\n                a.className = \"complex_arrow_loading\"\r\n            }\r\n        } else {\r\n            a.className = \"complex_arrow\"\r\n        }\r\n        return\r\n    }\r\n    if ((!this.itemPull[h][\"complex\"]) && (a != null )) {\r\n        c.removeChild(a);\r\n        if (this.itemPull[h][\"hotkey_backup\"] != null  && this.setHotKey) {\r\n            this.setHotKey(h.replace(this.idPrefix, \"\"), this.itemPull[h][\"hotkey_backup\"])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._getItemLevelType = function(a) {\r\n    return ( this.itemPull[this.idPrefix + a][\"parent\"] == this.idPrefix + this.topId ? \"TopLevel\" : \"SubLevelArea\") \r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setIconsPath = function(a) {\r\n    this.conf.icons_path = a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._updateItemImage = function(g, h) {\r\n    g = this.idPrefix + g;\r\n    var o = this.itemPull[g][\"type\"];\r\n    if (o == \"checkbox\" || o == \"radio\") {\r\n        return\r\n    }\r\n    var l = (this.itemPull[g][\"parent\"] == this.idPrefix + this.topId && !this.conf.context);\r\n    var m = null ;\r\n    if (l) {\r\n        for (var a = 0; a < this.idPull[g].childNodes.length; a++) {\r\n            try {\r\n                if (this.idPull[g].childNodes[a].className == \"dhtmlxMenu_TopLevel_Item_Icon\") {\r\n                    m = this.idPull[g].childNodes[a]\r\n                }\r\n            } catch (n) {}\r\n        }\r\n    } else {\r\n        try {\r\n            var m = this.idPull[g].childNodes[this.conf.rtl ? 2 : 0].childNodes[0]\r\n        } catch (n) {}\r\n        if (!(m != null  && typeof (m.className) != \"undefined\" && m.className == \"sub_icon\")) {\r\n            m = null \r\n        }\r\n    }\r\n    var s = this.itemPull[g][(this.itemPull[g][\"state\"] == \"enabled\" ? \"imgen\" : \"imgdis\")];\r\n    if (s.length > 0) {\r\n        if (m != null ) {\r\n            m.src = this.conf.icons_path + s\r\n        } else {\r\n            if (l) {\r\n                var m = document.createElement(\"IMG\");\r\n                m.className = \"dhtmlxMenu_TopLevel_Item_Icon\";\r\n                m.src = this.conf.icons_path + s;\r\n                m.border = \"0\";\r\n                m.id = \"image_\" + g;\r\n                if (!this.conf.rtl && this.idPull[g].childNodes.length > 0) {\r\n                    this.idPull[g].insertBefore(m, this.idPull[g].childNodes[0])\r\n                } else {\r\n                    this.idPull[g].appendChild(m)\r\n                }\r\n            } else {\r\n                var m = document.createElement(\"IMG\");\r\n                m.className = \"sub_icon\";\r\n                m.src = this.conf.icons_path + s;\r\n                m.border = \"0\";\r\n                m.id = \"image_\" + g;\r\n                var r = this.idPull[g].childNodes[this.conf.rtl ? 2 : 0];\r\n                while (r.childNodes.length > 0) {\r\n                    r.removeChild(r.childNodes[0])\r\n                }\r\n                r.appendChild(m)\r\n            }\r\n        }\r\n    } else {\r\n        if (m != null ) {\r\n            var c = m.parentNode;\r\n            c.removeChild(m);\r\n            c.innerHTML = \"&nbsp;\";\r\n            c = m = null \r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._getAllParents = function(l) {\r\n    var e = new Array();\r\n    for (var c in this.itemPull) {\r\n        if (this.itemPull[c][\"parent\"] == l) {\r\n            e[e.length] = this.itemPull[c][\"id\"];\r\n            if (this.itemPull[c][\"complex\"]) {\r\n                var g = this._getAllParents(this.itemPull[c][\"id\"]);\r\n                for (var h = 0; h < g.length; h++) {\r\n                    e[e.length] = g[h]\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._autoDetectVisibleArea = function() {\r\n    if (this.conf.v_enabled) {\r\n        return\r\n    }\r\n    var a = window.dhx4.screenDim();\r\n    this.conf.v.x1 = a.left;\r\n    this.conf.v.x2 = a.right;\r\n    this.conf.v.y1 = a.top;\r\n    this.conf.v.y2 = a.bottom\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getItemPosition = function(h) {\r\n    h = this.idPrefix + h;\r\n    var g = -1;\r\n    if (this.itemPull[h] == null ) {\r\n        return g\r\n    }\r\n    var a = this.itemPull[h][\"parent\"];\r\n    var e = (this.idPull[\"polygon_\" + a] != null  ? this.idPull[\"polygon_\" + a].tbd : this.cont);\r\n    for (var c = 0; c < e.childNodes.length; c++) {\r\n        if (e.childNodes[c] == this.idPull[\"separator_\" + h] || e.childNodes[c] == this.idPull[h]) {\r\n            g = c\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setItemPosition = function(m, l) {\r\n    m = this.idPrefix + m;\r\n    if (this.idPull[m] == null ) {\r\n        return\r\n    }\r\n    var c = (this.itemPull[m][\"parent\"] == this.idPrefix + this.topId);\r\n    var a = this.idPull[m];\r\n    var g = this.getItemPosition(m.replace(this.idPrefix, \"\"));\r\n    var e = this.itemPull[m][\"parent\"];\r\n    var h = (this.idPull[\"polygon_\" + e] != null  ? this.idPull[\"polygon_\" + e].tbd : this.cont);\r\n    h.removeChild(h.childNodes[g]);\r\n    if (l < 0) {\r\n        l = 0\r\n    }\r\n    if (c && l < 1) {\r\n        l = 1\r\n    }\r\n    if (l < h.childNodes.length) {\r\n        h.insertBefore(a, h.childNodes[l])\r\n    } else {\r\n        h.appendChild(a)\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getParentId = function(a) {\r\n    a = this.idPrefix + a;\r\n    if (this.itemPull[a] == null ) {\r\n        return null \r\n    }\r\n    return ( (this.itemPull[a][\"parent\"] != null  ? this.itemPull[a][\"parent\"] : this.topId).replace(this.idPrefix, \"\")) \r\n}\r\n;\r\ndhtmlXMenuObject.prototype.hide = function() {\r\n    this._clearAndHide()\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.clearAll = function() {\r\n    this.removeItem(this.idPrefix + this.topId, true);\r\n    this._isInited = false;\r\n    this.idPrefix = this._genStr(12) + \"_\";\r\n    this.itemPull = {}\r\n}\r\n;\r\nif (typeof (dhtmlXMenuObject.prototype.liveInst) == \"undefined\") {\r\n    dhtmlXMenuObject.prototype.liveInst = {}\r\n}\r\ndhtmlXMenuObject.prototype._redistribTopLevelSelection = function(g, c) {\r\n    var a = this._getSubItemToDeselectByPolygon(\"parent\");\r\n    this._removeSubItemFromSelected(-1, -1);\r\n    for (var e = 0; e < a.length; e++) {\r\n        if (a[e] != g) {\r\n            this._hidePolygon(a[e])\r\n        }\r\n        if ((this.idPull[a[e]] != null ) && (a[e] != g)) {\r\n            this.idPull[a[e]].className = this.idPull[a[e]].className.replace(/Selected/g, \"Normal\")\r\n        }\r\n    }\r\n    if (this.itemPull[this.idPrefix + g][\"state\"] == \"enabled\") {\r\n        this.idPull[this.idPrefix + g].className = \"dhtmlxMenu_\" + this.conf.skin + \"_TopLevel_Item_Selected\";\r\n        this._addSubItemToSelected(this.idPrefix + g, \"parent\");\r\n        this.conf.selected = (this.conf.mode == \"win\" ? (this.conf.selected != -1 ? g : this.conf.selected) : g);\r\n        if ((this.itemPull[this.idPrefix + g][\"complex\"]) && (this.conf.selected != -1)) {\r\n            this._showPolygon(this.idPrefix + g, this.conf.dir_toplv)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._initTopLevelMenu = function() {\r\n    this.conf.dir_toplv = \"bottom\";\r\n    this.conf.dir_sublv = (this.conf.rtl ? \"left\" : \"right\");\r\n    if (this.conf.context) {\r\n        this.idPull[this.idPrefix + this.topId] = new Array(0,0);\r\n        this._addSubMenuPolygon(this.idPrefix + this.topId, this.idPrefix + this.topId)\r\n    } else {\r\n        var a = this._getMenuNodes(this.idPrefix + this.topId);\r\n        for (var c = 0; c < a.length; c++) {\r\n            if (this.itemPull[a[c]][\"type\"] == \"item\") {\r\n                this._renderToplevelItem(a[c], null )\r\n            }\r\n            if (this.itemPull[a[c]][\"type\"] == \"separator\") {\r\n                this._renderSeparator(a[c], null )\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._renderToplevelItem = function(n, l) {\r\n    var h = this;\r\n    var a = document.createElement(\"DIV\");\r\n    a.id = n;\r\n    if (this.itemPull[n][\"state\"] == \"enabled\" && this.itemPull[n][\"cssNormal\"] != null ) {\r\n        a.className = this.itemPull[n][\"cssNormal\"]\r\n    } else {\r\n        a.className = \"dhtmlxMenu_\" + this.conf.skin + \"_TopLevel_Item_\" + (this.itemPull[n][\"state\"] == \"enabled\" ? \"Normal\" : \"Disabled\")\r\n    }\r\n    if (this.itemPull[n][\"title\"] != \"\") {\r\n        var g = document.createElement(\"DIV\");\r\n        g.className = \"top_level_text\";\r\n        g.innerHTML = this.itemPull[n][\"title\"];\r\n        a.appendChild(g)\r\n    }\r\n    if (this.itemPull[n][\"tip\"].length > 0) {\r\n        a.title = this.itemPull[n][\"tip\"]\r\n    }\r\n    if ((this.itemPull[n][\"imgen\"] != \"\") || (this.itemPull[n][\"imgdis\"] != \"\")) {\r\n        var e = this.itemPull[n][(this.itemPull[n][\"state\"] == \"enabled\") ? \"imgen\" : \"imgdis\"];\r\n        if (e) {\r\n            var c = document.createElement(\"IMG\");\r\n            c.border = \"0\";\r\n            c.id = \"image_\" + n;\r\n            c.src = this.conf.icons_path + e;\r\n            c.className = \"dhtmlxMenu_TopLevel_Item_Icon\";\r\n            if (a.childNodes.length > 0 && !this.conf.rtl) {\r\n                a.insertBefore(c, a.childNodes[0])\r\n            } else {\r\n                a.appendChild(c)\r\n            }\r\n        }\r\n    }\r\n    a.onselectstart = function(m) {\r\n        m = m || event;\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    a.oncontextmenu = function(m) {\r\n        m = m || event;\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    if (!this.cont) {\r\n        this.cont = document.createElement(\"DIV\");\r\n        this.cont.dir = \"ltr\";\r\n        this.cont.className = (this.conf.align == \"right\" ? \"align_right\" : \"align_left\");\r\n        this.base.appendChild(this.cont)\r\n    }\r\n    if (l != null ) {\r\n        l++;\r\n        if (l < 0) {\r\n            l = 0\r\n        }\r\n        if (l > this.cont.childNodes.length - 1) {\r\n            l = null \r\n        }\r\n    }\r\n    if (l != null ) {\r\n        this.cont.insertBefore(a, this.cont.childNodes[l])\r\n    } else {\r\n        this.cont.appendChild(a)\r\n    }\r\n    this.idPull[a.id] = a;\r\n    if (this.itemPull[n][\"complex\"] && (!this.conf.dload)) {\r\n        this._addSubMenuPolygon(this.itemPull[n][\"id\"], this.itemPull[n][\"id\"])\r\n    }\r\n    a.onmouseover = function() {\r\n        if (h.conf.mode == \"web\") {\r\n            window.clearTimeout(h.conf.tm_handler)\r\n        }\r\n        var m = h._getSubItemToDeselectByPolygon(\"parent\");\r\n        h._removeSubItemFromSelected(-1, -1);\r\n        for (var r = 0; r < m.length; r++) {\r\n            if (m[r] != this.id) {\r\n                h._hidePolygon(m[r])\r\n            }\r\n            if ((h.idPull[m[r]] != null ) && (m[r] != this.id)) {\r\n                if (h.itemPull[m[r]][\"cssNormal\"] != null ) {\r\n                    h.idPull[m[r]].className = h.itemPull[m[r]][\"cssNormal\"]\r\n                } else {\r\n                    if (h.idPull[m[r]].className == \"sub_item_selected\") {\r\n                        h.idPull[m[r]].className = \"sub_item\"\r\n                    }\r\n                    h.idPull[m[r]].className = h.idPull[m[r]].className.replace(/Selected/g, \"Normal\")\r\n                }\r\n            }\r\n        }\r\n        if (h.itemPull[this.id][\"state\"] == \"enabled\") {\r\n            this.className = \"dhtmlxMenu_\" + h.conf.skin + \"_TopLevel_Item_Selected\";\r\n            h._addSubItemToSelected(this.id, \"parent\");\r\n            h.conf.selected = (h.conf.mode == \"win\" ? (h.conf.selected != -1 ? this.id : h.conf.selected) : this.id);\r\n            if (h.conf.dload) {\r\n                if (h.itemPull[this.id].loaded == \"no\") {\r\n                    this._dynLoadTM = new Date().getTime();\r\n                    h.itemPull[this.id].loaded = \"get\";\r\n                    var s = this.id.replace(h.idPrefix, \"\");\r\n                    h._dhxdataload.onBeforeXLS = function() {\r\n                        var v = {\r\n                            params: {}\r\n                        };\r\n                        v.params[this.conf.dload_pid] = s;\r\n                        for (var u in this.conf.dload_params) {\r\n                            v.params[u] = this.conf.dload_params[u]\r\n                        }\r\n                        return v\r\n                    }\r\n                    ;\r\n                    h.loadStruct(h.conf.dload_url)\r\n                }\r\n                if (h.conf.top_mode && h.conf.mode == \"web\" && !h.conf.context) {\r\n                    this._mouseOver = true\r\n                }\r\n            }\r\n            if ((!h.conf.dload) || (h.conf.dload && (!h.itemPull[this.id][\"loaded\"] || h.itemPull[this.id][\"loaded\"] == \"yes\"))) {\r\n                if ((h.itemPull[this.id][\"complex\"]) && (h.conf.selected != -1)) {\r\n                    if (h.conf.top_mode && h.conf.mode == \"web\" && !h.conf.context) {\r\n                        this._mouseOver = true;\r\n                        var o = this.id;\r\n                        this._menuOpenTM = window.setTimeout(function() {\r\n                            h._showPolygon(o, h.conf.dir_toplv)\r\n                        }, h.conf.top_tmtime)\r\n                    } else {\r\n                        h._showPolygon(this.id, h.conf.dir_toplv)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        h._doOnTouchMenu(this.id.replace(h.idPrefix, \"\"))\r\n    }\r\n    ;\r\n    a.onmouseout = function() {\r\n        if (!((h.itemPull[this.id][\"complex\"]) && (h.conf.selected != -1)) && (h.itemPull[this.id][\"state\"] == \"enabled\")) {\r\n            if (h.itemPull[this.id][\"cssNormal\"] != null ) {\r\n                a.className = h.itemPull[this.id][\"cssNormal\"]\r\n            } else {\r\n                a.className = \"dhtmlxMenu_\" + h.conf.skin + \"_TopLevel_Item_Normal\"\r\n            }\r\n        }\r\n        if (h.conf.mode == \"web\") {\r\n            window.clearTimeout(h.conf.tm_handler);\r\n            h.conf.tm_handler = window.setTimeout(function() {\r\n                h._clearAndHide()\r\n            }, h.conf.tm_sec, \"JavaScript\")\r\n        }\r\n        if (h.conf.top_mode && h.conf.mode == \"web\" && !h.conf.context) {\r\n            this._mouseOver = false;\r\n            window.clearTimeout(this._menuOpenTM)\r\n        }\r\n    }\r\n    ;\r\n    a.onclick = function(u) {\r\n        if (h.conf.mode == \"web\") {\r\n            window.clearTimeout(h.conf.tm_handler)\r\n        }\r\n        if (h.conf.mode != \"web\" && h.itemPull[this.id][\"state\"] == \"disabled\") {\r\n            return\r\n        }\r\n        u = u || event;\r\n        u.cancelBubble = true;\r\n        if (u.preventDefault) {\r\n            u.preventDefault()\r\n        } else {\r\n            u.returnValue = false\r\n        }\r\n        if (h.conf.mode == \"win\") {\r\n            if (h.itemPull[this.id][\"complex\"]) {\r\n                if (h.conf.selected == this.id) {\r\n                    h.conf.selected = -1;\r\n                    var r = false\r\n                } else {\r\n                    h.conf.selected = this.id;\r\n                    var r = true\r\n                }\r\n                if (r) {\r\n                    h._showPolygon(this.id, h.conf.dir_toplv)\r\n                } else {\r\n                    h._hidePolygon(this.id)\r\n                }\r\n            }\r\n        }\r\n        var m = (h.itemPull[this.id][\"complex\"] ? \"c\" : \"-\");\r\n        var v = (h.itemPull[this.id][\"state\"] != \"enabled\" ? \"d\" : \"-\");\r\n        var o = {\r\n            ctrl: u.ctrlKey,\r\n            alt: u.altKey,\r\n            shift: u.shiftKey\r\n        };\r\n        h._doOnClick(this.id.replace(h.idPrefix, \"\"), m + v + \"t\", o);\r\n        return false\r\n    }\r\n    ;\r\n    if (this.conf.skin == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._addSubMenuPolygon = function(l, h) {\r\n    var c = this._renderSublevelPolygon(l, h);\r\n    var a = this._getMenuNodes(h);\r\n    for (e = 0; e < a.length; e++) {\r\n        if (this.itemPull[a[e]][\"type\"] == \"separator\") {\r\n            this._renderSeparator(a[e], null )\r\n        } else {\r\n            this._renderSublevelItem(a[e], null )\r\n        }\r\n    }\r\n    if (l == h) {\r\n        var g = \"topLevel\"\r\n    } else {\r\n        var g = \"subLevel\"\r\n    }\r\n    for (var e = 0; e < a.length; e++) {\r\n        if (this.itemPull[a[e]][\"complex\"]) {\r\n            this._addSubMenuPolygon(l, this.itemPull[a[e]][\"id\"])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._renderSublevelPolygon = function(h, g) {\r\n    var c = document.createElement(\"DIV\");\r\n    c.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_Polygon \" + (this.conf.rtl ? \"dir_right\" : \"\");\r\n    c.dir = \"ltr\";\r\n    c.oncontextmenu = function(l) {\r\n        l = l || event;\r\n        if (l.preventDefault) {\r\n            l.preventDefault()\r\n        } else {\r\n            l.returnValue = false\r\n        }\r\n        l.cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    c.id = \"polygon_\" + g;\r\n    c.onclick = function(l) {\r\n        l = l || event;\r\n        l.cancelBubble = true\r\n    }\r\n    ;\r\n    c.style.display = \"none\";\r\n    document.body.insertBefore(c, document.body.firstChild);\r\n    c.innerHTML = '<div style=\"position:relative;\"></div><div style=\"position: relative; overflow:hidden;\"></div><div style=\"position:relative;\"></div>';\r\n    var e = document.createElement(\"TABLE\");\r\n    e.className = \"dhtmlxMebu_SubLevelArea_Tbl\";\r\n    e.cellSpacing = 0;\r\n    e.cellPadding = 0;\r\n    e.border = 0;\r\n    var a = document.createElement(\"TBODY\");\r\n    e.appendChild(a);\r\n    c.childNodes[1].appendChild(e);\r\n    c.tbl = e;\r\n    c.tbd = a;\r\n    this.idPull[c.id] = c;\r\n    if (this.sxDacProc != null ) {\r\n        this.idPull[\"sxDac_\" + g] = new this.sxDacProc(c,c.className);\r\n        if (window.dhx4.isIE) {\r\n            this.idPull[\"sxDac_\" + g]._setSpeed(this.dacSpeedIE);\r\n            this.idPull[\"sxDac_\" + g]._setCustomCycle(this.dacCyclesIE)\r\n        } else {\r\n            this.idPull[\"sxDac_\" + g]._setSpeed(this.dacSpeed);\r\n            this.idPull[\"sxDac_\" + g]._setCustomCycle(this.dacCycles)\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._renderSublevelItem = function(a, r) {\r\n    var n = this;\r\n    var o = document.createElement(\"TR\");\r\n    o.className = (this.itemPull[a][\"state\"] == \"enabled\" ? \"sub_item\" : \"sub_item_dis\");\r\n    var m = document.createElement(\"TD\");\r\n    m.className = \"sub_item_icon\";\r\n    var s = this.itemPull[a][(this.itemPull[a][\"state\"] == \"enabled\" ? \"imgen\" : \"imgdis\")];\r\n    if (s != \"\") {\r\n        var w = this.itemPull[a][\"type\"];\r\n        if (w == \"checkbox\" || w == \"radio\") {\r\n            var h = document.createElement(\"DIV\");\r\n            h.id = \"image_\" + this.itemPull[a][\"id\"];\r\n            h.className = \"sub_icon \" + s;\r\n            m.appendChild(h)\r\n        }\r\n        if (!(w == \"checkbox\" || w == \"radio\")) {\r\n            var h = document.createElement(\"IMG\");\r\n            h.id = \"image_\" + this.itemPull[a][\"id\"];\r\n            h.className = \"sub_icon\";\r\n            h.src = this.conf.icons_path + s;\r\n            m.appendChild(h)\r\n        }\r\n    } else {\r\n        m.innerHTML = \"&nbsp;\"\r\n    }\r\n    var l = document.createElement(\"TD\");\r\n    l.className = \"sub_item_text\";\r\n    if (this.itemPull[a][\"title\"] != \"\") {\r\n        var v = document.createElement(\"DIV\");\r\n        v.className = \"sub_item_text\";\r\n        v.innerHTML = this.itemPull[a][\"title\"];\r\n        l.appendChild(v)\r\n    } else {\r\n        l.innerHTML = \"&nbsp;\"\r\n    }\r\n    var g = document.createElement(\"TD\");\r\n    g.className = \"sub_item_hk\";\r\n    if (this.itemPull[a][\"complex\"]) {\r\n        var c = document.createElement(\"DIV\");\r\n        c.className = \"complex_arrow\";\r\n        c.id = \"arrow_\" + this.itemPull[a][\"id\"];\r\n        g.appendChild(c)\r\n    } else {\r\n        if (this.itemPull[a][\"hotkey\"].length > 0 && !this.itemPull[a][\"complex\"]) {\r\n            var e = document.createElement(\"DIV\");\r\n            e.className = \"sub_item_hk\";\r\n            e.innerHTML = this.itemPull[a][\"hotkey\"];\r\n            g.appendChild(e)\r\n        } else {\r\n            g.innerHTML = \"&nbsp;\"\r\n        }\r\n    }\r\n    o.appendChild(this.conf.rtl ? g : m);\r\n    o.appendChild(l);\r\n    o.appendChild(this.conf.rtl ? m : g);\r\n    o.id = this.itemPull[a][\"id\"];\r\n    o.parent = this.itemPull[a][\"parent\"];\r\n    if (this.itemPull[a][\"tip\"].length > 0) {\r\n        o.title = this.itemPull[a][\"tip\"]\r\n    }\r\n    o.onselectstart = function(x) {\r\n        x = x || event;\r\n        if (x.preventDefault) {\r\n            x.preventDefault()\r\n        } else {\r\n            x.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    o.onmouseover = function(x) {\r\n        if (n.conf.hide_tm[this.id]) {\r\n            window.clearTimeout(n.conf.hide_tm[this.id])\r\n        }\r\n        if (n.conf.mode == \"web\") {\r\n            window.clearTimeout(n.conf.tm_handler)\r\n        }\r\n        if (!this._visible) {\r\n            n._redistribSubLevelSelection(this.id, this.parent)\r\n        }\r\n        this._visible = true\r\n    }\r\n    ;\r\n    o.onmouseout = function() {\r\n        if (n.conf.mode == \"web\") {\r\n            if (n.conf.tm_handler) {\r\n                window.clearTimeout(n.conf.tm_handler)\r\n            }\r\n            n.conf.tm_handler = window.setTimeout(function() {\r\n                if (n && n._clearAndHide) {\r\n                    n._clearAndHide()\r\n                }\r\n            }, n.conf.tm_sec, \"JavaScript\")\r\n        }\r\n        var x = this;\r\n        if (n.conf.hide_tm[this.id]) {\r\n            window.clearTimeout(n.conf.hide_tm[this.id])\r\n        }\r\n        n.conf.hide_tm[this.id] = window.setTimeout(function() {\r\n            x._visible = false\r\n        }, 50)\r\n    }\r\n    ;\r\n    o.onclick = function(y) {\r\n        if (!n.checkEvent(\"onClick\") && n.itemPull[this.id][\"complex\"]) {\r\n            return\r\n        }\r\n        y = y || event;\r\n        y.cancelBubble = true;\r\n        if (y.preventDefault) {\r\n            y.preventDefault()\r\n        } else {\r\n            y.returnValue = false\r\n        }\r\n        tc = (n.itemPull[this.id][\"complex\"] ? \"c\" : \"-\");\r\n        td = (n.itemPull[this.id][\"state\"] == \"enabled\" ? \"-\" : \"d\");\r\n        var x = {\r\n            ctrl: y.ctrlKey,\r\n            alt: y.altKey,\r\n            shift: y.shiftKey\r\n        };\r\n        switch (n.itemPull[this.id][\"type\"]) {\r\n        case \"checkbox\":\r\n            n._checkboxOnClickHandler(this.id.replace(n.idPrefix, \"\"), tc + td + \"n\", x);\r\n            break;\r\n        case \"radio\":\r\n            n._radioOnClickHandler(this.id.replace(n.idPrefix, \"\"), tc + td + \"n\", x);\r\n            break;\r\n        case \"item\":\r\n            n._doOnClick(this.id.replace(n.idPrefix, \"\"), tc + td + \"n\", x);\r\n            break\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    var u = this.idPull[\"polygon_\" + this.itemPull[a][\"parent\"]];\r\n    if (r != null ) {\r\n        r++;\r\n        if (r < 0) {\r\n            r = 0\r\n        }\r\n        if (r > u.tbd.childNodes.length - 1) {\r\n            r = null \r\n        }\r\n    }\r\n    if (r != null  && u.tbd.childNodes[r] != null ) {\r\n        u.tbd.insertBefore(o, u.tbd.childNodes[r])\r\n    } else {\r\n        u.tbd.appendChild(o)\r\n    }\r\n    this.idPull[o.id] = o\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._renderSeparator = function(c, m) {\r\n    var a = (this.conf.context ? \"SubLevelArea\" : (this.itemPull[c][\"parent\"] == this.idPrefix + this.topId ? \"TopLevel\" : \"SubLevelArea\"));\r\n    if (a == \"TopLevel\" && this.conf.context) {\r\n        return\r\n    }\r\n    var h = this;\r\n    if (a != \"TopLevel\") {\r\n        var l = document.createElement(\"TR\");\r\n        l.className = \"sub_sep\";\r\n        var e = document.createElement(\"TD\");\r\n        e.colSpan = \"3\";\r\n        l.appendChild(e)\r\n    }\r\n    var g = document.createElement(\"DIV\");\r\n    g.id = \"separator_\" + c;\r\n    g.className = (a == \"TopLevel\" ? \"top_sep\" : \"sub_sep\");\r\n    g.onselectstart = function(r) {\r\n        r = r || event;\r\n        if (r.preventDefault) {\r\n            r.preventDefault()\r\n        } else {\r\n            r.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    g.onclick = function(s) {\r\n        s = s || event;\r\n        s.cancelBubble = true;\r\n        var r = {\r\n            ctrl: s.ctrlKey,\r\n            alt: s.altKey,\r\n            shift: s.shiftKey\r\n        };\r\n        h._doOnClick(this.id.replace(\"separator_\" + h.idPrefix, \"\"), \"--s\", r)\r\n    }\r\n    ;\r\n    if (a == \"TopLevel\") {\r\n        if (m != null ) {\r\n            m++;\r\n            if (m < 0) {\r\n                m = 0\r\n            }\r\n            if (this.cont.childNodes[m] != null ) {\r\n                this.cont.insertBefore(g, this.cont.childNodes[m])\r\n            } else {\r\n                this.cont.appendChild(g)\r\n            }\r\n        } else {\r\n            var o = this.cont.childNodes[this.cont.childNodes.length - 1];\r\n            if (String(o).search(\"TopLevel_Text\") == -1) {\r\n                this.cont.appendChild(g)\r\n            } else {\r\n                this.cont.insertBefore(g, o)\r\n            }\r\n        }\r\n        this.idPull[g.id] = g\r\n    } else {\r\n        var n = this.idPull[\"polygon_\" + this.itemPull[c][\"parent\"]];\r\n        if (m != null ) {\r\n            m++;\r\n            if (m < 0) {\r\n                m = 0\r\n            }\r\n            if (m > n.tbd.childNodes.length - 1) {\r\n                m = null \r\n            }\r\n        }\r\n        if (m != null  && n.tbd.childNodes[m] != null ) {\r\n            n.tbd.insertBefore(l, n.tbd.childNodes[m])\r\n        } else {\r\n            n.tbd.appendChild(l)\r\n        }\r\n        e.appendChild(g);\r\n        this.idPull[g.id] = l\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.addNewSeparator = function(a, c) {\r\n    c = this.idPrefix + (c != null  ? c : this._genStr(24));\r\n    var e = this.idPrefix + this.getParentId(a);\r\n    this._addItemIntoGlobalStrorage(c, e, \"\", \"separator\", false, \"\", \"\");\r\n    this._renderSeparator(c, this.getItemPosition(a))\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._initObj = function(s, u, m) {\r\n    if (!(s instanceof Array)) {\r\n        m = s.parentId;\r\n        if (m != null  && String(m).indexOf(this.idPrefix) !== 0) {\r\n            m = this.idPrefix + String(m)\r\n        }\r\n        s = s.items\r\n    }\r\n    for (var e = 0; e < s.length; e++) {\r\n        if (typeof (s[e].id) == \"undefined\" || s[e].id == null ) {\r\n            s[e].id = this._genStr(24)\r\n        }\r\n        if (s[e].text == null ) {\r\n            s[e].text = \"\"\r\n        }\r\n        if (String(s[e].id).indexOf(this.idPrefix) !== 0) {\r\n            s[e].id = this.idPrefix + String(s[e].id)\r\n        }\r\n        var g = {\r\n            type: \"item\",\r\n            tip: \"\",\r\n            hotkey: \"\",\r\n            state: \"enabled\",\r\n            imgen: \"\",\r\n            imgdis: \"\"\r\n        };\r\n        for (var v in g) {\r\n            if (typeof (s[e][v]) == \"undefined\") {\r\n                s[e][v] = g[v]\r\n            }\r\n        }\r\n        if (s[e].imgen == \"\" && s[e].img != null ) {\r\n            s[e].imgen = s[e].img\r\n        }\r\n        if (s[e].imgdis == \"\" && s[e].img_disabled != null ) {\r\n            s[e].imgdis = s[e].img_disabled\r\n        }\r\n        if (s[e].title == null  && s[e].text != null ) {\r\n            s[e].title = s[e].text\r\n        }\r\n        if (s[e].href != null ) {\r\n            if (s[e].href.link != null ) {\r\n                s[e].href_link = s[e].href.link\r\n            }\r\n            if (s[e].href.target != null ) {\r\n                s[e].href_target = s[e].href.target\r\n            }\r\n        }\r\n        if (s[e].userdata != null ) {\r\n            for (var v in s[e].userdata) {\r\n                this.userData[s[e].id + \"_\" + v] = s[e].userdata[v]\r\n            }\r\n        }\r\n        if (typeof (s[e].enabled) != \"undefined\" && window.dhx4.s2b(s[e].enabled) == false) {\r\n            s[e].state = \"disabled\"\r\n        } else {\r\n            if (typeof (s[e].disabled) != \"undefined\" && window.dhx4.s2b(s[e].disabled) == true) {\r\n                s[e].state = \"disabled\"\r\n            }\r\n        }\r\n        if (typeof (s[e].parent) == \"undefined\") {\r\n            s[e].parent = (m != null  ? m : this.idPrefix + this.topId)\r\n        }\r\n        if (s[e].type == \"checkbox\") {\r\n            s[e].checked = window.dhx4.s2b(s[e].checked);\r\n            s[e].imgen = s[e].imgdis = \"chbx_\" + (s[e].checked ? \"1\" : \"0\")\r\n        }\r\n        if (s[e].type == \"radio\") {\r\n            s[e].checked = window.dhx4.s2b(s[e].checked);\r\n            s[e].imgen = s[e].imgdis = \"rdbt_\" + (s[e].checked ? \"1\" : \"0\");\r\n            if (typeof (s[e].group) == \"undefined\" || s[e].group == null ) {\r\n                s[e].group = this._genStr(24)\r\n            }\r\n            if (this.radio[s[e].group] == null ) {\r\n                this.radio[s[e].group] = []\r\n            }\r\n            this.radio[s[e].group].push(s[e].id)\r\n        }\r\n        this.itemPull[s[e].id] = s[e];\r\n        if (s[e].items != null  && s[e].items.length > 0) {\r\n            this.itemPull[s[e].id].complex = true;\r\n            this._initObj(s[e].items, true, s[e].id)\r\n        } else {\r\n            if (this.conf.dload && s[e].complex == true) {\r\n                this.itemPull[s[e].id].loaded = \"no\"\r\n            }\r\n        }\r\n        this.itemPull[s[e].id].items = null \r\n    }\r\n    if (u !== true) {\r\n        if (this.conf.dload == true) {\r\n            if (m == null ) {\r\n                this._initTopLevelMenu()\r\n            } else {\r\n                this._addSubMenuPolygon(m, m);\r\n                if (this.conf.selected == m) {\r\n                    var r = (this.itemPull[m].parent == this.idPrefix + this.topId);\r\n                    var c = (r && !this.conf.context ? this.conf.dir_toplv : this.conf.dir_sublv);\r\n                    var h = false;\r\n                    if (r && this.conf.top_mode && this.conf.mode == \"web\" && !this.conf.context) {\r\n                        var w = this.idPull[m];\r\n                        if (w._mouseOver == true) {\r\n                            var l = this.conf.top_tmtime - (new Date().getTime() - w._dynLoadTM);\r\n                            if (l > 1) {\r\n                                var o = m;\r\n                                var n = this;\r\n                                w._menuOpenTM = window.setTimeout(function() {\r\n                                    n._showPolygon(o, c);\r\n                                    n = o = null \r\n                                }, l);\r\n                                h = true\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!h) {\r\n                        this._showPolygon(m, c)\r\n                    }\r\n                }\r\n                this.itemPull[m].loaded = \"yes\";\r\n                if (this.conf.dload_icon == true) {\r\n                    this._updateLoaderIcon(m, false)\r\n                }\r\n            }\r\n        } else {\r\n            this._init()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._xmlToJson = function(h, g) {\r\n    var m = [];\r\n    if (g == null ) {\r\n        var n = h.getElementsByTagName(this.conf.tags.root);\r\n        if (n == null  || (n != null  && n.length == 0)) {\r\n            return {\r\n                items: []\r\n            }\r\n        }\r\n        n = n[0]\r\n    } else {\r\n        n = h\r\n    }\r\n    if (n.getAttribute(\"parentId\") != null ) {\r\n        g = this.idPrefix + n.getAttribute(\"parentId\")\r\n    }\r\n    for (var c = 0; c < n.childNodes.length; c++) {\r\n        if (typeof (n.childNodes[c].tagName) != \"undefined\" && String(n.childNodes[c].tagName).toLowerCase() == this.conf.tags.item) {\r\n            var a = n.childNodes[c];\r\n            var u = {\r\n                id: this.idPrefix + (a.getAttribute(\"id\") || this._genStr(24)),\r\n                title: a.getAttribute(\"text\") || \"\",\r\n                imgen: a.getAttribute(\"img\") || \"\",\r\n                imgdis: a.getAttribute(\"imgdis\") || \"\",\r\n                tip: \"\",\r\n                hotkey: \"\",\r\n                type: a.getAttribute(\"type\") || \"item\"\r\n            };\r\n            if (a.getAttribute(\"cssNormal\") != null ) {\r\n                u.cssNormal = a.getAttribute(\"cssNormal\")\r\n            }\r\n            if (u.type == \"checkbox\") {\r\n                u.checked = a.getAttribute(\"checked\")\r\n            }\r\n            if (u.type == \"radio\") {\r\n                u.checked = a.getAttribute(\"checked\");\r\n                u.group = a.getAttribute(\"group\")\r\n            }\r\n            u.state = \"enabled\";\r\n            if (a.getAttribute(\"enabled\") != null  && window.dhx4.s2b(a.getAttribute(\"enabled\")) == false) {\r\n                u.state = \"disabled\"\r\n            } else {\r\n                if (a.getAttribute(\"disabled\") != null  && window.dhx4.s2b(a.getAttribute(\"disabled\")) == true) {\r\n                    u.state = \"disabled\"\r\n                }\r\n            }\r\n            u.parent = (g != null  ? g : this.idPrefix + this.topId);\r\n            if (this.conf.dload) {\r\n                u.complex = (a.getAttribute(\"complex\") != null );\r\n                if (u.complex) {\r\n                    u.loaded = \"no\"\r\n                }\r\n            } else {\r\n                var e = this._xmlToJson(a, u.id);\r\n                u.items = e.items;\r\n                u.complex = (u.items.length > 0)\r\n            }\r\n            for (var o = 0; o < a.childNodes.length; o++) {\r\n                if (typeof (a.childNodes[o].tagName) != \"undefined\") {\r\n                    var s = String(a.childNodes[o].tagName || \"\").toLowerCase();\r\n                    if (s == this.conf.tags.userdata) {\r\n                        var l = a.childNodes[o];\r\n                        if (l.getAttribute(\"name\") != null ) {\r\n                            this.userData[u.id + \"_\" + l.getAttribute(\"name\")] = (l.firstChild != null  && l.firstChild.nodeValue != null  ? l.firstChild.nodeValue : \"\")\r\n                        }\r\n                    }\r\n                    if (s == this.conf.tags.text_ext) {\r\n                        u.title = a.childNodes[o].firstChild.nodeValue\r\n                    }\r\n                    if (s == this.conf.tags.tooltip) {\r\n                        u.tip = a.childNodes[o].firstChild.nodeValue\r\n                    }\r\n                    if (s == this.conf.tags.hotkey) {\r\n                        u.hotkey = a.childNodes[o].firstChild.nodeValue\r\n                    }\r\n                    if (s == this.conf.tags.href && u.type == \"item\") {\r\n                        u.href_link = a.childNodes[o].firstChild.nodeValue;\r\n                        if (a.childNodes[o].getAttribute(\"target\") != null ) {\r\n                            u.href_target = a.childNodes[o].getAttribute(\"target\")\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            m.push(u)\r\n        }\r\n    }\r\n    var a = {\r\n        parentId: g,\r\n        items: m\r\n    };\r\n    return a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.enableDynamicLoading = function(a, c) {\r\n    this.conf.dload = true;\r\n    this.conf.dload_url = a;\r\n    this.conf.dload_sign = (String(this.conf.dload_url).search(/\\?/) == -1 ? \"?\" : \"&\");\r\n    this.conf.dload_icon = c;\r\n    this._init()\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._updateLoaderIcon = function(g, e) {\r\n    if (this.idPull[g] == null ) {\r\n        return\r\n    }\r\n    if (String(this.idPull[g].className).search(\"TopLevel_Item\") >= 0) {\r\n        return\r\n    }\r\n    var c = (this.conf.rtl ? 0 : 2);\r\n    if (!this.idPull[g].childNodes[c]) {\r\n        return\r\n    }\r\n    if (!this.idPull[g].childNodes[c].childNodes[0]) {\r\n        return\r\n    }\r\n    var a = this.idPull[g].childNodes[c].childNodes[0];\r\n    if (String(a.className).search(\"complex_arrow\") === 0) {\r\n        a.className = \"complex_arrow\" + (e ? \"_loading\" : \"\")\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.addNewSibling = function(g, h, a, c, e, n) {\r\n    var m = this.idPrefix + (h != null  ? h : this._genStr(24));\r\n    var l = this.idPrefix + (g != null  ? this.getParentId(g) : this.topId);\r\n    this._addItemIntoGlobalStrorage(m, l, a, \"item\", c, e, n);\r\n    if ((l == this.idPrefix + this.topId) && (!this.conf.context)) {\r\n        this._renderToplevelItem(m, this.getItemPosition(g))\r\n    } else {\r\n        this._renderSublevelItem(m, this.getItemPosition(g))\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.addNewChild = function(m, l, g, a, c, e, h) {\r\n    if (m == null ) {\r\n        if (this.conf.context) {\r\n            m = this.topId\r\n        } else {\r\n            this.addNewSibling(m, g, a, c, e, h);\r\n            if (l != null ) {\r\n                this.setItemPosition(g, l)\r\n            }\r\n            return\r\n        }\r\n    }\r\n    g = this.idPrefix + (g != null  ? g : this._genStr(24));\r\n    if (this.setHotKey) {\r\n        this.setHotKey(m, \"\")\r\n    }\r\n    m = this.idPrefix + m;\r\n    this._addItemIntoGlobalStrorage(g, m, a, \"item\", c, e, h);\r\n    if (this.idPull[\"polygon_\" + m] == null ) {\r\n        this._renderSublevelPolygon(m, m)\r\n    }\r\n    this._renderSublevelItem(g, l - 1);\r\n    this._redefineComplexState(m)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.removeItem = function(g, l, h) {\r\n    if (!l) {\r\n        g = this.idPrefix + g\r\n    }\r\n    var m = null ;\r\n    if (g != this.idPrefix + this.topId) {\r\n        if (this.itemPull[g] == null ) {\r\n            return\r\n        }\r\n        if (this.idPull[\"polygon_\" + g] && this.idPull[\"polygon_\" + g]._tmShow) {\r\n            window.clearTimeout(this.idPull[\"polygon_\" + g]._tmShow)\r\n        }\r\n        var u = this.itemPull[g][\"type\"];\r\n        if (u == \"separator\") {\r\n            var s = this.idPull[\"separator_\" + g];\r\n            if (this.itemPull[g][\"parent\"] == this.idPrefix + this.topId) {\r\n                s.onclick = null ;\r\n                s.onselectstart = null ;\r\n                s.id = null ;\r\n                s.parentNode.removeChild(s)\r\n            } else {\r\n                s.childNodes[0].childNodes[0].onclick = null ;\r\n                s.childNodes[0].childNodes[0].onselectstart = null ;\r\n                s.childNodes[0].childNodes[0].id = null ;\r\n                s.childNodes[0].removeChild(s.childNodes[0].childNodes[0]);\r\n                s.removeChild(s.childNodes[0]);\r\n                s.parentNode.removeChild(s)\r\n            }\r\n            this.idPull[\"separator_\" + g] = null ;\r\n            this.itemPull[g] = null ;\r\n            delete this.idPull[\"separator_\" + g];\r\n            delete this.itemPull[g];\r\n            s = null \r\n        } else {\r\n            m = this.itemPull[g][\"parent\"];\r\n            var s = this.idPull[g];\r\n            s.onclick = null ;\r\n            s.oncontextmenu = null ;\r\n            s.onmouseover = null ;\r\n            s.onmouseout = null ;\r\n            s.onselectstart = null ;\r\n            s.id = null ;\r\n            while (s.childNodes.length > 0) {\r\n                s.removeChild(s.childNodes[0])\r\n            }\r\n            s.parentNode.removeChild(s);\r\n            this.idPull[g] = null ;\r\n            this.itemPull[g] = null ;\r\n            delete this.idPull[g];\r\n            delete this.itemPull[g];\r\n            s = null \r\n        }\r\n        u = null \r\n    }\r\n    for (var o in this.itemPull) {\r\n        if (this.itemPull[o][\"parent\"] == g) {\r\n            this.removeItem(o, true, true)\r\n        }\r\n    }\r\n    var r = new Array(g);\r\n    if (m != null  && !h) {\r\n        if (this.idPull[\"polygon_\" + m] != null ) {\r\n            if (this.idPull[\"polygon_\" + m].tbd.childNodes.length == 0) {\r\n                r.push(m);\r\n                this._updateItemComplexState(m, false, false)\r\n            }\r\n        }\r\n    }\r\n    for (var c = 0; c < r.length; c++) {\r\n        if (this.idPull[\"polygon_\" + r[c]]) {\r\n            var e = this.idPull[\"polygon_\" + r[c]];\r\n            e.onclick = null ;\r\n            e.oncontextmenu = null ;\r\n            e.tbl.removeChild(e.tbd);\r\n            e.tbd = null ;\r\n            e.childNodes[1].removeChild(e.tbl);\r\n            e.tbl = null ;\r\n            e.id = null ;\r\n            e.parentNode.removeChild(e);\r\n            e = null ;\r\n            if (window.dhx4.isIE6) {\r\n                var n = \"polygon_\" + r[c] + \"_ie6cover\";\r\n                if (this.idPull[n] != null ) {\r\n                    document.body.removeChild(this.idPull[n]);\r\n                    delete this.idPull[n]\r\n                }\r\n            }\r\n            if (this.idPull[\"arrowup_\" + g] != null  && this._removeArrow) {\r\n                this._removeArrow(\"arrowup_\" + g)\r\n            }\r\n            if (this.idPull[\"arrowdown_\" + g] != null  && this._removeArrow) {\r\n                this._removeArrow(\"arrowdown_\" + g)\r\n            }\r\n            this.idPull[\"polygon_\" + r[c]] = null ;\r\n            delete this.idPull[\"polygon_\" + r[c]]\r\n        }\r\n    }\r\n    r = null ;\r\n    if (this.conf.skin == \"dhx_terrace\" && arguments.length == 1) {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._addItemIntoGlobalStrorage = function(n, a, e, m, g, c, l) {\r\n    var h = {\r\n        id: n,\r\n        title: e,\r\n        imgen: (c != null  ? c : \"\"),\r\n        imgdis: (l != null  ? l : \"\"),\r\n        type: m,\r\n        state: (g == true ? \"disabled\" : \"enabled\"),\r\n        parent: a,\r\n        complex: false,\r\n        hotkey: \"\",\r\n        tip: \"\"\r\n    };\r\n    this.itemPull[h.id] = h\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.renderAsContextMenu = function() {\r\n    this.conf.context = true;\r\n    if (this.base._autoSkinUpdate == true) {\r\n        this.base.className = this.base.className.replace(\"dhtmlxMenu_\" + this.conf.skin + \"_Middle\", \"\");\r\n        this.base._autoSkinUpdate = false\r\n    }\r\n    if (this.conf.ctx_baseid != null ) {\r\n        this.addContextZone(this.conf.ctx_baseid)\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.addContextZone = function(c) {\r\n    if (c == document.body) {\r\n        c = \"document.body.\" + this.idPrefix;\r\n        var g = document.body\r\n    } else {\r\n        if (typeof (c) == \"string\") {\r\n            var g = document.getElementById(c)\r\n        } else {\r\n            var g = c\r\n        }\r\n    }\r\n    var l = false;\r\n    for (var e in this.conf.ctx_zones) {\r\n        l = l || (e == c) || (this.conf.ctx_zones[e] == g)\r\n    }\r\n    if (l == true) {\r\n        return false\r\n    }\r\n    this.conf.ctx_zones[c] = g;\r\n    var h = this;\r\n    if (window.dhx4.isOpera) {\r\n        this.operaContext = function(a) {\r\n            h._doOnContextMenuOpera(a, h)\r\n        }\r\n        ;\r\n        g.addEventListener(\"mouseup\", this.operaContext, false)\r\n    } else {\r\n        if (g.oncontextmenu != null  && !g._oldContextMenuHandler) {\r\n            g._oldContextMenuHandler = g.oncontextmenu\r\n        }\r\n        g.oncontextmenu = function(m) {\r\n            for (var a in dhtmlXMenuObject.prototype.liveInst) {\r\n                if (a != h.conf.live_id) {\r\n                    if (dhtmlXMenuObject.prototype.liveInst[a].context) {\r\n                        dhtmlXMenuObject.prototype.liveInst[a]._hideContextMenu()\r\n                    }\r\n                }\r\n            }\r\n            m = m || event;\r\n            m.cancelBubble = true;\r\n            if (m.preventDefault) {\r\n                m.preventDefault()\r\n            } else {\r\n                m.returnValue = false\r\n            }\r\n            h._doOnContextBeforeCall(m, this);\r\n            return false\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._doOnContextMenuOpera = function(g, a) {\r\n    for (var c in dhtmlXMenuObject.prototype.liveInst) {\r\n        if (c != a.conf.live_id) {\r\n            if (dhtmlXMenuObject.prototype.liveInst[c].context) {\r\n                dhtmlXMenuObject.prototype.liveInst[c]._hideContextMenu()\r\n            }\r\n        }\r\n    }\r\n    g.cancelBubble = true;\r\n    if (g.preventDefault) {\r\n        g.preventDefault()\r\n    } else {\r\n        g.returnValue = false\r\n    }\r\n    if (g.button == 0 && g.ctrlKey == true) {\r\n        a._doOnContextBeforeCall(g, this)\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.removeContextZone = function(a) {\r\n    if (!this.isContextZone(a)) {\r\n        return false\r\n    }\r\n    if (a == document.body) {\r\n        a = \"document.body.\" + this.idPrefix\r\n    }\r\n    var c = this.conf.ctx_zones[a];\r\n    if (window.dhx4.isOpera) {\r\n        c.removeEventListener(\"mouseup\", this.operaContext, false)\r\n    } else {\r\n        c.oncontextmenu = (c._oldContextMenuHandler != null  ? c._oldContextMenuHandler : null );\r\n        c._oldContextMenuHandler = null \r\n    }\r\n    try {\r\n        this.conf.ctx_zones[a] = null ;\r\n        delete this.conf.ctx_zones[a]\r\n    } catch (g) {}\r\n    return true\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.isContextZone = function(a) {\r\n    if (a == document.body && this.conf.ctx_zones[\"document.body.\" + this.idPrefix] != null ) {\r\n        return true\r\n    }\r\n    var c = false;\r\n    if (this.conf.ctx_zones[a] != null ) {\r\n        if (this.conf.ctx_zones[a] == document.getElementById(a)) {\r\n            c = true\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._isContextMenuVisible = function() {\r\n    if (this.idPull[\"polygon_\" + this.idPrefix + this.topId] == null ) {\r\n        return false\r\n    }\r\n    return ( this.idPull[\"polygon_\" + this.idPrefix + this.topId].style.display == \"\") \r\n}\r\n;\r\ndhtmlXMenuObject.prototype._showContextMenu = function(c, e, a) {\r\n    this._clearAndHide();\r\n    if (this.idPull[\"polygon_\" + this.idPrefix + this.topId] == null ) {\r\n        return false\r\n    }\r\n    window.clearTimeout(this.conf.tm_handler);\r\n    this.idPull[this.idPrefix + this.topId] = new Array(c,e);\r\n    this._showPolygon(this.idPrefix + this.topId, \"bottom\");\r\n    this.callEvent(\"onContextMenu\", [a])\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._hideContextMenu = function() {\r\n    if (this.idPull[\"polygon_\" + this.idPrefix + this.topId] == null ) {\r\n        return false\r\n    }\r\n    this._clearAndHide();\r\n    this._hidePolygon(this.idPrefix + this.topId)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._doOnContextBeforeCall = function(l, n) {\r\n    this.conf.ctx_zoneid = n.id;\r\n    this._clearAndHide();\r\n    this._hideContextMenu();\r\n    if (window.dhx4.isChrome == true || window.dhx4.isEdge == true || window.dhx4.isOpera == true || window.dhx4.isIE11 == true) {\r\n        var m = window.dhx4.absLeft(l.currentTarget) + l.offsetX;\r\n        var h = window.dhx4.absTop(l.currentTarget) + l.offsetY\r\n    } else {\r\n        if (window.dhx4.isIE6 == true || window.dhx4.isIE7 == true || window.dhx4.isIE == true) {\r\n            var m = window.dhx4.absLeft(l.srcElement) + l.x || 0;\r\n            var h = window.dhx4.absTop(l.srcElement) + l.y || 0\r\n        } else {\r\n            var g = (l.srcElement || l.target);\r\n            var c = (window.dhx4.isIE || window.dhx4.isKHTML ? l.offsetX : l.layerX);\r\n            var a = (window.dhx4.isIE || window.dhx4.isKHTML ? l.offsetY : l.layerY);\r\n            var m = window.dhx4.absLeft(g) + c;\r\n            var h = window.dhx4.absTop(g) + a\r\n        }\r\n    }\r\n    if (this.checkEvent(\"onBeforeContextMenu\")) {\r\n        if (this.callEvent(\"onBeforeContextMenu\", [n.id, l])) {\r\n            if (this.conf.ctx_autoshow) {\r\n                this._showContextMenu(m, h, n.id);\r\n                this.callEvent(\"onAfterContextMenu\", [n.id, l])\r\n            }\r\n        }\r\n    } else {\r\n        if (this.conf.ctx_autoshow) {\r\n            this._showContextMenu(m, h, n.id);\r\n            this.callEvent(\"onAfterContextMenu\", [n.id])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.showContextMenu = function(a, c) {\r\n    this._showContextMenu(a, c, false)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.hideContextMenu = function() {\r\n    this._hideContextMenu()\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setAutoShowMode = function(a) {\r\n    this.conf.ctx_autoshow = (a == true ? true : false)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setAutoHideMode = function(a) {\r\n    this.conf.ctx_autohide = (a == true ? true : false)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setContextMenuHideAllMode = function(a) {\r\n    this.conf.ctx_hideall = (a == true ? true : false)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getContextMenuHideAllMode = function() {\r\n    return this.conf.ctx_hideall\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._improveTerraceSkin = function() {\r\n    for (var e in this.itemPull) {\r\n        if (this.itemPull[e].parent == this.idPrefix + this.topId && this.idPull[e] != null ) {\r\n            var h = false;\r\n            var g = false;\r\n            if (this.idPull[e].parentNode.firstChild == this.idPull[e]) {\r\n                h = true\r\n            }\r\n            if (this.idPull[e].parentNode.lastChild == this.idPull[e]) {\r\n                g = true\r\n            }\r\n            for (var c in this.itemPull) {\r\n                if (this.itemPull[c].type == \"separator\" && this.itemPull[c].parent == this.idPrefix + this.topId) {\r\n                    if (this.idPull[e].nextSibling == this.idPull[\"separator_\" + c]) {\r\n                        g = true\r\n                    }\r\n                    if (this.idPull[e].previousSibling == this.idPull[\"separator_\" + c]) {\r\n                        h = true\r\n                    }\r\n                }\r\n            }\r\n            this.idPull[e].style.borderLeftWidth = (h ? \"1px\" : \"0px\");\r\n            this.idPull[e].style.borderTopLeftRadius = this.idPull[e].style.borderBottomLeftRadius = (h ? \"3px\" : \"0px\");\r\n            this.idPull[e].style.borderTopRightRadius = this.idPull[e].style.borderBottomRightRadius = (g ? \"3px\" : \"0px\");\r\n            this.idPull[e]._bl = h;\r\n            this.idPull[e]._br = g\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._improveTerraceButton = function(c, a) {\r\n    if (a) {\r\n        this.idPull[c].style.borderBottomLeftRadius = (this.idPull[c]._bl ? \"3px\" : \"0px\");\r\n        this.idPull[c].style.borderBottomRightRadius = (this.idPull[c]._br ? \"3px\" : \"0px\")\r\n    } else {\r\n        this.idPull[c].style.borderBottomLeftRadius = \"0px\";\r\n        this.idPull[c].style.borderBottomRightRadius = \"0px\"\r\n    }\r\n}\r\n;\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype._createNode_menu = function(h, c, g, a, e) {\r\n        if (typeof (e) != \"undefined\") {\r\n            h = e\r\n        } else {\r\n            h = document.createElement(\"DIV\");\r\n            h.className = \"dhx_cell_menu_\" + (this.conf.borders ? \"def\" : \"no_borders\");\r\n            h.appendChild(document.createElement(\"DIV\"))\r\n        }\r\n        this.cell.insertBefore(h, this.cell.childNodes[this.conf.idx.toolbar || this.conf.idx.cont]);\r\n        this.conf.ofs_nodes.t.menu = true;\r\n        this._updateIdx();\r\n        return h\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.attachMenu = function(a) {\r\n        if (this.dataNodes.menu) {\r\n            return\r\n        }\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"menu\"]);\r\n        if (typeof (a) == \"undefined\") {\r\n            a = {}\r\n        }\r\n        if (typeof (a.skin) == \"undefined\") {\r\n            a.skin = this.conf.skin\r\n        }\r\n        a.parent = this._attachObject(\"menu\").firstChild;\r\n        this.dataNodes.menu = new dhtmlXMenuObject(a);\r\n        this._adjustCont(this._idd);\r\n        a.parent = null ;\r\n        a = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataNodes.menu\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.detachMenu = function() {\r\n        if (!this.dataNodes.menu) {\r\n            return\r\n        }\r\n        this.dataNodes.menu.unload();\r\n        this.dataNodes.menu = null ;\r\n        delete this.dataNodes.menu;\r\n        this._detachObject(\"menu\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.showMenu = function() {\r\n        this._mtbShowHide(\"menu\", \"\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.hideMenu = function() {\r\n        this._mtbShowHide(\"menu\", \"none\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.getAttachedMenu = function() {\r\n        return this.dataNodes.menu\r\n    }\r\n}\r\ndhtmlXMenuObject.prototype.setItemEnabled = function(a) {\r\n    this._changeItemState(a, \"enabled\", this._getItemLevelType(a))\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setItemDisabled = function(a) {\r\n    this._changeItemState(a, \"disabled\", this._getItemLevelType(a))\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.isItemEnabled = function(a) {\r\n    return ( this.itemPull[this.idPrefix + a] != null  ? (this.itemPull[this.idPrefix + a][\"state\"] == \"enabled\") : false) \r\n}\r\n;\r\ndhtmlXMenuObject.prototype._changeItemState = function(h, g, c) {\r\n    var e = false;\r\n    var a = this.idPrefix + h;\r\n    if ((this.itemPull[a] != null ) && (this.idPull[a] != null )) {\r\n        if (this.itemPull[a][\"state\"] != g) {\r\n            this.itemPull[a][\"state\"] = g;\r\n            if (this.itemPull[a][\"parent\"] == this.idPrefix + this.topId && !this.conf.context) {\r\n                this.idPull[a].className = \"dhtmlxMenu_\" + this.conf.skin + \"_TopLevel_Item_\" + (this.itemPull[a][\"state\"] == \"enabled\" ? \"Normal\" : \"Disabled\")\r\n            } else {\r\n                this.idPull[a].className = \"sub_item\" + (this.itemPull[a][\"state\"] == \"enabled\" ? \"\" : \"_dis\")\r\n            }\r\n            this._updateItemComplexState(this.idPrefix + h, this.itemPull[this.idPrefix + h][\"complex\"], false);\r\n            this._updateItemImage(h, c);\r\n            if ((this.idPrefix + this.conf.last_click == a) && (c != \"TopLevel\")) {\r\n                this._redistribSubLevelSelection(a, this.itemPull[a][\"parent\"])\r\n            }\r\n            if (c == \"TopLevel\" && !this.conf.context) {}\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getItemText = function(a) {\r\n    return ( this.itemPull[this.idPrefix + a] != null  ? this.itemPull[this.idPrefix + a][\"title\"] : \"\") \r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setItemText = function(l, h) {\r\n    l = this.idPrefix + l;\r\n    if ((this.itemPull[l] != null ) && (this.idPull[l] != null )) {\r\n        this._clearAndHide();\r\n        this.itemPull[l][\"title\"] = h;\r\n        if (this.itemPull[l][\"parent\"] == this.idPrefix + this.topId && !this.conf.context) {\r\n            var g = null ;\r\n            for (var a = 0; a < this.idPull[l].childNodes.length; a++) {\r\n                try {\r\n                    if (this.idPull[l].childNodes[a].className == \"top_level_text\") {\r\n                        g = this.idPull[l].childNodes[a]\r\n                    }\r\n                } catch (c) {}\r\n            }\r\n            if (String(this.itemPull[l][\"title\"]).length == \"\" || this.itemPull[l][\"title\"] == null ) {\r\n                if (g != null ) {\r\n                    g.parentNode.removeChild(g)\r\n                }\r\n            } else {\r\n                if (!g) {\r\n                    g = document.createElement(\"DIV\");\r\n                    g.className = \"top_level_text\";\r\n                    if (this.conf.rtl && this.idPull[l].childNodes.length > 0) {\r\n                        this.idPull[l].insertBefore(g, this.idPull[l].childNodes[0])\r\n                    } else {\r\n                        this.idPull[l].appendChild(g)\r\n                    }\r\n                }\r\n                g.innerHTML = this.itemPull[l][\"title\"]\r\n            }\r\n        } else {\r\n            var g = null ;\r\n            for (var a = 0; a < this.idPull[l].childNodes[1].childNodes.length; a++) {\r\n                if (String(this.idPull[l].childNodes[1].childNodes[a].className || \"\") == \"sub_item_text\") {\r\n                    g = this.idPull[l].childNodes[1].childNodes[a]\r\n                }\r\n            }\r\n            if (String(this.itemPull[l][\"title\"]).length == \"\" || this.itemPull[l][\"title\"] == null ) {\r\n                if (g) {\r\n                    g.parentNode.removeChild(g);\r\n                    g = null ;\r\n                    this.idPull[l].childNodes[1].innerHTML = \"&nbsp;\"\r\n                }\r\n            } else {\r\n                if (!g) {\r\n                    g = document.createElement(\"DIV\");\r\n                    g.className = \"sub_item_text\";\r\n                    this.idPull[l].childNodes[1].innerHTML = \"\";\r\n                    this.idPull[l].childNodes[1].appendChild(g)\r\n                }\r\n                g.innerHTML = this.itemPull[l][\"title\"]\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.loadFromHTML = function(e, l, g) {\r\n    var c = this.conf.tags.item;\r\n    this.conf.tags.item = \"div\";\r\n    var h = (typeof (e) == \"string\" ? document.getElementById(e) : e);\r\n    var a = this._xmlToJson(h, this.idPrefix + this.topId);\r\n    this._initObj(a);\r\n    this.conf.tags.item = c;\r\n    if (l) {\r\n        h.parentNode.removeChild(h)\r\n    }\r\n    h = objOd = null ;\r\n    if (onload != null ) {\r\n        if (typeof (g) == \"function\") {\r\n            g()\r\n        } else {\r\n            if (typeof (window[g]) == \"function\") {\r\n                window[g]()\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.hideItem = function(a) {\r\n    this._changeItemVisible(a, false)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.showItem = function(a) {\r\n    this._changeItemVisible(a, true)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.isItemHidden = function(c) {\r\n    var a = null ;\r\n    if (this.idPull[this.idPrefix + c] != null ) {\r\n        a = (this.idPull[this.idPrefix + c].style.display == \"none\")\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._changeItemVisible = function(e, c) {\r\n    var a = this.idPrefix + e;\r\n    if (this.itemPull[a] == null ) {\r\n        return\r\n    }\r\n    if (this.itemPull[a][\"type\"] == \"separator\") {\r\n        a = \"separator_\" + a\r\n    }\r\n    if (this.idPull[a] == null ) {\r\n        return\r\n    }\r\n    this.idPull[a].style.display = (c ? \"\" : \"none\");\r\n    this._redefineComplexState(this.itemPull[this.idPrefix + e][\"parent\"])\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setUserData = function(e, a, c) {\r\n    this.userData[this.idPrefix + e + \"_\" + a] = c\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getUserData = function(c, a) {\r\n    return ( this.userData[this.idPrefix + c + \"_\" + a] != null  ? this.userData[this.idPrefix + c + \"_\" + a] : null ) \r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setOpenMode = function(a) {\r\n    this.conf.mode = (a == \"win\" ? \"win\" : \"web\")\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setWebModeTimeout = function(a) {\r\n    this.conf.tm_sec = (!isNaN(a) ? a : 400)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getItemImage = function(c) {\r\n    var a = new Array(null ,null );\r\n    c = this.idPrefix + c;\r\n    if (this.itemPull[c][\"type\"] == \"item\") {\r\n        a[0] = this.itemPull[c][\"imgen\"];\r\n        a[1] = this.itemPull[c][\"imgdis\"]\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setItemImage = function(e, a, c) {\r\n    if (this.itemPull[this.idPrefix + e][\"type\"] != \"item\") {\r\n        return\r\n    }\r\n    this.itemPull[this.idPrefix + e][\"imgen\"] = a;\r\n    this.itemPull[this.idPrefix + e][\"imgdis\"] = c;\r\n    this._updateItemImage(e, this._getItemLevelType(e))\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.clearItemImage = function(a) {\r\n    this.setItemImage(a, \"\", \"\")\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setVisibleArea = function(c, a, g, e) {\r\n    this.conf.v_enabled = true;\r\n    this.conf.v.x1 = c;\r\n    this.conf.v.x2 = a;\r\n    this.conf.v.y1 = g;\r\n    this.conf.v.y2 = e\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setTooltip = function(c, a) {\r\n    c = this.idPrefix + c;\r\n    if (!(this.itemPull[c] != null  && this.idPull[c] != null )) {\r\n        return\r\n    }\r\n    this.idPull[c].title = (a.length > 0 ? a : null );\r\n    this.itemPull[c][\"tip\"] = a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getTooltip = function(a) {\r\n    if (this.itemPull[this.idPrefix + a] == null ) {\r\n        return null \r\n    }\r\n    return this.itemPull[this.idPrefix + a][\"tip\"]\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setTopText = function(a) {\r\n    if (this.conf.context) {\r\n        return\r\n    }\r\n    if (this._topText == null ) {\r\n        this._topText = document.createElement(\"DIV\");\r\n        this._topText.className = \"dhtmlxMenu_TopLevel_Text_\" + (this.conf.rtl ? \"left\" : (this.conf.align == \"left\" ? \"right\" : \"left\"));\r\n        this.base.appendChild(this._topText)\r\n    }\r\n    this._topText.innerHTML = a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setAlign = function(a) {\r\n    if (this.conf.align == a) {\r\n        return\r\n    }\r\n    if (a == \"left\" || a == \"right\") {\r\n        this.conf.align = a;\r\n        if (this.cont) {\r\n            this.cont.className = (this.conf.align == \"right\" ? \"align_right\" : \"align_left\")\r\n        }\r\n        if (this._topText != null ) {\r\n            this._topText.className = \"dhtmlxMenu_TopLevel_Text_\" + (this.conf.align == \"left\" ? \"right\" : \"left\")\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setHref = function(e, a, c) {\r\n    if (this.itemPull[this.idPrefix + e] == null ) {\r\n        return\r\n    }\r\n    this.itemPull[this.idPrefix + e][\"href_link\"] = a;\r\n    if (c != null ) {\r\n        this.itemPull[this.idPrefix + e][\"href_target\"] = c\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.clearHref = function(a) {\r\n    if (this.itemPull[this.idPrefix + a] == null ) {\r\n        return\r\n    }\r\n    delete this.itemPull[this.idPrefix + a][\"href_link\"];\r\n    delete this.itemPull[this.idPrefix + a][\"href_target\"]\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getCircuit = function(c) {\r\n    var a = new Array(c);\r\n    while (this.getParentId(c) != this.topId) {\r\n        c = this.getParentId(c);\r\n        a[a.length] = c\r\n    }\r\n    return a.reverse()\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._getCheckboxState = function(a) {\r\n    if (this.itemPull[this.idPrefix + a] == null ) {\r\n        return null \r\n    }\r\n    return this.itemPull[this.idPrefix + a][\"checked\"]\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._setCheckboxState = function(c, a) {\r\n    if (this.itemPull[this.idPrefix + c] == null ) {\r\n        return\r\n    }\r\n    this.itemPull[this.idPrefix + c][\"checked\"] = a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._updateCheckboxImage = function(c) {\r\n    if (this.idPull[this.idPrefix + c] == null ) {\r\n        return\r\n    }\r\n    this.itemPull[this.idPrefix + c][\"imgen\"] = \"chbx_\" + (this._getCheckboxState(c) ? \"1\" : \"0\");\r\n    this.itemPull[this.idPrefix + c][\"imgdis\"] = this.itemPull[this.idPrefix + c][\"imgen\"];\r\n    try {\r\n        this.idPull[this.idPrefix + c].childNodes[(this.conf.rtl ? 2 : 0)].childNodes[0].className = \"sub_icon \" + this.itemPull[this.idPrefix + c][\"imgen\"]\r\n    } catch (a) {}\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._checkboxOnClickHandler = function(g, a, c) {\r\n    if (a.charAt(1) == \"d\") {\r\n        return\r\n    }\r\n    if (this.itemPull[this.idPrefix + g] == null ) {\r\n        return\r\n    }\r\n    var e = this._getCheckboxState(g);\r\n    if (this.checkEvent(\"onCheckboxClick\")) {\r\n        if (this.callEvent(\"onCheckboxClick\", [g, e, this.conf.ctx_zoneid, c])) {\r\n            this.setCheckboxState(g, !e)\r\n        }\r\n    } else {\r\n        this.setCheckboxState(g, !e)\r\n    }\r\n    if (this.checkEvent(\"onClick\")) {\r\n        this.callEvent(\"onClick\", [g])\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setCheckboxState = function(c, a) {\r\n    this._setCheckboxState(c, a);\r\n    this._updateCheckboxImage(c)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getCheckboxState = function(a) {\r\n    return this._getCheckboxState(a)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.addCheckbox = function(n, g, o, r, s, a, h) {\r\n    if (this.conf.context && g == this.topId) {} else {\r\n        if (this.itemPull[this.idPrefix + g] == null ) {\r\n            return\r\n        }\r\n        if (n == \"child\" && this.itemPull[this.idPrefix + g][\"type\"] != \"item\") {\r\n            return\r\n        }\r\n    }\r\n    var l = \"chbx_\" + (a ? \"1\" : \"0\");\r\n    var e = l;\r\n    if (n == \"sibling\") {\r\n        var c = this.idPrefix + (r != null  ? r : this._genStr(24));\r\n        var m = this.idPrefix + this.getParentId(g);\r\n        this._addItemIntoGlobalStrorage(c, m, s, \"checkbox\", h, l, e);\r\n        this.itemPull[c][\"checked\"] = a;\r\n        this._renderSublevelItem(c, this.getItemPosition(g))\r\n    } else {\r\n        var c = this.idPrefix + (r != null  ? r : this._genStr(24));\r\n        var m = this.idPrefix + g;\r\n        this._addItemIntoGlobalStrorage(c, m, s, \"checkbox\", h, l, e);\r\n        this.itemPull[c][\"checked\"] = a;\r\n        if (this.idPull[\"polygon_\" + m] == null ) {\r\n            this._renderSublevelPolygon(m, m)\r\n        }\r\n        this._renderSublevelItem(c, o - 1);\r\n        this._redefineComplexState(m)\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setHotKey = function(m, a) {\r\n    m = this.idPrefix + m;\r\n    if (!(this.itemPull[m] != null  && this.idPull[m] != null )) {\r\n        return\r\n    }\r\n    if (this.itemPull[m][\"parent\"] == this.idPrefix + this.topId && !this.conf.context) {\r\n        return\r\n    }\r\n    if (this.itemPull[m][\"complex\"]) {\r\n        return\r\n    }\r\n    var c = this.itemPull[m][\"type\"];\r\n    if (!(c == \"item\" || c == \"checkbox\" || c == \"radio\")) {\r\n        return\r\n    }\r\n    var l = null ;\r\n    try {\r\n        if (this.idPull[m].childNodes[this.conf.rtl ? 0 : 2].childNodes[0].className == \"sub_item_hk\") {\r\n            l = this.idPull[m].childNodes[this.conf.rtl ? 0 : 2].childNodes[0]\r\n        }\r\n    } catch (h) {}\r\n    if (a.length == 0) {\r\n        this.itemPull[m][\"hotkey_backup\"] = this.itemPull[m][\"hotkey\"];\r\n        this.itemPull[m][\"hotkey\"] = \"\";\r\n        if (l != null ) {\r\n            l.parentNode.removeChild(l)\r\n        }\r\n    } else {\r\n        this.itemPull[m][\"hotkey\"] = a;\r\n        this.itemPull[m][\"hotkey_backup\"] = null ;\r\n        if (l == null ) {\r\n            l = document.createElement(\"DIV\");\r\n            l.className = \"sub_item_hk\";\r\n            var g = this.idPull[m].childNodes[this.conf.rtl ? 0 : 2];\r\n            while (g.childNodes.length > 0) {\r\n                g.removeChild(g.childNodes[0])\r\n            }\r\n            g.appendChild(l)\r\n        }\r\n        l.innerHTML = a\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getHotKey = function(a) {\r\n    if (this.itemPull[this.idPrefix + a] == null ) {\r\n        return null \r\n    }\r\n    return this.itemPull[this.idPrefix + a][\"hotkey\"]\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon = function(a) {\r\n    var e = this._getSubItemToDeselectByPolygon(a);\r\n    for (var c = 0; c < this.conf.opened_poly.length; c++) {\r\n        if (this.conf.opened_poly[c] != a) {\r\n            this._hidePolygon(this.conf.opened_poly[c])\r\n        }\r\n    }\r\n    for (var c = 0; c < e.length; c++) {\r\n        if (this.idPull[e[c]] != null  && this.itemPull[e[c]][\"state\"] == \"enabled\") {\r\n            this.idPull[e[c]].className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_Item_Normal\"\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._checkArrowsState = function(g) {\r\n    var c = this.idPull[\"polygon_\" + g].childNodes[1];\r\n    var e = this.idPull[\"arrowup_\" + g];\r\n    var a = this.idPull[\"arrowdown_\" + g];\r\n    if (c.scrollTop == 0) {\r\n        e.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_ArrowUp_Disabled\"\r\n    } else {\r\n        e.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_ArrowUp\" + (e.over ? \"_Over\" : \"\")\r\n    }\r\n    if (c.scrollTop + c.offsetHeight < c.scrollHeight) {\r\n        a.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_ArrowDown\" + (a.over ? \"_Over\" : \"\")\r\n    } else {\r\n        a.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_ArrowDown_Disabled\"\r\n    }\r\n    c = e = a = null \r\n}\r\n;\r\ndhtmlXMenuObject.prototype._addUpArrow = function(g) {\r\n    var c = this;\r\n    var e = document.createElement(\"DIV\");\r\n    e.pId = this.idPrefix + g;\r\n    e.id = \"arrowup_\" + this.idPrefix + g;\r\n    e.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_ArrowUp\";\r\n    e.over = false;\r\n    e.onselectstart = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    e.oncontextmenu = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    e.onmouseover = function() {\r\n        if (c.conf.mode == \"web\") {\r\n            window.clearTimeout(c.conf.tm_handler)\r\n        }\r\n        c._clearAllSelectedSubItemsInPolygon(this.pId);\r\n        if (this.className == \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowUp_Disabled\") {\r\n            return\r\n        }\r\n        this.className = \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowUp_Over\";\r\n        this.over = true;\r\n        c._canScrollUp = true;\r\n        c._doScrollUp(this.pId, true)\r\n    }\r\n    ;\r\n    e.onmouseout = function() {\r\n        if (c.conf.mode == \"web\") {\r\n            window.clearTimeout(c.conf.tm_handler);\r\n            c.conf.tm_handler = window.setTimeout(function() {\r\n                c._clearAndHide()\r\n            }, c.conf.tm_sec, \"JavaScript\")\r\n        }\r\n        this.over = false;\r\n        c._canScrollUp = false;\r\n        if (this.className == \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowUp_Disabled\") {\r\n            return\r\n        }\r\n        this.className = \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowUp\";\r\n        window.clearTimeout(c.conf.of_utm)\r\n    }\r\n    ;\r\n    e.onclick = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        h.cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    var a = this.idPull[\"polygon_\" + this.idPrefix + g];\r\n    a.childNodes[0].appendChild(e);\r\n    this.idPull[e.id] = e;\r\n    a = e = null \r\n}\r\n;\r\ndhtmlXMenuObject.prototype._addDownArrow = function(g) {\r\n    var c = this;\r\n    var e = document.createElement(\"DIV\");\r\n    e.pId = this.idPrefix + g;\r\n    e.id = \"arrowdown_\" + this.idPrefix + g;\r\n    e.className = \"dhtmlxMenu_\" + this.conf.skin + \"_SubLevelArea_ArrowDown\";\r\n    e.over = false;\r\n    e.onselectstart = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    e.oncontextmenu = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    e.onmouseover = function() {\r\n        if (c.conf.mode == \"web\") {\r\n            window.clearTimeout(c.conf.tm_handler)\r\n        }\r\n        c._clearAllSelectedSubItemsInPolygon(this.pId);\r\n        if (this.className == \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowDown_Disabled\") {\r\n            return\r\n        }\r\n        this.className = \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowDown_Over\";\r\n        this.over = true;\r\n        c._canScrollDown = true;\r\n        c._doScrollDown(this.pId, true)\r\n    }\r\n    ;\r\n    e.onmouseout = function() {\r\n        if (c.conf.mode == \"web\") {\r\n            window.clearTimeout(c.conf.tm_handler);\r\n            c.conf.tm_handler = window.setTimeout(function() {\r\n                c._clearAndHide()\r\n            }, c.conf.tm_sec, \"JavaScript\")\r\n        }\r\n        this.over = false;\r\n        c._canScrollDown = false;\r\n        if (this.className == \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowDown_Disabled\") {\r\n            return\r\n        }\r\n        this.className = \"dhtmlxMenu_\" + c.conf.skin + \"_SubLevelArea_ArrowDown\";\r\n        window.clearTimeout(c.conf.of_dtm)\r\n    }\r\n    ;\r\n    e.onclick = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        h.cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    var a = this.idPull[\"polygon_\" + this.idPrefix + g];\r\n    a.childNodes[2].appendChild(e);\r\n    this.idPull[e.id] = e;\r\n    a = e = null \r\n}\r\n;\r\ndhtmlXMenuObject.prototype._removeUpArrow = function(c) {\r\n    var a = \"arrowup_\" + this.idPrefix + c;\r\n    this._removeArrow(a)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._removeDownArrow = function(c) {\r\n    var a = \"arrowdown_\" + this.idPrefix + c;\r\n    this._removeArrow(a)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._removeArrow = function(a) {\r\n    var c = this.idPull[a];\r\n    c.onselectstart = null ;\r\n    c.oncontextmenu = null ;\r\n    c.onmouseover = null ;\r\n    c.onmouseout = null ;\r\n    c.onclick = null ;\r\n    if (c.parentNode) {\r\n        c.parentNode.removeChild(c)\r\n    }\r\n    c = null ;\r\n    this.idPull[a] = null ;\r\n    try {\r\n        delete this.idPull[a]\r\n    } catch (g) {}\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._isArrowExists = function(a) {\r\n    if (this.idPull[\"arrowup_\" + a] != null  && this.idPull[\"arrowdown_\" + a] != null ) {\r\n        return true\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._doScrollUp = function(l, g) {\r\n    var a = this.idPull[\"polygon_\" + l].childNodes[1];\r\n    if (this._canScrollUp && a.scrollTop > 0) {\r\n        var e = false;\r\n        var h = a.scrollTop - this.conf.of_ustep;\r\n        if (h < 0) {\r\n            e = true;\r\n            h = 0\r\n        }\r\n        a.scrollTop = h;\r\n        if (!e) {\r\n            var c = this;\r\n            this.conf.of_utm = window.setTimeout(function() {\r\n                c._doScrollUp(l, false);\r\n                c = null \r\n            }, this.conf.of_utime)\r\n        } else {\r\n            g = true\r\n        }\r\n    } else {\r\n        this._canScrollUp = false;\r\n        this._checkArrowsState(l)\r\n    }\r\n    if (g) {\r\n        this._checkArrowsState(l)\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._doScrollDown = function(l, g) {\r\n    var a = this.idPull[\"polygon_\" + l].childNodes[1];\r\n    if (this._canScrollDown && a.scrollTop + a.offsetHeight <= a.scrollHeight) {\r\n        var e = false;\r\n        var h = a.scrollTop + this.conf.of_dstep;\r\n        if (h + a.offsetHeight >= a.scrollHeight) {\r\n            e = true;\r\n            h = a.scrollHeight - a.offsetHeight\r\n        }\r\n        a.scrollTop = h;\r\n        if (!e) {\r\n            var c = this;\r\n            this.conf.of_dtm = window.setTimeout(function() {\r\n                c._doScrollDown(l, false);\r\n                c = null \r\n            }, this.conf.of_dtime)\r\n        } else {\r\n            g = true\r\n        }\r\n    } else {\r\n        this._canScrollDown = false;\r\n        this._checkArrowsState(l)\r\n    }\r\n    if (g) {\r\n        this._checkArrowsState(l)\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._countPolygonItems = function(l) {\r\n    var g = 0;\r\n    for (var c in this.itemPull) {\r\n        var e = this.itemPull[c][\"parent\"];\r\n        var h = this.itemPull[c][\"type\"];\r\n        if (e == this.idPrefix + l && (h == \"item\" || h == \"radio\" || h == \"checkbox\")) {\r\n            g++\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setOverflowHeight = function(g) {\r\n    if (g === \"auto\") {\r\n        this.conf.overflow_limit = 0;\r\n        this.conf.auto_overflow = true;\r\n        return\r\n    }\r\n    if (this.conf.overflow_limit == 0 && g <= 0) {\r\n        return\r\n    }\r\n    this._clearAndHide();\r\n    if (this.conf.overflow_limit >= 0 && g > 0) {\r\n        this.conf.overflow_limit = g;\r\n        return\r\n    }\r\n    if (this.conf.overflow_limit > 0 && g <= 0) {\r\n        for (var e in this.itemPull) {\r\n            if (this._isArrowExists(e)) {\r\n                var c = String(e).replace(this.idPrefix, \"\");\r\n                this._removeUpArrow(c);\r\n                this._removeDownArrow(c);\r\n                this.idPull[\"polygon_\" + e].childNodes[1].style.height = \"\"\r\n            }\r\n        }\r\n        this.conf.overflow_limit = 0;\r\n        return\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._getRadioImgObj = function(g) {\r\n    try {\r\n        var a = this.idPull[this.idPrefix + g].childNodes[(this.conf.rtl ? 2 : 0)].childNodes[0]\r\n    } catch (c) {\r\n        var a = null \r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._setRadioState = function(g, e) {\r\n    var c = this._getRadioImgObj(g);\r\n    if (c != null ) {\r\n        var a = this.itemPull[this.idPrefix + g];\r\n        a.checked = e;\r\n        a.imgen = \"rdbt_\" + (a.checked ? \"1\" : \"0\");\r\n        a.imgdis = a.imgen;\r\n        c.className = \"sub_icon \" + a.imgen\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._radioOnClickHandler = function(g, a, c) {\r\n    if (a.charAt(1) == \"d\" || this.itemPull[this.idPrefix + g][\"group\"] == null ) {\r\n        return\r\n    }\r\n    var e = this.itemPull[this.idPrefix + g][\"group\"];\r\n    if (this.checkEvent(\"onRadioClick\")) {\r\n        if (this.callEvent(\"onRadioClick\", [e, this.getRadioChecked(e), g, this.conf.ctx_zoneid, c])) {\r\n            this.setRadioChecked(e, g)\r\n        }\r\n    } else {\r\n        this.setRadioChecked(e, g)\r\n    }\r\n    if (this.checkEvent(\"onClick\")) {\r\n        this.callEvent(\"onClick\", [g])\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.getRadioChecked = function(g) {\r\n    var l = null ;\r\n    for (var e = 0; e < this.radio[g].length; e++) {\r\n        var h = this.radio[g][e].replace(this.idPrefix, \"\");\r\n        var a = this._getRadioImgObj(h);\r\n        if (a != null ) {\r\n            var c = (a.className).match(/rdbt_1$/gi);\r\n            if (c != null ) {\r\n                l = h\r\n            }\r\n        }\r\n    }\r\n    return l\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.setRadioChecked = function(c, g) {\r\n    if (this.radio[c] == null ) {\r\n        return\r\n    }\r\n    for (var a = 0; a < this.radio[c].length; a++) {\r\n        var e = this.radio[c][a].replace(this.idPrefix, \"\");\r\n        this._setRadioState(e, (e == g))\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.addRadioButton = function(o, h, r, s, u, v, a, l) {\r\n    if (this.conf.context && h == this.topId) {} else {\r\n        if (this.itemPull[this.idPrefix + h] == null ) {\r\n            return\r\n        }\r\n        if (o == \"child\" && this.itemPull[this.idPrefix + h][\"type\"] != \"item\") {\r\n            return\r\n        }\r\n    }\r\n    var e = this.idPrefix + (s != null  ? s : this._genStr(24));\r\n    var m = \"rdbt_\" + (a ? \"1\" : \"0\");\r\n    var c = m;\r\n    if (o == \"sibling\") {\r\n        var n = this.idPrefix + this.getParentId(h);\r\n        this._addItemIntoGlobalStrorage(e, n, u, \"radio\", l, m, c);\r\n        this._renderSublevelItem(e, this.getItemPosition(h))\r\n    } else {\r\n        var n = this.idPrefix + h;\r\n        this._addItemIntoGlobalStrorage(e, n, u, \"radio\", l, m, c);\r\n        if (this.idPull[\"polygon_\" + n] == null ) {\r\n            this._renderSublevelPolygon(n, n)\r\n        }\r\n        this._renderSublevelItem(e, r - 1);\r\n        this._redefineComplexState(n)\r\n    }\r\n    var g = (v != null  ? v : this._genStr(24));\r\n    this.itemPull[e][\"group\"] = g;\r\n    if (this.radio[g] == null ) {\r\n        this.radio[g] = new Array()\r\n    }\r\n    this.radio[g][this.radio[g].length] = e;\r\n    if (a == true) {\r\n        this.setRadioChecked(g, String(e).replace(this.idPrefix, \"\"))\r\n    }\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.serialize = function() {\r\n    var a = \"<menu>\" + this._readLevel(this.idPrefix + this.topId) + \"</menu>\";\r\n    return a\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._readLevel = function(g) {\r\n    var h = \"\";\r\n    for (var o in this.itemPull) {\r\n        if (this.itemPull[o][\"parent\"] == g) {\r\n            var c = \"\";\r\n            var e = \"\";\r\n            var s = \"\";\r\n            var n = String(this.itemPull[o][\"id\"]).replace(this.idPrefix, \"\");\r\n            var m = \"\";\r\n            var r = (this.itemPull[o][\"title\"] != \"\" ? ' text=\"' + this.itemPull[o][\"title\"] + '\"' : \"\");\r\n            var l = \"\";\r\n            if (this.itemPull[o][\"type\"] == \"item\") {\r\n                if (this.itemPull[o][\"imgen\"] != \"\") {\r\n                    c = ' img=\"' + this.itemPull[o][\"imgen\"] + '\"'\r\n                }\r\n                if (this.itemPull[o][\"imgdis\"] != \"\") {\r\n                    e = ' imgdis=\"' + this.itemPull[o][\"imgdis\"] + '\"'\r\n                }\r\n                if (this.itemPull[o][\"hotkey\"] != \"\") {\r\n                    s = \"<hotkey>\" + this.itemPull[o][\"hotkey\"] + \"</hotkey>\"\r\n                }\r\n            }\r\n            if (this.itemPull[o][\"type\"] == \"separator\") {\r\n                m = ' type=\"separator\"'\r\n            } else {\r\n                if (this.itemPull[o][\"state\"] == \"disabled\") {\r\n                    l = ' enabled=\"false\"'\r\n                }\r\n            }\r\n            if (this.itemPull[o][\"type\"] == \"checkbox\") {\r\n                m = ' type=\"checkbox\"' + (this.itemPull[o][\"checked\"] ? ' checked=\"true\"' : \"\")\r\n            }\r\n            if (this.itemPull[o][\"type\"] == \"radio\") {\r\n                m = ' type=\"radio\" group=\"' + this.itemPull[o][\"group\"] + '\" ' + (this.itemPull[o][\"checked\"] ? ' checked=\"true\"' : \"\")\r\n            }\r\n            h += \"<item id='\" + n + \"'\" + r + m + c + e + l + \">\";\r\n            h += s;\r\n            if (this.itemPull[o][\"complex\"]) {\r\n                h += this._readLevel(o)\r\n            }\r\n            h += \"</item>\"\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXMenuObject.prototype.enableEffect = function(e, h, g) {\r\n    this._menuEffect = (e == \"opacity\" || e == \"slide\" || e == \"slide+\" ? e : false);\r\n    this._pOpStyleIE = (navigator.userAgent.search(/MSIE\\s[678]\\.0/gi) >= 0);\r\n    for (var c in this.idPull) {\r\n        if (c.search(/polygon/) === 0) {\r\n            this._pOpacityApply(c, (this._pOpStyleIE ? 100 : 1));\r\n            this.idPull[c].style.height = \"\"\r\n        }\r\n    }\r\n    this._pOpMax = (typeof (h) == \"undefined\" ? 100 : h) / (this._pOpStyleIE ? 1 : 100);\r\n    this._pOpStyleName = (this._pOpStyleIE ? \"filter\" : \"opacity\");\r\n    this._pOpStyleValue = (this._pOpStyleIE ? \"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)\" : \"#\");\r\n    this._pSlSteps = (this._pOpStyleIE ? 10 : 20);\r\n    this._pSlTMTimeMax = g || 50\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._showPolygonEffect = function(a) {\r\n    this._pShowHide(a, true)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._hidePolygonEffect = function(a) {\r\n    this._pShowHide(a, false)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._pOpacityApply = function(a, c) {\r\n    this.idPull[a].style[this._pOpStyleName] = String(this._pOpStyleValue).replace(\"#\", c || this.idPull[a]._op)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._pShowHide = function(a, c) {\r\n    if (!this.idPull) {\r\n        return\r\n    }\r\n    if (this.idPull[a]._tmShow != null ) {\r\n        if ((this.idPull[a]._step_h > 0 && c == true) || (this.idPull[a]._step_h < 0 && c == false)) {\r\n            return\r\n        }\r\n        window.clearTimeout(this.idPull[a]._tmShow);\r\n        this.idPull[a]._tmShow = null ;\r\n        this.idPull[a]._max_h = null \r\n    }\r\n    if (c == false && (this.idPull[a].style.visibility == \"hidden\" || this.idPull[a].style.display == \"none\")) {\r\n        return\r\n    }\r\n    if (c == true && this.idPull[a].style.display == \"none\") {\r\n        this.idPull[a].style.visibility = \"hidden\";\r\n        this.idPull[a].style.display = \"\"\r\n    }\r\n    if (this.idPull[a]._max_h == null ) {\r\n        this.idPull[a]._max_h = parseInt(this.idPull[a].offsetHeight);\r\n        this.idPull[a]._h = (c == true ? 0 : this.idPull[a]._max_h);\r\n        this.idPull[a]._step_h = Math.round(this.idPull[a]._max_h / this._pSlSteps) * (c == true ? 1 : -1);\r\n        if (this.idPull[a]._step_h == 0) {\r\n            return\r\n        }\r\n        this.idPull[a]._step_tm = Math.round(this._pSlTMTimeMax / this._pSlSteps);\r\n        if (this._menuEffect == \"slide+\" || this._menuEffect == \"opacity\") {\r\n            this.idPull[a].op_tm = this.idPull[a]._step_tm;\r\n            this.idPull[a].op_step = (this._pOpMax / this._pSlSteps) * (c == true ? 1 : -1);\r\n            if (this._pOpStyleIE) {\r\n                this.idPull[a].op_step = Math.round(this.idPull[a].op_step)\r\n            }\r\n            this.idPull[a]._op = (c == true ? 0 : this._pOpMax);\r\n            this._pOpacityApply(a)\r\n        } else {\r\n            this.idPull[a]._op = (this._pOpStyleIE ? 100 : 1);\r\n            this._pOpacityApply(a)\r\n        }\r\n        if (this._menuEffect.search(/slide/) === 0) {\r\n            this.idPull[a].style.height = \"0px\"\r\n        }\r\n        this.idPull[a].style.visibility = \"visible\"\r\n    }\r\n    this._pEffectSet(a, this.idPull[a]._h + this.idPull[a]._step_h)\r\n}\r\n;\r\ndhtmlXMenuObject.prototype._pEffectSet = function(e, c) {\r\n    if (!this.idPull) {\r\n        return\r\n    }\r\n    if (this.idPull[e]._tmShow) {\r\n        window.clearTimeout(this.idPull[e]._tmShow)\r\n    }\r\n    this.idPull[e]._h = Math.max(0, Math.min(c, this.idPull[e]._max_h));\r\n    if (this._menuEffect.search(/slide/) === 0) {\r\n        this.idPull[e].style.height = this.idPull[e]._h + \"px\"\r\n    }\r\n    c += this.idPull[e]._step_h;\r\n    if (this._menuEffect == \"slide+\" || this._menuEffect == \"opacity\") {\r\n        this.idPull[e]._op = Math.max(0, Math.min(this._pOpMax, this.idPull[e]._op + this.idPull[e].op_step));\r\n        this._pOpacityApply(e)\r\n    }\r\n    if ((this.idPull[e]._step_h > 0 && c <= this.idPull[e]._max_h) || (this.idPull[e]._step_h < 0 && c >= 0)) {\r\n        var a = this;\r\n        this.idPull[e]._tmShow = window.setTimeout(function() {\r\n            a._pEffectSet(e, c)\r\n        }, this.idPull[e]._step_tm)\r\n    } else {\r\n        if (this._menuEffect.search(/slide/) === 0) {\r\n            this.idPull[e].style.height = \"\"\r\n        }\r\n        if (this.idPull[e]._step_h < 0) {\r\n            this.idPull[e].style.visibility = \"hidden\"\r\n        }\r\n        if (this._menuEffect == \"slide+\" || this._menuEffect == \"opacity\") {\r\n            this.idPull[e]._op = (this.idPull[e]._step_h < 0 ? (this._pOpStyleIE ? 100 : 1) : this._pOpMax);\r\n            this._pOpacityApply(e)\r\n        }\r\n        this.idPull[e]._tmShow = null ;\r\n        this.idPull[e]._h = null ;\r\n        this.idPull[e]._max_h = null ;\r\n        this.idPull[e]._step_tm = null \r\n    }\r\n}\r\n;\r\nfunction dhtmlXRibbon(g) {\r\n    var e = this, c, a;\r\n    this.conf = {\r\n        type: \"ribbon\",\r\n        icons_path: (g && g.icons_path) ? g.icons_path : \"\",\r\n        arrows_mode: (g && g.arrows_mode) ? g.arrows_mode : null ,\r\n        skin: \"dhx_skyblue\"\r\n    };\r\n    this._eventHandlers = {};\r\n    this._base = null ;\r\n    this._items = {};\r\n    this._tabbar = null ;\r\n    this.childIds = [];\r\n    if (typeof (g) == \"string\") {\r\n        a = g\r\n    } else {\r\n        if (g && g.tagName) {\r\n            a = g\r\n        } else {\r\n            if (g && g.parent) {\r\n                if (g.parent.tagName || typeof (g.parent) == \"string\") {\r\n                    a = g.parent\r\n                }\r\n            }\r\n        }\r\n    }\r\n    this._doOnHighlight0 = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].mouseover) == \"function\") {\r\n            if (e.items[l.type].mouseover(l, e, n) != true) {\r\n                return false\r\n            }\r\n        }\r\n        if (!/dhxrb_highlight0/.test(h.className)) {\r\n            h.className += \" dhxrb_highlight0\"\r\n        }\r\n    }\r\n    ;\r\n    this._doOffHighlight0 = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].mouseout) == \"function\") {\r\n            if (e.items[l.type].mouseout(l, e, n) != true) {\r\n                return false\r\n            }\r\n        }\r\n        if (/dhxrb_highlight1/.test(h.className)) {\r\n            h.className = h.className.replace(/\\s?dhxrb_highlight1/, \"\")\r\n        }\r\n        if (/dhxrb_highlight0/.test(h.className)) {\r\n            h.className = h.className.replace(/\\s?dhxrb_highlight0/, \"\")\r\n        }\r\n    }\r\n    ;\r\n    this._doOnHighlight1 = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        e.callEvent(\"_showPopup\", [l.id]);\r\n        if (e.items[l.type] && typeof (e.items[l.type].mousedown) == \"function\") {\r\n            if (e.items[l.type].mousedown(l, e, n) != true) {\r\n                return false\r\n            }\r\n        }\r\n        if (!/dhxrb_highlight1/.test(h.className)) {\r\n            h.className += \" dhxrb_highlight1\"\r\n        }\r\n    }\r\n    ;\r\n    this._doOffHighlight1 = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].mouseup) == \"function\") {\r\n            if (e.items[l.type].mouseup(l, e, n) != true) {\r\n                return false\r\n            }\r\n        }\r\n        if (/dhxrb_highlight1/.test(h.className)) {\r\n            h.className = h.className.replace(/\\s?dhxrb_highlight1/, \"\")\r\n        }\r\n    }\r\n    ;\r\n    this._doOnClick = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].click) == \"function\") {\r\n            e.items[l.type].click(l, e, n)\r\n        }\r\n    }\r\n    ;\r\n    this._doOnFocus = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        e.callEvent(\"_showPopup\", [l.id]);\r\n        if (e.items[l.type] && typeof (e.items[l.type].focus) == \"function\") {\r\n            e.items[l.type].focus(l, e, n)\r\n        }\r\n    }\r\n    ;\r\n    this._doOnBlur = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].blur) == \"function\") {\r\n            e.items[l.type].blur(l, e, n)\r\n        }\r\n    }\r\n    ;\r\n    this._doOnChange = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].change) == \"function\") {\r\n            e.items[l.type].change(l, e, n)\r\n        }\r\n    }\r\n    ;\r\n    this._doOnKeydown = function(n) {\r\n        n = n || event;\r\n        var m = n.target || n.srcElement;\r\n        var h = e._findItemByNode(m);\r\n        var l = e._items[h._dhx_ribbonId];\r\n        if (l.conf.disable) {\r\n            return\r\n        }\r\n        if (e.items[l.type] && typeof (e.items[l.type].keydown) == \"function\") {\r\n            e.items[l.type].keydown(l, e, n)\r\n        }\r\n    }\r\n    ;\r\n    this._tabCustomApi = {\r\n        enable: function(n, l) {\r\n            var h = null ;\r\n            l = l || false;\r\n            if (l != true) {\r\n                h = e._items[this._idd];\r\n                for (var m = 0; m < h.childIds.length; m++) {\r\n                    e.enable(h.childIds[m])\r\n                }\r\n            }\r\n            return e._tabOriginalApi.enable.apply(this, [n])\r\n        },\r\n        disable: function(n, l) {\r\n            var h = null ;\r\n            if (l != false) {\r\n                h = e._items[this._idd];\r\n                for (var m = 0; m < h.childIds.length; m++) {\r\n                    e.disable(h.childIds[m])\r\n                }\r\n            }\r\n            return e._tabOriginalApi.disable.apply(this, [n])\r\n        },\r\n        close: function(m) {\r\n            var l = e._items[this._idd];\r\n            e._removeTab(l);\r\n            e._tabOriginalApi.close.apply(this, [m]);\r\n            for (var h in e._tabOriginalApi) {\r\n                this[h] = null \r\n            }\r\n        }\r\n    };\r\n    this._attachEventTabbar = function() {\r\n        this._tabbar.attachEvent(\"onSelect\", function() {\r\n            return e.callEvent(\"onSelect\", arguments)\r\n        });\r\n        this._tabbar.attachEvent(\"onTabClick\", function() {\r\n            return e.callEvent(\"onTabClick\", arguments)\r\n        });\r\n        this._tabbar.attachEvent(\"onTabClose\", function() {\r\n            return e.callEvent(\"onTabClose\", arguments)\r\n        })\r\n    }\r\n    ;\r\n    if (typeof (a) == \"string\") {\r\n        this._base = document.getElementById(a)\r\n    } else {\r\n        if (a && a.tagName) {\r\n            this._base = a\r\n        } else {\r\n            this._base = document.createElement(\"div\");\r\n            this._base._dhx_remove = true;\r\n            if (document.body.firstChild) {\r\n                document.body.insertBefore(this._base, document.body.firstChild)\r\n            } else {\r\n                document.body.appendChild(this._base)\r\n            }\r\n        }\r\n    }\r\n    c = dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || dhx4.skinDetect(\"dhtmlxribbon\") || \"dhx_skyblue\";\r\n    if (typeof (g) == \"object\" && g.skin) {\r\n        c = g.skin\r\n    }\r\n    this.setSkin(c);\r\n    dhx4._eventable(this);\r\n    dhx4._enableDataLoading(this, \"_renderData\", \"_xmlToJson\", \"ribbon\", {\r\n        struct: true\r\n    });\r\n    this.attachEvent(\"_onHeightChanged\", function() {\r\n        this.conf.inited = true\r\n    });\r\n    this._base.className += \" dhxrb_without_tabbar\";\r\n    this._base.innerHTML = \"<div class='dhxrb_background_area'></div>\";\r\n    if (g != null ) {\r\n        if (g.json) {\r\n            this.loadStruct(g.json, g.onload)\r\n        } else {\r\n            if (g.xml) {\r\n                this.loadStruct(g.xml, g.onload)\r\n            } else {\r\n                this._renderData(g)\r\n            }\r\n        }\r\n    }\r\n    this.unload = function() {\r\n        var l = [];\r\n        for (var m = 0; m < this.childIds.length; m++) {\r\n            l.push(this.childIds[m])\r\n        }\r\n        dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n        dhx4._eventable(this, \"clear\");\r\n        for (var m = 0; m < l.length; m++) {\r\n            if (this._items[l[m]].type == \"tab\") {\r\n                this.tabs(l[m]).close(false)\r\n            } else {\r\n                this.removeItem(l[m])\r\n            }\r\n        }\r\n        if (this._tabbar) {\r\n            this._tabbar.unload();\r\n            this._tabbar = null \r\n        }\r\n        this._base.innerHTML = \"\";\r\n        if (this._base._dhx_remove) {\r\n            this._base.parentNode.removeChild(this._base)\r\n        } else {\r\n            this._base.className = this._base.className.replace(/\\s?(dhtmlx|dhxrb)(\\S*)/ig, \"\")\r\n        }\r\n        for (var h in this) {\r\n            this[h] = null \r\n        }\r\n        e = null \r\n    }\r\n}\r\ndhtmlXRibbon.prototype.setSizes = function() {\r\n    if (this._tabbar != null  && typeof (this.setSizes) == \"function\") {\r\n        this._tabbar.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._renderData = function(c) {\r\n    var a = this._base.firstChild;\r\n    if (c != null ) {\r\n        this.conf.icons_path = c.icons_path || this.conf.icons_path;\r\n        if (c.tabs instanceof Array) {\r\n            this._base.className = this._base.className.replace(/\\s?dhxrb_without_tabbar/i, \"\");\r\n            a.className = \"dhxrb_with_tabbar\";\r\n            this._tabbar = new dhtmlXTabBar(a);\r\n            this._attachEventTabbar();\r\n            this._tabbar.setSkin(this.conf.skin);\r\n            if (this.conf.arrows_mode != null ) {\r\n                this._tabbar.setArrowsMode(this.conf.arrows_mode)\r\n            }\r\n            this.childIds = this._appendTabs(c.tabs)\r\n        } else {\r\n            if (c.items instanceof Array) {\r\n                if (!/\\s?dhxrb_without_tabbar/i.test(this._base.className)) {\r\n                    this._base.className += \" dhxrb_without_tabbar\"\r\n                }\r\n                if (/\\s?dhxrb_background_area/i.test(a.className)) {\r\n                    a.className = \"dhxrb_background_area\"\r\n                }\r\n                a.innerHTML = \"<div class='dhxrb_g_area'></div>\";\r\n                this.childIds = this._appendBlocks(c.items, a.firstChild)\r\n            }\r\n        }\r\n        this.callEvent(\"_onHeightChanged\", [])\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._xmlToJson = function(c) {\r\n    var a = c.lastChild || null \r\n      , g = {}\r\n      , e = [];\r\n    if (a && a.tagName == \"ribbon\") {\r\n        e = this._convertXmlNodeListIntoObject(a.childNodes)\r\n    }\r\n    if (e[0] && e[0].type && e[0].type.toLowerCase() == \"block\") {\r\n        g.items = e\r\n    } else {\r\n        g.tabs = e\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXRibbon.prototype._convertXmlNodeListIntoObject = function(c) {\r\n    var e, a, h = [], g;\r\n    a = c.length;\r\n    for (e = 0; e < a; e++) {\r\n        g = this._covertXmlNodeToObject(c[e]);\r\n        if (g) {\r\n            h.push(g)\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXRibbon.prototype._covertXmlNodeToObject = function(g) {\r\n    if (!g || !g.tagName || !(g.tagName.toLowerCase() == \"item\" || g.tagName.toLowerCase() == \"tab\")) {\r\n        return null \r\n    }\r\n    var e, a, c = g.attributes, h = {};\r\n    a = c.length;\r\n    for (e = 0; e < a; e++) {\r\n        switch (c[e].name) {\r\n        case \"isbig\":\r\n            h.isbig = dhx4.s2b(c[e].value);\r\n            break;\r\n        case \"state\":\r\n            h.state = dhx4.s2b(c[e].value);\r\n            break;\r\n        default:\r\n            h[c[e].name] = c[e].value\r\n        }\r\n    }\r\n    if (g.childNodes.length) {\r\n        if (g.getAttribute(\"type\") == \"buttonCombo\" || g.getAttribute(\"type\") == \"buttonSelect\") {\r\n            h.data = g\r\n        } else {\r\n            if (g.tagName.toLowerCase() == \"tab\") {\r\n                h.items = this._convertXmlNodeListIntoObject(g.childNodes)\r\n            } else {\r\n                h.list = this._convertXmlNodeListIntoObject(g.childNodes)\r\n            }\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXRibbon.prototype._appendTabs = function(h) {\r\n    var c, a, e, g = [];\r\n    a = h.length;\r\n    for (c = 0; c < a; c++) {\r\n        e = this._addTab(h[c]);\r\n        if (h[c].items instanceof Array) {\r\n            e.childIds = this._appendBlocks(h[c].items, e.base, e)\r\n        }\r\n        g.push(e.id)\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXRibbon.prototype._addTab = function(e) {\r\n    var a, g;\r\n    var c = {\r\n        conf: {\r\n            active: false,\r\n            text: \"\",\r\n            width: null ,\r\n            position: null ,\r\n            disable: false\r\n        },\r\n        base: document.createElement(\"div\"),\r\n        type: \"tab\",\r\n        childIds: []\r\n    };\r\n    for (a in e) {\r\n        if (a == \"items\") {\r\n            continue\r\n        }\r\n        c.conf[a] = e[a]\r\n    }\r\n    if (!e.id) {\r\n        c.id = dhx4.newId()\r\n    } else {\r\n        c.id = e.id\r\n    }\r\n    while (this._items[c.id]) {\r\n        c.id = dhx4.newId()\r\n    }\r\n    this._tabbar.addTab(c.id, c.conf.text, c.conf.width, c.conf.position, c.conf.active);\r\n    c.base.className = \"dhxrb_g_area\";\r\n    c.base._dhx_ribbonId = c.id;\r\n    this.tabs(c.id).attachObject(c.base);\r\n    this._changeApiForTab(this.tabs(c.id));\r\n    this._items[c.id] = c;\r\n    return c\r\n}\r\n;\r\ndhtmlXRibbon.prototype._changeApiForTab = function(c) {\r\n    var a;\r\n    for (a in this._tabOriginalApi) {\r\n        this._tabOriginalApi[a] = this._tabOriginalApi[a] || c[a];\r\n        c[a] = this._tabCustomApi[a]\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._tabOriginalApi = {\r\n    enable: null ,\r\n    disable: null ,\r\n    close: null \r\n};\r\ndhtmlXRibbon.prototype._appendBlocks = function(a, s, e) {\r\n    var m, g, n, h, o, c, r = [];\r\n    e = e || null ;\r\n    g = a.length;\r\n    for (m = 0; m < g; m++) {\r\n        if (typeof (a[m]) == \"object\" && a[m].type == \"block\") {\r\n            n = this._addBlock(a[m], s);\r\n            if (a[m].list && (a[m].list instanceof Array)) {\r\n                h = a[m].list;\r\n                o = h.length;\r\n                for (c = 0; c < o; c++) {\r\n                    this._addItem(n.id, null , null , h[c])\r\n                }\r\n            }\r\n            if (e != null ) {\r\n                n.parentId = e.id\r\n            }\r\n            if (n.conf.disable) {\r\n                this.disable(n.id)\r\n            }\r\n            r.push(n.id)\r\n        }\r\n    }\r\n    return r\r\n}\r\n;\r\ndhtmlXRibbon.prototype._addBlock = function(h, g) {\r\n    var e, a, m, c;\r\n    m = {\r\n        conf: {\r\n            text: \"\",\r\n            text_pos: \"bottom\",\r\n            type: \"block\",\r\n            mode: \"cols\",\r\n            disable: false\r\n        },\r\n        type: \"block\",\r\n        childIds: [],\r\n        base: document.createElement(\"div\"),\r\n        contForItems: document.createElement(\"div\"),\r\n        contForText: document.createElement(\"div\")\r\n    };\r\n    for (c in h) {\r\n        if (c == \"list\" || c == \"type\" || c == \"id\") {\r\n            continue\r\n        }\r\n        m.conf[c] = h[c]\r\n    }\r\n    if (!h.id) {\r\n        m.id = dhx4.newId()\r\n    } else {\r\n        m.id = h.id\r\n    }\r\n    while (this._items[m.id]) {\r\n        m.id = dhx4.newId()\r\n    }\r\n    m.base.className = \"dhxrb_block_base\";\r\n    g.appendChild(m.base);\r\n    m.contForItems.className = \"dhxrb_block_items\";\r\n    m.contForText.className = \"dhxrb_block_label\";\r\n    m.base.appendChild(m.contForItems);\r\n    if (m.conf.text) {\r\n        m.contForText.innerHTML = m.conf.text;\r\n        if (m.conf.text_pos == \"top\") {\r\n            m.base.insertBefore(m.contForText, m.contForItems)\r\n        } else {\r\n            m.base.appendChild(m.contForText)\r\n        }\r\n    }\r\n    m.base._dhx_ribbonId = m.id;\r\n    this._items[m.id] = m;\r\n    return m\r\n}\r\n;\r\ndhtmlXRibbon.prototype._addItem = function(e, c, o, m) {\r\n    var h = this._items[e], a, l, s = null , n = this, g;\r\n    if (m.type != \"newLevel\" && !this.items[m.type]) {\r\n        return null \r\n    }\r\n    if (m.type == \"newLevel\") {\r\n        this._addNewLevel(h)\r\n    } else {\r\n        if (h.type == \"group\") {\r\n            a = document.createElement(\"div\");\r\n            a.className = \"dhxrb_in_group\";\r\n            h.base.appendChild(a)\r\n        } else {\r\n            if (m.isbig) {\r\n                a = document.createElement(\"div\");\r\n                a.className = \"dhxrb_big_button\";\r\n                h.contForItems.appendChild(a)\r\n            } else {\r\n                l = this._getContainerForSmallItem(h);\r\n                a = document.createElement(\"div\");\r\n                a.className = (h.conf.mode == \"rows\") ? \"dhxrb_in_row\" : \"dhxrb_3rows_button\";\r\n                l.appendChild(a)\r\n            }\r\n        }\r\n    }\r\n    if (a) {\r\n        this._attachEventForItem(a);\r\n        g = {\r\n            icons_path: m.icons_path || this.conf.icons_path,\r\n            skin: this.conf.skin\r\n        };\r\n        for (var r in m) {\r\n            g[r] = m[r]\r\n        }\r\n        if (!g.id) {\r\n            g.id = dhx4.newId()\r\n        }\r\n        while (this._items[g.id]) {\r\n            g.id = dhx4.newId()\r\n        }\r\n        s = (this.items[g.type] && this.items[g.type].render) ? this.items[g.type].render(a, g) : null \r\n    }\r\n    if (s != null ) {\r\n        this._items[s.id] = s;\r\n        s.parentId = h.id;\r\n        h.childIds.push(s.id);\r\n        a._dhx_ribbonId = s.id;\r\n        if (g.onclick && (typeof (g.onclick) == \"function\")) {\r\n            this._eventHandlers[s.id] = this._eventHandlers[s.id] || {};\r\n            this._eventHandlers[s.id][\"onclick\"] = g.onclick\r\n        }\r\n        s.callEvent = function() {\r\n            n.callEvent.apply(n, arguments)\r\n        }\r\n        ;\r\n        s._callHandler = function() {\r\n            n._callHandler.apply(n, arguments)\r\n        }\r\n        ;\r\n        if (this.items[g.type] && typeof (this.items[g.type].callAfterInit) == \"function\") {\r\n            this.items[g.type].callAfterInit.apply(this, [s])\r\n        }\r\n    }\r\n    return s\r\n}\r\n;\r\ndhtmlXRibbon.prototype._callHandler = function(c, a) {\r\n    if (this._eventHandlers[c] && this._eventHandlers[c].onclick) {\r\n        this._eventHandlers[c].onclick.apply(this, a)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.items = {};\r\ndhtmlXRibbon.prototype.items.button = {\r\n    render: function(c, a) {\r\n        var e, g;\r\n        g = {\r\n            base: c,\r\n            id: a.id,\r\n            type: a.type,\r\n            conf: {\r\n                text: \"\",\r\n                text_pos: (a.isbig) ? \"bottom\" : \"right\",\r\n                img: null ,\r\n                imgdis: null ,\r\n                isbig: false,\r\n                disable: false,\r\n                skin: a.skin\r\n            }\r\n        };\r\n        for (e in a) {\r\n            if (e == \"id\" || e == \"onclick\" || e == \"type\") {\r\n                continue\r\n            }\r\n            g.conf[e] = a[e]\r\n        }\r\n        c.innerHTML = \"<img class='dhxrb_image\" + ((g.conf.img) ? \"'\" : \" dhxrb_invisible'\") + \" src='\" + ((g.conf.img) ? g.conf.icons_path + g.conf.img : \"\") + \"' /><div class='dhxrb_label_button'>\" + g.conf.text + \"</div>\";\r\n        if (typeof (this.afterRender) == \"function\") {\r\n            this.afterRender(g)\r\n        }\r\n        if (g.conf.disable) {\r\n            this.disable(g)\r\n        }\r\n        return g\r\n    },\r\n    getText: function(a) {\r\n        return a.conf.text\r\n    },\r\n    setText: function(c, e) {\r\n        var a = c.base.childNodes[1];\r\n        c.conf.text = e;\r\n        a.innerHTML = e\r\n    },\r\n    setImage: function(c, a) {\r\n        c.conf.img = a;\r\n        if (c.conf.disable == false) {\r\n            c.base.childNodes[0].src = c.conf.icons_path + c.conf.img\r\n        }\r\n    },\r\n    setImageDis: function(c, a) {\r\n        c.conf.imgdis = a;\r\n        if (c.conf.disable == true) {\r\n            c.base.childNodes[0].src = c.conf.icons_path + c.conf.imgdis\r\n        }\r\n    },\r\n    mousedown: function(a, g, c) {\r\n        return true\r\n    },\r\n    click: function(a, g, c) {\r\n        if (c.button != 0) {\r\n            return false\r\n        }\r\n        g._callHandler(a.id, [a.id]);\r\n        a.callEvent(\"onClick\", [a.id]);\r\n        return false\r\n    },\r\n    disable: function(c) {\r\n        var e = c.base.childNodes[0]\r\n          , a = c.base.childNodes[1];\r\n        if (c.conf.imgdis) {\r\n            e.src = c.conf.icons_path + c.conf.imgdis;\r\n            if (/\\s?dhxrb_invisible/i.test(e.className)) {\r\n                e.className = e.className.replace(/\\s?dhxrb_invisible/i, \"\")\r\n            }\r\n        }\r\n        if (!/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className += \" dhxrb_disable_text_style\"\r\n        }\r\n        return true\r\n    },\r\n    enable: function(c) {\r\n        var e = c.base.childNodes[0]\r\n          , a = c.base.childNodes[1];\r\n        if (c.conf.img) {\r\n            e.src = c.conf.icons_path + c.conf.img\r\n        } else {\r\n            if (!/\\s?dhxrb_invisible/i.test(e.className)) {\r\n                e.className += \" dhxrb_invisible\"\r\n            }\r\n        }\r\n        if (/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className = a.className.replace(/\\s?dhxrb_disable_text_style/i, \"\")\r\n        }\r\n        return true\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.buttonTwoState = {\r\n    click: function(a, g, c) {\r\n        return false\r\n    },\r\n    afterRender: function(a) {\r\n        if (a.conf.state) {\r\n            this.setState(a, a.conf.state)\r\n        }\r\n    },\r\n    mouseover: function(a) {\r\n        if (!/dhxrb_highlight0/.test(a.base.className)) {\r\n            a.base.className += \" dhxrb_highlight0\"\r\n        }\r\n        return false\r\n    },\r\n    mouseout: function(a) {\r\n        if (/dhxrb_highlight0/.test(a.base.className)) {\r\n            a.base.className = a.base.className.replace(/\\s?dhxrb_highlight0/, \"\")\r\n        }\r\n        return false\r\n    },\r\n    mousedown: function(a, g, c) {\r\n        g._callHandler(a.id, [a.id, !a.conf.state]);\r\n        this.setState(a, !a.conf.state, true);\r\n        return false\r\n    },\r\n    mouseup: function(a) {\r\n        return false\r\n    },\r\n    setState: function(a, c, e) {\r\n        e = e || false;\r\n        c = dhx4.s2b(c);\r\n        if (c) {\r\n            if (!/dhxrb_highlight1/.test(a.base.className)) {\r\n                a.base.className += \" dhxrb_highlight1\"\r\n            }\r\n        } else {\r\n            if (/dhxrb_highlight1/.test(a.base.className)) {\r\n                a.base.className = a.base.className.replace(/\\s?dhxrb_highlight1/, \"\")\r\n            }\r\n        }\r\n        a.conf.state = c;\r\n        if (e) {\r\n            a.callEvent(\"onStateChange\", [a.id, a.conf.state])\r\n        }\r\n    },\r\n    getState: function(a) {\r\n        return ( a.conf.state == true) \r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.buttonSegment = {\r\n    click: function(a, g, c) {\r\n        return false\r\n    },\r\n    mousedown: function(a, g, c) {\r\n        this.setState(a, g, true);\r\n        return false\r\n    },\r\n    callAfterInit: function(a) {\r\n        if (a.conf.state || dhtmlXRibbon.prototype.items.buttonSegment._getSelectedNeighbor(a, this) == null ) {\r\n            if (a.conf.state) {\r\n                a.conf.state = false\r\n            }\r\n            dhtmlXRibbon.prototype.items.buttonSegment.setState(a, this, false)\r\n        }\r\n    },\r\n    afterRender: function() {},\r\n    setState: function(a, h, g) {\r\n        g = g || false;\r\n        var e = null \r\n          , c = dhx4.s2b(a.conf.state);\r\n        if (c == false) {\r\n            e = this._getSelectedNeighbor(a, h);\r\n            if (e != null ) {\r\n                this._unSelect(e)\r\n            }\r\n            if (!/dhxrb_highlight1/.test(a.base.className)) {\r\n                a.base.className += \" dhxrb_highlight1\"\r\n            }\r\n            a.conf.state = true;\r\n            if (g) {\r\n                h._callHandler(a.id, [a.id, (e ? e.id : null )]);\r\n                h.callEvent(\"onStateChange\", [a.id, (e ? e.id : null )])\r\n            }\r\n        }\r\n    },\r\n    remove: function(e, m) {\r\n        var h = dhx4.s2b(e.conf.state), l = null , a = 0, c = m._items[e.parentId], g;\r\n        if (h) {\r\n            while (c.childIds[a] && l == null ) {\r\n                g = m._items[c.childIds[a]];\r\n                if (g.type == \"buttonSegment\" && g != e) {\r\n                    l = g\r\n                }\r\n                a++\r\n            }\r\n            if (l) {\r\n                this.setState(l, m)\r\n            }\r\n        }\r\n    },\r\n    _unSelect: function(a) {\r\n        var c = dhx4.s2b(a.conf.state);\r\n        if (c) {\r\n            if (/dhxrb_highlight1/.test(a.base.className)) {\r\n                a.base.className = a.base.className.replace(/\\s?dhxrb_highlight1/, \"\")\r\n            }\r\n            a.conf.state = false\r\n        }\r\n    },\r\n    _getSelectedNeighbor: function(g, n) {\r\n        var e = n._items[g.parentId], c, a, m, h = null ;\r\n        a = e.childIds.length;\r\n        for (c = 0; c < a; c++) {\r\n            m = n._items[e.childIds[c]];\r\n            if (m.type == \"buttonSegment\" && m.conf.state) {\r\n                h = m;\r\n                break\r\n            }\r\n        }\r\n        return h\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.buttonSelect = {\r\n    itemCollection: [],\r\n    _isAttachedEventInWindow: false,\r\n    afterRender: function(c) {\r\n        var a = c.base.childNodes[1];\r\n        a.innerHTML += \"<span class='dhxrb_arrow'>&nbsp;</span>\";\r\n        c.menu = null ;\r\n        this.itemCollection.push(c);\r\n        this._attachEventToWindow();\r\n        a = null \r\n    },\r\n    setText: function(a, e) {\r\n        var c = a.base.childNodes[1].lastChild;\r\n        a.conf.text = e;\r\n        a.base.childNodes[1].innerHTML = e;\r\n        a.base.childNodes[1].appendChild(c)\r\n    },\r\n    setOptionText: function(a, e, c) {\r\n        if (a.menu != null ) {\r\n            a.menu.setItemText(e, c)\r\n        } else {\r\n            this._loopThroughItems(a.conf.items, e, c, false)\r\n        }\r\n    },\r\n    getOptionText: function(a, c) {\r\n        if (a.menu != null ) {\r\n            return a.menu.getItemText(c)\r\n        }\r\n        return this._loopThroughItems(a.conf.items, c, null , true)\r\n    },\r\n    _loopThroughItems: function(a, l, h, g) {\r\n        for (var e = 0; e < a.length; e++) {\r\n            if (a[e].id == l) {\r\n                if (g != true) {\r\n                    a[e].text = h;\r\n                    return true\r\n                } else {\r\n                    return a[e].text\r\n                }\r\n            }\r\n            if (a[e].items != null ) {\r\n                var c = this._loopThroughItems(a[e].items, l, h, g);\r\n                if (c != null ) {\r\n                    return c\r\n                }\r\n            }\r\n        }\r\n        return null \r\n    },\r\n    _attachEventToWindow: function() {\r\n        if (this._isAttachedEventInWindow == false) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                document.body.addEventListener(\"mousedown\", this._hideAllMenus, false)\r\n            } else {\r\n                document.body.attachEvent(\"onmousedown\", this._hideAllMenus)\r\n            }\r\n            this._isAttachedEventInWindow = true\r\n        }\r\n    },\r\n    _detachEventFromWindow: function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            document.body.removeEventListener(\"mousedown\", this._hideAllMenus, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousedown\", this._hideAllMenus)\r\n        }\r\n        this._isAttachedEventInWindow = false\r\n    },\r\n    _hideAllMenus: function(l) {\r\n        l = l || event;\r\n        var g = l.target || l.srcElement;\r\n        var a = true;\r\n        while (g != null  && a == true) {\r\n            if (g.className != null  && /SubLevelArea_Polygon/i.test(g.className)) {\r\n                a = false\r\n            } else {\r\n                g = g.parentNode\r\n            }\r\n        }\r\n        if (a == false) {\r\n            return\r\n        }\r\n        var c = dhtmlXRibbon.prototype.items.buttonSelect.itemCollection;\r\n        for (var n in c) {\r\n            var h = c[n];\r\n            if (h.menu instanceof dhtmlXMenuObject) {\r\n                if (h._skipHiding) {\r\n                    h._skipHiding = false\r\n                } else {\r\n                    dhtmlXRibbon.prototype.items.buttonSelect.hideMenu(h)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    mousedown: function(a, g, c) {\r\n        a._skipHiding = true;\r\n        this.showMenu(a);\r\n        return false\r\n    },\r\n    mouseup: function(a) {\r\n        return false\r\n    },\r\n    click: function() {},\r\n    setState: function() {},\r\n    showMenu: function(c) {\r\n        var a = dhx4.absLeft(c.base)\r\n          , e = dhx4.absTop(c.base) + c.base.offsetHeight;\r\n        if (!(c.menu instanceof dhtmlXMenuObject)) {\r\n            c.menu = new dhtmlXMenuObject({\r\n                parent: c.base,\r\n                icons_path: c.conf.icons_path,\r\n                context: true,\r\n                items: c.conf.items,\r\n                skin: c.conf.skin\r\n            });\r\n            if (c.conf.data) {\r\n                c.menu.loadStruct(c.conf.data);\r\n                delete c.conf.data\r\n            }\r\n            c.menu.setAutoHideMode(false);\r\n            c.menu.attachEvent(\"onHide\", function(g) {\r\n                if (g == null ) {\r\n                    dhtmlXRibbon.prototype.items.buttonSelect._doOnHideMenu(c)\r\n                }\r\n            });\r\n            c.menu.attachEvent(\"onShow\", function(g) {\r\n                if (g == null ) {\r\n                    dhtmlXRibbon.prototype.items.buttonSelect._doOnShowMenu(c)\r\n                }\r\n            });\r\n            c.menu.attachEvent(\"onClick\", function(g) {\r\n                c.callEvent(\"onClick\", [g, c.id])\r\n            });\r\n            c.base.oncontextmenu = function() {\r\n                return false\r\n            }\r\n            ;\r\n            dhtmlXRibbon.prototype.items.buttonSelect.showMenu(c)\r\n        } else {\r\n            c.menu.showContextMenu(a, e)\r\n        }\r\n    },\r\n    hideMenu: function(a) {\r\n        if (a.menu instanceof dhtmlXMenuObject) {\r\n            a.menu.hideContextMenu()\r\n        }\r\n    },\r\n    remove: function(c) {\r\n        var e, a;\r\n        if (c.menu instanceof dhtmlXMenuObject) {\r\n            c.menu.unload();\r\n            c.menu = null \r\n        }\r\n        c.base.oncontextmenu = null ;\r\n        e = dhtmlXRibbon.prototype._indexOf(dhtmlXRibbon.prototype.items.buttonSelect.itemCollection, c);\r\n        if (e != -1) {\r\n            dhtmlXRibbon.prototype.items.buttonSelect.itemCollection.splice(e, 1)\r\n        }\r\n        if (dhtmlXRibbon.prototype.items.buttonSelect.itemCollection.length == 0) {\r\n            this._detachEventFromWindow()\r\n        }\r\n    },\r\n    setSkin: function(a, c) {\r\n        if (a.menu instanceof dhtmlXMenuObject) {\r\n            a.menu.setSkin(c)\r\n        }\r\n    },\r\n    _doOnHideMenu: function(a) {\r\n        if (a._skipHiding) {\r\n            a._skipHiding = false\r\n        } else {\r\n            if (/dhxrb_highlight1/.test(a.base.className)) {\r\n                a.base.className = a.base.className.replace(/\\s?dhxrb_highlight1/, \"\")\r\n            }\r\n        }\r\n    },\r\n    _doOnShowMenu: function(a) {\r\n        if (!/dhxrb_highlight1/.test(a.base.className)) {\r\n            a.base.className += \" dhxrb_highlight1\"\r\n        }\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.group = {\r\n    render: function(c, a) {\r\n        var e, g;\r\n        g = {\r\n            base: c,\r\n            id: a.id,\r\n            type: a.type,\r\n            conf: {\r\n                disable: false,\r\n                skin: a.skin\r\n            },\r\n            childIds: []\r\n        };\r\n        c.className = \"dhxrb_group\";\r\n        for (e in a) {\r\n            if (e == \"id\" || e == \"onclick\" || e == \"type\") {\r\n                continue\r\n            }\r\n            g.conf[e] = a[e]\r\n        }\r\n        return g\r\n    },\r\n    callAfterInit: function(h) {\r\n        this._detachEventFromItem(h.base);\r\n        var g, a, m = h.conf.list, n, e, c;\r\n        a = (m) ? m.length : 0;\r\n        for (g = 0; g < a; g++) {\r\n            n = this._addItem(h.id, null , null , m[g]);\r\n            if (n == null ) {\r\n                continue\r\n            }\r\n            e = n.base.childNodes[1];\r\n            if (e && !e.innerHTML && !/\\s?dhxrb_label_hide/i.test(e.className)) {\r\n                e.className += \" dhxrb_label_hide\"\r\n            }\r\n        }\r\n        dhtmlXRibbon.prototype.items.group.normalize(h);\r\n        if (h.conf.disable) {\r\n            this.disable(h.id)\r\n        }\r\n        m = undefined\r\n    },\r\n    normalize: function(n) {\r\n        var a = n.base.children;\r\n        var e = a.length\r\n          , c = false\r\n          , o = 0;\r\n        var g, m;\r\n        for (var h = 0; h < e; h++) {\r\n            if (!/dhxrb_separator_group/i.test(a[h].className)) {\r\n                if (/dhxrb_item_hide/i.test(a[h].className)) {\r\n                    o++;\r\n                    continue\r\n                }\r\n            }\r\n            if ((Math.ceil((h - o) / 2) - Math.floor((h - o) / 2)) == 0) {\r\n                if (/dhxrb_separator_group/i.test(a[h].className)) {\r\n                    a[h].parentNode.removeChild(a[h]);\r\n                    c = true;\r\n                    break\r\n                }\r\n            } else {\r\n                if (!/dhxrb_separator_group/i.test(a[h].className)) {\r\n                    g = document.createElement(\"div\");\r\n                    g.className = \"dhxrb_separator_groupp\";\r\n                    n.base.insertBefore(g, a[h]);\r\n                    c = true;\r\n                    break\r\n                }\r\n            }\r\n        }\r\n        if (c) {\r\n            this.normalize(n)\r\n        } else {\r\n            m = n.base.lastChild;\r\n            if (m && /dhxrb_separator_group/i.test(m.className)) {\r\n                m.parentNode.removeChild(m)\r\n            }\r\n        }\r\n    },\r\n    hideChild: function(c, g) {\r\n        var a = dhtmlXRibbon.prototype._indexOf(c.base.children, g.base);\r\n        if (a == 0) {\r\n            a++\r\n        } else {\r\n            if (a != -1) {\r\n                a--\r\n            } else {\r\n                return\r\n            }\r\n        }\r\n        var e = c.base.children[a];\r\n        if (e && /dhxrb_separator_group/i.test(e.className)) {\r\n            e.parentNode.removeChild(e)\r\n        }\r\n    },\r\n    showChild: function(a) {\r\n        this.normalize(a)\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.input = {\r\n    render: function(c, a) {\r\n        var e, g;\r\n        g = {\r\n            base: c,\r\n            id: a.id,\r\n            type: a.type,\r\n            conf: {\r\n                text: \"\",\r\n                text_pos: (a.isbig) ? \"bottom\" : \"right\",\r\n                img: null ,\r\n                imgdis: null ,\r\n                isbig: false,\r\n                disable: false,\r\n                skin: a.skin,\r\n                value: \"\"\r\n            }\r\n        };\r\n        for (e in a) {\r\n            if (e == \"id\" || e == \"onclick\" || e == \"type\") {\r\n                continue\r\n            }\r\n            g.conf[e] = a[e]\r\n        }\r\n        c.innerHTML = \"<input type='text' class='dhxrb_input'><div class='dhxrb_label_button'>\" + g.conf.text + \"</div>\";\r\n        if (typeof (this.afterRender) == \"function\") {\r\n            this.afterRender(g)\r\n        }\r\n        if (g.conf.disable) {\r\n            this.disable(g)\r\n        }\r\n        if (g.conf.width) {\r\n            this.setWidth(g, g.conf.width)\r\n        }\r\n        if (g.conf.value) {\r\n            this.setValue(g, g.conf.value)\r\n        }\r\n        return g\r\n    },\r\n    callAfterInit: function(c) {\r\n        var a = c.base.childNodes[0];\r\n        this._detachEventFromItem(c.base);\r\n        this._attachEventsToInput(a)\r\n    },\r\n    setText: dhtmlXRibbon.prototype.items.button.setText,\r\n    getText: dhtmlXRibbon.prototype.items.button.getText,\r\n    change: function(c) {\r\n        var a = c.base.childNodes[0];\r\n        c.conf.value = a.value\r\n    },\r\n    keydown: function(c, h, g) {\r\n        if (g.keyCode == 13) {\r\n            var a = c.base.childNodes[0];\r\n            c.conf.value = a.value;\r\n            h.callEvent(\"onEnter\", [c.id, c.conf.value])\r\n        }\r\n    },\r\n    remove: function(c, e) {\r\n        var a = c.base.childNodes[0];\r\n        e._detachEventsFromInput(a)\r\n    },\r\n    getValue: function(c) {\r\n        var a = c.base.childNodes[0], e;\r\n        e = a.value;\r\n        a = undefined;\r\n        return e\r\n    },\r\n    setValue: function(c, e) {\r\n        var a = c.base.childNodes[0], e;\r\n        a.value = e;\r\n        c.conf.value = e\r\n    },\r\n    setWidth: function(c, e) {\r\n        var a = c.base.childNodes[0];\r\n        a.style.width = parseInt(e) + \"px\"\r\n    },\r\n    disable: function(e) {\r\n        var c = e.base.childNodes[0]\r\n          , a = e.base.childNodes[1];\r\n        c.disabled = true;\r\n        if (!/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className += \" dhxrb_disable_text_style\"\r\n        }\r\n        return true\r\n    },\r\n    enable: function(e) {\r\n        var c = e.base.childNodes[0]\r\n          , a = e.base.childNodes[1];\r\n        c.disabled = false;\r\n        if (/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className = a.className.replace(/\\s?dhxrb_disable_text_style/i, \"\")\r\n        }\r\n        return true\r\n    },\r\n    getInput: function(a) {\r\n        return a.base.childNodes[0]\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.getInput = function(c) {\r\n    var a = this._items[c];\r\n    if (a == null  || a.type != \"input\") {\r\n        return null \r\n    }\r\n    return this.items[a.type].getInput(a)\r\n}\r\n;\r\ndhtmlXRibbon.prototype.items.checkbox = {\r\n    render: function(c, a) {\r\n        var e, g;\r\n        g = {\r\n            base: c,\r\n            id: a.id,\r\n            type: a.type,\r\n            conf: {\r\n                text: \"\",\r\n                text_pos: (a.isbig) ? \"bottom\" : \"right\",\r\n                disable: false,\r\n                checked: false\r\n            }\r\n        };\r\n        for (e in a) {\r\n            if (e == \"id\" || e == \"onclick\" || e == \"type\") {\r\n                continue\r\n            }\r\n            g.conf[e] = a[e]\r\n        }\r\n        c.innerHTML = \"<div class='dhxrb_checkbox'></div><div class='dhxrb_label_checkbox'>\" + g.conf.text + \"</div>\";\r\n        if (typeof (this.afterRender) == \"function\") {\r\n            this.afterRender(g)\r\n        }\r\n        if (g.conf.checked) {\r\n            this.check(g)\r\n        }\r\n        return g\r\n    },\r\n    callAfterInit: function(a) {\r\n        if (a.conf.disable) {\r\n            this.disable(a.id)\r\n        }\r\n    },\r\n    setText: dhtmlXRibbon.prototype.items.button.setText,\r\n    getText: dhtmlXRibbon.prototype.items.button.getText,\r\n    mousedown: function(a) {\r\n        return false\r\n    },\r\n    mouseup: function(a) {\r\n        return false\r\n    },\r\n    click: function(a, g, c) {\r\n        if (c.button != 0) {\r\n            return false\r\n        }\r\n        if (a.type == \"checkbox\") {\r\n            if (a.conf.checked) {\r\n                this.uncheck(a, true)\r\n            } else {\r\n                this.check(a, true)\r\n            }\r\n        }\r\n    },\r\n    check: function(a, c) {\r\n        c = c || false;\r\n        if (a.type != \"checkbox\") {\r\n            return\r\n        }\r\n        a.conf.checked = true;\r\n        if (!/\\s?dhxrb_checked/i.test(a.base.className)) {\r\n            a.base.className += \" dhxrb_checked\"\r\n        }\r\n        if (c) {\r\n            a.callEvent(\"onCheck\", [a.id, a.conf.checked])\r\n        }\r\n    },\r\n    uncheck: function(a, c) {\r\n        c = c || false;\r\n        if (a.type != \"checkbox\") {\r\n            return\r\n        }\r\n        a.conf.checked = false;\r\n        if (/\\s?dhxrb_checked/i.test(a.base.className)) {\r\n            a.base.className = a.base.className.replace(/\\s?dhxrb_checked/i, \"\")\r\n        }\r\n        if (c) {\r\n            a.callEvent(\"onCheck\", [a.id, a.conf.checked])\r\n        }\r\n    },\r\n    isChecked: function(a) {\r\n        if (a.type != \"checkbox\") {\r\n            return false\r\n        }\r\n        return ( a.conf.checked == true) \r\n    },\r\n    disable: function(a) {\r\n        return true\r\n    },\r\n    enable: function(a) {\r\n        return true\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.text = {\r\n    render: function(a, g) {\r\n        var e = {\r\n            base: a,\r\n            id: g.id,\r\n            type: g.type,\r\n            conf: {\r\n                text: \"\"\r\n            }\r\n        };\r\n        for (var c in g) {\r\n            if (c == \"id\" || c == \"type\") {\r\n                continue\r\n            }\r\n            e.conf[c] = g[c]\r\n        }\r\n        a.innerHTML = \"<div class='dhxrb_item_text'>\" + e.conf.text + \"</div>\";\r\n        if (typeof (this.afterRender) == \"function\") {\r\n            this.afterRender(e)\r\n        }\r\n        return e\r\n    },\r\n    callAfterInit: function(a) {\r\n        this._detachEventFromItem(a.base)\r\n    },\r\n    getText: function(a) {\r\n        return a.conf.text\r\n    },\r\n    setText: function(a, c) {\r\n        a.conf.text = c;\r\n        a.base.firstChild.innerHTML = a.conf.text\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.buttonCombo = {\r\n    render: function(a, c) {\r\n        var e, g, h = {};\r\n        g = {\r\n            base: a,\r\n            id: c.id,\r\n            type: c.type,\r\n            conf: {\r\n                text: \"\",\r\n                text_pos: \"right\",\r\n                width: 140,\r\n                skin: c.skin,\r\n                callEvent: true,\r\n                mode: c.comboType,\r\n                image_path: c.comboImagePath,\r\n                default_image: c.comboDefaultImage,\r\n                default_image_dis: c.comboDefaultImageDis\r\n            }\r\n        };\r\n        for (e in c) {\r\n            if (e == \"id\" || e == \"onclick\" || e == \"type\") {\r\n                continue\r\n            }\r\n            g.conf[e] = c[e]\r\n        }\r\n        for (e in g.conf) {\r\n            if (e == \"text\" || e == \"text_pos\" || e == \"disable\" || e == \"data\") {\r\n                continue\r\n            }\r\n            h[e] = g.conf[e]\r\n        }\r\n        g.base.className += \" dhxrb_buttoncombo_cont\";\r\n        g.base.innerHTML = \"<div class='dhxrb_buttoncombo'></div><div class='dhxrb_label_button'>\" + g.conf.text + \"</div>\";\r\n        h.parent = g.base.firstChild;\r\n        g.combo = new dhtmlXCombo(h);\r\n        g.combo.setSkin(h.skin);\r\n        g.combo.attachEvent(\"onChange\", function(l, m) {\r\n            g._callHandler(g.id, [l, m]);\r\n            if (g.conf.callEvent == true) {\r\n                g.callEvent(\"onSelectOption\", [g.id, l, m])\r\n            }\r\n            g.conf.callEvent = true\r\n        });\r\n        if (g.conf.data) {\r\n            g.combo.load(g.conf.data);\r\n            delete g.conf.data\r\n        }\r\n        if (typeof (this.afterRender) == \"function\") {\r\n            this.afterRender(g)\r\n        }\r\n        if (g.conf.disable) {\r\n            this.disable(g)\r\n        }\r\n        return g\r\n    },\r\n    callAfterInit: function(a) {\r\n        this._detachEventFromItem(a.base)\r\n    },\r\n    disable: function(c) {\r\n        var a = c.base.lastChild;\r\n        if (c.combo instanceof dhtmlXCombo) {\r\n            c.combo.disable()\r\n        }\r\n        if (!/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className += \" dhxrb_disable_text_style\"\r\n        }\r\n        return true\r\n    },\r\n    enable: function(c) {\r\n        var a = c.base.lastChild;\r\n        if (c.combo instanceof dhtmlXCombo) {\r\n            c.combo.enable()\r\n        }\r\n        if (/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className = a.className.replace(/\\s?dhxrb_disable_text_style/i, \"\")\r\n        }\r\n        return true\r\n    },\r\n    remove: function(a) {\r\n        if (a.combo instanceof dhtmlXCombo) {\r\n            a.combo.unload();\r\n            a.combo = null \r\n        }\r\n    },\r\n    getValue: function(a) {\r\n        var c = null ;\r\n        if (a.combo instanceof dhtmlXCombo) {\r\n            c = a.combo.getSelectedValue()\r\n        }\r\n        return c\r\n    },\r\n    setValue: function(a, c, e) {\r\n        if (a.combo instanceof dhtmlXCombo) {\r\n            a.conf.callEvent = e;\r\n            a.combo.setComboValue(c)\r\n        }\r\n    },\r\n    setSkin: function(a, c) {\r\n        if (a.combo instanceof dhtmlXCombo) {\r\n            a.combo.setSkin(c)\r\n        }\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items.slider = {\r\n    render: function(a, h) {\r\n        var e, g, c = {};\r\n        g = {\r\n            base: a,\r\n            id: h.id,\r\n            type: h.type,\r\n            conf: {\r\n                text: \"\",\r\n                text_pos: \"right\",\r\n                size: 150,\r\n                vertical: false,\r\n                min: 0,\r\n                max: 99,\r\n                value: 0,\r\n                step: 1,\r\n                margin: 10,\r\n                disabled: false,\r\n                enableTooltip: false\r\n            }\r\n        };\r\n        for (e in h) {\r\n            if (e == \"id\" || e == \"onclick\" || e == \"type\") {\r\n                continue\r\n            }\r\n            g.conf[e] = h[e]\r\n        }\r\n        for (e in g.conf) {\r\n            if (e == \"text\" || e == \"text_pos\" || e == \"isbig\") {\r\n                continue\r\n            }\r\n            c[e] = g.conf[e]\r\n        }\r\n        g.base.innerHTML = \"<center><div class='dhxrb_slider'></div></center><div class='dhxrb_label_button'>\" + g.conf.text + \"</div>\";\r\n        c.parent = g.base.firstChild.firstChild;\r\n        g.slider = new dhtmlXSlider(c);\r\n        if (typeof (this.afterRender) == \"function\") {\r\n            this.afterRender(g)\r\n        }\r\n        if (g.conf.disable) {\r\n            this.disable(g)\r\n        }\r\n        g.slider.attachEvent(\"onChange\", function(l) {\r\n            g._callHandler(g.id, [l]);\r\n            g.callEvent(\"onValueChange\", [g.id, l])\r\n        });\r\n        return g\r\n    },\r\n    callAfterInit: function(a) {\r\n        this._detachEventFromItem(a.base)\r\n    },\r\n    setSkin: function(a, c) {\r\n        if (a.slider instanceof dhtmlXSlider) {\r\n            a.slider.setSkin(c)\r\n        }\r\n    },\r\n    disable: function(c) {\r\n        var a = c.base.childNodes[1];\r\n        if (c.slider instanceof dhtmlXSlider) {\r\n            c.slider.disable()\r\n        }\r\n        if (!/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className += \" dhxrb_disable_text_style\"\r\n        }\r\n        return true\r\n    },\r\n    enable: function(c) {\r\n        var a = c.base.childNodes[1];\r\n        if (c.slider instanceof dhtmlXSlider) {\r\n            c.slider.enable()\r\n        }\r\n        if (/\\s?dhxrb_disable_text_style/i.test(a.className)) {\r\n            a.className = a.className.replace(/\\s?dhxrb_disable_text_style/i, \"\")\r\n        }\r\n        return true\r\n    },\r\n    remove: function(a) {\r\n        if (a.slider instanceof dhtmlXSlider) {\r\n            a.slider.unload();\r\n            a.slider = null \r\n        }\r\n    },\r\n    getValue: function(a) {\r\n        var c = null ;\r\n        if (a.slider instanceof dhtmlXSlider) {\r\n            c = a.slider.getValue()\r\n        }\r\n        return c\r\n    },\r\n    setValue: function(a, c) {\r\n        if (a.slider instanceof dhtmlXSlider) {\r\n            a.slider.setValue(c)\r\n        }\r\n    }\r\n};\r\ndhtmlXRibbon.prototype.items._extends = function(e, c) {\r\n    var a;\r\n    for (a in c) {\r\n        e[a] = e[a] || c[a]\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXRibbon.prototype._addNewLevel = function(e) {\r\n    var c, a;\r\n    if (e.conf.mode == \"rows\") {\r\n        c = e.contForItems.lastChild;\r\n        if (c && /dhxrb_block_rows/i.test(c.className) && (c.childNodes.length < 3)) {\r\n            a = document.createElement(\"div\");\r\n            a.className = \"dhxrb_block_row\";\r\n            c.appendChild(a)\r\n        } else {\r\n            c = document.createElement(\"div\");\r\n            c.className = \"dhxrb_block_rows\";\r\n            e.contForItems.appendChild(c);\r\n            a = document.createElement(\"div\");\r\n            a.className = \"dhxrb_block_row\";\r\n            c.appendChild(a)\r\n        }\r\n    } else {\r\n        var a = document.createElement(\"div\");\r\n        a.className = \"dhxrb_3rows_block\";\r\n        e.contForItems.appendChild(a)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._attachEventForItem = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.addEventListener(\"mouseover\", this._doOnHighlight0, false);\r\n        a.addEventListener(\"mouseout\", this._doOffHighlight0, false);\r\n        a.addEventListener(\"mousedown\", this._doOnHighlight1, false);\r\n        a.addEventListener(\"mouseup\", this._doOffHighlight1, false);\r\n        a.addEventListener(\"click\", this._doOnClick, false)\r\n    } else {\r\n        a.attachEvent(\"onmouseover\", this._doOnHighlight0);\r\n        a.attachEvent(\"onmouseout\", this._doOffHighlight0);\r\n        a.attachEvent(\"onmousedown\", this._doOnHighlight1);\r\n        a.attachEvent(\"onmouseup\", this._doOffHighlight1);\r\n        a.attachEvent(\"onclick\", this._doOnClick)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._detachEventFromItem = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.removeEventListener(\"mouseover\", this._doOnHighlight0, false);\r\n        a.removeEventListener(\"mouseout\", this._doOffHighlight0, false);\r\n        a.removeEventListener(\"mousedown\", this._doOnHighlight1, false);\r\n        a.removeEventListener(\"mouseup\", this._doOffHighlight1, false);\r\n        a.removeEventListener(\"click\", this._doOnClick, false)\r\n    } else {\r\n        a.detachEvent(\"onmouseover\", this._doOnHighlight0);\r\n        a.detachEvent(\"onmouseout\", this._doOffHighlight0);\r\n        a.detachEvent(\"onmousedown\", this._doOnHighlight1);\r\n        a.detachEvent(\"onmouseup\", this._doOffHighlight1);\r\n        a.detachEvent(\"onclick\", this._doOnClick)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._attachEventsToInput = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.addEventListener(\"focus\", this._doOnFocus, false);\r\n        a.addEventListener(\"blur\", this._doOnBlur, false);\r\n        a.addEventListener(\"change\", this._doOnChange, false);\r\n        a.addEventListener(\"keydown\", this._doOnKeydown, false)\r\n    } else {\r\n        a.attachEvent(\"onfocus\", this._doOnFocus);\r\n        a.attachEvent(\"onblur\", this._doOnBlur);\r\n        a.attachEvent(\"onchange\", this._doOnChange);\r\n        a.attachEvent(\"onkeydown\", this._doOnKeydown)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._detachEventsFromInput = function(a) {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        a.removeEventListener(\"focus\", this._doOnFocus, false);\r\n        a.removeEventListener(\"blur\", this._doOnBlur, false);\r\n        a.removeEventListener(\"change\", this._doOnChange, false);\r\n        a.removeEventListener(\"keydown\", this._doOnKeydown, false)\r\n    } else {\r\n        a.detachEvent(\"onfocus\", this._doOnFocus);\r\n        a.detachEvent(\"onblur\", this._doOnBlur);\r\n        a.detachEvent(\"onchange\", this._doOnChange);\r\n        a.detachEvent(\"onkeydown\", this._doOnKeydown)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._getContainerForSmallItem = function(e) {\r\n    var c = e.contForItems.lastChild\r\n      , a = null ;\r\n    if (e.conf.mode == \"rows\") {\r\n        if (c && /\\s?dhxrb_block_rows/i.test(c.className)) {\r\n            a = c.lastChild;\r\n            if (!a) {\r\n                a = document.createElement(\"div\");\r\n                a.className = \"dhxrb_block_row\";\r\n                c.appendChild(a)\r\n            }\r\n        } else {\r\n            c = document.createElement(\"div\");\r\n            c.className = \"dhxrb_block_rows\";\r\n            e.contForItems.appendChild(c);\r\n            a = document.createElement(\"div\");\r\n            a.className = \"dhxrb_block_row\";\r\n            c.appendChild(a)\r\n        }\r\n    } else {\r\n        if (c && /dhxrb_3rows_block/i.test(c.className) && (c.childNodes.length < 3)) {\r\n            a = c\r\n        } else {\r\n            a = document.createElement(\"div\");\r\n            a.className = \"dhxrb_3rows_block\";\r\n            e.contForItems.appendChild(a)\r\n        }\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXRibbon.prototype._findItemByNode = function(a) {\r\n    while (a && !a._dhx_ribbonId) {\r\n        a = a.parentNode\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXRibbon.prototype._indexOf = function(a, g) {\r\n    var e, c;\r\n    c = a.length;\r\n    for (e = 0; e < c; e++) {\r\n        if (a[e] == g) {\r\n            return e\r\n        }\r\n    }\r\n    return -1\r\n}\r\n;\r\ndhtmlXRibbon.prototype._removeItem = function(e) {\r\n    var a, g = -1, c = this._items[e.parentId];\r\n    if (e.type == \"group\") {\r\n        this._removeGroup(e);\r\n        return\r\n    }\r\n    delete this._items[e.id];\r\n    a = e.base.parentNode;\r\n    this._detachEventFromItem(e.base);\r\n    a.removeChild(e.base);\r\n    if (c.type == \"block\") {\r\n        if (a != c.contForItems && a.childNodes.length == 0) {\r\n            a.parentNode.removeChild(a)\r\n        }\r\n    } else {\r\n        if (c.type == \"group\") {\r\n            dhtmlXRibbon.prototype.items.group.normalize(c)\r\n        }\r\n    }\r\n    g = this._indexOf(c.childIds, e.id);\r\n    if (g != -1) {\r\n        c.childIds.splice(g, 1)\r\n    }\r\n    if (this.items[e.type] && (typeof (this.items[e.type].remove) == \"function\")) {\r\n        this.items[e.type].remove(e, this)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._removeGroup = function(g) {\r\n    var c = [], l, e = this._items[g.parentId], a = g.base.parentNode;\r\n    for (var h = 0; h < g.childIds.length; h++) {\r\n        c.push(this._items[g.childIds[h]])\r\n    }\r\n    for (var h = 0; h < c.length; h++) {\r\n        this._removeItem(c[h])\r\n    }\r\n    delete this._items[g.id];\r\n    if (g.base.parentNode) {\r\n        a.removeChild(g.base)\r\n    }\r\n    if (a.childNodes.length == 0) {\r\n        a.parentNode.removeChild(a)\r\n    }\r\n    l = this._indexOf(e.childIds, g.id);\r\n    if (l != -1) {\r\n        e.childIds.splice(l, 1)\r\n    }\r\n    if (this.items[g.type] && (typeof (this.items[g.type].remove) == \"function\")) {\r\n        this.items[g.type].remove(g)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._removeBlock = function(h) {\r\n    var a = [], g, c;\r\n    for (var e = 0; e < h.childIds.length; e++) {\r\n        a.push(this._items[h.childIds[e]])\r\n    }\r\n    for (var e = 0; e < a.length; e++) {\r\n        this._removeItem(a[e])\r\n    }\r\n    delete this._items[h.id];\r\n    h.base.parentNode.removeChild(h.base);\r\n    if (h.parentId) {\r\n        c = this._items[h.parentId]\r\n    } else {\r\n        c = this\r\n    }\r\n    g = this._indexOf(c.childIds, h.id);\r\n    if (g != -1) {\r\n        c.childIds.splice(g, 1)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._removeTab = function(c, a) {\r\n    var h = [], g;\r\n    for (var e = 0; e < c.childIds.length; e++) {\r\n        h.push(this._items[c.childIds[e]])\r\n    }\r\n    for (var e = 0; e < h.length; e++) {\r\n        this._removeBlock(h[e])\r\n    }\r\n    delete this._items[c.id];\r\n    g = this._indexOf(this.childIds, c.id);\r\n    if (g != -1) {\r\n        this.childIds.splice(g, 1)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype._skinCollection = {\r\n    dhx_skyblue: true,\r\n    dhx_web: true,\r\n    dhx_terrace: true\r\n};\r\ndhtmlXRibbon.prototype._setSkinForItems = function(e) {\r\n    var a, c;\r\n    for (a in this._items) {\r\n        c = this._items[a];\r\n        c.conf.skin = e;\r\n        if (dhtmlXRibbon.prototype.items[c.type] && typeof (dhtmlXRibbon.prototype.items[c.type].setSkin) == \"function\") {\r\n            dhtmlXRibbon.prototype.items[c.type].setSkin(c, e)\r\n        }\r\n    }\r\n    c = undefined,\r\n    a = undefined\r\n}\r\n;\r\ndhtmlXRibbon.prototype._setBlockText = function(a, c) {\r\n    a.conf.text = c;\r\n    a.contForText.innerHTML = c;\r\n    if (!c && (c != 0) && a.contForText.parentNode) {\r\n        a.contForText.parentNode.removeChild(a.contForText)\r\n    } else {\r\n        if (!a.contForText.parentNode) {\r\n            if (a.conf.text_pos == \"top\") {\r\n                a.base.insertBefore(a.contForText, a.contForItems)\r\n            } else {\r\n                a.base.appendChild(a.contForText)\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.hide = function(e) {\r\n    var c = this._items[e];\r\n    if (this.items[c.type] && (typeof (this.items[c.type].hide) == \"function\")) {\r\n        if (this.items[c.type].hide(c) != true) {\r\n            return\r\n        }\r\n    }\r\n    if (c.type == \"tab\") {\r\n        return\r\n    } else {\r\n        if (!/\\s?dhxrb_item_hide/i.test(c.base.className)) {\r\n            c.base.className += \" dhxrb_item_hide\"\r\n        }\r\n    }\r\n    var a = this._items[c.parentId];\r\n    if (a && this.items[a.type] && (typeof (this.items[a.type].hideChild) == \"function\")) {\r\n        this.items[a.type].hideChild(a, c)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.show = function(e) {\r\n    var c = this._items[e];\r\n    if (this.items[c.type] && (typeof (this.items[c.type].show) == \"function\")) {\r\n        if (this.items[c.type].show(c) != true) {\r\n            return\r\n        }\r\n    }\r\n    if (c.type == \"tab\") {\r\n        return\r\n    } else {\r\n        if (/\\s?dhxrb_item_hide/i.test(c.base.className)) {\r\n            c.base.className = c.base.className.replace(/\\s?dhxrb_item_hide/i, \"\")\r\n        }\r\n    }\r\n    var a = this._items[c.parentId];\r\n    if (a && this.items[a.type] && (typeof (this.items[a.type].showChild) == \"function\")) {\r\n        this.items[a.type].showChild(a, c)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.check = function(e, c) {\r\n    c = dhx4.s2b(c);\r\n    var a = this._items[e];\r\n    if (a && !a.conf.checked && typeof (this.items[a.type].check) == \"function\") {\r\n        this.items[a.type].check(a);\r\n        if (c) {\r\n            this.callEvent(\"onCheck\", [a.id, a.conf.checked])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.uncheck = function(e, c) {\r\n    c = dhx4.s2b(c);\r\n    var a = this._items[e];\r\n    if (a && a.conf.checked && typeof (this.items[a.type].uncheck) == \"function\") {\r\n        this.items[a.type].uncheck(a);\r\n        if (c) {\r\n            this.callEvent(\"onCheck\", [a.id, a.conf.checked])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.isChecked = function(c) {\r\n    var a = this._items[c];\r\n    if (a && typeof (this.items[a.type].isChecked) == \"function\") {\r\n        return this.items[a.type].isChecked(a)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.disable = function(g, a) {\r\n    var c = this._items[g];\r\n    if (this.items[c.type] && (typeof (this.items[c.type].disable) == \"function\")) {\r\n        if (this.items[c.type].disable(c) != true) {\r\n            return\r\n        }\r\n    }\r\n    if (c.type == \"tab\") {\r\n        return\r\n    } else {\r\n        if (c.type == \"block\" || c.type == \"group\") {\r\n            for (var e = 0; e < c.childIds.length; e++) {\r\n                this.disable(c.childIds[e])\r\n            }\r\n        }\r\n    }\r\n    if (!/\\s?dhxrb_item_disable/i.test(c.base.className)) {\r\n        c.base.className += \" dhxrb_item_disable\"\r\n    }\r\n    c.conf.disable = true\r\n}\r\n;\r\ndhtmlXRibbon.prototype.enable = function(e, a) {\r\n    var c = this._items[e];\r\n    if (this.items[c.type] && (typeof (this.items[c.type].enable) == \"function\")) {\r\n        if (this.items[c.type].enable(c) != true) {\r\n            return\r\n        }\r\n    }\r\n    if (c.type == \"tab\") {\r\n        return\r\n    } else {\r\n        if (c.type == \"block\" || c.type == \"group\") {\r\n            for (q = 0; q < c.childIds.length; q++) {\r\n                this.enable(c.childIds[q])\r\n            }\r\n        }\r\n    }\r\n    if (/\\s?dhxrb_item_disable/i.test(c.base.className)) {\r\n        c.base.className = c.base.className.replace(/\\s?dhxrb_item_disable/i, \"\")\r\n    }\r\n    c.conf.disable = false\r\n}\r\n;\r\ndhtmlXRibbon.prototype.isEnabled = function(c) {\r\n    var a = this._items[c];\r\n    if (this.items[a.type] && typeof (this.items[a.type].isEnabled) == \"function\") {\r\n        return this.items[a.type].isEnabled(a)\r\n    }\r\n    if (a.type == \"tab\") {\r\n        return\r\n    } else {\r\n        return a.conf.disable != true\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.isVisible = function(c) {\r\n    var a = this._items[c];\r\n    if (this.items[a.type] && (typeof (this.items[a.type].isVisible) == \"function\")) {\r\n        return this.items[a.type].isVisible(a)\r\n    }\r\n    if (a.type == \"tab\") {\r\n        return\r\n    } else {\r\n        return !/\\s?dhxrb_item_hide/i.test(a.base.className)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.setItemState = function(g, c, e) {\r\n    c = dhx4.s2b(c);\r\n    e = dhx4.s2b(e);\r\n    var a = this._items[g];\r\n    if (a && (typeof (this.items[a.type].setState) == \"function\")) {\r\n        switch (a.type) {\r\n        case \"buttonSegment\":\r\n            this.items[a.type].setState(a, this, e);\r\n            break;\r\n        default:\r\n            this.items[a.type].setState(a, c, e)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.getItemState = function(c) {\r\n    var a = this._items[c];\r\n    if (a && (typeof (this.items[a.type].getState) == \"function\")) {\r\n        switch (a.type) {\r\n        case \"buttonTwoState\":\r\n        case \"buttonSegment\":\r\n            return this.items[a.type].getState(a);\r\n            break\r\n        }\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXRibbon.prototype.setIconPath = function(a) {\r\n    this.conf.icons_path = a\r\n}\r\n;\r\ndhtmlXRibbon.prototype.removeItem = function(c) {\r\n    var a = this._items[c];\r\n    if (a == null ) {\r\n        return\r\n    }\r\n    switch (a.type) {\r\n    case \"tab\":\r\n        break;\r\n    case \"block\":\r\n        this._removeBlock(a);\r\n        break;\r\n    case \"group\":\r\n        this._removeGroup(a);\r\n        break;\r\n    default:\r\n        this._removeItem(a)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.setSkin = function(h) {\r\n    h = (typeof (h) == \"string\") ? h.toLowerCase() : \"\";\r\n    if (this._skinCollection[h] != true) {\r\n        return\r\n    }\r\n    var e, c = -1, a, g = \"dhtmlxribbon\";\r\n    e = this._base.className.match(/\\S\\w+/ig);\r\n    if (e instanceof Array) {\r\n        for (a in this._skinCollection) {\r\n            if (c == -1) {\r\n                c = this._indexOf(e, g + \"_\" + a)\r\n            } else {\r\n                break\r\n            }\r\n        }\r\n        c = (c == -1) ? e.length : c\r\n    } else {\r\n        e = [];\r\n        c = 0\r\n    }\r\n    e[c] = g + \"_\" + h;\r\n    this._base.className = e.join(\" \");\r\n    this.conf.skin = h;\r\n    if (this._tabbar != null ) {\r\n        this._tabbar.setSkin(h)\r\n    }\r\n    this._setSkinForItems(h)\r\n}\r\n;\r\ndhtmlXRibbon.prototype.tabs = function(a) {\r\n    if (this._tabbar instanceof dhtmlXTabBar) {\r\n        return this._tabbar.tabs(a)\r\n    } else {\r\n        return undefined\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.getItemType = function(c) {\r\n    var a = this._items[c];\r\n    if (a) {\r\n        return a.type\r\n    } else {\r\n        return undefined\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.getValue = function(e) {\r\n    var a = this._items[e]\r\n      , c = undefined;\r\n    if (a && this.items[a.type] && typeof (this.items[a.type].getValue) == \"function\") {\r\n        c = this.items[a.type].getValue(a)\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXRibbon.prototype.setValue = function(g, c, e) {\r\n    var a = this._items[g];\r\n    e = (e === false ? false : true);\r\n    if (a && this.items[a.type] && typeof (this.items[a.type].setValue) == \"function\") {\r\n        this.items[a.type].setValue(a, c, e)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.getItemText = function(c) {\r\n    var a = this._items[c];\r\n    if (!a) {\r\n        return null \r\n    } else {\r\n        if (a.type == \"tab\") {\r\n            return this.tabs(a.id).getText()\r\n        } else {\r\n            if (a.type == \"block\") {\r\n                return this.items.button.getText(a)\r\n            } else {\r\n                if (this.items[a.type] && typeof (this.items[a.type].getText) == \"function\") {\r\n                    return this.items[a.type].getText(a)\r\n                } else {\r\n                    return null \r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.setItemText = function(e, c) {\r\n    var a = this._items[e];\r\n    if (!a) {\r\n        return\r\n    } else {\r\n        if (a.type == \"tab\") {\r\n            this.tabs(a.id).setText(c)\r\n        } else {\r\n            if (a.type == \"block\") {\r\n                this._setBlockText(a, c)\r\n            } else {\r\n                if (this.items[a.type] && typeof (this.items[a.type].setText) == \"function\") {\r\n                    this.items[a.type].setText(a, c)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.setItemOptionText = function(g, e, c) {\r\n    var a = this._items[g];\r\n    if (a.type == \"buttonSelect\") {\r\n        this.items[a.type].setOptionText(a, e, c)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.getItemOptionText = function(e, c) {\r\n    var a = this._items[e];\r\n    if (a.type == \"buttonSelect\") {\r\n        return this.items[a.type].getOptionText(a, c)\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXRibbon.prototype.setItemImage = function(e, a) {\r\n    var c = this._items[e];\r\n    if (c != null  && this.items[c.type] != null  && typeof (this.items[c.type].setImage) == \"function\") {\r\n        this.items[c.type].setImage(c, a)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.setItemImageDis = function(e, a) {\r\n    var c = this._items[e];\r\n    if (c != null  && this.items[c.type] != null  && typeof (this.items[c.type].setImageDis) == \"function\") {\r\n        this.items[c.type].setImageDis(c, a)\r\n    }\r\n}\r\n;\r\ndhtmlXRibbon.prototype.getCombo = function(c) {\r\n    var a = this._items[c];\r\n    if (a != null  && a.type == \"buttonCombo\") {\r\n        return a.combo\r\n    }\r\n    return null \r\n}\r\n;\r\n(function() {\r\n    var a = dhtmlXRibbon.prototype.items;\r\n    a.buttonTwoState = a._extends(a.buttonTwoState, a.button);\r\n    a.buttonSelect = a._extends(a.buttonSelect, a.buttonTwoState);\r\n    a.buttonSegment = a._extends(a.buttonSegment, a.buttonTwoState)\r\n})();\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype._createNode_ribbon = function(h, c, g, a, e) {\r\n        if (typeof (e) != \"undefined\") {\r\n            h = e\r\n        } else {\r\n            h = document.createElement(\"DIV\");\r\n            h.className = \"dhx_cell_ribbon_\" + (this.conf.borders ? \"def\" : \"no_borders\");\r\n            h.appendChild(document.createElement(\"DIV\"))\r\n        }\r\n        this.cell.insertBefore(h, this.cell.childNodes[this.conf.idx.cont]);\r\n        this.conf.ofs_nodes.t.ribbon = true;\r\n        this._updateIdx();\r\n        this._adjustCont(this._idd);\r\n        return h\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.attachRibbon = function(a) {\r\n        if (!(this.dataNodes.ribbon == null  && this.dataNodes.toolbar == null )) {\r\n            return\r\n        }\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"ribbon\"]);\r\n        if (typeof (a) == \"undefined\") {\r\n            a = {}\r\n        }\r\n        if (typeof (a.skin) == \"undefined\") {\r\n            a.skin = this.conf.skin\r\n        }\r\n        a.parent = this._attachObject(\"ribbon\").firstChild;\r\n        this.dataNodes.ribbon = new dhtmlXRibbon(a);\r\n        var c = this;\r\n        this.dataNodes.ribbon.attachEvent(\"_onHeightChanged\", function() {\r\n            c._adjustCont(c._idd)\r\n        });\r\n        this._adjustCont();\r\n        a.parent = null ;\r\n        a = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataNodes.ribbon\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.detachRibbon = function() {\r\n        if (!this.dataNodes.ribbon) {\r\n            return\r\n        }\r\n        this.dataNodes.ribbon.unload();\r\n        this.dataNodes.ribbon = null ;\r\n        delete this.dataNodes.ribbon;\r\n        this._detachObject(\"ribbon\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.showRibbon = function() {\r\n        this._mtbShowHide(\"ribbon\", \"\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.hideRibbon = function() {\r\n        this._mtbShowHide(\"ribbon\", \"none\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.getAttachedRibbon = function() {\r\n        return this.dataNodes.ribbon\r\n    }\r\n}\r\nfunction dhtmlXToolbarObject(c, e) {\r\n    var a = this;\r\n    this.conf = {\r\n        skin: (e || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxtoolbar\") || \"dhx_skyblue\"),\r\n        align: \"left\",\r\n        align_autostart: \"left\",\r\n        icons_path: \"\",\r\n        iconSize: 18,\r\n        sel_ofs_x: 0,\r\n        sel_ofs_y: 0,\r\n        xml_autoload: null ,\r\n        items_autoload: null \r\n    };\r\n    if (typeof (c) == \"object\" && c != null  && typeof (c.tagName) == \"undefined\") {\r\n        if (c.icons_path != null  || c.icon_path != null ) {\r\n            this.conf.icons_path = (c.icons_path || c.icon_path)\r\n        }\r\n        if (c.icons_size != null ) {\r\n            this.conf.icons_size_autoload = c.icons_size\r\n        }\r\n        if (c.json != null ) {\r\n            this.conf.json_autoload = c.json\r\n        }\r\n        if (c.xml != null ) {\r\n            this.conf.xml_autoload = c.xml\r\n        }\r\n        if (c.onload != null ) {\r\n            this.conf.onload_autoload = c.onload\r\n        }\r\n        if (c.onclick != null  || c.onClick != null ) {\r\n            this.conf.auto_onclick = (c.onclick || c.onClick)\r\n        }\r\n        if (c.items != null ) {\r\n            this.conf.items_autoload = c.items\r\n        }\r\n        if (c.skin != null ) {\r\n            this.conf.skin = c.skin\r\n        }\r\n        if (c.align != null ) {\r\n            this.conf.align_autostart = c.align\r\n        }\r\n        c = c.parent\r\n    }\r\n    this.cont = (typeof (c) != \"object\") ? document.getElementById(c) : c;\r\n    while (this.cont.childNodes.length > 0) {\r\n        this.cont.removeChild(this.cont.childNodes[0])\r\n    }\r\n    c = null ;\r\n    this.cont.dir = \"ltr\";\r\n    this.base = document.createElement(\"DIV\");\r\n    this.base.className = \"dhxtoolbar_float_left\";\r\n    this.cont.appendChild(this.base);\r\n    this.cont.ontouchstart = function(g) {\r\n        g = g || event;\r\n        if ((String(g.target.tagName || \"\").toLowerCase() == \"input\") ) {\r\n            return true\r\n        }\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        g.cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    this.setSkin(this.conf.skin);\r\n    this.objPull = {};\r\n    this.anyUsed = \"none\";\r\n    this._genStr = function(g) {\r\n        var h = \"dhxId_\";\r\n        var m = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\r\n        for (var l = 0; l < g; l++) {\r\n            h += m.charAt(Math.round(Math.random() * (m.length - 1)))\r\n        }\r\n        return h\r\n    }\r\n    ;\r\n    this.rootTypes = new Array(\"button\",\"buttonSelect\",\"buttonTwoState\",\"separator\",\"label\",\"slider\",\"text\",\"buttonInput\");\r\n    this.idPrefix = this._genStr(12);\r\n    window.dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToJson\", \"toolbar\", {\r\n        struct: true\r\n    });\r\n    window.dhx4._eventable(this);\r\n    this._getObj = function(m, g) {\r\n        var h = null ;\r\n        for (var l = 0; l < m.childNodes.length; l++) {\r\n            if (m.childNodes[l].tagName != null ) {\r\n                if (String(m.childNodes[l].tagName).toLowerCase() == String(g).toLowerCase()) {\r\n                    h = m.childNodes[l]\r\n                }\r\n            }\r\n        }\r\n        return h\r\n    }\r\n    ;\r\n    this._addImgObj = function(h) {\r\n        var g = document.createElement(\"IMG\");\r\n        if (h.childNodes.length > 0) {\r\n            h.insertBefore(g, h.childNodes[0])\r\n        } else {\r\n            h.appendChild(g)\r\n        }\r\n        return g\r\n    }\r\n    ;\r\n    this._setItemImage = function(m, h, g) {\r\n        if (g == true) {\r\n            m.imgEn = h\r\n        } else {\r\n            m.imgDis = h\r\n        }\r\n        if ((!m.state && g == true) || (m.state && g == false)) {\r\n            return\r\n        }\r\n        var l = this._getObj(m.obj, \"img\");\r\n        if (l == null ) {\r\n            l = this._addImgObj(m.obj)\r\n        }\r\n        l.src = this.conf.icons_path + h\r\n    }\r\n    ;\r\n    this._clearItemImage = function(l, g) {\r\n        if (g == true) {\r\n            l.imgEn = \"\"\r\n        } else {\r\n            l.imgDis = \"\"\r\n        }\r\n        if ((!l.state && g == true) || (l.state && g == false)) {\r\n            return\r\n        }\r\n        var h = this._getObj(l.obj, \"img\");\r\n        if (h != null ) {\r\n            h.parentNode.removeChild(h)\r\n        }\r\n    }\r\n    ;\r\n    this._setItemText = function(g, l) {\r\n        var h = this._getObj(g.obj, \"div\");\r\n        if (l == null  || l.length == 0) {\r\n            if (h != null ) {\r\n                h.parentNode.removeChild(h)\r\n            }\r\n            return\r\n        }\r\n        if (h == null ) {\r\n            h = document.createElement(\"DIV\");\r\n            h.className = \"dhxtoolbar_text\";\r\n            g.obj.appendChild(h)\r\n        }\r\n        h.innerHTML = l\r\n    }\r\n    ;\r\n    this._getItemText = function(g) {\r\n        var h = this._getObj(g.obj, \"div\");\r\n        if (h != null ) {\r\n            return h.innerHTML\r\n        }\r\n        return \"\"\r\n    }\r\n    ;\r\n    this._enableItem = function(h) {\r\n        if (h.state) {\r\n            return\r\n        }\r\n        h.state = true;\r\n        if (this.objPull[h.id][\"type\"] == \"buttonTwoState\" && this.objPull[h.id][\"obj\"][\"pressed\"] == true) {\r\n            h.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_pres\";\r\n            h.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_over\"\r\n        } else {\r\n            h.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n            h.obj.renderAs = h.obj.className\r\n        }\r\n        if (h.arw) {\r\n            h.arw.className = String(h.obj.className).replace(\"btn\", \"arw\")\r\n        }\r\n        var g = this._getObj(h.obj, \"img\");\r\n        if (h.imgEn != \"\") {\r\n            if (g == null ) {\r\n                g = this._addImgObj(h.obj)\r\n            }\r\n            g.src = this.conf.icons_path + h.imgEn\r\n        } else {\r\n            if (g != null ) {\r\n                g.parentNode.removeChild(g)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._disableItem = function(h) {\r\n        if (!h.state) {\r\n            return\r\n        }\r\n        h.state = false;\r\n        h.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_\" + (this.objPull[h.id][\"type\"] == \"buttonTwoState\" && h.obj.pressed ? \"pres_\" : \"\") + \"dis\";\r\n        h.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n        if (h.arw) {\r\n            h.arw.className = String(h.obj.className).replace(\"btn\", \"arw\")\r\n        }\r\n        var g = this._getObj(h.obj, \"img\");\r\n        if (h.imgDis != \"\") {\r\n            if (g == null ) {\r\n                g = this._addImgObj(h.obj)\r\n            }\r\n            g.src = this.conf.icons_path + h.imgDis\r\n        } else {\r\n            if (g != null ) {\r\n                g.parentNode.removeChild(g)\r\n            }\r\n        }\r\n        if (h.polygon != null ) {\r\n            if (h.polygon.style.display != \"none\") {\r\n                window.dhx4.zim.clear(h.polygon._idd);\r\n                h.polygon.style.display = \"none\";\r\n                if (h.polygon._ie6cover) {\r\n                    h.polygon._ie6cover.style.display = \"none\"\r\n                }\r\n                if (this.conf.skin == \"dhx_terrace\") {\r\n                    this._improveTerraceButtonSelect(h.id, true)\r\n                }\r\n                this.callEvent(\"onButtonSelectHide\", [h.obj.idd])\r\n            }\r\n        }\r\n        this.anyUsed = \"none\"\r\n    }\r\n    ;\r\n    this.clearAll = function() {\r\n        for (var g in this.objPull) {\r\n            this._removeItem(String(g).replace(this.idPrefix, \"\"))\r\n        }\r\n    }\r\n    ;\r\n    this._doOnClick = function(g) {\r\n        if (a && a.forEachItem) {\r\n            a.forEachItem(function(l) {\r\n                if (a.objPull[a.idPrefix + l][\"type\"] == \"buttonSelect\") {\r\n                    var h = a.objPull[a.idPrefix + l];\r\n                    if (h.arw._skip === true) {\r\n                        h.arw._skip = false\r\n                    } else {\r\n                        if (h.polygon.style.display != \"none\") {\r\n                            h.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n                            h.obj.className = h.obj.renderAs;\r\n                            h.arw.className = String(h.obj.renderAs).replace(\"btn\", \"arw\");\r\n                            a.anyUsed = \"none\";\r\n                            window.dhx4.zim.clear(h.polygon._idd);\r\n                            h.polygon.style.display = \"none\";\r\n                            if (h.polygon._ie6cover) {\r\n                                h.polygon._ie6cover.style.display = \"none\"\r\n                            }\r\n                            if (a.conf.skin == \"dhx_terrace\") {\r\n                                a._improveTerraceButtonSelect(h.id, true)\r\n                            }\r\n                            a.callEvent(\"onButtonSelectHide\", [h.obj.idd])\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) != \"undefined\") {\r\n        window.addEventListener(\"mousedown\", this._doOnClick, false);\r\n        window.addEventListener(\"touchstart\", this._doOnClick, false)\r\n    } else {\r\n        document.body.attachEvent(\"onmousedown\", this._doOnClick)\r\n    }\r\n    if (this.conf.icons_size_autoload != null ) {\r\n        this.setIconSize(this.conf.icons_size_autoload);\r\n        this.conf.icons_size_autoload = null \r\n    }\r\n    if (this.conf.items_autoload != null ) {\r\n        this.loadStruct(this.conf.items_autoload, this.conf.onload_autoload);\r\n        this.conf.items_autoload = null \r\n    } else {\r\n        if (this.conf.json_autoload != null ) {\r\n            this.loadStruct(this.conf.json_autoload, this.conf.onload_autoload);\r\n            this.conf.json_autoload = null \r\n        } else {\r\n            if (this.conf.xml_autoload != null ) {\r\n                this.loadStruct(this.conf.xml_autoload, this.conf.onload_autoload);\r\n                this.conf.xml_autoload = null \r\n            }\r\n        }\r\n    }\r\n    if (this.conf.align_autostart != this.conf.align) {\r\n        this.setAlign(this.conf.align_autostart);\r\n        this.conf.align_autostart = null \r\n    }\r\n    if (typeof (this.conf.auto_onclick) == \"function\") {\r\n        this.attachEvent(\"onClick\", this.conf.auto_onclick)\r\n    } else {\r\n        if (typeof (this.conf.auto_onclick) == \"string\" && typeof (window[this.conf.auto_onclick]) == \"function\") {\r\n            this.attachEvent(\"onClick\", window[this.conf.auto_onclick])\r\n        }\r\n    }\r\n    return this\r\n}\r\ndhtmlXToolbarObject.prototype.addSpacer = function(e) {\r\n    var c = this.idPrefix + e;\r\n    if (this._spacer != null ) {\r\n        if (this._spacer.idd == e) {\r\n            return\r\n        }\r\n        if (this._spacer == this.objPull[c].obj.parentNode) {\r\n            var a = true;\r\n            while (a) {\r\n                var m = this._spacer.childNodes[0].idd;\r\n                this.base.appendChild(this._spacer.childNodes[0]);\r\n                if (m == e || this._spacer.childNodes.length == 0) {\r\n                    if (this.objPull[c].arw != null ) {\r\n                        this.base.appendChild(this.objPull[c].arw)\r\n                    }\r\n                    a = false\r\n                }\r\n            }\r\n            this._spacer.idd = e;\r\n            this._fixSpacer();\r\n            return\r\n        }\r\n        if (this.base == this.objPull[c].obj.parentNode) {\r\n            var a = true;\r\n            var l = (this.objPull[c].arw != null );\r\n            while (a) {\r\n                var g = this.base.childNodes.length - 1;\r\n                if (l == true) {\r\n                    if (this.base.childNodes[g] == this.objPull[c].arw) {\r\n                        a = false\r\n                    }\r\n                }\r\n                if (this.base.childNodes[g].idd == e) {\r\n                    a = false\r\n                }\r\n                if (a) {\r\n                    if (this._spacer.childNodes.length > 0) {\r\n                        this._spacer.insertBefore(this.base.childNodes[g], this._spacer.childNodes[0])\r\n                    } else {\r\n                        this._spacer.appendChild(this.base.childNodes[g])\r\n                    }\r\n                }\r\n            }\r\n            this._spacer.idd = e;\r\n            this._fixSpacer();\r\n            return\r\n        }\r\n    } else {\r\n        var h = null ;\r\n        for (var g = 0; g < this.base.childNodes.length; g++) {\r\n            if (this.base.childNodes[g] == this.objPull[this.idPrefix + e].obj) {\r\n                h = g;\r\n                if (this.objPull[this.idPrefix + e].arw != null ) {\r\n                    h = g + 1\r\n                }\r\n            }\r\n        }\r\n        if (h != null ) {\r\n            this._spacer = document.createElement(\"DIV\");\r\n            this._spacer.className = (this.conf.align == \"right\" ? \" dhxtoolbar_float_left\" : \" dhxtoolbar_float_right\");\r\n            this._spacer.dir = \"ltr\";\r\n            this._spacer.idd = e;\r\n            while (this.base.childNodes.length > h + 1) {\r\n                this._spacer.appendChild(this.base.childNodes[h + 1])\r\n            }\r\n            this.cont.appendChild(this._spacer);\r\n            this._fixSpacer()\r\n        }\r\n    }\r\n    if (this.conf.skin == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.removeSpacer = function() {\r\n    if (!this._spacer) {\r\n        return\r\n    }\r\n    while (this._spacer.childNodes.length > 0) {\r\n        this.base.appendChild(this._spacer.childNodes[0])\r\n    }\r\n    this._spacer.parentNode.removeChild(this._spacer);\r\n    this._spacer = null ;\r\n    if (this.conf.skin == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._fixSpacer = function() {\r\n    if (typeof (window.addEventListener) == \"undefined\" && this._spacer != null ) {\r\n        this._spacer.style.borderLeft = \"1px solid #a4bed4\";\r\n        var a = this._spacer;\r\n        window.setTimeout(function() {\r\n            a.style.borderLeft = \"0px solid #a4bed4\";\r\n            a = null \r\n        }, 1)\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.getType = function(e) {\r\n    var g = this.getParentId(e);\r\n    if (g != null ) {\r\n        var c = null ;\r\n        var a = this.objPull[this.idPrefix + g]._listOptions[e];\r\n        if (a != null ) {\r\n            if (a.sep != null ) {\r\n                c = \"buttonSelectSeparator\"\r\n            } else {\r\n                c = \"buttonSelectButton\"\r\n            }\r\n        }\r\n        return c\r\n    } else {\r\n        if (this.objPull[this.idPrefix + e] == null ) {\r\n            return null \r\n        }\r\n        return this.objPull[this.idPrefix + e][\"type\"]\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.getTypeExt = function(c) {\r\n    var a = this.getType(c);\r\n    if (a == \"buttonSelectButton\" || a == \"buttonSelectSeparator\") {\r\n        if (a == \"buttonSelectButton\") {\r\n            a = \"button\"\r\n        } else {\r\n            a = \"separator\"\r\n        }\r\n        return a\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.inArray = function(e, c) {\r\n    for (var a = 0; a < e.length; a++) {\r\n        if (e[a] == c) {\r\n            return true\r\n        }\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.getParentId = function(g) {\r\n    var h = null ;\r\n    for (var e in this.objPull) {\r\n        if (this.objPull[e]._listOptions) {\r\n            for (var c in this.objPull[e]._listOptions) {\r\n                if (c == g) {\r\n                    h = String(e).replace(this.idPrefix, \"\")\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._addItem = function(a, c) {\r\n    if (typeof (a.text) == \"string\") {\r\n        a.text = window.dhx4.trim(a.text);\r\n        if (a.text.length == 0) {\r\n            a.text = null \r\n        }\r\n    }\r\n    this._addItemToStorage(a, c);\r\n    if (this.conf.skin == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addButton = function(h, g, c, a, e) {\r\n    this._addItem({\r\n        id: h,\r\n        type: \"button\",\r\n        text: c,\r\n        img: a,\r\n        imgdis: e\r\n    }, g)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addText = function(e, c, a) {\r\n    this._addItem({\r\n        id: e,\r\n        type: \"text\",\r\n        text: a\r\n    }, c)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addButtonSelect = function(g, n, s, a, c, o, m, w, h, l) {\r\n    var v = [];\r\n    for (var e = 0; e < a.length; e++) {\r\n        var r = {};\r\n        if (a[e] instanceof Array) {\r\n            r.id = a[e][0];\r\n            r.type = (a[e][1] == \"obj\" ? \"button\" : \"separator\");\r\n            r.text = (a[e][2] || null );\r\n            r.img = (a[e][3] || null )\r\n        } else {\r\n            if (a[e] instanceof Object && a[e] != null  && typeof (a[e].id) != \"undefined\" && typeof (a[e].type) != \"undefined\") {\r\n                r.id = a[e].id;\r\n                r.type = (a[e].type == \"obj\" ? \"button\" : \"separator\");\r\n                r.text = a[e].text;\r\n                r.img = a[e].img\r\n            }\r\n        }\r\n        v.push(r)\r\n    }\r\n    this._addItem({\r\n        id: g,\r\n        type: \"buttonSelect\",\r\n        text: s,\r\n        img: c,\r\n        imgdis: o,\r\n        renderSelect: m,\r\n        openAll: w,\r\n        options: v,\r\n        maxOpen: h,\r\n        mode: l\r\n    }, n)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addButtonTwoState = function(h, g, c, a, e) {\r\n    this._addItem({\r\n        id: h,\r\n        type: \"buttonTwoState\",\r\n        img: a,\r\n        imgdis: e,\r\n        text: c\r\n    }, g)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addSeparator = function(c, a) {\r\n    this._addItem({\r\n        id: c,\r\n        type: \"separator\"\r\n    }, a)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addSlider = function(c, m, h, g, o, e, l, a, n) {\r\n    this._addItem({\r\n        id: c,\r\n        type: \"slider\",\r\n        length: h,\r\n        valueMin: g,\r\n        valueMax: o,\r\n        valueNow: e,\r\n        textMin: l,\r\n        textMax: a,\r\n        toolTip: n\r\n    }, m)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.addInput = function(g, e, c, a) {\r\n    this._addItem({\r\n        id: g,\r\n        type: \"buttonInput\",\r\n        value: c,\r\n        width: a\r\n    }, e)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.forEachItem = function(e) {\r\n    for (var c in this.objPull) {\r\n        if (this.inArray(this.rootTypes, this.objPull[c][\"type\"])) {\r\n            e(this.objPull[c][\"id\"].replace(this.idPrefix, \"\"))\r\n        }\r\n    }\r\n}\r\n;\r\n(function() {\r\n    var l = \"isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen\".split(\",\");\r\n    var e = [false, \"\", \"\", false, \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", false, \"\", \"\", \"\", null , \"\", [null , null ], \"\", [null , null ], \"\", null ];\r\n    var c = function(m, n) {\r\n        return function(s, r, o) {\r\n            s = this.idPrefix + s;\r\n            if (this.objPull[s][m] != null ) {\r\n                return this.objPull[s][m].call(this.objPull[s], r, o)\r\n            } else {\r\n                return n\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    for (var h = 0; h < l.length; h++) {\r\n        var a = l[h];\r\n        var g = e[h];\r\n        dhtmlXToolbarObject.prototype[a] = c(a, g)\r\n    }\r\n})();\r\ndhtmlXToolbarObject.prototype.showItem = function(a) {\r\n    a = this.idPrefix + a;\r\n    if (this.objPull[a] != null  && this.objPull[a].showItem != null ) {\r\n        this.objPull[a].showItem();\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            this._improveTerraceSkin()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.hideItem = function(a) {\r\n    a = this.idPrefix + a;\r\n    if (this.objPull[a] != null  && this.objPull[a].hideItem != null ) {\r\n        this.objPull[a].hideItem();\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            this._improveTerraceSkin()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.getPosition = function(a) {\r\n    return this._getPosition(a)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._getPosition = function(h, e) {\r\n    if (this.objPull[this.idPrefix + h] == null ) {\r\n        return null \r\n    }\r\n    var g = null ;\r\n    var a = 0;\r\n    for (var c = 0; c < this.base.childNodes.length; c++) {\r\n        if (this.base.childNodes[c].idd != null ) {\r\n            if (this.base.childNodes[c].idd == h) {\r\n                g = a\r\n            }\r\n            a++\r\n        }\r\n    }\r\n    if (!g && this._spacer != null ) {\r\n        for (var c = 0; c < this._spacer.childNodes.length; c++) {\r\n            if (this._spacer.childNodes[c].idd != null ) {\r\n                if (this._spacer.childNodes[c].idd == h) {\r\n                    g = a\r\n                }\r\n                a++\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setPosition = function(a, c) {\r\n    this._setPosition(a, c)\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._setPosition = function(h, g) {\r\n    if (this.objPull[this.idPrefix + h] == null ) {\r\n        return\r\n    }\r\n    var a = null ;\r\n    if (this._spacer) {\r\n        a = this._spacer.idd;\r\n        this.removeSpacer()\r\n    }\r\n    if (isNaN(g)) {\r\n        g = this.base.childNodes.length\r\n    }\r\n    if (g < 0) {\r\n        g = 0\r\n    }\r\n    var e = this.objPull[this.idPrefix + h];\r\n    this.base.removeChild(e.obj);\r\n    if (e.arw) {\r\n        this.base.removeChild(e.arw)\r\n    }\r\n    var c = this._getIdByPosition(g, true);\r\n    if (c[0] == null ) {\r\n        this.base.appendChild(e.obj);\r\n        if (e.arw) {\r\n            this.base.appendChild(e.arw)\r\n        }\r\n    } else {\r\n        this.base.insertBefore(e.obj, this.base.childNodes[c[1]]);\r\n        if (e.arw) {\r\n            this.base.insertBefore(e.arw, this.base.childNodes[c[1] + 1])\r\n        }\r\n    }\r\n    if (a != null ) {\r\n        this.addSpacer(a)\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._getIdByPosition = function(l, c) {\r\n    var h = null ;\r\n    var a = 0;\r\n    var e = 0;\r\n    for (var g = 0; g < this.base.childNodes.length; g++) {\r\n        if (this.base.childNodes[g][\"idd\"] != null  && h == null ) {\r\n            if ((a++) == l) {\r\n                h = this.base.childNodes[g][\"idd\"]\r\n            }\r\n        }\r\n        if (h == null ) {\r\n            e++\r\n        }\r\n    }\r\n    e = (h == null  ? null  : e);\r\n    return ( c == true ? new Array(h,e) : h) \r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.removeItem = function(a) {\r\n    this._removeItem(a);\r\n    if (this.conf.skin == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._removeItem = function(h) {\r\n    var e = this.getType(h);\r\n    h = this.idPrefix + h;\r\n    var g = this.objPull[h];\r\n    if (e == \"button\") {\r\n        g.obj._doOnMouseOver = null ;\r\n        g.obj._doOnMouseOut = null ;\r\n        g.obj._doOnMouseUp = null ;\r\n        g.obj._doOnMouseUpOnceAnywhere = null ;\r\n        g.obj.onclick = null ;\r\n        g.obj.onmouseover = null ;\r\n        g.obj.onmouseout = null ;\r\n        g.obj.onmouseup = null ;\r\n        g.obj.onmousedown = null ;\r\n        g.obj.onselectstart = null ;\r\n        g.obj.renderAs = null ;\r\n        g.obj.idd = null ;\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.id = null ;\r\n        g.state = null ;\r\n        g.img = null ;\r\n        g.imgEn = null ;\r\n        g.imgDis = null ;\r\n        g.type = null ;\r\n        g.enableItem = null ;\r\n        g.disableItem = null ;\r\n        g.isEnabled = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null ;\r\n        g.setItemText = null ;\r\n        g.getItemText = null ;\r\n        g.setItemImage = null ;\r\n        g.clearItemImage = null ;\r\n        g.setItemImageDis = null ;\r\n        g.clearItemImageDis = null ;\r\n        g.setItemToolTip = null ;\r\n        g.getItemToolTip = null \r\n    }\r\n    if (e == \"buttonTwoState\") {\r\n        g.obj._doOnMouseOver = null ;\r\n        g.obj._doOnMouseOut = null ;\r\n        g.obj.onmouseover = null ;\r\n        g.obj.onmouseout = null ;\r\n        g.obj.onmousedown = null ;\r\n        g.obj.onselectstart = null ;\r\n        g.obj.renderAs = null ;\r\n        g.obj.idd = null ;\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.id = null ;\r\n        g.state = null ;\r\n        g.img = null ;\r\n        g.imgEn = null ;\r\n        g.imgDis = null ;\r\n        g.type = null ;\r\n        g.enableItem = null ;\r\n        g.disableItem = null ;\r\n        g.isEnabled = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null ;\r\n        g.setItemText = null ;\r\n        g.getItemText = null ;\r\n        g.setItemImage = null ;\r\n        g.clearItemImage = null ;\r\n        g.setItemImageDis = null ;\r\n        g.clearItemImageDis = null ;\r\n        g.setItemToolTip = null ;\r\n        g.getItemToolTip = null ;\r\n        g.setItemState = null ;\r\n        g.getItemState = null \r\n    }\r\n    if (e == \"buttonSelect\") {\r\n        for (var c in g._listOptions) {\r\n            this.removeListOption(h, c)\r\n        }\r\n        g._listOptions = null ;\r\n        if (g.polygon._ie6cover) {\r\n            document.body.removeChild(g.polygon._ie6cover);\r\n            g.polygon._ie6cover = null \r\n        }\r\n        g.p_tbl.removeChild(g.p_tbody);\r\n        g.polygon.removeChild(g.p_tbl);\r\n        g.polygon.onselectstart = null ;\r\n        document.body.removeChild(g.polygon);\r\n        g.p_tbody = null ;\r\n        g.p_tbl = null ;\r\n        g.polygon = null ;\r\n        g.obj.onclick = null ;\r\n        g.obj.onmouseover = null ;\r\n        g.obj.onmouseout = null ;\r\n        g.obj.onmouseup = null ;\r\n        g.obj.onmousedown = null ;\r\n        g.obj.onselectstart = null ;\r\n        g.obj.idd = null ;\r\n        g.obj.iddPrefix = null ;\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.arw.onclick = null ;\r\n        g.arw.onmouseover = null ;\r\n        g.arw.onmouseout = null ;\r\n        g.arw.onmouseup = null ;\r\n        g.arw.onmousedown = null ;\r\n        g.arw.onselectstart = null ;\r\n        g.arw.parentNode.removeChild(g.arw);\r\n        g.arw = null ;\r\n        g.renderSelect = null ;\r\n        g.state = null ;\r\n        g.type = null ;\r\n        g.id = null ;\r\n        g.img = null ;\r\n        g.imgEn = null ;\r\n        g.imgDis = null ;\r\n        g.openAll = null ;\r\n        g._isListButton = null ;\r\n        g._separatorButtonSelectObject = null ;\r\n        g._buttonButtonSelectObject = null ;\r\n        g.setWidth = null ;\r\n        g.enableItem = null ;\r\n        g.disableItem = null ;\r\n        g.isEnabled = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null ;\r\n        g.setItemText = null ;\r\n        g.getItemText = null ;\r\n        g.setItemImage = null ;\r\n        g.clearItemImage = null ;\r\n        g.setItemImageDis = null ;\r\n        g.clearItemImageDis = null ;\r\n        g.setItemToolTip = null ;\r\n        g.getItemToolTip = null ;\r\n        g.addListOption = null ;\r\n        g.removeListOption = null ;\r\n        g.showListOption = null ;\r\n        g.hideListOption = null ;\r\n        g.isListOptionVisible = null ;\r\n        g.enableListOption = null ;\r\n        g.disableListOption = null ;\r\n        g.isListOptionEnabled = null ;\r\n        g.setListOptionPosition = null ;\r\n        g.getListOptionPosition = null ;\r\n        g.setListOptionImage = null ;\r\n        g.getListOptionImage = null ;\r\n        g.clearListOptionImage = null ;\r\n        g.setListOptionText = null ;\r\n        g.getListOptionText = null ;\r\n        g.setListOptionToolTip = null ;\r\n        g.getListOptionToolTip = null ;\r\n        g.forEachListOption = null ;\r\n        g.getAllListOptions = null ;\r\n        g.setListOptionSelected = null ;\r\n        g.getListOptionSelected = null \r\n    }\r\n    if (e == \"buttonInput\") {\r\n        g.obj.childNodes[0].onkeydown = null ;\r\n        g.obj.removeChild(g.obj.childNodes[0]);\r\n        g.obj.w = null ;\r\n        g.obj.idd = null ;\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.id = null ;\r\n        g.type = null ;\r\n        g.enableItem = null ;\r\n        g.disableItem = null ;\r\n        g.isEnabled = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null ;\r\n        g.setItemToolTip = null ;\r\n        g.getItemToolTip = null ;\r\n        g.setWidth = null ;\r\n        g.getWidth = null ;\r\n        g.setValue = null ;\r\n        g.getValue = null ;\r\n        g.setItemText = null ;\r\n        g.getItemText = null \r\n    }\r\n    if (e == \"slider\") {\r\n        if (window.dhx4.isIPad) {\r\n            document.removeEventListener(\"touchmove\", pen._doOnMouseMoveStart, false);\r\n            document.removeEventListener(\"touchend\", pen._doOnMouseMoveEnd, false)\r\n        } else {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                window.removeEventListener(\"mousemove\", g.pen._doOnMouseMoveStart, false);\r\n                window.removeEventListener(\"mouseup\", g.pen._doOnMouseMoveEnd, false)\r\n            } else {\r\n                document.body.detachEvent(\"onmousemove\", g.pen._doOnMouseMoveStart);\r\n                document.body.detachEvent(\"onmouseup\", g.pen._doOnMouseMoveEnd)\r\n            }\r\n        }\r\n        g.pen.allowMove = null ;\r\n        g.pen.initXY = null ;\r\n        g.pen.maxX = null ;\r\n        g.pen.minX = null ;\r\n        g.pen.nowX = null ;\r\n        g.pen.newNowX = null ;\r\n        g.pen.valueMax = null ;\r\n        g.pen.valueMin = null ;\r\n        g.pen.valueNow = null ;\r\n        g.pen._definePos = null ;\r\n        g.pen._detectLimits = null ;\r\n        g.pen._doOnMouseMoveStart = null ;\r\n        g.pen._doOnMouseMoveEnd = null ;\r\n        g.pen.onmousedown = null ;\r\n        g.obj.removeChild(g.pen);\r\n        g.pen = null ;\r\n        g.label.tip = null ;\r\n        document.body.removeChild(g.label);\r\n        g.label = null ;\r\n        g.obj.onselectstart = null ;\r\n        g.obj.idd = null ;\r\n        while (g.obj.childNodes.length > 0) {\r\n            g.obj.removeChild(g.obj.childNodes[0])\r\n        }\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.id = null ;\r\n        g.type = null ;\r\n        g.state = null ;\r\n        g.enableItem = null ;\r\n        g.disableItem = null ;\r\n        g.isEnabled = null ;\r\n        g.setItemToolTipTemplate = null ;\r\n        g.getItemToolTipTemplate = null ;\r\n        g.setMaxValue = null ;\r\n        g.setMinValue = null ;\r\n        g.getMaxValue = null ;\r\n        g.getMinValue = null ;\r\n        g.setValue = null ;\r\n        g.getValue = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null \r\n    }\r\n    if (e == \"separator\") {\r\n        g.obj.onselectstart = null ;\r\n        g.obj.idd = null ;\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.id = null ;\r\n        g.type = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null \r\n    }\r\n    if (e == \"text\") {\r\n        g.obj.onselectstart = null ;\r\n        g.obj.idd = null ;\r\n        g.obj.parentNode.removeChild(g.obj);\r\n        g.obj = null ;\r\n        g.id = null ;\r\n        g.type = null ;\r\n        g.showItem = null ;\r\n        g.hideItem = null ;\r\n        g.isVisible = null ;\r\n        g.setWidth = null ;\r\n        g.setItemText = null ;\r\n        g.getItemText = null \r\n    }\r\n    e = null ;\r\n    g = null ;\r\n    this.objPull[this.idPrefix + h] = null ;\r\n    delete this.objPull[this.idPrefix + h]\r\n}\r\n;\r\n(function() {\r\n    var g = \"addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected\".split(\",\");\r\n    var c = function(h) {\r\n        return function(s, m, l, r, o, n) {\r\n            s = this.idPrefix + s;\r\n            if (this.objPull[s] == null ) {\r\n                return\r\n            }\r\n            if (this.objPull[s][\"type\"] != \"buttonSelect\") {\r\n                return\r\n            }\r\n            return this.objPull[s][h].call(this.objPull[s], m, l, r, o, n)\r\n        }\r\n    }\r\n    ;\r\n    for (var e = 0; e < g.length; e++) {\r\n        var a = g[e];\r\n        dhtmlXToolbarObject.prototype[a] = c(a)\r\n    }\r\n})();\r\ndhtmlXToolbarObject.prototype._rtlParseBtn = function(c, a) {\r\n    return c + a\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._separatorObject = function(a, e, c) {\r\n    this.id = a.idPrefix + e;\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.className = \"dhx_toolbar_sep\";\r\n    this.obj.style.display = (c.hidden != null  ? \"none\" : \"\");\r\n    this.obj.idd = String(e);\r\n    this.obj.title = (c.title || \"\");\r\n    this.obj.onselectstart = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.obj.ontouchstart = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        g.cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    a.base.appendChild(this.obj);\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display == \"\") \r\n    }\r\n    ;\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._textObject = function(a, e, c) {\r\n    this.id = a.idPrefix + e;\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.className = \"dhx_toolbar_text\";\r\n    this.obj.style.display = (c.hidden != null  ? \"none\" : \"\");\r\n    this.obj.idd = String(e);\r\n    this.obj.title = (c.title || \"\");\r\n    this.obj.onselectstart = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.obj.ontouchstart = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        g.cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    this.obj.innerHTML = (c.text || \"\");\r\n    a.base.appendChild(this.obj);\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display == \"\") \r\n    }\r\n    ;\r\n    this.setItemText = function(g) {\r\n        this.obj.innerHTML = g\r\n    }\r\n    ;\r\n    this.getItemText = function() {\r\n        return this.obj.innerHTML\r\n    }\r\n    ;\r\n    this.setWidth = function(g) {\r\n        this.obj.style.width = g + \"px\"\r\n    }\r\n    ;\r\n    this.setItemToolTip = function(g) {\r\n        this.obj.title = g\r\n    }\r\n    ;\r\n    this.getItemToolTip = function() {\r\n        return this.obj.title\r\n    }\r\n    ;\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._buttonObject = function(a, g, c) {\r\n    this.id = a.idPrefix + g;\r\n    this.state = (c.enabled != null  ? false : true);\r\n    this.imgEn = (c.img || \"\");\r\n    this.imgDis = (c.imgdis || \"\");\r\n    this.img = (this.state ? (this.imgEn != \"\" ? this.imgEn : \"\") : (this.imgDis != \"\" ? this.imgDis : \"\"));\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_\" + (this.state ? \"def\" : \"dis\");\r\n    this.obj.style.display = (c.hidden != null  ? \"none\" : \"\");\r\n    this.obj.allowClick = false;\r\n    this.obj.extAction = (c.action || null );\r\n    this.obj.renderAs = this.obj.className;\r\n    this.obj.idd = String(g);\r\n    this.obj.title = (c.title || \"\");\r\n    this.obj.pressed = false;\r\n    this.obj.innerHTML = a._rtlParseBtn((this.img != \"\" ? \"<img src='\" + a.conf.icons_path + this.img + \"'>\" : \"\"), (c.text != null  ? \"<div class='dhxtoolbar_text'>\" + c.text + \"</div>\" : \"\"));\r\n    var e = this;\r\n    this.obj.onselectstart = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.obj.onmouseover = function() {\r\n        this._doOnMouseOver()\r\n    }\r\n    ;\r\n    this.obj.onmouseout = function() {\r\n        this._doOnMouseOut()\r\n    }\r\n    ;\r\n    this.obj._doOnMouseOver = function() {\r\n        this.allowClick = true;\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        this.className = \"dhx_toolbar_btn dhxtoolbar_btn_over\";\r\n        this.renderAs = this.className\r\n    }\r\n    ;\r\n    this.obj._doOnMouseOut = function() {\r\n        this.allowClick = false;\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        this.className = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n        this.renderAs = this.renderAs\r\n    }\r\n    ;\r\n    this.obj.onclick = function(h) {\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (this.allowClick == false) {\r\n            return\r\n        }\r\n        h = h || event;\r\n        var l = this.idd.replace(a.idPrefix, \"\");\r\n        if (this.extAction) {\r\n            try {\r\n                window[this.extAction](l)\r\n            } catch (h) {}\r\n        }\r\n        if (a && a.callEvent) {\r\n            a.callEvent(\"onClick\", [l])\r\n        }\r\n    }\r\n    ;\r\n    this.obj[window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(h) {\r\n        if (e.state == false) {\r\n            h = h || event;\r\n            if (h.preventDefault) {\r\n                h.preventDefault()\r\n            } else {\r\n                h.returnValue = false\r\n            }\r\n            h.cancelBubble = true;\r\n            return false\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        a.anyUsed = this.idd;\r\n        this.className = \"dhx_toolbar_btn dhxtoolbar_btn_pres\";\r\n        this.pressed = true;\r\n        this.onmouseover = function() {\r\n            this._doOnMouseOver()\r\n        }\r\n        ;\r\n        this.onmouseout = function() {\r\n            a.anyUsed = \"none\";\r\n            this._doOnMouseOut()\r\n        }\r\n        ;\r\n        return false\r\n    }\r\n    ;\r\n    this.obj[window.dhx4.isIPad ? \"ontouchend\" : \"onmouseup\"] = function(m) {\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            if (a.anyUsed != this.idd) {\r\n                return\r\n            }\r\n        }\r\n        var l = a.anyUsed;\r\n        this._doOnMouseUp();\r\n        if (window.dhx4.isIPad && l != \"none\") {\r\n            if (this.extAction) {\r\n                var h = this;\r\n                window.setTimeout(function() {\r\n                    try {\r\n                        window[h.extAction](g)\r\n                    } catch (n) {}\r\n                    h = null \r\n                }, 1)\r\n            }\r\n            a.callEvent(\"onClick\", [this.idd.replace(a.idPrefix, \"\")])\r\n        }\r\n    }\r\n    ;\r\n    if (window.dhx4.isIPad) {\r\n        this.obj.ontouchmove = function(h) {\r\n            this._doOnMouseUp()\r\n        }\r\n    }\r\n    this.obj._doOnMouseUp = function() {\r\n        a.anyUsed = \"none\";\r\n        this.className = this.renderAs;\r\n        this.pressed = false\r\n    }\r\n    ;\r\n    this.obj._doOnMouseUpOnceAnywhere = function() {\r\n        this._doOnMouseUp();\r\n        this.onmouseover = function() {\r\n            this._doOnMouseOver()\r\n        }\r\n        ;\r\n        this.onmouseout = function() {\r\n            this._doOnMouseOut()\r\n        }\r\n    }\r\n    ;\r\n    a.base.appendChild(this.obj);\r\n    this.enableItem = function() {\r\n        a._enableItem(this)\r\n    }\r\n    ;\r\n    this.disableItem = function() {\r\n        a._disableItem(this)\r\n    }\r\n    ;\r\n    this.isEnabled = function() {\r\n        return this.state\r\n    }\r\n    ;\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display == \"\") \r\n    }\r\n    ;\r\n    this.setItemText = function(h) {\r\n        a._setItemText(this, h)\r\n    }\r\n    ;\r\n    this.getItemText = function() {\r\n        return a._getItemText(this)\r\n    }\r\n    ;\r\n    this.setItemImage = function(h) {\r\n        a._setItemImage(this, h, true)\r\n    }\r\n    ;\r\n    this.clearItemImage = function() {\r\n        a._clearItemImage(this, true)\r\n    }\r\n    ;\r\n    this.setItemImageDis = function(h) {\r\n        a._setItemImage(this, h, false)\r\n    }\r\n    ;\r\n    this.clearItemImageDis = function() {\r\n        a._clearItemImage(this, false)\r\n    }\r\n    ;\r\n    this.setItemToolTip = function(h) {\r\n        this.obj.title = h\r\n    }\r\n    ;\r\n    this.getItemToolTip = function() {\r\n        return this.obj.title\r\n    }\r\n    ;\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._buttonSelectObject = function(e, l, h) {\r\n    this.id = e.idPrefix + l;\r\n    this.state = (h.enabled != null  ? (h.enabled == \"true\" ? true : false) : true);\r\n    this.imgEn = (h.img || \"\");\r\n    this.imgDis = (h.imgdis || \"\");\r\n    this.img = (this.state ? (this.imgEn != \"\" ? this.imgEn : \"\") : (this.imgDis != \"\" ? this.imgDis : \"\"));\r\n    this.mode = (h.mode || \"button\");\r\n    if (this.mode == \"select\") {\r\n        this.openAll = true;\r\n        this.renderSelect = false;\r\n        if (!h.text || h.text.length == 0) {\r\n            h.text = \"&nbsp;\"\r\n        }\r\n    } else {\r\n        this.openAll = (window.dhx4.s2b(h.openAll) == true);\r\n        this.renderSelect = (h.renderSelect == null  ? true : window.dhx4.s2b(h.renderSelect))\r\n    }\r\n    this.maxOpen = (!isNaN(h.maxOpen ? h.maxOpen : \"\") ? h.maxOpen : null );\r\n    this._maxOpenTest = function() {\r\n        if (!isNaN(this.maxOpen)) {\r\n            if (!e._sbw) {\r\n                var n = document.createElement(\"DIV\");\r\n                n.className = \"dhxtoolbar_maxopen_test\";\r\n                document.body.appendChild(n);\r\n                var m = document.createElement(\"DIV\");\r\n                m.className = \"dhxtoolbar_maxopen_test2\";\r\n                n.appendChild(m);\r\n                e._sbw = n.offsetWidth - m.offsetWidth;\r\n                n.removeChild(m);\r\n                m = null ;\r\n                document.body.removeChild(n);\r\n                n = null \r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._maxOpenTest();\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.allowClick = false;\r\n    this.obj.extAction = (h.action || null );\r\n    this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_\" + (this.state ? \"def\" : \"dis\");\r\n    this.obj.style.display = (h.hidden != null  ? \"none\" : \"\");\r\n    this.obj.renderAs = this.obj.className;\r\n    this.obj.onselectstart = function(m) {\r\n        m = m || event;\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.obj.idd = String(l);\r\n    this.obj.title = (h.title || \"\");\r\n    this.obj.pressed = false;\r\n    this.callEvent = false;\r\n    this.obj.innerHTML = e._rtlParseBtn((this.img != \"\" ? \"<img src='\" + e.conf.icons_path + this.img + \"'>\" : \"\"), (h.text != null  ? \"<div class='dhxtoolbar_text'>\" + h.text + \"</div>\" : \"\"));\r\n    e.base.appendChild(this.obj);\r\n    this.arw = document.createElement(\"DIV\");\r\n    this.arw.className = \"dhx_toolbar_arw dhxtoolbar_btn_\" + (this.state ? \"def\" : \"dis\");\r\n    this.arw.style.display = this.obj.style.display;\r\n    this.arw.innerHTML = \"<div class='arwimg'>&nbsp;</div>\";\r\n    this.arw.title = this.obj.title;\r\n    this.arw.onselectstart = function(m) {\r\n        m = m || event;\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    e.base.appendChild(this.arw);\r\n    var a = this;\r\n    this.obj.onmouseover = function(m) {\r\n        m = m || event;\r\n        if (e.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        if (!a.state) {\r\n            return\r\n        }\r\n        a.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_over\";\r\n        a.obj.className = a.obj.renderAs;\r\n        a.arw.className = String(a.obj.renderAs).replace(\"btn\", \"arw\")\r\n    }\r\n    ;\r\n    this.obj.onmouseout = function() {\r\n        a.obj.allowClick = false;\r\n        if (e.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        if (!a.state) {\r\n            return\r\n        }\r\n        a.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n        a.obj.className = a.obj.renderAs;\r\n        a.arw.className = String(a.obj.renderAs).replace(\"btn\", \"arw\");\r\n        a.callEvent = false\r\n    }\r\n    ;\r\n    this.arw.onmouseover = this.obj.onmouseover;\r\n    this.arw.onmouseout = this.obj.onmouseout;\r\n    if (this.openAll == true) {} else {\r\n        this.obj.onclick = function(m) {\r\n            m = m || event;\r\n            if (!a.obj.allowClick) {\r\n                return\r\n            }\r\n            if (!a.state) {\r\n                return\r\n            }\r\n            if (e.anyUsed != \"none\") {\r\n                return\r\n            }\r\n            var n = a.obj.idd.replace(e.idPrefix, \"\");\r\n            if (a.obj.extAction) {\r\n                try {\r\n                    window[a.obj.extAction](n)\r\n                } catch (m) {}\r\n            }\r\n            e.callEvent(\"onClick\", [n])\r\n        }\r\n        ;\r\n        this.obj[window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(m) {\r\n            m = m || event;\r\n            if (e.anyUsed != \"none\") {\r\n                return\r\n            }\r\n            if (!a.state) {\r\n                return\r\n            }\r\n            a.obj.allowClick = true;\r\n            a.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_pres\";\r\n            a.arw.className = \"dhx_toolbar_arw dhxtoolbar_btn_pres\";\r\n            a.callEvent = true\r\n        }\r\n        ;\r\n        this.obj[window.dhx4.isIPad ? \"ontouchend\" : \"onmouseup\"] = function(n) {\r\n            n = n || event;\r\n            n.cancelBubble = true;\r\n            if (e.anyUsed != \"none\") {\r\n                return\r\n            }\r\n            if (!a.state) {\r\n                return\r\n            }\r\n            a.obj.className = a.obj.renderAs;\r\n            a.arw.className = String(a.obj.renderAs).replace(\"btn\", \"arw\");\r\n            if (window.dhx4.isIPad) {\r\n                if (this.extAction) {\r\n                    var m = this;\r\n                    window.setTimeout(function() {\r\n                        try {\r\n                            window[m.extAction](o)\r\n                        } catch (r) {}\r\n                        m = null \r\n                    }, 1)\r\n                }\r\n                if (a.callEvent) {\r\n                    var o = a.obj.idd.replace(e.idPrefix, \"\");\r\n                    e.callEvent(\"onClick\", [o])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (window.dhx4.isIPad) {\r\n        this.obj.ontouchmove = this.obj.onmouseout\r\n    }\r\n    this.arw[window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(o) {\r\n        o = o || event;\r\n        var x = (this.className.indexOf(\"dhx_toolbar_arw\") === 0 ? this : this.nextSibling);\r\n        if (x._skip) {\r\n            o = o || event;\r\n            o.cancelBubble = true\r\n        } else {\r\n            x._skip = true\r\n        }\r\n        x = null ;\r\n        if (!a.state) {\r\n            return\r\n        }\r\n        if (e.anyUsed == a.obj.idd) {\r\n            a.obj.className = a.obj.renderAs;\r\n            a.arw.className = String(a.obj.renderAs).replace(\"btn\", \"arw\");\r\n            e.anyUsed = \"none\";\r\n            window.dhx4.zim.clear(a.polygon._idd);\r\n            a.polygon.style.display = \"none\";\r\n            if (a.polygon._ie6cover) {\r\n                a.polygon._ie6cover.style.display = \"none\"\r\n            }\r\n            if (e.conf.skin == \"dhx_terrace\") {\r\n                e._improveTerraceButtonSelect(a.id, true)\r\n            }\r\n            e.callEvent(\"onButtonSelectHide\", [a.obj.idd])\r\n        } else {\r\n            if (e.anyUsed != \"none\") {\r\n                if (e.objPull[e.idPrefix + e.anyUsed][\"type\"] == \"buttonSelect\") {\r\n                    var w = e.objPull[e.idPrefix + e.anyUsed];\r\n                    if (w.polygon.style.display != \"none\") {\r\n                        w.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n                        w.obj.className = w.obj.renderAs;\r\n                        w.arw.className = String(a.obj.renderAs).replace(\"btn\", \"arw\");\r\n                        window.dhx4.zim.clear(w.polygon._idd);\r\n                        w.polygon.style.display = \"none\";\r\n                        if (w.polygon._ie6cover) {\r\n                            w.polygon._ie6cover.style.display = \"none\"\r\n                        }\r\n                        if (e.conf.skin == \"dhx_terrace\") {\r\n                            e._improveTerraceButtonSelect(w.id, true)\r\n                        }\r\n                        e.callEvent(\"onButtonSelectHide\", [w.obj.idd])\r\n                    }\r\n                }\r\n            }\r\n            a.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_over\";\r\n            a.arw.className = \"dhx_toolbar_arw dhxtoolbar_btn_pres\";\r\n            e.anyUsed = a.obj.idd;\r\n            a.polygon.style.top = \"0px\";\r\n            a.polygon.style.visibility = \"hidden\";\r\n            a.polygon.style.zIndex = window.dhx4.zim.reserve(a.polygon._idd);\r\n            a.polygon.style.display = \"\";\r\n            if (e.conf.skin == \"dhx_terrace\") {\r\n                e._improveTerraceButtonSelect(a.id, false)\r\n            }\r\n            a._fixMaxOpenHeight(a.maxOpen || null );\r\n            e._autoDetectVisibleArea();\r\n            var r = window.dhx4.absTop(a.obj) + a.obj.offsetHeight + e.conf.sel_ofs_y;\r\n            var u = a.polygon.offsetHeight;\r\n            if (r + u > e.tY2) {\r\n                var s = (a.maxOpen != null  ? Math.floor((e.tY2 - r) / 22) : 0);\r\n                if (s >= 1) {\r\n                    a._fixMaxOpenHeight(s)\r\n                } else {\r\n                    r = window.dhx4.absTop(a.obj) - u - e.conf.sel_ofs_y;\r\n                    if (r < 0) {\r\n                        r = 0\r\n                    }\r\n                }\r\n            }\r\n            a.polygon.style.top = r + \"px\";\r\n            if (e.rtl) {\r\n                a.polygon.style.left = window.dhx4.absLeft(a.obj) + a.obj.offsetWidth - a.polygon.offsetWidth + e.conf.sel_ofs_x + \"px\"\r\n            } else {\r\n                var n = document.body.scrollLeft;\r\n                var m = n + (window.innerWidth || document.body.clientWidth);\r\n                var v = window.dhx4.absLeft(a.obj) + e.conf.sel_ofs_x;\r\n                if (v + a.polygon.offsetWidth > m) {\r\n                    v = window.dhx4.absLeft(a.arw) + a.arw.offsetWidth - a.polygon.offsetWidth\r\n                }\r\n                a.polygon.style.left = Math.max(v, 5) + \"px\"\r\n            }\r\n            a.polygon.style.visibility = \"visible\";\r\n            if (a.polygon._ie6cover) {\r\n                a.polygon._ie6cover.style.left = a.polygon.style.left;\r\n                a.polygon._ie6cover.style.top = a.polygon.style.top;\r\n                a.polygon._ie6cover.style.width = a.polygon.offsetWidth + \"px\";\r\n                a.polygon._ie6cover.style.height = a.polygon.offsetHeight + \"px\";\r\n                a.polygon._ie6cover.style.display = \"\"\r\n            }\r\n            e.callEvent(\"onButtonSelectShow\", [a.obj.idd])\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this.arw.onclick = function(m) {\r\n        m = m || event;\r\n        m.cancelBubble = true\r\n    }\r\n    ;\r\n    this.arw[window.dhx4.isIPad ? \"ontouchend\" : \"onmouseup\"] = function(m) {\r\n        m = m || event;\r\n        m.cancelBubble = true\r\n    }\r\n    ;\r\n    if (this.openAll === true) {\r\n        this.obj.onclick = this.arw.onclick;\r\n        this.obj.onmousedown = this.arw.onmousedown;\r\n        this.obj.onmouseup = this.arw.onmouseup;\r\n        if (window.dhx4.isIPad) {\r\n            this.obj.ontouchstart = this.arw.ontouchstart;\r\n            this.obj.ontouchend = this.arw.ontouchend\r\n        }\r\n    }\r\n    this.obj.iddPrefix = e.idPrefix;\r\n    this._listOptions = {};\r\n    this._fixMaxOpenHeight = function(s) {\r\n        var r = \"auto\";\r\n        var o = false;\r\n        if (s !== null ) {\r\n            var n = 0;\r\n            for (var m in this._listOptions) {\r\n                n++\r\n            }\r\n            if (n > s) {\r\n                this._ph = 22 * s;\r\n                r = this._ph + \"px\"\r\n            } else {\r\n                o = true\r\n            }\r\n        }\r\n        this.polygon.style.width = \"auto\";\r\n        this.polygon.style.height = \"auto\";\r\n        if (!o && a.maxOpen != null ) {\r\n            this.polygon.style.width = this.p_tbl.offsetWidth + e._sbw + \"px\";\r\n            this.polygon.style.height = r\r\n        }\r\n    }\r\n    ;\r\n    this._separatorButtonSelectObject = function(o, m, n) {\r\n        this.obj = {};\r\n        this.obj.tr = document.createElement(\"TR\");\r\n        this.obj.tr.className = \"tr_sep\";\r\n        this.obj.tr.onselectstart = function(r) {\r\n            r = r || event;\r\n            if (r.preventDefault) {\r\n                r.preventDefault()\r\n            } else {\r\n                r.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        this.obj.td = document.createElement(\"TD\");\r\n        this.obj.td.colSpan = \"2\";\r\n        this.obj.td.className = \"td_btn_sep\";\r\n        this.obj.td.onselectstart = function(r) {\r\n            r = r || event;\r\n            if (r.preventDefault) {\r\n                r.preventDefault()\r\n            } else {\r\n                r.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        if (isNaN(n)) {\r\n            n = a.p_tbody.childNodes.length + 1\r\n        } else {\r\n            if (n < 1) {\r\n                n = 1\r\n            }\r\n        }\r\n        if (n > a.p_tbody.childNodes.length) {\r\n            a.p_tbody.appendChild(this.obj.tr)\r\n        } else {\r\n            a.p_tbody.insertBefore(this.obj.tr, a.p_tbody.childNodes[n - 1])\r\n        }\r\n        this.obj.tr.appendChild(this.obj.td);\r\n        this.obj.sep = document.createElement(\"DIV\");\r\n        this.obj.sep.className = \"btn_sep\";\r\n        this.obj.sep.onselectstart = function(r) {\r\n            r = r || event;\r\n            if (r.preventDefault) {\r\n                r.preventDefault()\r\n            } else {\r\n                r.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        this.obj.td.appendChild(this.obj.sep);\r\n        a._listOptions[o] = this.obj;\r\n        return this\r\n    }\r\n    ;\r\n    this._buttonButtonSelectObject = function(s, o, r) {\r\n        var n = true;\r\n        if (typeof (o.enabled) != \"undefined\") {\r\n            n = window.dhx4.s2b(o.enabled)\r\n        } else {\r\n            if (typeof (o.disabled) != \"undefined\") {\r\n                n = window.dhx4.s2b(o.disabled)\r\n            }\r\n        }\r\n        this.obj = {};\r\n        this.obj.tr = document.createElement(\"TR\");\r\n        this.obj.tr.en = n;\r\n        this.obj.tr.extAction = (o.action || null );\r\n        this.obj.tr._selected = (o.selected != null );\r\n        this.obj.tr.className = \"tr_btn\" + (this.obj.tr.en ? (this.obj.tr._selected && a.renderSelect ? \" tr_btn_selected\" : \"\") : \" tr_btn_disabled\");\r\n        this.obj.tr.onselectstart = function(u) {\r\n            u = u || event;\r\n            if (u.preventDefault) {\r\n                u.preventDefault()\r\n            } else {\r\n                u.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        this.obj.tr.idd = String(s);\r\n        if (isNaN(r)) {\r\n            r = a.p_tbody.childNodes.length + 1\r\n        } else {\r\n            if (r < 1) {\r\n                r = 1\r\n            }\r\n        }\r\n        if (r > a.p_tbody.childNodes.length) {\r\n            a.p_tbody.appendChild(this.obj.tr)\r\n        } else {\r\n            a.p_tbody.insertBefore(this.obj.tr, a.p_tbody.childNodes[r - 1])\r\n        }\r\n        this.obj.td_a = document.createElement(\"TD\");\r\n        this.obj.td_a.className = \"td_btn_img\";\r\n        this.obj.td_a.onselectstart = function(u) {\r\n            u = u || event;\r\n            if (u.preventDefault) {\r\n                u.preventDefault()\r\n            } else {\r\n                u.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        this.obj.td_b = document.createElement(\"TD\");\r\n        this.obj.td_b.className = \"td_btn_txt\";\r\n        this.obj.td_b.onselectstart = function(u) {\r\n            u = u || event;\r\n            if (u.preventDefault) {\r\n                u.preventDefault()\r\n            } else {\r\n                u.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        if (e.rtl) {\r\n            this.obj.tr.appendChild(this.obj.td_b);\r\n            this.obj.tr.appendChild(this.obj.td_a)\r\n        } else {\r\n            this.obj.tr.appendChild(this.obj.td_a);\r\n            this.obj.tr.appendChild(this.obj.td_b)\r\n        }\r\n        if (o.img != null ) {\r\n            this.obj.td_a.innerHTML = \"<img class='btn_sel_img' src='\" + e.conf.icons_path + o.img + \"' border='0'>\";\r\n            this.obj.tr._img = o.img\r\n        } else {\r\n            this.obj.td_a.innerHTML = \"&nbsp;\"\r\n        }\r\n        var m = (o.text != null  ? o.text : (o.itemText || \"\"));\r\n        this.obj.td_b.innerHTML = \"<div class='btn_sel_text'>\" + m + \"</div>\";\r\n        this.obj.tr.onmouseover = function(u) {\r\n            u = u || event;\r\n            if (u.type.match(/touch/) != null ) {\r\n                return\r\n            }\r\n            if (!this.en || (this._selected && a.renderSelect)) {\r\n                return\r\n            }\r\n            this.className = \"tr_btn tr_btn_over\"\r\n        }\r\n        ;\r\n        this.obj.tr.onmouseout = function(u) {\r\n            u = u || event;\r\n            if (u.type.match(/touch/) != null ) {\r\n                return\r\n            }\r\n            if (!this.en) {\r\n                return\r\n            }\r\n            if (this._selected && a.renderSelect) {\r\n                if (String(this.className).search(\"tr_btn_selected\") == -1) {\r\n                    this.className = \"tr_btn tr_btn_selected\"\r\n                }\r\n            } else {\r\n                this.className = \"tr_btn\"\r\n            }\r\n        }\r\n        ;\r\n        this.obj.tr.ontouchstart = this.obj.tr.onmousedown = function(u) {\r\n            u = u || event;\r\n            if (this._etype == null ) {\r\n                this._etype = u.type\r\n            }\r\n        }\r\n        ;\r\n        this.obj.tr.onclick = function(v) {\r\n            v = v || event;\r\n            v.cancelBubble = true;\r\n            if (!this.en) {\r\n                return\r\n            }\r\n            a.setListOptionSelected(this.idd.replace(e.idPrefix, \"\"));\r\n            a.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n            a.obj.className = a.obj.renderAs;\r\n            a.arw.className = String(a.obj.renderAs).replace(\"btn\", \"arw\");\r\n            if (this._etype != null  && this._etype.match(/touch/) == null ) {\r\n                window.dhx4.zim.clear(a.polygon._idd);\r\n                a.polygon.style.display = \"none\";\r\n                if (a.polygon._ie6cover) {\r\n                    a.polygon._ie6cover.style.display = \"none\"\r\n                }\r\n            } else {\r\n                var u = a.polygon;\r\n                window.setTimeout(function() {\r\n                    window.dhx4.zim.clear(u._idd);\r\n                    u.style.display = \"none\";\r\n                    u = null \r\n                }, 500)\r\n            }\r\n            this._etype = null ;\r\n            if (e.conf.skin == \"dhx_terrace\") {\r\n                e._improveTerraceButtonSelect(a.id, true)\r\n            }\r\n            e.anyUsed = \"none\";\r\n            e.callEvent(\"onButtonSelectHide\", [a.obj.idd]);\r\n            var w = this.idd.replace(e.idPrefix, \"\");\r\n            if (this.extAction) {\r\n                try {\r\n                    window[this.extAction](w)\r\n                } catch (v) {}\r\n            }\r\n            e.callEvent(\"onClick\", [w])\r\n        }\r\n        ;\r\n        a._listOptions[s] = this.obj;\r\n        return this\r\n    }\r\n    ;\r\n    this.polygon = document.createElement(\"DIV\");\r\n    this.polygon.dir = \"ltr\";\r\n    this.polygon.style.display = \"none\";\r\n    this.polygon.className = \"dhx_toolbar_poly_\" + e.conf.skin + \" dhxtoolbar_icons_\" + e.conf.iconSize;\r\n    this.polygon.onselectstart = function(m) {\r\n        m = m || event;\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.polygon.onmousedown = function(m) {\r\n        m = m || event;\r\n        m.cancelBubble = true\r\n    }\r\n    ;\r\n    this.polygon.style.overflowY = \"auto\";\r\n    this.polygon._idd = window.dhx4.newId();\r\n    this.polygon.ontouchstart = function(m) {\r\n        m = m || event;\r\n        m.cancelBubble = true\r\n    }\r\n    ;\r\n    this.polygon.ontouchend = function(m) {\r\n        m = m || event;\r\n        m.cancelBubble = true\r\n    }\r\n    ;\r\n    this.p_tbl = document.createElement(\"TABLE\");\r\n    this.p_tbl.className = \"buttons_cont\";\r\n    this.p_tbl.cellSpacing = \"0\";\r\n    this.p_tbl.cellPadding = \"0\";\r\n    this.p_tbl.border = \"0\";\r\n    this.polygon.appendChild(this.p_tbl);\r\n    this.p_tbody = document.createElement(\"TBODY\");\r\n    this.p_tbl.appendChild(this.p_tbody);\r\n    if (h.options != null ) {\r\n        for (var g = 0; g < h.options.length; g++) {\r\n            var c = \"_\" + (h.options[g].type || \"\") + \"ButtonSelectObject\";\r\n            if (h.options[g].id == null ) {\r\n                h.options[g].id = e._genStr(24)\r\n            }\r\n            if (typeof (this[c]) == \"function\") {\r\n                new this[c](h.options[g].id,h.options[g])\r\n            }\r\n        }\r\n    }\r\n    document.body.appendChild(this.polygon);\r\n    if (window.dhx4.isIE6) {\r\n        this.polygon._ie6cover = document.createElement(\"IFRAME\");\r\n        this.polygon._ie6cover.frameBorder = 0;\r\n        this.polygon._ie6cover.style.position = \"absolute\";\r\n        this.polygon._ie6cover.style.border = \"none\";\r\n        this.polygon._ie6cover.style.backgroundColor = \"#000000\";\r\n        this.polygon._ie6cover.style.filter = \"alpha(opacity=100)\";\r\n        this.polygon._ie6cover.style.display = \"none\";\r\n        this.polygon._ie6cover.setAttribute(\"src\", \"javascript:false;\");\r\n        document.body.appendChild(this.polygon._ie6cover)\r\n    }\r\n    this.setWidth = function(m) {\r\n        this.obj.style.width = m - this.arw.offsetWidth + \"px\";\r\n        this.polygon.style.width = this.obj.offsetWidth + this.arw.offsetWidth - 2 + \"px\";\r\n        this.p_tbl.style.width = this.polygon.style.width\r\n    }\r\n    ;\r\n    this.enableItem = function() {\r\n        e._enableItem(this)\r\n    }\r\n    ;\r\n    this.disableItem = function() {\r\n        e._disableItem(this)\r\n    }\r\n    ;\r\n    this.isEnabled = function() {\r\n        return this.state\r\n    }\r\n    ;\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\";\r\n        this.arw.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\";\r\n        this.arw.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display == \"\") \r\n    }\r\n    ;\r\n    this.setItemText = function(m) {\r\n        e._setItemText(this, m)\r\n    }\r\n    ;\r\n    this.getItemText = function() {\r\n        return e._getItemText(this)\r\n    }\r\n    ;\r\n    this.setItemImage = function(m) {\r\n        e._setItemImage(this, m, true)\r\n    }\r\n    ;\r\n    this.clearItemImage = function() {\r\n        e._clearItemImage(this, true)\r\n    }\r\n    ;\r\n    this.setItemImageDis = function(m) {\r\n        e._setItemImage(this, m, false)\r\n    }\r\n    ;\r\n    this.clearItemImageDis = function() {\r\n        e._clearItemImage(this, false)\r\n    }\r\n    ;\r\n    this.setItemToolTip = function(m) {\r\n        this.obj.title = m;\r\n        this.arw.title = m\r\n    }\r\n    ;\r\n    this.getItemToolTip = function() {\r\n        return this.obj.title\r\n    }\r\n    ;\r\n    this.addListOption = function(u, s, o, r, m) {\r\n        if (!(o == \"button\" || o == \"separator\")) {\r\n            return\r\n        }\r\n        var n = {\r\n            id: u,\r\n            type: o,\r\n            text: r,\r\n            img: m\r\n        };\r\n        new this[\"_\" + o + \"ButtonSelectObject\"](u,n,s)\r\n    }\r\n    ;\r\n    this.removeListOption = function(o) {\r\n        if (!this._isListButton(o, true)) {\r\n            return\r\n        }\r\n        var m = this._listOptions[o];\r\n        if (m.td_a != null  && m.td_b != null ) {\r\n            m.td_a.onselectstart = null ;\r\n            m.td_b.onselectstart = null ;\r\n            while (m.td_a.childNodes.length > 0) {\r\n                m.td_a.removeChild(m.td_a.childNodes[0])\r\n            }\r\n            while (m.td_b.childNodes.length > 0) {\r\n                m.td_b.removeChild(m.td_b.childNodes[0])\r\n            }\r\n            m.tr.onselectstart = null ;\r\n            m.tr.onmouseover = null ;\r\n            m.tr.onmouseout = null ;\r\n            m.tr.onclick = null ;\r\n            m.tr.ontouchstart = null ;\r\n            m.tr.onmousedown = null ;\r\n            while (m.tr.childNodes.length > 0) {\r\n                m.tr.removeChild(m.tr.childNodes[0])\r\n            }\r\n            m.tr.parentNode.removeChild(m.tr);\r\n            m.td_a = null ;\r\n            m.td_b = null ;\r\n            m.tr = null \r\n        } else {\r\n            m.sep.onselectstart = null ;\r\n            m.td.onselectstart = null ;\r\n            m.tr.onselectstart = null ;\r\n            while (m.td.childNodes.length > 0) {\r\n                m.td.removeChild(m.td.childNodes[0])\r\n            }\r\n            while (m.tr.childNodes.length > 0) {\r\n                m.tr.removeChild(m.tr.childNodes[0])\r\n            }\r\n            m.tr.parentNode.removeChild(m.tr);\r\n            m.sep = null ;\r\n            m.td = null ;\r\n            m.tr = null \r\n        }\r\n        m = null ;\r\n        this._listOptions[o] = null ;\r\n        try {\r\n            delete this._listOptions[o]\r\n        } catch (n) {}\r\n    }\r\n    ;\r\n    this.showListOption = function(m) {\r\n        if (!this._isListButton(m, true)) {\r\n            return\r\n        }\r\n        this._listOptions[m].tr.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideListOption = function(m) {\r\n        if (!this._isListButton(m, true)) {\r\n            return\r\n        }\r\n        this._listOptions[m].tr.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isListOptionVisible = function(m) {\r\n        if (!this._isListButton(m, true)) {\r\n            return\r\n        }\r\n        return ( this._listOptions[m].tr.style.display != \"none\") \r\n    }\r\n    ;\r\n    this.enableListOption = function(m) {\r\n        if (!this._isListButton(m)) {\r\n            return\r\n        }\r\n        this._listOptions[m].tr.en = true;\r\n        this._listOptions[m].tr.className = \"tr_btn\" + (this._listOptions[m].tr._selected && e.renderSelect ? \" tr_btn_selected\" : \"\")\r\n    }\r\n    ;\r\n    this.disableListOption = function(m) {\r\n        if (!this._isListButton(m)) {\r\n            return\r\n        }\r\n        this._listOptions[m].tr.en = false;\r\n        this._listOptions[m].tr.className = \"tr_btn tr_btn_disabled\"\r\n    }\r\n    ;\r\n    this.isListOptionEnabled = function(m) {\r\n        if (!this._isListButton(m)) {\r\n            return\r\n        }\r\n        return this._listOptions[m].tr.en\r\n    }\r\n    ;\r\n    this.setListOptionPosition = function(o, n) {\r\n        if (!this._listOptions[o] || this.getListOptionPosition(o) == n || isNaN(n)) {\r\n            return\r\n        }\r\n        if (n < 1) {\r\n            n = 1\r\n        }\r\n        var m = this._listOptions[o].tr;\r\n        this.p_tbody.removeChild(m);\r\n        if (n > this.p_tbody.childNodes.length) {\r\n            this.p_tbody.appendChild(m)\r\n        } else {\r\n            this.p_tbody.insertBefore(m, this.p_tbody.childNodes[n - 1])\r\n        }\r\n        m = null \r\n    }\r\n    ;\r\n    this.getListOptionPosition = function(o) {\r\n        var n = -1;\r\n        if (!this._listOptions[o]) {\r\n            return n\r\n        }\r\n        for (var m = 0; m < this.p_tbody.childNodes.length; m++) {\r\n            if (this.p_tbody.childNodes[m] == this._listOptions[o].tr) {\r\n                n = m + 1\r\n            }\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    this.setListOptionImage = function(o, m) {\r\n        if (!this._isListButton(o)) {\r\n            return\r\n        }\r\n        var n = this._listOptions[o].tr.childNodes[(e.rtl ? 1 : 0)];\r\n        n.innerHTML = \"<img src='\" + e.conf.icons_path + m + \"' class='btn_sel_img'>\";\r\n        n = null \r\n    }\r\n    ;\r\n    this.getListOptionImage = function(o) {\r\n        if (!this._isListButton(o)) {\r\n            return\r\n        }\r\n        var n = this._listOptions[o].tr.childNodes[(e.rtl ? 1 : 0)];\r\n        var m = null ;\r\n        if (n.childNodes.length > 0) {\r\n            m = n.childNodes[0].src\r\n        }\r\n        n = null ;\r\n        return m\r\n    }\r\n    ;\r\n    this.clearListOptionImage = function(n) {\r\n        if (!this._isListButton(n)) {\r\n            return\r\n        }\r\n        var m = this._listOptions[n].tr.childNodes[(e.rtl ? 1 : 0)];\r\n        while (m.childNodes.length > 0) {\r\n            m.removeChild(m.childNodes[0])\r\n        }\r\n        m.innerHTML = \"&nbsp;\";\r\n        m = null \r\n    }\r\n    ;\r\n    this.setListOptionText = function(n, m) {\r\n        if (!this._isListButton(n)) {\r\n            return\r\n        }\r\n        this._listOptions[n].tr.childNodes[(e.rtl ? 0 : 1)].childNodes[0].innerHTML = m\r\n    }\r\n    ;\r\n    this.getListOptionText = function(m) {\r\n        if (!this._isListButton(m)) {\r\n            return\r\n        }\r\n        return this._listOptions[m].tr.childNodes[(e.rtl ? 0 : 1)].childNodes[0].innerHTML\r\n    }\r\n    ;\r\n    this.setListOptionToolTip = function(n, m) {\r\n        if (!this._isListButton(n)) {\r\n            return\r\n        }\r\n        this._listOptions[n].tr.title = m\r\n    }\r\n    ;\r\n    this.getListOptionToolTip = function(m) {\r\n        if (!this._isListButton(m)) {\r\n            return\r\n        }\r\n        return this._listOptions[m].tr.title\r\n    }\r\n    ;\r\n    this.forEachListOption = function(n) {\r\n        for (var m in this._listOptions) {\r\n            n(m)\r\n        }\r\n    }\r\n    ;\r\n    this.getAllListOptions = function() {\r\n        var n = new Array();\r\n        for (var m in this._listOptions) {\r\n            n[n.length] = m\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    this.setListOptionSelected = function(o) {\r\n        for (var m in this._listOptions) {\r\n            var n = this._listOptions[m];\r\n            if (n.td_a != null  && n.td_b != null  && n.tr.en) {\r\n                if (m == o) {\r\n                    n.tr._selected = true;\r\n                    n.tr.className = \"tr_btn\" + (this.renderSelect ? \" tr_btn_selected\" : \"\");\r\n                    if (this.mode == \"select\") {\r\n                        if (n.tr._img) {\r\n                            this.setItemImage(n.tr._img)\r\n                        } else {\r\n                            this.clearItemImage()\r\n                        }\r\n                        this.setItemText(this.getListOptionText(o))\r\n                    }\r\n                } else {\r\n                    n.tr._selected = false;\r\n                    n.tr.className = \"tr_btn\"\r\n                }\r\n            }\r\n            n = null \r\n        }\r\n    }\r\n    ;\r\n    this.getListOptionSelected = function() {\r\n        var n = null ;\r\n        for (var m in this._listOptions) {\r\n            if (this._listOptions[m].tr._selected == true) {\r\n                n = m\r\n            }\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    this._isListButton = function(n, m) {\r\n        if (this._listOptions[n] == null ) {\r\n            return false\r\n        }\r\n        if (!m && this._listOptions[n].tr.className == \"tr_sep\") {\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    this.setMaxOpen = function(m) {\r\n        this._ph = null ;\r\n        if (typeof (m) == \"number\") {\r\n            this.maxOpen = m;\r\n            this._maxOpenTest();\r\n            return\r\n        }\r\n        this.maxOpen = null \r\n    }\r\n    ;\r\n    if (h.width) {\r\n        this.setWidth(h.width)\r\n    }\r\n    if (this.mode == \"select\" && typeof (h.selected) != \"undefined\") {\r\n        this.setListOptionSelected(h.selected)\r\n    }\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._buttonInputObject = function(e, h, g) {\r\n    this.id = e.idPrefix + h;\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n    this.obj.style.display = (g.hidden != null  ? \"none\" : \"\");\r\n    this.obj.idd = String(h);\r\n    this.obj.w = (g.width != null  ? g.width : 100);\r\n    this.obj.title = (g.title != null  ? g.title : \"\");\r\n    this.obj.innerHTML = \"<input class='dhxtoolbar_input' type='text' style='width:\" + this.obj.w + \"px;'\" + (g.value != null  ? \" value='\" + g.value + \"'\" : \"\") + \">\";\r\n    var c = e;\r\n    var a = this;\r\n    this.obj.childNodes[0].onkeydown = function(l) {\r\n        l = l || event;\r\n        if (l.keyCode == 13) {\r\n            c.callEvent(\"onEnter\", [a.obj.idd, this.value])\r\n        }\r\n    }\r\n    ;\r\n    e.base.appendChild(this.obj);\r\n    this.enableItem = function() {\r\n        this.obj.childNodes[0].disabled = false\r\n    }\r\n    ;\r\n    this.disableItem = function() {\r\n        this.obj.childNodes[0].disabled = true\r\n    }\r\n    ;\r\n    this.isEnabled = function() {\r\n        return ( !this.obj.childNodes[0].disabled) \r\n    }\r\n    ;\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display != \"none\") \r\n    }\r\n    ;\r\n    this.setValue = function(l) {\r\n        this.obj.childNodes[0].value = l\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.obj.childNodes[0].value\r\n    }\r\n    ;\r\n    this.setWidth = function(l) {\r\n        this.obj.w = l;\r\n        this.obj.childNodes[0].style.width = this.obj.w + \"px\"\r\n    }\r\n    ;\r\n    this.getWidth = function() {\r\n        return this.obj.w\r\n    }\r\n    ;\r\n    this.setItemToolTip = function(l) {\r\n        this.obj.title = l\r\n    }\r\n    ;\r\n    this.getItemToolTip = function() {\r\n        return this.obj.title\r\n    }\r\n    ;\r\n    this.getInput = function() {\r\n        return this.obj.firstChild\r\n    }\r\n    ;\r\n    if (typeof (g.enabled) != \"undefined\" && window.dhx4.s2b(g.enabled) == false) {\r\n        this.disableItem()\r\n    }\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._buttonTwoStateObject = function(a, g, c) {\r\n    this.id = a.idPrefix + g;\r\n    this.state = (c.enabled != null  ? false : true);\r\n    this.imgEn = (c.img != null  ? c.img : \"\");\r\n    this.imgDis = (c.imgdis != null  ? c.imgdis : \"\");\r\n    this.img = (this.state ? (this.imgEn != \"\" ? this.imgEn : \"\") : (this.imgDis != \"\" ? this.imgDis : \"\"));\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.pressed = (c.selected != null );\r\n    this.obj.extAction = (c.action || null );\r\n    this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_\" + (this.obj.pressed ? \"pres\" + (this.state ? \"\" : \"_dis\") : (this.state ? \"def\" : \"dis\"));\r\n    this.obj.style.display = (c.hidden != null  ? \"none\" : \"\");\r\n    this.obj.renderAs = this.obj.className;\r\n    this.obj.idd = String(g);\r\n    this.obj.title = (c.title || \"\");\r\n    if (this.obj.pressed) {\r\n        this.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_over\"\r\n    }\r\n    this.obj.innerHTML = a._rtlParseBtn((this.img != \"\" ? \"<img src='\" + a.conf.icons_path + this.img + \"'>\" : \"\"), (c.text != null  ? \"<div class='dhxtoolbar_text'>\" + c.text + \"</div>\" : \"\"));\r\n    a.base.appendChild(this.obj);\r\n    var e = this;\r\n    this.obj.onselectstart = function(h) {\r\n        h = h || event;\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.obj.onmouseover = function() {\r\n        this._doOnMouseOver()\r\n    }\r\n    ;\r\n    this.obj.onmouseout = function() {\r\n        this._doOnMouseOut()\r\n    }\r\n    ;\r\n    this.obj._doOnMouseOver = function() {\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        if (this.pressed) {\r\n            this.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_over\";\r\n            return\r\n        }\r\n        this.className = \"dhx_toolbar_btn dhxtoolbar_btn_over\";\r\n        this.renderAs = this.className\r\n    }\r\n    ;\r\n    this.obj._doOnMouseOut = function() {\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        if (this.pressed) {\r\n            this.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n            return\r\n        }\r\n        this.className = \"dhx_toolbar_btn dhxtoolbar_btn_def\";\r\n        this.renderAs = this.className\r\n    }\r\n    ;\r\n    this.obj[window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(h) {\r\n        if (a.checkEvent(\"onBeforeStateChange\")) {\r\n            if (!a.callEvent(\"onBeforeStateChange\", [this.idd.replace(a.idPrefix, \"\"), this.pressed])) {\r\n                return\r\n            }\r\n        }\r\n        if (e.state == false) {\r\n            return\r\n        }\r\n        if (a.anyUsed != \"none\") {\r\n            return\r\n        }\r\n        this.pressed = !this.pressed;\r\n        this.className = (this.pressed ? \"dhx_toolbar_btn dhxtoolbar_btn_pres\" : this.renderAs);\r\n        var l = this.idd.replace(a.idPrefix, \"\");\r\n        if (this.extAction) {\r\n            try {\r\n                window[this.extAction](l, this.pressed)\r\n            } catch (h) {}\r\n        }\r\n        a.callEvent(\"onStateChange\", [l, this.pressed]);\r\n        return false\r\n    }\r\n    ;\r\n    this.setItemState = function(h, m) {\r\n        if (this.obj.pressed != h) {\r\n            if (h == true) {\r\n                this.obj.pressed = true;\r\n                this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_pres\" + (this.state ? \"\" : \"_dis\");\r\n                this.obj.renderAs = \"dhx_toolbar_btn dhxtoolbar_btn_over\"\r\n            } else {\r\n                this.obj.pressed = false;\r\n                this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_\" + (this.state ? \"def\" : \"dis\");\r\n                this.obj.renderAs = this.obj.className\r\n            }\r\n            if (m == true) {\r\n                var n = this.obj.idd.replace(a.idPrefix, \"\");\r\n                if (this.obj.extAction) {\r\n                    try {\r\n                        window[this.obj.extAction](n, this.obj.pressed)\r\n                    } catch (l) {}\r\n                }\r\n                a.callEvent(\"onStateChange\", [n, this.obj.pressed])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getItemState = function() {\r\n        return this.obj.pressed\r\n    }\r\n    ;\r\n    this.enableItem = function() {\r\n        a._enableItem(this)\r\n    }\r\n    ;\r\n    this.disableItem = function() {\r\n        a._disableItem(this)\r\n    }\r\n    ;\r\n    this.isEnabled = function() {\r\n        return this.state\r\n    }\r\n    ;\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display == \"\") \r\n    }\r\n    ;\r\n    this.setItemText = function(h) {\r\n        a._setItemText(this, h)\r\n    }\r\n    ;\r\n    this.getItemText = function() {\r\n        return a._getItemText(this)\r\n    }\r\n    ;\r\n    this.setItemImage = function(h) {\r\n        a._setItemImage(this, h, true)\r\n    }\r\n    ;\r\n    this.clearItemImage = function() {\r\n        a._clearItemImage(this, true)\r\n    }\r\n    ;\r\n    this.setItemImageDis = function(h) {\r\n        a._setItemImage(this, h, false)\r\n    }\r\n    ;\r\n    this.clearItemImageDis = function() {\r\n        a._clearItemImage(this, false)\r\n    }\r\n    ;\r\n    this.setItemToolTip = function(h) {\r\n        this.obj.title = h\r\n    }\r\n    ;\r\n    this.getItemToolTip = function() {\r\n        return this.obj.title\r\n    }\r\n    ;\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._sliderObject = function(g, l, h) {\r\n    this.id = g.idPrefix + l;\r\n    this.state = (h.enabled != null  ? (h.enabled == \"true\" ? true : false) : true);\r\n    this.obj = document.createElement(\"DIV\");\r\n    this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_\" + (this.state ? \"def\" : \"dis\");\r\n    this.obj.style.display = (h.hidden != null  ? \"none\" : \"\");\r\n    this.obj.onselectstart = function(m) {\r\n        m = m || event;\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this.obj.idd = String(l);\r\n    this.obj.len = (h.length != null  ? Number(h.length) : 50);\r\n    this.obj.innerHTML = \"<div class='dhxtoolbar_text'>\" + (h.textMin || \"\") + \"</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:\" + this.obj.len + \"px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>\" + (h.textMax || \"\") + \"</div>\";\r\n    g.base.appendChild(this.obj);\r\n    var a = this;\r\n    this.pen = document.createElement(\"DIV\");\r\n    this.pen.className = \"dhxtoolbar_sl_pen\";\r\n    this.obj.appendChild(this.pen);\r\n    var e = this.pen;\r\n    this.label = document.createElement(\"DIV\");\r\n    this.label.dir = \"ltr\";\r\n    this.label.className = \"dhx_toolbar_slider_label_\" + g.conf.skin + (g.rtl ? \"_rtl\" : \"\");\r\n    this.label.style.display = \"none\";\r\n    this.label.tip = (h.toolTip || \"%v\");\r\n    this.label._zi = window.dhx4.newId();\r\n    document.body.appendChild(this.label);\r\n    var c = this.label;\r\n    this.pen.valueMin = (h.valueMin != null  ? Number(h.valueMin) : 0);\r\n    this.pen.valueMax = (h.valueMax != null  ? Number(h.valueMax) : 100);\r\n    if (this.pen.valueMin > this.pen.valueMax) {\r\n        this.pen.valueMin = this.pen.valueMax\r\n    }\r\n    this.pen.valueNow = (h.valueNow != null  ? Number(h.valueNow) : this.pen.valueMax);\r\n    if (this.pen.valueNow > this.pen.valueMax) {\r\n        this.pen.valueNow = this.pen.valueMax\r\n    }\r\n    if (this.pen.valueNow < this.pen.valueMin) {\r\n        this.pen.valueNow = this.pen.valueMin\r\n    }\r\n    this.pen._detectLimits = function() {\r\n        this.minX = a.obj.childNodes[1].offsetLeft + 2;\r\n        this.maxX = a.obj.childNodes[3].offsetLeft - this.offsetWidth + 1\r\n    }\r\n    ;\r\n    this.pen._detectLimits();\r\n    this.pen._definePos = function() {\r\n        this.nowX = Math.round((this.valueNow - this.valueMin) * (this.maxX - this.minX) / (this.valueMax - this.valueMin) + this.minX);\r\n        this.style.left = this.nowX + \"px\";\r\n        this.newNowX = this.nowX\r\n    }\r\n    ;\r\n    this.pen._definePos();\r\n    this.pen.initXY = 0;\r\n    this.pen.allowMove = false;\r\n    this.pen[window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(m) {\r\n        if (a.state == false) {\r\n            return\r\n        }\r\n        m = m || event;\r\n        this.initXY = (window.dhx4.isIPad ? m.touches[0].clientX : m.clientX);\r\n        this.newValueNow = this.valueNow;\r\n        this.allowMove = true;\r\n        this.className = \"dhxtoolbar_sl_pen dhxtoolbar_over\";\r\n        if (c.tip != \"\") {\r\n            c.style.visibility = \"hidden\";\r\n            c.style.display = \"\";\r\n            c.innerHTML = c.tip.replace(\"%v\", this.valueNow);\r\n            c.style.left = Math.round(window.dhx4.absLeft(this) + this.offsetWidth / 2 - c.offsetWidth / 2) + \"px\";\r\n            c.style.top = window.dhx4.absTop(this) - c.offsetHeight - 3 + \"px\";\r\n            c.style.visibility = \"\";\r\n            c.style.zIndex = window.dhx4.zim.reserve(c._zi)\r\n        }\r\n    }\r\n    ;\r\n    this.pen._doOnMouseMoveStart = function(n) {\r\n        n = n || event;\r\n        if (!e.allowMove) {\r\n            return\r\n        }\r\n        var m = (window.dhx4.isIPad ? n.touches[0].clientX : n.clientX);\r\n        var o = m - e.initXY;\r\n        if (m < window.dhx4.absLeft(e) + Math.round(e.offsetWidth / 2) && e.nowX == e.minX) {\r\n            return\r\n        }\r\n        if (m > window.dhx4.absLeft(e) + Math.round(e.offsetWidth / 2) && e.nowX == e.maxX) {\r\n            return\r\n        }\r\n        e.newNowX = e.nowX + o;\r\n        if (e.newNowX < e.minX) {\r\n            e.newNowX = e.minX\r\n        }\r\n        if (e.newNowX > e.maxX) {\r\n            e.newNowX = e.maxX\r\n        }\r\n        e.nowX = e.newNowX;\r\n        e.style.left = e.nowX + \"px\";\r\n        e.initXY = m;\r\n        e.newValueNow = Math.round((e.valueMax - e.valueMin) * (e.newNowX - e.minX) / (e.maxX - e.minX) + e.valueMin);\r\n        if (c.tip != \"\") {\r\n            c.innerHTML = c.tip.replace(/%v/gi, e.newValueNow);\r\n            c.style.left = Math.round(window.dhx4.absLeft(e) + e.offsetWidth / 2 - c.offsetWidth / 2) + \"px\";\r\n            c.style.top = window.dhx4.absTop(e) - c.offsetHeight - 3 + \"px\"\r\n        }\r\n        n.cancelBubble = true;\r\n        if (n.preventDefault) {\r\n            n.preventDefault()\r\n        } else {\r\n            n.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this.pen._doOnMouseMoveEnd = function() {\r\n        if (!e.allowMove) {\r\n            return\r\n        }\r\n        e.className = \"dhxtoolbar_sl_pen\";\r\n        e.allowMove = false;\r\n        e.nowX = e.newNowX;\r\n        e.valueNow = e.newValueNow;\r\n        if (c.tip != \"\") {\r\n            c.style.display = \"none\";\r\n            window.dhx4.zim.clear(c._zi)\r\n        }\r\n        g.callEvent(\"onValueChange\", [a.obj.idd.replace(g.idPrefix, \"\"), e.valueNow])\r\n    }\r\n    ;\r\n    if (window.dhx4.isIPad) {\r\n        document.addEventListener(\"touchmove\", e._doOnMouseMoveStart, false);\r\n        document.addEventListener(\"touchend\", e._doOnMouseMoveEnd, false)\r\n    } else {\r\n        if (typeof (window.addEventListener) != \"undefined\") {\r\n            window.addEventListener(\"mousemove\", e._doOnMouseMoveStart, false);\r\n            window.addEventListener(\"mouseup\", e._doOnMouseMoveEnd, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousemove\", e._doOnMouseMoveStart);\r\n            document.body.attachEvent(\"onmouseup\", e._doOnMouseMoveEnd)\r\n        }\r\n    }\r\n    this.enableItem = function() {\r\n        if (this.state) {\r\n            return\r\n        }\r\n        this.state = true;\r\n        this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_def\"\r\n    }\r\n    ;\r\n    this.disableItem = function() {\r\n        if (!this.state) {\r\n            return\r\n        }\r\n        this.state = false;\r\n        this.obj.className = \"dhx_toolbar_btn dhxtoolbar_btn_dis\"\r\n    }\r\n    ;\r\n    this.isEnabled = function() {\r\n        return this.state\r\n    }\r\n    ;\r\n    this.showItem = function() {\r\n        this.obj.style.display = \"\"\r\n    }\r\n    ;\r\n    this.hideItem = function() {\r\n        this.obj.style.display = \"none\"\r\n    }\r\n    ;\r\n    this.isVisible = function() {\r\n        return ( this.obj.style.display == \"\") \r\n    }\r\n    ;\r\n    this.setValue = function(m, n) {\r\n        m = Number(m);\r\n        if (m < this.pen.valueMin) {\r\n            m = this.pen.valueMin\r\n        }\r\n        if (m > this.pen.valueMax) {\r\n            m = this.pen.valueMax\r\n        }\r\n        this.pen.valueNow = m;\r\n        this.pen._definePos();\r\n        if (n == true) {\r\n            g.callEvent(\"onValueChange\", [this.obj.idd.replace(g.idPrefix, \"\"), this.pen.valueNow])\r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.pen.valueNow\r\n    }\r\n    ;\r\n    this.setMinValue = function(n, m) {\r\n        n = Number(n);\r\n        if (n > this.pen.valueMax) {\r\n            return\r\n        }\r\n        this.obj.childNodes[0].innerHTML = m;\r\n        this.obj.childNodes[0].style.display = (m.length > 0 ? \"\" : \"none\");\r\n        this.pen.valueMin = n;\r\n        if (this.pen.valueNow < this.pen.valueMin) {\r\n            this.pen.valueNow = this.pen.valueMin\r\n        }\r\n        this.pen._detectLimits();\r\n        this.pen._definePos()\r\n    }\r\n    ;\r\n    this.setMaxValue = function(n, m) {\r\n        n = Number(n);\r\n        if (n < this.pen.valueMin) {\r\n            return\r\n        }\r\n        this.obj.childNodes[4].innerHTML = m;\r\n        this.obj.childNodes[4].style.display = (m.length > 0 ? \"\" : \"none\");\r\n        this.pen.valueMax = n;\r\n        if (this.pen.valueNow > this.pen.valueMax) {\r\n            this.pen.valueNow = this.pen.valueMax\r\n        }\r\n        this.pen._detectLimits();\r\n        this.pen._definePos()\r\n    }\r\n    ;\r\n    this.getMinValue = function() {\r\n        var m = this.obj.childNodes[0].innerHTML;\r\n        var n = this.pen.valueMin;\r\n        return new Array(n,m)\r\n    }\r\n    ;\r\n    this.getMaxValue = function() {\r\n        var m = this.obj.childNodes[4].innerHTML;\r\n        var n = this.pen.valueMax;\r\n        return new Array(n,m)\r\n    }\r\n    ;\r\n    this.setItemToolTipTemplate = function(m) {\r\n        this.label.tip = m\r\n    }\r\n    ;\r\n    this.getItemToolTipTemplate = function() {\r\n        return this.label.tip\r\n    }\r\n    ;\r\n    return this\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.unload = function() {\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        window.removeEventListener(\"mousedown\", this._doOnClick, false);\r\n        window.removeEventListener(\"touchstart\", this._doOnClick, false)\r\n    } else {\r\n        document.body.detachEvent(\"onmousedown\", this._doOnClick)\r\n    }\r\n    this._doOnClick = null ;\r\n    this.clearAll();\r\n    this.objPull = null ;\r\n    if (this._xmlLoader) {\r\n        this._xmlLoader.destructor();\r\n        this._xmlLoader = null \r\n    }\r\n    while (this.base.childNodes.length > 0) {\r\n        this.base.removeChild(this.base.childNodes[0])\r\n    }\r\n    this.cont.removeChild(this.base);\r\n    this.base = null ;\r\n    while (this.cont.childNodes.length > 0) {\r\n        this.cont.removeChild(this.cont.childNodes[0])\r\n    }\r\n    this.cont.className = \"\";\r\n    this.cont = null ;\r\n    window.dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n    window.dhx4._eventable(this, \"clear\");\r\n    this.tX1 = null ;\r\n    this.tX2 = null ;\r\n    this.tY1 = null ;\r\n    this.tY2 = null ;\r\n    this.anyUsed = null ;\r\n    this.idPrefix = null ;\r\n    this.rootTypes = null ;\r\n    this._rtl = null ;\r\n    this._rtlParseBtn = null ;\r\n    this.setRTL = null ;\r\n    this._sbw = null ;\r\n    this._getObj = null ;\r\n    this._addImgObj = null ;\r\n    this._setItemImage = null ;\r\n    this._clearItemImage = null ;\r\n    this._setItemText = null ;\r\n    this._getItemText = null ;\r\n    this._enableItem = null ;\r\n    this._disableItem = null ;\r\n    this._xmlParser = null ;\r\n    this._addItemToStorage = null ;\r\n    this._genStr = null ;\r\n    this._addItem = null ;\r\n    this._getPosition = null ;\r\n    this._setPosition = null ;\r\n    this._getIdByPosition = null ;\r\n    this._separatorObject = null ;\r\n    this._textObject = null ;\r\n    this._buttonObject = null ;\r\n    this._buttonSelectObject = null ;\r\n    this._buttonInputObject = null ;\r\n    this._buttonTwoStateObject = null ;\r\n    this._sliderObject = null ;\r\n    this._autoDetectVisibleArea = null ;\r\n    this._removeItem = null ;\r\n    this.setAlign = null ;\r\n    this.setSkin = null ;\r\n    this.setIconsPath = null ;\r\n    this.setIconPath = null ;\r\n    this.loadXML = null ;\r\n    this.loadXMLString = null ;\r\n    this.clearAll = null ;\r\n    this.addSpacer = null ;\r\n    this.removeSpacer = null ;\r\n    this.getType = null ;\r\n    this.getTypeExt = null ;\r\n    this.inArray = null ;\r\n    this.getParentId = null ;\r\n    this.addButton = null ;\r\n    this.addText = null ;\r\n    this.addButtonSelect = null ;\r\n    this.addButtonTwoState = null ;\r\n    this.addSeparator = null ;\r\n    this.addSlider = null ;\r\n    this.addInput = null ;\r\n    this.forEachItem = null ;\r\n    this.showItem = null ;\r\n    this.hideItem = null ;\r\n    this.isVisible = null ;\r\n    this.enableItem = null ;\r\n    this.disableItem = null ;\r\n    this.isEnabled = null ;\r\n    this.setItemText = null ;\r\n    this.getItemText = null ;\r\n    this.setItemToolTip = null ;\r\n    this.getItemToolTip = null ;\r\n    this.setItemImage = null ;\r\n    this.setItemImageDis = null ;\r\n    this.clearItemImage = null ;\r\n    this.clearItemImageDis = null ;\r\n    this.setItemState = null ;\r\n    this.getItemState = null ;\r\n    this.setItemToolTipTemplate = null ;\r\n    this.getItemToolTipTemplate = null ;\r\n    this.setValue = null ;\r\n    this.getValue = null ;\r\n    this.setMinValue = null ;\r\n    this.getMinValue = null ;\r\n    this.setMaxValue = null ;\r\n    this.getMaxValue = null ;\r\n    this.setWidth = null ;\r\n    this.getWidth = null ;\r\n    this.getPosition = null ;\r\n    this.setPosition = null ;\r\n    this.removeItem = null ;\r\n    this.addListOption = null ;\r\n    this.removeListOption = null ;\r\n    this.showListOption = null ;\r\n    this.hideListOption = null ;\r\n    this.isListOptionVisible = null ;\r\n    this.enableListOption = null ;\r\n    this.disableListOption = null ;\r\n    this.isListOptionEnabled = null ;\r\n    this.setListOptionPosition = null ;\r\n    this.getListOptionPosition = null ;\r\n    this.setListOptionText = null ;\r\n    this.getListOptionText = null ;\r\n    this.setListOptionToolTip = null ;\r\n    this.getListOptionToolTip = null ;\r\n    this.setListOptionImage = null ;\r\n    this.getListOptionImage = null ;\r\n    this.clearListOptionImage = null ;\r\n    this.forEachListOption = null ;\r\n    this.getAllListOptions = null ;\r\n    this.setListOptionSelected = null ;\r\n    this.getListOptionSelected = null ;\r\n    this.unload = null ;\r\n    this.setUserData = null ;\r\n    this.getUserData = null ;\r\n    this.setMaxOpen = null ;\r\n    this.items = null ;\r\n    this.conf = null \r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._autoDetectVisibleArea = function() {\r\n    var a = window.dhx4.screenDim();\r\n    this.tX1 = a.left;\r\n    this.tX2 = a.right;\r\n    this.tY1 = a.top;\r\n    this.tY2 = a.bottom\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._initObj = function(c) {\r\n    for (var a = 0; a < c.length; a++) {\r\n        this._addItemToStorage(c[a])\r\n    }\r\n    if (this.conf.skin == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._xmlToJson = function(v) {\r\n    var o = [];\r\n    var A = v.getElementsByTagName(\"toolbar\");\r\n    if (A != null  && A[0] != null ) {\r\n        A = A[0];\r\n        var x = function(h) {\r\n            var e = null ;\r\n            for (var r = 0; r < h.childNodes.length; r++) {\r\n                if (e == null  && h.childNodes[r].tagName == \"itemText\") {\r\n                    e = window.dhx4._xmlNodeValue(h.childNodes[r]);\r\n                    break\r\n                }\r\n            }\r\n            return e\r\n        }\r\n        ;\r\n        var E = [\"id\", \"type\", \"hidden\", \"title\", \"text\", \"enabled\", \"img\", \"imgdis\", \"action\", \"openAll\", \"renderSelect\", \"mode\", \"maxOpen\", \"width\", \"value\", \"selected\", \"length\", \"textMin\", \"textMax\", \"toolTip\", \"valueMin\", \"valueMax\", \"valueNow\"];\r\n        var g = [\"id\", \"type\", \"enabled\", \"disabled\", \"action\", \"selected\", \"img\", \"text\"];\r\n        for (var c = 0; c < A.childNodes.length; c++) {\r\n            if (A.childNodes[c].tagName == \"item\") {\r\n                var n = {};\r\n                for (var C = 0; C < E.length; C++) {\r\n                    var l = A.childNodes[c].getAttribute(E[C]);\r\n                    if (l != null ) {\r\n                        n[E[C]] = l\r\n                    }\r\n                }\r\n                for (var y = 0; y < A.childNodes[c].childNodes.length; y++) {\r\n                    if (A.childNodes[c].childNodes[y].tagName == \"item\" && n.type == \"buttonSelect\") {\r\n                        var D = {};\r\n                        for (var C = 0; C < g.length; C++) {\r\n                            var l = A.childNodes[c].childNodes[y].getAttribute(g[C]);\r\n                            if (l != null ) {\r\n                                D[g[C]] = l\r\n                            }\r\n                        }\r\n                        var s = A.childNodes[c].childNodes[y].getElementsByTagName(\"userdata\");\r\n                        for (var C = 0; C < s.length; C++) {\r\n                            if (!D.userdata) {\r\n                                D.userdata = {}\r\n                            }\r\n                            var a = {};\r\n                            try {\r\n                                a.name = s[C].getAttribute(\"name\")\r\n                            } catch (m) {\r\n                                a.name = null \r\n                            }\r\n                            try {\r\n                                a.value = s[C].firstChild.nodeValue\r\n                            } catch (m) {\r\n                                a.value = \"\"\r\n                            }\r\n                            if (a.name != null ) {\r\n                                D.userdata[a.name] = a.value\r\n                            }\r\n                        }\r\n                        D.text = x(A.childNodes[c].childNodes[y]) || D.text;\r\n                        if (n.options == null ) {\r\n                            n.options = []\r\n                        }\r\n                        n.options.push(D)\r\n                    }\r\n                    if (A.childNodes[c].childNodes[y].tagName == \"userdata\") {\r\n                        if (n.userdata == null ) {\r\n                            n.userdata = {}\r\n                        }\r\n                        var D = {};\r\n                        try {\r\n                            D.name = A.childNodes[c].childNodes[y].getAttribute(\"name\")\r\n                        } catch (m) {\r\n                            D.name = null \r\n                        }\r\n                        try {\r\n                            D.value = A.childNodes[c].childNodes[y].firstChild.nodeValue\r\n                        } catch (m) {\r\n                            D.value = \"\"\r\n                        }\r\n                        if (D.name != null ) {\r\n                            n.userdata[D.name] = D.value\r\n                        }\r\n                    }\r\n                }\r\n                n.text = x(A.childNodes[c]) || n.text;\r\n                o.push(n)\r\n            }\r\n        }\r\n        x = null \r\n    }\r\n    return o\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._addItemToStorage = function(l, n) {\r\n    var m = (l.id || this._genStr(24));\r\n    var g = (l.type || \"\");\r\n    if (g == \"spacer\") {\r\n        this.addSpacer(this._lastId)\r\n    } else {\r\n        this._lastId = m\r\n    }\r\n    if (g != \"\" && this[\"_\" + g + \"Object\"] != null ) {\r\n        if (g == \"buttonSelect\") {\r\n            if (l.options != null ) {\r\n                for (var h = 0; h < l.options.length; h++) {\r\n                    if (l.options[h].type == \"obj\") {\r\n                        l.options[h].type = \"button\"\r\n                    }\r\n                    if (l.options[h].type == \"sep\") {\r\n                        l.options[h].type = \"separator\"\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (g == \"slider\") {\r\n            var e = {\r\n                tip_template: \"toolTip\",\r\n                value_min: \"valueMin\",\r\n                value_max: \"valueMax\",\r\n                value_now: \"valueNow\",\r\n                text_min: \"textMin\",\r\n                text_max: \"textMax\"\r\n            };\r\n            for (var c in e) {\r\n                if (l[e[c]] == null  && l[c] != null ) {\r\n                    l[e[c]] = l[c]\r\n                }\r\n            }\r\n        }\r\n        if (g == \"buttonInput\") {\r\n            if (l.value == null  && l.text != null ) {\r\n                l.value = l.text\r\n            }\r\n        }\r\n        if (g == \"buttonTwoState\") {\r\n            if (typeof (l.selected) == \"undefined\" && typeof (l.pressed) != \"undefined\" && window.dhx4.s2b(l.pressed)) {\r\n                l.selected = true\r\n            }\r\n        }\r\n        if (typeof (l.enabled) == \"undefined\" && typeof (l.disabled) != \"undefined\" && window.dhx4.s2b(l.disabled)) {\r\n            l.enabled = false\r\n        }\r\n        if (l.imgDis == null  && l.img_disabled != null ) {\r\n            l.imgdis = l.img_disabled\r\n        }\r\n        if ((typeof (l.openAll) == \"undefined\" || l.openAll == null ) && this.conf.skin == \"dhx_terrace\") {\r\n            l.openAll = true\r\n        }\r\n        this.objPull[this.idPrefix + m] = new this[\"_\" + g + \"Object\"](this,m,l);\r\n        this.objPull[this.idPrefix + m][\"type\"] = g;\r\n        this.setPosition(m, n)\r\n    }\r\n    if (l.userdata != null ) {\r\n        for (var c in l.userdata) {\r\n            this.setUserData(m, c, l.userdata[c])\r\n        }\r\n    }\r\n    if (l.options != null ) {\r\n        for (var h = 0; h < l.options.length; h++) {\r\n            if (l.options[h].userdata != null ) {\r\n                for (var c in l.options[h].userdata) {\r\n                    this.setListOptionUserData(l.id, l.options[h].id, c, l.options[h].userdata[c])\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setSkin = function(h, e) {\r\n    if (e === true) {\r\n        this.cont.className = this.cont.className.replace(/dhxtoolbar_icons_\\d{1,}/, \"dhxtoolbar_icons_\" + this.conf.iconSize)\r\n    } else {\r\n        this.conf.skin = h;\r\n        if (this.conf.skin == \"dhx_skyblue\") {\r\n            this.conf.sel_ofs_y = 1\r\n        }\r\n        if (this.conf.skin == \"dhx_web\") {\r\n            this.conf.sel_ofs_y = 1;\r\n            this.conf.sel_ofs_x = 1\r\n        }\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            this.conf.sel_ofs_y = -1;\r\n            this.conf.sel_ofs_x = 0\r\n        }\r\n        this.cont.className = \"dhx_toolbar_\" + this.conf.skin + \" dhxtoolbar_icons_\" + this.conf.iconSize\r\n    }\r\n    for (var c in this.objPull) {\r\n        var g = this.objPull[c];\r\n        if (g.type == \"slider\") {\r\n            g.pen._detectLimits();\r\n            g.pen._definePos();\r\n            g.label.className = \"dhx_toolbar_slider_label_\" + this.conf.skin\r\n        }\r\n        if (g.type == \"buttonSelect\") {\r\n            g.polygon.className = \"dhx_toolbar_poly_\" + this.conf.skin + \" dhxtoolbar_icons_\" + this.conf.iconSize\r\n        }\r\n    }\r\n    if (h == \"dhx_terrace\") {\r\n        this._improveTerraceSkin()\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setAlign = function(a) {\r\n    this.conf.align = (a == \"right\" ? \"right\" : \"left\");\r\n    this.base.className = (a == \"right\" ? \"dhxtoolbar_float_right\" : \"dhxtoolbar_float_left\");\r\n    if (this._spacer) {\r\n        this._spacer.className = (a == \"right\" ? \" dhxtoolbar_float_left\" : \" dhxtoolbar_float_right\")\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setIconSize = function(a) {\r\n    this.conf.iconSize = ({\r\n        18: true,\r\n        24: true,\r\n        32: true,\r\n        48: true\r\n    }[a] ? a : 18);\r\n    this.setSkin(this.conf.skin, true);\r\n    this.callEvent(\"_onIconSizeChange\", [this.conf.iconSize])\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setIconsPath = function(a) {\r\n    this.conf.icons_path = a\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setUserData = function(e, a, c) {\r\n    e = this.idPrefix + e;\r\n    if (this.objPull[e] != null ) {\r\n        if (this.objPull[e].userData == null ) {\r\n            this.objPull[e].userData = {}\r\n        }\r\n        this.objPull[e].userData[a] = c\r\n    }\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.getUserData = function(c, a) {\r\n    c = this.idPrefix + c;\r\n    if (this.objPull[c] != null  && this.objPull[c].userData != null ) {\r\n        return this.objPull[c].userData[a] || null \r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._isListOptionExists = function(a, e) {\r\n    if (this.objPull[this.idPrefix + a] == null ) {\r\n        return false\r\n    }\r\n    var c = this.objPull[this.idPrefix + a];\r\n    if (c.type != \"buttonSelect\") {\r\n        return false\r\n    }\r\n    if (c._listOptions[e] == null ) {\r\n        return false\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.setListOptionUserData = function(a, h, c, g) {\r\n    if (!this._isListOptionExists(a, h)) {\r\n        return\r\n    }\r\n    var e = this.objPull[this.idPrefix + a]._listOptions[h];\r\n    if (e.userData == null ) {\r\n        e.userData = {}\r\n    }\r\n    e.userData[c] = g\r\n}\r\n;\r\ndhtmlXToolbarObject.prototype.getListOptionUserData = function(a, g, c) {\r\n    if (!this._isListOptionExists(a, g)) {\r\n        return null \r\n    }\r\n    var e = this.objPull[this.idPrefix + a]._listOptions[g];\r\n    if (!e.userData) {\r\n        return null \r\n    }\r\n    return ( e.userData[c] ? e.userData[c] : null ) \r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._improveTerraceSkin = function() {\r\n    if (this.conf.terrace_radius == null ) {\r\n        this.conf.terrace_radius = \"3px\"\r\n    }\r\n    var g = [];\r\n    var h = {\r\n        separator: true,\r\n        text: true\r\n    };\r\n    var m = [this.base];\r\n    if (this._spacer != null ) {\r\n        m.push(this._spacer)\r\n    }\r\n    for (var o = 0; o < m.length; o++) {\r\n        g[o] = [];\r\n        for (var c = 0; c < m[o].childNodes.length; c++) {\r\n            if (m[o].childNodes[c].idd != null  && m[o].childNodes[c].style.display != \"none\") {\r\n                var n = this.idPrefix + m[o].childNodes[c].idd;\r\n                if (this.objPull[n] != null  && this.objPull[n].obj == m[o].childNodes[c]) {\r\n                    g[o].push({\r\n                        a: n,\r\n                        type: this.objPull[n].type,\r\n                        node: this.objPull[n][this.objPull[n].type == \"buttonSelect\" ? \"arw\" : \"obj\"]\r\n                    })\r\n                }\r\n            }\r\n        }\r\n        m[o] = null \r\n    }\r\n    for (var o = 0; o < g.length; o++) {\r\n        for (var c = 0; c < g[o].length; c++) {\r\n            var r = g[o][c];\r\n            var s = false;\r\n            var l = false;\r\n            if (!h[r.type]) {\r\n                if (c == g[o].length - 1 || (g[o][c + 1] != null  && h[g[o][c + 1].type])) {\r\n                    s = true\r\n                }\r\n                if (c == 0 || (c - 1 >= 0 && g[o][c - 1] != null  && h[g[o][c - 1].type])) {\r\n                    l = true\r\n                }\r\n            }\r\n            r.node.style.borderRightWidth = (s ? \"1px\" : \"0px\");\r\n            r.node.style.borderTopRightRadius = r.node.style.borderBottomRightRadius = (s ? this.conf.terrace_radius : \"0px\");\r\n            if (r.type == \"buttonSelect\") {\r\n                r.node.previousSibling.style.borderTopLeftRadius = r.node.previousSibling.style.borderBottomLeftRadius = (l ? this.conf.terrace_radius : \"0px\");\r\n                r.node.previousSibling._br = s;\r\n                r.node.previousSibling._bl = l\r\n            } else {\r\n                r.node.style.borderTopLeftRadius = r.node.style.borderBottomLeftRadius = (l ? this.conf.terrace_radius : \"0px\")\r\n            }\r\n            r.node._br = s;\r\n            r.node._bl = l\r\n        }\r\n    }\r\n    for (var o = 0; o < g.length; o++) {\r\n        for (var c = 0; c < g[o].length; c++) {\r\n            for (var n in g[o][c]) {\r\n                g[o][c][n] = null \r\n            }\r\n            g[o][c] = null \r\n        }\r\n        g[o] = null \r\n    }\r\n    g = m = null \r\n}\r\n;\r\ndhtmlXToolbarObject.prototype._improveTerraceButtonSelect = function(e, c) {\r\n    var a = this.objPull[e];\r\n    if (c == true) {\r\n        a.obj.style.borderBottomLeftRadius = (a.obj._bl ? this.conf.terrace_radius : \"0px\");\r\n        a.arw.style.borderBottomRightRadius = (a.obj._br ? this.conf.terrace_radius : \"0px\")\r\n    } else {\r\n        a.obj.style.borderBottomLeftRadius = \"0px\";\r\n        a.arw.style.borderBottomRightRadius = \"0px\"\r\n    }\r\n    a = null \r\n}\r\n;\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype._createNode_toolbar = function(h, c, g, a, e) {\r\n        if (typeof (e) != \"undefined\") {\r\n            h = e\r\n        } else {\r\n            h = document.createElement(\"DIV\");\r\n            h.className = \"dhx_cell_toolbar_\" + (this.conf.borders ? \"def\" : \"no_borders\");\r\n            h.appendChild(document.createElement(\"DIV\"));\r\n            h.firstChild.className = \"dhx_toolbar_base_18_dhx_skyblue\"\r\n        }\r\n        this.cell.insertBefore(h, this.cell.childNodes[this.conf.idx.cont]);\r\n        this.conf.ofs_nodes.t.toolbar = true;\r\n        this._updateIdx();\r\n        return h\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.attachToolbar = function(a) {\r\n        if (!(this.dataNodes.ribbon == null  && this.dataNodes.toolbar == null )) {\r\n            return\r\n        }\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"toolbar\"]);\r\n        if (typeof (a) == \"undefined\") {\r\n            a = {}\r\n        } else {\r\n            if (typeof (a) == \"string\") {\r\n                a = {\r\n                    skin: a\r\n                }\r\n            }\r\n        }\r\n        if (typeof (a.skin) == \"undefined\") {\r\n            a.skin = this.conf.skin\r\n        }\r\n        a.parent = this._attachObject(\"toolbar\").firstChild;\r\n        this.dataNodes.toolbar = new dhtmlXToolbarObject(a);\r\n        this._adjustCont(this._idd);\r\n        this.dataNodes.toolbar._masterCell = this;\r\n        this.dataNodes.toolbar.attachEvent(\"_onIconSizeChange\", function() {\r\n            this._masterCell._adjustCont()\r\n        });\r\n        a.parent = null ;\r\n        a = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataNodes.toolbar\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.detachToolbar = function() {\r\n        if (!this.dataNodes.toolbar) {\r\n            return\r\n        }\r\n        this.dataNodes.toolbar._masterCell = null ;\r\n        this.dataNodes.toolbar.unload();\r\n        this.dataNodes.toolbar = null ;\r\n        delete this.dataNodes.toolbar;\r\n        this._detachObject(\"toolbar\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.showToolbar = function() {\r\n        this._mtbShowHide(\"toolbar\", \"\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.hideToolbar = function() {\r\n        this._mtbShowHide(\"toolbar\", \"none\")\r\n    }\r\n    ;\r\n    dhtmlXCellObject.prototype.getAttachedToolbar = function() {\r\n        return this.dataNodes.toolbar\r\n    }\r\n}\r\nfunction dhtmlXEditor(e, g) {\r\n    var c = this;\r\n    this.conf = {\r\n        content: \"\",\r\n        contentHTML: \"\",\r\n        resizeTM: null ,\r\n        resizeTMTime: 100,\r\n        roMode: false,\r\n        toolbar: false,\r\n        iconsPath: \"\",\r\n        evs: [\"focus\", \"blur\", \"keydown\", \"keyup\", \"keypress\", \"mouseup\", \"mousedown\", \"click\", \"touchend\"],\r\n        iOSfix: (navigator.userAgent.match(/Mobile/gi) != null  && navigator.userAgent.match(/iPad/gi) != null  && navigator.userAgent.match(/AppleWebKit/gi) != null )\r\n    };\r\n    this._doOnFocusChanged = null ;\r\n    this._doOnAccess = null ;\r\n    if (typeof (e) == \"object\" && e != null  && e.tagName == null ) {\r\n        g = e.skin;\r\n        if (e.content != null ) {\r\n            this.conf.content = e.content\r\n        }\r\n        if (e.contentHTML != null ) {\r\n            this.conf.contentHTML = e.contentHTML\r\n        }\r\n        if (e.iconsPath != null ) {\r\n            this.conf.iconsPath = e.iconsPath\r\n        }\r\n        if (e.toolbar != null ) {\r\n            this.conf.toolbar = window.dhx4.s2b(e.toolbar)\r\n        }\r\n        if (e.onFocusChanged != null ) {\r\n            this._doOnFocusChanged = e.onFocusChanged\r\n        }\r\n        if (e.onAccess != null ) {\r\n            this._doOnAccess = e.onAccess\r\n        }\r\n        e = e.parent\r\n    }\r\n    this.conf.skin = (g || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxeditor\") || \"dhx_skyblue\");\r\n    if (typeof (e) == \"string\") {\r\n        e = document.getElementById(e)\r\n    }\r\n    this.base = e;\r\n    this.base.className += \" dhxeditor_\" + this.conf.skin;\r\n    while (this.base.childNodes.length > 0) {\r\n        this.base.removeChild(this.base.childNodes[0])\r\n    }\r\n    var h = (window.dhx4.isIE ? this.base.currentStyle.position : (window.getComputedStyle != null  ? window.getComputedStyle(this.base, null ).getPropertyValue(\"position\") : \"\"));\r\n    if (!(h == \"relative\" || h == \"absolute\")) {\r\n        this.base.style.position = \"relative\"\r\n    }\r\n    this.cell = new dhtmlXEditorCell(window.dhx4.newId(),this);\r\n    this.base.appendChild(this.cell.cell);\r\n    this.cBlock = document.createElement(\"DIV\");\r\n    this.cBlock.className = \"dhxcont_content_blocker\";\r\n    this.cBlock.style.display = \"none\";\r\n    this.base.appendChild(this.cBlock);\r\n    this.editor = document.createElement(\"IFRAME\");\r\n    this.editor.className = \"dhxeditor_mainiframe\";\r\n    this.editor.frameBorder = 0;\r\n    if (window.dhx4.isOpera) {\r\n        this.editor.scrolling = \"yes\"\r\n    }\r\n    this.setSizes();\r\n    var a = this.editor;\r\n    if (typeof (window.addEventListener) != \"undefined\") {\r\n        a.onload = function() {\r\n            for (var l = 0; l < c.conf.evs.length; l++) {\r\n                a.contentWindow.addEventListener(c.conf.evs[l], c._ev, false)\r\n            }\r\n        }\r\n    } else {\r\n        a.onreadystatechange = function(l) {\r\n            if (typeof (a.readyState) != \"undefined\" && a.readyState == \"complete\") {\r\n                try {\r\n                    for (var m = 0; m < c.conf.evs.length; m++) {\r\n                        a.contentWindow.document.body.attachEvent(\"on\" + c.conf.evs[m], c._ev)\r\n                    }\r\n                } catch (n) {}\r\n            }\r\n        }\r\n    }\r\n    this._ev = function(m) {\r\n        m = m || event;\r\n        var l = m.type;\r\n        if (c.conf.iOSfix == true && l == \"touchend\") {\r\n            c.editor.contentWindow.focus();\r\n            return\r\n        }\r\n        c.callEvent(\"onAccess\", [l, m]);\r\n        if (typeof (c._doOnAccess) == \"function\") {\r\n            c._doOnAccess(l, m)\r\n        } else {\r\n            if (typeof (c._doOnAccess) == \"string\" && typeof (window[c._doOnAccess]) == \"function\") {\r\n                window[c._doOnAccess](l, m)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._focus = function() {\r\n        if (window.dhx4.isIE) {\r\n            this.editor.contentWindow.document.body.focus()\r\n        } else {\r\n            this.editor.contentWindow.focus()\r\n        }\r\n    }\r\n    ;\r\n    this.cell.attachObject(this.editor);\r\n    this.edWin = this.editor.contentWindow;\r\n    this.edDoc = this.edWin.document;\r\n    this._prepareContent = function(n, r) {\r\n        var m = \"\";\r\n        if (n === true && this.getContent != null ) {\r\n            m = this.getContent()\r\n        }\r\n        var l = this.editor.contentWindow.document;\r\n        l.open(\"text/html\", \"replace\");\r\n        if (window.dhx4.isOpera) {\r\n            l.write(\"<html><head><style> html, body { overflow:auto;-webkit-overflow-scrolling: touch; padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color:#ffffff;} </style></head><body \" + (r !== true ? \"contenteditable='true'\" : \"\") + \" tabindex='0'></body></html>\")\r\n        } else {\r\n            if (window.dhx4.isKHTML) {\r\n                l.write(\"<html><head><style> html {overflow-x: auto;-webkit-overflow-scrolling: touch; overflow-y: auto;} body { overflow: auto; overflow-y: scroll;} html,body { padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color:#ffffff;} </style></head><body \" + (r !== true ? \"contenteditable='true'\" : \"\") + \" tabindex='0'></body></html>\")\r\n            } else {\r\n                if (window.dhx4.isIE) {\r\n                    l.write(\"<html><head><style> html {overflow-y: auto;} body {overflow-y: scroll;-webkit-overflow-scrolling: touch;} html,body { overflow-x: auto; padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color: #ffffff; outline: none; } </style></head><body \" + (r !== true ? \"contenteditable='true'\" : \"\") + \" tabindex='0'></body></html>\")\r\n                } else {\r\n                    l.write(\"<html><head><style> html,body { overflow-x: auto; overflow-y:-webkit-overflow-scrolling: touch; scroll; padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color:#ffffff;} </style></head><body \" + (r !== true ? \"contenteditable='true'\" : \"\") + \" tabindex='0'></body></html>\")\r\n                }\r\n            }\r\n        }\r\n        l.close();\r\n        if (window.dhx4.isIE) {\r\n            l.contentEditable = (r !== true)\r\n        } else {\r\n            l.designMode = (r !== true ? \"On\" : \"Off\")\r\n        }\r\n        if (window.dhx4.isFF) {\r\n            try {\r\n                l.execCommand(\"useCSS\", false, true)\r\n            } catch (o) {}\r\n        }\r\n        if (n === true && this.setContent != null ) {\r\n            this.setContent(m)\r\n        }\r\n    }\r\n    ;\r\n    this._prepareContent();\r\n    this._doOnResize = function() {\r\n        window.clearTimeout(c.conf.resizeTM);\r\n        c.conf.resizeTM = window.setTimeout(function() {\r\n            if (c.setSizes) {\r\n                c.setSizes()\r\n            }\r\n        }, c.conf.resizeTMTime)\r\n    }\r\n    ;\r\n    this._runCommand = function(n, r) {\r\n        if (this.conf.roMode === true) {\r\n            return\r\n        }\r\n        if (arguments.length < 2) {\r\n            r = null \r\n        }\r\n        if (window.dhx4.isIE) {\r\n            this.edWin.focus()\r\n        }\r\n        try {\r\n            var m = this.editor.contentWindow.document;\r\n            m.execCommand(n, false, r)\r\n        } catch (o) {}\r\n        if (window.dhx4.isIE) {\r\n            this.edWin.focus();\r\n            var l = this;\r\n            window.setTimeout(function() {\r\n                l.edWin.focus();\r\n                l = null \r\n            }, 1)\r\n        }\r\n    }\r\n    ;\r\n    this.applyBold = function() {\r\n        this._runCommand(\"Bold\")\r\n    }\r\n    ;\r\n    this.applyItalic = function() {\r\n        this._runCommand(\"Italic\")\r\n    }\r\n    ;\r\n    this.applyUnderscore = function() {\r\n        this._runCommand(\"Underline\")\r\n    }\r\n    ;\r\n    this.clearFormatting = function() {\r\n        this._runCommand(\"RemoveFormat\");\r\n        var l = this.getContent();\r\n        l = l.replace(/<\\/?h\\d>/gi, \"\");\r\n        this.setContent(l)\r\n    }\r\n    ;\r\n    this._doOnClick = function(n) {\r\n        var m = n || window.event;\r\n        var l = m.target || m.srcElement;\r\n        c._showInfo(l)\r\n    }\r\n    ;\r\n    this._doOnMouseDown = function(n) {\r\n        var m = n || window.event;\r\n        var l = m.target || m.srcElement;\r\n        c._showInfo(l)\r\n    }\r\n    ;\r\n    this._doOnKeyUp = function(o) {\r\n        var n = o || window.event;\r\n        var l = n.keyCode;\r\n        var m = n.target || n.srcElement;\r\n        if ({\r\n            37: 1,\r\n            38: 1,\r\n            39: 1,\r\n            40: 1,\r\n            13: 1\r\n        }[l] == 1) {\r\n            c._showInfo(m)\r\n        }\r\n    }\r\n    ;\r\n    this._getParentByTag = function(l, n) {\r\n        n = n.toLowerCase();\r\n        var m = l;\r\n        do {\r\n            if (n == \"\" || m.nodeName.toLowerCase() == n) {\r\n                return m\r\n            }\r\n        } while (m = m.parentNode);return l\r\n    }\r\n    ;\r\n    this._isStyleProperty = function(m, r, l, o) {\r\n        r = r.toLowerCase();\r\n        var s = m;\r\n        do {\r\n            if ((s.nodeName.toLowerCase() == r) && (s.style[l] == o)) {\r\n                return true\r\n            }\r\n        } while (s = s.parentNode);return false\r\n    }\r\n    ;\r\n    this._setStyleProperty = function(l, o) {\r\n        this.style[o] = false;\r\n        var m = this._getParentByTag(l, o);\r\n        if (m && (m.tagName.toLowerCase() == o)) {\r\n            this.style[o] = true\r\n        }\r\n        if (o == \"del\" && this._getParentByTag(l, \"strike\") && this._getParentByTag(l, \"strike\").tagName.toLowerCase() == \"strike\") {\r\n            this.style.del = true\r\n        }\r\n    }\r\n    ;\r\n    this._showInfo = function(m) {\r\n        var m = (this._getSelectionBounds().end) ? this._getSelectionBounds().end : m;\r\n        if (!m || !this._setStyleProperty) {\r\n            return\r\n        }\r\n        try {\r\n            if (this.edWin.getComputedStyle) {\r\n                var l = this.edWin.getComputedStyle(m, null );\r\n                var n = ((l.getPropertyValue(\"font-weight\") == 401) ? 700 : l.getPropertyValue(\"font-weight\"));\r\n                this.style = {\r\n                    fontStyle: l.getPropertyValue(\"font-style\"),\r\n                    fontSize: l.getPropertyValue(\"font-size\"),\r\n                    textDecoration: l.getPropertyValue(\"text-decoration\"),\r\n                    fontWeight: n,\r\n                    fontFamily: l.getPropertyValue(\"font-family\"),\r\n                    textAlign: l.getPropertyValue(\"text-align\")\r\n                };\r\n                if (window.dhx4.isKHTML) {\r\n                    this.style.fontStyle = l.getPropertyValue(\"font-style\");\r\n                    this.style.vAlign = l.getPropertyValue(\"vertical-align\");\r\n                    this.style.del = this._isStyleProperty(m, \"span\", \"textDecoration\", \"line-through\");\r\n                    this.style.u = this._isStyleProperty(m, \"span\", \"textDecoration\", \"underline\")\r\n                }\r\n            } else {\r\n                var l = m.currentStyle;\r\n                this.style = {\r\n                    fontStyle: l.fontStyle,\r\n                    fontSize: l.fontSize,\r\n                    textDecoration: l.textDecoration,\r\n                    fontWeight: l.fontWeight,\r\n                    fontFamily: l.fontFamily,\r\n                    textAlign: l.textAlign\r\n                }\r\n            }\r\n            this._setStyleProperty(m, \"h1\");\r\n            this._setStyleProperty(m, \"h2\");\r\n            this._setStyleProperty(m, \"h3\");\r\n            this._setStyleProperty(m, \"h4\");\r\n            if (!window.dhx4.isKHTML) {\r\n                this._setStyleProperty(m, \"del\");\r\n                this._setStyleProperty(m, \"sub\");\r\n                this._setStyleProperty(m, \"sup\");\r\n                this._setStyleProperty(m, \"u\")\r\n            }\r\n            this.callEvent(\"onFocusChanged\", [this.style, l])\r\n        } catch (o) {\r\n            return null \r\n        }\r\n    }\r\n    ;\r\n    this._getSelectionBounds = function() {\r\n        var r, n, u, m;\r\n        if (this.edWin.getSelection) {\r\n            var s = this.edWin.getSelection();\r\n            if (window.dhx4.isEdge && s.rangeCount == 0) {\r\n                return {\r\n                    root: null ,\r\n                    start: null ,\r\n                    end: null \r\n                }\r\n            }\r\n            r = s.getRangeAt(s.rangeCount - 1);\r\n            u = r.startContainer;\r\n            m = r.endContainer;\r\n            n = r.commonAncestorContainer;\r\n            if (u.nodeName == \"#text\") {\r\n                n = n.parentNode\r\n            }\r\n            if (u.nodeName == \"#text\") {\r\n                u = u.parentNode\r\n            }\r\n            if (u.nodeName.toLowerCase() == \"body\") {\r\n                u = u.firstChild\r\n            }\r\n            if (m.nodeName == \"#text\") {\r\n                m = m.parentNode\r\n            }\r\n            if (m.nodeName.toLowerCase() == \"body\") {\r\n                m = m.lastChild\r\n            }\r\n            if (u == m) {\r\n                n = u\r\n            }\r\n            return {\r\n                root: n,\r\n                start: u,\r\n                end: m\r\n            }\r\n        } else {\r\n            if (this.edWin.document.selection) {\r\n                r = this.edDoc.selection.createRange();\r\n                if (!r.duplicate) {\r\n                    return null \r\n                }\r\n                n = r.parentElement();\r\n                var o = r.duplicate();\r\n                var l = r.duplicate();\r\n                o.collapse(true);\r\n                l.moveToElementText(o.parentElement());\r\n                l.setEndPoint(\"EndToStart\", o);\r\n                u = o.parentElement();\r\n                o = r.duplicate();\r\n                l = r.duplicate();\r\n                l.collapse(false);\r\n                o.moveToElementText(l.parentElement());\r\n                o.setEndPoint(\"StartToEnd\", l);\r\n                m = l.parentElement();\r\n                if (u.nodeName.toLowerCase() == \"body\") {\r\n                    u = u.firstChild\r\n                }\r\n                if (m.nodeName.toLowerCase() == \"body\") {\r\n                    m = m.lastChild\r\n                }\r\n                if (u == m) {\r\n                    n = u\r\n                }\r\n                return {\r\n                    root: n,\r\n                    start: u,\r\n                    end: m\r\n                }\r\n            }\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this.getContent = function() {\r\n        if (!this.edDoc.body) {\r\n            return \"\"\r\n        } else {\r\n            if (window.dhx4.isFF) {\r\n                return this.editor.contentWindow.document.body.innerHTML.replace(/<\\/{0,}br\\/{0,}>\\s{0,}$/gi, \"\")\r\n            }\r\n            if (window.dhx4.isIE && this.edDoc.body.innerText.length == 0) {\r\n                return \"\"\r\n            }\r\n            return this.edDoc.body.innerHTML\r\n        }\r\n    }\r\n    ;\r\n    this.setContent = function(n) {\r\n        n = n || \"\";\r\n        if (this.edDoc.body) {\r\n            var m = false;\r\n            if (window.dhx4.isFF) {\r\n                var l = navigator.userAgent.match(/Firefox\\/(\\d*)/);\r\n                m = (l != null  && l[1] < 28)\r\n            }\r\n            if (m) {\r\n                if (typeof (this.conf.ffTest) == \"undefined\") {\r\n                    this.editor.contentWindow.document.body.innerHTML = \"\";\r\n                    this._runCommand(\"InsertHTML\", \"test\");\r\n                    this.conf.ffTest = (this.editor.contentWindow.document.body.innerHTML.length > 0)\r\n                }\r\n                if (this.conf.ffTest) {\r\n                    this.editor.contentWindow.document.body.innerHTML = n\r\n                } else {\r\n                    this.editor.contentWindow.document.body.innerHTML = \"\";\r\n                    if (n.length == 0) {\r\n                        n = \" \"\r\n                    }\r\n                    this._runCommand(\"InsertHTML\", n)\r\n                }\r\n            } else {\r\n                this.editor.contentWindow.document.body.innerHTML = n\r\n            }\r\n            this.callEvent(\"onContentSet\", [])\r\n        } else {\r\n            if (!this.conf.firstLoadEv) {\r\n                this.conf.firstLoadEv = true;\r\n                this.conf.firstLoadData = n;\r\n                this._onFirstLoad = function() {\r\n                    c.setContent(c.conf.firstLoadData);\r\n                    if (typeof (window.addEventListener) == \"function\") {\r\n                        c.edWin.removeEventListener(\"load\", c._onFirstLoad, false)\r\n                    } else {\r\n                        c.edWin.detachEvent(\"onload\", c._onFirstLoad)\r\n                    }\r\n                    c.conf.firstLoadData = null ;\r\n                    c.conf.firstLoadEv = false;\r\n                    c._onFirstLoad = null \r\n                }\r\n                ;\r\n                if (typeof (window.addEventListener) == \"function\") {\r\n                    this.edWin.addEventListener(\"load\", this._onFirstLoad, false)\r\n                } else {\r\n                    this.edWin.attachEvent(\"onload\", this._onFirstLoad)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setContentHTML = function(l) {\r\n        window.dhx4.ajax.get(l, function(m) {\r\n            if (m.xmlDoc.responseText != null ) {\r\n                c.setContent(m.xmlDoc.responseText)\r\n            }\r\n        })\r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    this.attachEvent(\"onFocusChanged\", function(l) {\r\n        if (typeof (this._doOnFocusChanged) == \"function\") {\r\n            this._doOnFocusChanged(l)\r\n        } else {\r\n            if (typeof (this._doOnFocusChanged) == \"string\" && typeof (window[this._doOnFocusChanged]) == \"function\") {\r\n                window[this._doOnFocusChanged](l)\r\n            }\r\n        }\r\n    });\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        window.addEventListener(\"resize\", this._doOnResize, false);\r\n        this.edDoc.addEventListener(\"click\", this._doOnClick, false);\r\n        this.edDoc.addEventListener(\"keyup\", this._doOnKeyUp, false);\r\n        if (window.dhx4.isOpera) {\r\n            this.edDoc.addEventListener(\"mousedown\", this._doOnMouseDown, false)\r\n        }\r\n    } else {\r\n        window.attachEvent(\"onresize\", this._doOnResize);\r\n        this.edDoc.attachEvent(\"onclick\", this._doOnClick);\r\n        this.edDoc.attachEvent(\"onkeyup\", this._doOnKeyUp)\r\n    }\r\n    this.unload = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"resize\", this._doOnResize, false);\r\n            this.edDoc.removeEventListener(\"click\", this._doOnClick, false);\r\n            this.edDoc.removeEventListener(\"keyup\", this._doOnKeyUp, false);\r\n            if (window.dhx4.isOpera) {\r\n                this.edDoc.removeEventListener(\"mousedown\", this._doOnMouseDown, false)\r\n            }\r\n            for (var l = 0; l < c.conf.evs.length; l++) {\r\n                a.contentWindow.removeEventListener(c.conf.evs[l], c._ev, false)\r\n            }\r\n            if (this.tb != null  && this.conf.iOSfix == true) {\r\n                this.tb.cont.removeEventListener(\"touchend\", this._doOnIOSFix, false);\r\n                this._doOnIOSFix = null \r\n            }\r\n        } else {\r\n            window.detachEvent(\"onresize\", this._doOnResize, false);\r\n            this.edDoc.detachEvent(\"onclick\", this._doOnClick);\r\n            this.edDoc.detachEvent(\"onkeyup\", this._doOnKeyUp);\r\n            for (var l = 0; l < c.conf.evs.length; l++) {\r\n                a.contentWindow.document.body.detachEvent(\"on\" + c.conf.evs[l], c._ev)\r\n            }\r\n        }\r\n        this._doOnAccess = null ;\r\n        this._doOnFocusChanged = null ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.editor.onload = null \r\n        } else {\r\n            this.editor.onreadystatechange = null \r\n        }\r\n        this.editor.parentNode.removeChild(this.editor);\r\n        this.editor = null ;\r\n        this.edDoc = null ;\r\n        this.edWin = null ;\r\n        this.cell._unload();\r\n        this.cell = null ;\r\n        this.tb = null ;\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.cBlock.parentNode.removeChild(this.cBlock);\r\n        this.cBlock = null ;\r\n        this.base.className = String(this.base.className).replace(new RegExp(\"\\\\s{0,}dhxeditor_\" + this.conf.skin), \"\");\r\n        while (this.base.childNodes.length > 0) {\r\n            this.base.removeChild(this.base.childNodes[0])\r\n        }\r\n        this.base = null ;\r\n        this._doOnClick = null ;\r\n        this._doOnKeyUp = null ;\r\n        this._doOnMouseDown = null ;\r\n        this._ev = null ;\r\n        this._focus = null ;\r\n        this._prepareContent = null ;\r\n        this._doOnResize = null ;\r\n        this.setIconsPath = null ;\r\n        this.init = null ;\r\n        this.setSizes = null ;\r\n        this._runCommand = null ;\r\n        this.applyBold = null ;\r\n        this.applyItalic = null ;\r\n        this.applyUnderscore = null ;\r\n        this.clearFormatting = null ;\r\n        this._showInfo = null ;\r\n        this._getSelectionBounds = null ;\r\n        this.getContent = null ;\r\n        this.setContent = null ;\r\n        this.setContentHTML = null ;\r\n        this.setReadonly = null ;\r\n        this.isReadonly = null ;\r\n        this.unload = null ;\r\n        c = a = null \r\n    }\r\n    ;\r\n    if (this.conf.toolbar == true && typeof (this.attachToolbar) == \"function\" && typeof (window.dhtmlXToolbarObject) == \"function\") {\r\n        this.attachToolbar(this.conf.iconsPath);\r\n        if (this.conf.iOSfix == true) {\r\n            this._doOnIOSFix = function() {\r\n                c.editor.contentWindow.focus()\r\n            }\r\n            ;\r\n            this.tb.cont.addEventListener(\"touchend\", this._doOnIOSFix, false)\r\n        }\r\n    }\r\n    this.setIconsPath = function(l) {\r\n        this.conf.iconsPath = l\r\n    }\r\n    ;\r\n    if (this.conf.content.length > 0) {\r\n        this.setContent(this.conf.content);\r\n        this.conf.content = \"\"\r\n    } else {\r\n        if (this.conf.contentHTML.length > 0) {\r\n            this.setContentHTML(this.conf.contentHTML);\r\n            this.conf.contentHTML = \"\"\r\n        }\r\n    }\r\n    return this\r\n}\r\ndhtmlXEditor.prototype.setSizes = function() {\r\n    this.cell._setSize(0, 0, this.base.clientWidth, this.base.clientHeight);\r\n    if (this.editor != null ) {\r\n        this.editor.style.left = \"5px\";\r\n        this.editor.style.width = this.base.clientWidth - 5 + \"px\"\r\n    }\r\n}\r\n;\r\ndhtmlXEditor.prototype.setReadonly = function(a) {\r\n    this.conf.roMode = (a === true);\r\n    this._prepareContent(true, this.conf.roMode);\r\n    this.cBlock.style.display = (this.conf.roMode ? \"\" : \"none\")\r\n}\r\n;\r\ndhtmlXEditor.prototype.isReadonly = function(a) {\r\n    return ( this.conf.roMode || false) \r\n}\r\n;\r\ndhtmlXEditor.prototype.setSkin = function(a) {\r\n    this.base.className = String(this.base.className).replace(new RegExp(\"dhxeditor_\" + this.conf.skin), \"dhxeditor_\" + a);\r\n    this.conf.skin = this.cell.conf.skin = a;\r\n    if (this.tb) {\r\n        this.cell.detachToolbar(a);\r\n        this.tb = null ;\r\n        this.attachToolbar()\r\n    }\r\n    this.setSizes()\r\n}\r\n;\r\nwindow.dhtmlXEditorCell = function(e, a) {\r\n    dhtmlXCellObject.apply(this, [e, \"_editor\"]);\r\n    var c = this;\r\n    this.editor = a;\r\n    this.conf.skin = this.editor.conf.skin;\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        this._stbUnload();\r\n        this.editor = null ;\r\n        c = null \r\n    });\r\n    this._stbInit();\r\n    return this\r\n}\r\n;\r\ndhtmlXEditorCell.prototype = new dhtmlXCellObject();\r\ndhtmlXEditorCell.prototype._stbInit = function() {\r\n    var l = this;\r\n    var h = document.createElement(\"DIV\");\r\n    h.className = \"dhx_cell_stb\";\r\n    this.cell.insertBefore(h, this.cell.childNodes[this.conf.idx.cont]);\r\n    h.onselectstart = function(a) {\r\n        a = a || event;\r\n        a.cancelBubble = true;\r\n        if (a.preventDefault) {\r\n            a.preventDefault()\r\n        } else {\r\n            a.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    var g = {\r\n        bold: \"applyBold\",\r\n        italic: \"applyItalic\",\r\n        underline: \"applyUnderscore\",\r\n        clearformat: \"clearFormatting\"\r\n    };\r\n    for (var e in g) {\r\n        var c = document.createElement(\"A\");\r\n        c.href = \"javascript:void(0);\";\r\n        c.tabIndex = -1;\r\n        h.appendChild(c);\r\n        c.onmousedown = c.onclick = function(a) {\r\n            a = a || event;\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            } else {\r\n                a.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        var m = document.createElement(\"DIV\");\r\n        m.className = \"dhx_cell_stb_button btn_\" + e;\r\n        m._actv = e.charAt(0);\r\n        m._cmd = g[e];\r\n        c.appendChild(m);\r\n        m.onclick = function(a) {\r\n            a = a || event;\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            } else {\r\n                a.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        m.onmousedown = function(a) {\r\n            a = a || event;\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            } else {\r\n                a.returnValue = false\r\n            }\r\n            l.editor[this._cmd]();\r\n            l.editor.callEvent(\"onToolbarClick\", [this._actv])\r\n        }\r\n        ;\r\n        m = c = null \r\n    }\r\n    h = null ;\r\n    this._stbUnload = function() {\r\n        var a = this.cell.childNodes[this.conf.idx.stb];\r\n        a.onselectstart = null ;\r\n        while (a.childNodes.length > 0) {\r\n            a.lastChild.onmousedown = a.lastChild.onclick = null ;\r\n            a.lastChild.firstChild.onmousedown = a.lastChild.firstChild.onclick = null ;\r\n            a.lastChild.firstChild._actv = a.lastChild.firstChild._cmd = null ;\r\n            a.lastChild.removeChild(a.lastChild.firstChild);\r\n            a.removeChild(a.lastChild)\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        a = l = null ;\r\n        this.conf.idx_data.stb = this.conf.ofs_nodes.t._getStbHeight = null ;\r\n        delete this.conf.ofs_nodes.t._getStbHeight;\r\n        delete this.conf.idx_data.stb;\r\n        this._updateIdx()\r\n    }\r\n    ;\r\n    this.conf.ofs_nodes.t._getStbHeight = \"func\";\r\n    this.conf.idx_data.stb = \"dhx_cell_stb\";\r\n    this._updateIdx()\r\n}\r\n;\r\ndhtmlXEditorCell.prototype._stbHide = function() {\r\n    this.cell.childNodes[this.conf.idx.stb].style.display = \"none\"\r\n}\r\n;\r\ndhtmlXEditorCell.prototype._getStbHeight = function() {\r\n    return this.cell.childNodes[this.conf.idx.stb].offsetHeight\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachEditor = function(a) {\r\n    this.callEvent(\"_onBeforeContentAttach\", [\"editor\"]);\r\n    var e = document.createElement(\"DIV\");\r\n    e.style.width = \"100%\";\r\n    e.style.height = \"100%\";\r\n    e.style.position = \"relative\";\r\n    e.style.overflow = \"hidden\";\r\n    this._attachObject(e);\r\n    if (!(typeof (a) == \"object\" && a != null )) {\r\n        a = {}\r\n    }\r\n    a.parent = e;\r\n    this.dataType = \"editor\";\r\n    this.dataObj = new dhtmlXEditor(a);\r\n    e = null ;\r\n    a.parent = null ;\r\n    a = null ;\r\n    if (typeof (window.dhtmlXPortalCell) == \"function\" && this instanceof window.dhtmlXPortalCell) {\r\n        if (this.portal.conf.editor_ev == null ) {\r\n            var g = this.portal.attachEvent(\"onBeforeDrag\", function(h) {\r\n                if (this.cdata[h].dataType == \"editor\") {\r\n                    this.cdata[h].conf.editor_cont = this.cdata[h].dataObj.getContent()\r\n                }\r\n                return true\r\n            });\r\n            var c = this.portal.attachEvent(\"onDrop\", function(h) {\r\n                if (this.cdata[h].dataType == \"editor\") {\r\n                    this.cdata[h].dataObj.setContent(this.cdata[h].conf.editor_cont);\r\n                    this.cdata[h].dataObj._prepareContent(true);\r\n                    this.cdata[h].conf.editor_cont = null \r\n                }\r\n            });\r\n            this.portal.conf.editor_ev = [g, c]\r\n        }\r\n        this.conf.editor_ev = this.attachEvent(\"_onBeforeContentDetach\", function() {\r\n            this.detachEvent(this.conf.editor_ev);\r\n            this.conf.editor_ev = null ;\r\n            if (this instanceof window.dhtmlXPortalCell) {\r\n                var l = false;\r\n                for (var h in this.portal.cdata) {\r\n                    if (this.portal.cdata[h] != this && this.portal.cdata[h].dataType == \"editor\") {\r\n                        l = true\r\n                    }\r\n                }\r\n                if (l == false) {\r\n                    for (var m = 0; m < this.portal.conf.editor_ev.length; m++) {\r\n                        this.portal.detachEvent(this.portal.conf.editor_ev[m])\r\n                    }\r\n                    this.portal.conf.editor_ev = null \r\n                }\r\n            }\r\n        })\r\n    }\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\ndhtmlXEditor.prototype.attachToolbar = function(c) {\r\n    if (this.tb != null ) {\r\n        return\r\n    }\r\n    if (c != null ) {\r\n        this.conf.iconsPath = c\r\n    }\r\n    this.cell._stbHide();\r\n    this.tb = this.cell.attachToolbar({\r\n        icons_path: this.conf.iconsPath + \"/dhxeditor_\" + String(this.conf.skin).replace(/^dhx_/, \"\") + \"/\",\r\n        skin: this.conf.skin\r\n    });\r\n    this.setSizes();\r\n    this._availFonts = new Array(\"Arial\",\"Arial Narrow\",\"Comic Sans MS\",\"Courier\",\"Georgia\",\"Impact\",\"Tahoma\",\"Times New Roman\",\"Verdana\");\r\n    this._initFont = this._availFonts[0];\r\n    this._xmlFonts = \"\";\r\n    for (var l = 0; l < this._availFonts.length; l++) {\r\n        var g = String(this._availFonts[l]).replace(/\\s/g, \"_\");\r\n        this._xmlFonts += '<item type=\"button\" id=\"applyFontFamily:' + g + '\"><itemText><![CDATA[<img src=\"' + this.tb.imagePath + \"font_\" + String(g).toLowerCase() + '.gif\" border=\"0\" style=\"/*margin-top:1px;margin-bottom:1px;*/width:110px;height:16px;\">]]></itemText></item>'\r\n    }\r\n    this._availSizes = {\r\n        \"1\": \"8pt\",\r\n        \"2\": \"10pt\",\r\n        \"3\": \"12pt\",\r\n        \"4\": \"14pt\",\r\n        \"5\": \"18pt\",\r\n        \"6\": \"24pt\",\r\n        \"7\": \"36pt\"\r\n    };\r\n    this._xmlSizes = \"\";\r\n    for (var e in this._availSizes) {\r\n        this._xmlSizes += '<item type=\"button\" id=\"applyFontSize:' + e + \":\" + this._availSizes[e] + '\" text=\"' + this._availSizes[e] + '\"/>'\r\n    }\r\n    this.tbXML = '<toolbar><item id=\"applyH1\" type=\"buttonTwoState\" img=\"h1.gif\" imgdis=\"h4_dis.gif\" title=\"H1\"/><item id=\"applyH2\" type=\"buttonTwoState\" img=\"h2.gif\" imgdis=\"h4_dis.gif\" title=\"H2\"/><item id=\"applyH3\" type=\"buttonTwoState\" img=\"h3.gif\" imgdis=\"h4_dis.gif\" title=\"H3\"/><item id=\"applyH4\" type=\"buttonTwoState\" img=\"h4.gif\" imgdis=\"h4_dis.gif\" title=\"H4\"/><item id=\"separ01\" type=\"separator\"/><item id=\"applyBold\" type=\"buttonTwoState\" img=\"bold.gif\" imgdis=\"bold_dis.gif\" title=\"Bold Text\"/><item id=\"applyItalic\" type=\"buttonTwoState\" img=\"italic.gif\" imgdis=\"italic_dis.gif\" title=\"Italic Text\"/><item id=\"applyUnderscore\" type=\"buttonTwoState\" img=\"underline.gif\" imgdis=\"underline_dis.gif\" title=\"Underscore Text\"/><item id=\"applyStrikethrough\" type=\"buttonTwoState\" img=\"strike.gif\" imgdis=\"strike_dis.gif\" title=\"Strikethrough Text\"/><item id=\"separ02\" type=\"separator\"/><item id=\"alignLeft\" type=\"buttonTwoState\" img=\"align_left.gif\" imgdis=\"align_left_dis.gif\" title=\"Left Alignment\"/><item id=\"alignCenter\" type=\"buttonTwoState\" img=\"align_center.gif\" imgdis=\"align_center_dis.gif\" title=\"Center Alignment\"/><item id=\"alignRight\" type=\"buttonTwoState\" img=\"align_right.gif\" imgdis=\"align_right_dis.gif\" title=\"Right Alignment\"/><item id=\"alignJustify\" type=\"buttonTwoState\" img=\"align_justify.gif\" title=\"Justified Alignment\"/><item id=\"separ03\" type=\"separator\"/><item id=\"applySub\" type=\"buttonTwoState\" img=\"script_sub.gif\" imgdis=\"script_sub.gif\" title=\"Subscript\"/><item id=\"applySuper\" type=\"buttonTwoState\" img=\"script_super.gif\" imgdis=\"script_super_dis.gif\" title=\"Superscript\"/><item id=\"separ04\" type=\"separator\"/><item id=\"createNumList\" type=\"button\" img=\"list_number.gif\" imgdis=\"list_number_dis.gif\" title=\"Number List\"/><item id=\"createBulList\" type=\"button\" img=\"list_bullet.gif\" imgdis=\"list_bullet_dis.gif\" title=\"Bullet List\"/><item id=\"separ05\" type=\"separator\"/><item id=\"increaseIndent\" type=\"button\" img=\"indent_inc.gif\" imgdis=\"indent_inc_dis.gif\" title=\"Increase Indent\"/><item id=\"decreaseIndent\" type=\"button\" img=\"indent_dec.gif\" imgdis=\"indent_dec_dis.gif\" title=\"Decrease Indent\"/><item id=\"separ06\" type=\"separator\"/><item id=\"clearFormatting\" type=\"button\" img=\"clear.gif\" title=\"Clear Formatting\"/></toolbar>';\r\n    this.tb.loadStruct(this.tbXML);\r\n    this._checkAlign = function(a) {\r\n        this.tb.setItemState(\"alignCenter\", false);\r\n        this.tb.setItemState(\"alignRight\", false);\r\n        this.tb.setItemState(\"alignJustify\", false);\r\n        this.tb.setItemState(\"alignLeft\", false);\r\n        if (a) {\r\n            this.tb.setItemState(a, true)\r\n        }\r\n    }\r\n    ;\r\n    this._checkH = function(a) {\r\n        this.tb.setItemState(\"applyH1\", false);\r\n        this.tb.setItemState(\"applyH2\", false);\r\n        this.tb.setItemState(\"applyH3\", false);\r\n        this.tb.setItemState(\"applyH4\", false);\r\n        if (a) {\r\n            this.tb.setItemState(a, true)\r\n        }\r\n    }\r\n    ;\r\n    this._doOnFocusChanged = function(n) {\r\n        if (!n.h1 && !n.h2 && !n.h3 && !n.h4) {\r\n            var a = (String(n.fontWeight).search(/bold/i) != -1) || (Number(n.fontWeight) >= 700);\r\n            this.tb.setItemState(\"applyBold\", a)\r\n        } else {\r\n            this.tb.setItemState(\"applyBold\", false)\r\n        }\r\n        var m = \"alignLeft\";\r\n        if (String(n.textAlign).search(/center/) != -1) {\r\n            m = \"alignCenter\"\r\n        }\r\n        if (String(n.textAlign).search(/right/) != -1) {\r\n            m = \"alignRight\"\r\n        }\r\n        if (String(n.textAlign).search(/justify/) != -1) {\r\n            m = \"alignJustify\"\r\n        }\r\n        this.tb.setItemState(m, true);\r\n        this._checkAlign(m);\r\n        this.tb.setItemState(\"applyH1\", n.h1);\r\n        this.tb.setItemState(\"applyH2\", n.h2);\r\n        this.tb.setItemState(\"applyH3\", n.h3);\r\n        this.tb.setItemState(\"applyH4\", n.h4);\r\n        if (window._KHTMLrv) {\r\n            n.sub = (n.vAlign == \"sub\");\r\n            n.sup = (n.vAlign == \"super\")\r\n        }\r\n        this.tb.setItemState(\"applyItalic\", (n.fontStyle == \"italic\"));\r\n        this.tb.setItemState(\"applyStrikethrough\", n.del);\r\n        this.tb.setItemState(\"applySub\", n.sub);\r\n        this.tb.setItemState(\"applySuper\", n.sup);\r\n        this.tb.setItemState(\"applyUnderscore\", n.u)\r\n    }\r\n    ;\r\n    this._doOnToolbarClick = function(m) {\r\n        var a = String(m).split(\":\");\r\n        if (this[a[0]] != null ) {\r\n            if (typeof (this[a[0]]) == \"function\") {\r\n                this[a[0]](a[1]);\r\n                this.callEvent(\"onToolbarClick\", [m])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._doOnStateChange = function(m, a) {\r\n        this[m]();\r\n        switch (m) {\r\n        case \"alignLeft\":\r\n        case \"alignCenter\":\r\n        case \"alignRight\":\r\n        case \"alignJustify\":\r\n            this._checkAlign(m);\r\n            break;\r\n        case \"applyH1\":\r\n        case \"applyH2\":\r\n        case \"applyH3\":\r\n        case \"applyH4\":\r\n            this._checkH(m);\r\n            break\r\n        }\r\n        this.callEvent(\"onToolbarClick\", [m])\r\n    }\r\n    ;\r\n    this._doOnBeforeStateChange = function(m, a) {\r\n        if ((m == \"alignLeft\" || m == \"alignCenter\" || m == \"alignRight\" || m == \"alignJustify\") && a == true) {\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    var h = this;\r\n    this.tb.attachEvent(\"onClick\", function(a) {\r\n        h._doOnToolbarClick(a)\r\n    });\r\n    this.tb.attachEvent(\"onStateChange\", function(m, a) {\r\n        h._doOnStateChange(m, a)\r\n    });\r\n    this.tb.attachEvent(\"onBeforeStateChange\", function(m, a) {\r\n        return h._doOnBeforeStateChange(m, a)\r\n    });\r\n    this.applyBold = function() {\r\n        this._runCommand(\"Bold\")\r\n    }\r\n    ;\r\n    this.applyItalic = function() {\r\n        this._runCommand(\"Italic\")\r\n    }\r\n    ;\r\n    this.applyUnderscore = function() {\r\n        this._runCommand(\"Underline\")\r\n    }\r\n    ;\r\n    this.applyStrikethrough = function() {\r\n        this._runCommand(\"StrikeThrough\")\r\n    }\r\n    ;\r\n    this.alignLeft = function() {\r\n        this._runCommand(\"JustifyLeft\")\r\n    }\r\n    ;\r\n    this.alignRight = function() {\r\n        this._runCommand(\"JustifyRight\")\r\n    }\r\n    ;\r\n    this.alignCenter = function() {\r\n        this._runCommand(\"JustifyCenter\")\r\n    }\r\n    ;\r\n    this.alignJustify = function() {\r\n        this._runCommand(\"JustifyFull\")\r\n    }\r\n    ;\r\n    this.applySub = function() {\r\n        this._runCommand(\"Subscript\")\r\n    }\r\n    ;\r\n    this.applySuper = function() {\r\n        this._runCommand(\"Superscript\")\r\n    }\r\n    ;\r\n    this.applyH1 = function() {\r\n        this._runCommand(\"FormatBlock\", \"<H1>\")\r\n    }\r\n    ;\r\n    this.applyH2 = function() {\r\n        this._runCommand(\"FormatBlock\", \"<H2>\")\r\n    }\r\n    ;\r\n    this.applyH3 = function() {\r\n        this._runCommand(\"FormatBlock\", \"<H3>\")\r\n    }\r\n    ;\r\n    this.applyH4 = function() {\r\n        this._runCommand(\"FormatBlock\", \"<H4>\")\r\n    }\r\n    ;\r\n    this.createNumList = function() {\r\n        this._runCommand(\"InsertOrderedList\")\r\n    }\r\n    ;\r\n    this.createBulList = function() {\r\n        this._runCommand(\"InsertUnorderedList\")\r\n    }\r\n    ;\r\n    this.increaseIndent = function() {\r\n        this._runCommand(\"Indent\")\r\n    }\r\n    ;\r\n    this.decreaseIndent = function() {\r\n        this._runCommand(\"Outdent\")\r\n    }\r\n    ;\r\n    this.clearFormatting = function() {\r\n        this._runCommand(\"RemoveFormat\");\r\n        this.tb.setItemState(\"applyBold\", false);\r\n        this.tb.setItemState(\"applyItalic\", false);\r\n        this.tb.setItemState(\"applyStrikethrough\", false);\r\n        this.tb.setItemState(\"applySub\", false);\r\n        this.tb.setItemState(\"applySuper\", false);\r\n        this.tb.setItemState(\"applyUnderscore\", false);\r\n        var a = this.getContent();\r\n        a = a.replace(/<\\/?h\\d>/gi, \"\");\r\n        this.setContent(a)\r\n    }\r\n}\r\n;\r\ndhtmlx.Group = {\r\n    _init: function() {\r\n        dhtmlx.assert(this.data, \"DataStore required for grouping\");\r\n        this.data.attachEvent(\"onStoreLoad\", dhtmlx.bind(function() {\r\n            if (this._settings.group) {\r\n                this.group(this._settings.group, false)\r\n            }\r\n        }, this));\r\n        this.attachEvent(\"onBeforeRender\", dhtmlx.bind(function(a) {\r\n            if (this._settings.sort) {\r\n                a.block();\r\n                a.sort(this._settings.sort);\r\n                a.unblock()\r\n            }\r\n        }, this));\r\n        this.data.attachEvent(\"onClearAll\", dhtmlx.bind(function() {\r\n            this.data._not_grouped_order = this.data._not_grouped_pull = null \r\n        }, this));\r\n        this.attachEvent(\"onBeforeSort\", dhtmlx.bind(function() {\r\n            this._settings.sort = null \r\n        }, this))\r\n    },\r\n    _init_group_data_event: function(c, a) {\r\n        c.attachEvent(\"onClearAll\", dhtmlx.bind(function() {\r\n            this.ungroup(false);\r\n            this.block();\r\n            this.clearAll();\r\n            this.unblock()\r\n        }, a))\r\n    },\r\n    sum: function(c, a) {\r\n        c = dhtmlx.Template.setter(c);\r\n        a = a || this.data;\r\n        var e = 0;\r\n        a.each(function(g) {\r\n            e += c(g) * 1\r\n        });\r\n        return e\r\n    },\r\n    min: function(e, c) {\r\n        e = dhtmlx.Template.setter(e);\r\n        c = c || this.data;\r\n        var a = Infinity;\r\n        c.each(function(g) {\r\n            if (e(g) * 1 < a) {\r\n                a = e(g) * 1\r\n            }\r\n        });\r\n        return a * 1\r\n    },\r\n    max: function(e, c) {\r\n        e = dhtmlx.Template.setter(e);\r\n        c = c || this.data;\r\n        var a = -Infinity;\r\n        c.each(function(g) {\r\n            if (e(g) * 1 > a) {\r\n                a = e(g) * 1\r\n            }\r\n        });\r\n        return a\r\n    },\r\n    _split_data_by: function(l) {\r\n        var n = function(s, r) {\r\n            s = dhtmlx.Template.setter(s);\r\n            return s(r[0])\r\n        }\r\n        ;\r\n        var o = dhtmlx.Template.setter(l.by);\r\n        if (!l.map[o]) {\r\n            l.map[o] = [o, n]\r\n        }\r\n        var e = {};\r\n        var m = [];\r\n        this.data.each(function(r) {\r\n            var s = o(r);\r\n            if (!e[s]) {\r\n                m.push({\r\n                    id: s\r\n                });\r\n                e[s] = dhtmlx.toArray()\r\n            }\r\n            e[s].push(r)\r\n        });\r\n        for (var a in l.map) {\r\n            var h = (l.map[a][1] || n);\r\n            if (typeof h != \"function\") {\r\n                h = this[h]\r\n            }\r\n            for (var g = 0; g < m.length; g++) {\r\n                m[g][a] = h.call(this, l.map[a][0], e[m[g].id])\r\n            }\r\n        }\r\n        this.data._not_grouped_order = this.data.order;\r\n        this.data._not_grouped_pull = this.data.pull;\r\n        this.data.order = dhtmlx.toArray();\r\n        this.data.pull = {};\r\n        for (var g = 0; g < m.length; g++) {\r\n            var c = this.data.id(m[g]);\r\n            this.data.pull[c] = m[g];\r\n            this.data.order.push(c)\r\n        }\r\n        this.callEvent(\"onStoreUpdated\", [])\r\n    },\r\n    group: function(a, c) {\r\n        this.ungroup(false);\r\n        this._split_data_by(a);\r\n        if (c !== false) {\r\n            this.data.callEvent(\"onStoreUpdated\", [])\r\n        }\r\n    },\r\n    ungroup: function(a) {\r\n        if (this.data._not_grouped_order) {\r\n            this.data.order = this.data._not_grouped_order;\r\n            this.data.pull = this.data._not_grouped_pull;\r\n            this.data._not_grouped_pull = this.data._not_grouped_order = null \r\n        }\r\n        if (a !== false) {\r\n            this.data.callEvent(\"onStoreUpdated\", [])\r\n        }\r\n    },\r\n    group_setter: function(a) {\r\n        dhtmlx.assert(typeof a == \"object\", \"Incorrect group value\");\r\n        dhtmlx.assert(a.by, \"group.by is mandatory\");\r\n        dhtmlx.assert(a.map, \"group.map is mandatory\");\r\n        return a\r\n    },\r\n    sort_setter: function(a) {\r\n        if (typeof a != \"object\") {\r\n            a = {\r\n                by: a\r\n            }\r\n        }\r\n        this._mergeSettings(a, {\r\n            as: \"string\",\r\n            dir: \"asc\"\r\n        });\r\n        return a\r\n    }\r\n};\r\ndhtmlx.Date = {\r\n    Locale: {\r\n        month_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n        month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n        day_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n        day_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\r\n    },\r\n    date_part: function(a) {\r\n        a.setHours(0);\r\n        a.setMinutes(0);\r\n        a.setSeconds(0);\r\n        a.setMilliseconds(0);\r\n        return a\r\n    },\r\n    time_part: function(a) {\r\n        return (a.valueOf() / 1000 - a.getTimezoneOffset() * 60) % 86400\r\n    },\r\n    week_start: function(c) {\r\n        var a = c.getDay();\r\n        if (this.config.start_on_monday) {\r\n            if (a === 0) {\r\n                a = 6\r\n            } else {\r\n                a--\r\n            }\r\n        }\r\n        return this.date_part(this.add(c, -1 * a, \"day\"))\r\n    },\r\n    month_start: function(a) {\r\n        a.setDate(1);\r\n        return this.date_part(a)\r\n    },\r\n    year_start: function(a) {\r\n        a.setMonth(0);\r\n        return this.month_start(a)\r\n    },\r\n    day_start: function(a) {\r\n        return this.date_part(a)\r\n    },\r\n    add: function(c, e, g) {\r\n        var a = new Date(c.valueOf());\r\n        switch (g) {\r\n        case \"day\":\r\n            a.setDate(a.getDate() + e);\r\n            break;\r\n        case \"week\":\r\n            a.setDate(a.getDate() + 7 * e);\r\n            break;\r\n        case \"month\":\r\n            a.setMonth(a.getMonth() + e);\r\n            break;\r\n        case \"year\":\r\n            a.setYear(a.getFullYear() + e);\r\n            break;\r\n        case \"hour\":\r\n            a.setHours(a.getHours() + e);\r\n            break;\r\n        case \"minute\":\r\n            a.setMinutes(a.getMinutes() + e);\r\n            break;\r\n        default:\r\n            return dhtmlx.Date[\"add_\" + g](c, e, g)\r\n        }\r\n        return a\r\n    },\r\n    to_fixed: function(a) {\r\n        if (a < 10) {\r\n            return \"0\" + a\r\n        }\r\n        return a\r\n    },\r\n    copy: function(a) {\r\n        return new Date(a.valueOf())\r\n    },\r\n    date_to_str: function(c, a) {\r\n        c = c.replace(/%[a-zA-Z]/g, function(e) {\r\n            switch (e) {\r\n            case \"%d\":\r\n                return '\"+dhtmlx.Date.to_fixed(date.getDate())+\"';\r\n            case \"%m\":\r\n                return '\"+dhtmlx.Date.to_fixed((date.getMonth()+1))+\"';\r\n            case \"%j\":\r\n                return '\"+date.getDate()+\"';\r\n            case \"%n\":\r\n                return '\"+(date.getMonth()+1)+\"';\r\n            case \"%y\":\r\n                return '\"+dhtmlx.Date.to_fixed(date.getFullYear()%100)+\"';\r\n            case \"%Y\":\r\n                return '\"+date.getFullYear()+\"';\r\n            case \"%D\":\r\n                return '\"+dhtmlx.Date.Locale.day_short[date.getDay()]+\"';\r\n            case \"%l\":\r\n                return '\"+dhtmlx.Date.Locale.day_full[date.getDay()]+\"';\r\n            case \"%M\":\r\n                return '\"+dhtmlx.Date.Locale.month_short[date.getMonth()]+\"';\r\n            case \"%F\":\r\n                return '\"+dhtmlx.Date.Locale.month_full[date.getMonth()]+\"';\r\n            case \"%h\":\r\n                return '\"+dhtmlx.Date.to_fixed((date.getHours()+11)%12+1)+\"';\r\n            case \"%g\":\r\n                return '\"+((date.getHours()+11)%12+1)+\"';\r\n            case \"%G\":\r\n                return '\"+date.getHours()+\"';\r\n            case \"%H\":\r\n                return '\"+dhtmlx.Date.to_fixed(date.getHours())+\"';\r\n            case \"%i\":\r\n                return '\"+dhtmlx.Date.to_fixed(date.getMinutes())+\"';\r\n            case \"%a\":\r\n                return '\"+(date.getHours()>11?\"pm\":\"am\")+\"';\r\n            case \"%A\":\r\n                return '\"+(date.getHours()>11?\"PM\":\"AM\")+\"';\r\n            case \"%s\":\r\n                return '\"+dhtmlx.Date.to_fixed(date.getSeconds())+\"';\r\n            case \"%W\":\r\n                return '\"+dhtmlx.Date.to_fixed(dhtmlx.Date.getISOWeek(date))+\"';\r\n            default:\r\n                return e\r\n            }\r\n        });\r\n        if (a) {\r\n            c = c.replace(/date\\.get/g, \"date.getUTC\")\r\n        }\r\n        return new Function(\"date\",'return \"' + c + '\";')\r\n    },\r\n    str_to_date: function(h, e) {\r\n        var l = \"var temp=date.split(/[^0-9a-zA-Z]+/g);\";\r\n        var a = h.match(/%[a-zA-Z]/g);\r\n        for (var c = 0; c < a.length; c++) {\r\n            switch (a[c]) {\r\n            case \"%j\":\r\n            case \"%d\":\r\n                l += \"set[2]=temp[\" + c + \"]||1;\";\r\n                break;\r\n            case \"%n\":\r\n            case \"%m\":\r\n                l += \"set[1]=(temp[\" + c + \"]||1)-1;\";\r\n                break;\r\n            case \"%y\":\r\n                l += \"set[0]=temp[\" + c + \"]*1+(temp[\" + c + \"]>50?1900:2000);\";\r\n                break;\r\n            case \"%g\":\r\n            case \"%G\":\r\n            case \"%h\":\r\n            case \"%H\":\r\n                l += \"set[3]=temp[\" + c + \"]||0;\";\r\n                break;\r\n            case \"%i\":\r\n                l += \"set[4]=temp[\" + c + \"]||0;\";\r\n                break;\r\n            case \"%Y\":\r\n                l += \"set[0]=temp[\" + c + \"]||0;\";\r\n                break;\r\n            case \"%a\":\r\n            case \"%A\":\r\n                l += \"set[3]=set[3]%12+((temp[\" + c + \"]||'').toLowerCase()=='am'?0:12);\";\r\n                break;\r\n            case \"%s\":\r\n                l += \"set[5]=temp[\" + c + \"]||0;\";\r\n                break\r\n            }\r\n        }\r\n        var g = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\r\n        if (e) {\r\n            g = \" Date.UTC(\" + g + \")\"\r\n        }\r\n        return new Function(\"date\",\"var set=[0,0,1,0,0,0]; \" + l + \" return new Date(\" + g + \");\")\r\n    },\r\n    getISOWeek: function(e) {\r\n        if (!e) {\r\n            return false\r\n        }\r\n        var c = e.getDay();\r\n        if (c === 0) {\r\n            c = 7\r\n        }\r\n        var g = new Date(e.valueOf());\r\n        g.setDate(e.getDate() + (4 - c));\r\n        var a = g.getFullYear();\r\n        var l = Math.floor((g.getTime() - new Date(a,0,1).getTime()) / 86400000);\r\n        var h = 1 + Math.floor(l / 7);\r\n        return h\r\n    },\r\n    getUTCISOWeek: function(a) {\r\n        return this.getISOWeek(a)\r\n    }\r\n};\r\ndhtmlx.math = {};\r\ndhtmlx.math._toHex = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\"];\r\ndhtmlx.math.toHex = function(c, a) {\r\n    c = parseInt(c, 10);\r\n    str = \"\";\r\n    while (c > 0) {\r\n        str = this._toHex[c % 16] + str;\r\n        c = Math.floor(c / 16)\r\n    }\r\n    while (str.length < a) {\r\n        str = \"0\" + str\r\n    }\r\n    return str\r\n}\r\n;\r\ndhtmlx.math.hexToDec = function(a) {\r\n    return parseInt(a, 16)\r\n}\r\n;\r\ndhtmlx.math.toRgb = function(c) {\r\n    var h, e, a, l;\r\n    if (typeof (c) != \"string\") {\r\n        h = c[0];\r\n        e = c[1];\r\n        a = c[2]\r\n    } else {\r\n        if (c.indexOf(\"rgb\") != -1) {\r\n            l = c.substr(c.indexOf(\"(\") + 1, c.lastIndexOf(\")\") - c.indexOf(\"(\") - 1).split(\",\");\r\n            h = l[0];\r\n            e = l[1];\r\n            a = l[2]\r\n        } else {\r\n            if (c.substr(0, 1) == \"#\") {\r\n                c = c.substr(1)\r\n            }\r\n            h = this.hexToDec(c.substr(0, 2));\r\n            e = this.hexToDec(c.substr(2, 2));\r\n            a = this.hexToDec(c.substr(4, 2))\r\n        }\r\n    }\r\n    h = (parseInt(h, 10) || 0);\r\n    e = (parseInt(e, 10) || 0);\r\n    a = (parseInt(a, 10) || 0);\r\n    if (h < 0 || h > 255) {\r\n        h = 0\r\n    }\r\n    if (e < 0 || e > 255) {\r\n        e = 0\r\n    }\r\n    if (a < 0 || a > 255) {\r\n        a = 0\r\n    }\r\n    return [h, e, a]\r\n}\r\n;\r\ndhtmlx.math.hsvToRgb = function(m, y, w) {\r\n    var l, o, e, c, x, a, n, u;\r\n    l = Math.floor((m / 60)) % 6;\r\n    o = m / 60 - l;\r\n    e = w * (1 - y);\r\n    c = w * (1 - o * y);\r\n    x = w * (1 - (1 - o) * y);\r\n    a = 0;\r\n    n = 0;\r\n    u = 0;\r\n    switch (l) {\r\n    case 0:\r\n        a = w;\r\n        n = x;\r\n        u = e;\r\n        break;\r\n    case 1:\r\n        a = c;\r\n        n = w;\r\n        u = e;\r\n        break;\r\n    case 2:\r\n        a = e;\r\n        n = w;\r\n        u = x;\r\n        break;\r\n    case 3:\r\n        a = e;\r\n        n = c;\r\n        u = w;\r\n        break;\r\n    case 4:\r\n        a = x;\r\n        n = e;\r\n        u = w;\r\n        break;\r\n    case 5:\r\n        a = w;\r\n        n = e;\r\n        u = c;\r\n        break\r\n    }\r\n    a = Math.floor(a * 255);\r\n    n = Math.floor(n * 255);\r\n    u = Math.floor(u * 255);\r\n    return [a, n, u]\r\n}\r\n;\r\ndhtmlx.math.rgbToHsv = function(c, n, o) {\r\n    var l, e, u, a, w, y, m, x;\r\n    l = c / 255;\r\n    e = n / 255;\r\n    u = o / 255;\r\n    var a = Math.min(l, e, u);\r\n    var w = Math.max(l, e, u);\r\n    m = 0;\r\n    y = w == 0 ? 0 : (1 - a / w);\r\n    x = w;\r\n    if (w == a) {\r\n        m = 0\r\n    } else {\r\n        if (w == l && e >= u) {\r\n            m = 60 * (e - u) / (w - a) + 0\r\n        } else {\r\n            if (w == l && e < u) {\r\n                m = 60 * (e - u) / (w - a) + 360\r\n            } else {\r\n                if (w == e) {\r\n                    m = 60 * (u - l) / (w - a) + 120\r\n                } else {\r\n                    if (w == u) {\r\n                        m = 60 * (l - e) / (w - a) + 240\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return [m, y, x]\r\n}\r\n;\r\nif (!dhtmlx.presets) {\r\n    dhtmlx.presets = {}\r\n}\r\ndhtmlx.presets.chart = {\r\n    simple: {\r\n        item: {\r\n            borderColor: \"#ffffff\",\r\n            color: \"#2b7100\",\r\n            shadow: false,\r\n            borderWidth: 2\r\n        },\r\n        line: {\r\n            color: \"#8ecf03\",\r\n            width: 2\r\n        }\r\n    },\r\n    plot: {\r\n        color: \"#1293f8\",\r\n        item: {\r\n            borderColor: \"#636363\",\r\n            borderWidth: 1,\r\n            color: \"#ffffff\",\r\n            type: \"r\",\r\n            shadow: false\r\n        },\r\n        line: {\r\n            color: \"#1293f8\",\r\n            width: 2\r\n        }\r\n    },\r\n    diamond: {\r\n        color: \"#b64040\",\r\n        item: {\r\n            borderColor: \"#b64040\",\r\n            color: \"#b64040\",\r\n            type: \"d\",\r\n            radius: 3,\r\n            shadow: true\r\n        },\r\n        line: {\r\n            color: \"#ff9000\",\r\n            width: 2\r\n        }\r\n    },\r\n    point: {\r\n        color: \"#fe5916\",\r\n        disableLines: true,\r\n        fill: false,\r\n        disableItems: false,\r\n        item: {\r\n            color: \"#feb916\",\r\n            borderColor: \"#fe5916\",\r\n            radius: 2,\r\n            borderWidth: 1,\r\n            type: \"r\"\r\n        },\r\n        alpha: 1\r\n    },\r\n    line: {\r\n        line: {\r\n            color: \"#3399ff\",\r\n            width: 2\r\n        },\r\n        item: {\r\n            color: \"#ffffff\",\r\n            borderColor: \"#3399ff\",\r\n            radius: 2,\r\n            borderWidth: 2,\r\n            type: \"d\"\r\n        },\r\n        fill: false,\r\n        disableItems: false,\r\n        disableLines: false,\r\n        alpha: 1\r\n    },\r\n    area: {\r\n        fill: \"#3399ff\",\r\n        line: {\r\n            color: \"#3399ff\",\r\n            width: 1\r\n        },\r\n        disableItems: true,\r\n        alpha: 0.2,\r\n        disableLines: false\r\n    },\r\n    round: {\r\n        item: {\r\n            radius: 3,\r\n            borderColor: \"#3f83ff\",\r\n            borderWidth: 1,\r\n            color: \"#3f83ff\",\r\n            type: \"r\",\r\n            shadow: false,\r\n            alpha: 0.6\r\n        }\r\n    },\r\n    square: {\r\n        item: {\r\n            radius: 3,\r\n            borderColor: \"#447900\",\r\n            borderWidth: 2,\r\n            color: \"#69ba00\",\r\n            type: \"s\",\r\n            shadow: false,\r\n            alpha: 1\r\n        }\r\n    },\r\n    column: {\r\n        color: \"RAINBOW\",\r\n        gradient: false,\r\n        width: 45,\r\n        radius: 0,\r\n        alpha: 1,\r\n        border: true\r\n    },\r\n    stick: {\r\n        width: 5,\r\n        gradient: false,\r\n        color: \"#67b5c9\",\r\n        radius: 2,\r\n        alpha: 1,\r\n        border: false\r\n    },\r\n    alpha: {\r\n        color: \"#b9a8f9\",\r\n        width: 70,\r\n        gradient: \"falling\",\r\n        radius: 0,\r\n        alpha: 0.5,\r\n        border: true\r\n    }\r\n};\r\ndhtmlx.ui.Map = function(a) {\r\n    this.name = \"Map\";\r\n    this._id = \"map_\" + dhtmlx.uid();\r\n    this._key = a;\r\n    this._map = [];\r\n    this._areas = []\r\n}\r\n;\r\ndhtmlx.ui.Map.prototype = {\r\n    addRect: function(e, c, a) {\r\n        this._areas.push({\r\n            index: a,\r\n            points: c\r\n        });\r\n        this._createMapArea(e, \"RECT\", c, a)\r\n    },\r\n    addPoly: function(e, c, a) {\r\n        this._createMapArea(e, \"POLY\", c, a)\r\n    },\r\n    _createMapArea: function(h, c, g, e) {\r\n        var a = \"\";\r\n        if (arguments.length == 4) {\r\n            a = \"userdata='\" + e + \"'\"\r\n        }\r\n        this._map.push(\"<area \" + this._key + \"='\" + h + \"' shape='\" + c + \"' coords='\" + g.join() + \"' \" + a + \"></area>\")\r\n    },\r\n    addSector: function(a, r, o, m, h, e, g, l) {\r\n        var n = [];\r\n        n.push(m);\r\n        n.push(Math.floor(h * g));\r\n        for (var c = r; c < o; c += Math.PI / 18) {\r\n            n.push(Math.floor(m + e * Math.cos(c)));\r\n            n.push(Math.floor((h + e * Math.sin(c)) * g))\r\n        }\r\n        n.push(Math.floor(m + e * Math.cos(o)));\r\n        n.push(Math.floor((h + e * Math.sin(o)) * g));\r\n        n.push(m);\r\n        n.push(Math.floor(h * g));\r\n        return this.addPoly(a, n, l)\r\n    },\r\n    render: function(a) {\r\n        var e = dhtmlx.html.create(\"DIV\");\r\n        e.style.cssText = \"position:absolute; width:100%; height:100%; top:0px; left:0px;\";\r\n        a.appendChild(e);\r\n        var c = dhtmlx._isIE ? \"\" : \"src='data:image/gif;base64,R0lGODlhEgASAIAAAP///////yH5BAUUAAEALAAAAAASABIAAAIPjI+py+0Po5y02ouz3pwXADs='\";\r\n        e.innerHTML = \"<map id='\" + this._id + \"' name='\" + this._id + \"'>\" + this._map.join(\"\\n\") + \"</map><img \" + c + \" class='dhx_map_img' usemap='#\" + this._id + \"' onmousedown='return false;'>\";\r\n        a._htmlmap = e;\r\n        this._map = []\r\n    }\r\n};\r\ndhtmlx.chart = {};\r\ndhtmlx.chart.scatter = {\r\n    pvt_render_scatter: function(r, l, o, n, m, a) {\r\n        if (!this._settings.xValue) {\r\n            return dhtmlx.log(\"warning\", \"Undefined propery: xValue\")\r\n        }\r\n        var e = this._getLimits();\r\n        var h = this._getLimits(\"h\", \"xValue\");\r\n        if (!m) {\r\n            if (!this.canvases.x) {\r\n                this.canvases.x = new dhtmlx.ui.Canvas(this._obj,\"axis_x\")\r\n            }\r\n            if (!this.canvases.y) {\r\n                this.canvases.y = new dhtmlx.ui.Canvas(this._obj,\"axis_y\")\r\n            }\r\n            this._drawYAxis(this.canvases.y.getCanvas(), l, o, n, e.min, e.max);\r\n            this._drawHXAxis(this.canvases.x.getCanvas(), l, o, n, h.min, h.max)\r\n        }\r\n        e = {\r\n            min: this._settings.yAxis.start,\r\n            max: this._settings.yAxis.end\r\n        };\r\n        h = {\r\n            min: this._settings.xAxis.start,\r\n            max: this._settings.xAxis.end\r\n        };\r\n        var c = this._getScatterParams(r, l, o, n, h, e);\r\n        this._mapStart = o;\r\n        for (var g = 0; g < l.length; g++) {\r\n            this._drawScatterItem(r, a, o, n, c, h, e, l[g], m)\r\n        }\r\n    },\r\n    _getScatterParams: function(a, g, e, c, m, l) {\r\n        var h = {};\r\n        h.totalHeight = c.y - e.y;\r\n        h.totalWidth = c.x - e.x;\r\n        this._calcScatterUnit(h, m.min, m.max, h.totalWidth, \"X\");\r\n        this._calcScatterUnit(h, l.min, l.max, h.totalHeight, \"Y\");\r\n        return h\r\n    },\r\n    _drawScatterItem: function(s, a, o, n, e, h, g, l, m) {\r\n        var c = this._calculateScatterItemPosition(e, n, o, h, l, \"X\");\r\n        var r = this._calculateScatterItemPosition(e, o, n, g, l, \"Y\");\r\n        this._drawItem(s, c, r, l, this._settings.label.call(this, l), m, a)\r\n    },\r\n    _calculateScatterItemPosition: function(e, n, m, a, h, c) {\r\n        var r = this._settings[c == \"X\" ? \"xValue\" : \"value\"].call(this, h);\r\n        var g = e[\"valueFactor\" + c];\r\n        var s = (parseFloat(r || 0) - a.min) * g;\r\n        var o = e[\"unit\" + c];\r\n        var l = m[c.toLowerCase()] - (c == \"X\" ? (-1) : 1) * Math.floor(o * s);\r\n        if (s < 0) {\r\n            l = m[c.toLowerCase()]\r\n        }\r\n        if (r > a.max) {\r\n            l = n[c.toLowerCase()]\r\n        }\r\n        if (r < a.min) {\r\n            l = m[c.toLowerCase()]\r\n        }\r\n        return l\r\n    },\r\n    _calcScatterUnit: function(l, e, a, c, g) {\r\n        var h = this._getRelativeValue(e, a);\r\n        g = (g || \"\");\r\n        l[\"relValue\" + g] = h[0];\r\n        l[\"valueFactor\" + g] = h[1];\r\n        l[\"unit\" + g] = (l[\"relValue\" + g] ? c / l[\"relValue\" + g] : 10)\r\n    }\r\n};\r\ndhtmlx.chart.radar = {\r\n    pvt_render_radar: function(c, g, a, l, e, h) {\r\n        this._renderRadarChart(c, g, a, l, e, h)\r\n    },\r\n    _renderRadarChart: function(v, h, s, r, o, a) {\r\n        if (!h.length) {\r\n            return\r\n        }\r\n        var m = this._getPieParameters(s, r);\r\n        var n = (this._settings.radius ? this._settings.radius : m.radius);\r\n        var c = (this._settings.x ? this._settings.x : m.x);\r\n        var u = (this._settings.y ? this._settings.y : m.y);\r\n        var e = [];\r\n        for (var g = 0; g < h.length; g++) {\r\n            e.push(1)\r\n        }\r\n        var l = this._getRatios(e, h.length);\r\n        this._mapStart = s;\r\n        if (!o) {\r\n            this._drawRadarAxises(l, c, u, n, h)\r\n        }\r\n        this._drawRadarData(v, l, c, u, n, h, o, a)\r\n    },\r\n    _drawRadarData: function(D, u, n, m, h, O, E, N) {\r\n        var C, w, M, K, F, J, g, e, H, L, I, v, c, A, r, o, a, s, l;\r\n        M = this._settings;\r\n        F = M.yAxis.start;\r\n        J = M.yAxis.end;\r\n        l = this._getRelativeValue(F, J);\r\n        v = l[0];\r\n        s = (v ? h / v : h / 2);\r\n        a = l[1];\r\n        c = -Math.PI / 2;\r\n        C = w = c;\r\n        H = [];\r\n        e = 0;\r\n        for (K = 0; K < O.length; K++) {\r\n            if (!o) {\r\n                A = M.value(O[K]);\r\n                r = (parseFloat(A || 0) - F) * a\r\n            } else {\r\n                r = o\r\n            }\r\n            L = Math.floor(s * r);\r\n            A = M.value((K != (O.length - 1)) ? O[K + 1] : O[0]);\r\n            o = (parseFloat(A || 0) - F) * a;\r\n            I = Math.floor(s * o);\r\n            C = w;\r\n            w = ((K != (O.length - 1)) ? (c + u[K] - 0.0001) : c);\r\n            g = (e || this._getPositionByAngle(C, n, m, L));\r\n            e = this._getPositionByAngle(w, n, m, I);\r\n            H.push(g)\r\n        }\r\n        if (M.fill) {\r\n            this._fillRadarChart(D, H, O)\r\n        }\r\n        if (!M.disableLines) {\r\n            this._strokeRadarChart(D, H, O)\r\n        }\r\n        if (!M.disableItems) {\r\n            this._drawRadarItemMarkers(D, H, O, E, N)\r\n        }\r\n        H = null \r\n    },\r\n    _drawRadarItemMarkers: function(a, e, h, g, l) {\r\n        for (var c = 0; c < e.length; c++) {\r\n            this._drawItem(a, e[c].x, e[c].y, h[c], this._settings.label.call(this, h), g, l)\r\n        }\r\n    },\r\n    _fillRadarChart: function(a, g, l) {\r\n        var h, e;\r\n        a.globalAlpha = this._settings.alpha.call(this, {});\r\n        a.beginPath();\r\n        for (var c = 0; c < g.length; c++) {\r\n            a.fillStyle = this._settings.fill.call(this, l[c]);\r\n            h = g[c];\r\n            e = (g[c + 1] || g[0]);\r\n            if (!c) {\r\n                a.moveTo(h.x, h.y)\r\n            }\r\n            a.lineTo(e.x, e.y)\r\n        }\r\n        a.fill();\r\n        a.globalAlpha = 1\r\n    },\r\n    _strokeRadarChart: function(a, g, l) {\r\n        var h, e;\r\n        for (var c = 0; c < g.length; c++) {\r\n            h = g[c];\r\n            e = (g[c + 1] || g[0]);\r\n            this._drawLine(a, h.x, h.y, e.x, e.y, this._settings.line.color.call(this, l[c]), this._settings.line.width)\r\n        }\r\n    },\r\n    _drawRadarAxises: function(C, w, v, m, P) {\r\n        var a = this._settings.yAxis;\r\n        var g = this._settings.xAxis;\r\n        var n = a.start;\r\n        var l = a.end;\r\n        var r = a.step;\r\n        var D = {};\r\n        var O = this._configYAxis;\r\n        if (typeof O.step == \"undefined\" || typeof O.start == \"undefined\" || typeof O.end == \"undefined\") {\r\n            var s = this._getLimits();\r\n            D = this._calculateScale(s.min, s.max);\r\n            n = D.start;\r\n            l = D.end;\r\n            r = D.step;\r\n            a.end = l;\r\n            a.start = n\r\n        }\r\n        var J = [];\r\n        var M, L, E;\r\n        var N = 0;\r\n        var e = m * r / (l - n);\r\n        var u, A;\r\n        if (r < 1) {\r\n            u = Math.min(this._log10(r), (n <= 0 ? 0 : this._log10(n)));\r\n            A = Math.pow(10, -u)\r\n        }\r\n        var K = [];\r\n        if (!this.canvases.scale) {\r\n            this.canvases.scale = new dhtmlx.ui.Canvas(this._obj,\"radar_scale\")\r\n        }\r\n        var I = this.canvases.scale.getCanvas();\r\n        for (M = l; M >= n; M -= r) {\r\n            if (D.fixNum) {\r\n                M = parseFloat((new Number(M)).toFixed(D.fixNum))\r\n            }\r\n            J.push(Math.floor(N * e) + 0.5);\r\n            if (A) {\r\n                M = Math.round(M * A) / A\r\n            }\r\n            var o = v - m + J[J.length - 1];\r\n            this.canvases.scale.renderTextAt(\"middle\", \"left\", w, o, a.template(M.toString()), \"dhx_axis_item_y dhx_radar\");\r\n            if (C.length < 2) {\r\n                this._drawScaleSector(I, \"arc\", w, v, m - J[J.length - 1], -Math.PI / 2, 3 * Math.PI / 2, M);\r\n                return\r\n            }\r\n            var h = -Math.PI / 2;\r\n            var H = h;\r\n            var F;\r\n            for (L = 0; L < C.length; L++) {\r\n                if (M == l) {\r\n                    K.push(H)\r\n                }\r\n                F = h + C[L] - 0.0001;\r\n                this._drawScaleSector(I, (O.lineShape || \"line\"), w, v, m - J[J.length - 1], H, F, M, L, P[M]);\r\n                H = F\r\n            }\r\n            N++\r\n        }\r\n        for (M = 0; M < K.length; M++) {\r\n            E = this._getPositionByAngle(K[M], w, v, m);\r\n            if (g.lines.call(this, P[M], M)) {\r\n                this._drawLine(I, w, v, E.x, E.y, (g ? g.lineColor.call(this, P[M]) : \"#cfcfcf\"), 1)\r\n            }\r\n            this._drawRadarScaleLabel(I, w, v, m, K[M], (g ? g.template.call(this, P[M]) : \"&nbsp;\"))\r\n        }\r\n    },\r\n    _drawScaleSector: function(u, l, s, o, h, c, a, g, e) {\r\n        var r, n;\r\n        if (h < 0) {\r\n            return false\r\n        }\r\n        r = this._getPositionByAngle(c, s, o, h);\r\n        n = this._getPositionByAngle(a, s, o, h);\r\n        var m = this._settings.yAxis;\r\n        if (m.bg) {\r\n            u.beginPath();\r\n            u.moveTo(s, o);\r\n            if (l == \"arc\") {\r\n                u.arc(s, o, h, c, a, false)\r\n            } else {\r\n                u.lineTo(r.x, r.y);\r\n                u.lineTo(n.x, n.y)\r\n            }\r\n            u.fillStyle = m.bg(g, e);\r\n            u.moveTo(s, o);\r\n            u.fill();\r\n            u.closePath()\r\n        }\r\n        if (m.lines.call(this, g)) {\r\n            u.lineWidth = 1;\r\n            u.beginPath();\r\n            if (l == \"arc\") {\r\n                u.arc(s, o, h, c, a, false)\r\n            } else {\r\n                u.moveTo(r.x, r.y);\r\n                u.lineTo(n.x, n.y)\r\n            }\r\n            u.strokeStyle = m.lineColor.call(this, g);\r\n            u.stroke()\r\n        }\r\n    },\r\n    _drawRadarScaleLabel: function(A, o, m, c, n, v) {\r\n        var w = this.canvases.scale.renderText(0, 0, v, \"dhx_axis_radar_title\", 1);\r\n        var e = w.scrollWidth;\r\n        var u = w.offsetHeight;\r\n        var s = 0.001;\r\n        var l = this._getPositionByAngle(n, o, m, c + 5);\r\n        var h = 0\r\n          , g = 0;\r\n        if (n < 0 || n > Math.PI) {\r\n            g = -u\r\n        }\r\n        if (n > Math.PI / 2) {\r\n            h = -e\r\n        }\r\n        if (Math.abs(n + Math.PI / 2) < s || Math.abs(n - Math.PI / 2) < s) {\r\n            h = -e / 2\r\n        } else {\r\n            if (Math.abs(n) < s || Math.abs(n - Math.PI) < s) {\r\n                g = -u / 2\r\n            }\r\n        }\r\n        w.style.top = l.y + g + \"px\";\r\n        w.style.left = l.x + h + \"px\";\r\n        w.style.width = e + \"px\";\r\n        w.style.whiteSpace = \"nowrap\"\r\n    }\r\n};\r\ndhtmlx.chart.area = {\r\n    pvt_render_area: function(n, F, h, g, o, C) {\r\n        var s, A, u, r, l, y, m, E, D, x, w, c, v, a, e;\r\n        y = this._calculateLineParams(n, F, h, g, o);\r\n        A = this._settings;\r\n        r = (A.eventRadius || Math.floor(y.cellWidth / 2));\r\n        if (F.length) {\r\n            m = [];\r\n            x = (!A.offset ? h.x : h.x + y.cellWidth * 0.5);\r\n            for (u = 0; u < F.length; u++) {\r\n                l = F[u];\r\n                D = this._getPointY(l, h, g, y);\r\n                v = x + y.cellWidth * u;\r\n                if (D) {\r\n                    a = (typeof D == \"object\" ? D.y0 : D);\r\n                    if (u && this._settings.fixOverflow) {\r\n                        E = this._getPointY(F[u - 1], h, g, y);\r\n                        if (E.out && E.out == D.out) {\r\n                            continue\r\n                        }\r\n                        w = y.cellWidth * (u - 1) - 0.5 + x;\r\n                        c = (typeof E == \"object\" ? E.y0 : E);\r\n                        if (E.out) {\r\n                            e = (E.out == \"min\" ? g.y : h.y);\r\n                            m.push([this._calcOverflowX(w, v, c, a, e), e])\r\n                        }\r\n                        if (D.out) {\r\n                            e = (D.out == \"min\" ? g.y : h.y);\r\n                            m.push([this._calcOverflowX(w, v, c, a, e), e]);\r\n                            if (u == (F.length - 1) && e == h.y) {\r\n                                m.push([v, h.y])\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!D.out) {\r\n                        m.push([v, a]);\r\n                        C.addRect(l.id, [v - r - h.x, a - r - h.y, v + r - h.x, a + r - h.y], o)\r\n                    }\r\n                    if (!A.yAxis) {\r\n                        s = (!A.offset && (u == F.length - 1) ? \"left\" : \"center\");\r\n                        this.canvases[o].renderTextAt(false, s, v, a - A.labelOffset, A.label(l))\r\n                    }\r\n                }\r\n            }\r\n            if (m.length) {\r\n                m.push([v, g.y]);\r\n                m.push([m[0][0], g.y])\r\n            }\r\n            n.globalAlpha = this._settings.alpha.call(this, F[0]);\r\n            n.fillStyle = this._settings.color.call(this, F[0]);\r\n            n.beginPath();\r\n            this._path(n, m);\r\n            n.fill();\r\n            if (A.border) {\r\n                n.lineWidth = A.borderWidth || 1;\r\n                if (A.borderColor) {\r\n                    n.strokeStyle = A.borderColor.call(this, F[0])\r\n                } else {\r\n                    this._setBorderStyles(n, n.fillStyle)\r\n                }\r\n                n.beginPath();\r\n                this._path(n, m);\r\n                n.stroke()\r\n            }\r\n            n.lineWidth = 1;\r\n            n.globalAlpha = 1\r\n        }\r\n    }\r\n};\r\ndhtmlx.chart.stackedArea = {\r\n    pvt_render_stackedArea: function(o, H, c, a, r, E) {\r\n        var J, I, v, D, A, w, h, u, l, C, n, g, e, m;\r\n        C = this._calculateLineParams(o, H, c, a, r);\r\n        D = this._settings;\r\n        u = (D.eventRadius || Math.floor(C.cellWidth / 2));\r\n        if (H.length) {\r\n            n = [];\r\n            m = [];\r\n            g = (!D.offset ? c.x : c.x + C.cellWidth * 0.5);\r\n            var F = function(x, K) {\r\n                return r ? (H[x].$startY ? K - a.y + H[x].$startY : 0) : K\r\n            }\r\n            ;\r\n            var s = function(y, M, L) {\r\n                var K = (L.y - M.y) / (L.x - M.x);\r\n                return K * y + M.y - K * M.x\r\n            }\r\n            ;\r\n            for (A = 0; A < H.length; A++) {\r\n                l = H[A];\r\n                if (!A) {\r\n                    e = F(A, a.y);\r\n                    n.push([g, e])\r\n                } else {\r\n                    g += C.cellWidth\r\n                }\r\n                e = F(A, this._getPointY(l, c, a, C));\r\n                m.push((isNaN(e) && !A) ? (H[A].$startY || a.y) : e);\r\n                if (e) {\r\n                    n.push([g, e]);\r\n                    E.addRect(l.id, [g - u - c.x, e - u - c.y, g + u - c.x, e + u - c.y], r);\r\n                    if (!D.yAxis) {\r\n                        v = (!D.offset && h ? \"left\" : \"center\");\r\n                        this.canvases[r].renderTextAt(false, v, g, e - D.labelOffset, D.label(l))\r\n                    }\r\n                }\r\n            }\r\n            n.push([g, F(A - 1, a.y)]);\r\n            if (r) {\r\n                for (A = H.length - 2; A > 0; A--) {\r\n                    g -= C.cellWidth;\r\n                    e = H[A].$startY;\r\n                    if (e) {\r\n                        n.push([g, e])\r\n                    }\r\n                }\r\n            }\r\n            n.push([n[0][0], n[0][1]]);\r\n            o.globalAlpha = this._settings.alpha.call(this, H[0]);\r\n            o.fillStyle = this._settings.color.call(this, H[0]);\r\n            o.beginPath();\r\n            this._path(o, n);\r\n            o.fill();\r\n            for (A = 0; A < H.length; A++) {\r\n                e = m[A];\r\n                if (!e) {\r\n                    if (A == H.length - 1) {\r\n                        e = H[A].$startY\r\n                    }\r\n                    for (w = A + 1; w < H.length; w++) {\r\n                        if (m[w]) {\r\n                            J = {\r\n                                x: c.x,\r\n                                y: m[0]\r\n                            };\r\n                            I = {\r\n                                x: (c.x + C.cellWidth * w),\r\n                                y: m[w]\r\n                            };\r\n                            e = s(c.x + C.cellWidth * A, J, I);\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n                H[A].$startY = e\r\n            }\r\n        }\r\n    }\r\n};\r\ndhtmlx.chart.spline = {\r\n    pvt_render_spline: function(o, I, g, e, r, H) {\r\n        var F, u, n, s, E, m, l, A, w, v, h, c, a;\r\n        E = this._calculateLineParams(o, I, g, e, r);\r\n        F = this._settings;\r\n        this._mapStart = g;\r\n        n = [];\r\n        if (I.length) {\r\n            A = (F.offset ? g.x + E.cellWidth * 0.5 : g.x);\r\n            for (u = 0; u < I.length; u++) {\r\n                h = this._getPointY(I[u], g, e, E);\r\n                if (h) {\r\n                    l = ((!u) ? A : E.cellWidth * u - 0.5 + A);\r\n                    n.push({\r\n                        x: l,\r\n                        y: h,\r\n                        index: u\r\n                    })\r\n                }\r\n            }\r\n            m = this._getSplineParameters(n);\r\n            for (u = 0; u < n.length; u++) {\r\n                w = n[u].x;\r\n                c = n[u].y;\r\n                if (u < n.length - 1) {\r\n                    v = n[u + 1].x;\r\n                    a = n[u + 1].y;\r\n                    for (s = w; s < v; s++) {\r\n                        var D = this._getSplineYPoint(s, w, u, m.a, m.b, m.c, m.d);\r\n                        if (D < g.y) {\r\n                            D = g.y\r\n                        }\r\n                        if (D > e.y) {\r\n                            D = e.y\r\n                        }\r\n                        var C = this._getSplineYPoint(s + 1, w, u, m.a, m.b, m.c, m.d);\r\n                        if (C < g.y) {\r\n                            C = g.y\r\n                        }\r\n                        if (C > e.y) {\r\n                            C = e.y\r\n                        }\r\n                        this._drawLine(o, s, D, s + 1, C, F.line.color(I[u]), F.line.width)\r\n                    }\r\n                    this._drawLine(o, v - 1, this._getSplineYPoint(s, w, u, m.a, m.b, m.c, m.d), v, a, F.line.color(I[u]), F.line.width)\r\n                }\r\n                this._drawItem(o, w, c, I[n[u].index], F.label(I[n[u].index]), r, H)\r\n            }\r\n        }\r\n    },\r\n    _getSplineParameters: function(A) {\r\n        var l, D, C, E, y, x, w, r, o = [], g = [], e = A.length;\r\n        for (l = 0; l < e - 1; l++) {\r\n            o[l] = A[l + 1].x - A[l].x;\r\n            g[l] = (A[l + 1].y - A[l].y) / o[l]\r\n        }\r\n        D = [];\r\n        C = [];\r\n        D[0] = 0;\r\n        D[1] = 2 * (o[0] + o[1]);\r\n        C[0] = 0;\r\n        C[1] = 6 * (g[1] - g[0]);\r\n        for (l = 2; l < e - 1; l++) {\r\n            D[l] = 2 * (o[l - 1] + o[l]) - o[l - 1] * o[l - 1] / D[l - 1];\r\n            C[l] = 6 * (g[l] - g[l - 1]) - o[l - 1] * C[l - 1] / D[l - 1]\r\n        }\r\n        E = [];\r\n        E[e - 1] = E[0] = 0;\r\n        for (l = e - 2; l >= 1; l--) {\r\n            E[l] = (C[l] - o[l] * E[l + 1]) / D[l]\r\n        }\r\n        y = [];\r\n        x = [];\r\n        w = [];\r\n        r = [];\r\n        for (l = 0; l < e - 1; l++) {\r\n            y[l] = A[l].y;\r\n            x[l] = -o[l] * E[l + 1] / 6 - o[l] * E[l] / 3 + (A[l + 1].y - A[l].y) / o[l];\r\n            w[l] = E[l] / 2;\r\n            r[l] = (E[l + 1] - E[l]) / (6 * o[l])\r\n        }\r\n        return {\r\n            a: y,\r\n            b: x,\r\n            c: w,\r\n            d: r\r\n        }\r\n    },\r\n    _getSplineYPoint: function(g, l, m, h, e, o, n) {\r\n        return h[m] + (g - l) * (e[m] + (g - l) * (o[m] + (g - l) * n[m]))\r\n    }\r\n};\r\ndhtmlx.chart.barH = {\r\n    pvt_render_barH: function(D, Q, m, l, E, P) {\r\n        var u, w, H, F, a, J, r, N, x, O, c, A, n, K, y, h, C, v, M, g, s;\r\n        H = (l.y - m.y) / Q.length;\r\n        r = this._getLimits(\"h\");\r\n        N = r.max;\r\n        x = r.min;\r\n        h = l.x - m.x;\r\n        s = !!this._settings.yAxis;\r\n        if (!E) {\r\n            this._drawHScales(D, Q, m, l, x, N, H)\r\n        }\r\n        if (s) {\r\n            N = parseFloat(this._settings.xAxis.end);\r\n            x = parseFloat(this._settings.xAxis.start)\r\n        }\r\n        K = this._getRelativeValue(x, N);\r\n        A = K[0];\r\n        c = K[1];\r\n        v = (A ? h / A : 10);\r\n        if (!s) {\r\n            y = 10;\r\n            v = (A ? (h - y) / A : 10)\r\n        }\r\n        w = parseInt(this._settings.width, 10);\r\n        var L = this._series.length;\r\n        var o = this._settings.seriesMargin;\r\n        var e = this._settings.seriesPadding;\r\n        if (this._series && (w * L + e + (L > 2 ? o * L : 0) > H)) {\r\n            w = H / L - e - (L > 2 ? o : 0)\r\n        }\r\n        u = (H - w * L - o * (L - 1)) / 2;\r\n        if (this._settings.border) {\r\n            w = parseInt(w, 10);\r\n            u = parseInt(u, 10)\r\n        }\r\n        n = (typeof this._settings.radius != \"undefined\" ? parseInt(this._settings.radius, 10) : Math.round(w / 5));\r\n        O = false;\r\n        a = this._settings.gradient;\r\n        if (a && typeof (a) != \"function\") {\r\n            O = a;\r\n            a = false\r\n        } else {\r\n            if (a) {\r\n                a = D.createLinearGradient(m.x, m.y, l.x, m.y);\r\n                this._settings.gradient(a)\r\n            }\r\n        }\r\n        if (!s) {\r\n            this._drawLine(D, m.x - 0.5, m.y, m.x - 0.5, l.y, \"#000000\", 1)\r\n        }\r\n        for (J = 0; J < Q.length; J++) {\r\n            C = parseFloat(this._settings.value(Q[J] || 0));\r\n            if (C > N) {\r\n                C = N\r\n            }\r\n            C -= x;\r\n            C *= c;\r\n            M = m.x;\r\n            g = m.y + u + (L > 2 ? o * E : 0) + parseInt(J * H, 10) + w * E;\r\n            if ((C < 0 && this._settings.origin == \"auto\") || (this._settings.xAxis && C === 0 && !(this._settings.origin != \"auto\" && this._settings.origin > x))) {\r\n                this.canvases[E].renderTextAt(\"middle\", \"right\", M + 10, g + w / 2 + u, this._settings.label(Q[J]));\r\n                continue\r\n            }\r\n            if (C < 0 && this._settings.origin != \"auto\" && this._settings.origin > x) {\r\n                C = 0\r\n            }\r\n            if (!s) {\r\n                C += y / v\r\n            }\r\n            F = a || this._settings.color.call(this, Q[J]);\r\n            if (this._settings.border) {\r\n                this._drawBarHBorder(D, M, g, w, x, n, v, C, F)\r\n            }\r\n            D.globalAlpha = this._settings.alpha.call(this, Q[J]);\r\n            var I = this._drawBarH(D, l, M, g, w, x, n, v, C, F, a, O);\r\n            if (O != false) {\r\n                this._drawBarHGradient(D, M, g, w, x, n, v, C, F, O)\r\n            }\r\n            D.globalAlpha = 1;\r\n            if (I[3] == g) {\r\n                this.canvases[E].renderTextAt(\"middle\", \"left\", I[0] - 5, I[3] + Math.floor(w / 2), this._settings.label(Q[J]));\r\n                P.addRect(Q[J].id, [I[0] - m.x, I[3] - m.y, I[2] - m.x, I[3] + w - m.y], E)\r\n            } else {\r\n                this.canvases[E].renderTextAt(\"middle\", false, I[2] + 5, I[1] + Math.floor(w / 2), this._settings.label(Q[J]));\r\n                P.addRect(Q[J].id, [I[0] - m.x, g - m.y, I[2] - m.x, I[3] - m.y], E)\r\n            }\r\n        }\r\n    },\r\n    _setBarHPoints: function(x, g, v, y, m, w, u, l, h) {\r\n        var c = 0;\r\n        if (m > w * u) {\r\n            var s = (m - w * u) / m;\r\n            c = -Math.asin(s) + Math.PI / 2\r\n        }\r\n        x.moveTo(g, v + l);\r\n        var e = g + w * u - m - (m ? 0 : l);\r\n        if (m < w * u) {\r\n            x.lineTo(e, v + l)\r\n        }\r\n        var r = v + m;\r\n        if (m && m > 0) {\r\n            x.arc(e, r, m - l, -Math.PI / 2 + c, 0, false)\r\n        }\r\n        var o = v + y - m - (m ? 0 : l);\r\n        var a = e + m - (m ? l : 0);\r\n        x.lineTo(a, o);\r\n        if (m && m > 0) {\r\n            x.arc(e, o, m - l, 0, Math.PI / 2 - c, false)\r\n        }\r\n        var n = v + y - l;\r\n        x.lineTo(g, n);\r\n        if (!h) {\r\n            x.lineTo(g, v + l)\r\n        }\r\n        return [a, n]\r\n    },\r\n    _drawHScales: function(e, m, l, h, n, c, g) {\r\n        var a = 0;\r\n        if (this._settings.xAxis) {\r\n            if (!this.canvases.x) {\r\n                this.canvases.x = new dhtmlx.ui.Canvas(this._obj)\r\n            }\r\n            a = this._drawHXAxis(this.canvases.x.getCanvas(), m, l, h, n, c)\r\n        }\r\n        if (this._settings.yAxis) {\r\n            if (!this.canvases.y) {\r\n                this.canvases.y = new dhtmlx.ui.Canvas(this._obj)\r\n            }\r\n            this._drawHYAxis(this.canvases.y.getCanvas(), m, l, h, g, a)\r\n        }\r\n    },\r\n    _drawHYAxis: function(u, h, o, m, e, a) {\r\n        if (!this._settings.yAxis) {\r\n            return\r\n        }\r\n        var l;\r\n        var c = parseInt((a ? a : o.x), 10) - 0.5;\r\n        var r = m.y + 0.5;\r\n        var n = o.y;\r\n        this._drawLine(u, c, r, c, n, this._settings.yAxis.color, 1);\r\n        for (var g = 0; g < h.length; g++) {\r\n            var s = ((this._settings.origin != \"auto\") && (this._settings.view == \"barH\") && (parseFloat(this._settings.value(h[g])) < this._settings.origin));\r\n            l = n + e / 2 + g * e;\r\n            this.canvases.y.renderTextAt(\"middle\", (s ? false : \"left\"), (s ? c + 5 : c - 5), l, this._settings.yAxis.template(h[g]), \"dhx_axis_item_y\", (s ? 0 : c - 10));\r\n            if (this._settings.yAxis.lines.call(this, h[g])) {\r\n                this._drawLine(u, o.x, l, m.x, l, this._settings.yAxis.lineColor.call(this, h[g]), 1)\r\n            }\r\n        }\r\n        this._drawLine(u, o.x + 0.5, n + 0.5, m.x, n + 0.5, this._settings.yAxis.lineColor.call(this, {}), 1);\r\n        this._setYAxisTitle(o, m)\r\n    },\r\n    _drawHXAxis: function(C, u, y, x, e, o) {\r\n        var m;\r\n        var h = {};\r\n        var n = this._settings.xAxis;\r\n        if (!n) {\r\n            return\r\n        }\r\n        var A = x.y + 0.5;\r\n        var g = y.x - 0.5;\r\n        var a = x.x - 0.5;\r\n        var s = y.x;\r\n        this._drawLine(C, g, A, a, A, n.color, 1);\r\n        if (n.step) {\r\n            m = parseFloat(n.step)\r\n        }\r\n        if (typeof this._configXAxis.step == \"undefined\" || typeof this._configXAxis.start == \"undefined\" || typeof this._configXAxis.end == \"undefined\") {\r\n            h = this._calculateScale(e, o);\r\n            e = h.start;\r\n            o = h.end;\r\n            m = h.step;\r\n            this._settings.xAxis.end = o;\r\n            this._settings.xAxis.start = e;\r\n            this._settings.xAxis.step = m\r\n        }\r\n        if (m === 0) {\r\n            return\r\n        }\r\n        var l = (a - g) * m / (o - e);\r\n        var w = 0;\r\n        for (var r = e; r <= o; r += m) {\r\n            if (h.fixNum) {\r\n                r = parseFloat((new Number(r)).toFixed(h.fixNum))\r\n            }\r\n            var v = Math.floor(g + w * l) + 0.5;\r\n            if (!(r == e && this._settings.origin == \"auto\") && n.lines.call(this, r)) {\r\n                this._drawLine(C, v, A, v, y.y, this._settings.xAxis.lineColor.call(this, r), 1)\r\n            }\r\n            if (r == this._settings.origin) {\r\n                s = v + 1\r\n            }\r\n            this.canvases.x.renderTextAt(false, true, v, A + 2, n.template(r.toString()), \"dhx_axis_item_x\");\r\n            w++\r\n        }\r\n        this.canvases.x.renderTextAt(true, false, g, x.y + this._settings.padding.bottom - 3, this._settings.xAxis.title, \"dhx_axis_title_x\", x.x - y.x);\r\n        if (!n.lines.call(this, {})) {\r\n            this._drawLine(C, g, y.y - 0.5, a, y.y - 0.5, this._settings.xAxis.color, 0.2)\r\n        }\r\n        return s\r\n    },\r\n    _correctBarHParams: function(n, h, e, l, m, o, g) {\r\n        var a = this._settings.yAxis;\r\n        var c = h;\r\n        if (!!a && this._settings.origin != \"auto\" && (this._settings.origin > g)) {\r\n            h += (this._settings.origin - g) * m;\r\n            c = h;\r\n            l = l - (this._settings.origin - g);\r\n            if (l < 0) {\r\n                l *= (-1);\r\n                n.translate(h, e + o);\r\n                n.rotate(Math.PI);\r\n                h = 0.5;\r\n                e = 0\r\n            }\r\n            h += 0.5\r\n        }\r\n        return {\r\n            value: l,\r\n            x0: h,\r\n            y0: e,\r\n            start: c\r\n        }\r\n    },\r\n    _drawBarH: function(v, h, C, g, o, r, l, n, u, w, a, m) {\r\n        var x;\r\n        v.save();\r\n        var s = this._correctBarHParams(v, C, g, u, n, o, r);\r\n        v.fillStyle = w;\r\n        v.beginPath();\r\n        if (n * s.value > 0) {\r\n            x = this._setBarHPoints(v, s.x0, s.y0, o, l, n, s.value, (this._settings.border ? 1 : 0));\r\n            if (a && !m) {\r\n                v.lineTo(h.x, s.y0 + (this._settings.border ? 1 : 0))\r\n            }\r\n        } else {\r\n            x = [s.x0, s.y0 + 1]\r\n        }\r\n        v.fill();\r\n        v.restore();\r\n        var e = s.y0;\r\n        var c = (s.y0 != g ? g : x[1]);\r\n        var A = (s.y0 != g ? (s.start - x[0]) : s.start);\r\n        var y = (s.y0 != g ? s.start : x[0]);\r\n        return [A, e, y, c]\r\n    },\r\n    _drawBarHBorder: function(o, c, m, r, h, g, n, l, e) {\r\n        o.save();\r\n        var a = this._correctBarHParams(o, c, m, l, n, r, h);\r\n        o.beginPath();\r\n        this._setBorderStyles(o, e);\r\n        o.globalAlpha = 0.9;\r\n        if (n * a.value > 0) {\r\n            this._setBarHPoints(o, a.x0, a.y0, r, g, n, a.value, o.lineWidth / 2, 1)\r\n        }\r\n        o.stroke();\r\n        o.restore()\r\n    },\r\n    _drawBarHGradient: function(s, e, o, u, m, l, r, n, g, a) {\r\n        s.save();\r\n        var c = this._correctBarHParams(s, e, o, n, r, u, m);\r\n        var h = this._setBarGradient(s, c.x0, c.y0 + u, c.x0 + r * c.value, c.y0, a, g, \"x\");\r\n        s.fillStyle = h.gradient;\r\n        s.beginPath();\r\n        if (r * c.value > 0) {\r\n            this._setBarHPoints(s, c.x0, c.y0 + h.offset, u - h.offset * 2, l, r, c.value, h.offset)\r\n        }\r\n        s.fill();\r\n        s.globalAlpha = 1;\r\n        s.restore()\r\n    }\r\n};\r\ndhtmlx.assert(dhtmlx.chart.barH);\r\ndhtmlx.chart.stackedBarH = {\r\n    pvt_render_stackedBarH: function(D, Q, h, g, E, P) {\r\n        var O, w;\r\n        var c;\r\n        var x;\r\n        var A = g.x - h.x;\r\n        var n = !!this._settings.yAxis;\r\n        var m = this._getStackedLimits(Q);\r\n        O = m.max;\r\n        w = m.min;\r\n        var H = Math.floor((g.y - h.y) / Q.length);\r\n        if (!E) {\r\n            this._drawHScales(D, Q, h, g, w, O, H)\r\n        }\r\n        if (n) {\r\n            O = parseFloat(this._settings.xAxis.end);\r\n            w = parseFloat(this._settings.xAxis.start)\r\n        }\r\n        var L = this._getRelativeValue(w, O);\r\n        x = L[0];\r\n        c = L[1];\r\n        var u = (x ? A / x : 10);\r\n        if (!n) {\r\n            var y = 10;\r\n            u = (x ? (A - y) / x : 10)\r\n        }\r\n        var v = parseInt(this._settings.width, 10);\r\n        if ((v + 4) > H) {\r\n            v = H - 4\r\n        }\r\n        var o = (H - v) / 2;\r\n        var l = 0;\r\n        var r = false;\r\n        var a = this._settings.gradient;\r\n        if (a) {\r\n            r = true\r\n        }\r\n        if (!n) {\r\n            this._drawLine(D, h.x - 0.5, h.y, h.x - 0.5, g.y, \"#000000\", 1)\r\n        }\r\n        var N = 0;\r\n        var K = 0;\r\n        for (J = 0; J < this._series.length; J++) {\r\n            if (J == E) {\r\n                K = N\r\n            }\r\n            if (this._series[J].view == \"stackedBarH\") {\r\n                N++\r\n            }\r\n        }\r\n        for (var J = 0; J < Q.length; J++) {\r\n            if (!K) {\r\n                Q[J].$startX = h.x\r\n            }\r\n            var C = parseFloat(this._settings.value(Q[J] || 0));\r\n            if (C > O) {\r\n                C = O\r\n            }\r\n            C -= w;\r\n            C *= c;\r\n            var M = h.x;\r\n            var e = h.y + o + J * H;\r\n            if (!K) {\r\n                Q[J].$startX = M\r\n            } else {\r\n                M = Q[J].$startX\r\n            }\r\n            if (C < 0 || (this._settings.yAxis && C === 0)) {\r\n                this.canvases.y.renderTextAt(\"middle\", true, M + 10, e + v / 2, this._settings.label(Q[J]));\r\n                continue\r\n            }\r\n            if (!n) {\r\n                C += y / u\r\n            }\r\n            var F = this._settings.color.call(this, Q[J]);\r\n            D.globalAlpha = this._settings.alpha.call(this, Q[J]);\r\n            D.fillStyle = this._settings.color.call(this, Q[J]);\r\n            D.beginPath();\r\n            var I = this._setBarHPoints(D, M, e, v, l, u, C, (this._settings.border ? 1 : 0));\r\n            if (a && !r) {\r\n                D.lineTo(h.x + A, e + (this._settings.border ? 1 : 0))\r\n            }\r\n            D.fill();\r\n            if (r != false) {\r\n                var s = this._setBarGradient(D, M, e + v, M, e, r, F, \"x\");\r\n                D.fillStyle = s.gradient;\r\n                D.beginPath();\r\n                I = this._setBarHPoints(D, M, e, v, l, u, C, 0);\r\n                D.fill()\r\n            }\r\n            if (this._settings.border) {\r\n                this._drawBarHBorder(D, M, e, v, w, l, u, C, F)\r\n            }\r\n            D.globalAlpha = 1;\r\n            this.canvases[E].renderTextAt(\"middle\", true, Q[J].$startX + (I[0] - Q[J].$startX) / 2 - 1, e + (I[1] - e) / 2, this._settings.label(Q[J]));\r\n            P.addRect(Q[J].id, [Q[J].$startX - h.x, e - h.y, I[0] - h.x, I[1] - h.y], E);\r\n            Q[J].$startX = I[0]\r\n        }\r\n    }\r\n};\r\ndhtmlx.chart.stackedBar = {\r\n    pvt_render_stackedBar: function(y, M, g, e, A, L) {\r\n        var J, u;\r\n        var a;\r\n        var v;\r\n        var w = e.y - g.y;\r\n        var l = !!this._settings.yAxis;\r\n        var K = !!this._settings.xAxis;\r\n        var h = this._getStackedLimits(M);\r\n        J = h.max;\r\n        u = h.min;\r\n        var D = Math.floor((e.x - g.x) / M.length);\r\n        if (!A) {\r\n            this._drawScales(M, g, e, u, J, D)\r\n        }\r\n        if (l) {\r\n            J = parseFloat(this._settings.yAxis.end);\r\n            u = parseFloat(this._settings.yAxis.start)\r\n        }\r\n        var H = this._getRelativeValue(u, J);\r\n        v = H[0];\r\n        a = H[1];\r\n        var r = (v ? w / v : 10);\r\n        var s = parseInt(this._settings.width, 10);\r\n        if (s + 4 > D) {\r\n            s = D - 4\r\n        }\r\n        var m = Math.floor((D - s) / 2);\r\n        var n = (this._settings.gradient ? this._settings.gradient : false);\r\n        if (!K) {\r\n            this._drawLine(y, g.x, e.y + 0.5, e.x, e.y + 0.5, \"#000000\", 1)\r\n        }\r\n        for (var F = 0; F < M.length; F++) {\r\n            var x = parseFloat(this._settings.value(M[F] || 0));\r\n            if (!x) {\r\n                if (!A || !M[F].$startY) {\r\n                    M[F].$startY = e.y\r\n                }\r\n                continue\r\n            }\r\n            if (!A) {\r\n                x -= u\r\n            }\r\n            x *= a;\r\n            var I = g.x + m + F * D;\r\n            var c = e.y;\r\n            if (!A) {\r\n                M[F].$startY = c\r\n            } else {\r\n                c = M[F].$startY\r\n            }\r\n            if (c < (g.y + 1)) {\r\n                continue\r\n            }\r\n            if (x < 0 || (this._settings.yAxis && x === 0)) {\r\n                this.canvases.y.renderTextAt(true, true, I + Math.floor(s / 2), c, this._settings.label(M[F]));\r\n                continue\r\n            }\r\n            var C = this._settings.color.call(this, M[F]);\r\n            y.globalAlpha = this._settings.alpha.call(this, M[F]);\r\n            y.fillStyle = this._settings.color.call(this, M[F]);\r\n            y.beginPath();\r\n            var E = this._setStakedBarPoints(y, I - (this._settings.border ? 0.5 : 0), c, s + (this._settings.border ? 0.5 : 0), r, x, 0, g.y);\r\n            y.fill();\r\n            if (n) {\r\n                y.save();\r\n                var o = this._setBarGradient(y, I, c, I + s, E[1], n, C, \"y\");\r\n                y.fillStyle = o.gradient;\r\n                y.beginPath();\r\n                E = this._setStakedBarPoints(y, I + o.offset, c, s - o.offset * 2, r, x, (this._settings.border ? 1 : 0), g.y);\r\n                y.fill();\r\n                y.restore()\r\n            }\r\n            if (this._settings.border) {\r\n                y.save();\r\n                this._setBorderStyles(y, C);\r\n                y.beginPath();\r\n                this._setStakedBarPoints(y, I - 0.5, c, s + 1, r, x, 0, g.y, 1);\r\n                y.stroke();\r\n                y.restore()\r\n            }\r\n            y.globalAlpha = 1;\r\n            this.canvases[A].renderTextAt(false, true, I + Math.floor(s / 2), (E[1] + (c - E[1]) / 2) - 7, this._settings.label(M[F]));\r\n            L.addRect(M[F].id, [I - g.x, E[1] - g.y, E[0] - g.x, (M[F].$startY || c) - g.y], A);\r\n            M[F].$startY = (this._settings.border ? (E[1] + 1) : E[1])\r\n        }\r\n    },\r\n    _setStakedBarPoints: function(u, c, o, v, r, n, g, e, h) {\r\n        u.moveTo(c, o);\r\n        var m = o - r * n + g;\r\n        if (m < e) {\r\n            m = e\r\n        }\r\n        u.lineTo(c, m);\r\n        var a = c + v;\r\n        var l = m;\r\n        u.lineTo(a, l);\r\n        var s = c + v;\r\n        u.lineTo(s, o);\r\n        if (!h) {\r\n            u.lineTo(c, o)\r\n        }\r\n        return [s, l - 2 * g]\r\n    }\r\n};\r\ndhtmlx.chart.line = {\r\n    pvt_render_line: function(m, C, h, g, n, y) {\r\n        var x, o, l, v, u, s, r, c, a, e, A, w;\r\n        v = this._calculateLineParams(m, C, h, g, n);\r\n        x = this._settings;\r\n        if (C.length) {\r\n            u = (x.offset ? h.x + v.cellWidth * 0.5 : h.x);\r\n            l = [];\r\n            for (o = 0; o < C.length; o++) {\r\n                w = this._getPointY(C[o], h, g, v);\r\n                if (w) {\r\n                    r = ((!o) ? u : v.cellWidth * o - 0.5 + u);\r\n                    a = (typeof w == \"object\" ? w.y0 : w);\r\n                    if (o && this._settings.fixOverflow) {\r\n                        A = this._getPointY(C[o - 1], h, g, v);\r\n                        if (A.out && A.out == w.out) {\r\n                            continue\r\n                        }\r\n                        s = v.cellWidth * (o - 1) - 0.5 + u;\r\n                        c = (typeof A == \"object\" ? A.y0 : A);\r\n                        if (A.out) {\r\n                            e = (A.out == \"min\" ? g.y : h.y);\r\n                            l.push({\r\n                                x: this._calcOverflowX(s, r, c, a, e),\r\n                                y: e\r\n                            })\r\n                        }\r\n                        if (w.out) {\r\n                            e = (w.out == \"min\" ? g.y : h.y);\r\n                            l.push({\r\n                                x: this._calcOverflowX(s, r, c, a, e),\r\n                                y: e\r\n                            })\r\n                        }\r\n                    }\r\n                    if (!w.out) {\r\n                        l.push({\r\n                            x: r,\r\n                            y: w,\r\n                            index: o\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n            this._mapStart = h;\r\n            for (o = 1; o <= l.length; o++) {\r\n                s = l[o - 1].x;\r\n                c = l[o - 1].y;\r\n                if (o < l.length) {\r\n                    r = l[o].x;\r\n                    a = l[o].y;\r\n                    this._drawLine(m, s, c, r, a, x.line.color.call(this, C[o - 1]), x.line.width);\r\n                    if (x.line && x.line.shadow) {\r\n                        m.globalAlpha = 0.3;\r\n                        this._drawLine(m, s + 2, c + x.line.width + 8, r + 2, a + x.line.width + 8, \"#eeeeee\", x.line.width + 3);\r\n                        m.globalAlpha = 1\r\n                    }\r\n                }\r\n                if (typeof l[o - 1].index != \"undefined\") {\r\n                    this._drawItem(m, s, c, C[l[o - 1].index], x.label(C[l[o - 1].index]), n, y, h)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _calcOverflowX: function(c, a, g, e, h) {\r\n        return c + (h - g) * (a - c) / (e - g)\r\n    },\r\n    _drawItem: function(v, e, u, o, s, r, c) {\r\n        var g = this._settings.item;\r\n        var n = parseInt(g.radius.call(this, o), 10) || 0;\r\n        var m = this._mapStart;\r\n        if (n) {\r\n            v.save();\r\n            if (g.shadow) {\r\n                v.lineWidth = 1;\r\n                v.strokeStyle = \"#bdbdbd\";\r\n                v.fillStyle = \"#bdbdbd\";\r\n                var a = [0.1, 0.2, 0.3];\r\n                for (var l = (a.length - 1); l >= 0; l--) {\r\n                    v.globalAlpha = a[l];\r\n                    v.strokeStyle = \"#d0d0d0\";\r\n                    v.beginPath();\r\n                    this._strokeChartItem(v, e, u + 2 * n / 3, n + l + 1, g.type);\r\n                    v.stroke()\r\n                }\r\n                v.beginPath();\r\n                v.globalAlpha = 0.3;\r\n                v.fillStyle = \"#bdbdbd\";\r\n                this._strokeChartItem(v, e, u + 2 * n / 3, n + 1, g.type);\r\n                v.fill()\r\n            }\r\n            v.restore();\r\n            if (g.type == \"image\" && g.src) {\r\n                this._drawImage(v, e - n, u - n, g.src, n * 2, n * 2)\r\n            } else {\r\n                v.lineWidth = g.borderWidth;\r\n                v.fillStyle = g.color.call(this, o);\r\n                v.strokeStyle = g.borderColor.call(this, o);\r\n                v.globalAlpha = g.alpha.call(this, o);\r\n                v.beginPath();\r\n                this._strokeChartItem(v, e, u, n + 1, g.type);\r\n                v.fill();\r\n                v.stroke();\r\n                v.globalAlpha = 1\r\n            }\r\n        }\r\n        if (s) {\r\n            this.canvases[r].renderTextAt(false, true, e, u - n - this._settings.labelOffset, this._settings.label.call(this, o))\r\n        }\r\n        var h = (this._settings.eventRadius || n + 1);\r\n        c.addRect(o.id, [e - h - m.x, u - h - m.y, e + h - m.x, u + h - m.y], r)\r\n    },\r\n    _drawImage: function(e, c, n, l, g, a) {\r\n        var h = document.createElement(\"img\");\r\n        h.style.display = \"none\";\r\n        h.style.width = g + \"px\";\r\n        h.style.height = a + \"px\";\r\n        document.body.appendChild(h);\r\n        h.src = l;\r\n        var m = function() {\r\n            e.drawImage(h, c, n)\r\n        }\r\n        ;\r\n        if (h.complete) {\r\n            m(h)\r\n        } else {\r\n            h.onload = m\r\n        }\r\n    },\r\n    _strokeChartItem: function(a, c, h, g, e) {\r\n        var l = [];\r\n        c = parseInt(c, 10);\r\n        h = parseInt(h, 10);\r\n        if (e && (e == \"square\" || e == \"s\")) {\r\n            g *= Math.sqrt(2) / 2;\r\n            l = [[c - g - a.lineWidth / 2, h - g], [c + g, h - g], [c + g, h + g], [c - g, h + g], [c - g, h - g]]\r\n        } else {\r\n            if (e && (e == \"diamond\" || e == \"d\")) {\r\n                var m = (a.lineWidth > 1 ? a.lineWidth * Math.sqrt(2) / 4 : 0);\r\n                l = [[c, h - g], [c + g, h], [c, h + g], [c - g, h], [c + m, h - g - m]]\r\n            } else {\r\n                if (e && (e == \"triangle\" || e == \"t\")) {\r\n                    l = [[c, h - g], [c + Math.sqrt(3) * g / 2, h + g / 2], [c - Math.sqrt(3) * g / 2, h + g / 2], [c, h - g]]\r\n                } else {\r\n                    l = [[c, h, g, 0, Math.PI * 2, true]]\r\n                }\r\n            }\r\n        }\r\n        this._path(a, l)\r\n    },\r\n    _getPointY: function(e, n, l, a) {\r\n        var m = a.minValue;\r\n        var g = a.maxValue;\r\n        var r = a.unit;\r\n        var c = a.valueFactor;\r\n        var o = this._settings.value(e);\r\n        var s = (parseFloat(o || 0) - m) * c;\r\n        if (!this._settings.yAxis) {\r\n            s += a.startValue / r\r\n        }\r\n        var h = l.y - r * s;\r\n        if (this._settings.fixOverflow && (this._settings.view == \"line\" || this._settings.view == \"area\")) {\r\n            if (o > g) {\r\n                h = {\r\n                    y: n.y,\r\n                    y0: h,\r\n                    out: \"max\"\r\n                }\r\n            } else {\r\n                if (s < 0 || o < m) {\r\n                    h = {\r\n                        y: l.y,\r\n                        y0: h,\r\n                        out: \"min\"\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (o > g) {\r\n                h = n.y\r\n            }\r\n            if (s < 0 || o < m) {\r\n                h = l.y\r\n            }\r\n        }\r\n        return h\r\n    },\r\n    _calculateLineParams: function(o, g, m, l, h) {\r\n        var c = {};\r\n        var r;\r\n        c.totalHeight = l.y - m.y;\r\n        c.cellWidth = (l.x - m.x) / ((!this._settings.offset) ? (g.length - 1) : g.length);\r\n        var e = !!this._settings.yAxis;\r\n        var a = (this._settings.view.indexOf(\"stacked\") != -1 ? this._getStackedLimits(g) : this._getLimits());\r\n        c.maxValue = a.max;\r\n        c.minValue = a.min;\r\n        if (!h) {\r\n            this._drawScales(g, m, l, c.minValue, c.maxValue, c.cellWidth)\r\n        }\r\n        if (e) {\r\n            c.maxValue = parseFloat(this._settings.yAxis.end);\r\n            c.minValue = parseFloat(this._settings.yAxis.start)\r\n        }\r\n        var n = this._getRelativeValue(c.minValue, c.maxValue);\r\n        r = n[0];\r\n        c.valueFactor = n[1];\r\n        c.unit = (r ? c.totalHeight / r : 10);\r\n        c.startValue = 0;\r\n        if (!e) {\r\n            c.startValue = 10;\r\n            if (c.unit != c.totalHeight) {\r\n                c.unit = (r ? (c.totalHeight - c.startValue) / r : 10)\r\n            }\r\n        }\r\n        return c\r\n    }\r\n};\r\ndhtmlx.chart.bar = {\r\n    pvt_render_bar: function(D, T, l, h, E, S) {\r\n        var w, H, K, o, P, x, y, c, L, A, v, O, r, Q = h.y - l.y;\r\n        r = !!this._settings.yAxis;\r\n        O = !!this._settings.xAxis;\r\n        o = this._getLimits();\r\n        P = o.max;\r\n        x = o.min;\r\n        H = (h.x - l.x) / T.length;\r\n        if (!E && !(this._settings.origin != \"auto\" && !r)) {\r\n            this._drawScales(T, l, h, x, P, H)\r\n        }\r\n        if (r) {\r\n            P = parseFloat(this._settings.yAxis.end);\r\n            x = parseFloat(this._settings.yAxis.start)\r\n        }\r\n        L = this._getRelativeValue(x, P);\r\n        y = L[0];\r\n        c = L[1];\r\n        v = (y ? Q / y : y);\r\n        if (!r && !(this._settings.origin != \"auto\" && O)) {\r\n            A = 10;\r\n            v = (y ? (Q - A) / y : A)\r\n        }\r\n        if (!E && (this._settings.origin != \"auto\" && !r) && this._settings.origin > x) {\r\n            this._drawXAxis(D, T, l, h, H, h.y - v * (this._settings.origin - x))\r\n        }\r\n        w = parseInt(this._settings.width, 10);\r\n        var N = 0;\r\n        var J = 0;\r\n        for (K = 0; K < this._series.length; K++) {\r\n            if (K == E) {\r\n                J = N\r\n            }\r\n            if (this._series[K].view == \"bar\") {\r\n                N++\r\n            }\r\n        }\r\n        var n = this._settings.seriesMargin;\r\n        var g = this._settings.seriesPadding;\r\n        if (this._series && (w * N + g + (N > 2 ? n * N : 0) > H)) {\r\n            w = H / N - g - (N > 2 ? n : 0)\r\n        }\r\n        var s = (H - w * N - n * (N - 1)) / 2;\r\n        if (this._settings.border) {\r\n            w = parseInt(w, 10);\r\n            s = parseInt(s, 10)\r\n        }\r\n        var m = (typeof this._settings.radius != \"undefined\" ? parseInt(this._settings.radius, 10) : Math.round(w / 5));\r\n        var u = false;\r\n        var a = this._settings.gradient;\r\n        if (a && typeof (a) != \"function\") {\r\n            u = a;\r\n            a = false\r\n        } else {\r\n            if (a) {\r\n                a = D.createLinearGradient(0, h.y, 0, l.y);\r\n                this._settings.gradient(a)\r\n            }\r\n        }\r\n        if (!O) {\r\n            this._drawLine(D, l.x, h.y + 0.5, h.x, h.y + 0.5, \"#000000\", 1)\r\n        }\r\n        for (K = 0; K < T.length; K++) {\r\n            var C = parseFloat(this._settings.value(T[K]) || 0);\r\n            if (isNaN(C)) {\r\n                continue\r\n            }\r\n            if (C > P) {\r\n                C = P\r\n            }\r\n            C -= x;\r\n            C *= c;\r\n            var M = l.x + s + (N > 2 ? n * J : 0) + K * H + w * J;\r\n            var e = h.y;\r\n            if (C < 0 || (this._settings.yAxis && C === 0 && !(this._settings.origin != \"auto\" && this._settings.origin > x))) {\r\n                this.canvases[E].renderTextAt(true, true, M + Math.floor(w / 2), e, this._settings.label(T[K]));\r\n                continue\r\n            }\r\n            if (!r && !(this._settings.origin != \"auto\" && O)) {\r\n                C += A / v\r\n            }\r\n            var F = a || this._settings.color.call(this, T[K]);\r\n            D.globalAlpha = this._settings.alpha.call(this, T[K]);\r\n            var I = this._drawBar(D, l, M, e, w, x, m, v, C, F, a, u);\r\n            if (u) {\r\n                this._drawBarGradient(D, M, e, w, x, m, v, C, F, u)\r\n            }\r\n            if (this._settings.border) {\r\n                this._drawBarBorder(D, M, e, w, x, m, v, C, F)\r\n            }\r\n            D.globalAlpha = 1;\r\n            if (I[0] != M) {\r\n                this.canvases[E].renderTextAt(false, true, M + Math.floor(w / 2), I[1], this._settings.label(T[K]))\r\n            } else {\r\n                this.canvases[E].renderTextAt(true, true, M + Math.floor(w / 2), I[3], this._settings.label(T[K]))\r\n            }\r\n            S.addRect(T[K].id, [M - l.x, I[3] - l.y, I[2] - l.x, I[1] - l.y], E)\r\n        }\r\n    },\r\n    _correctBarParams: function(n, h, e, l, m, o, g) {\r\n        var a = this._settings.xAxis;\r\n        var c = e;\r\n        if (!!a && this._settings.origin != \"auto\" && (this._settings.origin > g)) {\r\n            e -= (this._settings.origin - g) * m;\r\n            c = e;\r\n            l = l - (this._settings.origin - g);\r\n            if (l < 0) {\r\n                l *= (-1);\r\n                n.translate(h + o, e);\r\n                n.rotate(Math.PI);\r\n                h = 0;\r\n                e = 0\r\n            }\r\n            e -= 0.5\r\n        }\r\n        return {\r\n            value: l,\r\n            x0: h,\r\n            y0: e,\r\n            start: c\r\n        }\r\n    },\r\n    _drawBar: function(v, h, C, g, o, r, l, n, u, w, a, m) {\r\n        var x;\r\n        v.save();\r\n        v.fillStyle = w;\r\n        var s = this._correctBarParams(v, C, g, u, n, o, r);\r\n        if (n * s.value > 0) {\r\n            x = this._setBarPoints(v, s.x0, s.y0, o, l, n, s.value, (this._settings.border ? 1 : 0))\r\n        } else {\r\n            x = [s.x0, s.y0]\r\n        }\r\n        if (a && !m) {\r\n            v.lineTo(s.x0 + (this._settings.border ? 1 : 0), h.y)\r\n        }\r\n        v.fill();\r\n        v.restore();\r\n        var A = s.x0;\r\n        var y = (s.x0 != C ? C + x[0] : x[0]);\r\n        var e = (s.x0 != C ? (s.start - x[1] - s.y0) : s.y0);\r\n        var c = (s.x0 != C ? s.start - s.y0 : x[1]);\r\n        return [A, e, y, c]\r\n    },\r\n    _drawBarBorder: function(o, c, m, r, h, g, n, l, e) {\r\n        var a;\r\n        o.save();\r\n        a = this._correctBarParams(o, c, m, l, n, r, h);\r\n        this._setBorderStyles(o, e);\r\n        if (n * a.value > 0) {\r\n            this._setBarPoints(o, a.x0, a.y0, r, g, n, a.value, o.lineWidth / 2, 1)\r\n        }\r\n        o.stroke();\r\n        o.restore()\r\n    },\r\n    _drawBarGradient: function(u, g, r, v, n, m, s, o, h, c) {\r\n        u.save();\r\n        var e = this._correctBarParams(u, g, r, o, s, v, n);\r\n        var l = this._setBarGradient(u, e.x0, e.y0, e.x0 + v, e.y0 - s * e.value + 2, c, h, \"y\");\r\n        var a = this._settings.border ? 1 : 0;\r\n        u.fillStyle = l.gradient;\r\n        if (s * e.value > 0) {\r\n            this._setBarPoints(u, e.x0 + l.offset, e.y0, v - l.offset * 2, m, s, e.value, l.offset + a)\r\n        }\r\n        u.fill();\r\n        u.restore()\r\n    },\r\n    _setBarPoints: function(x, g, u, y, n, v, s, h, m) {\r\n        x.beginPath();\r\n        var c = 0;\r\n        if (n > v * s) {\r\n            var l = (n - v * s) / n;\r\n            if (l <= 1 && l >= -1) {\r\n                c = -Math.acos(l) + Math.PI / 2\r\n            }\r\n        }\r\n        x.moveTo(g + h, u);\r\n        var r = u - Math.floor(v * s) + n + (n ? 0 : h);\r\n        if (n < v * s) {\r\n            x.lineTo(g + h, r)\r\n        }\r\n        var e = g + n;\r\n        if (n && n > 0) {\r\n            x.arc(e, r, n - h, -Math.PI + c, -Math.PI / 2, false)\r\n        }\r\n        var a = g + y - n - h;\r\n        var o = r - n + (n ? h : 0);\r\n        x.lineTo(a, o);\r\n        if (n && n > 0) {\r\n            x.arc(a, r, n - h, -Math.PI / 2, 0 - c, false)\r\n        }\r\n        var w = g + y - h;\r\n        x.lineTo(w, u);\r\n        if (!m) {\r\n            x.lineTo(g + h, u)\r\n        }\r\n        return [w, o]\r\n    }\r\n};\r\ndhtmlx.chart.pie = {\r\n    pvt_render_pie: function(c, g, a, l, e, h) {\r\n        this._renderPie(c, g, a, l, 1, h, e)\r\n    },\r\n    _renderPie: function(u, H, h, g, E, F, v) {\r\n        if (!H.length) {\r\n            return\r\n        }\r\n        var w = this._getPieParameters(h, g);\r\n        var m = (this._settings.radius ? this._settings.radius : w.radius);\r\n        if (m < 0) {\r\n            return\r\n        }\r\n        var a = this._getValues(H);\r\n        var l = this._getTotalValue(a);\r\n        var n = this._getRatios(a, l);\r\n        var D = (this._settings.x ? this._settings.x : w.x);\r\n        var e = (this._settings.y ? this._settings.y : w.y);\r\n        if (E == 1 && this._settings.shadow) {\r\n            this._addShadow(u, D, e, m)\r\n        }\r\n        e = e / E;\r\n        var s = -Math.PI / 2;\r\n        var r;\r\n        var y = [];\r\n        u.scale(1, E);\r\n        if (this._settings.gradient) {\r\n            var C = (E != 1 ? D + m / 3 : D);\r\n            var c = (E != 1 ? e + m / 3 : e);\r\n            this._showRadialGradient(u, D, e, m, C, c)\r\n        }\r\n        if (this._settings.labelLines) {\r\n            this._labelMargins = this._getLabelMargins(n, m)\r\n        }\r\n        for (var A = 0; A < H.length; A++) {\r\n            if (!a[A]) {\r\n                continue\r\n            }\r\n            u.strokeStyle = (H.length == 1 ? this._settings.color.call(this, H[A]) : this._settings.lineColor.call(this, H[A]));\r\n            u.beginPath();\r\n            u.moveTo(D, e);\r\n            y.push(s);\r\n            r = -Math.PI / 2 + n[A] - 0.0001;\r\n            u.arc(D, e, m, s, r, false);\r\n            u.lineTo(D, e);\r\n            var x = this._settings.color.call(this, H[A]);\r\n            u.fillStyle = x;\r\n            u.fill();\r\n            if (this._settings.pieInnerText) {\r\n                this._drawSectorLabel(D, e, 5 * m / 6, s, r, E, this._settings.pieInnerText(H[A], l), true)\r\n            }\r\n            if (this._settings.label) {\r\n                this._drawSectorLabel(D, e, m, s, r, E, this._settings.label(H[A]), 0, (this._labelMargins ? this._labelMargins[A] : {}), u)\r\n            }\r\n            if (E != 1) {\r\n                this._createLowerSector(u, D, e, s, r, m, true);\r\n                u.fillStyle = \"#000000\";\r\n                u.globalAlpha = 0.2;\r\n                this._createLowerSector(u, D, e, s, r, m, false);\r\n                u.globalAlpha = 1;\r\n                u.fillStyle = x\r\n            }\r\n            F.addSector(H[A].id, s, r, D - h.x, e - h.y / E, m, E, v);\r\n            s = r\r\n        }\r\n        u.globalAlpha = 0.8;\r\n        var o;\r\n        if (y.length > 1) {\r\n            for (A = 0; A < y.length; A++) {\r\n                o = this._getPositionByAngle(y[A], D, e, m);\r\n                this._drawLine(u, D, e, o.x, o.y, this._settings.lineColor.call(this, H[A]), 2)\r\n            }\r\n        }\r\n        if (E == 1) {\r\n            u.lineWidth = 2;\r\n            u.strokeStyle = \"#ffffff\";\r\n            u.beginPath();\r\n            u.arc(D, e, m + 1, 0, 2 * Math.PI, false);\r\n            u.stroke()\r\n        }\r\n        u.globalAlpha = 1;\r\n        u.scale(1, 1 / E)\r\n    },\r\n    _getLabelMargins: function(v, l) {\r\n        var D, C, J, I, a = [], w = [];\r\n        var M = {\r\n            1: [0]\r\n        };\r\n        for (J = 1; J < v.length; J++) {\r\n            D = -Math.PI / 2 + (J > 1 ? (v[J - 1] - (v[J - 1] - v[J - 2]) / 2) : v[J - 1] / 2);\r\n            C = -Math.PI / 2 + v[J] - (v[J] - v[J - 1]) / 2;\r\n            var h = Math.cos(C);\r\n            var y = Math.sin(C);\r\n            var m = Math.cos(D);\r\n            var A = Math.sin(D);\r\n            var E = Math.round((l + 8) * Math.abs(Math.sin(C) - Math.sin(D)));\r\n            var s = (h < 0 ? (y < 0 ? 4 : 3) : (y < 0 ? 1 : 2));\r\n            var u = (m < 0 ? (A < 0 ? 4 : 3) : (A < 0 ? 1 : 2));\r\n            if (!M[s]) {\r\n                M[s] = []\r\n            }\r\n            M[s].push(u == s ? E : 0)\r\n        }\r\n        var F = [];\r\n        var L = 0;\r\n        for (var x in M) {\r\n            var g = 0;\r\n            var e = M[x].length;\r\n            var o = 0;\r\n            var n = 0;\r\n            if (x == 1 || x == 3) {\r\n                I = x - 1;\r\n                var K = 0;\r\n                while (I > 0) {\r\n                    if (M[I]) {\r\n                        K += M[I].length\r\n                    }\r\n                    I--\r\n                }\r\n                F[K + M[x].length - 1] = {\r\n                    y: 0,\r\n                    x: 0\r\n                };\r\n                var I = M[x].length - 2;\r\n                while (I >= 0) {\r\n                    if ((o || I) && M[x][I + 1] - o < 18) {\r\n                        o += 18 - M[x][I + 1]\r\n                    } else {\r\n                        o = 0\r\n                    }\r\n                    F[K + I] = {\r\n                        y: o * (x == 1 ? -1 : 1)\r\n                    };\r\n                    I--\r\n                }\r\n                for (var H = F.length - M[x].length; H < F.length; H++) {\r\n                    if (F[H][\"y\"] != 0) {\r\n                        n += 6;\r\n                        F[H][\"x\"] = n\r\n                    } else {\r\n                        F[H][\"x\"] = 0;\r\n                        n = 0\r\n                    }\r\n                }\r\n            } else {\r\n                var I = 1;\r\n                F.push({\r\n                    y: 0,\r\n                    x: 0\r\n                });\r\n                while (I < M[x].length) {\r\n                    if (M[x][I] - o < 18) {\r\n                        o += 18 - M[x][I]\r\n                    } else {\r\n                        o = 0\r\n                    }\r\n                    F.push({\r\n                        y: o * (x == 4 ? -1 : 1)\r\n                    });\r\n                    I++\r\n                }\r\n                for (var H = F.length - 1; H >= F.length - M[x].length; H--) {\r\n                    if (F[H][\"y\"] != 0) {\r\n                        n += 8;\r\n                        F[H][\"x\"] = n\r\n                    } else {\r\n                        n = 0;\r\n                        F[H][\"x\"] = 0\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return F\r\n    },\r\n    _getValues: function(e) {\r\n        var a = [];\r\n        for (var c = 0; c < e.length; c++) {\r\n            a.push(parseFloat(this._settings.value(e[c]) || 0))\r\n        }\r\n        return a\r\n    },\r\n    _getTotalValue: function(a) {\r\n        var e = 0;\r\n        for (var c = 0; c < a.length; c++) {\r\n            e += a[c]\r\n        }\r\n        return e\r\n    },\r\n    _getRatios: function(c, a) {\r\n        var l;\r\n        var h = [];\r\n        var g = 0;\r\n        a = a || this._getTotalValue(c);\r\n        for (var e = 0; e < c.length; e++) {\r\n            l = c[e];\r\n            h[e] = Math.PI * 2 * (a ? ((l + g) / a) : (1 / c.length));\r\n            g += l\r\n        }\r\n        return h\r\n    },\r\n    _getPieParameters: function(m, h) {\r\n        var g = h.x - m.x;\r\n        var c = h.y - m.y;\r\n        var e = m.x + g / 2;\r\n        var l = m.y + c / 2;\r\n        var a = Math.min(g / 2, c / 2);\r\n        return {\r\n            x: e,\r\n            y: l,\r\n            radius: a\r\n        }\r\n    },\r\n    _createLowerSector: function(g, h, m, e, a, l, c) {\r\n        g.lineWidth = 1;\r\n        if (!((e <= 0 && a >= 0) || (e >= 0 && a <= Math.PI) || (Math.abs(e - Math.PI) > 0.003 && e <= Math.PI && a >= Math.PI))) {\r\n            return\r\n        }\r\n        if (e <= 0 && a >= 0) {\r\n            e = 0;\r\n            c = false;\r\n            this._drawSectorLine(g, h, m, l, e, a)\r\n        }\r\n        if (e <= Math.PI && a >= Math.PI) {\r\n            a = Math.PI;\r\n            c = false;\r\n            this._drawSectorLine(g, h, m, l, e, a)\r\n        }\r\n        var n = (this._settings.height || Math.floor(l / 4)) / this._settings.cant;\r\n        g.beginPath();\r\n        g.arc(h, m, l, e, a, false);\r\n        g.lineTo(h + l * Math.cos(a), m + l * Math.sin(a) + n);\r\n        g.arc(h, m + n, l, a, e, true);\r\n        g.lineTo(h + l * Math.cos(e), m + l * Math.sin(e));\r\n        g.fill();\r\n        if (c) {\r\n            g.stroke()\r\n        }\r\n    },\r\n    _drawSectorLine: function(e, g, l, h, c, a) {\r\n        e.beginPath();\r\n        e.arc(g, l, h, c, a, false);\r\n        e.stroke()\r\n    },\r\n    _addShadow: function(c, a, l, g) {\r\n        c.globalAlpha = 0.5;\r\n        var h = [\"#c4c4c4\", \"#c6c6c6\", \"#cacaca\", \"#dcdcdc\", \"#dddddd\", \"#e0e0e0\", \"#eeeeee\", \"#f5f5f5\", \"#f8f8f8\"];\r\n        for (var e = h.length - 1; e > -1; e--) {\r\n            c.beginPath();\r\n            c.fillStyle = h[e];\r\n            c.arc(a + 1, l + 1, g + e, 0, Math.PI * 2, true);\r\n            c.fill()\r\n        }\r\n        c.globalAlpha = 1\r\n    },\r\n    _getGrayGradient: function(a) {\r\n        a.addColorStop(0, \"#ffffff\");\r\n        a.addColorStop(0.7, \"#7a7a7a\");\r\n        a.addColorStop(1, \"#000000\");\r\n        return a\r\n    },\r\n    _showRadialGradient: function(e, c, m, a, g, h) {\r\n        e.beginPath();\r\n        var l;\r\n        if (typeof this._settings.gradient != \"function\") {\r\n            l = e.createRadialGradient(g, h, a / 4, c, m, a);\r\n            l = this._getGrayGradient(l)\r\n        } else {\r\n            l = this._settings.gradient(l)\r\n        }\r\n        e.fillStyle = l;\r\n        e.arc(c, m, a, 0, Math.PI * 2, true);\r\n        e.fill();\r\n        e.globalAlpha = 0.7\r\n    },\r\n    _drawSectorLabel: function(N, g, m, F, E, O, C, a, D, I) {\r\n        var A = this.canvases[0].renderText(0, 0, C, 0, 1);\r\n        if (!A) {\r\n            return\r\n        }\r\n        var P = A.scrollWidth;\r\n        A.style.width = P + \"px\";\r\n        if (P > N) {\r\n            P = N\r\n        }\r\n        var H = (E - F < 0.2 ? 4 : 8);\r\n        if (a) {\r\n            H = P / 1.8\r\n        }\r\n        var l = F + (E - F) / 2;\r\n        var h = m;\r\n        m = (a ? 5 * m / 6 : m + this._settings.labelOffset);\r\n        m = m - (H - 8) / 2;\r\n        var s = -H;\r\n        var r = -8;\r\n        var J = \"right\";\r\n        if (l >= Math.PI / 2 && l < Math.PI || l <= 3 * Math.PI / 2 && l >= Math.PI) {\r\n            s = -P - s;\r\n            J = \"left\"\r\n        }\r\n        var n = 0;\r\n        if (!a && O < 1 && (l > 0 && l < Math.PI)) {\r\n            n = (this._settings.height || Math.floor(m / 4)) / O\r\n        }\r\n        var u = (g + Math.floor(m + n) * Math.sin(l)) * O + r;\r\n        var v = N + Math.floor(m + H / 2) * Math.cos(l) + s;\r\n        var o = (E < Math.PI / 2 + 0.01);\r\n        var w = (F < Math.PI / 2);\r\n        if (w && o) {\r\n            v = Math.max(v, N + 3)\r\n        } else {\r\n            if (!w && !o) {\r\n                v = Math.min(v, N - P)\r\n            } else {\r\n                if (!a && !this._settings.labelLines && (l >= Math.PI / 2 && l < Math.PI || l <= 3 * Math.PI / 2 && l >= Math.PI)) {\r\n                    v += P / 3\r\n                }\r\n            }\r\n        }\r\n        if (this._settings.labelLines && !a) {\r\n            var K = Math.abs((Math.abs(D || 0) + Math.abs(h * Math.sin(l))) / Math.sin(l));\r\n            if (D.y) {\r\n                u += D.y\r\n            }\r\n            if (J == \"left\") {\r\n                v -= D.x\r\n            } else {\r\n                v += D.x\r\n            }\r\n            I.beginPath();\r\n            I.strokeStyle = \"#555\";\r\n            var M = N + h * Math.cos(l);\r\n            var e = g + h * Math.sin(l);\r\n            I.moveTo(M, e);\r\n            var L = v - (J == \"left\" ? s - 8 : 2);\r\n            var c = u;\r\n            if (J == \"left\" && L > M) {\r\n                L = M - Math.abs(c - e + 16) / Math.tan(l - Math.PI);\r\n                c = c + 16;\r\n                if (l < Math.PI) {\r\n                    c -= 8\r\n                }\r\n            } else {\r\n                c += 8\r\n            }\r\n            I.lineTo(L, c);\r\n            I.lineTo(L + (J == \"left\" ? -5 : 5), c);\r\n            I.stroke();\r\n            u = c - 8;\r\n            v = L + s + (J == \"left\" ? -15 : 15)\r\n        }\r\n        A.style.top = u + \"px\";\r\n        A.style.left = v + \"px\";\r\n        A.style.width = P + \"px\";\r\n        A.style.textAlign = J;\r\n        A.style.whiteSpace = \"nowrap\"\r\n    }\r\n};\r\ndhtmlx.chart.pie3D = {\r\n    pvt_render_pie3D: function(c, g, a, l, e, h) {\r\n        this._renderPie(c, g, a, l, this._settings.cant, h)\r\n    }\r\n};\r\ndhtmlx.chart.donut = {\r\n    pvt_render_donut: function(u, h, r, o, m, c) {\r\n        if (!h.length) {\r\n            return\r\n        }\r\n        this._renderPie(u, h, r, o, 1, c);\r\n        var g = this._settings;\r\n        var l = this._getPieParameters(r, o);\r\n        var a = (g.radius ? g.radius : l.radius);\r\n        var n = ((g.innerRadius && (g.innerRadius < a)) ? g.innerRadius : a / 3);\r\n        var e = (g.x ? g.x : l.x);\r\n        var s = (g.y ? g.y : l.y);\r\n        u.fillStyle = \"#ffffff\";\r\n        u.beginPath();\r\n        u.arc(e, s, n, 0, Math.PI * 2, true);\r\n        u.fill()\r\n    }\r\n};\r\ndhtmlx.DataDriver.dhtmlxgrid = {\r\n    _grid_getter: \"_get_cell_value\",\r\n    toObject: function(a) {\r\n        this._grid = a;\r\n        return a\r\n    },\r\n    getRecords: function(a) {\r\n        return a.rowsBuffer\r\n    },\r\n    getDetails: function(e) {\r\n        var a = {};\r\n        for (var c = 0; c < this._grid.getColumnsNum(); c++) {\r\n            a[\"data\" + c] = this._grid[this._grid_getter](e, c)\r\n        }\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    }\r\n};\r\ndhtmlx.ui.Canvas = function(c, e, h) {\r\n    this._canvas_labels = [];\r\n    this._canvas_name = e;\r\n    this._obj = c;\r\n    var g = c.offsetWidth * (window.devicePixelRatio || 1);\r\n    var a = c.offsetHeight * (window.devicePixelRatio || 1);\r\n    var h = h || \"\";\r\n    h += \";width:\" + c.offsetWidth + \"px;height:\" + c.offsetHeight + \"px;\";\r\n    this._prepareCanvas(e, h, g, a)\r\n}\r\n;\r\ndhtmlx.ui.Canvas.prototype = {\r\n    _prepareCanvas: function(c, g, e, a) {\r\n        this._canvas = dhtmlx.html.create(\"canvas\", {\r\n            width: e,\r\n            height: a,\r\n            canvas_id: c,\r\n            style: (g || \"\")\r\n        });\r\n        this._obj.appendChild(this._canvas);\r\n        if (!this._canvas.getContext) {\r\n            if (dhtmlx._isIE) {\r\n                dhtmlx.require(\"thirdparty/excanvas/excanvas.js\");\r\n                G_vmlCanvasManager.init_(document);\r\n                G_vmlCanvasManager.initElement(this._canvas)\r\n            } else {\r\n                dhtmlx.error(\"Canvas is not supported in the current browser\")\r\n            }\r\n        }\r\n        return this._canvas\r\n    },\r\n    getCanvas: function(c) {\r\n        var a = (this._canvas || this._prepareCanvas()).getContext(c || \"2d\");\r\n        if (!this._webixDevicePixelRatio) {\r\n            this._webixDevicePixelRatio = true;\r\n            a.scale(window.devicePixelRatio || 1, window.devicePixelRatio || 1)\r\n        }\r\n        return a\r\n    },\r\n    _resizeCanvas: function() {\r\n        if (this._canvas) {\r\n            var a = this._canvas.parentNode.offsetWidth;\r\n            var c = this._canvas.parentNode.offsetHeight;\r\n            this._canvas.setAttribute(\"width\", a * (window.devicePixelRatio || 1));\r\n            this._canvas.setAttribute(\"height\", c * (window.devicePixelRatio || 1));\r\n            this._canvas.style.width = a + \"px\";\r\n            this._canvas.style.height = c + \"px\";\r\n            this._webixDevicePixelRatio = false\r\n        }\r\n    },\r\n    renderText: function(a, l, h, g, c) {\r\n        if (!h) {\r\n            return\r\n        }\r\n        var e = dhtmlx.html.create(\"DIV\", {\r\n            \"class\": \"dhx_canvas_text\" + (g ? (\" \" + g) : \"\"),\r\n            style: \"left:\" + a + \"px; top:\" + l + \"px;\"\r\n        }, h);\r\n        this._obj.appendChild(e);\r\n        this._canvas_labels.push(e);\r\n        if (c) {\r\n            e.style.width = c + \"px\"\r\n        }\r\n        return e\r\n    },\r\n    renderTextAt: function(h, o, a, n, g, m, e) {\r\n        var l = this.renderText.call(this, a, n, g, m, e);\r\n        if (l) {\r\n            if (h) {\r\n                if (h == \"middle\") {\r\n                    l.style.top = parseInt(n - l.offsetHeight / 2, 10) + \"px\"\r\n                } else {\r\n                    l.style.top = n - l.offsetHeight + \"px\"\r\n                }\r\n            }\r\n            if (o) {\r\n                if (o == \"left\") {\r\n                    l.style.left = a - l.offsetWidth + \"px\"\r\n                } else {\r\n                    l.style.left = parseInt(a - l.offsetWidth / 2, 10) + \"px\"\r\n                }\r\n            }\r\n        }\r\n        return l\r\n    },\r\n    clearCanvas: function(a) {\r\n        var c = [], e;\r\n        for (e = 0; e < this._canvas_labels.length; e++) {\r\n            this._obj.removeChild(this._canvas_labels[e])\r\n        }\r\n        this._canvas_labels = [];\r\n        if (!a && this._obj._htmlmap) {\r\n            c = this._getMapAreas();\r\n            while (c.length) {\r\n                c[0].parentNode.removeChild(c[0]);\r\n                c.splice(0, 1)\r\n            }\r\n            c = null ;\r\n            if (!this._obj._htmlmap.getElementsByTagName(\"AREA\").length) {\r\n                this._obj._htmlmap.parentNode.removeChild(this._obj._htmlmap);\r\n                this._obj._htmlmap = null \r\n            }\r\n        }\r\n        this.getCanvas().clearRect(0, 0, this._canvas.width, this._canvas.height)\r\n    },\r\n    toggleCanvas: function() {\r\n        this._toggleCanvas(this._canvas.style.display == \"none\")\r\n    },\r\n    showCanvas: function() {\r\n        this._toggleCanvas(true)\r\n    },\r\n    hideCanvas: function() {\r\n        this._toggleCanvas(false)\r\n    },\r\n    _toggleCanvas: function(a) {\r\n        var c, e;\r\n        for (e = 0; e < this._canvas_labels.length; e++) {\r\n            this._canvas_labels[e].style.display = (a ? \"\" : \"none\")\r\n        }\r\n        if (this._obj._htmlmap) {\r\n            c = this._getMapAreas();\r\n            for (e = 0; e < c.length; e++) {\r\n                if (a) {\r\n                    c[e].removeAttribute(\"disabled\")\r\n                } else {\r\n                    c[e].setAttribute(\"disabled\", \"true\")\r\n                }\r\n            }\r\n        }\r\n        this._canvas.style.display = (a ? \"\" : \"none\")\r\n    },\r\n    _getMapAreas: function() {\r\n        var e = [], a, c;\r\n        a = this._obj._htmlmap.getElementsByTagName(\"AREA\");\r\n        for (c = 0; c < a.length; c++) {\r\n            if (a[c].getAttribute(\"userdata\") == this._canvas_name) {\r\n                e.push(a[c])\r\n            }\r\n        }\r\n        return e\r\n    }\r\n};\r\ndhtmlXChart = function(a) {\r\n    this.name = \"Chart\";\r\n    if (dhtmlx.assert_enabled()) {\r\n        this._assert()\r\n    }\r\n    dhtmlx.extend(this, dhtmlx.Settings);\r\n    this._parseContainer(a, \"dhx_chart\");\r\n    dhtmlx.extend(this, dhtmlx.AtomDataLoader);\r\n    dhtmlx.extend(this, dhtmlx.DataLoader);\r\n    this.data.provideApi(this, true);\r\n    dhtmlx.extend(this, dhtmlx.EventSystem);\r\n    dhtmlx.extend(this, dhtmlx.MouseEvents);\r\n    dhtmlx.extend(this, dhtmlx.Destruction);\r\n    dhtmlx.extend(this, dhtmlx.Group);\r\n    dhtmlx.extend(this, dhtmlx.AutoTooltip);\r\n    for (var c in dhtmlx.chart) {\r\n        dhtmlx.extend(this, dhtmlx.chart[c])\r\n    }\r\n    if (a.preset) {\r\n        this.definePreset(a)\r\n    }\r\n    this._parseSettings(a, this.defaults);\r\n    this._series = [this._settings];\r\n    this.data.attachEvent(\"onStoreUpdated\", dhtmlx.bind(function() {\r\n        this.render()\r\n    }, this));\r\n    this.attachEvent(\"onLocateData\", this._switchSerie)\r\n}\r\n;\r\ndhtmlXChart.prototype = {\r\n    _id: \"dhx_area_id\",\r\n    on_click: {\r\n        dhx_chart_legend_item: function(m, n, l) {\r\n            var h = l.getAttribute(\"series_id\");\r\n            if (this.callEvent(\"onLegendClick\", [m, h, l])) {\r\n                var g = this._settings;\r\n                var c = g.legend.values;\r\n                var a = (c && (typeof c[h].toggle != \"undefined\")) ? c[h].toggle : g.legend.toggle;\r\n                if ((typeof h != \"undefined\") && this._series.length > 1) {\r\n                    if (a) {\r\n                        if (l.className.indexOf(\"hidden\") != -1) {\r\n                            this.showSeries(h)\r\n                        } else {\r\n                            this.hideSeries(h)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    on_dblclick: {},\r\n    on_mouse_move: {},\r\n    bind: function() {\r\n        dhx.BaseBind.legacyBind.apply(this, arguments)\r\n    },\r\n    sync: function() {\r\n        dhx.BaseBind.legacySync.apply(this, arguments)\r\n    },\r\n    resize: function() {\r\n        for (var a in this.canvases) {\r\n            this.canvases[a]._resizeCanvas()\r\n        }\r\n        this.render()\r\n    },\r\n    view_setter: function(a) {\r\n        if (!dhtmlx.chart[a]) {\r\n            dhtmlx.error(\"Chart type extension is not loaded: \" + a)\r\n        }\r\n        if (typeof this._settings.offset == \"undefined\") {\r\n            this._settings.offset = !(a == \"area\" || a == \"stackedArea\")\r\n        }\r\n        if (a == \"radar\" && !this._settings.yAxis) {\r\n            this.define(\"yAxis\", {})\r\n        }\r\n        if (a == \"scatter\") {\r\n            if (!this._settings.yAxis) {\r\n                this.define(\"yAxis\", {})\r\n            }\r\n            if (!this._settings.xAxis) {\r\n                this.define(\"xAxis\", {})\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    clearCanvas: function() {\r\n        if (this.canvases && typeof this.canvases == \"object\") {\r\n            for (var a in this.canvases) {\r\n                this.canvases[a].clearCanvas()\r\n            }\r\n        }\r\n    },\r\n    render: function() {\r\n        var e, c, g, h, a;\r\n        if (!this.callEvent(\"onBeforeRender\", [this.data])) {\r\n            return\r\n        }\r\n        if (this.canvases && typeof this.canvases == \"object\") {\r\n            for (c in this.canvases) {\r\n                this.canvases[c].clearCanvas()\r\n            }\r\n        } else {\r\n            this.canvases = {}\r\n        }\r\n        if (this._settings.legend) {\r\n            if (!this.canvases.legend) {\r\n                this.canvases.legend = new dhtmlx.ui.Canvas(this._obj,\"legend\")\r\n            }\r\n            this._drawLegend(this.data.getRange(), this._obj.offsetWidth)\r\n        }\r\n        e = this._getChartBounds(this._obj.offsetWidth, this._obj.offsetHeight);\r\n        this._map = h = new dhtmlx.ui.Map(this._id);\r\n        a = this._settings;\r\n        g = this._getChartData();\r\n        for (c = 0; c < this._series.length; c++) {\r\n            this._settings = this._series[c];\r\n            if (!this.canvases[c]) {\r\n                this.canvases[c] = new dhtmlx.ui.Canvas(this._obj,c,\"z-index:\" + (2 + c))\r\n            }\r\n            this[\"pvt_render_\" + this._settings.view](this.canvases[c].getCanvas(), g, e.start, e.end, c, h)\r\n        }\r\n        h.render(this._obj);\r\n        this._obj.lastChild.style.zIndex = 1000;\r\n        this._applyBounds(this._obj.lastChild, e);\r\n        this.callEvent(\"onAfterRender\", []);\r\n        this._settings = a\r\n    },\r\n    _applyBounds: function(e, c) {\r\n        var a = {};\r\n        a.left = c.start.x;\r\n        a.top = c.start.y;\r\n        a.width = c.end.x - c.start.x;\r\n        a.height = c.end.y - c.start.y;\r\n        for (var g in a) {\r\n            e.style[g] = a[g] + \"px\"\r\n        }\r\n    },\r\n    _getChartData: function() {\r\n        var g, m, e, h, l, r, a, n, o, c;\r\n        h = this.data.getRange();\r\n        g = (this._settings.view.toLowerCase().indexOf(\"barh\") != -1 ? \"yAxis\" : \"xAxis\");\r\n        m = this._settings[g];\r\n        if (m && m.units && (typeof m.units == \"object\")) {\r\n            e = m.units;\r\n            n = [];\r\n            if (typeof e.start != \"undefined\" && typeof e.end != \"undefined\" && typeof e.next != \"undefined\") {\r\n                a = e.start;\r\n                while (a <= e.end) {\r\n                    n.push(a);\r\n                    a = e.next.call(this, a)\r\n                }\r\n            } else {\r\n                if (Object.prototype.toString.call(e) === \"[object Array]\") {\r\n                    n = e\r\n                }\r\n            }\r\n            r = [];\r\n            if (n.length) {\r\n                o = m.value;\r\n                c = {};\r\n                for (l = 0; l < h.length; l++) {\r\n                    c[o(h[l])] = l\r\n                }\r\n                for (l = 0; l < n.length; l++) {\r\n                    if (typeof c[n[l]] != \"undefined\") {\r\n                        h[c[n[l]]].$unit = n[l];\r\n                        r.push(h[c[n[l]]])\r\n                    } else {\r\n                        r.push({\r\n                            $unit: n[l]\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n            return r\r\n        }\r\n        return h\r\n    },\r\n    value_setter: dhtmlx.Template.obj_setter,\r\n    xValue_setter: dhtmlx.Template.obj_setter,\r\n    yValue_setter: function(a) {\r\n        this.define(\"value\", a)\r\n    },\r\n    alpha_setter: dhtmlx.Template.obj_setter,\r\n    label_setter: dhtmlx.Template.obj_setter,\r\n    lineColor_setter: dhtmlx.Template.obj_setter,\r\n    borderColor_setter: dhtmlx.Template.obj_setter,\r\n    pieInnerText_setter: dhtmlx.Template.obj_setter,\r\n    gradient_setter: function(a) {\r\n        if ((typeof (a) != \"function\") && a && (a === true)) {\r\n            a = \"light\"\r\n        }\r\n        return a\r\n    },\r\n    colormap: {\r\n        RAINBOW: function(a) {\r\n            var c = Math.floor(this.indexById(a.id) / this.dataCount() * 1536);\r\n            if (c == 1536) {\r\n                c -= 1\r\n            }\r\n            return this._rainbow[Math.floor(c / 256)](c % 256)\r\n        }\r\n    },\r\n    color_setter: function(a) {\r\n        return this.colormap[a] || dhtmlx.Template.obj_setter(a)\r\n    },\r\n    fill_setter: function(a) {\r\n        return ( (!a || a == 0) ? false : dhtmlx.Template.obj_setter(a)) \r\n    },\r\n    definePreset: function(a) {\r\n        this.define(\"preset\", a.preset);\r\n        delete a.preset\r\n    },\r\n    preset_setter: function(h) {\r\n        var e, c, g;\r\n        this.defaults = dhtmlx.extend({}, this.defaults);\r\n        if (typeof dhtmlx.presets.chart[h] == \"object\") {\r\n            g = dhtmlx.presets.chart[h];\r\n            for (e in g) {\r\n                if (typeof g[e] == \"object\") {\r\n                    if (!this.defaults[e] || typeof this.defaults[e] != \"object\") {\r\n                        this.defaults[e] = dhtmlx.extend({}, g[e])\r\n                    } else {\r\n                        this.defaults[e] = dhtmlx.extend({}, this.defaults[e]);\r\n                        for (c in g[e]) {\r\n                            this.defaults[e][c] = g[e][c]\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.defaults[e] = g[e]\r\n                }\r\n            }\r\n            return h\r\n        }\r\n        return false\r\n    },\r\n    legend_setter: function(a) {\r\n        if (!a) {\r\n            if (this.legendObj) {\r\n                this.legendObj.innerHTML = \"\";\r\n                this.legendObj = null \r\n            }\r\n            return false\r\n        }\r\n        if (typeof (a) != \"object\") {\r\n            a = {\r\n                template: a\r\n            }\r\n        }\r\n        this._mergeSettings(a, {\r\n            width: 150,\r\n            height: 18,\r\n            layout: \"y\",\r\n            align: \"left\",\r\n            valign: \"bottom\",\r\n            template: \"\",\r\n            toggle: (this._settings.view.toLowerCase().indexOf(\"stacked\") != -1 ? \"\" : \"hide\"),\r\n            marker: {\r\n                type: \"square\",\r\n                width: 15,\r\n                height: 15,\r\n                radius: 3\r\n            },\r\n            margin: 4,\r\n            padding: 3\r\n        });\r\n        a.template = dhtmlx.Template.setter(a.template);\r\n        return a\r\n    },\r\n    defaults: {\r\n        color: \"RAINBOW\",\r\n        alpha: \"1\",\r\n        label: false,\r\n        value: \"{obj.value}\",\r\n        padding: {},\r\n        view: \"pie\",\r\n        lineColor: \"#ffffff\",\r\n        cant: 0.5,\r\n        width: 30,\r\n        labelWidth: 100,\r\n        line: {\r\n            width: 2,\r\n            color: \"#1293f8\"\r\n        },\r\n        seriesMargin: 1,\r\n        seriesPadding: 4,\r\n        item: {\r\n            radius: 3,\r\n            borderColor: \"#636363\",\r\n            borderWidth: 1,\r\n            color: \"#ffffff\",\r\n            alpha: 1,\r\n            type: \"r\",\r\n            shadow: false\r\n        },\r\n        shadow: true,\r\n        gradient: false,\r\n        border: true,\r\n        labelOffset: 20,\r\n        origin: \"auto\"\r\n    },\r\n    item_setter: function(a) {\r\n        if (typeof (a) != \"object\") {\r\n            a = {\r\n                color: a,\r\n                borderColor: a\r\n            }\r\n        }\r\n        this._mergeSettings(a, dhtmlx.extend({}, this.defaults.item));\r\n        var e = [\"alpha\", \"borderColor\", \"color\", \"radius\"];\r\n        for (var c = 0; c < e.length; c++) {\r\n            a[e[c]] = dhtmlx.Template.setter(a[e[c]])\r\n        }\r\n        return a\r\n    },\r\n    line_setter: function(a) {\r\n        if (typeof (a) != \"object\") {\r\n            a = {\r\n                color: a\r\n            }\r\n        }\r\n        dhtmlx.extend(this.defaults.line, a);\r\n        a = dhtmlx.extend({}, this.defaults.line);\r\n        a.color = dhtmlx.Template.setter(a.color);\r\n        return a\r\n    },\r\n    padding_setter: function(a) {\r\n        if (typeof (a) != \"object\") {\r\n            a = {\r\n                left: a,\r\n                right: a,\r\n                top: a,\r\n                bottom: a\r\n            }\r\n        }\r\n        this._mergeSettings(a, {\r\n            left: 50,\r\n            right: 20,\r\n            top: 35,\r\n            bottom: 40\r\n        });\r\n        return a\r\n    },\r\n    xAxis_setter: function(a) {\r\n        if (!a) {\r\n            return false\r\n        }\r\n        if (typeof (a) != \"object\") {\r\n            a = {\r\n                template: a\r\n            }\r\n        }\r\n        if (!a.value) {\r\n            a.value = a.template\r\n        }\r\n        this._mergeSettings(a, {\r\n            title: \"\",\r\n            color: \"#000000\",\r\n            lineColor: \"#cfcfcf\",\r\n            template: \"{obj}\",\r\n            value: \"{obj}\",\r\n            lines: true\r\n        });\r\n        var c = [\"lineColor\", \"template\", \"lines\", \"value\"];\r\n        this._converToTemplate(c, a);\r\n        this._configXAxis = dhtmlx.extend({}, a);\r\n        return a\r\n    },\r\n    yAxis_setter: function(a) {\r\n        this._mergeSettings(a, {\r\n            title: \"\",\r\n            color: \"#000000\",\r\n            lineColor: \"#cfcfcf\",\r\n            template: \"{obj}\",\r\n            lines: true,\r\n            bg: \"#ffffff\"\r\n        });\r\n        var c = [\"lineColor\", \"template\", \"lines\", \"bg\"];\r\n        this._converToTemplate(c, a);\r\n        this._configYAxis = dhtmlx.extend({}, a);\r\n        return a\r\n    },\r\n    _converToTemplate: function(a, c) {\r\n        for (var e = 0; e < a.length; e++) {\r\n            c[a[e]] = dhtmlx.Template.setter(c[a[e]])\r\n        }\r\n    },\r\n    _drawScales: function(h, g, e, m, a, c) {\r\n        var l = 0;\r\n        if (this._settings.yAxis) {\r\n            if (!this.canvases.y) {\r\n                this.canvases.y = new dhtmlx.ui.Canvas(this._obj,\"axis_y\")\r\n            }\r\n            l = this._drawYAxis(this.canvases.y.getCanvas(), h, g, e, m, a)\r\n        }\r\n        if (this._settings.xAxis) {\r\n            if (!this.canvases.x) {\r\n                this.canvases.x = new dhtmlx.ui.Canvas(this._obj,\"axis_x\")\r\n            }\r\n            this._drawXAxis(this.canvases.x.getCanvas(), h, g, e, c, l)\r\n        }\r\n        return l\r\n    },\r\n    _drawXAxis: function(v, l, s, r, g, o) {\r\n        var e = s.x - 0.5;\r\n        var u = parseInt((o ? o : r.y), 10) + 0.5;\r\n        var c = r.x;\r\n        var m;\r\n        var a = true;\r\n        for (var h = 0; h < l.length; h++) {\r\n            if (this._settings.offset === true) {\r\n                m = e + g / 2 + h * g\r\n            } else {\r\n                m = (h == l.length - 1) ? r.x : e + h * g;\r\n                a = !!h\r\n            }\r\n            m = Math.ceil(m) - 0.5;\r\n            var n = ((this._settings.origin != \"auto\") && (this._settings.view == \"bar\") && (parseFloat(this._settings.value(l[h])) < this._settings.origin));\r\n            this._drawXAxisLabel(m, u, l[h], a, n);\r\n            if ((this._settings.offset || h) && this._settings.xAxis.lines.call(this, l[h])) {\r\n                this._drawXAxisLine(v, m, r.y, s.y, l[h])\r\n            }\r\n        }\r\n        this.canvases.x.renderTextAt(true, false, e, r.y + this._settings.padding.bottom - 3, this._settings.xAxis.title, \"dhx_axis_title_x\", r.x - s.x);\r\n        this._drawLine(v, e, u, c, u, this._settings.xAxis.color, 1);\r\n        if (!this._settings.xAxis.lines.call(this, {}) || !this._settings.offset) {\r\n            return\r\n        }\r\n        this._drawLine(v, c + 0.5, r.y, c + 0.5, s.y + 0.5, this._settings.xAxis.color, 0.2)\r\n    },\r\n    _drawYAxis: function(x, E, l, h, n, m) {\r\n        var o;\r\n        var v = {};\r\n        if (!this._settings.yAxis) {\r\n            return\r\n        }\r\n        var A = l.x - 0.5;\r\n        var g = h.y;\r\n        var e = l.y;\r\n        var w = h.y;\r\n        if (this._settings.yAxis.step) {\r\n            o = parseFloat(this._settings.yAxis.step)\r\n        }\r\n        if (typeof this._configYAxis.step == \"undefined\" || typeof this._configYAxis.start == \"undefined\" || typeof this._configYAxis.end == \"undefined\") {\r\n            v = this._calculateScale(n, m);\r\n            n = v.start;\r\n            m = v.end;\r\n            o = v.step;\r\n            this._settings.yAxis.end = m;\r\n            this._settings.yAxis.start = n\r\n        }\r\n        this._setYAxisTitle(l, h);\r\n        if (o === 0) {\r\n            m = n;\r\n            o = 1\r\n        }\r\n        var a = (m == n ? g - e : (g - e) * o / (m - n));\r\n        var C = 0;\r\n        for (var y = n; y <= m; y += o) {\r\n            if (v.fixNum) {\r\n                y = parseFloat((new Number(y)).toFixed(v.fixNum))\r\n            }\r\n            var D = Math.floor(g - C * a) + 0.5;\r\n            if (!(y == n && this._settings.origin == \"auto\") && this._settings.yAxis.lines.call(this, y)) {\r\n                this._drawLine(x, A, D, h.x, D, this._settings.yAxis.lineColor.call(this, y), 1)\r\n            }\r\n            if (y == this._settings.origin) {\r\n                w = D\r\n            }\r\n            var r = y;\r\n            if (o < 1) {\r\n                var s = Math.min(this._log10(o), (n <= 0 ? 0 : this._log10(n)));\r\n                var u = Math.pow(10, -s);\r\n                r = Math.round(y * u) / u;\r\n                y = r\r\n            }\r\n            this.canvases.y.renderText(0, D - 5, this._settings.yAxis.template(r.toString()), \"dhx_axis_item_y\", l.x - 5);\r\n            C++\r\n        }\r\n        this._drawLine(x, A, g + 1, A, e, this._settings.yAxis.color, 1);\r\n        return w\r\n    },\r\n    _setYAxisTitle: function(e, c) {\r\n        var a = \"dhx_axis_title_y\" + (dhtmlx._isIE && dhtmlx._isIE != 9 ? \" dhx_ie_filter\" : \"\");\r\n        var g = this.canvases.y.renderTextAt(\"middle\", false, 0, parseInt((c.y - e.y) / 2 + e.y, 10), this._settings.yAxis.title, a);\r\n        if (g) {\r\n            g.style.left = (dhtmlx.env.transform ? (g.offsetHeight - g.offsetWidth) / 2 : 0) + \"px\"\r\n        }\r\n    },\r\n    _calculateScale: function(r, c) {\r\n        if (this._settings.origin != \"auto\" && this._settings.origin < r) {\r\n            r = this._settings.origin\r\n        }\r\n        var h, g, m;\r\n        h = ((c - r) / 8) || 1;\r\n        var e = Math.floor(this._log10(h));\r\n        var a = Math.pow(10, e);\r\n        var l = h / a;\r\n        l = (l > 5 ? 10 : 5);\r\n        h = parseInt(l, 10) * a;\r\n        if (h > Math.abs(r)) {\r\n            g = (r < 0 ? -h : 0)\r\n        } else {\r\n            var s = Math.abs(r);\r\n            var o = Math.floor(this._log10(s));\r\n            var n = s / Math.pow(10, o);\r\n            g = Math.ceil(n * 10) / 10 * Math.pow(10, o) - h;\r\n            if (s > 1 && h > 0.1) {\r\n                g = Math.ceil(g)\r\n            }\r\n            while (r < 0 ? g <= r : g >= r) {\r\n                g -= h\r\n            }\r\n            if (r < 0) {\r\n                g = -g - 2 * h\r\n            }\r\n        }\r\n        m = g;\r\n        while (m < c) {\r\n            m += h;\r\n            m = parseFloat((new Number(m)).toFixed(Math.abs(e)))\r\n        }\r\n        return {\r\n            start: g,\r\n            end: m,\r\n            step: h,\r\n            fixNum: Math.abs(e)\r\n        }\r\n    },\r\n    _getLimits: function(c, m) {\r\n        var n, l;\r\n        var h = ((arguments.length && c == \"h\") ? this._configXAxis : this._configYAxis);\r\n        m = m || \"value\";\r\n        if (h && (typeof h.end != \"undefined\") && (typeof h.start != \"undefined\") && h.step) {\r\n            n = parseFloat(h.end);\r\n            l = parseFloat(h.start)\r\n        } else {\r\n            n = this.max(this._series[0][m]);\r\n            l = (h && (typeof h.start != \"undefined\")) ? parseFloat(h.start) : this.min(this._series[0][m]);\r\n            if (this._series.length > 1) {\r\n                for (var g = 1; g < this._series.length; g++) {\r\n                    var a = this.max(this._series[g][m]);\r\n                    var e = this.min(this._series[g][m]);\r\n                    if (a > n) {\r\n                        n = a\r\n                    }\r\n                    if (e < l) {\r\n                        l = e\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            max: n,\r\n            min: l\r\n        }\r\n    },\r\n    _log10: function(c) {\r\n        var a = \"log\";\r\n        return Math.floor((Math[a](c) / Math.LN10))\r\n    },\r\n    _drawXAxisLabel: function(c, l, h, a, g) {\r\n        if (!this._settings.xAxis) {\r\n            return\r\n        }\r\n        var e = this.canvases.x.renderTextAt(g, a, c, l - (g ? 2 : 0), this._settings.xAxis.template(h));\r\n        if (e) {\r\n            e.className += \" dhx_axis_item_x\"\r\n        }\r\n    },\r\n    _drawXAxisLine: function(c, a, g, e, h) {\r\n        if (!this._settings.xAxis || !this._settings.xAxis.lines) {\r\n            return\r\n        }\r\n        this._drawLine(c, a, g, a, e, this._settings.xAxis.lineColor.call(this, h), 1)\r\n    },\r\n    _drawLine: function(a, g, m, e, h, c, l) {\r\n        a.strokeStyle = c;\r\n        a.lineWidth = l;\r\n        a.beginPath();\r\n        a.moveTo(g, m);\r\n        a.lineTo(e, h);\r\n        a.stroke();\r\n        a.lineWidth = 1\r\n    },\r\n    _getRelativeValue: function(g, h) {\r\n        var e, a;\r\n        var c = 1;\r\n        if (h != g) {\r\n            e = h - g\r\n        } else {\r\n            e = g\r\n        }\r\n        return [e, c]\r\n    },\r\n    _rainbow: [function(a) {\r\n        return \"#FF\" + dhtmlx.math.toHex(a / 2, 2) + \"00\"\r\n    }\r\n    , function(a) {\r\n        return \"#FF\" + dhtmlx.math.toHex(a / 2 + 128, 2) + \"00\"\r\n    }\r\n    , function(a) {\r\n        return \"#\" + dhtmlx.math.toHex(255 - a, 2) + \"FF00\"\r\n    }\r\n    , function(a) {\r\n        return \"#00FF\" + dhtmlx.math.toHex(a, 2)\r\n    }\r\n    , function(a) {\r\n        return \"#00\" + dhtmlx.math.toHex(255 - a, 2) + \"FF\"\r\n    }\r\n    , function(a) {\r\n        return \"#\" + dhtmlx.math.toHex(a, 2) + \"00FF\"\r\n    }\r\n    ],\r\n    addSeries: function(c) {\r\n        var a = this._settings;\r\n        this._settings = dhtmlx.extend({}, a);\r\n        this._parseSettings(c, {});\r\n        this._series.push(this._settings);\r\n        this._settings = a\r\n    },\r\n    _switchSerie: function(l, a, h) {\r\n        var g;\r\n        this._active_serie = (this._series.length == 1 ? a.getAttribute(\"userdata\") : this._getActiveSeries(h));\r\n        if (!this._series[this._active_serie]) {\r\n            return\r\n        }\r\n        for (var c = 0; c < this._series.length; c++) {\r\n            g = this._series[c].tooltip;\r\n            if (g) {\r\n                g.disable()\r\n            }\r\n        }\r\n        if (!a.getAttribute(\"disabled\")) {\r\n            g = this._series[this._active_serie].tooltip;\r\n            if (g) {\r\n                g.enable()\r\n            }\r\n        }\r\n    },\r\n    _getActiveSeries: function(l) {\r\n        var o, c, h, g, n, s, r, m;\r\n        c = this._map._areas;\r\n        g = dhtmlx.html.offset(this._obj._htmlmap);\r\n        n = dhtmlx.html.pos(l);\r\n        r = n.x - g.x;\r\n        m = n.y - g.y;\r\n        for (h = 0; h < c.length; h++) {\r\n            o = c[h].points;\r\n            if (r <= o[2] && r >= o[0] && m <= o[3] && m >= o[1]) {\r\n                if (s) {\r\n                    if (c[h].index > s.index) {\r\n                        s = c[h]\r\n                    }\r\n                } else {\r\n                    s = c[h]\r\n                }\r\n            }\r\n        }\r\n        return s ? s.index : 0\r\n    },\r\n    hideSeries: function(a) {\r\n        this.canvases[a].hideCanvas();\r\n        if (this._settings.legend.values && this._settings.legend.values[a]) {\r\n            this._settings.legend.values[a].$hidden = true\r\n        }\r\n        this._drawLegend()\r\n    },\r\n    showSeries: function(a) {\r\n        this.canvases[a].showCanvas();\r\n        if (this._settings.legend.values && this._settings.legend.values[a]) {\r\n            delete this._settings.legend.values[a].$hidden\r\n        }\r\n        this._drawLegend()\r\n    },\r\n    _changeColorSV: function(c, h, a) {\r\n        var g, e;\r\n        e = dhtmlx.math.toRgb(c);\r\n        g = dhtmlx.math.rgbToHsv(e[0], e[1], e[2]);\r\n        g[1] *= h;\r\n        g[2] *= a;\r\n        return \"rgb(\" + dhtmlx.math.hsvToRgb(g[0], g[1], g[2]) + \")\"\r\n    },\r\n    _setBorderStyles: function(a, c) {\r\n        var g, e;\r\n        e = dhtmlx.math.toRgb(c);\r\n        g = dhtmlx.math.rgbToHsv(e[0], e[1], e[2]);\r\n        g[2] /= 2;\r\n        c = \"rgb(\" + dhtmlx.math.hsvToRgb(g[0], g[1], g[2]) + \")\";\r\n        a.strokeStyle = c;\r\n        if (a.globalAlpha == 1) {\r\n            a.globalAlpha = 0.9\r\n        }\r\n    },\r\n    _drawLegend: function(h, c) {\r\n        var l, s, C, u, m, v, a, o = 0, n = 0, A, r, g, w;\r\n        h = h || [];\r\n        c = c || this._obj.offsetWidth;\r\n        A = this.canvases.legend.getCanvas();\r\n        s = this._settings.legend;\r\n        a = (this._settings.legend.layout != \"x\" ? \"width:\" + s.width + \"px\" : \"\");\r\n        if (this.legendObj) {\r\n            this.legendObj.innerHTML = \"\";\r\n            this.legendObj.parentNode.removeChild(this.legendObj)\r\n        }\r\n        this.canvases.legend.clearCanvas(true);\r\n        C = dhtmlx.html.create(\"DIV\", {\r\n            \"class\": \"dhx_chart_legend\",\r\n            style: \"left:\" + o + \"px; top:\" + n + \"px;\" + a\r\n        }, \"\");\r\n        if (s.padding) {\r\n            C.style.padding = s.padding + \"px\"\r\n        }\r\n        this.legendObj = C;\r\n        this._obj.appendChild(C);\r\n        m = [];\r\n        if (!s.values) {\r\n            for (l = 0; l < h.length; l++) {\r\n                m.push(this._drawLegendText(C, s.template(h[l])))\r\n            }\r\n        } else {\r\n            for (l = 0; l < s.values.length; l++) {\r\n                m.push(this._drawLegendText(C, s.values[l].text, (typeof s.values[l].id != \"undefined\" ? typeof s.values[l].id : l), s.values[l].$hidden))\r\n            }\r\n        }\r\n        v = C.offsetWidth;\r\n        u = C.offsetHeight;\r\n        if (v < this._obj.offsetWidth) {\r\n            if (s.layout == \"x\" && s.align == \"center\") {\r\n                o = (this._obj.offsetWidth - v) / 2\r\n            }\r\n            if (s.align == \"right\") {\r\n                o = this._obj.offsetWidth - v\r\n            }\r\n            if (s.margin && s.align != \"center\") {\r\n                o += (s.align == \"left\" ? 1 : -1) * s.margin\r\n            }\r\n        }\r\n        if (u < this._obj.offsetHeight) {\r\n            if (s.valign == \"middle\" && s.align != \"center\" && s.layout != \"x\") {\r\n                n = (this._obj.offsetHeight - u) / 2\r\n            } else {\r\n                if (s.valign == \"bottom\") {\r\n                    n = this._obj.offsetHeight - u\r\n                }\r\n            }\r\n            if (s.margin && s.valign != \"middle\") {\r\n                n += (s.valign == \"top\" ? 1 : -1) * s.margin\r\n            }\r\n        }\r\n        C.style.left = o + \"px\";\r\n        C.style.top = n + \"px\";\r\n        A.save();\r\n        for (l = 0; l < m.length; l++) {\r\n            w = m[l];\r\n            if (s.values && s.values[l].$hidden) {\r\n                g = true;\r\n                r = (s.values[l].disableColor ? s.values[l].disableColor : \"#d9d9d9\")\r\n            } else {\r\n                g = false;\r\n                r = (s.values ? s.values[l].color : this._settings.color.call(this, h[l]))\r\n            }\r\n            var e = (s.marker.position == \"right\" ? w.offsetWidth - s.marker.width : 0);\r\n            this._drawLegendMarker(A, w.offsetLeft + o + e, w.offsetTop + n, r, w.offsetHeight, g, l)\r\n        }\r\n        A.restore();\r\n        m = null \r\n    },\r\n    _drawLegendText: function(a, l, c, h) {\r\n        var g = \"\";\r\n        var e = this._settings.legend;\r\n        if (e.layout == \"x\") {\r\n            g = \"float:left;\"\r\n        }\r\n        var n = e.marker.position;\r\n        var m = dhtmlx.html.create(\"DIV\", {\r\n            style: g + \"padding-\" + (n && n == \"right\" ? \"right\" : \"left\") + \":\" + (10 + e.marker.width) + \"px\",\r\n            \"class\": \"dhx_chart_legend_item\" + (h ? \" hidden\" : \"\")\r\n        }, l);\r\n        if (arguments.length > 2) {\r\n            m.setAttribute(\"series_id\", c)\r\n        }\r\n        a.appendChild(m);\r\n        return m\r\n    },\r\n    _drawLegendMarker: function(C, u, s, h, A, l, n) {\r\n        var c = [];\r\n        var m = this._settings.legend.marker;\r\n        var w = this._settings.legend.values;\r\n        var r = (w && w[n].markerType ? w[n].markerType : m.type);\r\n        if (h) {\r\n            C.fillStyle = h;\r\n            C.strokeStyle = this._getDarkenColor(h, 0.75)\r\n        }\r\n        C.beginPath();\r\n        if (r == \"round\" || !m.radius) {\r\n            C.lineWidth = m.height;\r\n            C.lineCap = r;\r\n            u += C.lineWidth / 2 + 5;\r\n            s += A / 2;\r\n            C.moveTo(u, s);\r\n            var a = u + m.width - m.height + 1;\r\n            C.lineTo(a, s)\r\n        } else {\r\n            if (r == \"item\") {\r\n                if (this._settings.line && this._settings.view != \"scatter\" && !this._settings.disableLines) {\r\n                    C.beginPath();\r\n                    C.lineWidth = this._series[n].line.width;\r\n                    C.strokeStyle = l ? h : this._series[n].line.color.call(this, {});\r\n                    var e = u + 5;\r\n                    var v = s + A / 2;\r\n                    C.moveTo(e, v);\r\n                    var a = e + m.width;\r\n                    C.lineTo(a, v);\r\n                    C.stroke()\r\n                }\r\n                var g = this._series[n].item;\r\n                var o = parseInt(g.radius.call(this, {}), 10) || 0;\r\n                if (o) {\r\n                    if (g.type == \"image\" && g.src) {\r\n                        this._drawImage(C, u + 5, s + m.height / 2 - 5, g.src, o * 2, o * 2);\r\n                        return\r\n                    } else {\r\n                        C.beginPath();\r\n                        if (l) {\r\n                            C.lineWidth = g.borderWidth;\r\n                            C.strokeStyle = h;\r\n                            C.fillStyle = h\r\n                        } else {\r\n                            C.lineWidth = g.borderWidth;\r\n                            C.fillStyle = g.color.call(this, {});\r\n                            C.strokeStyle = g.borderColor.call(this, {});\r\n                            C.globalAlpha = g.alpha.call(this, {})\r\n                        }\r\n                        C.beginPath();\r\n                        u += m.width / 2 + 5;\r\n                        s += A / 2;\r\n                        this._strokeChartItem(C, u, s, o + 1, g.type);\r\n                        C.fill();\r\n                        C.stroke()\r\n                    }\r\n                }\r\n                C.globalAlpha = 1\r\n            } else {\r\n                C.lineWidth = 1;\r\n                u += 5;\r\n                s += parseInt(A / 2 - m.height / 2, 10);\r\n                c = [[u + m.radius, s + m.radius, m.radius, Math.PI, 3 * Math.PI / 2, false], [u + m.width - m.radius, s], [u + m.width - m.radius, s + m.radius, m.radius, -Math.PI / 2, 0, false], [u + m.width, s + m.height - m.radius], [u + m.width - m.radius, s + m.height - m.radius, m.radius, 0, Math.PI / 2, false], [u + m.radius, s + m.height], [u + m.radius, s + m.height - m.radius, m.radius, Math.PI / 2, Math.PI, false], [u, s + m.radius]];\r\n                this._path(C, c)\r\n            }\r\n        }\r\n        C.stroke();\r\n        C.fill()\r\n    },\r\n    _getDarkenColor: function(a, g) {\r\n        var e, c;\r\n        c = dhtmlx.math.toRgb(a);\r\n        e = dhtmlx.math.rgbToHsv(c[0], c[1], c[2]);\r\n        e[2] = e[2] * g;\r\n        return \"rgb(\" + dhtmlx.math.hsvToRgb(e[0], e[1], e[2]) + \")\"\r\n    },\r\n    _getChartBounds: function(a, m) {\r\n        var o, e, n, c;\r\n        o = this._settings.padding.left;\r\n        e = this._settings.padding.top;\r\n        n = a - this._settings.padding.right;\r\n        c = m - this._settings.padding.bottom;\r\n        if (this._settings.legend) {\r\n            var h = this._settings.legend;\r\n            var l = this._settings.legend.width;\r\n            var g = this._settings.legend.height;\r\n            if (h.layout == \"x\") {\r\n                if (h.valign == \"center\") {\r\n                    if (h.align == \"right\") {\r\n                        n -= l\r\n                    } else {\r\n                        if (h.align == \"left\") {\r\n                            o += l\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (h.valign == \"bottom\") {\r\n                        c -= g\r\n                    } else {\r\n                        e += g\r\n                    }\r\n                }\r\n            } else {\r\n                if (h.align == \"right\") {\r\n                    n -= l\r\n                } else {\r\n                    if (h.align == \"left\") {\r\n                        o += l\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            start: {\r\n                x: o,\r\n                y: e\r\n            },\r\n            end: {\r\n                x: n,\r\n                y: c\r\n            }\r\n        }\r\n    },\r\n    _getStackedLimits: function(h) {\r\n        var c, a, l, g, e;\r\n        if (this._settings.yAxis && (typeof this._settings.yAxis.end != \"undefined\") && (typeof this._settings.yAxis.start != \"undefined\") && this._settings.yAxis.step) {\r\n            l = parseFloat(this._settings.yAxis.end);\r\n            g = parseFloat(this._settings.yAxis.start)\r\n        } else {\r\n            for (c = 0; c < h.length; c++) {\r\n                h[c].$sum = 0;\r\n                h[c].$min = Infinity;\r\n                for (a = 0; a < this._series.length; a++) {\r\n                    e = parseFloat(this._series[a].value(h[c]) || 0);\r\n                    if (isNaN(e)) {\r\n                        continue\r\n                    }\r\n                    if (this._series[a].view.toLowerCase().indexOf(\"stacked\") != -1) {\r\n                        h[c].$sum += e\r\n                    }\r\n                    if (e < h[c].$min) {\r\n                        h[c].$min = e\r\n                    }\r\n                }\r\n            }\r\n            l = -Infinity;\r\n            g = Infinity;\r\n            for (c = 0; c < h.length; c++) {\r\n                if (h[c].$sum > l) {\r\n                    l = h[c].$sum\r\n                }\r\n                if (h[c].$min < g) {\r\n                    g = h[c].$min\r\n                }\r\n            }\r\n            if (g > 0) {\r\n                g = 0\r\n            }\r\n        }\r\n        return {\r\n            max: l,\r\n            min: g\r\n        }\r\n    },\r\n    _setBarGradient: function(w, c, s, a, o, n, g, e) {\r\n        var r, h, m, l, v, u;\r\n        if (n == \"light\") {\r\n            if (e == \"x\") {\r\n                r = w.createLinearGradient(c, s, a, s)\r\n            } else {\r\n                r = w.createLinearGradient(c, s, c, o)\r\n            }\r\n            u = [[0, \"#FFFFFF\"], [0.9, g], [1, g]];\r\n            h = 2\r\n        } else {\r\n            if (n == \"falling\" || n == \"rising\") {\r\n                if (e == \"x\") {\r\n                    r = w.createLinearGradient(c, s, a, s)\r\n                } else {\r\n                    r = w.createLinearGradient(c, s, c, o)\r\n                }\r\n                m = dhtmlx.math.toRgb(g);\r\n                l = dhtmlx.math.rgbToHsv(m[0], m[1], m[2]);\r\n                l[1] *= 1 / 2;\r\n                v = \"rgb(\" + dhtmlx.math.hsvToRgb(l[0], l[1], l[2]) + \")\";\r\n                if (n == \"falling\") {\r\n                    u = [[0, v], [0.7, g], [1, g]]\r\n                } else {\r\n                    if (n == \"rising\") {\r\n                        u = [[0, g], [0.3, g], [1, v]]\r\n                    }\r\n                }\r\n                h = 0\r\n            } else {\r\n                w.globalAlpha = 0.37;\r\n                h = 0;\r\n                if (e == \"x\") {\r\n                    r = w.createLinearGradient(c, o, c, s)\r\n                } else {\r\n                    r = w.createLinearGradient(c, s, a, s)\r\n                }\r\n                u = [[0, \"#9d9d9d\"], [0.3, \"#e8e8e8\"], [0.45, \"#ffffff\"], [0.55, \"#ffffff\"], [0.7, \"#e8e8e8\"], [1, \"#9d9d9d\"]]\r\n            }\r\n        }\r\n        this._gradient(r, u);\r\n        return {\r\n            gradient: r,\r\n            offset: h\r\n        }\r\n    },\r\n    _getPositionByAngle: function(e, c, h, g) {\r\n        e *= (-1);\r\n        c = c + Math.cos(e) * g;\r\n        h = h - Math.sin(e) * g;\r\n        return {\r\n            x: c,\r\n            y: h\r\n        }\r\n    },\r\n    _gradient: function(e, c) {\r\n        for (var a = 0; a < c.length; a++) {\r\n            e.addColorStop(c[a][0], c[a][1])\r\n        }\r\n    },\r\n    _path: function(a, e) {\r\n        var c, g;\r\n        for (c = 0; c < e.length; c++) {\r\n            g = (c ? \"lineTo\" : \"moveTo\");\r\n            if (e[c].length > 2) {\r\n                g = \"arc\"\r\n            }\r\n            a[g].apply(a, e[c])\r\n        }\r\n    },\r\n    _circle: function(c, a, g, e) {\r\n        c.arc(a, g, e, Math.PI * 2, true)\r\n    },\r\n    _addMapRect: function(g, h, a, e, c) {\r\n        g.addRect(h, [a[0].x - e.x, a[0].y - e.y, a[1].x - e.x, a[1].y - e.y], c)\r\n    }\r\n};\r\ndhtmlx.compat(\"layout\");\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachChart = function(a) {\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"chart\"]);\r\n        var c = document.createElement(\"DIV\");\r\n        c.id = \"dhxChartObj_\" + window.dhx4.newId();\r\n        c.style.width = \"100%\";\r\n        c.style.height = \"100%\";\r\n        document.body.appendChild(c);\r\n        this._attachObject(c);\r\n        a.container = c.id;\r\n        this.dataType = \"chart\";\r\n        this.dataObj = new dhtmlXChart(a);\r\n        if (!this.dataObj.setSizes) {\r\n            this.dataObj.setSizes = function() {\r\n                if (this.resize) {\r\n                    this.resize()\r\n                } else {\r\n                    this.render()\r\n                }\r\n            }\r\n        }\r\n        return this.dataObj\r\n    }\r\n}\r\ndhtmlx.ui.pager = function(a) {\r\n    this.name = \"Pager\";\r\n    if (dhtmlx.assert_enabled()) {\r\n        this._assert()\r\n    }\r\n    dhtmlx.extend(this, dhtmlx.Settings);\r\n    this._parseContainer(a, \"dhx_pager\");\r\n    dhtmlx.extend(this, dhtmlx.EventSystem);\r\n    dhtmlx.extend(this, dhtmlx.SingleRender);\r\n    dhtmlx.extend(this, dhtmlx.MouseEvents);\r\n    this._parseSettings(a, {\r\n        size: 10,\r\n        page: -1,\r\n        group: 5,\r\n        count: 0,\r\n        type: \"default\"\r\n    });\r\n    this.data = this._settings;\r\n    this.refresh()\r\n}\r\n;\r\ndhtmlx.ui.pager.prototype = {\r\n    _id: \"dhx_p_id\",\r\n    on_click: {\r\n        dhx_pager_item: function(a, c) {\r\n            this.select(c)\r\n        }\r\n    },\r\n    select: function(a) {\r\n        switch (a) {\r\n        case \"next\":\r\n            a = this._settings.page + 1;\r\n            break;\r\n        case \"prev\":\r\n            a = this._settings.page - 1;\r\n            break;\r\n        case \"first\":\r\n            a = 0;\r\n            break;\r\n        case \"last\":\r\n            a = this._settings.limit - 1;\r\n            break;\r\n        default:\r\n            break\r\n        }\r\n        if (a < 0) {\r\n            a = 0\r\n        }\r\n        if (a >= this.data.limit) {\r\n            a = this.data.limit - 1\r\n        }\r\n        if (this.callEvent(\"onBeforePageChange\", [this._settings.page, a])) {\r\n            this.data.page = a * 1;\r\n            this.refresh();\r\n            this.callEvent(\"onAfterPageChange\", [a])\r\n        }\r\n    },\r\n    types: {\r\n        \"default\": {\r\n            template: dhtmlx.Template.fromHTML(\"{common.pages()}\"),\r\n            pages: function(e) {\r\n                var c = \"\";\r\n                if (e.page == -1) {\r\n                    return \"\"\r\n                }\r\n                e.min = e.page - Math.round((e.group - 1) / 2);\r\n                e.max = e.min + e.group - 1;\r\n                if (e.min < 0) {\r\n                    e.max += e.min * (-1);\r\n                    e.min = 0\r\n                }\r\n                if (e.max >= e.limit) {\r\n                    e.min -= Math.min(e.min, e.max - e.limit + 1);\r\n                    e.max = e.limit - 1\r\n                }\r\n                for (var a = (e.min || 0); a <= e.max; a++) {\r\n                    c += this.button({\r\n                        id: a,\r\n                        index: (a + 1),\r\n                        selected: (a == e.page ? \"_selected\" : \"\")\r\n                    })\r\n                }\r\n                return c\r\n            },\r\n            page: function(a) {\r\n                return a.page + 1\r\n            },\r\n            first: function() {\r\n                return this.button({\r\n                    id: \"first\",\r\n                    index: \" &lt;&lt; \",\r\n                    selected: \"\"\r\n                })\r\n            },\r\n            last: function() {\r\n                return this.button({\r\n                    id: \"last\",\r\n                    index: \" &gt;&gt; \",\r\n                    selected: \"\"\r\n                })\r\n            },\r\n            prev: function() {\r\n                return this.button({\r\n                    id: \"prev\",\r\n                    index: \"&lt;\",\r\n                    selected: \"\"\r\n                })\r\n            },\r\n            next: function() {\r\n                return this.button({\r\n                    id: \"next\",\r\n                    index: \"&gt;\",\r\n                    selected: \"\"\r\n                })\r\n            },\r\n            button: dhtmlx.Template.fromHTML(\"<div dhx_p_id='{obj.id}' class='dhx_pager_item{obj.selected}'>{obj.index}</div>\")\r\n        }\r\n    },\r\n    refresh: function() {\r\n        var a = this._settings;\r\n        a.limit = Math.ceil(a.count / a.size);\r\n        if (a.limit && a.limit != a.old_limit) {\r\n            a.page = Math.min(a.limit - 1, a.page)\r\n        }\r\n        var c = a.page;\r\n        if (c != -1 && (c != a.old_page) || (a.limit != a.old_limit)) {\r\n            this.render();\r\n            this.callEvent(\"onRefresh\", []);\r\n            a.old_limit = a.limit;\r\n            a.old_page = a.page\r\n        }\r\n    },\r\n    template_item_start: dhtmlx.Template.fromHTML(\"<div>\"),\r\n    template_item_end: dhtmlx.Template.fromHTML(\"</div>\")\r\n};\r\ndhtmlx.DataProcessor = {\r\n    _dp_init: function(c) {\r\n        var a = \"_methods\";\r\n        c[a] = [\"setItemStyle\", \"\", \"changeId\", \"remove\"];\r\n        this.attachEvent(\"onAfterAdd\", function(e) {\r\n            c.setUpdated(e, true, \"inserted\")\r\n        });\r\n        this.data.attachEvent(\"onStoreLoad\", dhtmlx.bind(function(g, e) {\r\n            if (g.getUserData) {\r\n                g.getUserData(e, this._userdata)\r\n            }\r\n        }, this));\r\n        this.attachEvent(\"onBeforeDelete\", function(g) {\r\n            if (c._silent_mode) {\r\n                return true\r\n            }\r\n            var e = c.getState(g);\r\n            if (e == \"inserted\") {\r\n                c.setUpdated(g, false);\r\n                return true\r\n            }\r\n            if (e == \"deleted\") {\r\n                return false\r\n            }\r\n            if (e == \"true_deleted\") {\r\n                return true\r\n            }\r\n            c.setUpdated(g, true, \"deleted\");\r\n            return false\r\n        });\r\n        this.attachEvent(\"onAfterEditStop\", function(e) {\r\n            c.setUpdated(e, true, \"updated\")\r\n        });\r\n        this.attachEvent(\"onBindUpdate\", function(e) {\r\n            window.setTimeout(function() {\r\n                c.setUpdated(e.id, true, \"updated\")\r\n            }, 1)\r\n        });\r\n        a = \"_getRowData\";\r\n        c[a] = function(m, e) {\r\n            var h = this.obj.data.get(m);\r\n            var l = {};\r\n            for (var g in h) {\r\n                if (g.indexOf(\"_\") === 0) {\r\n                    continue\r\n                }\r\n                l[g] = h[g]\r\n            }\r\n            return l\r\n        }\r\n        ;\r\n        a = \"_clearUpdateFlag\";\r\n        c[a] = function() {}\r\n        ;\r\n        this._userdata = {};\r\n        c.attachEvent(\"insertCallback\", this._dp_callback);\r\n        c.attachEvent(\"updateCallback\", this._dp_callback);\r\n        c.attachEvent(\"deleteCallback\", function(e, g) {\r\n            this.obj.setUserData(g, this.action_param, \"true_deleted\");\r\n            this.obj.remove(g)\r\n        });\r\n        dhtmlx.compat(\"dataProcessor\", c)\r\n    },\r\n    _dp_callback: function(a, c) {\r\n        this.obj.data.set(c, dhtmlx.DataDriver.xml.getDetails(a.firstChild));\r\n        this.obj.data.refresh(c)\r\n    },\r\n    setItemStyle: function(e, a) {\r\n        var c = this._locateHTML(e);\r\n        if (c) {\r\n            c.style.cssText += \";\" + a\r\n        }\r\n    },\r\n    changeId: function(c, a) {\r\n        this.data.changeId(c, a);\r\n        this.refresh()\r\n    },\r\n    setUserData: function(e, a, c) {\r\n        if (e) {\r\n            this.data.get(e)[a] = c\r\n        } else {\r\n            this._userdata[a] = c\r\n        }\r\n    },\r\n    getUserData: function(c, a) {\r\n        return c ? this.data.get(c)[a] : this._userdata[a]\r\n    }\r\n};\r\n(function() {\r\n    var a = \"_dp_init\";\r\n    dhtmlx.DataProcessor[a] = dhtmlx.DataProcessor._dp_init\r\n})();\r\ndhtmlx.compat.dnd = function() {\r\n    if (window.dhtmlDragAndDropObject) {\r\n        var n = \"_dragged\";\r\n        var g = dhtmlDragAndDropObject.prototype.checkLanding;\r\n        dhtmlDragAndDropObject.prototype.checkLanding = function(r, s, o) {\r\n            g.apply(this, arguments);\r\n            if (!o) {\r\n                var u = dhtmlx.DragControl._drag_context = dhtmlx.DragControl._drag_context || {};\r\n                if (!u.from) {\r\n                    u.from = this.dragStartObject\r\n                }\r\n                dhtmlx.DragControl._checkLand(r, s, true)\r\n            }\r\n        }\r\n        ;\r\n        var c = dhtmlDragAndDropObject.prototype.stopDrag;\r\n        dhtmlDragAndDropObject.prototype.stopDrag = function(s, o, r) {\r\n            if (!r) {\r\n                if (dhtmlx.DragControl._last) {\r\n                    dhtmlx.DragControl._active = m.dragStartNode;\r\n                    dhtmlx.DragControl._stopDrag(s, true)\r\n                }\r\n            }\r\n            c.apply(this, arguments)\r\n        }\r\n        ;\r\n        var m = new dhtmlDragAndDropObject();\r\n        var h = dhtmlx.DragControl._startDrag;\r\n        dhtmlx.DragControl._startDrag = function() {\r\n            h.apply(this, arguments);\r\n            var u = dhtmlx.DragControl._drag_context;\r\n            if (!u) {\r\n                return\r\n            }\r\n            var s = [];\r\n            var r = [];\r\n            for (var o = 0; o < u.source.length; o++) {\r\n                s[o] = {\r\n                    idd: u.source[o]\r\n                };\r\n                r.push(u.source[o])\r\n            }\r\n            m.dragStartNode = {\r\n                parentNode: {},\r\n                parentObject: {\r\n                    idd: s,\r\n                    id: (r.length == 1 ? r[0] : r),\r\n                    treeNod: {\r\n                        object: u.from\r\n                    }\r\n                }\r\n            };\r\n            m.dragStartNode.parentObject.treeNod[n] = s;\r\n            m.dragStartObject = u.from\r\n        }\r\n        ;\r\n        var l = dhtmlx.DragControl._checkLand;\r\n        dhtmlx.DragControl._checkLand = function(r, s, o) {\r\n            l.apply(this, arguments);\r\n            if (!this._last && !o) {\r\n                r = m.checkLanding(r, s, true)\r\n            }\r\n        }\r\n        ;\r\n        var a = dhtmlx.DragControl._stopDrag;\r\n        dhtmlx.DragControl._stopDrag = function(r, o) {\r\n            a.apply(this, arguments);\r\n            if (m.lastLanding && !o) {\r\n                m.stopDrag(r, false, true)\r\n            }\r\n        }\r\n        ;\r\n        var e = dhtmlx.DragControl.getMaster;\r\n        dhtmlx.DragControl.getMaster = function(r) {\r\n            var s = null ;\r\n            if (r) {\r\n                s = e.apply(this, arguments)\r\n            }\r\n            if (!s) {\r\n                s = m.dragStartObject;\r\n                var u = [];\r\n                var v = s[n];\r\n                for (var o = 0; o < v.length; o++) {\r\n                    u.push(v[o].idd || v[o].id)\r\n                }\r\n                dhtmlx.DragControl._drag_context.source = u\r\n            }\r\n            return s\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlx.DataMove = {\r\n    _init: function() {\r\n        dhtmlx.assert(this.data, \"DataMove :: Component doesn't have DataStore\")\r\n    },\r\n    copy: function(c, h, a, g) {\r\n        var e = this.get(c);\r\n        if (!e) {\r\n            dhtmlx.log(\"Warning\", \"Incorrect ID in DataMove::copy\");\r\n            return\r\n        }\r\n        if (a) {\r\n            dhtmlx.assert(a.externalData, \"DataMove :: External object doesn't support operation\");\r\n            e = a.externalData(e)\r\n        }\r\n        a = a || this;\r\n        return a.add(a.externalData(e, g), h)\r\n    },\r\n    move: function(e, m, c, l) {\r\n        if (e instanceof Array) {\r\n            for (var g = 0; g < e.length; g++) {\r\n                var a = (c || this).indexById(this.move(e[g], m, c, e[g]));\r\n                if (e[g + 1]) {\r\n                    m = a + (this.indexById(e[g + 1]) < a ? 0 : 1)\r\n                }\r\n            }\r\n            return\r\n        }\r\n        nid = e;\r\n        if (m < 0) {\r\n            dhtmlx.log(\"Info\", \"DataMove::move - moving outside of bounds is ignored\");\r\n            return\r\n        }\r\n        var h = this.get(e);\r\n        if (!h) {\r\n            dhtmlx.log(\"Warning\", \"Incorrect ID in DataMove::move\");\r\n            return\r\n        }\r\n        if (!c || c == this) {\r\n            this.data.move(this.indexById(e), m)\r\n        } else {\r\n            dhtmlx.assert(c.externalData, \"DataMove :: External object doesn't support operation\");\r\n            nid = c.add(c.externalData(h, l), m);\r\n            this.remove(e)\r\n        }\r\n        return nid\r\n    },\r\n    moveUp: function(c, a) {\r\n        return this.move(c, this.indexById(c) - (a || 1))\r\n    },\r\n    moveDown: function(c, a) {\r\n        return this.moveUp(c, (a || 1) * -1)\r\n    },\r\n    moveTop: function(a) {\r\n        return this.move(a, 0)\r\n    },\r\n    moveBottom: function(a) {\r\n        return this.move(a, this.data.dataCount() - 1)\r\n    },\r\n    externalData: function(a, e) {\r\n        var c = dhtmlx.extend({}, a);\r\n        c.id = e || dhtmlx.uid();\r\n        c.$selected = c.$template = null ;\r\n        return c\r\n    }\r\n};\r\ndhtmlx.DragControl = {\r\n    _drag_masters: dhtmlx.toArray([\"dummy\"]),\r\n    addDrop: function(c, e, a) {\r\n        c = dhtmlx.toNode(c);\r\n        c.dhx_drop = this._getCtrl(e);\r\n        if (a) {\r\n            c.dhx_master = true\r\n        }\r\n    },\r\n    _getCtrl: function(c) {\r\n        c = c || dhtmlx.DragControl;\r\n        var a = this._drag_masters.find(c);\r\n        if (a < 0) {\r\n            a = this._drag_masters.length;\r\n            this._drag_masters.push(c)\r\n        }\r\n        return a\r\n    },\r\n    addDrag: function(a, c) {\r\n        a = dhtmlx.toNode(a);\r\n        a.dhx_drag = this._getCtrl(c);\r\n        dhtmlx.event(a, \"mousedown\", this._preStart, a)\r\n    },\r\n    _preStart: function(a) {\r\n        if (dhtmlx.DragControl._active) {\r\n            dhtmlx.DragControl._preStartFalse();\r\n            dhtmlx.DragControl.destroyDrag()\r\n        }\r\n        dhtmlx.DragControl._active = this;\r\n        dhtmlx.DragControl._start_pos = {\r\n            x: a.pageX,\r\n            y: a.pageY\r\n        };\r\n        dhtmlx.DragControl._dhx_drag_mm = dhtmlx.event(document.body, \"mousemove\", dhtmlx.DragControl._startDrag);\r\n        dhtmlx.DragControl._dhx_drag_mu = dhtmlx.event(document.body, \"mouseup\", dhtmlx.DragControl._preStartFalse);\r\n        dhtmlx.DragControl._dhx_drag_sc = dhtmlx.event(this, \"scroll\", dhtmlx.DragControl._preStartFalse);\r\n        a.cancelBubble = true;\r\n        return false\r\n    },\r\n    _preStartFalse: function(a) {\r\n        dhtmlx.DragControl._dhx_drag_mm = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mm);\r\n        dhtmlx.DragControl._dhx_drag_mu = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mu);\r\n        dhtmlx.DragControl._dhx_drag_sc = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_sc)\r\n    },\r\n    _startDrag: function(a) {\r\n        var c = {\r\n            x: a.pageX,\r\n            y: a.pageY\r\n        };\r\n        if (Math.abs(c.x - dhtmlx.DragControl._start_pos.x) < 5 && Math.abs(c.y - dhtmlx.DragControl._start_pos.y) < 5) {\r\n            return\r\n        }\r\n        dhtmlx.DragControl._preStartFalse();\r\n        if (!dhtmlx.DragControl.createDrag(a)) {\r\n            return\r\n        }\r\n        dhtmlx.DragControl.sendSignal(\"start\");\r\n        dhtmlx.DragControl._dhx_drag_mm = dhtmlx.event(document.body, \"mousemove\", dhtmlx.DragControl._moveDrag);\r\n        dhtmlx.DragControl._dhx_drag_mu = dhtmlx.event(document.body, \"mouseup\", dhtmlx.DragControl._stopDrag);\r\n        dhtmlx.DragControl._moveDrag(a)\r\n    },\r\n    _stopDrag: function(a) {\r\n        dhtmlx.DragControl._dhx_drag_mm = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mm);\r\n        dhtmlx.DragControl._dhx_drag_mu = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mu);\r\n        if (dhtmlx.DragControl._last) {\r\n            dhtmlx.DragControl.onDrop(dhtmlx.DragControl._active, dhtmlx.DragControl._last, this._landing, a);\r\n            dhtmlx.DragControl.onDragOut(dhtmlx.DragControl._active, dhtmlx.DragControl._last, null , a)\r\n        }\r\n        dhtmlx.DragControl.destroyDrag();\r\n        dhtmlx.DragControl.sendSignal(\"stop\")\r\n    },\r\n    _moveDrag: function(a) {\r\n        var c = dhtmlx.html.pos(a);\r\n        dhtmlx.DragControl._html.style.top = c.y + dhtmlx.DragControl.top + \"px\";\r\n        dhtmlx.DragControl._html.style.left = c.x + dhtmlx.DragControl.left + \"px\";\r\n        if (dhtmlx.DragControl._skip) {\r\n            dhtmlx.DragControl._skip = false\r\n        } else {\r\n            dhtmlx.DragControl._checkLand((a.srcElement || a.target), a)\r\n        }\r\n        a.cancelBubble = true;\r\n        return false\r\n    },\r\n    _checkLand: function(a, c) {\r\n        while (a && a.tagName != \"BODY\") {\r\n            if (a.dhx_drop) {\r\n                if (this._last && (this._last != a || a.dhx_master)) {\r\n                    this.onDragOut(this._active, this._last, a, c)\r\n                }\r\n                if (!this._last || this._last != a || a.dhx_master) {\r\n                    this._last = null ;\r\n                    this._landing = this.onDragIn(dhtmlx.DragControl._active, a, c);\r\n                    if (this._landing) {\r\n                        this._last = a\r\n                    }\r\n                    return\r\n                }\r\n                return\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        if (this._last) {\r\n            this._last = this._landing = this.onDragOut(this._active, this._last, null , c)\r\n        }\r\n    },\r\n    sendSignal: function(a) {\r\n        dhtmlx.DragControl.active = (a == \"start\")\r\n    },\r\n    getMaster: function(a) {\r\n        return this._drag_masters[a.dhx_drag || a.dhx_drop]\r\n    },\r\n    getContext: function(a) {\r\n        return this._drag_context\r\n    },\r\n    createDrag: function(l) {\r\n        var g = dhtmlx.DragControl._active;\r\n        var h = this._drag_masters[g.dhx_drag];\r\n        var c;\r\n        if (h.onDragCreate) {\r\n            c = h.onDragCreate(g, l);\r\n            c.style.position = \"absolute\";\r\n            c.style.zIndex = dhtmlx.zIndex.drag;\r\n            c.onmousemove = dhtmlx.DragControl._skip_mark\r\n        } else {\r\n            var m = dhtmlx.DragControl.onDrag(g, l);\r\n            if (!m) {\r\n                return false\r\n            }\r\n            var c = document.createElement(\"DIV\");\r\n            c.innerHTML = m;\r\n            c.className = \"dhx_drag_zone\";\r\n            c.onmousemove = dhtmlx.DragControl._skip_mark;\r\n            document.body.appendChild(c)\r\n        }\r\n        dhtmlx.DragControl._html = c;\r\n        return true\r\n    },\r\n    _skip_mark: function() {\r\n        dhtmlx.DragControl._skip = true\r\n    },\r\n    destroyDrag: function() {\r\n        var c = dhtmlx.DragControl._active;\r\n        var e = this._drag_masters[c.dhx_drag];\r\n        if (e && e.onDragDestroy) {\r\n            e.onDragDestroy(c, dhtmlx.DragControl._html)\r\n        } else {\r\n            dhtmlx.html.remove(dhtmlx.DragControl._html)\r\n        }\r\n        dhtmlx.DragControl._landing = dhtmlx.DragControl._active = dhtmlx.DragControl._last = dhtmlx.DragControl._html = null \r\n    },\r\n    top: 5,\r\n    left: 5,\r\n    onDragIn: function(g, c, h) {\r\n        var a = this._drag_masters[c.dhx_drop];\r\n        if (a.onDragIn && a != this) {\r\n            return a.onDragIn(g, c, h)\r\n        }\r\n        c.className = c.className + \" dhx_drop_zone\";\r\n        return c\r\n    },\r\n    onDragOut: function(g, c, l, h) {\r\n        var a = this._drag_masters[c.dhx_drop];\r\n        if (a.onDragOut && a != this) {\r\n            return a.onDragOut(g, c, l, h)\r\n        }\r\n        c.className = c.className.replace(\"dhx_drop_zone\", \"\");\r\n        return null \r\n    },\r\n    onDrop: function(g, c, l, h) {\r\n        var a = this._drag_masters[c.dhx_drop];\r\n        dhtmlx.DragControl._drag_context.from = dhtmlx.DragControl.getMaster(g);\r\n        if (a.onDrop && a != this) {\r\n            return a.onDrop(g, c, l, h)\r\n        }\r\n        c.appendChild(g)\r\n    },\r\n    onDrag: function(c, g) {\r\n        var a = this._drag_masters[c.dhx_drag];\r\n        if (a.onDrag && a != this) {\r\n            return a.onDrag(c, g)\r\n        }\r\n        dhtmlx.DragControl._drag_context = {\r\n            source: c,\r\n            from: c\r\n        };\r\n        return \"<div style='\" + c.style.cssText + \"'>\" + c.innerHTML + \"</div>\"\r\n    }\r\n};\r\ndhtmlx.DragItem = {\r\n    _init: function() {\r\n        dhtmlx.assert(this.move, \"DragItem :: Component doesn't have DataMove interface\");\r\n        dhtmlx.assert(this.locate, \"DragItem :: Component doesn't have RenderStack interface\");\r\n        dhtmlx.assert(dhtmlx.DragControl, \"DragItem :: DragControl is not included\");\r\n        if (!this._settings || this._settings.drag) {\r\n            dhtmlx.DragItem._initHandlers(this)\r\n        } else {\r\n            if (this._settings) {\r\n                this.drag_setter = function(a) {\r\n                    if (a) {\r\n                        this._initHandlers(this);\r\n                        delete this.drag_setter\r\n                    }\r\n                    return a\r\n                }\r\n            }\r\n        }\r\n        if (this.dragMarker) {\r\n            this.attachEvent(\"onBeforeDragIn\", this.dragMarker);\r\n            this.attachEvent(\"onDragOut\", this.dragMarker)\r\n        }\r\n    },\r\n    _initHandlers: function(a) {\r\n        dhtmlx.DragControl.addDrop(a._obj, a, true);\r\n        dhtmlx.DragControl.addDrag(a._obj, a)\r\n    },\r\n    onDragIn: function(h, g, l) {\r\n        var n = this.locate(l) || null ;\r\n        var c = dhtmlx.DragControl._drag_context;\r\n        var m = dhtmlx.DragControl.getMaster(h);\r\n        var a = (this._locateHTML(n) || this._obj);\r\n        if (a == dhtmlx.DragControl._landing) {\r\n            return a\r\n        }\r\n        c.target = n;\r\n        c.to = m;\r\n        if (!this.callEvent(\"onBeforeDragIn\", [c, l])) {\r\n            c.id = null ;\r\n            return null \r\n        }\r\n        dhtmlx.html.addCss(a, \"dhx_drag_over\");\r\n        return a\r\n    },\r\n    onDragOut: function(h, g, o, l) {\r\n        var m = this.locate(l) || null ;\r\n        if (o != this._dataobj) {\r\n            m = null \r\n        }\r\n        var c = (this._locateHTML(m) || (o ? dhtmlx.DragControl.getMaster(o)._obj : window.undefined));\r\n        if (c == dhtmlx.DragControl._landing) {\r\n            return null \r\n        }\r\n        var a = dhtmlx.DragControl._drag_context;\r\n        dhtmlx.html.removeCss(dhtmlx.DragControl._landing, \"dhx_drag_over\");\r\n        a.target = a.to = null ;\r\n        this.callEvent(\"onDragOut\", [a, l]);\r\n        return null \r\n    },\r\n    onDrop: function(g, c, l, h) {\r\n        var a = dhtmlx.DragControl._drag_context;\r\n        a.to = this;\r\n        a.index = a.target ? this.indexById(a.target) : this.dataCount();\r\n        a.new_id = dhtmlx.uid();\r\n        if (!this.callEvent(\"onBeforeDrop\", [a, h])) {\r\n            return\r\n        }\r\n        if (a.from == a.to) {\r\n            this.move(a.source, a.index)\r\n        } else {\r\n            if (a.from) {\r\n                a.from.move(a.source, a.index, a.to, a.new_id)\r\n            } else {\r\n                dhtmlx.error(\"Unsopported d-n-d combination\")\r\n            }\r\n        }\r\n        this.callEvent(\"onAfterDrop\", [a, h])\r\n    },\r\n    onDrag: function(g, l) {\r\n        var m = this.locate(l);\r\n        var h = [m];\r\n        if (m) {\r\n            if (this.getSelected) {\r\n                var c = this.getSelected();\r\n                if (dhtmlx.PowerArray.find.call(c, m) != -1) {\r\n                    h = c\r\n                }\r\n            }\r\n            var a = dhtmlx.DragControl._drag_context = {\r\n                source: h,\r\n                start: m\r\n            };\r\n            a.from = this;\r\n            if (this.callEvent(\"onBeforeDrag\", [a, l])) {\r\n                return a.html || this._toHTML(this.get(m))\r\n            }\r\n        }\r\n        return null \r\n    }\r\n};\r\ndhtmlx.EditAbility = {\r\n    _init: function(a) {\r\n        this._edit_id = null ;\r\n        this._edit_bind = null ;\r\n        dhtmlx.assert(this.data, \"EditAbility :: Component doesn't have DataStore\");\r\n        dhtmlx.assert(this._locateHTML, \"EditAbility :: Component doesn't have RenderStack\");\r\n        this.attachEvent(\"onEditKeyPress\", function(e, g, c) {\r\n            if (e == 13 && !c) {\r\n                this.stopEdit()\r\n            } else {\r\n                if (e == 27) {\r\n                    this.stopEdit(true)\r\n                }\r\n            }\r\n        });\r\n        this.attachEvent(\"onBeforeRender\", function() {\r\n            this.stopEdit()\r\n        })\r\n    },\r\n    isEdit: function() {\r\n        return this._edit_id\r\n    },\r\n    edit: function(c) {\r\n        if (this.stopEdit(false, c)) {\r\n            if (!this.callEvent(\"onBeforeEditStart\", [c])) {\r\n                return\r\n            }\r\n            var a = this.data.get(c);\r\n            if (a.$template) {\r\n                return\r\n            }\r\n            a.$template = \"edit\";\r\n            this.data.refresh(c);\r\n            this._edit_id = c;\r\n            this._save_binding(c);\r\n            this._edit_bind(true, a);\r\n            this.callEvent(\"onAfterEditStart\", [c])\r\n        }\r\n    },\r\n    stopEdit: function(e, h) {\r\n        if (!this._edit_id) {\r\n            return true\r\n        }\r\n        if (this._edit_id == h) {\r\n            return false\r\n        }\r\n        var a = {};\r\n        if (!e) {\r\n            this._edit_bind(false, a)\r\n        } else {\r\n            a = null \r\n        }\r\n        if (!this.callEvent(\"onBeforeEditStop\", [this._edit_id, a])) {\r\n            return false\r\n        }\r\n        var c = this.data.get(this._edit_id);\r\n        c.$template = null ;\r\n        if (!e) {\r\n            this._edit_bind(false, c)\r\n        }\r\n        var g = this._edit_id;\r\n        this._edit_bind = this._edit_id = null ;\r\n        this.data.refresh(g);\r\n        this.callEvent(\"onAfterEditStop\", [g, a]);\r\n        return true\r\n    },\r\n    _save_binding: function(n) {\r\n        var a = this._locateHTML(n);\r\n        var e = \"\";\r\n        var l = \"\";\r\n        var h = [];\r\n        if (a) {\r\n            var g = a.getElementsByTagName(\"*\");\r\n            var m = \"\";\r\n            for (var c = 0; c < g.length; c++) {\r\n                if (g[c].nodeType == 1 && (m = g[c].getAttribute(\"bind\"))) {\r\n                    e += \"els[\" + h.length + \"].value=\" + m + \";\";\r\n                    l += m + \"=els[\" + h.length + \"].value;\";\r\n                    h.push(g[c]);\r\n                    g[c].className += \" dhx_allow_selection\";\r\n                    g[c].onselectstart = this._block_native\r\n                }\r\n            }\r\n            g = null \r\n        }\r\n        e = Function(\"obj\", \"els\", e);\r\n        l = Function(\"obj\", \"els\", l);\r\n        this._edit_bind = function(r, o) {\r\n            if (r) {\r\n                e(o, h);\r\n                if (h.length && h[0].select) {\r\n                    h[0].select()\r\n                }\r\n            } else {\r\n                l(o, h)\r\n            }\r\n        }\r\n    },\r\n    _block_native: function(a) {\r\n        (a || event).cancelBubble = true;\r\n        return true\r\n    }\r\n};\r\ndhtmlx.SelectionModel = {\r\n    _init: function() {\r\n        this._selected = dhtmlx.toArray();\r\n        dhtmlx.assert(this.data, \"SelectionModel :: Component doesn't have DataStore\");\r\n        this.data.attachEvent(\"onStoreUpdated\", dhtmlx.bind(this._data_updated, this));\r\n        this.data.attachEvent(\"onStoreLoad\", dhtmlx.bind(this._data_loaded, this));\r\n        this.data.attachEvent(\"onAfterFilter\", dhtmlx.bind(this._data_filtered, this));\r\n        this.data.attachEvent(\"onIdChange\", dhtmlx.bind(this._id_changed, this))\r\n    },\r\n    _id_changed: function(e, a) {\r\n        for (var c = this._selected.length - 1; c >= 0; c--) {\r\n            if (this._selected[c] == e) {\r\n                this._selected[c] = a\r\n            }\r\n        }\r\n    },\r\n    _data_filtered: function() {\r\n        for (var a = this._selected.length - 1; a >= 0; a--) {\r\n            if (this.data.indexById(this._selected[a]) < 0) {\r\n                var e = this._selected[a];\r\n                var c = this.item(e);\r\n                if (c) {\r\n                    delete c.$selected\r\n                }\r\n                this._selected.splice(a, 1);\r\n                this.callEvent(\"onSelectChange\", [e])\r\n            }\r\n        }\r\n    },\r\n    _data_updated: function(e, c, a) {\r\n        if (a == \"delete\") {\r\n            this._selected.remove(e)\r\n        } else {\r\n            if (!this.data.dataCount() && !this.data._filter_order) {\r\n                this._selected = dhtmlx.toArray()\r\n            }\r\n        }\r\n    },\r\n    _data_loaded: function() {\r\n        if (this._settings.select) {\r\n            this.data.each(function(a) {\r\n                if (a.$selected) {\r\n                    this.select(a.id)\r\n                }\r\n            }, this)\r\n        }\r\n    },\r\n    _select_mark: function(e, c, a) {\r\n        if (!a && !this.callEvent(\"onBeforeSelect\", [e, c])) {\r\n            return false\r\n        }\r\n        this.data.item(e).$selected = c;\r\n        if (a) {\r\n            a.push(e)\r\n        } else {\r\n            if (c) {\r\n                this._selected.push(e)\r\n            } else {\r\n                this._selected.remove(e)\r\n            }\r\n            this._refresh_selection(e)\r\n        }\r\n        return true\r\n    },\r\n    select: function(g, e, a) {\r\n        if (!g) {\r\n            return this.selectAll()\r\n        }\r\n        if (g instanceof Array) {\r\n            for (var c = 0; c < g.length; c++) {\r\n                this.select(g[c], e, a)\r\n            }\r\n            return\r\n        }\r\n        if (!this.data.exists(g)) {\r\n            dhtmlx.error(\"Incorrect id in select command: \" + g);\r\n            return\r\n        }\r\n        if (a && this._selected.length) {\r\n            return this.selectAll(this._selected[this._selected.length - 1], g)\r\n        }\r\n        if (!e && (this._selected.length != 1 || this._selected[0] != g)) {\r\n            this._silent_selection = true;\r\n            this.unselectAll();\r\n            this._silent_selection = false\r\n        }\r\n        if (this.isSelected(g)) {\r\n            if (e) {\r\n                this.unselect(g)\r\n            }\r\n            return\r\n        }\r\n        if (this._select_mark(g, true)) {\r\n            this.callEvent(\"onAfterSelect\", [g])\r\n        }\r\n    },\r\n    unselect: function(a) {\r\n        if (!a) {\r\n            return this.unselectAll()\r\n        }\r\n        if (!this.isSelected(a)) {\r\n            return\r\n        }\r\n        this._select_mark(a, false)\r\n    },\r\n    selectAll: function(g, e) {\r\n        var a;\r\n        var c = [];\r\n        if (g || e) {\r\n            a = this.data.getRange(g || null , e || null )\r\n        } else {\r\n            a = this.data.getRange()\r\n        }\r\n        a.each(function(h) {\r\n            var l = this.data.item(h.id);\r\n            if (!l.$selected) {\r\n                this._selected.push(h.id);\r\n                this._select_mark(h.id, true, c)\r\n            }\r\n            return h.id\r\n        }, this);\r\n        this._refresh_selection(c)\r\n    },\r\n    unselectAll: function() {\r\n        var a = [];\r\n        this._selected.each(function(c) {\r\n            this._select_mark(c, false, a)\r\n        }, this);\r\n        this._selected = dhtmlx.toArray();\r\n        this._refresh_selection(a)\r\n    },\r\n    isSelected: function(a) {\r\n        return this._selected.find(a) != -1\r\n    },\r\n    getSelected: function(a) {\r\n        switch (this._selected.length) {\r\n        case 0:\r\n            return a ? [] : \"\";\r\n        case 1:\r\n            return a ? [this._selected[0]] : this._selected[0];\r\n        default:\r\n            return ( [].concat(this._selected)) \r\n        }\r\n    },\r\n    _is_mass_selection: function(a) {\r\n        return a.length > 100 || a.length > this.data.dataCount / 2\r\n    },\r\n    _refresh_selection: function(c) {\r\n        if (typeof c != \"object\") {\r\n            c = [c]\r\n        }\r\n        if (!c.length) {\r\n            return\r\n        }\r\n        if (this._is_mass_selection(c)) {\r\n            this.data.refresh()\r\n        } else {\r\n            for (var a = 0; a < c.length; a++) {\r\n                this.render(c[a], this.data.item(c[a]), \"update\")\r\n            }\r\n        }\r\n        if (!this._silent_selection) {\r\n            this.callEvent(\"onSelectChange\", [c])\r\n        }\r\n    }\r\n};\r\ndhtmlx.RenderStack = {\r\n    _init: function() {\r\n        dhtmlx.assert(this.data, \"RenderStack :: Component doesn't have DataStore\");\r\n        dhtmlx.assert(dhtmlx.Template, \"dhtmlx.Template :: dhtmlx.Template is not accessible\");\r\n        this._html = document.createElement(\"DIV\")\r\n    },\r\n    _toHTML: function(a) {\r\n        dhtmlx.assert((!a.$template || this.type[\"template_\" + a.$template]), \"RenderStack :: Unknown template: \" + a.$template);\r\n        this.callEvent(\"onItemRender\", [a]);\r\n        return this.type._item_start(a, this.type) + (a.$template ? this.type[\"template_\" + a.$template] : this.type.template)(a, this.type) + this.type._item_end\r\n    },\r\n    _toHTMLObject: function(a) {\r\n        this._html.innerHTML = this._toHTML(a);\r\n        return this._html.firstChild\r\n    },\r\n    _locateHTML: function(a) {\r\n        if (this._htmlmap) {\r\n            return this._htmlmap[a]\r\n        }\r\n        this._htmlmap = {};\r\n        var e = this._dataobj.childNodes;\r\n        for (var c = 0; c < e.length; c++) {\r\n            var g = e[c].getAttribute(this._id);\r\n            if (g) {\r\n                this._htmlmap[g] = e[c]\r\n            }\r\n        }\r\n        return this._locateHTML(a)\r\n    },\r\n    locate: function(a) {\r\n        return dhtmlx.html.locate(a, this._id)\r\n    },\r\n    show: function(c) {\r\n        var a = this._locateHTML(c);\r\n        if (a) {\r\n            this._dataobj.scrollTop = a.offsetTop - this._dataobj.offsetTop\r\n        }\r\n    },\r\n    render: function(l, g, e, h) {\r\n        if (l) {\r\n            var a = this._locateHTML(l);\r\n            switch (e) {\r\n            case \"update\":\r\n                if (!a) {\r\n                    return\r\n                }\r\n                var c = this._htmlmap[l] = this._toHTMLObject(g);\r\n                dhtmlx.html.insertBefore(c, a);\r\n                dhtmlx.html.remove(a);\r\n                break;\r\n            case \"delete\":\r\n                if (!a) {\r\n                    return\r\n                }\r\n                dhtmlx.html.remove(a);\r\n                delete this._htmlmap[l];\r\n                break;\r\n            case \"add\":\r\n                var c = this._htmlmap[l] = this._toHTMLObject(g);\r\n                dhtmlx.html.insertBefore(c, this._locateHTML(this.data.next(l)), this._dataobj);\r\n                break;\r\n            case \"move\":\r\n                this.render(l, g, \"delete\");\r\n                this.render(l, g, \"add\");\r\n                break;\r\n            default:\r\n                dhtmlx.error(\"Unknown render command: \" + e);\r\n                break\r\n            }\r\n        } else {\r\n            if (this.callEvent(\"onBeforeRender\", [this.data])) {\r\n                this._dataobj.innerHTML = this.data.getRange().map(this._toHTML, this).join(\"\");\r\n                this._htmlmap = null \r\n            }\r\n        }\r\n        this.callEvent(\"onAfterRender\", [])\r\n    },\r\n    pager_setter: function(c) {\r\n        this.attachEvent(\"onBeforeRender\", function() {\r\n            var g = this._settings.pager._settings;\r\n            if (g.page == -1) {\r\n                return false\r\n            }\r\n            this.data.min = g.page * g.size;\r\n            this.data.max = (g.page + 1) * g.size - 1;\r\n            return true\r\n        });\r\n        var a = new dhtmlx.ui.pager(c);\r\n        var e = dhtmlx.bind(function() {\r\n            this.data.refresh()\r\n        }, this);\r\n        a.attachEvent(\"onRefresh\", e);\r\n        this.data.attachEvent(\"onStoreUpdated\", function(h) {\r\n            var g = this.dataCount();\r\n            if (g != a._settings.count) {\r\n                a._settings.count = g;\r\n                if (a._settings.page == -1) {\r\n                    a._settings.page = 0\r\n                }\r\n                a.refresh()\r\n            }\r\n        });\r\n        return a\r\n    },\r\n    height_setter: function(a) {\r\n        if (a == \"auto\") {\r\n            this.attachEvent(\"onAfterRender\", this._correct_height);\r\n            dhtmlx.event(window, \"resize\", dhtmlx.bind(this._correct_height, this))\r\n        }\r\n        return a\r\n    },\r\n    _correct_height: function() {\r\n        this._dataobj.style.overflow = \"hidden\";\r\n        this._dataobj.style.height = \"1px\";\r\n        var a = this._dataobj.scrollHeight;\r\n        this._dataobj.style.height = a + \"px\";\r\n        if (dhtmlx._isFF) {\r\n            var c = this._dataobj.scrollHeight;\r\n            if (c != a) {\r\n                this._dataobj.style.height = c + \"px\"\r\n            }\r\n        }\r\n        this._obj.style.height = this._dataobj.style.height\r\n    },\r\n    _getDimension: function() {\r\n        var a = this.type;\r\n        var c = (a.border || 0) + (a.padding || 0) * 2 + (a.margin || 0) * 2;\r\n        return {\r\n            x: a.width + c,\r\n            y: a.height + c\r\n        }\r\n    },\r\n    x_count_setter: function(c) {\r\n        var e = this._getDimension();\r\n        var a = dhtmlx.$customScroll ? 0 : 18;\r\n        this._dataobj.style.width = e.x * c + (this._settings.height != \"auto\" ? a : 0) + \"px\";\r\n        return c\r\n    },\r\n    y_count_setter: function(a) {\r\n        var c = this._getDimension();\r\n        this._dataobj.style.height = c.y * a + \"px\";\r\n        return a\r\n    }\r\n};\r\ndhtmlx.VirtualRenderStack = {\r\n    _init: function() {\r\n        dhtmlx.assert(this.render, \"VirtualRenderStack :: Object must use RenderStack first\");\r\n        this._htmlmap = {};\r\n        this._dataobj.style.overflowY = \"scroll\";\r\n        dhtmlx.event(this._dataobj, \"scroll\", dhtmlx.bind(this._render_visible_rows, this));\r\n        dhtmlx.event(window, \"resize\", dhtmlx.bind(function() {\r\n            this.render()\r\n        }, this));\r\n        this.data._unrendered_area = [];\r\n        this.data.getIndexRange = this._getIndexRange\r\n    },\r\n    _locateHTML: function(a) {\r\n        return this._htmlmap[a]\r\n    },\r\n    show: function(e) {\r\n        range = this._getVisibleRange();\r\n        var c = this.data.indexById(e);\r\n        var a = Math.floor(c / range._dx) * range._y;\r\n        this._dataobj.scrollTop = a\r\n    },\r\n    _getIndexRange: function(h, g) {\r\n        if (g !== 0) {\r\n            g = Math.min((g || Infinity), this.dataCount() - 1)\r\n        }\r\n        var a = dhtmlx.toArray();\r\n        for (var c = (h || 0); c <= g; c++) {\r\n            var e = this.item(this.order[c]);\r\n            if (this.order.length > c) {\r\n                if (!e) {\r\n                    this.order[c] = dhtmlx.uid();\r\n                    e = {\r\n                        id: this.order[c],\r\n                        $template: \"loading\"\r\n                    };\r\n                    this._unrendered_area.push(this.order[c])\r\n                } else {\r\n                    if (e.$template == \"loading\") {\r\n                        this._unrendered_area.push(this.order[c])\r\n                    }\r\n                }\r\n                a.push(e)\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    render: function(l, g, e, h) {\r\n        if (l) {\r\n            var a = this._locateHTML(l);\r\n            switch (e) {\r\n            case \"update\":\r\n                if (!a) {\r\n                    return\r\n                }\r\n                var c = this._htmlmap[l] = this._toHTMLObject(g);\r\n                dhtmlx.html.insertBefore(c, a);\r\n                dhtmlx.html.remove(a);\r\n                break;\r\n            default:\r\n                this._render_delayed();\r\n                break\r\n            }\r\n        } else {\r\n            if (this.callEvent(\"onBeforeRender\", [this.data])) {\r\n                this._htmlmap = {};\r\n                this._render_visible_rows(null , true);\r\n                this._wait_for_render = false;\r\n                this.callEvent(\"onAfterRender\", [])\r\n            }\r\n        }\r\n    },\r\n    _render_delayed: function() {\r\n        if (this._wait_for_render) {\r\n            return\r\n        }\r\n        this._wait_for_render = true;\r\n        window.setTimeout(dhtmlx.bind(function() {\r\n            this.render()\r\n        }, this), 1)\r\n    },\r\n    _create_placeholder: function(a) {\r\n        var c = document.createElement(\"DIV\");\r\n        c.className = \"dhxdataview_placeholder\";\r\n        c.style.cssText = \"height:\" + a + \"px; width:100%; overflow:hidden;\";\r\n        return c\r\n    },\r\n    _render_visible_rows: function(C, F) {\r\n        this.data._unrendered_area = [];\r\n        var A = this._getVisibleRange();\r\n        if (!this._dataobj.firstChild || F) {\r\n            this._dataobj.innerHTML = \"\";\r\n            this._dataobj.appendChild(this._create_placeholder(A._max));\r\n            this._htmlrows = [this._dataobj.firstChild]\r\n        }\r\n        var l = Math.max(A._from, 0);\r\n        var y = (this.data.max || this.data.max === 0) ? this.data.max : Infinity;\r\n        while (l <= A._height) {\r\n            while (this._htmlrows[l] && this._htmlrows[l]._filled && l <= A._height) {\r\n                l++\r\n            }\r\n            if (l > A._height) {\r\n                break\r\n            }\r\n            var o = l;\r\n            while (!this._htmlrows[o]) {\r\n                o--\r\n            }\r\n            var a = this._htmlrows[o];\r\n            var g = l * A._dx + (this.data.min || 0);\r\n            if (g > y) {\r\n                break\r\n            }\r\n            var m = Math.min(g + A._dx - 1, y);\r\n            var s = this._create_placeholder(A._y);\r\n            var n = this.data.getIndexRange(g, m);\r\n            if (!n.length) {\r\n                break\r\n            }\r\n            s.innerHTML = n.map(this._toHTML, this).join(\"\");\r\n            for (var w = 0; w < n.length; w++) {\r\n                this._htmlmap[this.data.idByIndex(g + w)] = s.childNodes[w]\r\n            }\r\n            var x = parseInt(a.style.height, 10);\r\n            var E = (l - o) * A._y;\r\n            var v = (x - E - A._y);\r\n            dhtmlx.html.insertBefore(s, E ? a.nextSibling : a, this._dataobj);\r\n            this._htmlrows[l] = s;\r\n            s._filled = true;\r\n            if (E <= 0 && v > 0) {\r\n                a.style.height = v + \"px\";\r\n                this._htmlrows[l + 1] = a\r\n            } else {\r\n                if (E < 0) {\r\n                    dhtmlx.html.remove(a)\r\n                } else {\r\n                    a.style.height = E + \"px\"\r\n                }\r\n                if (v > 0) {\r\n                    var r = this._htmlrows[l + 1] = this._create_placeholder(v);\r\n                    dhtmlx.html.insertBefore(r, s.nextSibling, this._dataobj)\r\n                }\r\n            }\r\n            l++\r\n        }\r\n        if (this.data._unrendered_area.length) {\r\n            var u = this.indexById(this.data._unrendered_area[0]);\r\n            var c = this.indexById(this.data._unrendered_area.pop()) + 1;\r\n            if (c > u) {\r\n                if (!this.callEvent(\"onDataRequest\", [u, c - u])) {\r\n                    return false\r\n                }\r\n                dhtmlx.assert(this.data.feed, \"Data feed is missed\");\r\n                this.data.feed.call(this, u, c - u)\r\n            }\r\n        }\r\n        if (dhtmlx._isIE) {\r\n            var D = this._getVisibleRange();\r\n            if (D._from != A._from) {\r\n                this._render_visible_rows()\r\n            }\r\n        }\r\n    },\r\n    _getVisibleRange: function() {\r\n        var c = dhtmlx.$customScroll ? 0 : 18;\r\n        var m = this._dataobj.scrollTop;\r\n        var a = this._dataobj.scrollWidth;\r\n        var n = this._dataobj.offsetHeight;\r\n        var r = this.type;\r\n        var g = this._getDimension();\r\n        var s = Math.floor(a / g.x) || 1;\r\n        var e = Math.floor(m / g.y);\r\n        var o = Math.ceil((n + m) / g.y) - 1;\r\n        var h = this.data.max ? (this.data.max - this.data.min) : this.data.dataCount();\r\n        var l = Math.ceil(h / s) * g.y;\r\n        return {\r\n            _from: e,\r\n            _height: o,\r\n            _top: m,\r\n            _max: l,\r\n            _y: g.y,\r\n            _dx: s\r\n        }\r\n    }\r\n};\r\ndhtmlXDataView = function(a) {\r\n    this.name = \"DataView\";\r\n    if (dhtmlx.assert_enabled()) {\r\n        this._assert()\r\n    }\r\n    dhtmlx.extend(this, dhtmlx.Settings);\r\n    this._parseContainer(a, \"dhx_dataview\");\r\n    dhtmlx.extend(this, dhtmlx.AtomDataLoader);\r\n    dhtmlx.extend(this, dhtmlx.DataLoader);\r\n    dhtmlx.extend(this, dhtmlx.EventSystem);\r\n    dhtmlx.extend(this, dhtmlx.RenderStack);\r\n    dhtmlx.extend(this, dhtmlx.SelectionModel);\r\n    dhtmlx.extend(this, dhtmlx.MouseEvents);\r\n    dhtmlx.extend(this, dhtmlx.KeyEvents);\r\n    dhtmlx.extend(this, dhtmlx.EditAbility);\r\n    dhtmlx.extend(this, dhtmlx.DataMove);\r\n    dhtmlx.extend(this, dhtmlx.DragItem);\r\n    dhtmlx.extend(this, dhtmlx.DataProcessor);\r\n    dhtmlx.extend(this, dhtmlx.AutoTooltip);\r\n    dhtmlx.extend(this, dhtmlx.Destruction);\r\n    this.data.attachEvent(\"onStoreUpdated\", dhtmlx.bind(function() {\r\n        this.render.apply(this, arguments)\r\n    }, this));\r\n    this._parseSettings(a, {\r\n        drag: false,\r\n        edit: false,\r\n        select: \"multiselect\",\r\n        type: \"default\"\r\n    });\r\n    if (this._settings.height != \"auto\" && !this._settings.renderAll) {\r\n        dhtmlx.extend(this, dhtmlx.VirtualRenderStack)\r\n    }\r\n    this.data.provideApi(this, true);\r\n    if (this.config.autowidth) {\r\n        this.attachEvent(\"onBeforeRender\", function() {\r\n            this.type.width = Math.floor((this._dataobj.scrollWidth) / (this.config.autowidth * 1 || 1)) - this.type.padding * 2 - this.type.margin * 2 - this.type.border * 2;\r\n            this.type._item_start = dhtmlx.Template.fromHTML(this.template_item_start(this.type));\r\n            this.type._item_end = this.template_item_end(this.type)\r\n        });\r\n        dhtmlx.event(window, \"resize\", function() {\r\n            this.refresh()\r\n        }, this)\r\n    }\r\n    if (dhtmlx.$customScroll) {\r\n        dhtmlx.CustomScroll.enable(this)\r\n    }\r\n}\r\n;\r\ndhtmlXDataView.prototype = {\r\n    bind: function() {\r\n        dhx.BaseBind.legacyBind.apply(this, arguments)\r\n    },\r\n    sync: function() {\r\n        dhx.BaseBind.legacySync.apply(this, arguments)\r\n    },\r\n    dragMarker: function(e, h) {\r\n        var g = this._locateHTML(e.target);\r\n        if (this.type.drag_marker) {\r\n            if (this._drag_marker) {\r\n                this._drag_marker.style.backgroundImage = \"\";\r\n                this._drag_marker.style.backgroundRepeat = \"\"\r\n            }\r\n            if (g) {\r\n                g.style.backgroundImage = \"url(\" + (dhtmlx.image_path || \"\") + this.type.drag_marker + \")\";\r\n                g.style.backgroundRepeat = \"no-repeat\";\r\n                this._drag_marker = g\r\n            }\r\n        }\r\n        if (g && this._settings.auto_scroll) {\r\n            var a = g.offsetTop;\r\n            var l = g.offsetHeight;\r\n            var c = this._obj.scrollTop;\r\n            var m = this._obj.offsetHeight;\r\n            if (a - l >= 0 && a - l * 0.75 < c) {\r\n                c = Math.max(a - l, 0)\r\n            } else {\r\n                if (a + l / 0.75 > c + m) {\r\n                    c = c + l\r\n                }\r\n            }\r\n            this._obj.scrollTop = c\r\n        }\r\n        return true\r\n    },\r\n    _id: \"dhx_f_id\",\r\n    on_click: {\r\n        dhx_dataview_item: function(a, c) {\r\n            if (this.stopEdit(false, c)) {\r\n                if (this._settings.select) {\r\n                    if (this._settings.select == \"multiselect\") {\r\n                        this.select(c, a.ctrlKey, a.shiftKey)\r\n                    } else {\r\n                        this.select(c)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    on_dblclick: {\r\n        dhx_dataview_item: function(a, c) {\r\n            if (this._settings.edit) {\r\n                this.edit(c)\r\n            }\r\n        }\r\n    },\r\n    on_mouse_move: {},\r\n    types: {\r\n        \"default\": {\r\n            css: \"default\",\r\n            template: dhtmlx.Template.fromHTML(\"<div style='padding:10px; white-space:nowrap; overflow:hidden;'>{obj.text}</div>\"),\r\n            template_edit: dhtmlx.Template.fromHTML(\"<div style='padding:10px; white-space:nowrap; overflow:hidden;'><textarea style='width:100%; height:100%;' bind='obj.text'></textarea></div>\"),\r\n            template_loading: dhtmlx.Template.fromHTML(\"<div style='padding:10px; white-space:nowrap; overflow:hidden;'>Loading...</div>\"),\r\n            width: 210,\r\n            height: 115,\r\n            margin: 0,\r\n            padding: 10,\r\n            border: 1\r\n        }\r\n    },\r\n    template_item_start: dhtmlx.Template.fromHTML(\"<div dhx_f_id='{-obj.id}' class='dhx_dataview_item dhx_dataview_{obj.css}_item{-obj.$selected?_selected:}' style='width:{obj.width}px; height:{obj.height}px; padding:{obj.padding}px; margin:{obj.margin}px; float:left; overflow:hidden;'>\"),\r\n    template_item_end: dhtmlx.Template.fromHTML(\"</div>\")\r\n};\r\ndhtmlx.compat(\"layout\");\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachDataView = function(a) {\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"dataview\"]);\r\n        var c = document.createElement(\"DIV\");\r\n        c.style.width = \"100%\";\r\n        c.style.height = \"100%\";\r\n        c.style.position = \"relative\";\r\n        c.style.overflow = \"hidden\";\r\n        this._attachObject(c);\r\n        if (typeof (a) == \"undefined\") {\r\n            a = {}\r\n        }\r\n        c.id = \"DataViewObject_\" + new Date().getTime();\r\n        a.container = c.id;\r\n        a.skin = this.conf.skin;\r\n        this.dataType = \"dataview\";\r\n        this.dataObj = new dhtmlXDataView(a);\r\n        this.dataObj.setSizes = function() {\r\n            this.render()\r\n        }\r\n        ;\r\n        c = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataObj\r\n    }\r\n}\r\ndhtmlXList = function(a) {\r\n    this.name = \"List\";\r\n    dhtmlx.extend(this, dhtmlx.Settings);\r\n    this._parseContainer(a, \"dhx_list\");\r\n    dhtmlx.extend(this, dhtmlx.AtomDataLoader);\r\n    dhtmlx.extend(this, dhtmlx.DataLoader);\r\n    dhtmlx.extend(this, dhtmlx.EventSystem);\r\n    dhtmlx.extend(this, dhtmlx.RenderStack);\r\n    dhtmlx.extend(this, dhtmlx.SelectionModel);\r\n    dhtmlx.extend(this, dhtmlx.MouseEvents);\r\n    dhtmlx.extend(this, dhtmlx.KeyEvents);\r\n    dhtmlx.extend(this, dhtmlx.EditAbility);\r\n    dhtmlx.extend(this, dhtmlx.DataMove);\r\n    dhtmlx.extend(this, dhtmlx.DragItem);\r\n    dhtmlx.extend(this, dhtmlx.DataProcessor);\r\n    dhtmlx.extend(this, dhtmlx.AutoTooltip);\r\n    dhtmlx.extend(this, dhtmlx.Destruction);\r\n    this._getDimension = function() {\r\n        var c = this.type;\r\n        var e = (c.margin || 0) * 2;\r\n        return {\r\n            x: c.width + e,\r\n            y: c.height + e\r\n        }\r\n    }\r\n    ;\r\n    this.data.attachEvent(\"onStoreUpdated\", dhtmlx.bind(function() {\r\n        this.render.apply(this, arguments)\r\n    }, this));\r\n    this._parseSettings(a, {\r\n        drag: false,\r\n        edit: false,\r\n        select: \"multiselect\",\r\n        type: \"default\"\r\n    });\r\n    this.data.provideApi(this, true);\r\n    if (dhtmlx.$customScroll) {\r\n        dhtmlx.CustomScroll.enable(this)\r\n    }\r\n}\r\n;\r\ndhtmlXList.prototype = {\r\n    bind: function() {\r\n        dhx.BaseBind.legacyBind.apply(this, arguments)\r\n    },\r\n    sync: function() {\r\n        dhx.BaseBind.legacySync.apply(this, arguments)\r\n    },\r\n    dragMarker: function(e, h) {\r\n        var g = this._locateHTML(e.target);\r\n        if (g && this._settings.auto_scroll) {\r\n            var a = g.offsetTop;\r\n            var l = g.offsetHeight;\r\n            var c = this._obj.scrollTop;\r\n            var m = this._obj.offsetHeight;\r\n            if (a - l >= 0 && a - l * 0.75 < c) {\r\n                c = Math.max(a - l, 0)\r\n            } else {\r\n                if (a + l / 0.75 > c + m) {\r\n                    c = c + l\r\n                }\r\n            }\r\n            this._obj.scrollTop = c\r\n        }\r\n        return true\r\n    },\r\n    _id: \"dhx_f_id\",\r\n    on_click: {\r\n        dhx_list_item: function(a, c) {\r\n            if (this.stopEdit(false, c)) {\r\n                if (this._settings.select) {\r\n                    if (this._settings.select == \"multiselect\") {\r\n                        this.select(c, a.ctrlKey, a.shiftKey)\r\n                    } else {\r\n                        this.select(c)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    on_dblclick: {\r\n        dhx_list_item: function(a, c) {\r\n            if (this._settings.edit) {\r\n                this.edit(c)\r\n            }\r\n        }\r\n    },\r\n    on_mouse_move: {},\r\n    types: {\r\n        \"default\": {\r\n            css: \"default\",\r\n            template: dhtmlx.Template.fromHTML(\"<div style='padding:10px; white-space:nowrap; overflow:hidden;'>{obj.text}</div>\"),\r\n            template_edit: dhtmlx.Template.fromHTML(\"<div style='padding:10px; white-space:nowrap; overflow:hidden;'><textarea bind='obj.text'></textarea></div>\"),\r\n            template_loading: dhtmlx.Template.fromHTML(\"<div style='padding:10px; white-space:nowrap; overflow:hidden;'>Loading...</div>\"),\r\n            height: 50,\r\n            margin: 0,\r\n            padding: 10,\r\n            border: 1\r\n        }\r\n    },\r\n    template_item_start: dhtmlx.Template.fromHTML(\"<div dhx_f_id='{-obj.id}' class='dhx_list_item dhx_list_{obj.css}_item{-obj.$selected?_selected:}' style='width:100%; height:{obj.height}px; padding:{obj.padding}px; margin:{obj.margin}px; overflow:hidden;'>\"),\r\n    template_item_end: dhtmlx.Template.fromHTML(\"</div>\")\r\n};\r\ndhtmlx.compat(\"layout\");\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachList = function(a) {\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"list\"]);\r\n        var c = document.createElement(\"DIV\");\r\n        c.style.width = \"100%\";\r\n        c.style.height = \"100%\";\r\n        c.style.position = \"relative\";\r\n        c.style.overflow = \"hidden\";\r\n        this._attachObject(c);\r\n        if (typeof (a) == \"undefined\") {\r\n            a = {}\r\n        }\r\n        c.id = \"ListObject_\" + new Date().getTime();\r\n        a.container = c.id;\r\n        a.skin = this.conf.skin;\r\n        this.dataType = \"list\";\r\n        this.dataObj = new dhtmlXList(a);\r\n        this.dataObj.setSizes = function() {\r\n            this.render()\r\n        }\r\n        ;\r\n        c = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataObj\r\n    }\r\n}\r\nfunction xmlPointer(a) {\r\n    this.d = a\r\n}\r\nxmlPointer.prototype = {\r\n    text: function() {\r\n        if (!_isFF) {\r\n            return this.d.xml\r\n        }\r\n        var a = new XMLSerializer();\r\n        return a.serializeToString(this.d)\r\n    },\r\n    get: function(a) {\r\n        return this.d.getAttribute(a)\r\n    },\r\n    exists: function() {\r\n        return !!this.d\r\n    },\r\n    content: function() {\r\n        return this.d.firstChild ? (this.d.firstChild.wholeText || this.d.firstChild.data) : \"\"\r\n    },\r\n    each: function(g, m, l, h) {\r\n        var e = this.d.childNodes;\r\n        var n = new xmlPointer();\r\n        if (e.length) {\r\n            for (h = h || 0; h < e.length; h++) {\r\n                if (e[h].tagName == g) {\r\n                    n.d = e[h];\r\n                    if (m.apply(l, [n, h]) == -1) {\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    get_all: function() {\r\n        var e = {};\r\n        var c = this.d.attributes;\r\n        for (var g = 0; g < c.length; g++) {\r\n            e[c[g].name] = c[g].value\r\n        }\r\n        return e\r\n    },\r\n    sub: function(g) {\r\n        var e = this.d.childNodes;\r\n        var l = new xmlPointer();\r\n        if (e.length) {\r\n            for (var h = 0; h < e.length; h++) {\r\n                if (e[h].tagName == g) {\r\n                    l.d = e[h];\r\n                    return l\r\n                }\r\n            }\r\n        }\r\n    },\r\n    up: function(a) {\r\n        return new xmlPointer(this.d.parentNode)\r\n    },\r\n    set: function(a, c) {\r\n        this.d.setAttribute(a, c)\r\n    },\r\n    clone: function(a) {\r\n        return new xmlPointer(this.d)\r\n    },\r\n    sub_exists: function(e) {\r\n        var c = this.d.childNodes;\r\n        if (c.length) {\r\n            for (var g = 0; g < c.length; g++) {\r\n                if (c[g].tagName == e) {\r\n                    return true\r\n                }\r\n            }\r\n        }\r\n        return false\r\n    },\r\n    through: function(e, m, r, h, s) {\r\n        var n = this.d.childNodes;\r\n        if (n.length) {\r\n            for (var g = 0; g < n.length; g++) {\r\n                if (n[g].tagName == e && n[g].getAttribute(m) != null  && n[g].getAttribute(m) != \"\" && (!r || n[g].getAttribute(m) == r)) {\r\n                    var l = new xmlPointer(n[g]);\r\n                    h.apply(s, [l, g])\r\n                }\r\n                var o = this.d;\r\n                this.d = n[g];\r\n                this.through(e, m, r, h, s);\r\n                this.d = o\r\n            }\r\n        }\r\n    }\r\n};\r\nfunction dhtmlXTreeObject(m, h, c, a) {\r\n    if (dhtmlxEvent.initTouch) {\r\n        dhtmlxEvent.initTouch()\r\n    }\r\n    if (_isIE) {\r\n        try {\r\n            document.execCommand(\"BackgroundImageCache\", false, true)\r\n        } catch (l) {}\r\n    }\r\n    if (typeof (m) != \"object\") {\r\n        this.parentObject = document.getElementById(m)\r\n    } else {\r\n        this.parentObject = m\r\n    }\r\n    this.parentObject.style.overflow = \"hidden\";\r\n    this._itim_dg = true;\r\n    this.dlmtr = \",\";\r\n    this.dropLower = false;\r\n    this.enableIEImageFix(true);\r\n    this.xmlstate = 0;\r\n    this.mytype = \"tree\";\r\n    this.smcheck = true;\r\n    this.width = h;\r\n    this.height = c;\r\n    this.rootId = a;\r\n    this.childCalc = null ;\r\n    this.def_img_x = \"18px\";\r\n    this.def_img_y = \"18px\";\r\n    this.def_line_img_x = \"18px\";\r\n    this.def_line_img_y = \"24px\";\r\n    this._dragged = new Array();\r\n    this._selected = new Array();\r\n    this.style_pointer = \"pointer\";\r\n    this._aimgs = true;\r\n    this.htmlcA = \" [\";\r\n    this.htmlcB = \"]\";\r\n    this.lWin = window;\r\n    this.cMenu = 0;\r\n    this.mlitems = 0;\r\n    this.iconURL = \"\";\r\n    this.dadmode = 0;\r\n    this.slowParse = false;\r\n    this.autoScroll = true;\r\n    this.hfMode = 0;\r\n    this.nodeCut = new Array();\r\n    this.XMLsource = 0;\r\n    this.XMLloadingWarning = 0;\r\n    this._idpull = {};\r\n    this._pullSize = 0;\r\n    this.treeLinesOn = true;\r\n    this.tscheck = false;\r\n    this.timgen = true;\r\n    this.dpcpy = false;\r\n    this._ld_id = null ;\r\n    this._dynDeleteBranches = {};\r\n    this._oie_onXLE = [];\r\n    this.imPath = window.dhx_globalImgPath || \"\";\r\n    this.checkArray = new Array(\"iconUncheckAll.gif\",\"iconCheckAll.gif\",\"iconCheckGray.gif\",\"iconUncheckDis.gif\",\"iconCheckDis.gif\",\"iconCheckDis.gif\");\r\n    this.radioArray = new Array(\"radio_off.gif\",\"radio_on.gif\",\"radio_on.gif\",\"radio_off.gif\",\"radio_on.gif\",\"radio_on.gif\");\r\n    this.lineArray = new Array(\"line2.gif\",\"line3.gif\",\"line4.gif\",\"blank.gif\",\"blank.gif\",\"line1.gif\");\r\n    this.minusArray = new Array(\"minus2.gif\",\"minus3.gif\",\"minus4.gif\",\"minus.gif\",\"minus5.gif\");\r\n    this.plusArray = new Array(\"plus2.gif\",\"plus3.gif\",\"plus4.gif\",\"plus.gif\",\"plus5.gif\");\r\n    this.imageArray = new Array(\"leaf.gif\",\"folderOpen.gif\",\"folderClosed.gif\");\r\n    this.cutImg = new Array(0,0,0);\r\n    this.cutImage = \"but_cut.gif\";\r\n    dhx4._eventable(this);\r\n    this.dragger = new dhtmlDragAndDropObject();\r\n    this.htmlNode = new dhtmlXTreeItemObject(this.rootId,\"\",0,this);\r\n    this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display = \"none\";\r\n    this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className = \"hiddenRow\";\r\n    this.allTree = this._createSelf();\r\n    this.allTree.appendChild(this.htmlNode.htmlNode);\r\n    if (dhtmlx.$customScroll) {\r\n        dhtmlx.CustomScroll.enable(this)\r\n    }\r\n    if (_isFF) {\r\n        this.allTree.childNodes[0].width = \"100%\";\r\n        this.allTree.childNodes[0].style.overflow = \"hidden\"\r\n    }\r\n    var g = this;\r\n    this.allTree.onselectstart = new Function(\"return false;\");\r\n    if (_isMacOS) {\r\n        this.allTree.oncontextmenu = function(n) {\r\n            return g._doContClick(n || window.event, true)\r\n        }\r\n    }\r\n    this.allTree.onmousedown = function(n) {\r\n        return g._doContClick(n || window.event)\r\n    }\r\n    ;\r\n    this.XMLLoader = this._parseXMLTree;\r\n    if (_isIE) {\r\n        this.preventIECashing(true)\r\n    }\r\n    this.selectionBar = document.createElement(\"DIV\");\r\n    this.selectionBar.className = \"selectionBar\";\r\n    this.selectionBar.innerHTML = \"&nbsp;\";\r\n    this.selectionBar.style.display = \"none\";\r\n    this.allTree.appendChild(this.selectionBar);\r\n    if (window.addEventListener) {\r\n        window.addEventListener(\"unload\", function() {\r\n            try {\r\n                g.destructor()\r\n            } catch (n) {}\r\n        }, false)\r\n    }\r\n    if (window.attachEvent) {\r\n        window.attachEvent(\"onunload\", function() {\r\n            try {\r\n                g.destructor()\r\n            } catch (n) {}\r\n        })\r\n    }\r\n    this.setImagesPath = this.setImagePath;\r\n    this.setIconsPath = this.setIconPath;\r\n    if (dhtmlx.image_path) {\r\n        this.setImagePath(dhtmlx.image_path)\r\n    }\r\n    this.setSkin(window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxtree\") || \"dhx_skyblue\");\r\n    return this\r\n}\r\ndhtmlXTreeObject.prototype.setDataMode = function(a) {\r\n    this._datamode = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._doContClick = function(m, a) {\r\n    if (!a && m.button != 2) {\r\n        if (this._acMenu) {\r\n            if (this._acMenu.hideContextMenu) {\r\n                this._acMenu.hideContextMenu()\r\n            } else {\r\n                this.cMenu._contextEnd()\r\n            }\r\n        }\r\n        return true\r\n    }\r\n    var c = (_isIE ? m.srcElement : m.target);\r\n    while ((c) && (c.tagName != \"BODY\")) {\r\n        if (c.parentObject) {\r\n            break\r\n        }\r\n        c = c.parentNode\r\n    }\r\n    if ((!c) || (!c.parentObject)) {\r\n        return true\r\n    }\r\n    var h = c.parentObject;\r\n    if (!this.callEvent(\"onRightClick\", [h.id, m])) {\r\n        (m.srcElement || m.target).oncontextmenu = function(r) {\r\n            (r || event).cancelBubble = true;\r\n            return false\r\n        }\r\n    }\r\n    this._acMenu = (h.cMenu || this.cMenu);\r\n    if (this._acMenu) {\r\n        if (!(this.callEvent(\"onBeforeContextMenu\", [h.id]))) {\r\n            return true\r\n        }\r\n        if (!_isMacOS) {\r\n            (m.srcElement || m.target).oncontextmenu = function(r) {\r\n                (r || event).cancelBubble = true;\r\n                return false\r\n            }\r\n        }\r\n        if (this._acMenu.showContextMenu) {\r\n            var g = window.document.documentElement;\r\n            var e = window.document.body;\r\n            var n = new Array((g.scrollLeft || e.scrollLeft),(g.scrollTop || e.scrollTop));\r\n            if (_isIE) {\r\n                var o = m.clientX + n[0];\r\n                var l = m.clientY + n[1]\r\n            } else {\r\n                var o = m.pageX;\r\n                var l = m.pageY\r\n            }\r\n            this._acMenu.showContextMenu(o - 1, l - 1);\r\n            this.contextID = h.id;\r\n            m.cancelBubble = true;\r\n            this._acMenu._skip_hide = true\r\n        } else {\r\n            c.contextMenuId = h.id;\r\n            c.contextMenu = this._acMenu;\r\n            c.a = this._acMenu._contextStart;\r\n            c.a(c, m);\r\n            c.a = null \r\n        }\r\n        return false\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableIEImageFix = function(a) {\r\n    if (!a) {\r\n        this._getImg = function(c) {\r\n            return document.createElement((c == this.rootId) ? \"div\" : \"img\")\r\n        }\r\n        ;\r\n        this._setSrc = function(e, c) {\r\n            e.src = c\r\n        }\r\n        ;\r\n        this._getSrc = function(c) {\r\n            return c.src\r\n        }\r\n    } else {\r\n        this._getImg = function() {\r\n            var c = document.createElement(\"DIV\");\r\n            c.innerHTML = \"&nbsp;\";\r\n            c.className = \"dhx_bg_img_fix\";\r\n            return c\r\n        }\r\n        ;\r\n        this._setSrc = function(e, c) {\r\n            e.style.backgroundImage = \"url(\" + c + \")\"\r\n        }\r\n        ;\r\n        this._getSrc = function(c) {\r\n            var e = c.style.backgroundImage;\r\n            return e.substr(4, e.length - 5).replace(/(^\")|(\"$)/g, \"\")\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.destructor = function() {\r\n    for (var c in this._idpull) {\r\n        var e = this._idpull[c];\r\n        if (!e) {\r\n            continue\r\n        }\r\n        e.parentObject = null ;\r\n        e.treeNod = null ;\r\n        e.childNodes = null ;\r\n        e.span = null ;\r\n        e.tr.nodem = null ;\r\n        e.tr = null ;\r\n        e.htmlNode.objBelong = null ;\r\n        e.htmlNode = null ;\r\n        this._idpull[c] = null \r\n    }\r\n    this.parentObject.innerHTML = \"\";\r\n    this.allTree.onselectstart = null ;\r\n    this.allTree.oncontextmenu = null ;\r\n    this.allTree.onmousedown = null ;\r\n    for (var c in this) {\r\n        this[c] = null \r\n    }\r\n}\r\n;\r\nfunction cObject() {\r\n    return this\r\n}\r\ncObject.prototype = new Object;\r\ncObject.prototype.clone = function() {\r\n    function a() {}\r\n    a.prototype = this;\r\n    return new a()\r\n}\r\n;\r\nfunction dhtmlXTreeItemObject(l, c, e, a, g, h) {\r\n    this.htmlNode = \"\";\r\n    this.acolor = \"\";\r\n    this.scolor = \"\";\r\n    this.tr = 0;\r\n    this.childsCount = 0;\r\n    this.tempDOMM = 0;\r\n    this.tempDOMU = 0;\r\n    this.dragSpan = 0;\r\n    this.dragMove = 0;\r\n    this.span = 0;\r\n    this.closeble = 1;\r\n    this.childNodes = new Array();\r\n    this.userData = new cObject();\r\n    this.checkstate = 0;\r\n    this.treeNod = a;\r\n    this.label = c;\r\n    this.parentObject = e;\r\n    this.actionHandler = g;\r\n    this.images = new Array(a.imageArray[0],a.imageArray[1],a.imageArray[2]);\r\n    this.id = a._globalIdStorageAdd(l, this);\r\n    if (this.treeNod.checkBoxOff) {\r\n        this.htmlNode = this.treeNod._createItem(1, this, h)\r\n    } else {\r\n        this.htmlNode = this.treeNod._createItem(0, this, h)\r\n    }\r\n    this.htmlNode.objBelong = this;\r\n    return this\r\n}\r\ndhtmlXTreeObject.prototype._globalIdStorageAdd = function(c, a) {\r\n    if (this._globalIdStorageFind(c, 1, 1)) {\r\n        c = c + \"_\" + (new Date()).valueOf();\r\n        return this._globalIdStorageAdd(c, a)\r\n    }\r\n    this._idpull[c] = a;\r\n    this._pullSize++;\r\n    return c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._globalIdStorageSub = function(a) {\r\n    if (this._idpull[a]) {\r\n        this._unselectItem(this._idpull[a]);\r\n        this._idpull[a] = null ;\r\n        this._pullSize--\r\n    }\r\n    if ((this._locker) && (this._locker[a])) {\r\n        this._locker[a] = false\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._globalIdStorageFind = function(l, a, e, g) {\r\n    var h = this._idpull[l];\r\n    if (h) {\r\n        if ((h.unParsed) && (!e)) {\r\n            this.reParse(h, 0)\r\n        }\r\n        if (this._srnd && !h.htmlNode) {\r\n            this._buildSRND(h, e)\r\n        }\r\n        if ((g) && (this._edsbpsA)) {\r\n            for (var c = 0; c < this._edsbpsA.length; c++) {\r\n                if (this._edsbpsA[c][2] == l) {\r\n                    dhx4.callEvent(\"ongetItemError\", [\"Requested item still in parsing process.\", l]);\r\n                    return null \r\n                }\r\n            }\r\n        }\r\n        return h\r\n    }\r\n    if ((this.slowParse) && (l != 0) && (!a)) {\r\n        return this.preParse(l)\r\n    } else {\r\n        return null \r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getSubItemsXML = function(a) {\r\n    var c = [];\r\n    a.each(\"item\", function(e) {\r\n        c.push(e.get(\"id\"))\r\n    }, this);\r\n    return c.join(this.dlmtr)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableSmartXMLParsing = function(a) {\r\n    this.slowParse = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.findXML = function(c, a, e) {}\r\n;\r\ndhtmlXTreeObject.prototype._getAllCheckedXML = function(c, a, g) {\r\n    var e = [];\r\n    if (g == 2) {\r\n        c.through(\"item\", \"checked\", -1, function(h) {\r\n            e.push(h.get(\"id\"))\r\n        }, this)\r\n    }\r\n    if (g == 1) {\r\n        c.through(\"item\", \"id\", null , function(h) {\r\n            if (h.get(\"checked\") && (h.get(\"checked\") != -1)) {\r\n                e.push(h.get(\"id\"))\r\n            }\r\n        }, this)\r\n    }\r\n    if (g == 0) {\r\n        c.through(\"item\", \"id\", null , function(h) {\r\n            if (!h.get(\"checked\") || h.get(\"checked\") == 0) {\r\n                e.push(h.get(\"id\"))\r\n            }\r\n        }, this)\r\n    }\r\n    if (e.length) {\r\n        return a + (a ? this.dlmtr : \"\") + e.join(this.dlmtr)\r\n    }\r\n    if (a) {\r\n        return a\r\n    } else {\r\n        return \"\"\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._setSubCheckedXML = function(a, c) {\r\n    var e = a ? \"1\" : \"\";\r\n    c.through(\"item\", \"id\", null , function(g) {\r\n        if (!g.get(\"disabled\") || g.get(\"disabled\") == 0) {\r\n            g.set(\"checked\", e)\r\n        }\r\n    }, this)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllScraggyItemsXML = function(e, a) {\r\n    var g = [];\r\n    var c = function(h) {\r\n        if (!h.sub_exists(\"item\")) {\r\n            g.push(h.get(\"id\"))\r\n        } else {\r\n            h.each(\"item\", c, this)\r\n        }\r\n    }\r\n    ;\r\n    c(e);\r\n    return g.join(\",\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllFatItemsXML = function(e, a) {\r\n    var g = [];\r\n    var c = function(h) {\r\n        if (!h.sub_exists(\"item\")) {\r\n            return\r\n        }\r\n        g.push(h.get(\"id\"));\r\n        h.each(\"item\", c, this)\r\n    }\r\n    ;\r\n    c(e);\r\n    return g.join(\",\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllSubItemsXML = function(e, c, a) {\r\n    var c = [];\r\n    a.through(\"item\", \"id\", null , function(g) {\r\n        c.push(g.get(\"id\"))\r\n    }, this);\r\n    return c.join(\",\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.reParse = function(e) {\r\n    var l = this;\r\n    if (!this.parsCount) {\r\n        l.callEvent(\"onXLS\", [l, e.id])\r\n    }\r\n    this.xmlstate = 1;\r\n    var g = e.unParsed;\r\n    e.unParsed = 0;\r\n    this.XMLloadingWarning = 1;\r\n    var a = this.parsingOn;\r\n    var m = this.waitUpdateXML;\r\n    var o = this.parsedArray;\r\n    this.parsedArray = new Array();\r\n    this.waitUpdateXML = false;\r\n    this.parsingOn = e.id;\r\n    this.parsedArray = new Array();\r\n    this.setCheckList = \"\";\r\n    this._parse(g, e.id, 2);\r\n    var r = this.setCheckList.split(this.dlmtr);\r\n    for (var h = 0; h < this.parsedArray.length; h++) {\r\n        e.htmlNode.childNodes[0].appendChild(this.parsedArray[h])\r\n    }\r\n    if (g.get(\"order\") && g.get(\"order\") != \"none\") {\r\n        this._reorderBranch(e, g.get(\"order\"), true)\r\n    }\r\n    this.oldsmcheck = this.smcheck;\r\n    this.smcheck = false;\r\n    for (var c = 0; c < r.length; c++) {\r\n        if (r[c]) {\r\n            this.setCheck(r[c], 1)\r\n        }\r\n    }\r\n    this.smcheck = this.oldsmcheck;\r\n    this.parsingOn = a;\r\n    this.waitUpdateXML = m;\r\n    this.parsedArray = o;\r\n    this.XMLloadingWarning = 0;\r\n    this._redrawFrom(this, e);\r\n    if (this._srnd && !e._sready) {\r\n        this.prepareSR(e.id)\r\n    }\r\n    this.xmlstate = 0;\r\n    return true\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.preParse = function(c) {\r\n    if (!c || !this._p) {\r\n        return null \r\n    }\r\n    var a = false;\r\n    this._p.clone().through(\"item\", \"id\", c, function(g) {\r\n        this._globalIdStorageFind(g.up().get(\"id\"));\r\n        return a = true\r\n    }, this);\r\n    if (a) {\r\n        var e = this._globalIdStorageFind(c, true, false);\r\n        if (!e) {\r\n            dhx4.callEvent(\"ongetItemError\", [\"The item \" + c + \" not operable. Seems you have non-unique|incorrect IDs in tree's XML.\", c])\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._escape = function(a) {\r\n    switch (this.utfesc) {\r\n    case \"none\":\r\n        return a;\r\n        break;\r\n    case \"utf8\":\r\n        return encodeURIComponent(a);\r\n        break;\r\n    default:\r\n        return escape(a);\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._drawNewTr = function(h, e) {\r\n    var g = document.createElement(\"tr\");\r\n    var c = document.createElement(\"td\");\r\n    var a = document.createElement(\"td\");\r\n    c.appendChild(document.createTextNode(\" \"));\r\n    a.colSpan = 3;\r\n    a.appendChild(h);\r\n    g.appendChild(c);\r\n    g.appendChild(a);\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.parse = function(g, e, a) {\r\n    if (typeof e == \"string\") {\r\n        a = e;\r\n        e = null \r\n    }\r\n    if (a === \"json\") {\r\n        return this._loadJSONObject(g, e)\r\n    } else {\r\n        if (a === \"csv\") {\r\n            return this._loadCSVString(g, e)\r\n        } else {\r\n            if (a === \"jsarray\") {\r\n                return this._loadJSArray(g, e)\r\n            }\r\n        }\r\n    }\r\n    var c = this;\r\n    if (!this.parsCount) {\r\n        this.callEvent(\"onXLS\", [c, null ])\r\n    }\r\n    this.xmlstate = 1;\r\n    this.XMLLoader({\r\n        responseXML: dhx4.ajax.parse(g)\r\n    }, e)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadXMLString = function() {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadXMLString was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this.parse.apply(this, arguments)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.load = function(c, h, e) {\r\n    if (typeof h == \"string\") {\r\n        e = h;\r\n        h = null \r\n    }\r\n    e = e || this._datamode;\r\n    if (e === \"json\") {\r\n        return this._loadJSON(c, h)\r\n    } else {\r\n        if (e === \"csv\") {\r\n            return this._loadCSV(c, h)\r\n        } else {\r\n            if (e === \"jsarray\") {\r\n                return this._loadJSArrayFile(xmlString, h)\r\n            }\r\n        }\r\n    }\r\n    var g = this;\r\n    if (!this.parsCount) {\r\n        this.callEvent(\"onXLS\", [g, this._ld_id])\r\n    }\r\n    this._ld_id = null ;\r\n    this.xmlstate = 1;\r\n    this.XMLLoader = this._parseXMLTree;\r\n    var a = this;\r\n    dhx4.ajax.get(c, function(l) {\r\n        a.XMLLoader(l.xmlDoc, h);\r\n        a = null \r\n    })\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadXML = function() {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadXML was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this.load.apply(this, arguments)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._attachChildNode = function(m, l, g, o, E, D, C, r, e, v, w) {\r\n    if (v && v.parentObject) {\r\n        m = v.parentObject\r\n    }\r\n    if (((m.XMLload == 0) && (this.XMLsource)) && (!this.XMLloadingWarning)) {\r\n        m.XMLload = 1;\r\n        this._loadDynXML(m.id)\r\n    }\r\n    var s = m.childsCount;\r\n    var F = m.childNodes;\r\n    if (w && w.tr.previousSibling) {\r\n        if (w.tr.previousSibling.previousSibling) {\r\n            v = w.tr.previousSibling.nodem\r\n        } else {\r\n            r = r.replace(\"TOP\", \"\") + \",TOP\"\r\n        }\r\n    }\r\n    if (v) {\r\n        var h, A;\r\n        for (h = 0; h < s; h++) {\r\n            if (F[h] == v) {\r\n                for (A = s; A != h; A--) {\r\n                    F[1 + A] = F[A]\r\n                }\r\n                break\r\n            }\r\n        }\r\n        h++;\r\n        s = h\r\n    }\r\n    if (r) {\r\n        var x = r.split(\",\");\r\n        for (var y = 0; y < x.length; y++) {\r\n            switch (x[y]) {\r\n            case \"TOP\":\r\n                if (m.childsCount > 0) {\r\n                    v = new Object;\r\n                    v.tr = m.childNodes[0].tr.previousSibling\r\n                }\r\n                m._has_top = true;\r\n                for (h = s; h > 0; h--) {\r\n                    F[h] = F[h - 1]\r\n                }\r\n                s = 0;\r\n                break\r\n            }\r\n        }\r\n    }\r\n    var u;\r\n    if (!(u = this._idpull[l]) || u.span != -1) {\r\n        u = F[s] = new dhtmlXTreeItemObject(l,g,m,this,o,1);\r\n        l = F[s].id;\r\n        m.childsCount++\r\n    }\r\n    if (!u.htmlNode) {\r\n        u.label = g;\r\n        u.htmlNode = this._createItem((this.checkBoxOff ? 1 : 0), u);\r\n        u.htmlNode.objBelong = u\r\n    }\r\n    if (E) {\r\n        u.images[0] = E\r\n    }\r\n    if (D) {\r\n        u.images[1] = D\r\n    }\r\n    if (C) {\r\n        u.images[2] = C\r\n    }\r\n    var c = this._drawNewTr(u.htmlNode);\r\n    if ((this.XMLloadingWarning) || (this._hAdI)) {\r\n        u.htmlNode.parentNode.parentNode.style.display = \"none\"\r\n    }\r\n    if ((v) && v.tr && (v.tr.nextSibling)) {\r\n        m.htmlNode.childNodes[0].insertBefore(c, v.tr.nextSibling)\r\n    } else {\r\n        if (this.parsingOn == m.id) {\r\n            this.parsedArray[this.parsedArray.length] = c\r\n        } else {\r\n            m.htmlNode.childNodes[0].appendChild(c)\r\n        }\r\n    }\r\n    if ((v) && (!v.span)) {\r\n        v = null \r\n    }\r\n    if (this.XMLsource) {\r\n        if ((e) && (e != 0)) {\r\n            u.XMLload = 0\r\n        } else {\r\n            u.XMLload = 1\r\n        }\r\n    }\r\n    u.tr = c;\r\n    c.nodem = u;\r\n    if (m.itemId == 0) {\r\n        c.childNodes[0].className = \"hiddenRow\"\r\n    }\r\n    if ((m._r_logic) || (this._frbtr)) {\r\n        this._setSrc(u.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0], this.imPath + this.radioArray[0])\r\n    }\r\n    if (r) {\r\n        var x = r.split(\",\");\r\n        for (var y = 0; y < x.length; y++) {\r\n            switch (x[y]) {\r\n            case \"SELECT\":\r\n                this.selectItem(l, false);\r\n                break;\r\n            case \"CALL\":\r\n                this.selectItem(l, true);\r\n                break;\r\n            case \"CHILD\":\r\n                u.XMLload = 0;\r\n                break;\r\n            case \"CHECKED\":\r\n                if (this.XMLloadingWarning) {\r\n                    this.setCheckList += this.dlmtr + l\r\n                } else {\r\n                    this.setCheck(l, 1)\r\n                }\r\n                break;\r\n            case \"HCHECKED\":\r\n                this._setCheck(u, \"unsure\");\r\n                break;\r\n            case \"OPEN\":\r\n                u.openMe = 1;\r\n                break\r\n            }\r\n        }\r\n    }\r\n    if (!this.XMLloadingWarning) {\r\n        if ((this._getOpenState(m) < 0) && (!this._hAdI)) {\r\n            this.openItem(m.id)\r\n        }\r\n        if (v) {\r\n            this._correctPlus(v);\r\n            this._correctLine(v)\r\n        }\r\n        this._correctPlus(m);\r\n        this._correctLine(m);\r\n        this._correctPlus(u);\r\n        if (m.childsCount >= 2) {\r\n            this._correctPlus(F[m.childsCount - 2]);\r\n            this._correctLine(F[m.childsCount - 2])\r\n        }\r\n        if (m.childsCount != 2) {\r\n            this._correctPlus(F[0])\r\n        }\r\n        if (this.tscheck) {\r\n            this._correctCheckStates(m)\r\n        }\r\n        if (this._onradh) {\r\n            if (this.xmlstate == 1) {\r\n                var a = this.onXLE;\r\n                this.onXLE = function(n) {\r\n                    this._onradh(l);\r\n                    if (a) {\r\n                        a(n)\r\n                    }\r\n                }\r\n            } else {\r\n                this._onradh(l)\r\n            }\r\n        }\r\n    }\r\n    return u\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableContextMenu = function(a) {\r\n    if (a) {\r\n        this.cMenu = a\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemContextMenu = function(h, g) {\r\n    var a = h.toString().split(this.dlmtr);\r\n    for (var e = 0; e < a.length; e++) {\r\n        var c = this._globalIdStorageFind(a[e]);\r\n        if (!c) {\r\n            continue\r\n        }\r\n        c.cMenu = g\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.insertNewItem = function(g, n, r, e, m, l, h, c, a) {\r\n    var s = this._globalIdStorageFind(g);\r\n    if (!s) {\r\n        return ( -1) \r\n    }\r\n    var o = this._attachChildNode(s, n, r, e, m, l, h, c, a);\r\n    if (!this._idpull[this.rootId].XMLload) {\r\n        this._idpull[this.rootId].XMLload = 1\r\n    }\r\n    if ((!this.XMLloadingWarning) && (this.childCalc)) {\r\n        this._fixChildCountLabel(s)\r\n    }\r\n    return o\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.insertNewChild = function(g, n, o, e, m, l, h, c, a) {\r\n    return this.insertNewItem(g, n, o, e, m, l, h, c, a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._parseXMLTree = function(a, e) {\r\n    var c = new xmlPointer(dhx4.ajax.xmltop(\"tree\", a));\r\n    this._parse(c);\r\n    this._p = c;\r\n    if (e) {\r\n        e.call(this, a)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._parseItem = function(l, r, h, n) {\r\n    var e;\r\n    if (this._srnd && (!this._idpull[e = l.get(\"id\")] || !this._idpull[e].span)) {\r\n        this._addItemSRND(r.id, e, l);\r\n        return\r\n    }\r\n    var m = l.get_all();\r\n    if ((typeof (this.waitUpdateXML) == \"object\") && (!this.waitUpdateXML[m.id])) {\r\n        this._parse(l, m.id, 1);\r\n        return\r\n    }\r\n    if ((m.text === null ) || (typeof (m.text) == \"undefined\")) {\r\n        m.text = l.sub(\"itemtext\");\r\n        if (m.text) {\r\n            m.text = m.text.content()\r\n        }\r\n    }\r\n    var u = [];\r\n    if (m.select) {\r\n        u.push(\"SELECT\")\r\n    }\r\n    if (m.top) {\r\n        u.push(\"TOP\")\r\n    }\r\n    if (m.call) {\r\n        this.nodeAskingCall = m.id\r\n    }\r\n    if (m.checked == -1) {\r\n        u.push(\"HCHECKED\")\r\n    } else {\r\n        if (m.checked) {\r\n            u.push(\"CHECKED\")\r\n        }\r\n    }\r\n    if (m.open) {\r\n        u.push(\"OPEN\")\r\n    }\r\n    if (this.waitUpdateXML) {\r\n        if (this._globalIdStorageFind(m.id)) {\r\n            var o = this.updateItem(m.id, m.text, m.im0, m.im1, m.im2, m.checked, m.child)\r\n        } else {\r\n            if (this.npl == 0) {\r\n                u.push(\"TOP\")\r\n            } else {\r\n                h = r.childNodes[this.npl]\r\n            }\r\n            var o = this._attachChildNode(r, m.id, m.text, 0, m.im0, m.im1, m.im2, u.join(\",\"), m.child, 0, h);\r\n            m.id = o.id;\r\n            h = null \r\n        }\r\n    } else {\r\n        var o = this._attachChildNode(r, m.id, m.text, 0, m.im0, m.im1, m.im2, u.join(\",\"), m.child, (n || 0), h)\r\n    }\r\n    if (m.tooltip) {\r\n        o.span.parentNode.parentNode.title = m.tooltip\r\n    }\r\n    if (m.style) {\r\n        if (o.span.style.cssText) {\r\n            o.span.style.cssText += (\";\" + m.style)\r\n        } else {\r\n            o.span.setAttribute(\"style\", o.span.getAttribute(\"style\") + \"; \" + m.style)\r\n        }\r\n    }\r\n    if (m.radio) {\r\n        o._r_logic = true\r\n    }\r\n    if (m.nocheckbox) {\r\n        var s = o.span.parentNode.previousSibling.previousSibling;\r\n        s.style.display = \"none\";\r\n        o.nocheckbox = true\r\n    }\r\n    if (m.disabled) {\r\n        if (m.checked != null ) {\r\n            this._setCheck(o, m.checked)\r\n        }\r\n        this.disableCheckbox(o, 1)\r\n    }\r\n    o._acc = m.child || 0;\r\n    if (this.parserExtension) {\r\n        this.parserExtension._parseExtension.call(this, l, m, (r ? r.id : 0))\r\n    }\r\n    this.setItemColor(o, m.aCol, m.sCol);\r\n    if (m.locked == \"1\") {\r\n        this.lockItem(o.id, true, true)\r\n    }\r\n    if ((m.imwidth) || (m.imheight)) {\r\n        this.setIconSize(m.imwidth, m.imheight, o)\r\n    }\r\n    if ((m.closeable == \"0\") || (m.closeable == \"1\")) {\r\n        this.setItemCloseable(o, m.closeable)\r\n    }\r\n    var g = \"\";\r\n    if (m.topoffset) {\r\n        this.setItemTopOffset(o, m.topoffset)\r\n    }\r\n    if ((!this.slowParse) || (typeof (this.waitUpdateXML) == \"object\")) {\r\n        if (l.sub_exists(\"item\")) {\r\n            g = this._parse(l, m.id, 1)\r\n        }\r\n    } else {\r\n        if ((!o.childsCount) && l.sub_exists(\"item\")) {\r\n            o.unParsed = l.clone()\r\n        }\r\n        l.each(\"userdata\", function(a) {\r\n            this.setUserData(m.id, a.get(\"name\"), a.content())\r\n        }, this)\r\n    }\r\n    if (g != \"\") {\r\n        this.nodeAskingCall = g\r\n    }\r\n    l.each(\"userdata\", function(a) {\r\n        this.setUserData(l.get(\"id\"), a.get(\"name\"), a.content())\r\n    }, this)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._parse = function(e, l, a, c) {\r\n    if (this._srnd && !this.parentObject.offsetHeight) {\r\n        var w = this;\r\n        return window.setTimeout(function() {\r\n            w._parse(e, l, a, c)\r\n        }, 100)\r\n    }\r\n    if (!e.exists()) {\r\n        return\r\n    }\r\n    this.skipLock = true;\r\n    if (!l) {\r\n        l = e.get(\"id\");\r\n        if (this._dynDeleteBranches[l]) {\r\n            this.deleteChildItems(l);\r\n            this._dynDeleteBranches[l]--;\r\n            if (!this._dynDeleteBranches[l]) {\r\n                delete this._dynDeleteBranches[l]\r\n            }\r\n        }\r\n        var u = e.get(\"dhx_security\");\r\n        if (u) {\r\n            dhtmlx.security_key = u\r\n        }\r\n        if (e.get(\"radio\")) {\r\n            this.htmlNode._r_logic = true\r\n        }\r\n        this.parsingOn = l;\r\n        this.parsedArray = new Array();\r\n        this.setCheckList = \"\";\r\n        this.nodeAskingCall = \"\"\r\n    }\r\n    var v = this._globalIdStorageFind(l);\r\n    if (!v) {\r\n        return dhx4.callEvent(\"onDataStructureError\", [\"XML refers to not existing parent\"])\r\n    }\r\n    this.parsCount = this.parsCount ? (this.parsCount + 1) : 1;\r\n    this.XMLloadingWarning = 1;\r\n    if ((v.childsCount) && (!c) && (!this._edsbps) && (!v._has_top)) {\r\n        var m = 0\r\n    } else {\r\n        var m = 0\r\n    }\r\n    this.npl = 0;\r\n    e.each(\"item\", function(x, n) {\r\n        v.XMLload = 1;\r\n        this._parseItem(x, v, 0, m);\r\n        if ((this._edsbps) && (this.npl == this._edsbpsC)) {\r\n            this._distributedStart(e, n + 1, l, a, v.childsCount);\r\n            return -1\r\n        }\r\n        this.npl++\r\n    }, this, c);\r\n    if (!a) {\r\n        e.each(\"userdata\", function(n) {\r\n            this.setUserData(e.get(\"id\"), n.get(\"name\"), n.content())\r\n        }, this);\r\n        v.XMLload = 1;\r\n        if (this.waitUpdateXML) {\r\n            this.waitUpdateXML = false;\r\n            for (var h = v.childsCount - 1; h >= 0; h--) {\r\n                if (v.childNodes[h]._dmark) {\r\n                    this.deleteItem(v.childNodes[h].id)\r\n                }\r\n            }\r\n        }\r\n        var r = this._globalIdStorageFind(this.parsingOn);\r\n        for (var h = 0; h < this.parsedArray.length; h++) {\r\n            v.htmlNode.childNodes[0].appendChild(this.parsedArray[h])\r\n        }\r\n        this.parsedArray = [];\r\n        this.lastLoadedXMLId = l;\r\n        this.XMLloadingWarning = 0;\r\n        var s = this.setCheckList.split(this.dlmtr);\r\n        for (var g = 0; g < s.length; g++) {\r\n            if (s[g]) {\r\n                this.setCheck(s[g], 1)\r\n            }\r\n        }\r\n        if ((this.XMLsource) && (this.tscheck) && (this.smcheck) && (v.id != this.rootId)) {\r\n            if (v.checkstate === 0) {\r\n                this._setSubChecked(0, v)\r\n            } else {\r\n                if (v.checkstate === 1) {\r\n                    this._setSubChecked(1, v)\r\n                }\r\n            }\r\n        }\r\n        this._redrawFrom(this, null , c);\r\n        if (e.get(\"order\") && e.get(\"order\") != \"none\") {\r\n            this._reorderBranch(v, e.get(\"order\"), true)\r\n        }\r\n        if (this.nodeAskingCall != \"\") {\r\n            this.callEvent(\"onClick\", [this.nodeAskingCall, this.getSelectedItemId()])\r\n        }\r\n        if (this._branchUpdate) {\r\n            this._branchUpdateNext(e)\r\n        }\r\n    }\r\n    if (this.parsCount == 1) {\r\n        this.parsingOn = null ;\r\n        if (this._srnd && v.id != this.rootId) {\r\n            this.prepareSR(v.id);\r\n            if (this.XMLsource) {\r\n                this.openItem(v.id)\r\n            }\r\n        }\r\n        e.through(\"item\", \"open\", null , function(n) {\r\n            this.openItem(n.get(\"id\"))\r\n        }, this);\r\n        if ((!this._edsbps) || (!this._edsbpsA.length)) {\r\n            var o = this;\r\n            window.setTimeout(function() {\r\n                o.callEvent(\"onXLE\", [o, l])\r\n            }, 1);\r\n            this.xmlstate = 0\r\n        }\r\n        this.skipLock = false\r\n    }\r\n    this.parsCount--;\r\n    var o = this;\r\n    if (this._edsbps) {\r\n        window.setTimeout(function() {\r\n            o._distributedStep(l)\r\n        }, this._edsbpsD)\r\n    }\r\n    if (!a && this.onXLE) {\r\n        this.onXLE(this, l)\r\n    }\r\n    return this.nodeAskingCall\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._branchUpdateNext = function(a) {\r\n    a.each(\"item\", function(g) {\r\n        var e = g.get(\"id\");\r\n        if (this._idpull[e] && (!this._idpull[e].XMLload)) {\r\n            return\r\n        }\r\n        this._branchUpdate++;\r\n        this.smartRefreshItem(g.get(\"id\"), g)\r\n    }, this);\r\n    this._branchUpdate--\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.checkUserData = function(c, e) {\r\n    if ((c.nodeType == 1) && (c.tagName == \"userdata\")) {\r\n        var a = c.getAttribute(\"name\");\r\n        if ((a) && (c.childNodes[0])) {\r\n            this.setUserData(e, a, c.childNodes[0].data)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._redrawFrom = function(n, c, m, e) {\r\n    if (!c) {\r\n        var h = n._globalIdStorageFind(n.lastLoadedXMLId);\r\n        n.lastLoadedXMLId = -1;\r\n        if (!h) {\r\n            return 0\r\n        }\r\n    } else {\r\n        h = c\r\n    }\r\n    var l = 0;\r\n    for (var g = (m ? m - 1 : 0); g < h.childsCount; g++) {\r\n        if ((!this._branchUpdate) || (this._getOpenState(h) == 1)) {\r\n            if ((!c) || (e == 1)) {\r\n                h.childNodes[g].htmlNode.parentNode.parentNode.style.display = \"\"\r\n            }\r\n        }\r\n        if (h.childNodes[g].openMe == 1) {\r\n            this._openItem(h.childNodes[g]);\r\n            h.childNodes[g].openMe = 0\r\n        }\r\n        n._redrawFrom(n, h.childNodes[g]);\r\n        if (this.childCalc != null ) {\r\n            if ((h.childNodes[g].unParsed) || ((!h.childNodes[g].XMLload) && (this.XMLsource))) {\r\n                if (h.childNodes[g]._acc) {\r\n                    h.childNodes[g].span.innerHTML = h.childNodes[g].label + this.htmlcA + h.childNodes[g]._acc + this.htmlcB\r\n                } else {\r\n                    h.childNodes[g].span.innerHTML = h.childNodes[g].label\r\n                }\r\n            }\r\n            if ((h.childNodes[g].childNodes.length) && (this.childCalc)) {\r\n                if (this.childCalc == 1) {\r\n                    h.childNodes[g].span.innerHTML = h.childNodes[g].label + this.htmlcA + h.childNodes[g].childsCount + this.htmlcB\r\n                }\r\n                if (this.childCalc == 2) {\r\n                    var a = h.childNodes[g].childsCount - (h.childNodes[g].pureChilds || 0);\r\n                    if (a) {\r\n                        h.childNodes[g].span.innerHTML = h.childNodes[g].label + this.htmlcA + a + this.htmlcB\r\n                    }\r\n                    if (h.pureChilds) {\r\n                        h.pureChilds++\r\n                    } else {\r\n                        h.pureChilds = 1\r\n                    }\r\n                }\r\n                if (this.childCalc == 3) {\r\n                    h.childNodes[g].span.innerHTML = h.childNodes[g].label + this.htmlcA + h.childNodes[g]._acc + this.htmlcB\r\n                }\r\n                if (this.childCalc == 4) {\r\n                    var a = h.childNodes[g]._acc;\r\n                    if (a) {\r\n                        h.childNodes[g].span.innerHTML = h.childNodes[g].label + this.htmlcA + a + this.htmlcB\r\n                    }\r\n                }\r\n            } else {\r\n                if (this.childCalc == 4) {\r\n                    l++\r\n                }\r\n            }\r\n            l += h.childNodes[g]._acc;\r\n            if (this.childCalc == 3) {\r\n                l++\r\n            }\r\n        }\r\n    }\r\n    if ((!h.unParsed) && ((h.XMLload) || (!this.XMLsource))) {\r\n        h._acc = l\r\n    }\r\n    n._correctLine(h);\r\n    n._correctPlus(h);\r\n    if ((this.childCalc) && (!c)) {\r\n        n._fixChildCountLabel(h)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._createSelf = function() {\r\n    var a = document.createElement(\"div\");\r\n    a.className = \"containerTableStyle\";\r\n    a.style.width = this.width;\r\n    a.style.height = this.height;\r\n    this.parentObject.appendChild(a);\r\n    return a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._xcloseAll = function(c) {\r\n    if (c.unParsed) {\r\n        return\r\n    }\r\n    if (this.rootId != c.id) {\r\n        if (!c.htmlNode) {\r\n            return\r\n        }\r\n        var g = c.htmlNode.childNodes[0].childNodes;\r\n        var a = g.length;\r\n        for (var e = 1; e < a; e++) {\r\n            g[e].style.display = \"none\"\r\n        }\r\n        this._correctPlus(c)\r\n    }\r\n    for (var e = 0; e < c.childsCount; e++) {\r\n        if (c.childNodes[e].childsCount) {\r\n            this._xcloseAll(c.childNodes[e])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._xopenAll = function(a) {\r\n    this._HideShow(a, 2);\r\n    for (var c = 0; c < a.childsCount; c++) {\r\n        this._xopenAll(a.childNodes[c])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._correctPlus = function(c) {\r\n    if (!c.htmlNode) {\r\n        return\r\n    }\r\n    var e = c.htmlNode.childNodes[0].childNodes[0].childNodes[0].lastChild;\r\n    var h = c.htmlNode.childNodes[0].childNodes[0].childNodes[2].childNodes[0];\r\n    var a = this.lineArray;\r\n    if ((this.XMLsource) && (!c.XMLload)) {\r\n        var a = this.plusArray;\r\n        this._setSrc(h, this.iconURL + c.images[2]);\r\n        if (this._txtimg) {\r\n            return ( e.innerHTML = \"[+]\") \r\n        }\r\n    } else {\r\n        if ((c.childsCount) || (c.unParsed)) {\r\n            if ((c.htmlNode.childNodes[0].childNodes[1]) && (c.htmlNode.childNodes[0].childNodes[1].style.display != \"none\")) {\r\n                if (!c.wsign) {\r\n                    var a = this.minusArray\r\n                }\r\n                this._setSrc(h, this.iconURL + c.images[1]);\r\n                if (this._txtimg) {\r\n                    return ( e.innerHTML = \"[-]\") \r\n                }\r\n            } else {\r\n                if (!c.wsign) {\r\n                    var a = this.plusArray\r\n                }\r\n                this._setSrc(h, this.iconURL + c.images[2]);\r\n                if (this._txtimg) {\r\n                    return ( e.innerHTML = \"[+]\") \r\n                }\r\n            }\r\n        } else {\r\n            this._setSrc(h, this.iconURL + c.images[0])\r\n        }\r\n    }\r\n    var g = 2;\r\n    if (!c.treeNod.treeLinesOn) {\r\n        this._setSrc(e, this.imPath + a[3])\r\n    } else {\r\n        if (c.parentObject) {\r\n            g = this._getCountStatus(c.id, c.parentObject)\r\n        }\r\n        this._setSrc(e, this.imPath + a[g])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._correctLine = function(c) {\r\n    if (!c.htmlNode) {\r\n        return\r\n    }\r\n    var a = c.parentObject;\r\n    if (a) {\r\n        if ((this._getLineStatus(c.id, a) == 0) || (!this.treeLinesOn)) {\r\n            for (var e = 1; e <= c.childsCount; e++) {\r\n                if (!c.htmlNode.childNodes[0].childNodes[e]) {\r\n                    break\r\n                }\r\n                c.htmlNode.childNodes[0].childNodes[e].childNodes[0].style.backgroundImage = \"\";\r\n                c.htmlNode.childNodes[0].childNodes[e].childNodes[0].style.backgroundRepeat = \"\"\r\n            }\r\n        } else {\r\n            for (var e = 1; e <= c.childsCount; e++) {\r\n                if (!c.htmlNode.childNodes[0].childNodes[e]) {\r\n                    break\r\n                }\r\n                c.htmlNode.childNodes[0].childNodes[e].childNodes[0].style.backgroundImage = \"url(\" + this.imPath + this.lineArray[5] + \")\";\r\n                c.htmlNode.childNodes[0].childNodes[e].childNodes[0].style.backgroundRepeat = \"repeat-y\"\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getCountStatus = function(c, a) {\r\n    if (a.childsCount <= 1) {\r\n        if (a.id == this.rootId) {\r\n            return 4\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n    if (a.childNodes[0].id == c) {\r\n        if (a.id == this.rootId) {\r\n            return 2\r\n        } else {\r\n            return 1\r\n        }\r\n    }\r\n    if (a.childNodes[a.childsCount - 1].id == c) {\r\n        return 0\r\n    }\r\n    return 1\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getLineStatus = function(c, a) {\r\n    if (a.childNodes[a.childsCount - 1].id == c) {\r\n        return 0\r\n    }\r\n    return 1\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._HideShow = function(c, h) {\r\n    if ((this.XMLsource) && (!c.XMLload)) {\r\n        if (h == 1) {\r\n            return\r\n        }\r\n        c.XMLload = 1;\r\n        this._loadDynXML(c.id);\r\n        return\r\n    }\r\n    if (c.unParsed) {\r\n        this.reParse(c)\r\n    }\r\n    var g = c.htmlNode.childNodes[0].childNodes;\r\n    var a = g.length;\r\n    if (a > 1) {\r\n        if (((g[1].style.display != \"none\") || (h == 1)) && (h != 2)) {\r\n            this.allTree.childNodes[0].border = \"1\";\r\n            this.allTree.childNodes[0].border = \"0\";\r\n            nodestyle = \"none\"\r\n        } else {\r\n            nodestyle = \"\"\r\n        }\r\n        for (var e = 1; e < a; e++) {\r\n            g[e].style.display = nodestyle\r\n        }\r\n    }\r\n    this._correctPlus(c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getOpenState = function(a) {\r\n    if (!a.htmlNode) {\r\n        return 0\r\n    }\r\n    var c = a.htmlNode.childNodes[0].childNodes;\r\n    if (c.length <= 1) {\r\n        return 0\r\n    }\r\n    if (c[1].style.display != \"none\") {\r\n        return 1\r\n    } else {\r\n        return -1\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.onRowClick2 = function() {\r\n    var a = this.parentObject.treeNod;\r\n    if (!a.callEvent(\"onDblClick\", [this.parentObject.id, a])) {\r\n        return false\r\n    }\r\n    if ((this.parentObject.closeble) && (this.parentObject.closeble != \"0\")) {\r\n        a._HideShow(this.parentObject)\r\n    } else {\r\n        a._HideShow(this.parentObject, 2)\r\n    }\r\n    if (a.checkEvent(\"onOpenEnd\")) {\r\n        if (!a.xmlstate) {\r\n            a.callEvent(\"onOpenEnd\", [this.parentObject.id, a._getOpenState(this.parentObject)])\r\n        } else {\r\n            a._oie_onXLE.push(a.onXLE);\r\n            a.onXLE = a._epnFHe\r\n        }\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.onRowClick = function() {\r\n    var a = this.parentObject.treeNod;\r\n    if (!a.callEvent(\"onOpenStart\", [this.parentObject.id, a._getOpenState(this.parentObject)])) {\r\n        return 0\r\n    }\r\n    if ((this.parentObject.closeble) && (this.parentObject.closeble != \"0\")) {\r\n        a._HideShow(this.parentObject)\r\n    } else {\r\n        a._HideShow(this.parentObject, 2)\r\n    }\r\n    if (a.checkEvent(\"onOpenEnd\")) {\r\n        if (!a.xmlstate) {\r\n            a.callEvent(\"onOpenEnd\", [this.parentObject.id, a._getOpenState(this.parentObject)])\r\n        } else {\r\n            a._oie_onXLE.push(a.onXLE);\r\n            a.onXLE = a._epnFHe\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._epnFHe = function(c, e, a) {\r\n    if (e != this.rootId) {\r\n        this.callEvent(\"onOpenEnd\", [e, c.getOpenState(e)])\r\n    }\r\n    c.onXLE = c._oie_onXLE.pop();\r\n    if (!a && !c._oie_onXLE.length) {\r\n        if (c.onXLE) {\r\n            c.onXLE(c, e)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.onRowClickDown = function(c) {\r\n    c = c || window.event;\r\n    var a = this.parentObject.treeNod;\r\n    a._selectItem(this.parentObject, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getSelectedItemId = function() {\r\n    var c = new Array();\r\n    for (var a = 0; a < this._selected.length; a++) {\r\n        c[a] = this._selected[a].id\r\n    }\r\n    return ( c.join(this.dlmtr)) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype._selectItem = function(m, n) {\r\n    if (this.checkEvent(\"onSelect\")) {\r\n        this._onSSCFold = this.getSelectedItemId()\r\n    }\r\n    if ((!this._amsel) || (!n) || ((!n.ctrlKey) && (!n.metaKey) && (!n.shiftKey))) {\r\n        this._unselectItems()\r\n    }\r\n    if ((m.i_sel) && (this._amsel) && (n) && (n.ctrlKey || n.metaKey)) {\r\n        this._unselectItem(m)\r\n    } else {\r\n        if ((!m.i_sel) && ((!this._amselS) || (this._selected.length == 0) || (this._selected[0].parentObject == m.parentObject))) {\r\n            if ((this._amsel) && (n) && (n.shiftKey) && (this._selected.length != 0) && (this._selected[this._selected.length - 1].parentObject == m.parentObject)) {\r\n                var h = this._getIndex(this._selected[this._selected.length - 1]);\r\n                var g = this._getIndex(m);\r\n                if (g < h) {\r\n                    var r = h;\r\n                    h = g;\r\n                    g = r\r\n                }\r\n                for (var l = h; l <= g; l++) {\r\n                    if (!m.parentObject.childNodes[l].i_sel) {\r\n                        this._markItem(m.parentObject.childNodes[l])\r\n                    }\r\n                }\r\n            } else {\r\n                this._markItem(m)\r\n            }\r\n        }\r\n    }\r\n    if (this.checkEvent(\"onSelect\")) {\r\n        var o = this.getSelectedItemId();\r\n        if (o != this._onSSCFold) {\r\n            this.callEvent(\"onSelect\", [o])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._markItem = function(a) {\r\n    if (a.scolor) {\r\n        a.span.style.color = a.scolor\r\n    }\r\n    a.span.className = \"selectedTreeRow\";\r\n    a.i_sel = true;\r\n    this._selected[this._selected.length] = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getIndexById = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return null \r\n    }\r\n    return this._getIndex(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getIndex = function(a) {\r\n    var e = a.parentObject;\r\n    for (var c = 0; c < e.childsCount; c++) {\r\n        if (e.childNodes[c] == a) {\r\n            return c\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._unselectItem = function(c) {\r\n    if ((c) && (c.i_sel)) {\r\n        c.span.className = \"standartTreeRow\";\r\n        if (c.acolor) {\r\n            c.span.style.color = c.acolor\r\n        }\r\n        c.i_sel = false;\r\n        for (var a = 0; a < this._selected.length; a++) {\r\n            if (!this._selected[a].i_sel) {\r\n                this._selected.splice(a, 1);\r\n                break\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._unselectItems = function() {\r\n    for (var a = 0; a < this._selected.length; a++) {\r\n        var c = this._selected[a];\r\n        c.span.className = \"standartTreeRow\";\r\n        if (c.acolor) {\r\n            c.span.style.color = c.acolor\r\n        }\r\n        c.i_sel = false\r\n    }\r\n    this._selected = new Array()\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.onRowSelect = function(h, g, m) {\r\n    h = h || window.event;\r\n    var c = this.parentObject;\r\n    if (g) {\r\n        c = g.parentObject\r\n    }\r\n    var a = c.treeNod;\r\n    var l = a.getSelectedItemId();\r\n    if ((!h) || (!h.skipUnSel)) {\r\n        a._selectItem(c, h)\r\n    }\r\n    if (!m) {\r\n        if (c.actionHandler) {\r\n            c.actionHandler(c.id, l)\r\n        } else {\r\n            a.callEvent(\"onClick\", [c.id, l])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._correctCheckStates = function(h) {\r\n    if (!this.tscheck) {\r\n        return\r\n    }\r\n    if (!h) {\r\n        return\r\n    }\r\n    if (h.id == this.rootId) {\r\n        return\r\n    }\r\n    var e = h.childNodes;\r\n    var c = 0;\r\n    var a = 0;\r\n    if (h.childsCount == 0) {\r\n        return\r\n    }\r\n    for (var g = 0; g < h.childsCount; g++) {\r\n        if (e[g].dscheck) {\r\n            continue\r\n        }\r\n        if (e[g].checkstate == 0) {\r\n            c = 1\r\n        } else {\r\n            if (e[g].checkstate == 1) {\r\n                a = 1\r\n            } else {\r\n                c = 1;\r\n                a = 1;\r\n                break\r\n            }\r\n        }\r\n    }\r\n    if ((c) && (a)) {\r\n        this._setCheck(h, \"unsure\")\r\n    } else {\r\n        if (c) {\r\n            this._setCheck(h, false)\r\n        } else {\r\n            this._setCheck(h, true)\r\n        }\r\n    }\r\n    this._correctCheckStates(h.parentObject)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.onCheckBoxClick = function(a) {\r\n    if (!this.treeNod.callEvent(\"onBeforeCheck\", [this.parentObject.id, this.parentObject.checkstate])) {\r\n        return\r\n    }\r\n    if (this.parentObject.dscheck) {\r\n        return true\r\n    }\r\n    if (this.treeNod.tscheck) {\r\n        if (this.parentObject.checkstate == 1) {\r\n            this.treeNod._setSubChecked(false, this.parentObject)\r\n        } else {\r\n            this.treeNod._setSubChecked(true, this.parentObject)\r\n        }\r\n    } else {\r\n        if (this.parentObject.checkstate == 1) {\r\n            this.treeNod._setCheck(this.parentObject, false)\r\n        } else {\r\n            this.treeNod._setCheck(this.parentObject, true)\r\n        }\r\n    }\r\n    this.treeNod._correctCheckStates(this.parentObject.parentObject);\r\n    return this.treeNod.callEvent(\"onCheck\", [this.parentObject.id, this.parentObject.checkstate])\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._createItem = function(u, s, n) {\r\n    var v = document.createElement(\"table\");\r\n    v.cellSpacing = 0;\r\n    v.cellPadding = 0;\r\n    v.border = 0;\r\n    if (this.hfMode) {\r\n        v.style.tableLayout = \"fixed\"\r\n    }\r\n    v.style.margin = 0;\r\n    v.style.padding = 0;\r\n    var m = document.createElement(\"tbody\");\r\n    var r = document.createElement(\"tr\");\r\n    var g = document.createElement(\"td\");\r\n    g.className = \"standartTreeImage\";\r\n    if (this._txtimg) {\r\n        var h = document.createElement(\"div\");\r\n        g.appendChild(h);\r\n        h.className = \"dhx_tree_textSign\"\r\n    } else {\r\n        var h = this._getImg(s.id);\r\n        h.border = \"0\";\r\n        if (h.tagName == \"IMG\") {\r\n            h.align = \"absmiddle\"\r\n        }\r\n        g.appendChild(h);\r\n        h.style.padding = 0;\r\n        h.style.margin = 0;\r\n        h.style.width = this.def_line_img_x\r\n    }\r\n    var e = document.createElement(\"td\");\r\n    var o = this._getImg(this.cBROf ? this.rootId : s.id);\r\n    o.checked = 0;\r\n    this._setSrc(o, this.imPath + this.checkArray[0]);\r\n    o.style.width = \"18px\";\r\n    o.style.height = \"18px\";\r\n    if (!u) {\r\n        e.style.display = \"none\"\r\n    }\r\n    e.appendChild(o);\r\n    if ((!this.cBROf) && (o.tagName == \"IMG\")) {\r\n        o.align = \"absmiddle\"\r\n    }\r\n    o.onclick = this.onCheckBoxClick;\r\n    o.treeNod = this;\r\n    o.parentObject = s;\r\n    if (!window._KHTMLrv) {\r\n        e.width = \"20px\"\r\n    } else {\r\n        e.width = \"16px\"\r\n    }\r\n    var c = document.createElement(\"td\");\r\n    c.className = \"standartTreeImage\";\r\n    var l = this._getImg(this.timgen ? s.id : this.rootId);\r\n    l.onmousedown = this._preventNsDrag;\r\n    l.ondragstart = this._preventNsDrag;\r\n    l.border = \"0\";\r\n    if (this._aimgs) {\r\n        l.parentObject = s;\r\n        if (l.tagName == \"IMG\") {\r\n            l.align = \"absmiddle\"\r\n        }\r\n        l.onclick = this.onRowSelect\r\n    }\r\n    if (!n) {\r\n        this._setSrc(l, this.iconURL + this.imageArray[0])\r\n    }\r\n    c.appendChild(l);\r\n    l.style.padding = 0;\r\n    l.style.margin = 0;\r\n    if (this.timgen) {\r\n        c.style.width = l.style.width = this.def_img_x;\r\n        l.style.height = this.def_img_y\r\n    } else {\r\n        l.style.width = \"0px\";\r\n        l.style.height = \"0px\";\r\n        if (_isOpera || window._KHTMLrv) {\r\n            c.style.display = \"none\"\r\n        }\r\n    }\r\n    var a = document.createElement(\"td\");\r\n    a.className = \"standartTreeRow\";\r\n    s.span = document.createElement(\"span\");\r\n    s.span.className = \"standartTreeRow\";\r\n    if (this.mlitems) {\r\n        s.span.style.width = this.mlitems;\r\n        s.span.style.display = \"block\"\r\n    } else {\r\n        a.noWrap = true\r\n    }\r\n    if (dhx4.isIE8) {\r\n        a.style.width = \"99999px\"\r\n    } else {\r\n        if (!window._KHTMLrv) {\r\n            a.style.width = \"100%\"\r\n        }\r\n    }\r\n    s.span.innerHTML = s.label;\r\n    a.appendChild(s.span);\r\n    a.parentObject = s;\r\n    g.parentObject = s;\r\n    a.onclick = this.onRowSelect;\r\n    g.onclick = this.onRowClick;\r\n    a.ondblclick = this.onRowClick2;\r\n    if (this.ettip) {\r\n        r.title = s.label\r\n    }\r\n    if (this.dragAndDropOff) {\r\n        if (this._aimgs) {\r\n            this.dragger.addDraggableItem(c, this);\r\n            c.parentObject = s\r\n        }\r\n        this.dragger.addDraggableItem(a, this)\r\n    }\r\n    s.span.style.paddingLeft = \"5px\";\r\n    s.span.style.paddingRight = \"5px\";\r\n    a.style.verticalAlign = \"\";\r\n    a.style.fontSize = \"10pt\";\r\n    a.style.cursor = this.style_pointer;\r\n    r.appendChild(g);\r\n    r.appendChild(e);\r\n    r.appendChild(c);\r\n    r.appendChild(a);\r\n    m.appendChild(r);\r\n    v.appendChild(m);\r\n    if (this.ehlt || this.checkEvent(\"onMouseIn\") || this.checkEvent(\"onMouseOut\")) {\r\n        r.onmousemove = this._itemMouseIn;\r\n        r[(_isIE) ? \"onmouseleave\" : \"onmouseout\"] = this._itemMouseOut\r\n    }\r\n    return v\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setImagePath = function(a) {\r\n    this.imPath = a;\r\n    this.iconURL = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setIconPath = function(a) {\r\n    this.iconURL = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getLeafCount = function(g) {\r\n    var e = 0;\r\n    for (var c = 0; c < g.childsCount; c++) {\r\n        if (g.childNodes[c].childsCount == 0) {\r\n            e++\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getChildCounterValue = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    if ((a.unParsed) || ((!a.XMLload) && (this.XMLsource))) {\r\n        return a._acc\r\n    }\r\n    switch (this.childCalc) {\r\n    case 1:\r\n        return a.childsCount;\r\n        break;\r\n    case 2:\r\n        return this._getLeafCount(a);\r\n        break;\r\n    case 3:\r\n        return a._acc;\r\n        break;\r\n    case 4:\r\n        return a._acc;\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._fixChildCountLabel = function(l, g) {\r\n    if (this.childCalc == null ) {\r\n        return\r\n    }\r\n    if ((l.unParsed) || ((!l.XMLload) && (this.XMLsource))) {\r\n        if (l._acc) {\r\n            l.span.innerHTML = l.label + this.htmlcA + l._acc + this.htmlcB\r\n        } else {\r\n            l.span.innerHTML = l.label\r\n        }\r\n        return\r\n    }\r\n    switch (this.childCalc) {\r\n    case 1:\r\n        if (l.childsCount != 0) {\r\n            l.span.innerHTML = l.label + this.htmlcA + l.childsCount + this.htmlcB\r\n        } else {\r\n            l.span.innerHTML = l.label\r\n        }\r\n        break;\r\n    case 2:\r\n        var h = this._getLeafCount(l);\r\n        if (h != 0) {\r\n            l.span.innerHTML = l.label + this.htmlcA + h + this.htmlcB\r\n        } else {\r\n            l.span.innerHTML = l.label\r\n        }\r\n        break;\r\n    case 3:\r\n        if (l.childsCount != 0) {\r\n            var e = 0;\r\n            for (var c = 0; c < l.childsCount; c++) {\r\n                if (!l.childNodes[c]._acc) {\r\n                    l.childNodes[c]._acc = 0\r\n                }\r\n                e += l.childNodes[c]._acc * 1\r\n            }\r\n            e += l.childsCount * 1;\r\n            l.span.innerHTML = l.label + this.htmlcA + e + this.htmlcB;\r\n            l._acc = e\r\n        } else {\r\n            l.span.innerHTML = l.label;\r\n            l._acc = 0\r\n        }\r\n        if ((l.parentObject) && (l.parentObject != this.htmlNode)) {\r\n            this._fixChildCountLabel(l.parentObject)\r\n        }\r\n        break;\r\n    case 4:\r\n        if (l.childsCount != 0) {\r\n            var e = 0;\r\n            for (var c = 0; c < l.childsCount; c++) {\r\n                if (!l.childNodes[c]._acc) {\r\n                    l.childNodes[c]._acc = 1\r\n                }\r\n                e += l.childNodes[c]._acc * 1\r\n            }\r\n            l.span.innerHTML = l.label + this.htmlcA + e + this.htmlcB;\r\n            l._acc = e\r\n        } else {\r\n            l.span.innerHTML = l.label;\r\n            l._acc = 1\r\n        }\r\n        if ((l.parentObject) && (l.parentObject != this.htmlNode)) {\r\n            this._fixChildCountLabel(l.parentObject)\r\n        }\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setChildCalcMode = function(a) {\r\n    switch (a) {\r\n    case \"child\":\r\n        this.childCalc = 1;\r\n        break;\r\n    case \"leafs\":\r\n        this.childCalc = 2;\r\n        break;\r\n    case \"childrec\":\r\n        this.childCalc = 3;\r\n        break;\r\n    case \"leafsrec\":\r\n        this.childCalc = 4;\r\n        break;\r\n    case \"disabled\":\r\n        this.childCalc = null ;\r\n        break;\r\n    default:\r\n        this.childCalc = 4\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setChildCalcHTML = function(c, a) {\r\n    this.htmlcA = c;\r\n    this.htmlcB = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnRightClickHandler = function(a) {\r\n    this.attachEvent(\"onRightClick\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnClickHandler = function(a) {\r\n    this.attachEvent(\"onClick\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnSelectStateChange = function(a) {\r\n    this.attachEvent(\"onSelect\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setXMLAutoLoading = function(a) {\r\n    this.XMLsource = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnCheckHandler = function(a) {\r\n    this.attachEvent(\"onCheck\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnOpenHandler = function(a) {\r\n    this.attachEvent(\"onOpenStart\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnOpenStartHandler = function(a) {\r\n    this.attachEvent(\"onOpenStart\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnOpenEndHandler = function(a) {\r\n    this.attachEvent(\"onOpenEnd\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnDblClickHandler = function(a) {\r\n    this.attachEvent(\"onDblClick\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.openAllItems = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    this._xopenAll(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getOpenState = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return \"\"\r\n    }\r\n    return this._getOpenState(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.closeAllItems = function(c) {\r\n    if (c === window.undefined) {\r\n        c = this.rootId\r\n    }\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    this._xcloseAll(a);\r\n    this.allTree.childNodes[0].border = \"1\";\r\n    this.allTree.childNodes[0].border = \"0\"\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setUserData = function(g, c, e) {\r\n    var a = this._globalIdStorageFind(g, 0, true);\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (c == \"hint\") {\r\n        a.htmlNode.childNodes[0].childNodes[0].title = e\r\n    }\r\n    if (typeof (a.userData[\"t_\" + c]) == \"undefined\") {\r\n        if (!a._userdatalist) {\r\n            a._userdatalist = c\r\n        } else {\r\n            a._userdatalist += \",\" + c\r\n        }\r\n    }\r\n    a.userData[\"t_\" + c] = e\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getUserData = function(e, c) {\r\n    var a = this._globalIdStorageFind(e, 0, true);\r\n    if (!a) {\r\n        return\r\n    }\r\n    return a.userData[\"t_\" + c]\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getItemColor = function(e) {\r\n    var a = this._globalIdStorageFind(e);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    var c = new Object();\r\n    if (a.acolor) {\r\n        c.acolor = a.acolor\r\n    }\r\n    if (a.scolor) {\r\n        c.scolor = a.scolor\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemColor = function(e, c, g) {\r\n    if ((e) && (e.span)) {\r\n        var a = e\r\n    } else {\r\n        var a = this._globalIdStorageFind(e)\r\n    }\r\n    if (!a) {\r\n        return 0\r\n    } else {\r\n        if (a.i_sel) {\r\n            if (g || c) {\r\n                a.span.style.color = g || c\r\n            }\r\n        } else {\r\n            if (c) {\r\n                a.span.style.color = c\r\n            }\r\n        }\r\n        if (g) {\r\n            a.scolor = g\r\n        }\r\n        if (c) {\r\n            a.acolor = c\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getItemText = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    return ( a.htmlNode.childNodes[0].childNodes[0].childNodes[3].childNodes[0].innerHTML) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getParentId = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if ((!a) || (!a.parentObject)) {\r\n        return \"\"\r\n    }\r\n    return a.parentObject.id\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.changeItemId = function(c, e) {\r\n    if (c == e) {\r\n        return\r\n    }\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    a.id = e;\r\n    a.span.contextMenuId = e;\r\n    this._idpull[e] = this._idpull[c];\r\n    delete this._idpull[c]\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.doCut = function() {\r\n    if (this.nodeCut) {\r\n        this.clearCut()\r\n    }\r\n    this.nodeCut = (new Array()).concat(this._selected);\r\n    for (var a = 0; a < this.nodeCut.length; a++) {\r\n        var c = this.nodeCut[a];\r\n        c._cimgs = new Array();\r\n        c._cimgs[0] = c.images[0];\r\n        c._cimgs[1] = c.images[1];\r\n        c._cimgs[2] = c.images[2];\r\n        c.images[0] = c.images[1] = c.images[2] = this.cutImage;\r\n        this._correctPlus(c)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.doPaste = function(e) {\r\n    var a = this._globalIdStorageFind(e);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    for (var c = 0; c < this.nodeCut.length; c++) {\r\n        if (this._checkPNodes(a, this.nodeCut[c])) {\r\n            continue\r\n        }\r\n        this._moveNode(this.nodeCut[c], a)\r\n    }\r\n    this.clearCut()\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.clearCut = function() {\r\n    for (var a = 0; a < this.nodeCut.length; a++) {\r\n        var c = this.nodeCut[a];\r\n        c.images[0] = c._cimgs[0];\r\n        c.images[1] = c._cimgs[1];\r\n        c.images[2] = c._cimgs[2];\r\n        this._correctPlus(c)\r\n    }\r\n    this.nodeCut = new Array()\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._moveNode = function(a, c) {\r\n    var l = this.dadmodec;\r\n    if (l == 1) {\r\n        var h = c;\r\n        if (this.dadmodefix < 0) {\r\n            while (true) {\r\n                h = this._getPrevNode(h);\r\n                if ((h == -1) ) {\r\n                    h = this.htmlNode;\r\n                    break\r\n                }\r\n                if ((h.tr == 0) || (h.tr.style.display == \"\") || (!h.parentObject)) {\r\n                    break\r\n                }\r\n            }\r\n            var g = h;\r\n            var e = c\r\n        } else {\r\n            if ((h.tr) && (h.tr.nextSibling) && (h.tr.nextSibling.nodem) && (this._getOpenState(h) < 1)) {\r\n                h = h.tr.nextSibling.nodem\r\n            } else {\r\n                h = this._getNextNode(h);\r\n                if ((h == -1) ) {\r\n                    h = this.htmlNode\r\n                }\r\n            }\r\n            var e = h;\r\n            var g = c\r\n        }\r\n        if (this._getNodeLevel(g, 0) > this._getNodeLevel(e, 0)) {\r\n            if (!this.dropLower) {\r\n                return this._moveNodeTo(a, g.parentObject)\r\n            } else {\r\n                if (e.id != this.rootId) {\r\n                    return this._moveNodeTo(a, e.parentObject, e)\r\n                } else {\r\n                    return this._moveNodeTo(a, this.htmlNode, null )\r\n                }\r\n            }\r\n        } else {\r\n            return this._moveNodeTo(a, e.parentObject, e)\r\n        }\r\n    } else {\r\n        return this._moveNodeTo(a, c)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._fixNodesCollection = function(n, l) {\r\n    var c = 0;\r\n    var g = 0;\r\n    var m = n.childNodes;\r\n    var a = n.childsCount - 1;\r\n    if (l == m[a]) {\r\n        return\r\n    }\r\n    for (var h = 0; h < a; h++) {\r\n        if (m[h] == m[a]) {\r\n            m[h] = m[h + 1];\r\n            m[h + 1] = m[a]\r\n        }\r\n    }\r\n    for (var h = 0; h < a + 1; h++) {\r\n        if (c) {\r\n            var e = m[h];\r\n            m[h] = c;\r\n            c = e\r\n        } else {\r\n            if (m[h] == l) {\r\n                c = m[h];\r\n                m[h] = m[a]\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._recreateBranch = function(l, n, h, a) {\r\n    var c;\r\n    var o = \"\";\r\n    if (h) {\r\n        for (c = 0; c < n.childsCount; c++) {\r\n            if (n.childNodes[c] == h) {\r\n                break\r\n            }\r\n        }\r\n        if (c != 0) {\r\n            h = n.childNodes[c - 1]\r\n        } else {\r\n            o = \"TOP\";\r\n            h = \"\"\r\n        }\r\n    }\r\n    var e = this._onradh;\r\n    this._onradh = null ;\r\n    var m = this._attachChildNode(n, l.id, l.label, 0, l.images[0], l.images[1], l.images[2], o, 0, h);\r\n    m._userdatalist = l._userdatalist;\r\n    m.userData = l.userData.clone();\r\n    if (l._attrs) {\r\n        m._attrs = {};\r\n        for (var g in l._attrs) {\r\n            m._attrs[g] = l._attrs[g]\r\n        }\r\n    }\r\n    m.XMLload = l.XMLload;\r\n    if (e) {\r\n        this._onradh = e;\r\n        this._onradh(m.id)\r\n    }\r\n    if (l.treeNod.dpcpy) {\r\n        l.treeNod._globalIdStorageFind(l.id)\r\n    } else {\r\n        m.unParsed = l.unParsed\r\n    }\r\n    this._correctPlus(m);\r\n    for (var c = 0; c < l.childsCount; c++) {\r\n        this._recreateBranch(l.childNodes[c], m, 0, 1)\r\n    }\r\n    if ((!a) && (this.childCalc)) {\r\n        this._redrawFrom(this, n)\r\n    }\r\n    return m\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._moveNodeTo = function(u, w, s) {\r\n    if (u.treeNod._nonTrivialNode) {\r\n        return u.treeNod._nonTrivialNode(this, w, s, u)\r\n    }\r\n    if (this._checkPNodes(w, u)) {\r\n        return false\r\n    }\r\n    if (w.mytype) {\r\n        var m = (u.treeNod.lWin != w.lWin)\r\n    } else {\r\n        var m = (u.treeNod.lWin != w.treeNod.lWin)\r\n    }\r\n    if (!this.callEvent(\"onDrag\", [u.id, w.id, (s ? s.id : null ), u.treeNod, w.treeNod])) {\r\n        return false\r\n    }\r\n    if ((w.XMLload == 0) && (this.XMLsource)) {\r\n        w.XMLload = 1;\r\n        this._loadDynXML(w.id)\r\n    }\r\n    this.openItem(w.id);\r\n    var e = u.treeNod;\r\n    var o = u.parentObject.childsCount;\r\n    var r = u.parentObject;\r\n    if ((m) || (e.dpcpy)) {\r\n        var g = u.id;\r\n        u = this._recreateBranch(u, w, s);\r\n        if (!e.dpcpy) {\r\n            e.deleteItem(g)\r\n        }\r\n    } else {\r\n        var h = w.childsCount;\r\n        var v = w.childNodes;\r\n        if (h == 0) {\r\n            w._open = true\r\n        }\r\n        e._unselectItem(u);\r\n        v[h] = u;\r\n        u.treeNod = w.treeNod;\r\n        w.childsCount++;\r\n        var n = this._drawNewTr(v[h].htmlNode);\r\n        if (!s) {\r\n            w.htmlNode.childNodes[0].appendChild(n);\r\n            if (this.dadmode == 1) {\r\n                this._fixNodesCollection(w, s)\r\n            }\r\n        } else {\r\n            w.htmlNode.childNodes[0].insertBefore(n, s.tr);\r\n            this._fixNodesCollection(w, s);\r\n            v = w.childNodes\r\n        }\r\n    }\r\n    if ((!e.dpcpy) && (!m)) {\r\n        var a = u.tr;\r\n        if ((document.all) && (navigator.appVersion.search(/MSIE\\ 5\\.0/gi) != -1)) {\r\n            window.setTimeout(function() {\r\n                a.parentNode.removeChild(a)\r\n            }, 250)\r\n        } else {\r\n            u.parentObject.htmlNode.childNodes[0].removeChild(u.tr)\r\n        }\r\n        if ((!s) || (w != u.parentObject)) {\r\n            for (var l = 0; l < r.childsCount; l++) {\r\n                if (r.childNodes[l].id == u.id) {\r\n                    r.childNodes[l] = 0;\r\n                    break\r\n                }\r\n            }\r\n        } else {\r\n            r.childNodes[r.childsCount - 1] = 0\r\n        }\r\n        e._compressChildList(r.childsCount, r.childNodes);\r\n        r.childsCount--\r\n    }\r\n    if ((!m) && (!e.dpcpy)) {\r\n        u.tr = n;\r\n        n.nodem = u;\r\n        u.parentObject = w;\r\n        if (e != w.treeNod) {\r\n            if (u.treeNod._registerBranch(u, e)) {\r\n                return\r\n            }\r\n            this._clearStyles(u);\r\n            this._redrawFrom(this, u.parentObject);\r\n            if (this._onradh) {\r\n                this._onradh(u.id)\r\n            }\r\n        }\r\n        this._correctPlus(w);\r\n        this._correctLine(w);\r\n        this._correctLine(u);\r\n        this._correctPlus(u);\r\n        if (s) {\r\n            this._correctPlus(s)\r\n        } else {\r\n            if (w.childsCount >= 2) {\r\n                this._correctPlus(v[w.childsCount - 2]);\r\n                this._correctLine(v[w.childsCount - 2])\r\n            }\r\n        }\r\n        this._correctPlus(v[w.childsCount - 1]);\r\n        if (this.tscheck) {\r\n            this._correctCheckStates(w)\r\n        }\r\n        if (e.tscheck) {\r\n            e._correctCheckStates(r)\r\n        }\r\n    }\r\n    if (o > 1) {\r\n        e._correctPlus(r.childNodes[o - 2]);\r\n        e._correctLine(r.childNodes[o - 2])\r\n    }\r\n    e._correctPlus(r);\r\n    e._correctLine(r);\r\n    this._fixChildCountLabel(w);\r\n    e._fixChildCountLabel(r);\r\n    this.callEvent(\"onDrop\", [u.id, w.id, (s ? s.id : null ), e, w.treeNod]);\r\n    return u.id\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._clearStyles = function(a) {\r\n    if (!a.htmlNode) {\r\n        return\r\n    }\r\n    var g = a.htmlNode.childNodes[0].childNodes[0].childNodes[1];\r\n    var c = g.nextSibling.nextSibling;\r\n    a.span.innerHTML = a.label;\r\n    a.i_sel = false;\r\n    if (a._aimgs) {\r\n        this.dragger.removeDraggableItem(g.nextSibling)\r\n    }\r\n    if (this.checkBoxOff) {\r\n        g.childNodes[0].style.display = \"\";\r\n        g.childNodes[0].onclick = this.onCheckBoxClick;\r\n        this._setSrc(g.childNodes[0], this.imPath + this.checkArray[a.checkstate])\r\n    } else {\r\n        g.style.display = \"none\"\r\n    }\r\n    g.childNodes[0].treeNod = this;\r\n    this.dragger.removeDraggableItem(c);\r\n    if (this.dragAndDropOff) {\r\n        this.dragger.addDraggableItem(c, this)\r\n    }\r\n    if (this._aimgs) {\r\n        this.dragger.addDraggableItem(g.nextSibling, this)\r\n    }\r\n    c.childNodes[0].className = \"standartTreeRow\";\r\n    c.onclick = this.onRowSelect;\r\n    c.ondblclick = this.onRowClick2;\r\n    g.previousSibling.onclick = this.onRowClick;\r\n    this._correctLine(a);\r\n    this._correctPlus(a);\r\n    for (var e = 0; e < a.childsCount; e++) {\r\n        this._clearStyles(a.childNodes[e])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._registerBranch = function(c, a) {\r\n    if (a) {\r\n        a._globalIdStorageSub(c.id)\r\n    }\r\n    c.id = this._globalIdStorageAdd(c.id, c);\r\n    c.treeNod = this;\r\n    for (var e = 0; e < c.childsCount; e++) {\r\n        this._registerBranch(c.childNodes[e], a)\r\n    }\r\n    return 0\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableThreeStateCheckboxes = function(a) {\r\n    this.tscheck = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnMouseInHandler = function(a) {\r\n    this.ehlt = true;\r\n    this.attachEvent(\"onMouseIn\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnMouseOutHandler = function(a) {\r\n    this.ehlt = true;\r\n    this.attachEvent(\"onMouseOut\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableMercyDrag = function(a) {\r\n    this.dpcpy = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableTreeImages = function(a) {\r\n    this.timgen = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableFixedMode = function(a) {\r\n    this.hfMode = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableCheckBoxes = function(c, a) {\r\n    this.checkBoxOff = dhx4.s2b(c);\r\n    this.cBROf = (!(this.checkBoxOff || dhx4.s2b(a)))\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setStdImages = function(a, e, c) {\r\n    this.imageArray[0] = a;\r\n    this.imageArray[1] = e;\r\n    this.imageArray[2] = c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableTreeLines = function(a) {\r\n    this.treeLinesOn = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setImageArrays = function(g, a, l, h, e, c) {\r\n    switch (g) {\r\n    case \"plus\":\r\n        this.plusArray[0] = a;\r\n        this.plusArray[1] = l;\r\n        this.plusArray[2] = h;\r\n        this.plusArray[3] = e;\r\n        this.plusArray[4] = c;\r\n        break;\r\n    case \"minus\":\r\n        this.minusArray[0] = a;\r\n        this.minusArray[1] = l;\r\n        this.minusArray[2] = h;\r\n        this.minusArray[3] = e;\r\n        this.minusArray[4] = c;\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.openItem = function(c) {\r\n    this.skipLock = true;\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    } else {\r\n        return this._openItem(a)\r\n    }\r\n    this.skipLock = false\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._openItem = function(a) {\r\n    var c = this._getOpenState(a);\r\n    if ((c < 0) || (((this.XMLsource) && (!a.XMLload)))) {\r\n        if (!this.callEvent(\"onOpenStart\", [a.id, c])) {\r\n            return 0\r\n        }\r\n        this._HideShow(a, 2);\r\n        if (this.checkEvent(\"onOpenEnd\")) {\r\n            if (this.onXLE == this._epnFHe) {\r\n                this._epnFHe(this, a.id, true)\r\n            }\r\n            if (!this.xmlstate || !this.XMLsource) {\r\n                this.callEvent(\"onOpenEnd\", [a.id, this._getOpenState(a)])\r\n            } else {\r\n                this._oie_onXLE.push(this.onXLE);\r\n                this.onXLE = this._epnFHe\r\n            }\r\n        }\r\n    } else {\r\n        if (this._srnd) {\r\n            this._HideShow(a, 2)\r\n        }\r\n    }\r\n    if (a.parentObject && !this._skip_open_parent) {\r\n        this._openItem(a.parentObject)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.closeItem = function(c) {\r\n    if (this.rootId == c) {\r\n        return 0\r\n    }\r\n    this.skipLock = true;\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    if (a.closeble) {\r\n        this._HideShow(a, 1)\r\n    }\r\n    this.skipLock = false\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getLevel = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    return this._getNodeLevel(a, 0)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemCloseable = function(e, a) {\r\n    a = dhx4.s2b(a);\r\n    if ((e) && (e.span)) {\r\n        var c = e\r\n    } else {\r\n        var c = this._globalIdStorageFind(e)\r\n    }\r\n    if (!c) {\r\n        return 0\r\n    }\r\n    c.closeble = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getNodeLevel = function(a, c) {\r\n    if (a.parentObject) {\r\n        return this._getNodeLevel(a.parentObject, c + 1)\r\n    }\r\n    return ( c) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.hasChildren = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return 0\r\n    } else {\r\n        if ((this.XMLsource) && (!a.XMLload)) {\r\n            return true\r\n        } else {\r\n            return a.childsCount\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getLeafCount = function(g) {\r\n    var e = 0;\r\n    for (var c = 0; c < g.childsCount; c++) {\r\n        if (g.childNodes[c].childsCount == 0) {\r\n            e++\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemText = function(g, e, c) {\r\n    var a = this._globalIdStorageFind(g);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    a.label = e;\r\n    a.span.innerHTML = e;\r\n    if (this.childCalc) {\r\n        this._fixChildCountLabel(a)\r\n    }\r\n    a.span.parentNode.parentNode.title = c || \"\"\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getItemTooltip = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return \"\"\r\n    }\r\n    return ( a.span.parentNode.parentNode._dhx_title || a.span.parentNode.parentNode.title || \"\") \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.refreshItem = function(c) {\r\n    if (!c) {\r\n        c = this.rootId\r\n    }\r\n    var a = this._globalIdStorageFind(c);\r\n    this._dynDeleteBranches[c] = (this._dynDeleteBranches[c] || 0) + 1;\r\n    this._loadDynXML(c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemImage2 = function(g, a, h, e) {\r\n    var c = this._globalIdStorageFind(g);\r\n    if (!c) {\r\n        return 0\r\n    }\r\n    c.images[1] = h;\r\n    c.images[2] = e;\r\n    c.images[0] = a;\r\n    this._correctPlus(c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemImage = function(e, a, g) {\r\n    var c = this._globalIdStorageFind(e);\r\n    if (!c) {\r\n        return 0\r\n    }\r\n    if (g) {\r\n        c.images[1] = a;\r\n        c.images[2] = g\r\n    } else {\r\n        c.images[0] = a\r\n    }\r\n    this._correctPlus(c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getSubItems = function(e) {\r\n    var a = this._globalIdStorageFind(e, 0, 1);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    if (a.unParsed) {\r\n        return ( this._getSubItemsXML(a.unParsed)) \r\n    }\r\n    var c = \"\";\r\n    for (i = 0; i < a.childsCount; i++) {\r\n        if (!c) {\r\n            c = \"\" + a.childNodes[i].id\r\n        } else {\r\n            c += this.dlmtr + a.childNodes[i].id\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllScraggyItems = function(e) {\r\n    var g = \"\";\r\n    for (var c = 0; c < e.childsCount; c++) {\r\n        if ((e.childNodes[c].unParsed) || (e.childNodes[c].childsCount > 0)) {\r\n            if (e.childNodes[c].unParsed) {\r\n                var a = this._getAllScraggyItemsXML(e.childNodes[c].unParsed, 1)\r\n            } else {\r\n                var a = this._getAllScraggyItems(e.childNodes[c])\r\n            }\r\n            if (a) {\r\n                if (g) {\r\n                    g += this.dlmtr + a\r\n                } else {\r\n                    g = a\r\n                }\r\n            }\r\n        } else {\r\n            if (!g) {\r\n                g = \"\" + e.childNodes[c].id\r\n            } else {\r\n                g += this.dlmtr + e.childNodes[c].id\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllFatItems = function(e) {\r\n    var g = \"\";\r\n    for (var c = 0; c < e.childsCount; c++) {\r\n        if ((e.childNodes[c].unParsed) || (e.childNodes[c].childsCount > 0)) {\r\n            if (!g) {\r\n                g = \"\" + e.childNodes[c].id\r\n            } else {\r\n                g += this.dlmtr + e.childNodes[c].id\r\n            }\r\n            if (e.childNodes[c].unParsed) {\r\n                var a = this._getAllFatItemsXML(e.childNodes[c].unParsed, 1)\r\n            } else {\r\n                var a = this._getAllFatItems(e.childNodes[c])\r\n            }\r\n            if (a) {\r\n                g += this.dlmtr + a\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllSubItems = function(l, h, g) {\r\n    if (g) {\r\n        c = g\r\n    } else {\r\n        var c = this._globalIdStorageFind(l)\r\n    }\r\n    if (!c) {\r\n        return 0\r\n    }\r\n    h = \"\";\r\n    for (var e = 0; e < c.childsCount; e++) {\r\n        if (!h) {\r\n            h = \"\" + c.childNodes[e].id\r\n        } else {\r\n            h += this.dlmtr + c.childNodes[e].id\r\n        }\r\n        var a = this._getAllSubItems(0, h, c.childNodes[e]);\r\n        if (a) {\r\n            h += this.dlmtr + a\r\n        }\r\n    }\r\n    if (c.unParsed) {\r\n        h = this._getAllSubItemsXML(l, h, c.unParsed)\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.selectItem = function(g, e, c) {\r\n    e = dhx4.s2b(e);\r\n    var a = this._globalIdStorageFind(g);\r\n    if ((!a) || (!a.parentObject)) {\r\n        return 0\r\n    }\r\n    if (this.XMLloadingWarning) {\r\n        a.parentObject.openMe = 1\r\n    } else {\r\n        this._openItem(a.parentObject)\r\n    }\r\n    var h = null ;\r\n    if (c) {\r\n        h = new Object;\r\n        h.ctrlKey = true;\r\n        if (a.i_sel) {\r\n            h.skipUnSel = true\r\n        }\r\n    }\r\n    if (e) {\r\n        this.onRowSelect(h, a.htmlNode.childNodes[0].childNodes[0].childNodes[3], false)\r\n    } else {\r\n        this.onRowSelect(h, a.htmlNode.childNodes[0].childNodes[0].childNodes[3], true)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getSelectedItemText = function() {\r\n    var c = new Array();\r\n    for (var a = 0; a < this._selected.length; a++) {\r\n        c[a] = this._selected[a].span.innerHTML\r\n    }\r\n    return ( c.join(this.dlmtr)) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype._compressChildList = function(a, e) {\r\n    a--;\r\n    for (var c = 0; c < a; c++) {\r\n        if (e[c] == 0) {\r\n            e[c] = e[c + 1];\r\n            e[c + 1] = 0\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._deleteNode = function(m, h, o) {\r\n    if ((!h) || (!h.parentObject)) {\r\n        return 0\r\n    }\r\n    var a = 0;\r\n    var c = 0;\r\n    if (h.tr.nextSibling) {\r\n        a = h.tr.nextSibling.nodem\r\n    }\r\n    if (h.tr.previousSibling) {\r\n        c = h.tr.previousSibling.nodem\r\n    }\r\n    var l = h.parentObject;\r\n    var e = l.childsCount;\r\n    var n = l.childNodes;\r\n    for (var g = 0; g < e; g++) {\r\n        if (n[g].id == m) {\r\n            if (!o) {\r\n                l.htmlNode.childNodes[0].removeChild(n[g].tr)\r\n            }\r\n            n[g] = 0;\r\n            break\r\n        }\r\n    }\r\n    this._compressChildList(e, n);\r\n    if (!o) {\r\n        l.childsCount--\r\n    }\r\n    if (a) {\r\n        this._correctPlus(a);\r\n        this._correctLine(a)\r\n    }\r\n    if (c) {\r\n        this._correctPlus(c);\r\n        this._correctLine(c)\r\n    }\r\n    if (this.tscheck) {\r\n        this._correctCheckStates(l)\r\n    }\r\n    if (!o) {\r\n        this._globalIdStorageRecSub(h)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setCheck = function(e, c) {\r\n    var a = this._globalIdStorageFind(e, 0, 1);\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (c === \"unsure\") {\r\n        this._setCheck(a, c)\r\n    } else {\r\n        c = dhx4.s2b(c);\r\n        if ((this.tscheck) && (this.smcheck)) {\r\n            this._setSubChecked(c, a)\r\n        } else {\r\n            this._setCheck(a, c)\r\n        }\r\n    }\r\n    if (this.smcheck) {\r\n        this._correctCheckStates(a.parentObject)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._setCheck = function(a, e) {\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (((a.parentObject._r_logic) || (this._frbtr)) && (e)) {\r\n        if (this._frbtrs) {\r\n            if (this._frbtrL) {\r\n                this.setCheck(this._frbtrL.id, 0)\r\n            }\r\n            this._frbtrL = a\r\n        } else {\r\n            for (var c = 0; c < a.parentObject.childsCount; c++) {\r\n                this._setCheck(a.parentObject.childNodes[c], 0)\r\n            }\r\n        }\r\n    }\r\n    var g = a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];\r\n    if (e == \"unsure\") {\r\n        a.checkstate = 2\r\n    } else {\r\n        if (e) {\r\n            a.checkstate = 1\r\n        } else {\r\n            a.checkstate = 0\r\n        }\r\n    }\r\n    if (a.dscheck) {\r\n        a.checkstate = a.dscheck\r\n    }\r\n    this._setSrc(g, this.imPath + ((a.parentObject._r_logic || this._frbtr) ? this.radioArray : this.checkArray)[a.checkstate])\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setSubChecked = function(e, c) {\r\n    var a = this._globalIdStorageFind(e);\r\n    this._setSubChecked(c, a);\r\n    this._correctCheckStates(a.parentObject)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._setSubChecked = function(e, a) {\r\n    e = dhx4.s2b(e);\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (((a.parentObject._r_logic) || (this._frbtr)) && (e)) {\r\n        for (var c = 0; c < a.parentObject.childsCount; c++) {\r\n            this._setSubChecked(0, a.parentObject.childNodes[c])\r\n        }\r\n    }\r\n    if (a.unParsed) {\r\n        this._setSubCheckedXML(e, a.unParsed)\r\n    }\r\n    if (a._r_logic || this._frbtr) {\r\n        this._setSubChecked(e, a.childNodes[0])\r\n    } else {\r\n        for (var c = 0; c < a.childsCount; c++) {\r\n            this._setSubChecked(e, a.childNodes[c])\r\n        }\r\n    }\r\n    var g = a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];\r\n    if (e) {\r\n        a.checkstate = 1\r\n    } else {\r\n        a.checkstate = 0\r\n    }\r\n    if (a.dscheck) {\r\n        a.checkstate = a.dscheck\r\n    }\r\n    this._setSrc(g, this.imPath + ((a.parentObject._r_logic || this._frbtr) ? this.radioArray : this.checkArray)[a.checkstate])\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.isItemChecked = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return\r\n    }\r\n    return a.checkstate\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.deleteChildItems = function(g) {\r\n    var a = this._globalIdStorageFind(g);\r\n    if (!a) {\r\n        return\r\n    }\r\n    var c = a.childsCount;\r\n    for (var e = 0; e < c; e++) {\r\n        this._deleteNode(a.childNodes[0].id, a.childNodes[0])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.deleteItem = function(e, a) {\r\n    if ((!this._onrdlh) || (this._onrdlh(e))) {\r\n        var c = this._deleteItem(e, a);\r\n        if (c) {\r\n            this._fixChildCountLabel(c)\r\n        }\r\n    }\r\n    this.allTree.childNodes[0].border = \"1\";\r\n    this.allTree.childNodes[0].border = \"0\"\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._deleteItem = function(l, c, h) {\r\n    c = dhx4.s2b(c);\r\n    var a = this._globalIdStorageFind(l);\r\n    if (!a) {\r\n        return\r\n    }\r\n    var e = this.getParentId(l);\r\n    var g = a.parentObject;\r\n    this._deleteNode(l, a, h);\r\n    if (this._editCell && this._editCell.id == l) {\r\n        this._editCell = null \r\n    }\r\n    this._correctPlus(g);\r\n    this._correctLine(g);\r\n    if ((c) && (e != this.rootId)) {\r\n        this.selectItem(e, 1)\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._globalIdStorageRecSub = function(a) {\r\n    for (var c = 0; c < a.childsCount; c++) {\r\n        this._globalIdStorageRecSub(a.childNodes[c]);\r\n        this._globalIdStorageSub(a.childNodes[c].id)\r\n    }\r\n    this._globalIdStorageSub(a.id);\r\n    var e = a;\r\n    e.span = null ;\r\n    e.tr.nodem = null ;\r\n    e.tr = null ;\r\n    e.htmlNode = null \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.insertNewNext = function(n, s, r, e, l, h, g, c, a) {\r\n    var m = this._globalIdStorageFind(n);\r\n    if ((!m) || (!m.parentObject)) {\r\n        return ( 0) \r\n    }\r\n    var o = this._attachChildNode(0, s, r, e, l, h, g, c, a, m);\r\n    if ((!this.XMLloadingWarning) && (this.childCalc)) {\r\n        this._fixChildCountLabel(m.parentObject)\r\n    }\r\n    return o\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getItemIdByIndex = function(e, a) {\r\n    var c = this._globalIdStorageFind(e);\r\n    if ((!c) || (a >= c.childsCount)) {\r\n        return null \r\n    }\r\n    return c.childNodes[a].id\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getChildItemIdByIndex = function(e, a) {\r\n    var c = this._globalIdStorageFind(e);\r\n    if ((!c) || (a >= c.childsCount)) {\r\n        return null \r\n    }\r\n    return c.childNodes[a].id\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setDragHandler = function(a) {\r\n    this.attachEvent(\"onDrag\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._clearMove = function() {\r\n    if (this._lastMark) {\r\n        this._lastMark.className = this._lastMark.className.replace(/dragAndDropRow/g, \"\");\r\n        this._lastMark = null \r\n    }\r\n    this.selectionBar.style.display = \"none\";\r\n    this.allTree.className = this.allTree.className.replace(\" selectionBox\", \"\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableDragAndDrop = function(c, a) {\r\n    if (c == \"temporary_disabled\") {\r\n        this.dADTempOff = false;\r\n        c = true\r\n    } else {\r\n        this.dADTempOff = true\r\n    }\r\n    this.dragAndDropOff = dhx4.s2b(c);\r\n    if (this.dragAndDropOff) {\r\n        this.dragger.addDragLanding(this.allTree, this)\r\n    }\r\n    if (arguments.length > 1) {\r\n        this._ddronr = (!dhx4.s2b(a))\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._setMove = function(h, e, m) {\r\n    if (h.parentObject.span) {\r\n        var g = dhx4.absTop(h);\r\n        var c = dhx4.absTop(this.allTree) - this.allTree.scrollTop;\r\n        this.dadmodec = this.dadmode;\r\n        this.dadmodefix = 0;\r\n        if (this.dadmode == 2) {\r\n            var l = m - g + (document.body.scrollTop || document.documentElement.scrollTop) - 2 - h.offsetHeight / 2;\r\n            if ((Math.abs(l) - h.offsetHeight / 6) > 0) {\r\n                this.dadmodec = 1;\r\n                if (l < 0) {\r\n                    this.dadmodefix = 0 - h.offsetHeight\r\n                }\r\n            } else {\r\n                this.dadmodec = 0\r\n            }\r\n        }\r\n        if (this.dadmodec == 0) {\r\n            var a = h.parentObject.span;\r\n            a.className += \" dragAndDropRow\";\r\n            this._lastMark = a\r\n        } else {\r\n            this._clearMove();\r\n            this.selectionBar.style.top = (g - c + ((parseInt(h.parentObject.span.parentNode.previousSibling.childNodes[0].style.height) || 18) - 1) + this.dadmodefix) + \"px\";\r\n            this.selectionBar.style.left = \"5px\";\r\n            if (this.allTree.offsetWidth > 20) {\r\n                this.selectionBar.style.width = (this.allTree.offsetWidth - (_isFF ? 30 : 25)) + \"px\"\r\n            }\r\n            this.selectionBar.style.display = \"\"\r\n        }\r\n        this._autoScroll(null , g, c)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._autoScroll = function(e, c, a) {\r\n    if (this.autoScroll) {\r\n        if (e) {\r\n            c = dhx4.absTop(e);\r\n            a = dhx4.absTop(this.allTree) - this.allTree.scrollTop\r\n        }\r\n        if ((c - a - parseInt(this.allTree.scrollTop)) > (parseInt(this.allTree.offsetHeight) - 50)) {\r\n            this.allTree.scrollTop = parseInt(this.allTree.scrollTop) + 20\r\n        }\r\n        if ((c - a) < (parseInt(this.allTree.scrollTop) + 30)) {\r\n            this.allTree.scrollTop = parseInt(this.allTree.scrollTop) - 20\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._createDragNode = function(l, h) {\r\n    if (!this.dADTempOff) {\r\n        return null \r\n    }\r\n    var g = l.parentObject;\r\n    if (!this.callEvent(\"onBeforeDrag\", [g.id, h])) {\r\n        return null \r\n    }\r\n    if (!g.i_sel) {\r\n        this._selectItem(g, h)\r\n    }\r\n    this._checkMSelectionLogic();\r\n    var c = document.createElement(\"div\");\r\n    var m = new Array();\r\n    if (this._itim_dg) {\r\n        for (var a = 0; a < this._selected.length; a++) {\r\n            m[a] = \"<table cellspacing='0' cellpadding='0'><tr><td><img width='18px' height='18px' src='\" + this._getSrc(this._selected[a].span.parentNode.previousSibling.childNodes[0]) + \"'></td><td>\" + this._selected[a].span.innerHTML + \"</td></tr></table>\"\r\n        }\r\n    } else {\r\n        m = this.getSelectedItemText().split(this.dlmtr)\r\n    }\r\n    c.innerHTML = m.join(\"\");\r\n    c.style.position = \"absolute\";\r\n    c.className = \"dragSpanDiv\";\r\n    this._dragged = (new Array()).concat(this._selected);\r\n    return c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._focusNode = function(a) {\r\n    var c = dhx4.absTop(a.htmlNode) - dhx4.absTop(this.allTree);\r\n    if ((c > (this.allTree.offsetHeight - 30)) || (c < 0)) {\r\n        this.allTree.scrollTop = c + this.allTree.scrollTop\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._preventNsDrag = function(a) {\r\n    if ((a) && (a.preventDefault)) {\r\n        a.preventDefault();\r\n        return false\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._drag = function(m, n, a) {\r\n    if (this._autoOpenTimer) {\r\n        clearTimeout(this._autoOpenTimer)\r\n    }\r\n    if (!a.parentObject) {\r\n        a = this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];\r\n        this.dadmodec = 0\r\n    }\r\n    this._clearMove();\r\n    var l = m.parentObject.treeNod;\r\n    if ((l) && (l._clearMove)) {\r\n        l._clearMove(\"\")\r\n    }\r\n    if ((!this.dragMove) || (this.dragMove())) {\r\n        if ((!l) || (!l._clearMove) || (!l._dragged)) {\r\n            var g = new Array(m.parentObject)\r\n        } else {\r\n            var g = l._dragged\r\n        }\r\n        var c = a.parentObject;\r\n        for (var h = 0; h < g.length; h++) {\r\n            var e = this._moveNode(g[h], c);\r\n            if ((this.dadmodec) && (e !== false)) {\r\n                c = this._globalIdStorageFind(e, true, true)\r\n            }\r\n            if ((e) && (!this._sADnD)) {\r\n                this.selectItem(e, 0, 1)\r\n            }\r\n        }\r\n    }\r\n    if (l) {\r\n        l._dragged = new Array()\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._dragIn = function(g, c, l, h) {\r\n    if (!this.dADTempOff) {\r\n        return 0\r\n    }\r\n    var m = c.parentObject;\r\n    var a = g.parentObject;\r\n    if ((!a) && (this._ddronr)) {\r\n        return\r\n    }\r\n    if (!this.callEvent(\"onDragIn\", [m.id, a ? a.id : null , m.treeNod, this])) {\r\n        if (a) {\r\n            this._autoScroll(g)\r\n        }\r\n        return 0\r\n    }\r\n    if (!a) {\r\n        this.allTree.className += \" selectionBox\"\r\n    } else {\r\n        if (m.childNodes == null ) {\r\n            this._setMove(g, l, h);\r\n            return g\r\n        }\r\n        var o = m.treeNod;\r\n        for (var e = 0; e < o._dragged.length; e++) {\r\n            if (this._checkPNodes(a, o._dragged[e])) {\r\n                this._autoScroll(g);\r\n                return 0\r\n            }\r\n        }\r\n        this.selectionBar.parentNode.removeChild(this.selectionBar);\r\n        a.span.parentNode.appendChild(this.selectionBar);\r\n        this._setMove(g, l, h);\r\n        if (this._getOpenState(a) <= 0) {\r\n            var n = this;\r\n            this._autoOpenId = a.id;\r\n            this._autoOpenTimer = window.setTimeout(function() {\r\n                n._autoOpenItem(null , n);\r\n                n = null \r\n            }, 1000)\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._autoOpenItem = function(c, a) {\r\n    a.openItem(a._autoOpenId)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._dragOut = function(a) {\r\n    this._clearMove();\r\n    if (this._autoOpenTimer) {\r\n        clearTimeout(this._autoOpenTimer)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getNextNode = function(a, c) {\r\n    if ((!c) && (a.childsCount)) {\r\n        return a.childNodes[0]\r\n    }\r\n    if (a == this.htmlNode) {\r\n        return -1\r\n    }\r\n    if ((a.tr) && (a.tr.nextSibling) && (a.tr.nextSibling.nodem)) {\r\n        return a.tr.nextSibling.nodem\r\n    }\r\n    return this._getNextNode(a.parentObject, true)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._lastChild = function(a) {\r\n    if (a.childsCount) {\r\n        return this._lastChild(a.childNodes[a.childsCount - 1])\r\n    } else {\r\n        return a\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getPrevNode = function(a, c) {\r\n    if ((a.tr) && (a.tr.previousSibling) && (a.tr.previousSibling.nodem)) {\r\n        return this._lastChild(a.tr.previousSibling.nodem)\r\n    }\r\n    if (a.parentObject) {\r\n        return a.parentObject\r\n    } else {\r\n        return -1\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.findItem = function(a, e, c) {\r\n    var g = this._findNodeByLabel(a, e, (c ? this.htmlNode : null ));\r\n    if (g) {\r\n        this.selectItem(g.id, true);\r\n        this._focusNode(g);\r\n        return g.id\r\n    } else {\r\n        return null \r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.findItemIdByLabel = function(a, e, c) {\r\n    var g = this._findNodeByLabel(a, e, (c ? this.htmlNode : null ));\r\n    if (g) {\r\n        return g.id\r\n    } else {\r\n        return null \r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.findStrInXML = function(c, e, h) {\r\n    if (!c.childNodes && c.item) {\r\n        return this.findStrInJSON(c, e, h)\r\n    }\r\n    if (!c.childNodes) {\r\n        return false\r\n    }\r\n    for (var a = 0; a < c.childNodes.length; a++) {\r\n        if (c.childNodes[a].nodeType == 1) {\r\n            var g = c.childNodes[a].getAttribute(e);\r\n            if (!g && c.childNodes[a].tagName == \"itemtext\") {\r\n                g = c.childNodes[a].firstChild.data\r\n            }\r\n            if ((g) && (g.toLowerCase().search(h) != -1)) {\r\n                return true\r\n            }\r\n            if (this.findStrInXML(c.childNodes[a], e, h)) {\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.findStrInJSON = function(c, e, h) {\r\n    for (var a = 0; a < c.item.length; a++) {\r\n        var g = c.item[a].text;\r\n        if ((g) && (g.toLowerCase().search(h) != -1)) {\r\n            return true\r\n        }\r\n        if (c.item[a].item && this.findStrInJSON(c.item[a], e, h)) {\r\n            return true\r\n        }\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._findNodeByLabel = function(a, h, g) {\r\n    var a = a.replace(new RegExp(\"^( )+\"), \"\").replace(new RegExp(\"( )+$\"), \"\");\r\n    a = new RegExp(a.replace(/([\\^\\.\\?\\*\\+\\\\\\[\\]\\(\\)]{1})/gi, \"\\\\$1\").replace(/ /gi, \".*\"),\"gi\");\r\n    if (!g) {\r\n        g = this._selected[0];\r\n        if (!g) {\r\n            g = this.htmlNode\r\n        }\r\n    }\r\n    var c = g;\r\n    if (!h) {\r\n        if ((g.unParsed) && (this.findStrInXML(g.unParsed.d, \"text\", a))) {\r\n            this.reParse(g)\r\n        }\r\n        g = this._getNextNode(c);\r\n        if (g == -1) {\r\n            g = this.htmlNode.childNodes[0]\r\n        }\r\n    } else {\r\n        var e = this._getPrevNode(c);\r\n        if (e == -1) {\r\n            e = this._lastChild(this.htmlNode)\r\n        }\r\n        if ((e.unParsed) && (this.findStrInXML(e.unParsed.d, \"text\", a))) {\r\n            this.reParse(e);\r\n            g = this._getPrevNode(c)\r\n        } else {\r\n            g = e\r\n        }\r\n        if (g == -1) {\r\n            g = this._lastChild(this.htmlNode)\r\n        }\r\n    }\r\n    while ((g) && (g != c)) {\r\n        if ((g.label) && (g.label.search(a) != -1)) {\r\n            return ( g) \r\n        }\r\n        if (!h) {\r\n            if (g == -1) {\r\n                if (c == this.htmlNode) {\r\n                    break\r\n                }\r\n                g = this.htmlNode.childNodes[0]\r\n            }\r\n            if ((g.unParsed) && (this.findStrInXML(g.unParsed.d, \"text\", a))) {\r\n                this.reParse(g)\r\n            }\r\n            g = this._getNextNode(g);\r\n            if (g == -1) {\r\n                g = this.htmlNode\r\n            }\r\n        } else {\r\n            var e = this._getPrevNode(g);\r\n            if (e == -1) {\r\n                e = this._lastChild(this.htmlNode)\r\n            }\r\n            if ((e.unParsed) && (this.findStrInXML(e.unParsed.d, \"text\", a))) {\r\n                this.reParse(e);\r\n                g = this._getPrevNode(g)\r\n            } else {\r\n                g = e\r\n            }\r\n            if (g == -1) {\r\n                g = this._lastChild(this.htmlNode)\r\n            }\r\n        }\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.moveItem = function(n, c, o, a) {\r\n    var h = this._globalIdStorageFind(n);\r\n    if (!h) {\r\n        return ( 0) \r\n    }\r\n    var l = null ;\r\n    switch (c) {\r\n    case \"right\":\r\n        alert(\"Not supported yet\");\r\n        break;\r\n    case \"item_child\":\r\n        var e = (a || this)._globalIdStorageFind(o);\r\n        if (!e) {\r\n            return ( 0) \r\n        }\r\n        l = (a || this)._moveNodeTo(h, e, 0);\r\n        break;\r\n    case \"item_sibling\":\r\n        var e = (a || this)._globalIdStorageFind(o);\r\n        if (!e) {\r\n            return ( 0) \r\n        }\r\n        l = (a || this)._moveNodeTo(h, e.parentObject, e);\r\n        break;\r\n    case \"item_sibling_next\":\r\n        var e = (a || this)._globalIdStorageFind(o);\r\n        if (!e) {\r\n            return ( 0) \r\n        }\r\n        if ((e.tr) && (e.tr.nextSibling) && (e.tr.nextSibling.nodem)) {\r\n            l = (a || this)._moveNodeTo(h, e.parentObject, e.tr.nextSibling.nodem)\r\n        } else {\r\n            l = (a || this)._moveNodeTo(h, e.parentObject)\r\n        }\r\n        break;\r\n    case \"left\":\r\n        if (h.parentObject.parentObject) {\r\n            l = this._moveNodeTo(h, h.parentObject.parentObject, h.parentObject)\r\n        }\r\n        break;\r\n    case \"up\":\r\n        var m = this._getPrevNode(h);\r\n        if ((m == -1) || (!m.parentObject)) {\r\n            return null \r\n        }\r\n        l = this._moveNodeTo(h, m.parentObject, m);\r\n        break;\r\n    case \"up_strict\":\r\n        var m = this._getIndex(h);\r\n        if (m != 0) {\r\n            l = this._moveNodeTo(h, h.parentObject, h.parentObject.childNodes[m - 1])\r\n        }\r\n        break;\r\n    case \"down_strict\":\r\n        var m = this._getIndex(h);\r\n        var g = h.parentObject.childsCount - 2;\r\n        if (m == g) {\r\n            l = this._moveNodeTo(h, h.parentObject)\r\n        } else {\r\n            if (m < g) {\r\n                l = this._moveNodeTo(h, h.parentObject, h.parentObject.childNodes[m + 2])\r\n            }\r\n        }\r\n        break;\r\n    case \"down\":\r\n        var m = this._getNextNode(this._lastChild(h));\r\n        if ((m == -1) || (!m.parentObject)) {\r\n            return\r\n        }\r\n        if (m.parentObject == h.parentObject) {\r\n            var m = this._getNextNode(m)\r\n        }\r\n        if (m == -1) {\r\n            l = this._moveNodeTo(h, h.parentObject)\r\n        } else {\r\n            if ((m == -1) || (!m.parentObject)) {\r\n                return\r\n            }\r\n            l = this._moveNodeTo(h, m.parentObject, m)\r\n        }\r\n        break\r\n    }\r\n    if (_isIE && _isIE < 8) {\r\n        this.allTree.childNodes[0].border = \"1\";\r\n        this.allTree.childNodes[0].border = \"0\"\r\n    }\r\n    return l\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setDragBehavior = function(c, a) {\r\n    this._sADnD = (!dhx4.s2b(a));\r\n    switch (c) {\r\n    case \"child\":\r\n        this.dadmode = 0;\r\n        break;\r\n    case \"sibling\":\r\n        this.dadmode = 1;\r\n        break;\r\n    case \"complex\":\r\n        this.dadmode = 2;\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadDynXML = function(e, c) {\r\n    c = c || this.XMLsource;\r\n    var a = (new Date()).valueOf();\r\n    this._ld_id = e;\r\n    if (this.xmlalb == \"function\") {\r\n        if (c) {\r\n            c(this._escape(e))\r\n        }\r\n    } else {\r\n        if (this.xmlalb == \"name\") {\r\n            this.load(c + this._escape(e))\r\n        } else {\r\n            if (this.xmlalb == \"xmlname\") {\r\n                this.load(c + this._escape(e) + \".xml?uid=\" + a)\r\n            } else {\r\n                this.load(c + dhtmlx.url(c) + \"uid=\" + a + \"&id=\" + this._escape(e))\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableMultiselection = function(c, a) {\r\n    this._amsel = dhx4.s2b(c);\r\n    this._amselS = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._checkMSelectionLogic = function() {\r\n    var e = new Array();\r\n    for (var c = 0; c < this._selected.length; c++) {\r\n        for (var a = 0; a < this._selected.length; a++) {\r\n            if ((c != a) && (this._checkPNodes(this._selected[a], this._selected[c]))) {\r\n                e[e.length] = this._selected[a]\r\n            }\r\n        }\r\n    }\r\n    for (var c = 0; c < e.length; c++) {\r\n        this._unselectItem(e[c])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._checkPNodes = function(c, a) {\r\n    if (this._dcheckf) {\r\n        return false\r\n    }\r\n    if (a == c) {\r\n        return 1\r\n    }\r\n    if (c.parentObject) {\r\n        return this._checkPNodes(c.parentObject, a)\r\n    } else {\r\n        return 0\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.disableDropCheck = function(a) {\r\n    this._dcheckf = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableDistributedParsing = function(e, c, a) {\r\n    this._edsbps = dhx4.s2b(e);\r\n    this._edsbpsA = new Array();\r\n    this._edsbpsC = c || 10;\r\n    this._edsbpsD = a || 250\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getDistributedParsingState = function() {\r\n    return ( !((!this._edsbpsA) || (!this._edsbpsA.length))) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getItemParsingState = function(e) {\r\n    var c = this._globalIdStorageFind(e, true, true);\r\n    if (!c) {\r\n        return 0\r\n    }\r\n    if (this._edsbpsA) {\r\n        for (var a = 0; a < this._edsbpsA.length; a++) {\r\n            if (this._edsbpsA[a][2] == e) {\r\n                return -1\r\n            }\r\n        }\r\n    }\r\n    return 1\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._distributedStart = function(c, h, g, e, a) {\r\n    if (!this._edsbpsA) {\r\n        this._edsbpsA = new Array()\r\n    }\r\n    this._edsbpsA[this._edsbpsA.length] = [c, h, g, e, a]\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._distributedStep = function(g) {\r\n    var c = this;\r\n    if ((!this._edsbpsA) || (!this._edsbpsA.length)) {\r\n        c.XMLloadingWarning = 0;\r\n        return\r\n    }\r\n    var h = this._edsbpsA[0];\r\n    this.parsedArray = new Array();\r\n    this._parse(h[0], h[2], h[3], h[1]);\r\n    var a = this._globalIdStorageFind(h[2]);\r\n    this._redrawFrom(this, a, h[4], this._getOpenState(a));\r\n    var e = this.setCheckList.split(this.dlmtr);\r\n    for (var l = 0; l < e.length; l++) {\r\n        if (e[l]) {\r\n            this.setCheck(e[l], 1)\r\n        }\r\n    }\r\n    this._edsbpsA = (new Array()).concat(this._edsbpsA.slice(1));\r\n    if ((!this._edsbpsA.length) ) {\r\n        window.setTimeout(function() {\r\n            if (c.onXLE) {\r\n                c.onXLE(c, g)\r\n            }\r\n            c.callEvent(\"onXLE\", [c, g])\r\n        }, 1);\r\n        c.xmlstate = 0\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableTextSigns = function(a) {\r\n    this._txtimg = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.preventIECaching = function(a) {\r\n    dhx4.ajax.cache = !a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.preventIECashing = dhtmlXTreeObject.prototype.preventIECaching;\r\ndhtmlXTreeObject.prototype.disableCheckbox = function(e, c) {\r\n    if (typeof (e) != \"object\") {\r\n        var a = this._globalIdStorageFind(e, 0, 1)\r\n    } else {\r\n        var a = e\r\n    }\r\n    if (!a) {\r\n        return\r\n    }\r\n    a.dscheck = dhx4.s2b(c) ? (((a.checkstate || 0) % 3) + 3) : ((a.checkstate > 2) ? (a.checkstate - 3) : a.checkstate);\r\n    this._setCheck(a);\r\n    if (a.dscheck < 3) {\r\n        a.dscheck = false\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.smartRefreshBranch = function(c, a) {\r\n    this._branchUpdate = 1;\r\n    this.smartRefreshItem(c, a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.smartRefreshItem = function(g, e) {\r\n    var a = this._globalIdStorageFind(g);\r\n    for (var c = 0; c < a.childsCount; c++) {\r\n        a.childNodes[c]._dmark = true\r\n    }\r\n    this.waitUpdateXML = true;\r\n    if (e && e.exists) {\r\n        this._parse(e, g)\r\n    } else {\r\n        this._loadDynXML(g, e)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.refreshItems = function(c, e) {\r\n    var g = c.toString().split(this.dlmtr);\r\n    this.waitUpdateXML = new Array();\r\n    for (var a = 0; a < g.length; a++) {\r\n        this.waitUpdateXML[g[a]] = true\r\n    }\r\n    this.load((e || this.XMLsource) + dhtmlx.url(e || this.XMLsource) + \"ids=\" + this._escape(c))\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.updateItem = function(m, l, g, e, c, h, n) {\r\n    var a = this._globalIdStorageFind(m);\r\n    a.userData = new cObject();\r\n    if (l) {\r\n        a.label = l\r\n    }\r\n    a.images = new Array(g || this.imageArray[0],e || this.imageArray[1],c || this.imageArray[2]);\r\n    this.setItemText(m, l);\r\n    if (h) {\r\n        this._setCheck(a, true)\r\n    }\r\n    if (n == \"1\" && !this.hasChildren(m)) {\r\n        a.XMLload = 0\r\n    }\r\n    this._correctPlus(a);\r\n    a._dmark = false;\r\n    return a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setDropHandler = function(a) {\r\n    this.attachEvent(\"onDrop\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnLoadingStart = function(a) {\r\n    this.attachEvent(\"onXLS\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnLoadingEnd = function(a) {\r\n    this.attachEvent(\"onXLE\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setXMLAutoLoadingBehaviour = function(a) {\r\n    this.xmlalb = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableSmartCheckboxes = function(a) {\r\n    this.smcheck = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getXMLState = function() {\r\n    return ( this.xmlstate == 1) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemTopOffset = function(l, g) {\r\n    var e;\r\n    if (typeof (l) != \"object\") {\r\n        e = this._globalIdStorageFind(l)\r\n    } else {\r\n        e = l\r\n    }\r\n    var h = e.span.parentNode.parentNode;\r\n    e.span.style.paddingBottom = \"1px\";\r\n    for (var c = 0; c < h.childNodes.length; c++) {\r\n        if (c != 0) {\r\n            if (_isIE) {\r\n                h.childNodes[c].style.height = \"18px\";\r\n                h.childNodes[c].style.paddingTop = parseInt(g) + \"px\"\r\n            } else {\r\n                h.childNodes[c].style.height = 18 + parseInt(g) + \"px\"\r\n            }\r\n        } else {\r\n            var a = h.childNodes[c].firstChild;\r\n            if (h.childNodes[c].firstChild.tagName != \"DIV\") {\r\n                a = document.createElement(\"DIV\");\r\n                h.childNodes[c].insertBefore(a, h.childNodes[c].firstChild)\r\n            }\r\n            if ((e.parentObject.id != this.rootId || e.parentObject.childNodes[0] != e) && this.treeLinesOn) {\r\n                h.childNodes[c].style.backgroundImage = \"url(\" + this.imPath + this.lineArray[5] + \")\"\r\n            }\r\n            a.innerHTML = \"&nbsp;\";\r\n            a.style.overflow = \"hidden\"\r\n        }\r\n        a.style.verticalAlign = h.childNodes[c].style.verticalAlign = \"bottom\";\r\n        if (_isIE) {\r\n            this.allTree.childNodes[0].border = \"1\";\r\n            this.allTree.childNodes[0].border = \"0\"\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setIconSize = function(g, c, h) {\r\n    if (h) {\r\n        if ((h) && (h.span)) {\r\n            var a = h\r\n        } else {\r\n            var a = this._globalIdStorageFind(h)\r\n        }\r\n        if (!a) {\r\n            return ( 0) \r\n        }\r\n        var e = a.span.parentNode.previousSibling.childNodes[0];\r\n        if (g) {\r\n            e.style.width = g + \"px\";\r\n            if (window._KHTMLrv) {\r\n                e.parentNode.style.width = g + \"px\"\r\n            }\r\n        }\r\n        if (c) {\r\n            e.style.height = c + \"px\";\r\n            if (window._KHTMLrv) {\r\n                e.parentNode.style.height = c + \"px\"\r\n            }\r\n        }\r\n    } else {\r\n        this.def_img_x = g;\r\n        this.def_img_y = c\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getItemImage = function(h, g, c) {\r\n    var e = this._globalIdStorageFind(h);\r\n    if (!e) {\r\n        return \"\"\r\n    }\r\n    var a = e.images[g || 0];\r\n    if (c) {\r\n        a = this.iconURL + a\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableRadioButtons = function(g, e) {\r\n    if (arguments.length == 1) {\r\n        this._frbtr = dhx4.s2b(g);\r\n        this.checkBoxOff = this.checkBoxOff || this._frbtr;\r\n        return\r\n    }\r\n    var c = this._globalIdStorageFind(g);\r\n    if (!c) {\r\n        return \"\"\r\n    }\r\n    e = dhx4.s2b(e);\r\n    if ((e) && (!c._r_logic)) {\r\n        c._r_logic = true;\r\n        for (var a = 0; a < c.childsCount; a++) {\r\n            this._setCheck(c.childNodes[a], c.childNodes[a].checkstate)\r\n        }\r\n    }\r\n    if ((!e) && (c._r_logic)) {\r\n        c._r_logic = false;\r\n        for (var a = 0; a < c.childsCount; a++) {\r\n            this._setCheck(c.childNodes[a], c.childNodes[a].checkstate)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableSingleRadioMode = function(a) {\r\n    this._frbtrs = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.openOnItemAdded = function(a) {\r\n    this._hAdI = !dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.openOnItemAdding = function(a) {\r\n    this._hAdI = !dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableMultiLineItems = function(a) {\r\n    if (a === true) {\r\n        this.mlitems = \"100%\"\r\n    } else {\r\n        this.mlitems = a\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableAutoTooltips = function(a) {\r\n    this.ettip = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.clearSelection = function(a) {\r\n    if (a) {\r\n        this._unselectItem(this._globalIdStorageFind(a))\r\n    } else {\r\n        this._unselectItems()\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.showItemSign = function(g, c) {\r\n    var a = this._globalIdStorageFind(g);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    var e = a.span.parentNode.previousSibling.previousSibling.previousSibling;\r\n    if (!dhx4.s2b(c)) {\r\n        this._openItem(a);\r\n        a.closeble = false;\r\n        a.wsign = true\r\n    } else {\r\n        a.closeble = true;\r\n        a.wsign = false\r\n    }\r\n    this._correctPlus(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.showItemCheckbox = function(h, g) {\r\n    if (!h) {\r\n        for (var c in this._idpull) {\r\n            this.showItemCheckbox(this._idpull[c], g)\r\n        }\r\n    }\r\n    if (typeof (h) != \"object\") {\r\n        h = this._globalIdStorageFind(h, 0, 0)\r\n    }\r\n    if (!h) {\r\n        return 0\r\n    }\r\n    h.nocheckbox = !dhx4.s2b(g);\r\n    var e = h.span.parentNode.previousSibling.previousSibling.childNodes[0];\r\n    e.parentNode.style.display = (!h.nocheckbox) ? \"\" : \"none\"\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setListDelimeter = function(a) {\r\n    this.dlmtr = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setEscapingMode = function(a) {\r\n    this.utfesc = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableHighlighting = function(a) {\r\n    this.ehlt = true;\r\n    this.ehlta = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._itemMouseOut = function() {\r\n    var c = this.childNodes[3].parentObject;\r\n    var a = c.treeNod;\r\n    a.callEvent(\"onMouseOut\", [c.id]);\r\n    if (c.id == a._l_onMSI) {\r\n        a._l_onMSI = null \r\n    }\r\n    if (!a.ehlta) {\r\n        return\r\n    }\r\n    c.span.className = c.span.className.replace(\"_lor\", \"\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._itemMouseIn = function() {\r\n    var c = this.childNodes[3].parentObject;\r\n    var a = c.treeNod;\r\n    if (a._l_onMSI != c.id) {\r\n        a.callEvent(\"onMouseIn\", [c.id])\r\n    }\r\n    a._l_onMSI = c.id;\r\n    if (!a.ehlta) {\r\n        return\r\n    }\r\n    c.span.className = c.span.className.replace(\"_lor\", \"\");\r\n    c.span.className = c.span.className.replace(/((standart|selected)TreeRow)/, \"$1_lor\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableActiveImages = function(a) {\r\n    this._aimgs = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.focusItem = function(c) {\r\n    var a = this._globalIdStorageFind(c);\r\n    if (!a) {\r\n        return ( 0) \r\n    }\r\n    this._focusNode(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllSubItems = function(a) {\r\n    return this._getAllSubItems(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllChildless = function() {\r\n    return this._getAllScraggyItems(this.htmlNode)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllLeafs = dhtmlXTreeObject.prototype.getAllChildless;\r\ndhtmlXTreeObject.prototype._getAllScraggyItems = function(e) {\r\n    var g = \"\";\r\n    for (var c = 0; c < e.childsCount; c++) {\r\n        if ((e.childNodes[c].unParsed) || (e.childNodes[c].childsCount > 0)) {\r\n            if (e.childNodes[c].unParsed) {\r\n                var a = this._getAllScraggyItemsXML(e.childNodes[c].unParsed, 1)\r\n            } else {\r\n                var a = this._getAllScraggyItems(e.childNodes[c])\r\n            }\r\n            if (a) {\r\n                if (g) {\r\n                    g += this.dlmtr + a\r\n                } else {\r\n                    g = a\r\n                }\r\n            }\r\n        } else {\r\n            if (!g) {\r\n                g = \"\" + e.childNodes[c].id\r\n            } else {\r\n                g += this.dlmtr + e.childNodes[c].id\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllFatItems = function(e) {\r\n    var g = \"\";\r\n    for (var c = 0; c < e.childsCount; c++) {\r\n        if ((e.childNodes[c].unParsed) || (e.childNodes[c].childsCount > 0)) {\r\n            if (!g) {\r\n                g = \"\" + e.childNodes[c].id\r\n            } else {\r\n                g += this.dlmtr + e.childNodes[c].id\r\n            }\r\n            if (e.childNodes[c].unParsed) {\r\n                var a = this._getAllFatItemsXML(e.childNodes[c].unParsed, 1)\r\n            } else {\r\n                var a = this._getAllFatItems(e.childNodes[c])\r\n            }\r\n            if (a) {\r\n                g += this.dlmtr + a\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllItemsWithKids = function() {\r\n    return this._getAllFatItems(this.htmlNode)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllFatItems = dhtmlXTreeObject.prototype.getAllItemsWithKids;\r\ndhtmlXTreeObject.prototype.getAllChecked = function() {\r\n    return this._getAllChecked(\"\", \"\", 1)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllUnchecked = function(a) {\r\n    if (a) {\r\n        a = this._globalIdStorageFind(a)\r\n    }\r\n    return this._getAllChecked(a, \"\", 0)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllPartiallyChecked = function() {\r\n    return this._getAllChecked(\"\", \"\", 2)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getAllCheckedBranches = function() {\r\n    var a = [this._getAllChecked(\"\", \"\", 1)];\r\n    var c = this._getAllChecked(\"\", \"\", 2);\r\n    if (c) {\r\n        a.push(c)\r\n    }\r\n    return a.join(this.dlmtr)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getAllChecked = function(g, e, h) {\r\n    if (!g) {\r\n        g = this.htmlNode\r\n    }\r\n    if (g.checkstate == h) {\r\n        if (!g.nocheckbox) {\r\n            if (e) {\r\n                e += this.dlmtr + g.id\r\n            } else {\r\n                e = \"\" + g.id\r\n            }\r\n        }\r\n    }\r\n    var a = g.childsCount;\r\n    for (var c = 0; c < a; c++) {\r\n        e = this._getAllChecked(g.childNodes[c], e, h)\r\n    }\r\n    if (g.unParsed) {\r\n        e = this._getAllCheckedXML(g.unParsed, e, h)\r\n    }\r\n    if (e) {\r\n        return e\r\n    } else {\r\n        return \"\"\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setItemStyle = function(g, e, c) {\r\n    var c = c || false;\r\n    var a = this._globalIdStorageFind(g);\r\n    if (!a) {\r\n        return 0\r\n    }\r\n    if (!a.span.style.cssText) {\r\n        a.span.setAttribute(\"style\", a.span.getAttribute(\"style\") + \"; \" + e)\r\n    } else {\r\n        a.span.style.cssText = c ? e : a.span.style.cssText + \";\" + e\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableImageDrag = function(a) {\r\n    this._itim_dg = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnDragIn = function(a) {\r\n    this.attachEvent(\"onDragIn\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableDragAndDropScrolling = function(a) {\r\n    this.autoScroll = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setSkin = function(a) {\r\n    var c = this.parentObject.className.replace(/dhxtree_[^ ]*/gi, \"\");\r\n    this.parentObject.className = c + \" dhxtree_\" + a;\r\n    if (a == \"dhx_terrace\" || a == \"dhx_web\") {\r\n        this.enableTreeLines(false)\r\n    }\r\n}\r\n;\r\n(function() {\r\n    dhtmlx.extend_api(\"dhtmlXTreeObject\", {\r\n        _init: function(a) {\r\n            return [a.parent, (a.width || \"100%\"), (a.height || \"100%\"), (a.root_id || 0)]\r\n        },\r\n        auto_save_selection: \"enableAutoSavingSelected\",\r\n        auto_tooltip: \"enableAutoTooltips\",\r\n        checkbox: \"enableCheckBoxes\",\r\n        checkbox_3_state: \"enableThreeStateCheckboxes\",\r\n        checkbox_smart: \"enableSmartCheckboxes\",\r\n        context_menu: \"enableContextMenu\",\r\n        distributed_parsing: \"enableDistributedParsing\",\r\n        drag: \"enableDragAndDrop\",\r\n        drag_copy: \"enableMercyDrag\",\r\n        drag_image: \"enableImageDrag\",\r\n        drag_scroll: \"enableDragAndDropScrolling\",\r\n        editor: \"enableItemEditor\",\r\n        hover: \"enableHighlighting\",\r\n        images: \"enableTreeImages\",\r\n        image_fix: \"enableIEImageFix\",\r\n        image_path: \"setImagePath\",\r\n        lines: \"enableTreeLines\",\r\n        loading_item: \"enableLoadingItem\",\r\n        multiline: \"enableMultiLineItems\",\r\n        multiselect: \"enableMultiselection\",\r\n        navigation: \"enableKeyboardNavigation\",\r\n        radio: \"enableRadioButtons\",\r\n        radio_single: \"enableSingleRadioMode\",\r\n        rtl: \"enableRTL\",\r\n        search: \"enableKeySearch\",\r\n        smart_parsing: \"enableSmartXMLParsing\",\r\n        smart_rendering: \"enableSmartRendering\",\r\n        text_icons: \"enableTextSigns\",\r\n        xml: \"loadXML\",\r\n        skin: \"setSkin\"\r\n    }, {})\r\n})();\r\ndhtmlXTreeObject.prototype._dp_init = function(a) {\r\n    a.attachEvent(\"insertCallback\", function(g, l, c) {\r\n        var e = dhx4.ajax.xpath(\".//item\", g);\r\n        var h = e[0].getAttribute(\"text\");\r\n        this.obj.insertNewItem(c, l, h, 0, 0, 0, 0, \"CHILD\")\r\n    });\r\n    a.attachEvent(\"updateCallback\", function(g, l, c) {\r\n        var e = dhx4.ajax.xpath(\".//item\", g);\r\n        var h = e[0].getAttribute(\"text\");\r\n        this.obj.setItemText(l, h);\r\n        if (this.obj.getParentId(l) != c) {\r\n            this.obj.moveItem(l, \"item_child\", c)\r\n        }\r\n        this.setUpdated(l, true, \"updated\")\r\n    });\r\n    a.attachEvent(\"deleteCallback\", function(e, g, c) {\r\n        this.obj.setUserData(g, this.action_param, \"true_deleted\");\r\n        this.obj.deleteItem(g, false)\r\n    });\r\n    a._methods = [\"setItemStyle\", \"\", \"changeItemId\", \"deleteItem\"];\r\n    this.attachEvent(\"onEdit\", function(c, e) {\r\n        if (c == 3) {\r\n            a.setUpdated(e, true)\r\n        }\r\n        return true\r\n    });\r\n    this.attachEvent(\"onDrop\", function(l, h, g, e, c) {\r\n        if (e == c) {\r\n            a.setUpdated(l, true)\r\n        }\r\n    });\r\n    this._onrdlh = function(c) {\r\n        var e = a.getState(c);\r\n        if (e == \"inserted\") {\r\n            a.set_invalid(c, false);\r\n            a.setUpdated(c, false);\r\n            return true\r\n        }\r\n        if (e == \"true_deleted\") {\r\n            a.setUpdated(c, false);\r\n            return true\r\n        }\r\n        a.setUpdated(c, true, \"deleted\");\r\n        return false\r\n    }\r\n    ;\r\n    this._onradh = function(c) {\r\n        a.setUpdated(c, true, \"inserted\")\r\n    }\r\n    ;\r\n    a._getRowData = function(h) {\r\n        var g = {};\r\n        var l = this.obj._globalIdStorageFind(h);\r\n        var e = l.parentObject;\r\n        var c = 0;\r\n        for (c = 0; c < e.childsCount; c++) {\r\n            if (e.childNodes[c] == l) {\r\n                break\r\n            }\r\n        }\r\n        g.tr_id = l.id;\r\n        g.tr_pid = e.id;\r\n        g.tr_order = c;\r\n        g.tr_text = l.span.innerHTML;\r\n        e = (l._userdatalist || \"\").split(\",\");\r\n        for (c = 0; c < e.length; c++) {\r\n            g[e[c]] = l.userData[\"t_\" + e[c]]\r\n        }\r\n        return g\r\n    }\r\n}\r\n;\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachTree = function(a) {\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"tree\"]);\r\n        var c = document.createElement(\"DIV\");\r\n        c.style.width = \"100%\";\r\n        c.style.height = \"100%\";\r\n        c.style.position = \"relative\";\r\n        c.style.overflow = \"hidden\";\r\n        this._attachObject(c);\r\n        this.dataType = \"tree\";\r\n        this.dataObj = new dhtmlXTreeObject(c,\"100%\",\"100%\",(a || 0));\r\n        this.dataObj.setSkin(this.conf.skin);\r\n        this.dataObj.allTree.childNodes[0].style.marginTop = \"2px\";\r\n        this.dataObj.allTree.childNodes[0].style.marginBottom = \"2px\";\r\n        c = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataObj\r\n    }\r\n}\r\ndhtmlXTreeObject.prototype.makeDraggable = function(c, a) {\r\n    if (typeof (c) != \"object\") {\r\n        c = document.getElementById(c)\r\n    }\r\n    dragger = new dhtmlDragAndDropObject();\r\n    dropper = new dhx_dragSomethingInTree();\r\n    dragger.addDraggableItem(c, dropper);\r\n    c.dragLanding = null ;\r\n    c.ondragstart = dropper._preventNsDrag;\r\n    c.onselectstart = new Function(\"return false;\");\r\n    c.parentObject = new Object;\r\n    c.parentObject.img = c;\r\n    c.parentObject.treeNod = dropper;\r\n    dropper._customDrop = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.makeDragable = dhtmlXTreeObject.prototype.makeDraggable;\r\ndhtmlXTreeObject.prototype.makeAllDraggable = function(c) {\r\n    var e = document.getElementsByTagName(\"div\");\r\n    for (var a = 0; a < e.length; a++) {\r\n        if (e[a].getAttribute(\"dragInDhtmlXTree\")) {\r\n            this.makeDragable(e[a], c)\r\n        }\r\n    }\r\n}\r\n;\r\nfunction dhx_dragSomethingInTree() {\r\n    this.lWin = window;\r\n    this._createDragNode = function(c) {\r\n        var a = document.createElement(\"div\");\r\n        a.style.position = \"absolute\";\r\n        a.innerHTML = (c.innerHTML || c.value);\r\n        a.className = \"dragSpanDiv\";\r\n        return a\r\n    }\r\n    ;\r\n    this._preventNsDrag = function(a) {\r\n        (a || window.event).cancelBubble = true;\r\n        if ((a) && (a.preventDefault)) {\r\n            a.preventDefault();\r\n            return false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._nonTrivialNode = function(c, e, a, g) {\r\n        if (this._customDrop) {\r\n            return this._customDrop(c, g.img.id, e.id, a ? a.id : null )\r\n        }\r\n        var h = (g.img.getAttribute(\"image\") || \"\");\r\n        var m = g.img.id || \"new\";\r\n        var l = (g.img.getAttribute(\"text\") || (_isIE ? g.img.innerText : g.img.textContent));\r\n        c[a ? \"insertNewNext\" : \"insertNewItem\"](a ? a.id : e.id, m, l, \"\", h, h, h)\r\n    }\r\n}\r\ndhtmlXTreeObject.prototype.enableItemEditor = function(a) {\r\n    this._eItEd = dhx4.s2b(a);\r\n    if (!this._eItEdFlag) {\r\n        this._edn_click_IE = true;\r\n        this._edn_dblclick = true;\r\n        this._ie_aFunc = this.aFunc;\r\n        this._ie_dblclickFuncHandler = this.dblclickFuncHandler;\r\n        this.setOnDblClickHandler(function(e, c) {\r\n            if (this._edn_dblclick) {\r\n                this._editItem(e, c)\r\n            }\r\n            return true\r\n        });\r\n        this.setOnClickHandler(function(e, c) {\r\n            this._stopEditItem(e, c);\r\n            if ((this.ed_hist_clcik == e) && (this._edn_click_IE)) {\r\n                this._editItem(e, c)\r\n            }\r\n            this.ed_hist_clcik = e;\r\n            return true\r\n        });\r\n        this._eItEdFlag = true\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setOnEditHandler = function(a) {\r\n    this.attachEvent(\"onEdit\", a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setEditStartAction = function(a, c) {\r\n    this._edn_click_IE = dhx4.s2b(a);\r\n    this._edn_dblclick = dhx4.s2b(c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._stopEdit = function(c, l) {\r\n    if (this._editCell) {\r\n        this.dADTempOff = this.dADTempOffEd;\r\n        if (this._editCell.id != c) {\r\n            var g = true;\r\n            if (!l) {\r\n                g = this.callEvent(\"onEdit\", [2, this._editCell.id, this, this._editCell.span.childNodes[0].value])\r\n            } else {\r\n                g = false;\r\n                this.callEvent(\"onEditCancel\", [this._editCell.id, this._editCell._oldValue])\r\n            }\r\n            if (g === true) {\r\n                g = this._editCell.span.childNodes[0].value\r\n            } else {\r\n                if (g === false) {\r\n                    g = this._editCell._oldValue\r\n                }\r\n            }\r\n            var h = (g != this._editCell._oldValue);\r\n            this._editCell.span.innerHTML = g;\r\n            this._editCell.label = this._editCell.span.innerHTML;\r\n            var e = this._editCell.i_sel ? \"selectedTreeRow\" : \"standartTreeRow\";\r\n            this._editCell.span.className = e;\r\n            this._editCell.span.parentNode.className = \"standartTreeRow\";\r\n            this._editCell.span.style.paddingRight = this._editCell.span.style.paddingLeft = \"5px\";\r\n            this._editCell.span.onclick = this._editCell.span.ondblclick = function() {}\r\n            ;\r\n            var m = this._editCell.id;\r\n            if (this.childCalc) {\r\n                this._fixChildCountLabel(this._editCell)\r\n            }\r\n            this._editCell = null ;\r\n            if (!l) {\r\n                this.callEvent(\"onEdit\", [3, m, this, h])\r\n            }\r\n            if (this._enblkbrd) {\r\n                this.parentObject.lastChild.focus();\r\n                this.parentObject.lastChild.focus()\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._stopEditItem = function(c, a) {\r\n    this._stopEdit(c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.stopEdit = function(a) {\r\n    if (this._editCell) {\r\n        this._stopEdit(this._editCell.id + \"_non\", a)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.editItem = function(a) {\r\n    this._editItem(a, this)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._editItem = function(h, a) {\r\n    if (this._eItEd) {\r\n        this._stopEdit();\r\n        var e = this._globalIdStorageFind(h);\r\n        if (!e) {\r\n            return\r\n        }\r\n        var g = this.callEvent(\"onEdit\", [0, h, this, e.span.innerHTML]);\r\n        if (g === true) {\r\n            g = (typeof e.span.innerText != \"undefined\" ? e.span.innerText : e.span.textContent)\r\n        } else {\r\n            if (g === false) {\r\n                return\r\n            }\r\n        }\r\n        this.dADTempOffEd = this.dADTempOff;\r\n        this.dADTempOff = false;\r\n        this._editCell = e;\r\n        e._oldValue = g;\r\n        e.span.innerHTML = \"<input type='text' class='intreeeditRow' />\";\r\n        e.span.style.paddingRight = e.span.style.paddingLeft = \"0px\";\r\n        e.span.onclick = e.span.ondblclick = function(l) {\r\n            (l || event).cancelBubble = true\r\n        }\r\n        ;\r\n        e.span.childNodes[0].value = g;\r\n        e.span.childNodes[0].onselectstart = function(l) {\r\n            (l || event).cancelBubble = true;\r\n            return true\r\n        }\r\n        ;\r\n        e.span.childNodes[0].onmousedown = function(l) {\r\n            (l || event).cancelBubble = true;\r\n            return true\r\n        }\r\n        ;\r\n        e.span.childNodes[0].focus();\r\n        e.span.childNodes[0].focus();\r\n        e.span.onclick = function(l) {\r\n            (l || event).cancelBubble = true;\r\n            return false\r\n        }\r\n        ;\r\n        e.span.className = \"\";\r\n        e.span.parentNode.className = \"\";\r\n        var c = this;\r\n        e.span.childNodes[0].onkeydown = function(l) {\r\n            if (!l) {\r\n                l = window.event\r\n            }\r\n            if (l.keyCode == 13) {\r\n                l.cancelBubble = true;\r\n                c._stopEdit(window.undefined)\r\n            } else {\r\n                if (l.keyCode == 27) {\r\n                    c._stopEdit(window.undefined, true)\r\n                }\r\n            }\r\n            (l || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.callEvent(\"onEdit\", [1, h, this])\r\n    }\r\n}\r\n;\r\nfunction jsonPointer(c, a) {\r\n    this.d = c;\r\n    this.dp = a\r\n}\r\njsonPointer.prototype = {\r\n    text: function() {\r\n        var a = function(h) {\r\n            var g = [];\r\n            for (var e = 0; e < h.length; e++) {\r\n                g.push(\"{\" + c(h[e]) + \"}\")\r\n            }\r\n            return g.join(\",\")\r\n        }\r\n        ;\r\n        var c = function(h) {\r\n            var g = [];\r\n            for (var e in h) {\r\n                if (typeof (h[e]) == \"object\") {\r\n                    if (e.length) {\r\n                        g.push('\"' + e + '\":[' + a(h[e]) + \"]\")\r\n                    } else {\r\n                        g.push('\"' + e + '\":{' + c(h[e]) + \"}\")\r\n                    }\r\n                } else {\r\n                    g.push('\"' + e + '\":\"' + h[e] + '\"')\r\n                }\r\n            }\r\n            return g.join(\",\")\r\n        }\r\n        ;\r\n        return \"{\" + c(this.d) + \"}\"\r\n    },\r\n    get: function(a) {\r\n        return this.d[a]\r\n    },\r\n    exists: function() {\r\n        return !!this.d\r\n    },\r\n    content: function() {\r\n        return this.d.content\r\n    },\r\n    each: function(g, m, l) {\r\n        var e = this.d[g];\r\n        var n = new jsonPointer();\r\n        if (e) {\r\n            for (var h = 0; h < e.length; h++) {\r\n                n.d = e[h];\r\n                m.apply(l, [n, h])\r\n            }\r\n        }\r\n    },\r\n    get_all: function() {\r\n        return this.d\r\n    },\r\n    sub: function(a) {\r\n        return new jsonPointer(this.d[a],this.d)\r\n    },\r\n    sub_exists: function(a) {\r\n        return !!this.d[a]\r\n    },\r\n    each_x: function(g, n, m, l, h) {\r\n        var e = this.d[g];\r\n        var o = new jsonPointer(0,this.d);\r\n        if (e) {\r\n            for (h = h || 0; h < e.length; h++) {\r\n                if (e[h][n]) {\r\n                    o.d = e[h];\r\n                    if (m.apply(l, [o, h]) == -1) {\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    up: function(a) {\r\n        return new jsonPointer(this.dp,this.d)\r\n    },\r\n    set: function(a, c) {\r\n        this.d[a] = c\r\n    },\r\n    clone: function(a) {\r\n        return new jsonPointer(this.d,this.dp)\r\n    },\r\n    through: function(e, m, r, h, s) {\r\n        var n = this.d[e];\r\n        if (n.length) {\r\n            for (var g = 0; g < n.length; g++) {\r\n                if (n[g][m] != null  && n[g][m] != \"\" && (!r || n[g][m] == r)) {\r\n                    var l = new jsonPointer(n[g],this.d);\r\n                    h.apply(s, [l, g])\r\n                }\r\n                var o = this.d;\r\n                this.d = n[g];\r\n                if (this.sub_exists(e)) {\r\n                    this.through(e, m, r, h, s)\r\n                }\r\n                this.d = o\r\n            }\r\n        }\r\n    }\r\n};\r\ndhtmlXTreeObject.prototype.loadJSArrayFile = function(a, c) {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadJSArrayFile was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this._loadJSArrayFile(a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadJSArrayFile = function(file, callback) {\r\n    if (!this.parsCount) {\r\n        this.callEvent(\"onXLS\", [this, this._ld_id])\r\n    }\r\n    this._ld_id = null ;\r\n    this.xmlstate = 1;\r\n    var that = this;\r\n    this.XMLLoader = function(xml, callback) {\r\n        eval(\"var z=\" + xml.responseText);\r\n        this._loadJSArray(z);\r\n        if (callback) {\r\n            callback.call(this, xml)\r\n        }\r\n    }\r\n    ;\r\n    dhx4.ajax.get(file, function(obj) {\r\n        that.XMLLoader(obj.xmlDoc, callback)\r\n    })\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadCSV = function(a, c) {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadCSV was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this._loadCSV(a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadCSV = function(a, e) {\r\n    if (!this.parsCount) {\r\n        this.callEvent(\"onXLS\", [this, this._ld_id])\r\n    }\r\n    this._ld_id = null ;\r\n    this.xmlstate = 1;\r\n    var c = this;\r\n    this.XMLLoader = function(g, h) {\r\n        this._loadCSVString(g.responseText);\r\n        if (h) {\r\n            h.call(this, g)\r\n        }\r\n    }\r\n    ;\r\n    dhx4.ajax.get(a, function(g) {\r\n        c.XMLLoader(g.xmlDoc, e)\r\n    })\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadJSArray = function(a, c) {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadJSArray was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this._loadJSArray(a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadJSArray = function(a, g) {\r\n    var l = [];\r\n    for (var c = 0; c < a.length; c++) {\r\n        if (!l[a[c][1]]) {\r\n            l[a[c][1]] = []\r\n        }\r\n        l[a[c][1]].push({\r\n            id: a[c][0],\r\n            text: a[c][2]\r\n        })\r\n    }\r\n    var h = {\r\n        id: this.rootId\r\n    };\r\n    var e = function(o, n) {\r\n        if (l[o.id]) {\r\n            o.item = l[o.id];\r\n            for (var m = 0; m < o.item.length; m++) {\r\n                n(o.item[m], n)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    e(h, e);\r\n    this._loadJSONObject(h, g)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadCSVString = function(a, c) {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadCSVString was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this._loadCSVString(a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadCSVString = function(a, l) {\r\n    var n = [];\r\n    var c = a.split(\"\\n\");\r\n    for (var g = 0; g < c.length; g++) {\r\n        var e = c[g].split(\",\");\r\n        if (!n[e[1]]) {\r\n            n[e[1]] = []\r\n        }\r\n        n[e[1]].push({\r\n            id: e[0],\r\n            text: e[2]\r\n        })\r\n    }\r\n    var m = {\r\n        id: this.rootId\r\n    };\r\n    var h = function(s, r) {\r\n        if (n[s.id]) {\r\n            s.item = n[s.id];\r\n            for (var o = 0; o < s.item.length; o++) {\r\n                r(s.item[o], r)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    h(m, h);\r\n    this._loadJSONObject(m, l)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadJSONObject = function(a, c) {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadJSONObject was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this._loadJSONObject(a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadJSONObject = function(a, c) {\r\n    if (!this.parsCount) {\r\n        this.callEvent(\"onXLS\", [this, null ])\r\n    }\r\n    this.xmlstate = 1;\r\n    var e = new jsonPointer(a);\r\n    this._parse(e);\r\n    this._p = e;\r\n    if (c) {\r\n        c()\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadJSON = function(a, c) {\r\n    if (window.console && window.console.info) {\r\n        window.console.info(\"loadJSON was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n    }\r\n    return this._loadJSON(a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadJSON = function(file, callback) {\r\n    if (!this.parsCount) {\r\n        this.callEvent(\"onXLS\", [this, this._ld_id])\r\n    }\r\n    this._ld_id = null ;\r\n    this.xmlstate = 1;\r\n    var that = this;\r\n    this.XMLLoader = function(xml, callback) {\r\n        try {\r\n            eval(\"var t=\" + xml.responseText)\r\n        } catch (e) {\r\n            dhx4.callEvent(\"onLoadXMLerror\", [\"Incorrect JSON\", (xml), this]);\r\n            return\r\n        }\r\n        var p = new jsonPointer(t);\r\n        this._parse(p);\r\n        this._p = p;\r\n        if (callback) {\r\n            callback.call(this, xml)\r\n        }\r\n    }\r\n    ;\r\n    dhx4.ajax.get(file, function(obj) {\r\n        that.XMLLoader(obj.xmlDoc, callback)\r\n    })\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.serializeTreeToJSON = function() {\r\n    var a = ['{\"id\":\"' + this.rootId + '\", \"item\":['];\r\n    var e = [];\r\n    for (var c = 0; c < this.htmlNode.childsCount; c++) {\r\n        e.push(this._serializeItemJSON(this.htmlNode.childNodes[c]))\r\n    }\r\n    a.push(e.join(\",\"));\r\n    a.push(\"]}\");\r\n    return a.join(\"\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._serializeItemJSON = function(m) {\r\n    var a = [];\r\n    if (m.unParsed) {\r\n        return ( m.unParsed.text()) \r\n    }\r\n    if (this._selected.length) {\r\n        var e = this._selected[0].id\r\n    } else {\r\n        e = \"\"\r\n    }\r\n    var l = m.span.innerHTML;\r\n    l = l.replace(/\\\"/g, '\\\\\"', l);\r\n    if (!this._xfullXML) {\r\n        a.push('{ \"id\":\"' + m.id + '\", ' + (this._getOpenState(m) == 1 ? ' \"open\":\"1\", ' : \"\") + (e == m.id ? ' \"select\":\"1\",' : \"\") + ' \"text\":\"' + l + '\"' + (((this.XMLsource) && (m.XMLload == 0)) ? ', \"child\":\"1\" ' : \"\"))\r\n    } else {\r\n        a.push('{ \"id\":\"' + m.id + '\", ' + (this._getOpenState(m) == 1 ? ' \"open\":\"1\", ' : \"\") + (e == m.id ? ' \"select\":\"1\",' : \"\") + ' \"text\":\"' + l + '\", \"im0\":\"' + m.images[0] + '\", \"im1\":\"' + m.images[1] + '\", \"im2\":\"' + m.images[2] + '\" ' + (m.acolor ? (', \"aCol\":\"' + m.acolor + '\" ') : \"\") + (m.scolor ? (', \"sCol\":\"' + m.scolor + '\" ') : \"\") + (m.checkstate == 1 ? ', \"checked\":\"1\" ' : (m.checkstate == 2 ? ', \"checked\":\"-1\"' : \"\")) + (m.closeable ? ', \"closeable\":\"1\" ' : \"\") + (((this.XMLsource) && (m.XMLload == 0)) ? ', \"child\":\"1\" ' : \"\"))\r\n    }\r\n    if ((this._xuserData) && (m._userdatalist)) {\r\n        a.push(', \"userdata\":[');\r\n        var h = m._userdatalist.split(\",\");\r\n        var g = [];\r\n        for (var c = 0; c < h.length; c++) {\r\n            g.push('{ \"name\":\"' + h[c] + '\" , \"content\":\"' + m.userData[\"t_\" + h[c]] + '\" }')\r\n        }\r\n        a.push(g.join(\",\"));\r\n        a.push(\"]\")\r\n    }\r\n    if (m.childsCount) {\r\n        a.push(', \"item\":[');\r\n        var g = [];\r\n        for (var c = 0; c < m.childsCount; c++) {\r\n            g.push(this._serializeItemJSON(m.childNodes[c]))\r\n        }\r\n        a.push(g.join(\",\"));\r\n        a.push(\"]\\n\")\r\n    }\r\n    a.push(\"}\\n\");\r\n    return a.join(\"\")\r\n}\r\n;\r\nfunction dhtmlXTreeFromHTML(obj) {\r\n    if (typeof (obj) != \"object\") {\r\n        obj = document.getElementById(obj)\r\n    }\r\n    var n = obj;\r\n    var id = n.id;\r\n    var cont = \"\";\r\n    for (var j = 0; j < obj.childNodes.length; j++) {\r\n        if (obj.childNodes[j].nodeType == \"1\") {\r\n            if (obj.childNodes[j].tagName == \"XMP\") {\r\n                var cHead = obj.childNodes[j];\r\n                for (var m = 0; m < cHead.childNodes.length; m++) {\r\n                    cont += cHead.childNodes[m].data\r\n                }\r\n            } else {\r\n                if (obj.childNodes[j].tagName.toLowerCase() == \"ul\") {\r\n                    cont = dhx_li2trees(obj.childNodes[j], new Array(), 0)\r\n                }\r\n            }\r\n            break\r\n        }\r\n    }\r\n    obj.innerHTML = \"\";\r\n    var t = new dhtmlXTreeObject(obj,\"100%\",\"100%\",0);\r\n    var z_all = new Array();\r\n    for (b in t) {\r\n        z_all[b.toLowerCase()] = b\r\n    }\r\n    var atr = obj.attributes;\r\n    for (var a = 0; a < atr.length; a++) {\r\n        if ((atr[a].name.indexOf(\"set\") == 0) || (atr[a].name.indexOf(\"enable\") == 0)) {\r\n            var an = atr[a].name;\r\n            if (!t[an]) {\r\n                an = z_all[atr[a].name]\r\n            }\r\n            t[an].apply(t, atr[a].value.split(\",\"))\r\n        }\r\n    }\r\n    if (typeof (cont) == \"object\") {\r\n        t.XMLloadingWarning = 1;\r\n        for (var i = 0; i < cont.length; i++) {\r\n            var n = t.insertNewItem(cont[i][0], cont[i][3], cont[i][1]);\r\n            if (cont[i][2]) {\r\n                t._setCheck(n, cont[i][2])\r\n            }\r\n        }\r\n        t.XMLloadingWarning = 0;\r\n        t.lastLoadedXMLId = 0;\r\n        t._redrawFrom(t)\r\n    } else {\r\n        t.parse(\"<tree id='0'>\" + cont + \"</tree>\")\r\n    }\r\n    window[id] = t;\r\n    var oninit = obj.getAttribute(\"oninit\");\r\n    if (oninit) {\r\n        eval(oninit)\r\n    }\r\n    return t\r\n}\r\nfunction dhx_init_trees() {\r\n    var c = document.getElementsByTagName(\"div\");\r\n    for (var a = 0; a < c.length; a++) {\r\n        if (c[a].className == \"dhtmlxTree\") {\r\n            dhtmlXTreeFromHTML(c[a])\r\n        }\r\n    }\r\n}\r\nfunction dhx_li2trees(s, l, e) {\r\n    for (var m = 0; m < s.childNodes.length; m++) {\r\n        var r = s.childNodes[m];\r\n        if ((r.nodeType == 1) && (r.tagName.toLowerCase() == \"li\")) {\r\n            var o = \"\";\r\n            var n = null ;\r\n            var a = r.getAttribute(\"checked\");\r\n            for (var h = 0; h < r.childNodes.length; h++) {\r\n                var g = r.childNodes[h];\r\n                if (g.nodeType == 3) {\r\n                    o += g.data\r\n                } else {\r\n                    if (g.tagName.toLowerCase() != \"ul\") {\r\n                        o += dhx_outer_html(g)\r\n                    } else {\r\n                        n = g\r\n                    }\r\n                }\r\n            }\r\n            l[l.length] = [e, o, a, (r.id || (l.length + 1))];\r\n            if (n) {\r\n                l = dhx_li2trees(n, l, (r.id || l.length))\r\n            }\r\n        }\r\n    }\r\n    return l\r\n}\r\nfunction dhx_outer_html(c) {\r\n    if (c.outerHTML) {\r\n        return c.outerHTML\r\n    }\r\n    var a = document.createElement(\"DIV\");\r\n    a.appendChild(c.cloneNode(true));\r\n    a = a.innerHTML;\r\n    return a\r\n}\r\nif (window.addEventListener) {\r\n    window.addEventListener(\"load\", dhx_init_trees, false)\r\n} else {\r\n    if (window.attachEvent) {\r\n        window.attachEvent(\"onload\", dhx_init_trees)\r\n    }\r\n}\r\ndhtmlXTreeObject.prototype.parserExtension = {\r\n    _parseExtension: function(g, c, e) {\r\n        this._idpull[c.id]._attrs = c\r\n    }\r\n};\r\ndhtmlXTreeObject.prototype.getAttribute = function(e, a) {\r\n    this._globalIdStorageFind(e);\r\n    var c = this._idpull[e]._attrs;\r\n    return c ? c[a] : window.undefined\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setAttribute = function(g, a, e) {\r\n    this._globalIdStorageFind(g);\r\n    var c = (this._idpull[g]._attrs) || {};\r\n    c[a] = e;\r\n    this._idpull[g]._attrs = c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableKeyboardNavigation = function(e) {\r\n    this._enblkbrd = dhx4.s2b(e);\r\n    if (this._enblkbrd) {\r\n        if (_isFF) {\r\n            var c = window.getComputedStyle(this.parentObject, null )[\"position\"];\r\n            if ((c != \"absolute\") && (c != \"relative\")) {\r\n                this.parentObject.style.position = \"relative\"\r\n            }\r\n        }\r\n        this._navKeys = [[\"up\", 38], [\"down\", 40], [\"open\", 39], [\"close\", 37], [\"call\", 13], [\"edit\", 113]];\r\n        var a = this;\r\n        var c = document.createElement(\"INPUT\");\r\n        c.className = \"a_dhx_hidden_input\";\r\n        c.autocomplete = \"off\";\r\n        if (window._KHTMLrv) {\r\n            c.style.color = \"white\"\r\n        }\r\n        this.parentObject.appendChild(c);\r\n        this.parentObject[_isOpera ? \"onkeypress\" : \"onkeydown\"] = function(g) {\r\n            if (a.callEvent(\"onKeyPress\", [(g || window.event).keyCode, (g || window.event)])) {\r\n                return a._onKeyDown(g || window.event)\r\n            }\r\n        }\r\n        ;\r\n        this.parentObject.onclick = function(g) {\r\n            if (_isFF || _isIE) {\r\n                c.select()\r\n            }\r\n            if (window._KHTMLrv || _isOpera) {\r\n                c.focus()\r\n            }\r\n        }\r\n    } else {\r\n        this.parentObject.onkeydown = null \r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onKeyDown = function(g) {\r\n    if (window.globalActiveDHTMLGridObject && globalActiveDHTMLGridObject.isActive) {\r\n        return true\r\n    }\r\n    var a = this;\r\n    for (var c = 0; c < this._navKeys.length; c++) {\r\n        if (this._navKeys[c][1] == g.keyCode) {\r\n            this[\"_onkey_\" + this._navKeys[c][0]].apply(this, [this.getSelectedItemId()]);\r\n            if (g.preventDefault) {\r\n                g.preventDefault()\r\n            }\r\n            (g || event).cancelBubble = true;\r\n            return false\r\n        }\r\n    }\r\n    if (this._textSearch) {\r\n        return this._searchItemByKey(g)\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onkey_up = function(e) {\r\n    var a = this._globalIdStorageFind(e);\r\n    if (!a) {\r\n        return\r\n    }\r\n    var c = this._getPrevVisibleNode(a);\r\n    if (c.id == this.rootId) {\r\n        return\r\n    }\r\n    this.focusItem(c.id);\r\n    this.selectItem(c.id, false)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onkey_down = function(e) {\r\n    var a = this._globalIdStorageFind(e);\r\n    if (!a) {\r\n        return\r\n    }\r\n    var c = this._getNextVisibleNode(a);\r\n    if (c.id == this.rootId) {\r\n        return\r\n    }\r\n    this.focusItem(c.id);\r\n    this.selectItem(c.id, false)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onkey_open = function(a) {\r\n    this.openItem(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onkey_close = function(a) {\r\n    this.closeItem(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onkey_call = function(a) {\r\n    if (this.stopEdit) {\r\n        this.stopEdit();\r\n        this.parentObject.lastChild.focus();\r\n        this.parentObject.lastChild.focus();\r\n        this.selectItem(a, true)\r\n    } else {\r\n        this.selectItem(this.getSelectedItemId(), true)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._onkey_edit = function(a) {\r\n    if (this.editItem) {\r\n        this.editItem(a)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getNextVisibleNode = function(a, c) {\r\n    if ((!c) && (this._getOpenState(a) > 0)) {\r\n        return a.childNodes[0]\r\n    }\r\n    if ((a.tr) && (a.tr.nextSibling) && (a.tr.nextSibling.nodem)) {\r\n        return a.tr.nextSibling.nodem\r\n    }\r\n    if (a.parentObject) {\r\n        return this._getNextVisibleNode(a.parentObject, 1)\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._getPrevVisibleNode = function(a) {\r\n    if ((a.tr) && (a.tr.previousSibling) && (a.tr.previousSibling.nodem)) {\r\n        return this._lastVisibleChild(a.tr.previousSibling.nodem)\r\n    }\r\n    if (a.parentObject) {\r\n        return a.parentObject\r\n    } else {\r\n        return a\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._lastVisibleChild = function(a) {\r\n    if (this._getOpenState(a) > 0) {\r\n        return this._lastVisibleChild(a.childNodes[a.childsCount - 1])\r\n    } else {\r\n        return a\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._searchItemByKey = function(c) {\r\n    if (c.keyCode == 8) {\r\n        this._textSearchString = \"\";\r\n        return true\r\n    }\r\n    var a = String.fromCharCode(c.keyCode).toUpperCase();\r\n    if (a.match(/[A-Z,a-z,0-9\\ ]/)) {\r\n        this._textSearchString += a;\r\n        this._textSearchInProgress = true;\r\n        if (!(this.getSelectedItemText() || \"\").match(RegExp(\"^\" + this._textSearchString, \"i\"))) {\r\n            this.findItem(this._textSearchString, 0)\r\n        }\r\n        this._textSearchInProgress = false;\r\n        if (c.preventDefault) {\r\n            c.preventDefault()\r\n        }\r\n        (c || event).cancelBubble = true;\r\n        return false\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.assignKeys = function(a) {\r\n    this._navKeys = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableKeySearch = function(c) {\r\n    this._textSearch = dhx4.s2b(c);\r\n    if (!this._textSearch) {\r\n        return\r\n    }\r\n    this._textSearchString = \"\";\r\n    var a = this;\r\n    this._markItem2 = this._markItem;\r\n    this._markItem = function(e) {\r\n        if (!a._textSearchInProgress) {\r\n            a._textSearchString = \"\"\r\n        }\r\n        a._markItem2(e)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableLoadingItem = function(a) {\r\n    this.attachEvent(\"onXLS\", this._showFakeItem);\r\n    this.attachEvent(\"onXLE\", this._hideFakeItem);\r\n    this._tfi_text = a || \"Loading...\"\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._showFakeItem = function(a, e) {\r\n    if ((e === null ) || (this._globalIdStorageFind(\"fake_load_xml_\" + e))) {\r\n        return\r\n    }\r\n    var c = this.XMLsource;\r\n    this.XMLsource = null ;\r\n    this.insertNewItem(e, \"fake_load_xml_\" + e, this._tfi_text);\r\n    this.XMLsource = c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._hideFakeItem = function(a, c) {\r\n    if (c === null ) {\r\n        return\r\n    }\r\n    this.deleteItem(\"fake_load_xml_\" + c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.isLocked = function(a) {\r\n    if (!this._locker) {\r\n        this._init_lock()\r\n    }\r\n    return ( this._locker[a] == true) \r\n}\r\n;\r\ndhtmlXTreeObject.prototype._lockItem = function(a, h, c) {\r\n    if (!this._locker) {\r\n        this._init_lock()\r\n    }\r\n    if (h) {\r\n        if (this._locker[a.id] == true) {\r\n            return\r\n        }\r\n        this._locker[a.id] = true;\r\n        a.bIm0 = a.images[0];\r\n        a.bIm1 = a.images[1];\r\n        a.bIm2 = a.images[2];\r\n        a.images[0] = this.lico0;\r\n        a.images[1] = this.lico1;\r\n        a.images[2] = this.lico2;\r\n        var g = a.span.parentNode;\r\n        var e = g.previousSibling;\r\n        this.dragger.removeDraggableItem(g);\r\n        this.dragger.removeDraggableItem(e)\r\n    } else {\r\n        if (this._locker[a.id] != true) {\r\n            return\r\n        }\r\n        this._locker[a.id] = false;\r\n        a.images[0] = a.bIm0;\r\n        a.images[1] = a.bIm1;\r\n        a.images[2] = a.bIm2;\r\n        var g = a.span.parentNode;\r\n        var e = g.previousSibling;\r\n        this.dragger.addDraggableItem(g, this);\r\n        this.dragger.addDraggableItem(e, this)\r\n    }\r\n    if (!c) {\r\n        this._correctPlus(a)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.lockItem = function(e, c) {\r\n    if (!this._locker) {\r\n        this._init_lock()\r\n    }\r\n    this._lockOn = false;\r\n    var a = this._globalIdStorageFind(e);\r\n    this._lockOn = true;\r\n    this._lockItem(a, dhx4.s2b(c))\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setLockedIcons = function(e, c, a) {\r\n    if (!this._locker) {\r\n        this._init_lock()\r\n    }\r\n    this.lico0 = e;\r\n    this.lico1 = c;\r\n    this.lico2 = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._init_lock = function() {\r\n    this._locker = new Array();\r\n    this._locker_count = \"0\";\r\n    this._lockOn = true;\r\n    this._globalIdStorageFindA = this._globalIdStorageFind;\r\n    this._globalIdStorageFind = this._lockIdFind;\r\n    if (this._serializeItem) {\r\n        this._serializeItemA = this._serializeItem;\r\n        this._serializeItem = this._serializeLockItem;\r\n        this._serializeTreeA = this.serializeTree;\r\n        this.serializeTree = this._serializeLockTree\r\n    }\r\n    this.setLockedIcons(this.imageArray[0], this.imageArray[1], this.imageArray[2])\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._lockIdFind = function(e, a, c) {\r\n    if (!this.skipLock) {\r\n        if ((!c) && (this._lockOn == true) && (this._locker[e] == true)) {\r\n            return null \r\n        }\r\n    }\r\n    return this._globalIdStorageFindA(e, a, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._serializeLockItem = function(a) {\r\n    if (this._locker[a.id] == true) {\r\n        return \"\"\r\n    }\r\n    return this._serializeItemA(a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._serializeLockTree = function() {\r\n    var a = this._serializeTreeA();\r\n    return a.replace(/<item[^>]+locked\\=\\\"1\\\"[^>]+\\/>/g, \"\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._moveNodeToA = dhtmlXTreeObject.prototype._moveNodeTo;\r\ndhtmlXTreeObject.prototype._moveNodeTo = function(a, e, c) {\r\n    if ((e.treeNod.isLocked) && (e.treeNod.isLocked(e.id))) {\r\n        return false\r\n    }\r\n    return this._moveNodeToA(a, e, c)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.lockTree = function(a) {\r\n    if (dhx4.s2b(a)) {\r\n        this._initTreeLocker()\r\n    } else {\r\n        if (this._TreeLocker) {\r\n            this._TreeLocker.parentNode.removeChild(this._TreeLocker);\r\n            this._TreeLocker = null \r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._initTreeLocker = function(a) {\r\n    if (this._TreeLocker) {\r\n        return\r\n    }\r\n    this.parentObject.style.overflow = \"hidden\";\r\n    if (this.parentObject.style.position != \"absolute\") {\r\n        this.parentObject.style.position = \"relative\"\r\n    }\r\n    var c = document.createElement(\"div\");\r\n    c.style.position = \"absolute\";\r\n    c.style.left = \"0px\";\r\n    c.style.top = \"0px\";\r\n    c.className = \"dhx_tree_opacity\";\r\n    c.style.width = this.allTree.offsetWidth + \"px\";\r\n    c.style.backgroundColor = \"#FFFFFF\";\r\n    c.style.height = this.allTree.offsetHeight + \"px\";\r\n    this._TreeLocker = c;\r\n    this.parentObject.appendChild(this._TreeLocker)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableRTL = function(c) {\r\n    var a = dhx4.s2b(c);\r\n    if (((a) && (!this.rtlMode)) || ((!a) && (this.rtlMode))) {\r\n        this.rtlMode = a;\r\n        this._switchToRTL(this.rtlMode)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._switchToRTL = function(a) {\r\n    if (a) {\r\n        this.allTree.className = this._ltr_line = this.lineArray;\r\n        this._ltr_min = this.minusArray;\r\n        this._ltr_plus = this.plusArray;\r\n        this.lineArray = new Array(\"line2_rtl.gif\",\"line3_rtl.gif\",\"line4_rtl.gif\",\"blank.gif\",\"blank.gif\",\"line1_rtl.gif\");\r\n        this.minusArray = new Array(\"minus2_rtl.gif\",\"minus3_rtl.gif\",\"minus4_rtl.gif\",\"minus.gif\",\"minus5_rtl.gif\");\r\n        this.plusArray = new Array(\"plus2_rtl.gif\",\"plus3_rtl.gif\",\"plus4_rtl.gif\",\"plus.gif\",\"plus5_rtl.gif\");\r\n        this.allTree.className = \"containerTableStyleRTL\"\r\n    } else {\r\n        this.allTree.className = \"containerTableStyle\";\r\n        this.lineArray = this._ltr_line;\r\n        this.minusArray = this._ltr_min;\r\n        this.plusArray = this._ltr_plus\r\n    }\r\n    if (this.htmlNode.childsCount) {\r\n        this._redrawFrom(this, this.htmlNode)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.sortTree = function(g, c, e) {\r\n    var a = this._globalIdStorageFind(g);\r\n    if (!a) {\r\n        return false\r\n    }\r\n    this._reorderBranch(a, (c.toString().toLowerCase() == \"asc\"), dhx4.s2b(e))\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setCustomSortFunction = function(a) {\r\n    this._csfunca = a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._reorderBranch = function(n, c, o) {\r\n    var a = [];\r\n    var l = n.childsCount;\r\n    if (!l) {\r\n        return\r\n    }\r\n    var h = n.childNodes[0].tr.parentNode;\r\n    for (var g = 0; g < l; g++) {\r\n        a[g] = n.childNodes[g];\r\n        h.removeChild(a[g].tr)\r\n    }\r\n    var e = this;\r\n    if (c == 1) {\r\n        if (this._csfunca) {\r\n            a.sort(function(r, m) {\r\n                return e._csfunca(r.id, m.id)\r\n            })\r\n        } else {\r\n            a.sort(function(r, m) {\r\n                return ( (r.span.innerHTML.toUpperCase() > m.span.innerHTML.toUpperCase()) ? 1 : ((r.span.innerHTML.toUpperCase() == m.span.innerHTML.toUpperCase()) ? 0 : -1)) \r\n            })\r\n        }\r\n    } else {\r\n        if (this._csfunca) {\r\n            a.sort(function(r, m) {\r\n                return e._csfunca(m.id, r.id)\r\n            })\r\n        } else {\r\n            a.sort(function(r, m) {\r\n                return ( (r.span.innerHTML.toUpperCase() < m.span.innerHTML.toUpperCase()) ? 1 : ((r.span.innerHTML.toUpperCase() == m.span.innerHTML.toUpperCase()) ? 0 : -1)) \r\n            })\r\n        }\r\n    }\r\n    for (var g = 0; g < l; g++) {\r\n        h.appendChild(a[g].tr);\r\n        n.childNodes[g] = a[g];\r\n        if ((o) && (a[g].unParsed)) {\r\n            a[g].unParsed.set(\"order\", c ? 1 : -1)\r\n        } else {\r\n            if ((o) && (a[g].childsCount)) {\r\n                this._reorderBranch(a[g], c, o)\r\n            }\r\n        }\r\n    }\r\n    for (var g = 0; g < l; g++) {\r\n        this._correctPlus(a[g]);\r\n        this._correctLine(a[g])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._reorderXMLBranch = function(l) {\r\n    var n = l.getAttribute(\"order\");\r\n    if (n == \"none\") {\r\n        return\r\n    }\r\n    var c = (n == 1);\r\n    var h = l.childNodes.length;\r\n    if (!h) {\r\n        return\r\n    }\r\n    var a = new Array();\r\n    var e = 0;\r\n    for (var g = 0; g < h; g++) {\r\n        if (l.childNodes[g].nodeType == 1) {\r\n            a[e] = l.childNodes[g];\r\n            e++\r\n        }\r\n    }\r\n    for (var g = h - 1; g != 0; g--) {\r\n        l.removeChild(l.childNodes[g])\r\n    }\r\n    if (c) {\r\n        a.sort(function(o, m) {\r\n            return ( (o.getAttribute(\"text\") > m.getAttribute(\"text\")) ? 1 : ((o.getAttribute(\"text\") == m.getAttribute(\"text\")) ? 0 : -1)) \r\n        })\r\n    } else {\r\n        a.sort(function(o, m) {\r\n            return ( (o.getAttribute(\"text\") < m.getAttribute(\"text\")) ? 1 : ((o.getAttribute(\"text\") == m.getAttribute(\"text\")) ? 0 : -1)) \r\n        })\r\n    }\r\n    for (var g = 0; g < e; g++) {\r\n        a[g].setAttribute(\"order\", n);\r\n        l.appendChild(a[g])\r\n    }\r\n    l.setAttribute(\"order\", \"none\")\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._serEnts = [[\"&\", \"&amp;\"], [\"<\", \"&lt;\"], [\">\", \"&gt;\"]];\r\ndhtmlXTreeObject.prototype.registerXMLEntity = function(a, c) {\r\n    this._serEnts[this._serEnts.length] = [a, c, new RegExp(a,\"g\")]\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setSerializationLevel = function(a, c, h, l, e) {\r\n    this._xuserData = dhx4.s2b(a);\r\n    this._xfullXML = dhx4.s2b(c);\r\n    this._dtd = e;\r\n    this._xescapeEntities = dhx4.s2b(h);\r\n    if (dhx4.s2b(l)) {\r\n        this._apreUC = \"<![CDATA[\";\r\n        this._apstUC = \"]]>\"\r\n    } else {}\r\n    for (var g = 0; g < this._serEnts.length; g++) {\r\n        this._serEnts[g][2] = new RegExp(this._serEnts[g][0],\"g\")\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.serializeTree = function() {\r\n    if (this.stopEdit) {\r\n        this.stopEdit()\r\n    }\r\n    this._apreUC = this._apreUC || \"\";\r\n    this._apstUC = this._apstUC || \"\";\r\n    var a = '<?xml version=\"1.0\"?>';\r\n    if (this._dtd) {\r\n        a += '<!DOCTYPE tree SYSTEM \"' + this._dtd + '\">'\r\n    }\r\n    a += '<tree id=\"' + this.rootId + '\">';\r\n    if ((this._xuserData) && (this._idpull[this.rootId]._userdatalist)) {\r\n        var e = this._idpull[this.rootId]._userdatalist.split(\",\");\r\n        for (var c = 0; c < e.length; c++) {\r\n            a += '<userdata name=\"' + e[c] + '\">' + this._apreUC + this._idpull[this.rootId].userData[\"t_\" + e[c]] + this._apstUC + \"</userdata>\"\r\n        }\r\n    }\r\n    for (var c = 0; c < this.htmlNode.childsCount; c++) {\r\n        a += this._serializeItem(this.htmlNode.childNodes[c])\r\n    }\r\n    a += \"</tree>\";\r\n    return a\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._serializeItem = function(m) {\r\n    if (m.unParsed) {\r\n        if (document.all) {\r\n            return m.unParsed.d.xml\r\n        } else {\r\n            var a = new XMLSerializer();\r\n            return a.serializeToString(m.unParsed.d)\r\n        }\r\n    }\r\n    var c = \"\";\r\n    if (this._selected.length) {\r\n        var g = this._selected[0].id\r\n    } else {\r\n        g = '\"'\r\n    }\r\n    var l = m.span.innerHTML;\r\n    if (this._xescapeEntities) {\r\n        for (var e = 0; e < this._serEnts.length; e++) {\r\n            l = l.replace(this._serEnts[e][2], this._serEnts[e][1])\r\n        }\r\n    }\r\n    if (!this._xfullXML) {\r\n        c = '<item id=\"' + m.id + '\" ' + (this._getOpenState(m) == 1 ? ' open=\"1\" ' : \"\") + (g == m.id ? ' select=\"1\"' : \"\") + ' text=\"' + l + '\"' + (((this.XMLsource) && (m.XMLload == 0)) ? ' child=\"1\" ' : \"\") + \">\"\r\n    } else {\r\n        c = '<item id=\"' + m.id + '\" ' + (this._getOpenState(m) == 1 ? ' open=\"1\" ' : \"\") + (g == m.id ? ' select=\"1\"' : \"\") + ' text=\"' + l + '\" im0=\"' + m.images[0] + '\" im1=\"' + m.images[1] + '\" im2=\"' + m.images[2] + '\" ' + (m.acolor ? ('aCol=\"' + m.acolor + '\" ') : \"\") + (m.scolor ? ('sCol=\"' + m.scolor + '\" ') : \"\") + (m.checkstate == 1 ? 'checked=\"1\" ' : (m.checkstate == 2 ? 'checked=\"-1\"' : \"\")) + (m.closeable ? 'closeable=\"1\" ' : \"\") + (((this.XMLsource) && (m.XMLload == 0)) ? ' child=\"1\" ' : \"\") + \">\"\r\n    }\r\n    if ((this._xuserData) && (m._userdatalist)) {\r\n        var h = m._userdatalist.split(\",\");\r\n        for (var e = 0; e < h.length; e++) {\r\n            c += '<userdata name=\"' + h[e] + '\">' + this._apreUC + m.userData[\"t_\" + h[e]] + this._apstUC + \"</userdata>\"\r\n        }\r\n    }\r\n    for (var e = 0; e < m.childsCount; e++) {\r\n        c += this._serializeItem(m.childNodes[e])\r\n    }\r\n    c += \"</item>\";\r\n    return c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.saveSelectedItem = function(c, a) {\r\n    c = c || \"\";\r\n    this.setCookie(\"treeStateSelected\" + c, this.getSelectedItemId(), a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.restoreSelectedItem = function(a) {\r\n    a = a || \"\";\r\n    var c = this.getCookie(\"treeStateSelected\" + a);\r\n    this.selectItem(c, false)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.enableAutoSavingSelected = function(a, c) {\r\n    this.assMode = dhx4.s2b(a);\r\n    if ((this.assMode) && (!this.oldOnSelect)) {\r\n        this.oldOnSelect = this.onRowSelect;\r\n        this.onRowSelect = function(h, g, l) {\r\n            if (!g) {\r\n                g = this\r\n            }\r\n            g.parentObject.treeNod.oldOnSelect(h, g, l);\r\n            if (g.parentObject.treeNod.assMode) {\r\n                g.parentObject.treeNod.saveSelectedItem(g.parentObject.treeNod.assCookieName)\r\n            }\r\n        }\r\n    }\r\n    this.assCookieName = c\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.saveState = function(e, c) {\r\n    var h = this._escape(this.serializeTree());\r\n    var a = 4000;\r\n    if (h.length > a) {\r\n        if (navigator.appName.indexOf(\"Microsoft\") != -1) {\r\n            return false\r\n        }\r\n        this.setCookie(\"treeStatex\" + e, Math.ceil(h.length / a));\r\n        for (var g = 0; g < Math.ceil(h.length / a); g++) {\r\n            this.setCookie(\"treeStatex\" + e + \"x\" + g, h.substr(g * a, a), c)\r\n        }\r\n    } else {\r\n        this.setCookie(\"treeStatex\" + e, h, c)\r\n    }\r\n    var h = this.getCookie(\"treeStatex\" + e);\r\n    if (!h) {\r\n        this.setCookie(\"treeStatex\" + e, \"\", c);\r\n        return false\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadState = function(a) {\r\n    var g = this.getCookie(\"treeStatex\" + a);\r\n    if (!g) {\r\n        return false\r\n    }\r\n    if (g.length) {\r\n        if (g.toString().length < 4) {\r\n            var e = \"\";\r\n            for (var c = 0; c < g; c++) {\r\n                e += this.getCookie(\"treeStatex\" + a + \"x\" + c)\r\n            }\r\n            g = e\r\n        }\r\n        this.parse((this.utfesc == \"utf8\") ? decodeURI(g) : unescape(g))\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.setCookie = function(c, e, a) {\r\n    var g = c + \"=\" + e + (a ? (\"; \" + a) : \"\");\r\n    document.cookie = g\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.getCookie = function(c) {\r\n    var e = c + \"=\";\r\n    if (document.cookie.length > 0) {\r\n        var g = document.cookie.indexOf(e);\r\n        if (g != -1) {\r\n            g += e.length;\r\n            var a = document.cookie.indexOf(\";\", g);\r\n            if (a == -1) {\r\n                a = document.cookie.length\r\n            }\r\n            return document.cookie.substring(g, a)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.saveOpenStates = function(c, a) {\r\n    var g = [];\r\n    for (var e = 0; e < this.htmlNode.childsCount; e++) {\r\n        g = g.concat(this._collectOpenStates(this.htmlNode.childNodes[e]))\r\n    }\r\n    g = g.join(this.dlmtr);\r\n    this.setCookie(\"treeOpenStatex\" + c, g, a)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.loadOpenStates = function(c) {\r\n    for (var e = 0; e < this.htmlNode.childsCount; e++) {\r\n        this._xcloseAll(this.htmlNode.childNodes[e])\r\n    }\r\n    this.allTree.childNodes[0].border = \"1\";\r\n    this.allTree.childNodes[0].border = \"0\";\r\n    var h = getCookie(\"treeOpenStatex\" + c);\r\n    if (h) {\r\n        var a = h.split(this.dlmtr);\r\n        for (var e = 0; e < a.length; e++) {\r\n            var g = this._globalIdStorageFind(a[e]);\r\n            if (g) {\r\n                if ((this.XMLsource) && (!g.XMLload) && (g.id != this.rootId)) {\r\n                    this._delayedLoad(g, \"loadOpenStates('\" + c + \"')\");\r\n                    return\r\n                } else {\r\n                    this.openItem(a[e])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    this.callEvent(\"onAllOpenDynamic\", [])\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._delayedLoad = function(c, a) {\r\n    this.afterLoadMethod = a;\r\n    this.onLoadReserve = this.onXLE;\r\n    this.onXLE = this._delayedLoadStep2;\r\n    this._loadDynXML(c.id)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._delayedLoadStep2 = function(tree) {\r\n    tree.onXLE = tree.onLoadReserve;\r\n    window.setTimeout(function() {\r\n        dhtmlx.temp = tree;\r\n        eval(\"dhtmlx.temp.\" + tree.afterLoadMethod)\r\n    }, 100);\r\n    if (tree.onXLE) {\r\n        tree.onXLE(tree)\r\n    }\r\n    tree.callEvent(\"onXLE\", [tree])\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._collectOpenStates = function(c) {\r\n    var e = [];\r\n    if (this._getOpenState(c) == 1) {\r\n        e.push(c.id);\r\n        for (var a = 0; a < c.childsCount; a++) {\r\n            e = e.concat(this._collectOpenStates(c.childNodes[a]))\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\nfunction setCookie(a, c) {\r\n    document.cookie = a + \"=\" + c\r\n}\r\nfunction getCookie(c) {\r\n    var e = c + \"=\";\r\n    if (document.cookie.length > 0) {\r\n        var g = document.cookie.indexOf(e);\r\n        if (g != -1) {\r\n            g += e.length;\r\n            var a = document.cookie.indexOf(\";\", g);\r\n            if (a == -1) {\r\n                a = document.cookie.length\r\n            }\r\n            return ( document.cookie.substring(g, a)) \r\n        }\r\n    }\r\n}\r\ndhtmlXTreeObject.prototype.openAllItemsDynamic = function(a) {\r\n    this.ClosedElem = new Array();\r\n    this.G_node = null ;\r\n    var c = this._globalIdStorageFind(a || this.rootId);\r\n    if (c.id != this.rootId && this.getOpenState(c.id) != 0) {\r\n        this.openItem(a)\r\n    }\r\n    this._openAllNodeChilds(c, 0);\r\n    if (this.ClosedElem.length > 0) {\r\n        this.onLoadReserve = this.onXLE;\r\n        this.onXLE = this._loadAndOpen;\r\n        this._loadAndOpen(this)\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._openAllNodeChilds = function(c) {\r\n    if ((c.XMLload == 0) || (c.unParsed)) {\r\n        this.ClosedElem.push(c)\r\n    }\r\n    for (var a = 0; a < c.childsCount; a++) {\r\n        if (this._getOpenState(c.childNodes[a]) < 0) {\r\n            this._HideShow(c.childNodes[a], 2)\r\n        }\r\n        if (c.childNodes[a].childsCount > 0) {\r\n            this._openAllNodeChilds(c.childNodes[a])\r\n        }\r\n        if ((c.childNodes[a].XMLload == 0) || (c.childNodes[a].unParsed)) {\r\n            this.ClosedElem.push(c.childNodes[a])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._loadAndOpen = function(a) {\r\n    if (a.G_node) {\r\n        a._openItem(a.G_node);\r\n        a._openAllNodeChilds(a.G_node);\r\n        a.G_node = null \r\n    }\r\n    if (a.ClosedElem.length > 0) {\r\n        a.G_node = a.ClosedElem.shift()\r\n    }\r\n    if (a.G_node) {\r\n        if (a.G_node.unParsed) {\r\n            a.reParse(a.G_node)\r\n        } else {\r\n            window.setTimeout(function() {\r\n                a._loadDynXML(a.G_node.id)\r\n            }, 100)\r\n        }\r\n    } else {\r\n        a.onXLE = a.onLoadReserve;\r\n        if (a.onXLE) {\r\n            a.onXLE(a)\r\n        }\r\n        a.callEvent(\"onAllOpenDynamic\", [a])\r\n    }\r\n}\r\n;\r\ndhtmlXTreeObject.prototype.openItemsDynamic = function(c, a) {\r\n    if (this.onXLE == this._stepOpen) {\r\n        return\r\n    }\r\n    this._opnItmsDnmcFlg = dhx4.s2b(a);\r\n    this.onLoadReserve = this.onXLE;\r\n    this.onXLE = this._stepOpen;\r\n    this.ClosedElem = c.split(\",\").reverse();\r\n    this._stepOpen(this)\r\n}\r\n;\r\ndhtmlXTreeObject.prototype._stepOpen = function(c) {\r\n    if (!c.ClosedElem.length) {\r\n        c.onXLE = c.onLoadReserve;\r\n        if (c._opnItmsDnmcFlg) {\r\n            c.selectItem(c.G_node, true)\r\n        }\r\n        if ((c.onXLE) && (arguments[1])) {\r\n            c.onXLE.apply(c, arguments)\r\n        }\r\n        c.callEvent(\"onOpenDynamicEnd\", []);\r\n        return\r\n    }\r\n    c.G_node = c.ClosedElem.pop();\r\n    c.skipLock = true;\r\n    var a = c._globalIdStorageFind(c.G_node);\r\n    if (a) {\r\n        if (a.XMLload === 0) {\r\n            c.openItem(c.G_node)\r\n        } else {\r\n            c.openItem(c.G_node);\r\n            c._stepOpen(c)\r\n        }\r\n    }\r\n    c.skipLock = false\r\n}\r\n;\r\nvar globalActiveDHTMLGridObject;\r\nString.prototype._dhx_trim = function() {\r\n    return this.replace(/&nbsp;/g, \" \").replace(/(^[ \\t]*)|([ \\t]*$)/g, \"\")\r\n}\r\n;\r\nfunction dhtmlxArray(a) {\r\n    return dhtmlx.extend((a || new Array()), dhtmlxArray._master)\r\n}\r\ndhtmlxArray._master = {\r\n    _dhx_find: function(c) {\r\n        for (var a = 0; a < this.length; a++) {\r\n            if (c == this[a]) {\r\n                return a\r\n            }\r\n        }\r\n        return -1\r\n    },\r\n    _dhx_insertAt: function(e, c) {\r\n        this[this.length] = null ;\r\n        for (var a = this.length - 1; a >= e; a--) {\r\n            this[a] = this[a - 1]\r\n        }\r\n        this[e] = c\r\n    },\r\n    _dhx_removeAt: function(a) {\r\n        this.splice(a, 1)\r\n    },\r\n    _dhx_swapItems: function(a, e) {\r\n        var c = this[a];\r\n        this[a] = this[e];\r\n        this[e] = c\r\n    }\r\n};\r\nfunction dhtmlXGridObject(id) {\r\n    if (dhtmlxEvent.initTouch) {\r\n        dhtmlxEvent.initTouch()\r\n    }\r\n    if (_isIE) {\r\n        try {\r\n            document.execCommand(\"BackgroundImageCache\", false, true)\r\n        } catch (e) {}\r\n    }\r\n    if (id) {\r\n        if (typeof (id) == \"object\") {\r\n            this.entBox = id;\r\n            if (!this.entBox.id) {\r\n                this.entBox.id = \"cgrid2_\" + this.uid()\r\n            }\r\n        } else {\r\n            this.entBox = document.getElementById(id)\r\n        }\r\n    } else {\r\n        this.entBox = document.createElement(\"DIV\");\r\n        this.entBox.id = \"cgrid2_\" + this.uid()\r\n    }\r\n    this.entBox.innerHTML = \"\";\r\n    dhx4._eventable(this);\r\n    var self = this;\r\n    this._wcorr = 0;\r\n    this.fontWidth = 7;\r\n    this.cell = null ;\r\n    this.row = null ;\r\n    this.iconURL = \"\";\r\n    this.editor = null ;\r\n    this._f2kE = true;\r\n    this._dclE = true;\r\n    this.combos = new Array(0);\r\n    this.defVal = new Array(0);\r\n    this.rowsAr = {};\r\n    this.rowsBuffer = dhtmlxArray();\r\n    this.rowsCol = dhtmlxArray();\r\n    this._data_cache = {};\r\n    this._ecache = {};\r\n    this._ud_enabled = true;\r\n    this.xmlLoader = this.doLoadDetails;\r\n    this._maskArr = [];\r\n    this.selectedRows = dhtmlxArray();\r\n    this.UserData = {};\r\n    this._sizeFix = this._borderFix = 0;\r\n    this.entBox.className += \" gridbox\";\r\n    this.entBox.style.width = this.entBox.getAttribute(\"width\") || (window.getComputedStyle ? (this.entBox.style.width || window.getComputedStyle(this.entBox, null )[\"width\"]) : (this.entBox.currentStyle ? this.entBox.currentStyle.width : this.entBox.style.width || 0)) || \"100%\";\r\n    this.entBox.style.height = this.entBox.getAttribute(\"height\") || (window.getComputedStyle ? (this.entBox.style.height || window.getComputedStyle(this.entBox, null )[\"height\"]) : (this.entBox.currentStyle ? this.entBox.currentStyle.height : this.entBox.style.height || 0)) || \"100%\";\r\n    this.entBox.style.cursor = \"default\";\r\n    this.entBox.onselectstart = function() {\r\n        return false\r\n    }\r\n    ;\r\n    var t_creator = function(name) {\r\n        var t = document.createElement(\"TABLE\");\r\n        t.cellSpacing = t.cellPadding = 0;\r\n        t.style.cssText = \"width:100%;table-layout:fixed;\";\r\n        t.className = name.substr(2);\r\n        return t\r\n    }\r\n    ;\r\n    this.obj = t_creator(\"c_obj\");\r\n    this.hdr = t_creator(\"c_hdr\");\r\n    this.hdr.style.marginRight = \"20px\";\r\n    this.hdr.style.paddingRight = \"20px\";\r\n    this.objBox = document.createElement(\"DIV\");\r\n    this.objBox.style.width = \"100%\";\r\n    this.objBox.style.overflow = \"auto\";\r\n    this.objBox.appendChild(this.obj);\r\n    this.objBox.className = \"objbox\";\r\n    if (dhtmlx.$customScroll) {\r\n        dhtmlx.CustomScroll.enable(this)\r\n    }\r\n    this.hdrBox = document.createElement(\"DIV\");\r\n    this.hdrBox.style.width = \"100%\";\r\n    this.hdrBox.style.height = \"25px\";\r\n    this.hdrBox.style.overflow = \"hidden\";\r\n    this.hdrBox.className = \"xhdr\";\r\n    this.preloadImagesAr = new Array(0);\r\n    this.sortImg = document.createElement(\"DIV\");\r\n    this.sortImg.style.display = \"none\";\r\n    this.hdrBox.appendChild(this.sortImg);\r\n    this.hdrBox.appendChild(this.hdr);\r\n    this.hdrBox.style.position = \"relative\";\r\n    this.entBox.appendChild(this.hdrBox);\r\n    this.entBox.appendChild(this.objBox);\r\n    this.entBox.grid = this;\r\n    this.objBox.grid = this;\r\n    this.hdrBox.grid = this;\r\n    this.obj.grid = this;\r\n    this.hdr.grid = this;\r\n    this.cellWidthPX = [];\r\n    this.cellWidthPC = [];\r\n    this.cellWidthType = this.entBox.cellwidthtype || \"px\";\r\n    this.delim = this.entBox.delimiter || \",\";\r\n    this._csvDelim = \",\";\r\n    this.hdrLabels = [];\r\n    this.columnIds = [];\r\n    this.columnColor = [];\r\n    this._hrrar = [];\r\n    this.cellType = dhtmlxArray();\r\n    this.cellAlign = [];\r\n    this.initCellWidth = [];\r\n    this.fldSort = [];\r\n    this._srdh = (_isIE && (document.compatMode != \"BackCompat\") ? 22 : 20);\r\n    this.imgURL = window.dhx_globalImgPath || \"\";\r\n    this.isActive = false;\r\n    this.isEditable = true;\r\n    this.useImagesInHeader = false;\r\n    this.pagingOn = false;\r\n    this.rowsBufferOutSize = 0;\r\n    dhtmlxEvent(window, \"unload\", function() {\r\n        try {\r\n            if (self.destructor) {\r\n                self.destructor()\r\n            }\r\n        } catch (e) {}\r\n    });\r\n    this.setSkin = function(name) {\r\n        this._srdh = window.dhx4.readFromCss(\"dhxgrid_rh_\" + name) + 4;\r\n        this.skin_name = name;\r\n        if (this._imgURL) {\r\n            this.setImagePath(this._imgURL)\r\n        }\r\n        var classname = this.entBox.className.split(\" gridbox\")[0];\r\n        this.entBox.className = classname + \" gridbox gridbox_\" + name + (_isIE ? \" isIE\" : \" isModern\");\r\n        this.skin_h_correction = 0;\r\n        this.enableAlterCss(\"ev_\" + name, \"odd_\" + name, this.isTreeGrid());\r\n        this._fixAlterCss();\r\n        switch (name) {\r\n        case \"dhx_terrace\":\r\n            this._srdh = 33;\r\n            this.forceDivInHeader = true;\r\n            break;\r\n        case \"dhx_web\":\r\n            this.forceDivInHeader = true;\r\n            this._srdh = 31;\r\n            break;\r\n        case \"dhx_skyblue\":\r\n            this.forceDivInHeader = true;\r\n            break\r\n        }\r\n        if (_isIE && this.hdr) {\r\n            var d = this.hdr.parentNode;\r\n            d.removeChild(this.hdr);\r\n            d.appendChild(this.hdr)\r\n        }\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    if (_isIE) {\r\n        this.preventIECaching(true)\r\n    }\r\n    if (window.dhtmlDragAndDropObject) {\r\n        this.dragger = new dhtmlDragAndDropObject()\r\n    }\r\n    this._doOnScroll = function(e, mode) {\r\n        this.callEvent(\"onScroll\", [this.objBox.scrollLeft, this.objBox.scrollTop]);\r\n        this.doOnScroll(e, mode)\r\n    }\r\n    ;\r\n    this.doOnScroll = function(e, mode) {\r\n        this.hdrBox.scrollLeft = this.objBox.scrollLeft;\r\n        if (this.ftr) {\r\n            this.ftr.parentNode.scrollLeft = this.objBox.scrollLeft\r\n        }\r\n        if (mode) {\r\n            return\r\n        }\r\n        if (this._srnd) {\r\n            if (this._dLoadTimer) {\r\n                window.clearTimeout(this._dLoadTimer)\r\n            }\r\n            this._dLoadTimer = window.setTimeout(function() {\r\n                if (self._update_srnd_view) {\r\n                    self._update_srnd_view()\r\n                }\r\n            }, 100)\r\n        }\r\n    }\r\n    ;\r\n    this.attachToObject = function(obj) {\r\n        obj.appendChild(this.globalBox ? this.globalBox : this.entBox);\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.init = function(fl) {\r\n        if ((this.isTreeGrid()) && (!this._h2)) {\r\n            this._h2 = this._createHierarchy();\r\n            if ((this._fake) && (!this._realfake)) {\r\n                this._fake._h2 = this._h2\r\n            }\r\n            this._tgc = {\r\n                imgURL: null \r\n            }\r\n        }\r\n        if (!this._hstyles) {\r\n            return\r\n        }\r\n        if (!this.skin_name) {\r\n            this.setSkin(window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxgrid\") || \"dhx_skyblue\")\r\n        }\r\n        this.editStop();\r\n        this.lastClicked = null ;\r\n        this.resized = null ;\r\n        this.fldSorted = this.r_fldSorted = null ;\r\n        this.cellWidthPX = [];\r\n        this.cellWidthPC = [];\r\n        if (this.hdr.rows.length > 0) {\r\n            var temp = this.xmlFileUrl;\r\n            this.clearAll(true);\r\n            this.xmlFileUrl = temp\r\n        }\r\n        var hdrRow = this.hdr.insertRow(0);\r\n        for (var i = 0; i < this.hdrLabels.length; i++) {\r\n            hdrRow.appendChild(document.createElement(\"TH\"));\r\n            hdrRow.childNodes[i]._cellIndex = i;\r\n            hdrRow.childNodes[i].style.height = \"0px\"\r\n        }\r\n        if (_isIE && _isIE < 8 && document.body.style.msTouchAction == this.undefined) {\r\n            hdrRow.style.position = \"absolute\"\r\n        } else {\r\n            hdrRow.style.height = \"auto\"\r\n        }\r\n        var hdrRow = this.hdr.insertRow(_isKHTML ? 2 : 1);\r\n        hdrRow._childIndexes = new Array();\r\n        var col_ex = 0;\r\n        for (var i = 0; i < this.hdrLabels.length; i++) {\r\n            hdrRow._childIndexes[i] = i - col_ex;\r\n            if ((this.hdrLabels[i] == this.splitSign) && (i != 0)) {\r\n                if (_isKHTML) {\r\n                    hdrRow.insertCell(i - col_ex)\r\n                }\r\n                hdrRow.cells[i - col_ex - 1].colSpan = (hdrRow.cells[i - col_ex - 1].colSpan || 1) + 1;\r\n                hdrRow.childNodes[i - col_ex - 1]._cellIndex++;\r\n                col_ex++;\r\n                hdrRow._childIndexes[i] = i - col_ex;\r\n                continue\r\n            }\r\n            hdrRow.insertCell(i - col_ex);\r\n            hdrRow.childNodes[i - col_ex]._cellIndex = i;\r\n            hdrRow.childNodes[i - col_ex]._cellIndexS = i;\r\n            this.setColumnLabel(i, this.hdrLabels[i])\r\n        }\r\n        if (col_ex == 0) {\r\n            hdrRow._childIndexes = null \r\n        }\r\n        this._cCount = this.hdrLabels.length;\r\n        if (_isIE) {\r\n            window.setTimeout(function() {\r\n                if (self.setSizes) {\r\n                    self.setSizes()\r\n                }\r\n            }, 1)\r\n        }\r\n        if (!this.obj.firstChild) {\r\n            this.obj.appendChild(document.createElement(\"TBODY\"))\r\n        }\r\n        var tar = this.obj.firstChild;\r\n        if (!tar.firstChild) {\r\n            tar.appendChild(document.createElement(\"TR\"));\r\n            tar = tar.firstChild;\r\n            if (_isIE && _isIE < 8 && document.body.style.msTouchAction == this.undefined) {\r\n                tar.style.position = \"absolute\"\r\n            } else {\r\n                tar.style.height = \"auto\"\r\n            }\r\n            for (var i = 0; i < this.hdrLabels.length; i++) {\r\n                tar.appendChild(document.createElement(\"TH\"));\r\n                tar.childNodes[i].style.height = \"0px\"\r\n            }\r\n        }\r\n        this._c_order = null ;\r\n        if (this.multiLine != true) {\r\n            this.obj.className += \" row20px\"\r\n        }\r\n        this.sortImg.style.position = \"absolute\";\r\n        this.sortImg.style.display = \"none\";\r\n        this.sortImg.className = \"dhxgrid_sort_desc\";\r\n        this.sortImg.defLeft = 0;\r\n        if (this.noHeader) {\r\n            this.hdrBox.style.display = \"none\"\r\n        } else {\r\n            this.noHeader = false\r\n        }\r\n        if (this._ivizcol) {\r\n            this.setColHidden()\r\n        }\r\n        this.attachHeader();\r\n        this.attachHeader(0, 0, \"_aFoot\");\r\n        this.setSizes();\r\n        if (fl) {\r\n            this.parseXML()\r\n        }\r\n        this.obj.scrollTop = 0;\r\n        if (this.dragAndDropOff) {\r\n            this.dragger.addDragLanding(this.entBox, this)\r\n        }\r\n        if (this._initDrF) {\r\n            this._initD()\r\n        }\r\n        dhx4.callEvent(\"onGridCreated\", [this])\r\n    }\r\n    ;\r\n    this.setColumnSizes = function(gridWidth) {\r\n        var summ = 0;\r\n        var fcols = [];\r\n        var fix = 0;\r\n        for (var i = 0; i < this._cCount; i++) {\r\n            if ((this.initCellWidth[i] == \"*\") && !this._hrrar[i]) {\r\n                this._awdth = false;\r\n                fcols.push(i);\r\n                continue\r\n            }\r\n            if (this.cellWidthType == \"%\") {\r\n                if (typeof this.cellWidthPC[i] == \"undefined\") {\r\n                    this.cellWidthPC[i] = this.initCellWidth[i]\r\n                }\r\n                var cwidth = (gridWidth * this.cellWidthPC[i] / 100) || 0;\r\n                if (fix > 0.5) {\r\n                    cwidth++;\r\n                    fix--\r\n                }\r\n                var rwidth = this.cellWidthPX[i] = Math.floor(cwidth);\r\n                var fix = fix + cwidth - rwidth\r\n            } else {\r\n                if (typeof this.cellWidthPX[i] == \"undefined\") {\r\n                    this.cellWidthPX[i] = this.initCellWidth[i]\r\n                }\r\n            }\r\n            if (!this._hrrar[i]) {\r\n                summ += this.cellWidthPX[i] * 1\r\n            }\r\n        }\r\n        if (fcols.length) {\r\n            var ms = Math.floor((gridWidth - summ) / fcols.length);\r\n            if (ms < 0) {\r\n                ms = 1\r\n            }\r\n            for (var i = 0; i < fcols.length; i++) {\r\n                var next = Math.max((this._drsclmW ? (this._drsclmW[fcols[i]] || 0) : 0), ms);\r\n                this.cellWidthPX[fcols[i]] = next;\r\n                summ += next\r\n            }\r\n            if (gridWidth > summ) {\r\n                var last = fcols[fcols.length - 1];\r\n                this.cellWidthPX[last] = this.cellWidthPX[last] + (gridWidth - summ);\r\n                summ = gridWidth\r\n            }\r\n            this._setAutoResize()\r\n        }\r\n        this.obj.style.width = summ + \"px\";\r\n        this.hdr.style.width = summ + \"px\";\r\n        if (this.ftr) {\r\n            this.ftr.style.width = summ + \"px\"\r\n        }\r\n        this.chngCellWidth();\r\n        return summ\r\n    }\r\n    ;\r\n    this.setSizes = function() {\r\n        if ((!this.hdr.rows[0]) ) {\r\n            return\r\n        }\r\n        var quirks = this.quirks = (_isIE && document.compatMode == \"BackCompat\");\r\n        var outerBorder = (this.entBox.offsetWidth - this.entBox.clientWidth) / 2;\r\n        if (!this.dontSetSizes) {\r\n            if (this.globalBox) {\r\n                if (!this.globalBox.clientWidth) {\r\n                    return\r\n                }\r\n                var ow = this.globalBox.clientWidth;\r\n                var splitOuterBorder = (this.globalBox.offsetWidth - ow) / 2;\r\n                if (this._delta_x && !this._realfake) {\r\n                    this.globalBox.style.width = this._delta_x;\r\n                    var owu = this.globalBox.clientWidth;\r\n                    this.entBox.style.width = Math.max(0, (owu + (quirks ? splitOuterBorder * 2 : 0)) - this._fake.entBox.clientWidth) + \"px\";\r\n                    if (owu != this._lastTimeSplitWidth) {\r\n                        this._fake._correctSplit(this._fake.entBox.clientWidth);\r\n                        this._lastTimeSplitWidth = owu\r\n                    }\r\n                }\r\n                if (this._delta_y && !this._realfake) {\r\n                    this.globalBox.style.height = this._delta_y;\r\n                    this.entBox.style.overflow = this._fake.entBox.style.overflow = \"hidden\";\r\n                    this.entBox.style.height = this._fake.entBox.style.height = this.globalBox.clientHeight + (quirks ? splitOuterBorder * 2 : 0) + \"px\"\r\n                }\r\n            } else {\r\n                if (this._delta_x) {\r\n                    if (this.entBox.parentNode && this.entBox.parentNode.tagName == \"TD\") {\r\n                        this.entBox.style.width = \"1px\";\r\n                        this.entBox.style.width = parseInt(this._delta_x) * this.entBox.parentNode.clientWidth / 100 - outerBorder * 2 + \"px\"\r\n                    } else {\r\n                        this.entBox.style.width = this._delta_x\r\n                    }\r\n                }\r\n                if (this._delta_y) {\r\n                    this.entBox.style.height = this._delta_y\r\n                }\r\n            }\r\n        }\r\n        window.clearTimeout(this._sizeTime);\r\n        if (!this.entBox.offsetWidth && (!this.globalBox || !this.globalBox.offsetWidth)) {\r\n            this._sizeTime = window.setTimeout(function() {\r\n                if (self.setSizes) {\r\n                    self.setSizes()\r\n                }\r\n            }, 250);\r\n            return\r\n        }\r\n        var border_x = ((!this._wthB) && ((this.entBox.cmp || this._delta_x) && (this.skin_name || \"\").indexOf(\"dhx\") == 0 && !quirks) ? 2 : 0);\r\n        var border_y = ((!this._wthB) && ((this.entBox.cmp || this._delta_y) && (this.skin_name || \"\").indexOf(\"dhx\") == 0 && !quirks) ? 2 : 0);\r\n        if (this._sizeFix) {\r\n            border_x -= this._sizeFix;\r\n            border_y -= this._sizeFix\r\n        }\r\n        var isVScroll = this.parentGrid ? false : (this.objBox.scrollHeight > this.objBox.offsetHeight);\r\n        var scrfix = dhtmlx.$customScroll ? 0 : 18;\r\n        var gridWidth = this.entBox.clientWidth - (this.skin_h_correction || 0) * (quirks ? 0 : 1) - border_x;\r\n        var gridWidthActive = this.entBox.clientWidth - (this.skin_h_correction || 0) - border_x;\r\n        var gridHeight = this.entBox.clientHeight - border_y;\r\n        var summ = this.setColumnSizes(gridWidthActive - (isVScroll ? scrfix : 0) - (this._correction_x || 0));\r\n        var isHScroll = this.parentGrid ? false : ((this.objBox.scrollWidth > this.objBox.offsetWidth) || (this.objBox.style.overflowX == \"scroll\"));\r\n        var headerHeight = this.hdr.clientHeight;\r\n        var footerHeight = this.ftr ? this.ftr.clientHeight : 0;\r\n        var newWidth = gridWidth;\r\n        var newHeight = gridHeight - headerHeight - footerHeight;\r\n        if (this._awdth && this._awdth[0] && this._awdth[1] == 99999) {\r\n            isHScroll = 0\r\n        }\r\n        if (this._ahgr) {\r\n            if (this._ahgrMA) {\r\n                newHeight = this.entBox.parentNode.clientHeight - headerHeight - footerHeight\r\n            } else {\r\n                newHeight = this.obj.offsetHeight + (isHScroll ? scrfix : 0) + (this._correction_y || 0)\r\n            }\r\n            if (this._ahgrM) {\r\n                if (this._ahgrF) {\r\n                    newHeight = Math.min(this._ahgrM, newHeight + headerHeight + footerHeight) - headerHeight - footerHeight\r\n                } else {\r\n                    newHeight = Math.min(this._ahgrM, newHeight)\r\n                }\r\n            }\r\n            if (isVScroll && newHeight >= this.obj.scrollHeight + (isHScroll ? scrfix : 0)) {\r\n                isVScroll = false;\r\n                this.setColumnSizes(gridWidthActive - (this._correction_x || 0))\r\n            }\r\n        }\r\n        if ((this._awdth) && (this._awdth[0])) {\r\n            if (this.cellWidthType == \"%\") {\r\n                this.cellWidthType = \"px\"\r\n            }\r\n            if (this._fake) {\r\n                summ += this._fake.entBox.clientWidth\r\n            }\r\n            var newWidth = Math.min(Math.max(summ + (isVScroll ? scrfix : 0), this._awdth[2]), this._awdth[1]) + (this._correction_x || 0);\r\n            this.objBox.style.overflowX = (!isVScroll && this.objBox.scrollWidth <= newWidth) ? \"hidden\" : \"auto\";\r\n            if (this._fake) {\r\n                newWidth -= this._fake.entBox.clientWidth\r\n            }\r\n        }\r\n        newHeight = Math.max(0, newHeight);\r\n        this._ff_size_delta = (this._ff_size_delta == 0.1) ? 0.2 : 0.1;\r\n        if (!_isFF) {\r\n            this._ff_size_delta = 0\r\n        }\r\n        if (!this.dontSetSizes) {\r\n            this.entBox.style.width = Math.max(0, newWidth + (quirks ? 2 : 0) * outerBorder + this._ff_size_delta) + \"px\";\r\n            this.entBox.style.height = newHeight + (quirks ? 2 : 0) * outerBorder + headerHeight + footerHeight + \"px\"\r\n        }\r\n        this.objBox.style.height = newHeight + ((quirks && !isVScroll) ? 2 : 0) * outerBorder + \"px\";\r\n        this.hdrBox.style.height = headerHeight + \"px\";\r\n        if (newHeight != gridHeight) {\r\n            this.doOnScroll(0, !this._srnd)\r\n        }\r\n        var ext = this[\"setSizes_\" + this.skin_name];\r\n        if (ext) {\r\n            ext.call(this)\r\n        }\r\n        this.setSortImgPos();\r\n        if (headerHeight != this.hdr.clientHeight && this._ahgr) {\r\n            this.setSizes()\r\n        }\r\n        this.callEvent(\"onSetSizes\", [])\r\n    }\r\n    ;\r\n    this.chngCellWidth = function() {\r\n        if ((_isOpera) && (this.ftr)) {\r\n            this.ftr.width = this.objBox.scrollWidth + \"px\"\r\n        }\r\n        var l = this._cCount;\r\n        for (var i = 0; i < l; i++) {\r\n            this.hdr.rows[0].cells[i].style.width = this.cellWidthPX[i] + \"px\";\r\n            this.obj.rows[0].childNodes[i].style.width = this.cellWidthPX[i] + \"px\";\r\n            if (this.ftr) {\r\n                this.ftr.rows[0].cells[i].style.width = this.cellWidthPX[i] + \"px\"\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setDelimiter = function(delim) {\r\n        this.delim = delim\r\n    }\r\n    ;\r\n    this.setInitWidthsP = function(wp) {\r\n        this.cellWidthType = \"%\";\r\n        this.initCellWidth = wp.split(this.delim.replace(/px/gi, \"\"));\r\n        if (!arguments[1]) {\r\n            this._setAutoResize()\r\n        }\r\n    }\r\n    ;\r\n    this._setAutoResize = function() {\r\n        if (this._realfake) {\r\n            return\r\n        }\r\n        var el = window;\r\n        var self = this;\r\n        dhtmlxEvent(window, \"resize\", function() {\r\n            window.clearTimeout(self._resize_timer);\r\n            if (self._setAutoResize) {\r\n                self._resize_timer = window.setTimeout(function() {\r\n                    if (self.setSizes) {\r\n                        self.setSizes()\r\n                    }\r\n                    if (self._fake) {\r\n                        self._fake._correctSplit()\r\n                    }\r\n                }, 100)\r\n            }\r\n        })\r\n    }\r\n    ;\r\n    this.setInitWidths = function(wp) {\r\n        this.cellWidthType = \"px\";\r\n        this.initCellWidth = wp.split(this.delim);\r\n        if (_isFF) {\r\n            for (var i = 0; i < this.initCellWidth.length; i++) {\r\n                if (this.initCellWidth[i] != \"*\") {\r\n                    this.initCellWidth[i] = parseInt(this.initCellWidth[i])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.enableMultiline = function(state) {\r\n        this.multiLine = dhx4.s2b(state)\r\n    }\r\n    ;\r\n    this.enableMultiselect = function(state) {\r\n        this.selMultiRows = dhx4.s2b(state)\r\n    }\r\n    ;\r\n    this.setImagePath = function(path) {\r\n        path = path.replace(/imgs\\/dhxgrid_[a-z]*\\/$/, \"imgs/\");\r\n        this._imgURL = path;\r\n        this.imgURL = path + \"dhxgrid_\" + (this.skin_name || \"dhx_skyblue\").replace(\"dhx_\", \"\") + \"/\";\r\n        this.iconTree = this.imgURL + \"tree/\"\r\n    }\r\n    ;\r\n    this.setImagesPath = this.setImagePath;\r\n    this.setIconPath = function(path) {\r\n        this.iconURL = path\r\n    }\r\n    ;\r\n    this.setIconsPath = this.setIconPath;\r\n    this.changeCursorState = function(ev) {\r\n        var el = ev.target || ev.srcElement;\r\n        if (el.tagName != \"TD\") {\r\n            el = this.getFirstParentOfType(el, \"TD\")\r\n        }\r\n        if (!el) {\r\n            return\r\n        }\r\n        if ((el.tagName == \"TD\") && (this._drsclmn) && (!this._drsclmn[el._cellIndex])) {\r\n            return el.style.cursor = \"default\"\r\n        }\r\n        var check = (ev.layerX || 0) + (((!_isIE) && (ev.target.tagName == \"DIV\")) ? el.offsetLeft : 0);\r\n        if ((el.offsetWidth - (ev.offsetX || (parseInt(this.getPosition(el, this.hdrBox)) - check) * -1)) < (_isOpera ? 20 : 10)) {\r\n            el.style.cursor = \"E-resize\"\r\n        } else {\r\n            el.style.cursor = \"default\"\r\n        }\r\n        if (_isOpera) {\r\n            this.hdrBox.scrollLeft = this.objBox.scrollLeft\r\n        }\r\n    }\r\n    ;\r\n    this.startColResize = function(ev) {\r\n        if (this.resized) {\r\n            this.stopColResize()\r\n        }\r\n        this.resized = null ;\r\n        var el = ev.target || ev.srcElement;\r\n        if (el.tagName != \"TD\") {\r\n            el = this.getFirstParentOfType(el, \"TD\")\r\n        }\r\n        var x = ev.clientX;\r\n        var tabW = this.hdr.offsetWidth;\r\n        var startW = parseInt(el.offsetWidth);\r\n        if (el.tagName == \"TD\" && el.style.cursor != \"default\") {\r\n            if ((this._drsclmn) && (!this._drsclmn[el._cellIndex])) {\r\n                return\r\n            }\r\n            self._old_d_mm = document.body.onmousemove;\r\n            self._old_d_mu = document.body.onmouseup;\r\n            document.body.onmousemove = function(e) {\r\n                if (self) {\r\n                    self.doColResize(e || window.event, el, startW, x, tabW)\r\n                }\r\n            }\r\n            ;\r\n            document.body.onmouseup = function() {\r\n                if (self) {\r\n                    self.stopColResize()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.stopColResize = function() {\r\n        document.body.onmousemove = self._old_d_mm || \"\";\r\n        document.body.onmouseup = self._old_d_mu || \"\";\r\n        this.setSizes();\r\n        this.doOnScroll(0, 1);\r\n        this.callEvent(\"onResizeEnd\", [this])\r\n    }\r\n    ;\r\n    this.doColResize = function(ev, el, startW, x, tabW) {\r\n        el.style.cursor = \"E-resize\";\r\n        this.resized = el;\r\n        var fcolW = startW + (ev.clientX - x);\r\n        var wtabW = tabW + (ev.clientX - x);\r\n        if (!(this.callEvent(\"onResize\", [el._cellIndex, fcolW, this]))) {\r\n            return\r\n        }\r\n        if (_isIE) {\r\n            this.objBox.scrollLeft = this.hdrBox.scrollLeft\r\n        }\r\n        var result = false;\r\n        if (el.colSpan > 1) {\r\n            var a_sizes = new Array();\r\n            for (var i = 0; i < el.colSpan; i++) {\r\n                a_sizes[i] = Math.round(fcolW * this.hdr.rows[0].childNodes[el._cellIndexS + i].offsetWidth / el.offsetWidth)\r\n            }\r\n            for (var i = 0; i < el.colSpan; i++) {\r\n                result = this._setColumnSizeR(el._cellIndexS + i * 1, a_sizes[i])\r\n            }\r\n        } else {\r\n            result = this._setColumnSizeR(el._cellIndex, fcolW)\r\n        }\r\n        this.doOnScroll(0, 1);\r\n        this.setSizes();\r\n        if (this._fake && this._awdth) {\r\n            this._fake._correctSplit()\r\n        }\r\n        return result\r\n    }\r\n    ;\r\n    this._setColumnSizeR = function(ind, fcolW) {\r\n        if (fcolW > ((this._drsclmW && !this._notresize) ? (this._drsclmW[ind] || 10) : 10)) {\r\n            this.obj.rows[0].childNodes[ind].style.width = fcolW + \"px\";\r\n            this.hdr.rows[0].childNodes[ind].style.width = fcolW + \"px\";\r\n            if (this.ftr) {\r\n                this.ftr.rows[0].childNodes[ind].style.width = fcolW + \"px\"\r\n            }\r\n            if (this.cellWidthType == \"px\") {\r\n                this.cellWidthPX[ind] = fcolW\r\n            } else {\r\n                var gridWidth = parseInt(this.entBox.offsetWidth);\r\n                if (this.objBox.scrollHeight > this.objBox.offsetHeight) {\r\n                    gridWidth -= 17\r\n                }\r\n                var pcWidth = Math.round(fcolW / gridWidth * 100);\r\n                this.cellWidthPC[ind] = pcWidth\r\n            }\r\n            if (this.sortImg.style.display != \"none\") {\r\n                this.setSortImgPos()\r\n            }\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.setSortImgState = function(state, ind, order, row) {\r\n        order = (order || \"asc\").toLowerCase();\r\n        if (!dhx4.s2b(state)) {\r\n            this.sortImg.style.display = \"none\";\r\n            this.fldSorted = this.r_fldSorted = null ;\r\n            return\r\n        }\r\n        if (order == \"asc\") {\r\n            this.sortImg.className = \"dhxgrid_sort_asc\"\r\n        } else {\r\n            this.sortImg.className = \"dhxgrid_sort_desc\"\r\n        }\r\n        this.sortImg.style.display = \"\";\r\n        this.fldSorted = this.hdr.rows[0].childNodes[ind];\r\n        var r = this.hdr.rows[row || 1];\r\n        if (!r) {\r\n            return\r\n        }\r\n        for (var i = 0; i < r.childNodes.length; i++) {\r\n            if (r.childNodes[i]._cellIndexS == ind) {\r\n                this.r_fldSorted = r.childNodes[i];\r\n                return this.setSortImgPos()\r\n            }\r\n        }\r\n        return this.setSortImgState(state, ind, order, (row || 1) + 1)\r\n    }\r\n    ;\r\n    this.setSortImgPos = function(ind, mode, hRowInd, el) {\r\n        if (this._hrrar && this._hrrar[this.r_fldSorted ? this.r_fldSorted._cellIndex : ind]) {\r\n            return\r\n        }\r\n        if (!el) {\r\n            if (!ind) {\r\n                var el = this.r_fldSorted\r\n            } else {\r\n                var el = this.hdr.rows[hRowInd || 0].cells[ind]\r\n            }\r\n        }\r\n        if (el != null ) {\r\n            var pos = this.getPosition(el, this.hdrBox);\r\n            var wdth = el.offsetWidth;\r\n            this.sortImg.style.left = Number(pos[0] + wdth - 13) + \"px\";\r\n            this.sortImg.defLeft = parseInt(this.sortImg.style.left);\r\n            this.sortImg.style.top = Number(pos[1] + 5) + \"px\";\r\n            if ((!this.useImagesInHeader) && (!mode)) {\r\n                this.sortImg.style.display = \"inline\"\r\n            }\r\n            this.sortImg.style.left = this.sortImg.defLeft + \"px\"\r\n        }\r\n    }\r\n    ;\r\n    this.setActive = function(fl) {\r\n        if (arguments.length == 0) {\r\n            var fl = true\r\n        }\r\n        if (fl == true) {\r\n            if (globalActiveDHTMLGridObject && (globalActiveDHTMLGridObject != this)) {\r\n                globalActiveDHTMLGridObject.editStop();\r\n                globalActiveDHTMLGridObject.callEvent(\"onBlur\", [globalActiveDHTMLGridObject])\r\n            }\r\n            globalActiveDHTMLGridObject = this;\r\n            this.isActive = true\r\n        } else {\r\n            this.isActive = false;\r\n            this.callEvent(\"onBlur\", [this])\r\n        }\r\n    }\r\n    ;\r\n    this._doClick = function(ev) {\r\n        var selMethod = 0;\r\n        var el = this.getFirstParentOfType(_isIE ? ev.srcElement : ev.target, \"TD\");\r\n        if (!el || !el.parentNode || !el.parentNode.idd) {\r\n            return\r\n        }\r\n        var fl = true;\r\n        if (this.markedCells) {\r\n            var markMethod = 0;\r\n            if (ev.shiftKey || ev.metaKey) {\r\n                markMethod = 1\r\n            }\r\n            if (ev.ctrlKey) {\r\n                markMethod = 2\r\n            }\r\n            this.doMark(el, markMethod);\r\n            return true\r\n        }\r\n        if (this.selMultiRows != false) {\r\n            if (ev.shiftKey && this.row != null  && this.selectedRows.length) {\r\n                selMethod = 1\r\n            }\r\n            if (ev.ctrlKey || ev.metaKey) {\r\n                selMethod = 2\r\n            }\r\n        }\r\n        return this.doClick(el, fl, selMethod, false)\r\n    }\r\n    ;\r\n    this._doContClick = function(ev) {\r\n        var el = this.getFirstParentOfType(_isIE ? ev.srcElement : ev.target, \"TD\");\r\n        if ((!el) || (typeof (el.parentNode.idd) == \"undefined\")) {\r\n            this.callEvent(\"onEmptyClick\", [ev]);\r\n            return true\r\n        }\r\n        if (ev.button == 2 || (_isMacOS && ev.ctrlKey)) {\r\n            if (!this.callEvent(\"onRightClick\", [el.parentNode.idd, el._cellIndex, ev])) {\r\n                var z = function(e) {\r\n                    (e || event).cancelBubble = true;\r\n                    return false\r\n                }\r\n                ;\r\n                (ev.srcElement || ev.target).oncontextmenu = z;\r\n                return z(ev)\r\n            }\r\n            if (this._ctmndx) {\r\n                if (!(this.callEvent(\"onBeforeContextMenu\", [el.parentNode.idd, el._cellIndex, this]))) {\r\n                    return true\r\n                }\r\n                if (_isIE) {\r\n                    ev.srcElement.oncontextmenu = function() {\r\n                        event.cancelBubble = true;\r\n                        return false\r\n                    }\r\n                }\r\n                if (this._ctmndx.showContextMenu) {\r\n                    var dEl0 = window.document.documentElement;\r\n                    var dEl1 = window.document.body;\r\n                    var corrector = new Array((dEl0.scrollLeft || dEl1.scrollLeft),(dEl0.scrollTop || dEl1.scrollTop));\r\n                    if (_isIE) {\r\n                        var x = ev.clientX + corrector[0];\r\n                        var y = ev.clientY + corrector[1]\r\n                    } else {\r\n                        var x = ev.pageX;\r\n                        var y = ev.pageY\r\n                    }\r\n                    this._ctmndx.showContextMenu(x - 1, y - 1);\r\n                    this.contextID = this._ctmndx.contextMenuZoneId = el.parentNode.idd + \"_\" + el._cellIndex;\r\n                    this._ctmndx._skip_hide = true\r\n                } else {\r\n                    el.contextMenuId = el.parentNode.idd + \"_\" + el._cellIndex;\r\n                    el.contextMenu = this._ctmndx;\r\n                    el.a = this._ctmndx._contextStart;\r\n                    el.a(el, ev);\r\n                    el.a = null \r\n                }\r\n                ev.cancelBubble = true;\r\n                return false\r\n            }\r\n        } else {\r\n            if (this._ctmndx) {\r\n                if (this._ctmndx.hideContextMenu) {\r\n                    this._ctmndx.hideContextMenu()\r\n                } else {\r\n                    this._ctmndx._contextEnd()\r\n                }\r\n            }\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    this.doClick = function(el, fl, selMethod, show) {\r\n        if (!this.selMultiRows) {\r\n            selMethod = 0\r\n        }\r\n        var psid = this.row ? this.row.idd : 0;\r\n        this.setActive(true);\r\n        if (!selMethod) {\r\n            selMethod = 0\r\n        }\r\n        if (this.cell != null ) {\r\n            this.cell.className = this.cell.className.replace(/cellselected/g, \"\")\r\n        }\r\n        if (el.tagName == \"TD\") {\r\n            if (this.checkEvent(\"onSelectStateChanged\")) {\r\n                var initial = this.getSelectedId()\r\n            }\r\n            var prow = this.row;\r\n            if (selMethod == 1) {\r\n                var elRowIndex = this.rowsCol._dhx_find(el.parentNode);\r\n                var lcRowIndex = this.rowsCol._dhx_find(this.lastClicked);\r\n                if (elRowIndex > lcRowIndex) {\r\n                    var strt = lcRowIndex;\r\n                    var end = elRowIndex\r\n                } else {\r\n                    var strt = elRowIndex;\r\n                    var end = lcRowIndex\r\n                }\r\n                for (var i = 0; i < this.rowsCol.length; i++) {\r\n                    if ((i >= strt && i <= end) ) {\r\n                        if (this.rowsCol[i] && (!this.rowsCol[i]._sRow)) {\r\n                            if (!this.rowsCol[i].idd) {\r\n                                continue\r\n                            }\r\n                            if (this.rowsCol[i].className.indexOf(\"rowselected\") == -1 && (this.callEvent(\"onBeforeSelect\", [this.rowsCol[i].idd, psid, el._cellIndex]))) {\r\n                                this.rowsCol[i].className += \" rowselected\";\r\n                                this.selectedRows[this.selectedRows.length] = this.rowsCol[i]\r\n                            }\r\n                        } else {\r\n                            this.clearSelection();\r\n                            return this.doClick(el, fl, 0, show)\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (selMethod == 2) {\r\n                    if (el.parentNode.className.indexOf(\"rowselected\") != -1) {\r\n                        el.parentNode.className = el.parentNode.className.replace(/rowselected/g, \"\");\r\n                        this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(el.parentNode));\r\n                        var skipRowSelection = true;\r\n                        show = false\r\n                    }\r\n                }\r\n            }\r\n            this.editStop();\r\n            if (typeof (el.parentNode.idd) == \"undefined\") {\r\n                return true\r\n            }\r\n            if ((!skipRowSelection) && (!el.parentNode._sRow)) {\r\n                if (this.callEvent(\"onBeforeSelect\", [el.parentNode.idd, psid, el._cellIndex])) {\r\n                    if (this.getSelectedRowId() != el.parentNode.idd) {\r\n                        if (selMethod == 0) {\r\n                            this.clearSelection()\r\n                        }\r\n                        this.cell = el;\r\n                        if ((prow == el.parentNode) && (this._chRRS)) {\r\n                            fl = false\r\n                        }\r\n                        this.row = el.parentNode;\r\n                        this.row.className += \" rowselected\";\r\n                        if (this.selectedRows._dhx_find(this.row) == -1) {\r\n                            this.selectedRows[this.selectedRows.length] = this.row\r\n                        }\r\n                    } else {\r\n                        this.cell = el;\r\n                        this.row = el.parentNode\r\n                    }\r\n                } else {\r\n                    fl = false\r\n                }\r\n            }\r\n            if (this.cell && this.cell.parentNode.className.indexOf(\"rowselected\") != -1) {\r\n                this.cell.className = this.cell.className.replace(/cellselected/g, \"\") + \" cellselected\"\r\n            }\r\n            if (selMethod != 1) {\r\n                if (!this.row) {\r\n                    return\r\n                }\r\n            }\r\n            this.lastClicked = el.parentNode;\r\n            var rid = this.row.idd;\r\n            var cid = this.cell;\r\n            if (fl && typeof (rid) != \"undefined\" && cid && !skipRowSelection) {\r\n                self.onRowSelectTime = setTimeout(function() {\r\n                    if (self.callEvent) {\r\n                        self.callEvent(\"onRowSelect\", [rid, cid._cellIndex])\r\n                    }\r\n                }, 100)\r\n            } else {\r\n                this.callEvent(\"onRowSelectRSOnly\", [rid])\r\n            }\r\n            if (this.checkEvent(\"onSelectStateChanged\")) {\r\n                var afinal = this.getSelectedId();\r\n                if (initial != afinal) {\r\n                    this.callEvent(\"onSelectStateChanged\", [afinal, initial])\r\n                }\r\n            }\r\n            if (skipRowSelection) {\r\n                return false\r\n            }\r\n        }\r\n        this.isActive = true;\r\n        if (show !== false && this.cell && this.cell.parentNode.idd) {\r\n            this.moveToVisible(this.cell)\r\n        }\r\n    }\r\n    ;\r\n    this.selectAll = function() {\r\n        this.clearSelection();\r\n        var coll = this.rowsBuffer;\r\n        if (this.pagingOn) {\r\n            coll = this.rowsCol\r\n        }\r\n        for (var i = 0; i < coll.length; i++) {\r\n            this.render_row(i).className += \" rowselected\"\r\n        }\r\n        this.selectedRows = dhtmlxArray([].concat(coll));\r\n        if (this.selectedRows.length) {\r\n            this.row = this.selectedRows[0];\r\n            this.cell = this.row.cells[0]\r\n        }\r\n        if ((this._fake) && (!this._realfake)) {\r\n            this._fake.selectAll()\r\n        }\r\n    }\r\n    ;\r\n    this.selectCell = function(r, cInd, fl, preserve, edit, show) {\r\n        if (!fl) {\r\n            fl = false\r\n        }\r\n        if (typeof (r) != \"object\") {\r\n            r = this.render_row(r)\r\n        }\r\n        if (!r || r == -1) {\r\n            return null \r\n        }\r\n        if (r._childIndexes) {\r\n            var c = r.childNodes[r._childIndexes[cInd]]\r\n        } else {\r\n            var c = r.childNodes[cInd]\r\n        }\r\n        if (!c) {\r\n            c = r.childNodes[0]\r\n        }\r\n        if (!this.markedCells) {\r\n            if (preserve) {\r\n                this.doClick(c, fl, 3, show)\r\n            } else {\r\n                this.doClick(c, fl, 0, show)\r\n            }\r\n        } else {\r\n            this.doMark(c, preserve ? 2 : 0)\r\n        }\r\n        if (edit) {\r\n            this.editCell()\r\n        }\r\n    }\r\n    ;\r\n    this.moveToVisible = function(cell_obj, onlyVScroll) {\r\n        if (this.pagingOn) {\r\n            var newPage = Math.floor(this.getRowIndex(cell_obj.parentNode.idd) / this.rowsBufferOutSize) + 1;\r\n            if (newPage != this.currentPage) {\r\n                this.changePage(newPage)\r\n            }\r\n        }\r\n        try {\r\n            if (cell_obj.offsetHeight) {\r\n                var distance = cell_obj.offsetLeft + cell_obj.offsetWidth + 20;\r\n                var scrollLeft = 0;\r\n                if (distance > (this.objBox.offsetWidth + this.objBox.scrollLeft)) {\r\n                    if (cell_obj.offsetLeft > this.objBox.scrollLeft) {\r\n                        scrollLeft = cell_obj.offsetLeft - (this.objBox.offsetWidth - cell_obj.offsetWidth) + 5\r\n                    }\r\n                } else {\r\n                    if (cell_obj.offsetLeft < this.objBox.scrollLeft) {\r\n                        distance -= cell_obj.offsetWidth * 2 / 3;\r\n                        if (distance < this.objBox.scrollLeft) {\r\n                            scrollLeft = cell_obj.offsetLeft - 5\r\n                        }\r\n                    }\r\n                }\r\n                if ((scrollLeft) && (!onlyVScroll)) {\r\n                    this.objBox.scrollLeft = scrollLeft\r\n                }\r\n            }\r\n            if (!cell_obj.offsetHeight) {\r\n                var mask = this._realfake ? this._fake.rowsAr[cell_obj.parentNode.idd] : cell_obj.parentNode;\r\n                distance = this.rowsBuffer._dhx_find(mask) * this._srdh\r\n            } else {\r\n                distance = cell_obj.offsetTop\r\n            }\r\n            var distancemax = distance + cell_obj.offsetHeight + 38;\r\n            if (distancemax > (this.objBox.offsetHeight + this.objBox.scrollTop)) {\r\n                var scrollTop = distance\r\n            } else {\r\n                if (distance < this.objBox.scrollTop) {\r\n                    var scrollTop = distance - 5\r\n                }\r\n            }\r\n            if (scrollTop) {\r\n                this.objBox.scrollTop = scrollTop\r\n            }\r\n        } catch (er) {}\r\n    }\r\n    ;\r\n    this.editCell = function() {\r\n        if (this.editor && this.cell == this.editor.cell) {\r\n            return\r\n        }\r\n        this.editStop();\r\n        if ((this.isEditable != true) || (!this.cell)) {\r\n            return false\r\n        }\r\n        var c = this.cell;\r\n        if (c.parentNode._locked) {\r\n            return false\r\n        }\r\n        this.editor = this.cells4(c);\r\n        if (this.editor != null ) {\r\n            if (this.editor.isDisabled()) {\r\n                this.editor = null ;\r\n                return false\r\n            }\r\n            if (this.callEvent(\"onEditCell\", [0, this.row.idd, this.cell._cellIndex]) != false && this.editor.edit) {\r\n                this._Opera_stop = (new Date).valueOf();\r\n                this.editor.edit();\r\n                c.className += \" editable\";\r\n                this.callEvent(\"onEditCell\", [1, this.row.idd, this.cell._cellIndex])\r\n            } else {\r\n                this.editor = null \r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.editStop = function(mode) {\r\n        if (_isOpera) {\r\n            if (this._Opera_stop) {\r\n                if ((this._Opera_stop * 1 + 50) > (new Date).valueOf()) {\r\n                    return\r\n                }\r\n                this._Opera_stop = null \r\n            }\r\n        }\r\n        if (this.editor && this.editor != null ) {\r\n            this.editor.cell.className = this.editor.cell.className.replace(\"editable\", \"\");\r\n            if (mode) {\r\n                var t = this.editor.val;\r\n                this.editor.detach();\r\n                this.editor.setValue(t);\r\n                this.editor = null ;\r\n                this.callEvent(\"onEditCancel\", [this.row.idd, this.cell._cellIndex, t]);\r\n                return\r\n            }\r\n            if (this.editor.detach()) {\r\n                this.cell.wasChanged = true\r\n            }\r\n            var g = this.editor;\r\n            if (g == null ) {\r\n                return\r\n            }\r\n            this.editor = null ;\r\n            var z = this.callEvent(\"onEditCell\", [2, this.row.idd, this.cell._cellIndex, g.getValue(), g.val]);\r\n            if ((typeof (z) == \"string\") || (typeof (z) == \"number\")) {\r\n                g[g.setImage ? \"setLabel\" : \"setValue\"](z)\r\n            } else {\r\n                if (!z) {\r\n                    g[g.setImage ? \"setLabel\" : \"setValue\"](g.val)\r\n                }\r\n            }\r\n            if (this._ahgr && this.multiLine) {\r\n                this.setSizes()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._nextRowCell = function(row, dir, pos) {\r\n        row = this._nextRow((this._groups ? this.rowsCol : this.rowsBuffer)._dhx_find(row), dir);\r\n        if (!row) {\r\n            return null \r\n        }\r\n        return row.childNodes[row._childIndexes ? row._childIndexes[pos] : pos]\r\n    }\r\n    ;\r\n    this._getNextCell = function(acell, dir, i) {\r\n        acell = acell || this.cell;\r\n        var arow = acell.parentNode;\r\n        if (this._tabOrder) {\r\n            i = this._tabOrder[acell._cellIndex];\r\n            if (typeof i != \"undefined\") {\r\n                if (i < 0) {\r\n                    acell = this._nextRowCell(arow, dir, Math.abs(i) - 1)\r\n                } else {\r\n                    acell = arow.childNodes[i]\r\n                }\r\n            }\r\n        } else {\r\n            var i = acell._cellIndex + dir;\r\n            if (i >= 0 && i < this._cCount) {\r\n                if (arow._childIndexes) {\r\n                    i = arow._childIndexes[acell._cellIndex] + dir\r\n                }\r\n                acell = arow.childNodes[i]\r\n            } else {\r\n                acell = this._nextRowCell(arow, dir, (dir == 1 ? 0 : (this._cCount - 1)))\r\n            }\r\n        }\r\n        if (!acell) {\r\n            if ((dir == 1) && this.tabEnd) {\r\n                this.tabEnd.focus();\r\n                this.tabEnd.focus();\r\n                this.setActive(false)\r\n            }\r\n            if ((dir == -1) && this.tabStart) {\r\n                this.tabStart.focus();\r\n                this.tabStart.focus();\r\n                this.setActive(false)\r\n            }\r\n            return null \r\n        }\r\n        if (acell.style.display != \"none\" && (!this.smartTabOrder || !this.cells(acell.parentNode.idd, acell._cellIndex).isDisabled())) {\r\n            return acell\r\n        }\r\n        return this._getNextCell(acell, dir)\r\n    }\r\n    ;\r\n    this._nextRow = function(ind, dir) {\r\n        var r = this.render_row(ind + dir);\r\n        if (!r || r == -1) {\r\n            return null \r\n        }\r\n        if (r && r.style.display == \"none\") {\r\n            return this._nextRow(ind + dir, dir)\r\n        }\r\n        return r\r\n    }\r\n    ;\r\n    this.scrollPage = function(dir) {\r\n        if (!this.rowsBuffer.length) {\r\n            return\r\n        }\r\n        var master = this._realfake ? this._fake : this;\r\n        var new_ind = Math.floor((master._r_select || this.getRowIndex(this.row.idd) || 0) + (dir) * this.objBox.offsetHeight / (this._srdh || 20));\r\n        if (new_ind < 0) {\r\n            new_ind = 0\r\n        }\r\n        if (new_ind >= this.rowsBuffer.length) {\r\n            new_ind = this.rowsBuffer.length - 1\r\n        }\r\n        if (this._srnd && !this.rowsBuffer[new_ind]) {\r\n            this.objBox.scrollTop += Math.floor((dir) * this.objBox.offsetHeight / (this._srdh || 20)) * (this._srdh || 20);\r\n            if (this._fake) {\r\n                this._fake.objBox.scrollTop = this.objBox.scrollTop\r\n            }\r\n            master._r_select = new_ind\r\n        } else {\r\n            this.selectCell(new_ind, this.cell._cellIndex, true, false, false, (this.multiLine || this._srnd));\r\n            if (!this.multiLine && !this._srnd && !this._realfake) {\r\n                this.objBox.scrollTop = this.getRowById(this.getRowId(new_ind)).offsetTop;\r\n                if (this._fake) {\r\n                    this._fake.objBox.scrollTop = this.objBox.scrollTop\r\n                }\r\n            }\r\n            master._r_select = null \r\n        }\r\n    }\r\n    ;\r\n    this.doKey = function(ev) {\r\n        if (!ev) {\r\n            return true\r\n        }\r\n        if ((ev.target || ev.srcElement).value !== window.undefined) {\r\n            var zx = (ev.target || ev.srcElement);\r\n            if (zx.className != \"dhxcombo_input\" && ((!zx.parentNode) || (zx.parentNode.className.indexOf(\"editable\") == -1))) {\r\n                return true\r\n            }\r\n        }\r\n        if ((globalActiveDHTMLGridObject) && (this != globalActiveDHTMLGridObject)) {\r\n            return globalActiveDHTMLGridObject.doKey(ev)\r\n        }\r\n        if (this.isActive == false) {\r\n            return true\r\n        }\r\n        if (this._htkebl) {\r\n            return true\r\n        }\r\n        if (!this.callEvent(\"onKeyPress\", [ev.keyCode, ev.ctrlKey, ev.shiftKey, ev])) {\r\n            return false\r\n        }\r\n        var code = \"k\" + ev.keyCode + \"_\" + (ev.ctrlKey ? 1 : 0) + \"_\" + (ev.shiftKey ? 1 : 0);\r\n        if (this.cell) {\r\n            if (this._key_events[code]) {\r\n                if (false === this._key_events[code].call(this)) {\r\n                    return true\r\n                }\r\n                if (ev.preventDefault) {\r\n                    ev.preventDefault()\r\n                }\r\n                ev.cancelBubble = true;\r\n                return false\r\n            }\r\n            if (this._key_events.k_other) {\r\n                this._key_events.k_other.call(this, ev)\r\n            }\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    this.selectRow = function(r, fl, preserve, show) {\r\n        if (typeof (r) != \"object\") {\r\n            r = this.render_row(r)\r\n        }\r\n        this.selectCell(r, 0, fl, preserve, false, show)\r\n    }\r\n    ;\r\n    this.wasDblClicked = function(ev) {\r\n        var el = this.getFirstParentOfType(_isIE ? ev.srcElement : ev.target, \"TD\");\r\n        if (el) {\r\n            var rowId = el.parentNode.idd;\r\n            return this.callEvent(\"onRowDblClicked\", [rowId, el._cellIndex, ev])\r\n        }\r\n    }\r\n    ;\r\n    this._onHeaderClick = function(e, el) {\r\n        var that = this.grid;\r\n        el = el || that.getFirstParentOfType(_isIE ? event.srcElement : e.target, \"TD\");\r\n        if (this.grid.resized == null ) {\r\n            if (!(this.grid.callEvent(\"onHeaderClick\", [el._cellIndexS, (e || window.event)]))) {\r\n                return false\r\n            }\r\n            that.sortField(el._cellIndexS, false, el)\r\n        }\r\n        this.grid.resized = null \r\n    }\r\n    ;\r\n    this.deleteSelectedRows = function() {\r\n        var num = this.selectedRows.length;\r\n        if (num == 0) {\r\n            return\r\n        }\r\n        var tmpAr = this.selectedRows;\r\n        this.selectedRows = dhtmlxArray();\r\n        for (var i = num - 1; i >= 0; i--) {\r\n            var node = tmpAr[i];\r\n            if (!this.deleteRow(node.idd, node)) {\r\n                this.selectedRows[this.selectedRows.length] = node\r\n            } else {\r\n                if (node == this.row) {\r\n                    var ind = i\r\n                }\r\n            }\r\n        }\r\n        if (ind) {\r\n            try {\r\n                if (ind + 1 > this.rowsCol.length) {\r\n                    ind--\r\n                }\r\n                this.selectCell(ind, 0, true)\r\n            } catch (er) {\r\n                this.row = null ;\r\n                this.cell = null \r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getSelectedRowId = function() {\r\n        var selAr = new Array(0);\r\n        var uni = {};\r\n        for (var i = 0; i < this.selectedRows.length; i++) {\r\n            var id = this.selectedRows[i].idd;\r\n            if (uni[id]) {\r\n                continue\r\n            }\r\n            selAr[selAr.length] = id;\r\n            uni[id] = true\r\n        }\r\n        if (selAr.length == 0) {\r\n            return null \r\n        } else {\r\n            return selAr.join(this.delim)\r\n        }\r\n    }\r\n    ;\r\n    this.getSelectedCellIndex = function() {\r\n        if (this.cell != null ) {\r\n            return this.cell._cellIndex\r\n        } else {\r\n            return -1\r\n        }\r\n    }\r\n    ;\r\n    this.getColWidth = function(ind) {\r\n        return parseInt(this.cellWidthPX[ind])\r\n    }\r\n    ;\r\n    this.setColWidth = function(ind, value) {\r\n        if (value == \"*\") {\r\n            this.initCellWidth[ind] = \"*\"\r\n        } else {\r\n            if (this._hrrar[ind]) {\r\n                return\r\n            }\r\n            if (this.cellWidthType == \"px\") {\r\n                this.cellWidthPX[ind] = parseInt(value)\r\n            } else {\r\n                this.cellWidthPC[ind] = parseInt(value)\r\n            }\r\n        }\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.getRowIndex = function(row_id) {\r\n        for (var i = 0; i < this.rowsBuffer.length; i++) {\r\n            if (this.rowsBuffer[i] && this.rowsBuffer[i].idd == row_id) {\r\n                return i\r\n            }\r\n        }\r\n        return -1\r\n    }\r\n    ;\r\n    this.getRowId = function(ind) {\r\n        return this.rowsBuffer[ind] ? this.rowsBuffer[ind].idd : this.undefined\r\n    }\r\n    ;\r\n    this.setRowId = function(ind, row_id) {\r\n        this.changeRowId(this.getRowId(ind), row_id)\r\n    }\r\n    ;\r\n    this.changeRowId = function(oldRowId, newRowId) {\r\n        if (oldRowId == newRowId) {\r\n            return\r\n        }\r\n        var row = this.rowsAr[oldRowId];\r\n        row.idd = newRowId;\r\n        if (this.UserData[oldRowId]) {\r\n            this.UserData[newRowId] = this.UserData[oldRowId];\r\n            this.UserData[oldRowId] = null \r\n        }\r\n        if (this._h2 && this._h2.get[oldRowId]) {\r\n            this._h2.get[newRowId] = this._h2.get[oldRowId];\r\n            this._h2.get[newRowId].id = newRowId;\r\n            delete this._h2.get[oldRowId]\r\n        }\r\n        this.rowsAr[oldRowId] = null ;\r\n        this.rowsAr[newRowId] = row;\r\n        for (var i = 0; i < row.childNodes.length; i++) {\r\n            if (row.childNodes[i]._code) {\r\n                row.childNodes[i]._code = this._compileSCL(row.childNodes[i]._val, row.childNodes[i])\r\n            }\r\n        }\r\n        if (this._mat_links && this._mat_links[oldRowId]) {\r\n            var a = this._mat_links[oldRowId];\r\n            delete this._mat_links[oldRowId];\r\n            for (var c in a) {\r\n                for (var i = 0; i < a[c].length; i++) {\r\n                    this._compileSCL(a[c][i].original, a[c][i])\r\n                }\r\n            }\r\n        }\r\n        this.callEvent(\"onRowIdChange\", [oldRowId, newRowId])\r\n    }\r\n    ;\r\n    this.setColumnIds = function(ids) {\r\n        this.columnIds = ids.split(this.delim)\r\n    }\r\n    ;\r\n    this.setColumnId = function(ind, id) {\r\n        this.columnIds[ind] = id\r\n    }\r\n    ;\r\n    this.getColIndexById = function(id) {\r\n        for (var i = 0; i < this.columnIds.length; i++) {\r\n            if (this.columnIds[i] == id) {\r\n                return i\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getColumnId = function(cin) {\r\n        return this.columnIds[cin]\r\n    }\r\n    ;\r\n    this.getColumnLabel = function(cin, ind, hdr) {\r\n        var z = (hdr || this.hdr).rows[(ind || 0) + 1];\r\n        for (var i = 0; i < z.cells.length; i++) {\r\n            if (z.cells[i]._cellIndexS == cin) {\r\n                return ( _isIE ? z.cells[i].innerText : z.cells[i].textContent) \r\n            }\r\n        }\r\n        return \"\"\r\n    }\r\n    ;\r\n    this.getColLabel = this.getColumnLabel;\r\n    this.getFooterLabel = function(cin, ind) {\r\n        return this.getColumnLabel(cin, ind, this.ftr)\r\n    }\r\n    ;\r\n    this.setRowTextBold = function(row_id) {\r\n        var r = this.getRowById(row_id);\r\n        if (r) {\r\n            r.style.fontWeight = \"bold\"\r\n        }\r\n    }\r\n    ;\r\n    this.setRowTextStyle = function(row_id, styleString) {\r\n        var r = this.getRowById(row_id);\r\n        if (!r) {\r\n            return\r\n        }\r\n        for (var i = 0; i < r.childNodes.length; i++) {\r\n            var pfix = r.childNodes[i]._attrs.style || \"\";\r\n            if ((this._hrrar) && (this._hrrar[i])) {\r\n                pfix = \"display:none;\"\r\n            }\r\n            if (_isIE) {\r\n                r.childNodes[i].style.cssText = pfix + \"width:\" + r.childNodes[i].style.width + \";\" + styleString\r\n            } else {\r\n                r.childNodes[i].style.cssText = pfix + \"width:\" + r.childNodes[i].style.width + \";\" + styleString\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setRowColor = function(row_id, color) {\r\n        var r = this.getRowById(row_id);\r\n        for (var i = 0; i < r.childNodes.length; i++) {\r\n            r.childNodes[i].bgColor = color\r\n        }\r\n    }\r\n    ;\r\n    this.setCellTextStyle = function(row_id, ind, styleString) {\r\n        var r = this.getRowById(row_id);\r\n        if (!r) {\r\n            return\r\n        }\r\n        var cell = r.childNodes[r._childIndexes ? r._childIndexes[ind] : ind];\r\n        if (!cell) {\r\n            return\r\n        }\r\n        var pfix = \"\";\r\n        if ((this._hrrar) && (this._hrrar[ind])) {\r\n            pfix = \"display:none;\"\r\n        }\r\n        if (_isIE) {\r\n            cell.style.cssText = pfix + \"width:\" + cell.style.width + \";\" + styleString\r\n        } else {\r\n            cell.style.cssText = pfix + \"width:\" + cell.style.width + \";\" + styleString\r\n        }\r\n    }\r\n    ;\r\n    this.setRowTextNormal = function(row_id) {\r\n        var r = this.getRowById(row_id);\r\n        if (r) {\r\n            r.style.fontWeight = \"normal\"\r\n        }\r\n    }\r\n    ;\r\n    this.doesRowExist = function(row_id) {\r\n        if (this.getRowById(row_id) != null ) {\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.getColumnsNum = function() {\r\n        return this._cCount\r\n    }\r\n    ;\r\n    this.moveRowUp = function(row_id) {\r\n        var r = this.getRowById(row_id);\r\n        if (this.isTreeGrid()) {\r\n            return this.moveRowUDTG(row_id, -1)\r\n        }\r\n        var rInd = this.rowsCol._dhx_find(r);\r\n        if ((r.previousSibling) && (rInd != 0)) {\r\n            r.parentNode.insertBefore(r, r.previousSibling);\r\n            this.rowsCol._dhx_swapItems(rInd, rInd - 1);\r\n            this.setSizes();\r\n            var bInd = this.rowsBuffer._dhx_find(r);\r\n            this.rowsBuffer._dhx_swapItems(bInd, bInd - 1);\r\n            if (this._cssEven) {\r\n                this._fixAlterCss(rInd - 1)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.moveRowDown = function(row_id) {\r\n        var r = this.getRowById(row_id);\r\n        if (this.isTreeGrid()) {\r\n            return this.moveRowUDTG(row_id, 1)\r\n        }\r\n        var rInd = this.rowsCol._dhx_find(r);\r\n        if (r.nextSibling) {\r\n            this.rowsCol._dhx_swapItems(rInd, rInd + 1);\r\n            if (r.nextSibling.nextSibling) {\r\n                r.parentNode.insertBefore(r, r.nextSibling.nextSibling)\r\n            } else {\r\n                r.parentNode.appendChild(r)\r\n            }\r\n            this.setSizes();\r\n            var bInd = this.rowsBuffer._dhx_find(r);\r\n            this.rowsBuffer._dhx_swapItems(bInd, bInd + 1);\r\n            if (this._cssEven) {\r\n                this._fixAlterCss(rInd)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getCombo = function(col_ind) {\r\n        if (!this.combos[col_ind]) {\r\n            this.combos[col_ind] = new dhtmlXGridComboObject()\r\n        }\r\n        return this.combos[col_ind]\r\n    }\r\n    ;\r\n    this.setUserData = function(row_id, name, value) {\r\n        if (!row_id) {\r\n            row_id = \"gridglobaluserdata\"\r\n        }\r\n        if (!this.UserData[row_id]) {\r\n            this.UserData[row_id] = new Hashtable()\r\n        }\r\n        this.UserData[row_id].put(name, value)\r\n    }\r\n    ;\r\n    this.getUserData = function(row_id, name) {\r\n        if (!row_id) {\r\n            row_id = \"gridglobaluserdata\"\r\n        }\r\n        this.getRowById(row_id);\r\n        var z = this.UserData[row_id];\r\n        return ( z ? z.get(name) : \"\") \r\n    }\r\n    ;\r\n    this.setEditable = function(fl) {\r\n        this.isEditable = dhx4.s2b(fl)\r\n    }\r\n    ;\r\n    this.selectRowById = function(row_id, multiFL, show, call) {\r\n        if (!call) {\r\n            call = false\r\n        }\r\n        this.selectCell(this.getRowById(row_id), 0, call, multiFL, false, show)\r\n    }\r\n    ;\r\n    this.clearSelection = function() {\r\n        this.editStop();\r\n        for (var i = 0; i < this.selectedRows.length; i++) {\r\n            var r = this.rowsAr[this.selectedRows[i].idd];\r\n            if (r) {\r\n                r.className = r.className.replace(/rowselected/g, \"\")\r\n            }\r\n        }\r\n        this.selectedRows = dhtmlxArray();\r\n        this.row = null ;\r\n        if (this.cell != null ) {\r\n            this.cell.className = this.cell.className.replace(/cellselected/g, \"\");\r\n            this.cell = null \r\n        }\r\n        this.callEvent(\"onSelectionCleared\", [])\r\n    }\r\n    ;\r\n    this.copyRowContent = function(from_row_id, to_row_id) {\r\n        var frRow = this.getRowById(from_row_id);\r\n        if (!this.isTreeGrid()) {\r\n            for (var i = 0; i < frRow.cells.length; i++) {\r\n                this.cells(to_row_id, i).setValue(this.cells(from_row_id, i).getValue())\r\n            }\r\n        } else {\r\n            this._copyTreeGridRowContent(frRow, from_row_id, to_row_id)\r\n        }\r\n        if (!_isIE) {\r\n            this.getRowById(from_row_id).cells[0].height = frRow.cells[0].offsetHeight\r\n        }\r\n    }\r\n    ;\r\n    this.setFooterLabel = function(c, label, ind) {\r\n        return this.setColumnLabel(c, label, ind, this.ftr)\r\n    }\r\n    ;\r\n    this.setColumnLabel = function(c, label, ind, hdr) {\r\n        var z = (hdr || this.hdr).rows[ind || 1];\r\n        var col = (z._childIndexes ? z._childIndexes[c] : c);\r\n        if (!z.cells[col]) {\r\n            return\r\n        }\r\n        if (!this.useImagesInHeader) {\r\n            var hdrHTML = \"<div class='hdrcell'>\";\r\n            if (label.indexOf(\"img:[\") != -1) {\r\n                var imUrl = label.replace(/.*\\[([^>]+)\\].*/, \"$1\");\r\n                label = label.substr(label.indexOf(\"]\") + 1, label.length);\r\n                hdrHTML += \"<img width='18px' height='18px' align='absmiddle' src='\" + imUrl + \"' hspace='2'>\"\r\n            }\r\n            hdrHTML += label;\r\n            hdrHTML += \"</div>\";\r\n            z.cells[col].innerHTML = hdrHTML;\r\n            if (this._hstyles[col]) {\r\n                z.cells[col].style.cssText = this._hstyles[c]\r\n            }\r\n        } else {\r\n            z.cells[col].style.textAlign = \"left\";\r\n            z.cells[col].innerHTML = \"<img src='\" + label + \"'>\";\r\n            var a = new Image();\r\n            a.src = \"\" + label.replace(/(\\.[a-z]+)/, \".des$1\");\r\n            this.preloadImagesAr[this.preloadImagesAr.length] = a;\r\n            var b = new Image();\r\n            b.src = \"\" + label.replace(/(\\.[a-z]+)/, \".asc$1\");\r\n            this.preloadImagesAr[this.preloadImagesAr.length] = b\r\n        }\r\n        if ((label || \"\").indexOf(\"#\") != -1) {\r\n            var t = label.match(/(^|{)#([^}]+)(}|$)/);\r\n            if (t) {\r\n                var tn = \"_in_header_\" + t[2];\r\n                if (this[tn]) {\r\n                    this[tn]((this.forceDivInHeader ? z.cells[col].firstChild : z.cells[col]), col, label.split(t[0]))\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setColLabel = function(a, b, ind, c) {\r\n        return this.setColumnLabel(a, b, (ind || 0) + 1, c)\r\n    }\r\n    ;\r\n    this.clearAll = function(header) {\r\n        if (!this.obj.rows[0]) {\r\n            return\r\n        }\r\n        if (this._h2) {\r\n            this._h2 = this._createHierarchy();\r\n            if (this._fake) {\r\n                if (this._realfake) {\r\n                    this._h2 = this._fake._h2\r\n                } else {\r\n                    this._fake._h2 = this._h2\r\n                }\r\n            }\r\n        }\r\n        this.limit = this._limitC = 0;\r\n        this.editStop(true);\r\n        if (this._dLoadTimer) {\r\n            window.clearTimeout(this._dLoadTimer)\r\n        }\r\n        if (this._dload) {\r\n            this.objBox.scrollTop = 0;\r\n            this.limit = this._limitC || 0;\r\n            this._initDrF = true\r\n        }\r\n        var len = this.rowsCol.length;\r\n        len = this.obj.rows.length;\r\n        for (var i = len - 1; i > 0; i--) {\r\n            var t_r = this.obj.rows[i];\r\n            t_r.parentNode.removeChild(t_r)\r\n        }\r\n        if (header) {\r\n            this._master_row = null ;\r\n            this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);\r\n            for (var i = this.hdr.rows.length - 1; i >= 0; i--) {\r\n                var t_r = this.hdr.rows[i];\r\n                t_r.parentNode.removeChild(t_r)\r\n            }\r\n            if (this.ftr) {\r\n                this.ftr.parentNode.removeChild(this.ftr);\r\n                this.ftr = null \r\n            }\r\n            this._aHead = this.ftr = this.cellWidth = this._aFoot = null ;\r\n            this.cellType = dhtmlxArray();\r\n            this._hrrar = [];\r\n            this.columnIds = [];\r\n            this.combos = [];\r\n            this._strangeParams = [];\r\n            this.defVal = [];\r\n            this._ivizcol = null \r\n        }\r\n        this.row = null ;\r\n        this.cell = null ;\r\n        this.rowsCol = dhtmlxArray();\r\n        this.rowsAr = {};\r\n        this._RaSeCol = [];\r\n        this.rowsBuffer = dhtmlxArray();\r\n        this.UserData = [];\r\n        this.selectedRows = dhtmlxArray();\r\n        if (this.pagingOn || this._srnd) {\r\n            this.xmlFileUrl = \"\"\r\n        }\r\n        if (this.pagingOn) {\r\n            this.changePage(1)\r\n        }\r\n        if (this._contextCallTimer) {\r\n            window.clearTimeout(this._contextCallTimer)\r\n        }\r\n        if (this._sst) {\r\n            this.enableStableSorting(true)\r\n        }\r\n        this._fillers = this.undefined;\r\n        this.setSortImgState(false);\r\n        this.setSizes();\r\n        this.callEvent(\"onClearAll\", [])\r\n    }\r\n    ;\r\n    this.sortField = function(ind, repeatFl, r_el) {\r\n        if (this.getRowsNum() == 0) {\r\n            return false\r\n        }\r\n        var el = this.hdr.rows[0].cells[ind];\r\n        if (!el) {\r\n            return\r\n        }\r\n        if (el.tagName == \"TH\" && (this.fldSort.length - 1) >= el._cellIndex && this.fldSort[el._cellIndex] != \"na\") {\r\n            var data = this.getSortingState();\r\n            var sortType = (data[0] == ind && data[1] == \"asc\") ? \"des\" : \"asc\";\r\n            if (!this.callEvent(\"onBeforeSorting\", [ind, this.fldSort[ind], sortType])) {\r\n                return\r\n            }\r\n            this.sortImg.className = \"dhxgrid_sort_\" + (sortType == \"asc\" ? \"asc\" : \"desc\");\r\n            if (this.useImagesInHeader) {\r\n                var cel = this.hdr.rows[1].cells[el._cellIndex].firstChild;\r\n                if (this.fldSorted != null ) {\r\n                    var celT = this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;\r\n                    celT.src = celT.src.replace(/(\\.asc\\.)|(\\.des\\.)/, \".\")\r\n                }\r\n                cel.src = cel.src.replace(/(\\.[a-z]+)$/, \".\" + sortType + \"$1\")\r\n            }\r\n            this.sortRows(el._cellIndex, this.fldSort[el._cellIndex], sortType);\r\n            this.fldSorted = el;\r\n            this.r_fldSorted = r_el;\r\n            var c = this.hdr.rows[1];\r\n            var c = r_el.parentNode;\r\n            var real_el = c._childIndexes ? c._childIndexes[el._cellIndex] : el._cellIndex;\r\n            this.setSortImgPos(false, false, false, r_el)\r\n        }\r\n    }\r\n    ;\r\n    this.setCustomSorting = function(func, col) {\r\n        if (!this._customSorts) {\r\n            this._customSorts = new Array()\r\n        }\r\n        this._customSorts[col] = (typeof (func) == \"string\") ? eval(func) : func;\r\n        this.fldSort[col] = \"cus\"\r\n    }\r\n    ;\r\n    this.enableHeaderImages = function(fl) {\r\n        this.useImagesInHeader = fl\r\n    }\r\n    ;\r\n    this.setHeader = function(hdrStr, splitSign, styles) {\r\n        if (typeof (hdrStr) != \"object\") {\r\n            var arLab = this._eSplit(hdrStr)\r\n        } else {\r\n            arLab = [].concat(hdrStr)\r\n        }\r\n        var arWdth = new Array(0);\r\n        var arTyp = new dhtmlxArray(0);\r\n        var arAlg = new Array(0);\r\n        var arVAlg = new Array(0);\r\n        var arSrt = new Array(0);\r\n        for (var i = 0; i < arLab.length; i++) {\r\n            arWdth[arWdth.length] = Math.round(100 / arLab.length);\r\n            arTyp[arTyp.length] = \"ed\";\r\n            arAlg[arAlg.length] = \"left\";\r\n            arVAlg[arVAlg.length] = \"middle\";\r\n            arSrt[arSrt.length] = \"na\"\r\n        }\r\n        this.splitSign = splitSign || \"#cspan\";\r\n        this.hdrLabels = arLab;\r\n        this.cellWidth = arWdth;\r\n        if (!this.initCellWidth.length) {\r\n            this.setInitWidthsP(arWdth.join(this.delim), true)\r\n        }\r\n        this.cellType = arTyp;\r\n        this.cellAlign = arAlg;\r\n        this.cellVAlign = arVAlg;\r\n        this.fldSort = arSrt;\r\n        this._hstyles = styles || []\r\n    }\r\n    ;\r\n    this._eSplit = function(str) {\r\n        if (![].push) {\r\n            return str.split(this.delim)\r\n        }\r\n        var a = \"r\" + (new Date()).valueOf();\r\n        var z = this.delim.replace(/([\\|\\+\\*\\^])/g, \"\\\\$1\");\r\n        return (str || \"\").replace(RegExp(z, \"g\"), a).replace(RegExp(\"\\\\\\\\\" + a, \"g\"), this.delim).split(a)\r\n    }\r\n    ;\r\n    this.getColType = function(cInd) {\r\n        return this.cellType[cInd]\r\n    }\r\n    ;\r\n    this.getColTypeById = function(cID) {\r\n        return this.cellType[this.getColIndexById(cID)]\r\n    }\r\n    ;\r\n    this.setColTypes = function(typeStr) {\r\n        this.cellType = dhtmlxArray(typeStr.split(this.delim));\r\n        this._strangeParams = new Array();\r\n        for (var i = 0; i < this.cellType.length; i++) {\r\n            if ((this.cellType[i].indexOf(\"[\") != -1) ) {\r\n                var z = this.cellType[i].split(/[\\[\\]]+/g);\r\n                this.cellType[i] = z[0];\r\n                this.defVal[i] = z[1];\r\n                if (z[1].indexOf(\"=\") == 0) {\r\n                    this.cellType[i] = \"math\";\r\n                    this._strangeParams[i] = z[0]\r\n                }\r\n            }\r\n            if (!window[\"eXcell_\" + this.cellType[i]]) {\r\n                dhx4.callEvent(\"onConfigurationError\", [\"Incorrect cell type: \" + this.cellType[i], this, this.cellType[i]])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setColSorting = function(sortStr) {\r\n        this.fldSort = sortStr.split(this.delim);\r\n        var check = {\r\n            str: 1,\r\n            \"int\": 1,\r\n            date: 1\r\n        };\r\n        for (var i = 0; i < this.fldSort.length; i++) {\r\n            if ((!check[this.fldSort[i]]) && (typeof (window[this.fldSort[i]]) == \"function\")) {\r\n                if (!this._customSorts) {\r\n                    this._customSorts = new Array()\r\n                }\r\n                this._customSorts[i] = window[this.fldSort[i]];\r\n                this.fldSort[i] = \"cus\"\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setColAlign = function(alStr) {\r\n        this.cellAlign = alStr.split(this.delim);\r\n        for (var i = 0; i < this.cellAlign.length; i++) {\r\n            this.cellAlign[i] = this.cellAlign[i]._dhx_trim()\r\n        }\r\n    }\r\n    ;\r\n    this.setColVAlign = function(valStr) {\r\n        this.cellVAlign = valStr.split(this.delim)\r\n    }\r\n    ;\r\n    this.setNoHeader = function(fl) {\r\n        this.noHeader = dhx4.s2b(fl)\r\n    }\r\n    ;\r\n    this.showRow = function(rowID) {\r\n        this.getRowById(rowID);\r\n        if (this._h2) {\r\n            this.openItem(this._h2.get[rowID].parent.id)\r\n        }\r\n        var c = this.getRowById(rowID).childNodes[0];\r\n        while (c && c.style.display == \"none\") {\r\n            c = c.nextSibling\r\n        }\r\n        if (c) {\r\n            this.moveToVisible(c, true)\r\n        }\r\n    }\r\n    ;\r\n    this.setStyle = function(ss_header, ss_grid, ss_selCell, ss_selRow) {\r\n        this.ssModifier = [ss_header, ss_grid, ss_selCell, ss_selCell, ss_selRow];\r\n        var prefs = [\"#\" + this.entBox.id + \" table.hdr td\", \"#\" + this.entBox.id + \" table.obj td\", \"#\" + this.entBox.id + \" table.obj tr.rowselected td.cellselected\", \"#\" + this.entBox.id + \" table.obj td.cellselected\", \"#\" + this.entBox.id + \" table.obj tr.rowselected td\"];\r\n        var index = 0;\r\n        while (!_isIE) {\r\n            try {\r\n                var temp = document.styleSheets[index].cssRules.length\r\n            } catch (e) {\r\n                index++;\r\n                continue\r\n            }\r\n            break\r\n        }\r\n        for (var i = 0; i < prefs.length; i++) {\r\n            if (this.ssModifier[i]) {\r\n                if (_isIE) {\r\n                    document.styleSheets[0].addRule(prefs[i], this.ssModifier[i])\r\n                } else {\r\n                    document.styleSheets[index].insertRule(prefs[i] + (\" { \" + this.ssModifier[i] + \" }\"), document.styleSheets[index].cssRules.length)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setColumnColor = function(clr) {\r\n        this.columnColor = clr.split(this.delim)\r\n    }\r\n    ;\r\n    this.enableAlterCss = function(cssE, cssU, perLevel, levelUnique) {\r\n        if (cssE || cssU) {\r\n            this.attachEvent(\"onGridReconstructed\", function() {\r\n                this._fixAlterCss();\r\n                if (this._fake) {\r\n                    this._fake._fixAlterCss()\r\n                }\r\n            })\r\n        }\r\n        this._cssSP = perLevel;\r\n        this._cssSU = levelUnique;\r\n        this._cssEven = cssE;\r\n        this._cssUnEven = cssU\r\n    }\r\n    ;\r\n    this._fixAlterCss = function(ind) {\r\n        if (this._h2 && (this._cssSP || this._cssSU)) {\r\n            return this._fixAlterCssTGR(ind)\r\n        }\r\n        if (!this._cssEven && !this._cssUnEven) {\r\n            return\r\n        }\r\n        ind = ind || 0;\r\n        var j = ind;\r\n        for (var i = ind; i < this.rowsCol.length; i++) {\r\n            if (!this.rowsCol[i]) {\r\n                continue\r\n            }\r\n            if (this.rowsCol[i].style.display != \"none\") {\r\n                if (this.rowsCol[i]._cntr) {\r\n                    j = 1;\r\n                    continue\r\n                }\r\n                if (this.rowsCol[i].className.indexOf(\"rowselected\") != -1) {\r\n                    if (j % 2 == 1) {\r\n                        this.rowsCol[i].className = this._cssUnEven + \" rowselected \" + (this.rowsCol[i]._css || \"\")\r\n                    } else {\r\n                        this.rowsCol[i].className = this._cssEven + \" rowselected \" + (this.rowsCol[i]._css || \"\")\r\n                    }\r\n                } else {\r\n                    if (j % 2 == 1) {\r\n                        this.rowsCol[i].className = this._cssUnEven + \" \" + (this.rowsCol[i]._css || \"\")\r\n                    } else {\r\n                        this.rowsCol[i].className = this._cssEven + \" \" + (this.rowsCol[i]._css || \"\")\r\n                    }\r\n                }\r\n                j++\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.clearChangedState = function() {\r\n        for (var i = 0; i < this.rowsCol.length; i++) {\r\n            var row = this.rowsCol[i];\r\n            if (row && row.childNodes) {\r\n                var cols = row.childNodes.length;\r\n                for (var j = 0; j < cols; j++) {\r\n                    row.childNodes[j].wasChanged = false\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getChangedRows = function(and_added) {\r\n        var res = new Array();\r\n        this.forEachRow(function(id) {\r\n            var row = this.rowsAr[id];\r\n            if (row.tagName != \"TR\") {\r\n                return\r\n            }\r\n            var cols = row.childNodes.length;\r\n            if (and_added && row._added) {\r\n                res[res.length] = row.idd\r\n            } else {\r\n                for (var j = 0; j < cols; j++) {\r\n                    if (row.childNodes[j].wasChanged) {\r\n                        res[res.length] = row.idd;\r\n                        break\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return res.join(this.delim)\r\n    }\r\n    ;\r\n    this._sUDa = false;\r\n    this._sAll = false;\r\n    this.setSerializationLevel = function(userData, fullXML, config, changedAttr, onlyChanged, asCDATA) {\r\n        this._sUDa = userData;\r\n        this._sAll = fullXML;\r\n        this._sConfig = config;\r\n        this._chAttr = changedAttr;\r\n        this._onlChAttr = onlyChanged;\r\n        this._asCDATA = asCDATA\r\n    }\r\n    ;\r\n    this.setSerializableColumns = function(list) {\r\n        if (!list) {\r\n            this._srClmn = null ;\r\n            return\r\n        }\r\n        this._srClmn = (list || \"\").split(\",\");\r\n        for (var i = 0; i < this._srClmn.length; i++) {\r\n            this._srClmn[i] = dhx4.s2b(this._srClmn[i])\r\n        }\r\n    }\r\n    ;\r\n    this._serialise = function(rCol, inner, closed) {\r\n        this.editStop();\r\n        var out = [];\r\n        var close = \"</\" + this.xml.s_row + \">\";\r\n        if (this.isTreeGrid()) {\r\n            this._h2.forEachChildF(0, function(el) {\r\n                var temp = this._serializeRow(this.render_row_tree(-1, el.id));\r\n                out.push(temp);\r\n                if (temp) {\r\n                    return true\r\n                } else {\r\n                    return false\r\n                }\r\n            }, this, function() {\r\n                out.push(close)\r\n            })\r\n        } else {\r\n            for (var i = 0; i < this.rowsBuffer.length; i++) {\r\n                if (this.rowsBuffer[i]) {\r\n                    if (this._chAttr && this.rowsBuffer[i]._locator) {\r\n                        continue\r\n                    }\r\n                    var temp = this._serializeRow(this.render_row(i));\r\n                    out.push(temp);\r\n                    if (temp) {\r\n                        out.push(close)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return [out.join(\"\")]\r\n    }\r\n    ;\r\n    this._serializeRow = function(r, i) {\r\n        var out = [];\r\n        var ra = this.xml.row_attrs;\r\n        var ca = this.xml.cell_attrs;\r\n        out.push(\"<\" + this.xml.s_row);\r\n        out.push(\" id='\" + r.idd + \"'\");\r\n        if ((this._sAll) && this.selectedRows._dhx_find(r) != -1) {\r\n            out.push(\" selected='1'\")\r\n        }\r\n        if (this._h2 && this._h2.get[r.idd].state == \"minus\") {\r\n            out.push(\" open='1'\")\r\n        }\r\n        if (ra.length) {\r\n            for (var i = 0; i < ra.length; i++) {\r\n                out.push(\" \" + ra[i] + \"='\" + r._attrs[ra[i]] + \"'\")\r\n            }\r\n        }\r\n        out.push(\">\");\r\n        if (this._sUDa && this.UserData[r.idd]) {\r\n            keysAr = this.UserData[r.idd].getKeys();\r\n            for (var ii = 0; ii < keysAr.length; ii++) {\r\n                out.push(\"<userdata name='\" + keysAr[ii] + \"'>\" + (this._asCDATA ? \"<![CDATA[\" : \"\") + this.UserData[r.idd].get(keysAr[ii]) + (this._asCDATA ? \"]]>\" : \"\") + \"</userdata>\")\r\n            }\r\n        }\r\n        var changeFl = false;\r\n        for (var jj = 0; jj < this._cCount; jj++) {\r\n            if ((!this._srClmn) || (this._srClmn[jj])) {\r\n                var zx = this.cells3(r, jj);\r\n                out.push(\"<cell\");\r\n                if (ca.length) {\r\n                    for (var i = 0; i < ca.length; i++) {\r\n                        out.push(\" \" + ca[i] + \"='\" + zx.cell._attrs[ca[i]] + \"'\")\r\n                    }\r\n                }\r\n                zxVal = zx[this._agetm]();\r\n                if (this._asCDATA) {\r\n                    zxVal = \"<![CDATA[\" + zxVal + \"]]>\"\r\n                }\r\n                if ((this._ecspn) && (zx.cell.colSpan) && zx.cell.colSpan > 1) {\r\n                    out.push(' colspan=\"' + zx.cell.colSpan + '\" ')\r\n                }\r\n                if (this._chAttr) {\r\n                    if (zx.wasChanged()) {\r\n                        out.push(' changed=\"1\"');\r\n                        changeFl = true\r\n                    }\r\n                } else {\r\n                    if ((this._onlChAttr) && (zx.wasChanged())) {\r\n                        changeFl = true\r\n                    }\r\n                }\r\n                if (this._sAll && this.cellType[jj] == \"tree\") {\r\n                    out.push((this._h2 ? (\" image='\" + this._h2.get[r.idd].image + \"'\") : \"\") + \">\" + zxVal + \"</cell>\")\r\n                } else {\r\n                    out.push(\">\" + zxVal + \"</cell>\")\r\n                }\r\n                if ((this._ecspn) && (zx.cell.colSpan)) {\r\n                    for (var u = 0; u < zx.cell.colSpan - 1; u++) {\r\n                        out.push(\"<cell/>\");\r\n                        jj++\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if ((this._onlChAttr) && (!changeFl) && (!r._added)) {\r\n            return \"\"\r\n        }\r\n        return out.join(\"\")\r\n    }\r\n    ;\r\n    this._serialiseConfig = function() {\r\n        var out = \"<head>\";\r\n        for (var i = 0; i < this.hdr.rows[0].cells.length; i++) {\r\n            if (this._srClmn && !this._srClmn[i]) {\r\n                continue\r\n            }\r\n            var sort = this.fldSort[i];\r\n            if (sort == \"cus\") {\r\n                sort = this._customSorts[i].toString();\r\n                sort = sort.replace(/function[\\ ]*/, \"\").replace(/\\([^\\f]*/, \"\")\r\n            }\r\n            out += \"<column width='\" + this.getColWidth(i) + \"' align='\" + this.cellAlign[i] + \"' type='\" + this.cellType[i] + \"' sort='\" + (sort || \"na\") + \"' color='\" + (this.columnColor[i] || \"\") + \"'\" + (this.columnIds[i] ? (\" id='\" + this.columnIds[i] + \"'\") : \"\") + \">\";\r\n            if (this._asCDATA) {\r\n                out += \"<![CDATA[\" + this.getColumnLabel(i) + \"]]>\"\r\n            } else {\r\n                out += this.getColumnLabel(i)\r\n            }\r\n            var z = this.getCombo(i);\r\n            if (z) {\r\n                for (var j = 0; j < z.keys.length; j++) {\r\n                    out += \"<option value='\" + z.keys[j] + \"'>\" + z.values[j] + \"</option>\"\r\n                }\r\n            }\r\n            out += \"</column>\"\r\n        }\r\n        return out += \"</head>\"\r\n    }\r\n    ;\r\n    this.serialize = function() {\r\n        var out = '<?xml version=\"1.0\"?><rows>';\r\n        if (this._mathSerialization) {\r\n            this._agetm = \"getMathValue\"\r\n        } else {\r\n            this._agetm = \"getValue\"\r\n        }\r\n        if (this._sUDa && this.UserData.gridglobaluserdata) {\r\n            var keysAr = this.UserData.gridglobaluserdata.getKeys();\r\n            for (var i = 0; i < keysAr.length; i++) {\r\n                out += \"<userdata name='\" + keysAr[i] + \"'>\" + this.UserData.gridglobaluserdata.get(keysAr[i]) + \"</userdata>\"\r\n            }\r\n        }\r\n        if (this._sConfig) {\r\n            out += this._serialiseConfig()\r\n        }\r\n        out += this._serialise();\r\n        out += \"</rows>\";\r\n        return out\r\n    }\r\n    ;\r\n    this.getPosition = function(oNode, pNode) {\r\n        if (!pNode) {\r\n            var pos = dhx4.getOffset(oNode);\r\n            return [pos.left, pos.top]\r\n        }\r\n        pNode = pNode || document.body;\r\n        var oCurrentNode = oNode;\r\n        var iLeft = 0;\r\n        var iTop = 0;\r\n        while ((oCurrentNode) && (oCurrentNode != pNode)) {\r\n            iLeft += oCurrentNode.offsetLeft - oCurrentNode.scrollLeft;\r\n            iTop += oCurrentNode.offsetTop - oCurrentNode.scrollTop;\r\n            oCurrentNode = oCurrentNode.offsetParent\r\n        }\r\n        if (pNode == document.body) {\r\n            if (_isIE) {\r\n                iTop += document.body.offsetTop || document.documentElement.offsetTop;\r\n                iLeft += document.body.offsetLeft || document.documentElement.offsetLeft\r\n            } else {\r\n                if (!_isFF) {\r\n                    iLeft += document.body.offsetLeft;\r\n                    iTop += document.body.offsetTop\r\n                }\r\n            }\r\n        }\r\n        return [iLeft, iTop]\r\n    }\r\n    ;\r\n    this.getFirstParentOfType = function(obj, tag) {\r\n        while (obj && obj.tagName != tag && obj.tagName != \"BODY\") {\r\n            obj = obj.parentNode\r\n        }\r\n        return obj\r\n    }\r\n    ;\r\n    this.objBox.onscroll = function() {\r\n        this.grid._doOnScroll()\r\n    }\r\n    ;\r\n    this.hdrBox.onscroll = function() {\r\n        if (this._try_header_sync) {\r\n            return\r\n        }\r\n        this._try_header_sync = true;\r\n        if (Math.abs(this.grid.objBox.scrollLeft - this.scrollLeft) > 1) {\r\n            this.grid.objBox.scrollLeft = this.scrollLeft\r\n        }\r\n        this._try_header_sync = false\r\n    }\r\n    ;\r\n    if ((!_isOpera) || (_OperaRv > 8.5)) {\r\n        this.hdr.onmousemove = function(e) {\r\n            this.grid.changeCursorState(e || window.event)\r\n        }\r\n        ;\r\n        this.hdr.onmousedown = function(e) {\r\n            return this.grid.startColResize(e || window.event)\r\n        }\r\n    }\r\n    this.obj.onmousemove = this._drawTooltip;\r\n    this.objBox.onclick = function(e) {\r\n        e = e || event;\r\n        e.cancelBubble = true;\r\n        this.firstChild.grid.setActive(true);\r\n        window.dhx4.callEvent(\"_onGridClick\", [e, this.firstChild.grid])\r\n    }\r\n    ;\r\n    this.obj.onclick = function(e) {\r\n        if (this.grid._doClick(e || window.event) !== false) {\r\n            if (this.grid._sclE) {\r\n                this.grid.editCell(e || window.event)\r\n            } else {\r\n                this.grid.editStop()\r\n            }\r\n        }\r\n        e = e || event;\r\n        e.cancelBubble = true;\r\n        window.dhx4.callEvent(\"_onGridClick\", [e, this.grid])\r\n    }\r\n    ;\r\n    if (_isMacOS) {\r\n        this.entBox.oncontextmenu = function(e) {\r\n            e.cancelBubble = true;\r\n            if (e.preventDefault) {\r\n                e.preventDefault()\r\n            } else {\r\n                e.returnValue = false\r\n            }\r\n            var that = this.grid;\r\n            if (that._realfake) {\r\n                that = that._fake\r\n            }\r\n            return that._doContClick(e || window.event)\r\n        }\r\n    } else {\r\n        this.entBox.onmousedown = function(e) {\r\n            return this.grid._doContClick(e || window.event)\r\n        }\r\n        ;\r\n        this.entBox.oncontextmenu = function(e) {\r\n            if (this.grid._ctmndx) {\r\n                (e || event).cancelBubble = true\r\n            }\r\n            return !this.grid._ctmndx\r\n        }\r\n    }\r\n    this.obj.ondblclick = function(e) {\r\n        if (!this.grid.wasDblClicked(e || window.event)) {\r\n            return false\r\n        }\r\n        if (this.grid._dclE) {\r\n            var row = this.grid.getFirstParentOfType((_isIE ? event.srcElement : e.target), \"TR\");\r\n            if (row == this.grid.row) {\r\n                this.grid.editCell(e || window.event)\r\n            }\r\n        }\r\n        (e || event).cancelBubble = true;\r\n        if (_isOpera) {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.hdr.onclick = this._onHeaderClick;\r\n    this.sortImg.onclick = function() {\r\n        self._onHeaderClick.apply({\r\n            grid: self\r\n        }, [null , self.r_fldSorted])\r\n    }\r\n    ;\r\n    this.hdr.ondblclick = this._onHeaderDblClick;\r\n    if (!document.body._dhtmlxgrid_onkeydown) {\r\n        dhtmlxEvent(document, \"keydown\", function(e) {\r\n            if (globalActiveDHTMLGridObject) {\r\n                return globalActiveDHTMLGridObject.doKey(e || window.event)\r\n            }\r\n        });\r\n        document.body._dhtmlxgrid_onkeydown = true\r\n    }\r\n    dhtmlxEvent(document.body, \"click\", function() {\r\n        if (self.editStop) {\r\n            self.editStop()\r\n        }\r\n        if (self.isActive) {\r\n            self.setActive(false)\r\n        }\r\n    });\r\n    if (this.entBox.style.height.toString().indexOf(\"%\") != -1) {\r\n        this._delta_y = this.entBox.style.height\r\n    }\r\n    if (this.entBox.style.width.toString().indexOf(\"%\") != -1) {\r\n        this._delta_x = this.entBox.style.width\r\n    }\r\n    if (this._delta_x || this._delta_y) {\r\n        this._setAutoResize()\r\n    }\r\n    this.setColHidden = this.setColumnsVisibility;\r\n    this.enableCollSpan = this.enableColSpan;\r\n    this.setMultiselect = this.enableMultiselect;\r\n    this.setMultiLine = this.enableMultiline;\r\n    this.deleteSelectedItem = this.deleteSelectedRows;\r\n    this.getSelectedId = this.getSelectedRowId;\r\n    this.getHeaderCol = this.getColumnLabel;\r\n    this.isItemExists = this.doesRowExist;\r\n    this.getColumnCount = this.getColumnsNum;\r\n    this.setSelectedRow = this.selectRowById;\r\n    this.setHeaderCol = this.setColumnLabel;\r\n    this.preventIECashing = this.preventIECaching;\r\n    this.enableAutoHeigth = this.enableAutoHeight;\r\n    this.getUID = this.uid;\r\n    if (dhtmlx.image_path) {\r\n        this.setImagePath(dhtmlx.image_path)\r\n    }\r\n    if (dhtmlx.skin) {\r\n        this.setSkin(dhtmlx.skin)\r\n    }\r\n    return this\r\n}\r\ndhtmlXGridObject.prototype = {\r\n    getRowAttribute: function(c, a) {\r\n        return this.getRowById(c)._attrs[a]\r\n    },\r\n    setRowAttribute: function(e, a, c) {\r\n        this.getRowById(e)._attrs[a] = c\r\n    },\r\n    isTreeGrid: function() {\r\n        return ( this.cellType._dhx_find(\"tree\") != -1) \r\n    },\r\n    setRowHidden: function(l, e) {\r\n        var c = dhx4.s2b(e);\r\n        var h = this.getRowById(l);\r\n        if (!h) {\r\n            return\r\n        }\r\n        if (h.expand === \"\") {\r\n            this.collapseKids(h)\r\n        }\r\n        if ((e) && (h.style.display != \"none\")) {\r\n            h.style.display = \"none\";\r\n            var g = this.selectedRows._dhx_find(h);\r\n            if (g != -1) {\r\n                h.className = h.className.replace(\"rowselected\", \"\");\r\n                for (var a = 0; a < h.childNodes.length; a++) {\r\n                    h.childNodes[a].className = h.childNodes[a].className.replace(/cellselected/g, \"\")\r\n                }\r\n                this.selectedRows._dhx_removeAt(g)\r\n            }\r\n            this.callEvent(\"onGridReconstructed\", [])\r\n        }\r\n        if ((!e) && (h.style.display == \"none\")) {\r\n            h.style.display = \"\";\r\n            this.callEvent(\"onGridReconstructed\", [])\r\n        }\r\n        this.callEvent(\"onRowHide\", [l, e]);\r\n        this.setSizes()\r\n    },\r\n    setColumnHidden: function(e, c) {\r\n        if (!this.hdr.rows.length) {\r\n            if (!this._ivizcol) {\r\n                this._ivizcol = []\r\n            }\r\n            return this._ivizcol[e] = c\r\n        }\r\n        if ((this.fldSorted) && (this.fldSorted.cellIndex == e) && (c)) {\r\n            this.sortImg.style.display = \"none\"\r\n        }\r\n        var a = dhx4.s2b(c);\r\n        if (a) {\r\n            if (!this._hrrar) {\r\n                this._hrrar = new Array()\r\n            } else {\r\n                if (this._hrrar[e]) {\r\n                    return\r\n                }\r\n            }\r\n            this._hrrar[e] = \"display:none;\";\r\n            this._hideShowColumn(e, \"none\")\r\n        } else {\r\n            if ((!this._hrrar) || (!this._hrrar[e])) {\r\n                return\r\n            }\r\n            this._hrrar[e] = \"\";\r\n            this._hideShowColumn(e, \"\")\r\n        }\r\n        if ((this.fldSorted) && (this.fldSorted.cellIndex == e) && (!c)) {\r\n            this.sortImg.style.display = \"inline\"\r\n        }\r\n        this.setSortImgPos();\r\n        this.callEvent(\"onColumnHidden\", [e, c])\r\n    },\r\n    isColumnHidden: function(a) {\r\n        if ((this._hrrar) && (this._hrrar[a])) {\r\n            return true\r\n        }\r\n        return false\r\n    },\r\n    setColumnsVisibility: function(c) {\r\n        if (c) {\r\n            this._ivizcol = c.split(this.delim)\r\n        }\r\n        if (this.hdr.rows.length && this._ivizcol) {\r\n            for (var a = 0; a < this._ivizcol.length; a++) {\r\n                this.setColumnHidden(a, this._ivizcol[a])\r\n            }\r\n        }\r\n    },\r\n    _fixHiddenRowsAll: function(n, e, a, c, l) {\r\n        l = l || \"_cellIndex\";\r\n        var m = n.rows.length;\r\n        for (var h = 0; h < m; h++) {\r\n            var o = n.rows[h].childNodes;\r\n            if (o.length != this._cCount) {\r\n                for (var g = 0; g < o.length; g++) {\r\n                    if (o[g][l] == e) {\r\n                        o[g].style[a] = c;\r\n                        break\r\n                    }\r\n                }\r\n            } else {\r\n                o[e].style[a] = c\r\n            }\r\n        }\r\n    },\r\n    _hideShowColumn: function(h, g) {\r\n        var a = h;\r\n        if (this.hdr.rows[1] && (this.hdr.rows[1]._childIndexes) && (this.hdr.rows[1]._childIndexes[h] != h)) {\r\n            a = this.hdr.rows[1]._childIndexes[h]\r\n        }\r\n        if (g == \"none\") {\r\n            this.hdr.rows[0].cells[h]._oldWidth = this.hdr.rows[0].cells[h].style.width || (this.initCellWidth[h] + \"px\");\r\n            this.hdr.rows[0].cells[h]._oldWidthP = this.cellWidthPC[h];\r\n            this.obj.rows[0].cells[h].style.width = \"0px\";\r\n            var c = {\r\n                rows: [this.obj.rows[0]]\r\n            };\r\n            this.forEachRow(function(l) {\r\n                if (this.rowsAr[l].tagName == \"TR\") {\r\n                    c.rows.push(this.rowsAr[l])\r\n                }\r\n            });\r\n            this._fixHiddenRowsAll(c, h, \"display\", \"none\");\r\n            if (this.isTreeGrid()) {\r\n                this._fixHiddenRowsAllTG(h, \"none\")\r\n            }\r\n            if ((_isOpera && _OperaRv < 9) || _isKHTML || (_isFF)) {\r\n                this._fixHiddenRowsAll(this.hdr, h, \"display\", \"none\", \"_cellIndexS\")\r\n            }\r\n            if (this.ftr) {\r\n                this._fixHiddenRowsAll(this.ftr.childNodes[0], h, \"display\", \"none\")\r\n            }\r\n            this._fixHiddenRowsAll(this.hdr, h, \"whiteSpace\", \"nowrap\", \"_cellIndexS\");\r\n            if (!this.cellWidthPX.length && !this.cellWidthPC.length) {\r\n                this.cellWidthPX = [].concat(this.initCellWidth)\r\n            }\r\n            if (this.cellWidthPX[h]) {\r\n                this.cellWidthPX[h] = 0\r\n            }\r\n            if (this.cellWidthPC[h]) {\r\n                this.cellWidthPC[h] = 0\r\n            }\r\n        } else {\r\n            if (this.hdr.rows[0].cells[h]._oldWidth) {\r\n                var e = this.hdr.rows[0].cells[h];\r\n                if (_isOpera || _isKHTML || (_isFF)) {\r\n                    this._fixHiddenRowsAll(this.hdr, h, \"display\", \"\", \"_cellIndexS\")\r\n                }\r\n                if (this.ftr) {\r\n                    this._fixHiddenRowsAll(this.ftr.childNodes[0], h, \"display\", \"\")\r\n                }\r\n                var c = {\r\n                    rows: [this.obj.rows[0]]\r\n                };\r\n                this.forEachRow(function(l) {\r\n                    if (this.rowsAr[l].tagName == \"TR\") {\r\n                        c.rows.push(this.rowsAr[l])\r\n                    }\r\n                });\r\n                this._fixHiddenRowsAll(c, h, \"display\", \"\");\r\n                if (this.isTreeGrid()) {\r\n                    this._fixHiddenRowsAllTG(h, \"\")\r\n                }\r\n                this._fixHiddenRowsAll(this.hdr, h, \"whiteSpace\", \"normal\", \"_cellIndexS\");\r\n                if (e._oldWidthP) {\r\n                    this.cellWidthPC[h] = e._oldWidthP\r\n                }\r\n                if (e._oldWidth) {\r\n                    this.cellWidthPX[h] = parseInt(e._oldWidth)\r\n                }\r\n            }\r\n        }\r\n        this.setSizes();\r\n        if ((!_isIE) && (!_isFF)) {\r\n            this.obj.border = 1;\r\n            this.obj.border = 0\r\n        }\r\n    },\r\n    enableColSpan: function(a) {\r\n        this._ecspn = dhx4.s2b(a)\r\n    },\r\n    enableRowsHover: function(c, a) {\r\n        this._unsetRowHover(false, true);\r\n        this._hvrCss = a;\r\n        if (dhx4.s2b(c)) {\r\n            if (!this._elmnh) {\r\n                this.obj._honmousemove = this.obj.onmousemove;\r\n                this.obj.onmousemove = this._setRowHover;\r\n                if (_isIE) {\r\n                    this.obj.onmouseleave = this._unsetRowHover\r\n                } else {\r\n                    this.obj.onmouseout = this._unsetRowHover\r\n                }\r\n                this._elmnh = true\r\n            }\r\n        } else {\r\n            if (this._elmnh) {\r\n                this.obj.onmousemove = this.obj._honmousemove;\r\n                if (_isIE) {\r\n                    this.obj.onmouseleave = null \r\n                } else {\r\n                    this.obj.onmouseout = null \r\n                }\r\n                this._elmnh = false\r\n            }\r\n        }\r\n    },\r\n    enableEditEvents: function(c, e, a) {\r\n        this._sclE = dhx4.s2b(c);\r\n        this._dclE = dhx4.s2b(e);\r\n        this._f2kE = dhx4.s2b(a)\r\n    },\r\n    enableLightMouseNavigation: function(a) {\r\n        if (dhx4.s2b(a)) {\r\n            if (!this._elmn) {\r\n                this.entBox._onclick = this.entBox.onclick;\r\n                this.entBox.onclick = function() {\r\n                    return true\r\n                }\r\n                ;\r\n                this.obj._onclick = this.obj.onclick;\r\n                this.obj.onclick = function(g) {\r\n                    var h = this.grid.getFirstParentOfType(g ? g.target : event.srcElement, \"TD\");\r\n                    if (!h) {\r\n                        return\r\n                    }\r\n                    this.grid.editStop();\r\n                    this.grid.doClick(h);\r\n                    this.grid.editCell();\r\n                    (g || event).cancelBubble = true\r\n                }\r\n                ;\r\n                this.obj._onmousemove = this.obj.onmousemove;\r\n                this.obj.onmousemove = this._autoMoveSelect;\r\n                this._elmn = true\r\n            }\r\n        } else {\r\n            if (this._elmn) {\r\n                this.entBox.onclick = this.entBox._onclick;\r\n                this.obj.onclick = this.obj._onclick;\r\n                this.obj.onmousemove = this.obj._onmousemove;\r\n                this._elmn = false\r\n            }\r\n        }\r\n    },\r\n    _unsetRowHover: function(g, h) {\r\n        if (h) {\r\n            that = this\r\n        } else {\r\n            that = this.grid\r\n        }\r\n        if ((that._lahRw) && (that._lahRw != h)) {\r\n            for (var a = 0; a < that._lahRw.childNodes.length; a++) {\r\n                that._lahRw.childNodes[a].className = that._lahRw.childNodes[a].className.replace(that._hvrCss, \"\")\r\n            }\r\n            that._lahRw = null \r\n        }\r\n    },\r\n    _setRowHover: function(g) {\r\n        var h = this.grid.getFirstParentOfType(g ? g.target : event.srcElement, \"TD\");\r\n        if (h && h.parentNode != this.grid._lahRw) {\r\n            this.grid._unsetRowHover(0, h);\r\n            h = h.parentNode;\r\n            if (!h.idd || h.idd == \"__filler__\") {\r\n                return\r\n            }\r\n            for (var a = 0; a < h.childNodes.length; a++) {\r\n                h.childNodes[a].className += \" \" + this.grid._hvrCss\r\n            }\r\n            this.grid._lahRw = h\r\n        }\r\n        this._honmousemove(g)\r\n    },\r\n    _autoMoveSelect: function(a) {\r\n        if (!this.grid.editor) {\r\n            var g = this.grid.getFirstParentOfType(a ? a.target : event.srcElement, \"TD\");\r\n            if (g.parentNode.idd) {\r\n                this.grid.doClick(g, true, 0)\r\n            }\r\n        }\r\n        this._onmousemove(a)\r\n    },\r\n    enableDistributedParsing: function(e, a, c) {\r\n        if (dhx4.s2b(e)) {\r\n            this._ads_count = a || 10;\r\n            this._ads_time = c || 250\r\n        } else {\r\n            this._ads_count = 0\r\n        }\r\n    },\r\n    destructor: function() {\r\n        this.editStop(true);\r\n        if (this._sizeTime) {\r\n            this._sizeTime = window.clearTimeout(this._sizeTime)\r\n        }\r\n        this.entBox.className = (this.entBox.className || \"\").replace(/gridbox.*/, \"\");\r\n        if (this.formInputs) {\r\n            for (var e = 0; e < this.formInputs.length; e++) {\r\n                this.parentForm.removeChild(this.formInputs[e])\r\n            }\r\n        }\r\n        var c;\r\n        for (var e = 0; e < this.rowsCol.length; e++) {\r\n            if (this.rowsCol[e]) {\r\n                this.rowsCol[e].grid = null \r\n            }\r\n        }\r\n        for (e in this.rowsAr) {\r\n            if (this.rowsAr[e]) {\r\n                this.rowsAr[e] = null \r\n            }\r\n        }\r\n        this.rowsCol = new dhtmlxArray();\r\n        this.rowsAr = {};\r\n        this.entBox.innerHTML = \"\";\r\n        var g = function() {}\r\n        ;\r\n        this.entBox.onclick = this.entBox.onmousedown = this.entBox.onbeforeactivate = this.entBox.onbeforedeactivate = this.entBox.onbeforedeactivate = this.entBox.onselectstart = g;\r\n        this.setSizes = this._update_srnd_view = this.callEvent = g;\r\n        this.entBox.grid = this.objBox.grid = this.hdrBox.grid = this.obj.grid = this.hdr.grid = null ;\r\n        if (this._fake) {\r\n            this.globalBox.innerHTML = \"\";\r\n            this._fake.setSizes = this._fake._update_srnd_view = this._fake.callEvent = g;\r\n            this.globalBox.onclick = this.globalBox.onmousedown = this.globalBox.onbeforeactivate = this.globalBox.onbeforedeactivate = this.globalBox.onbeforedeactivate = this.globalBox.onselectstart = g\r\n        }\r\n        for (c in this) {\r\n            if ((this[c]) && (this[c].m_obj)) {\r\n                this[c].m_obj = null \r\n            }\r\n            this[c] = null \r\n        }\r\n        if (this == globalActiveDHTMLGridObject) {\r\n            globalActiveDHTMLGridObject = null \r\n        }\r\n        return null \r\n    },\r\n    getSortingState: function() {\r\n        var a = new Array();\r\n        if (this.fldSorted) {\r\n            a[0] = this.fldSorted._cellIndex;\r\n            a[1] = (this.sortImg.className == \"dhxgrid_sort_desc\" ? \"des\" : \"asc\")\r\n        }\r\n        return a\r\n    },\r\n    enableAutoHeight: function(e, c, a) {\r\n        this._ahgr = dhx4.s2b(e);\r\n        this._ahgrF = dhx4.s2b(a);\r\n        this._ahgrM = c || null ;\r\n        if (arguments.length == 1) {\r\n            this.objBox.style.overflowY = e ? \"hidden\" : \"auto\"\r\n        }\r\n        if (c == \"auto\") {\r\n            this._ahgrM = null ;\r\n            this._ahgrMA = true;\r\n            this._setAutoResize()\r\n        }\r\n    },\r\n    enableStableSorting: function(a) {\r\n        this._sst = dhx4.s2b(a);\r\n        this.rowsCol.stablesort = function(l) {\r\n            var h = this.length - 1;\r\n            for (var g = 0; g < this.length - 1; g++) {\r\n                for (var e = 0; e < h; e++) {\r\n                    if (l(this[e], this[e + 1]) > 0) {\r\n                        var c = this[e];\r\n                        this[e] = this[e + 1];\r\n                        this[e + 1] = c\r\n                    }\r\n                }\r\n                h--\r\n            }\r\n        }\r\n    },\r\n    enableKeyboardSupport: function(a) {\r\n        this._htkebl = !dhx4.s2b(a)\r\n    },\r\n    enableContextMenu: function(a) {\r\n        this._ctmndx = a\r\n    },\r\n    setScrollbarWidthCorrection: function(a) {},\r\n    enableTooltips: function(c) {\r\n        this._enbTts = c.split(\",\");\r\n        for (var a = 0; a < this._enbTts.length; a++) {\r\n            this._enbTts[a] = dhx4.s2b(this._enbTts[a])\r\n        }\r\n    },\r\n    enableResizing: function(c) {\r\n        this._drsclmn = c.split(\",\");\r\n        for (var a = 0; a < this._drsclmn.length; a++) {\r\n            this._drsclmn[a] = dhx4.s2b(this._drsclmn[a])\r\n        }\r\n    },\r\n    setColumnMinWidth: function(a, c) {\r\n        if (arguments.length == 2) {\r\n            if (!this._drsclmW) {\r\n                this._drsclmW = new Array()\r\n            }\r\n            this._drsclmW[c] = a\r\n        } else {\r\n            this._drsclmW = a.split(\",\")\r\n        }\r\n    },\r\n    enableCellIds: function(a) {\r\n        this._enbCid = dhx4.s2b(a)\r\n    },\r\n    lockRow: function(a, e) {\r\n        var c = this.getRowById(a);\r\n        if (c) {\r\n            c._locked = dhx4.s2b(e);\r\n            if ((this.cell) && (this.cell.parentNode.idd == a)) {\r\n                this.editStop()\r\n            }\r\n        }\r\n    },\r\n    _getRowArray: function(h) {\r\n        var g = new Array();\r\n        for (var e = 0; e < h.childNodes.length; e++) {\r\n            var c = this.cells3(h, e);\r\n            g[e] = c.getValue()\r\n        }\r\n        return g\r\n    },\r\n    setDateFormat: function(c, a) {\r\n        this._dtmask = c;\r\n        this._dtmask_inc = a\r\n    },\r\n    setNumberFormat: function(n, e, h, m) {\r\n        var g = n.replace(/[^0\\,\\.]*/g, \"\");\r\n        var a = g.indexOf(\".\");\r\n        if (a > -1) {\r\n            a = g.length - a - 1\r\n        }\r\n        var c = g.indexOf(\",\");\r\n        if (c > -1) {\r\n            c = g.length - a - 2 - c\r\n        }\r\n        if (typeof h != \"string\") {\r\n            h = this.i18n.decimal_separator\r\n        }\r\n        if (typeof m != \"string\") {\r\n            m = this.i18n.group_separator\r\n        }\r\n        var o = n.split(g)[0];\r\n        var l = n.split(g)[1];\r\n        this._maskArr[e] = [a, c, o, l, h, m]\r\n    },\r\n    _aplNFb: function(h, g) {\r\n        var c = this._maskArr[g];\r\n        if (!c) {\r\n            return h\r\n        }\r\n        var e = parseFloat(h.toString().replace(/[^0-9]*/g, \"\"));\r\n        if (h.toString().substr(0, 1) == \"-\") {\r\n            e = e * -1\r\n        }\r\n        if (c[0] > 0) {\r\n            e = e / Math.pow(10, c[0])\r\n        }\r\n        return e\r\n    },\r\n    _aplNF: function(l, h) {\r\n        var e = this._maskArr[h];\r\n        if (!e) {\r\n            return l\r\n        }\r\n        var m = (parseFloat(l) < 0 ? \"-\" : \"\") + e[2];\r\n        l = Math.abs(Math.round(parseFloat(l) * Math.pow(10, e[0] > 0 ? e[0] : 0))).toString();\r\n        l = (l.length < e[0] ? Math.pow(10, e[0] + 1 - l.length).toString().substr(1, e[0] + 1) + l.toString() : l).split(\"\").reverse();\r\n        l[e[0]] = (l[e[0]] || \"0\") + e[4];\r\n        if (e[1] > 0) {\r\n            for (var g = (e[0] > 0 ? 0 : 1) + e[0] + e[1]; g < l.length; g += e[1]) {\r\n                l[g] += e[5]\r\n            }\r\n        }\r\n        return m + l.reverse().join(\"\") + e[3]\r\n    },\r\n    _launchCommands: function(a) {\r\n        for (var g = 0; g < a.length; g++) {\r\n            var e = new Array();\r\n            for (var c = 0; c < a[g].childNodes.length; c++) {\r\n                if (a[g].childNodes[c].nodeType == 1) {\r\n                    e[e.length] = a[g].childNodes[c].firstChild.data\r\n                }\r\n            }\r\n            this[a[g].getAttribute(\"command\")].apply(this, e)\r\n        }\r\n    },\r\n    _parseHead: function(h) {\r\n        var g = dhx4.ajax.xpath(\"./head\", h);\r\n        if (g.length) {\r\n            var l = dhx4.ajax.xpath(\"./column\", g[0]);\r\n            var m = dhx4.ajax.xpath(\"./settings\", g[0]);\r\n            var C = \"setInitWidths\";\r\n            var w = false;\r\n            if (m[0]) {\r\n                for (var n = 0; n < m[0].childNodes.length; n++) {\r\n                    switch (m[0].childNodes[n].tagName) {\r\n                    case \"colwidth\":\r\n                        if (m[0].childNodes[n].firstChild && m[0].childNodes[n].firstChild.data == \"%\") {\r\n                            C = \"setInitWidthsP\"\r\n                        }\r\n                        break;\r\n                    case \"splitat\":\r\n                        w = (m[0].childNodes[n].firstChild ? m[0].childNodes[n].firstChild.data : false);\r\n                        break\r\n                    }\r\n                }\r\n            }\r\n            this._launchCommands(dhx4.ajax.xpath(\"./beforeInit/call\", g[0]));\r\n            if (l.length > 0) {\r\n                if (this.hdr.rows.length > 0) {\r\n                    this.clearAll(true)\r\n                }\r\n                var a = [[], [], [], [], [], [], [], [], []];\r\n                var v = [\"\", \"width\", \"type\", \"align\", \"sort\", \"color\", \"format\", \"hidden\", \"id\"];\r\n                var u = [\"\", C, \"setColTypes\", \"setColAlign\", \"setColSorting\", \"setColumnColor\", \"\", \"\", \"setColumnIds\"];\r\n                for (var A = 0; A < l.length; A++) {\r\n                    for (var y = 1; y < v.length; y++) {\r\n                        a[y].push(l[A].getAttribute(v[y]))\r\n                    }\r\n                    a[0].push((l[A].firstChild ? l[A].firstChild.data : \"\").replace(/^\\s*((\\s\\S)*.+)\\s*$/gi, \"$1\"))\r\n                }\r\n                this.setHeader(a[0]);\r\n                for (var A = 0; A < u.length; A++) {\r\n                    if (u[A]) {\r\n                        this[u[A]](a[A].join(this.delim))\r\n                    }\r\n                }\r\n                for (var A = 0; A < l.length; A++) {\r\n                    if ((this.cellType[A].indexOf(\"co\") == 0) || (this.cellType[A] == \"clist\")) {\r\n                        var o = dhx4.ajax.xpath(\"./option\", l[A]);\r\n                        if (o.length) {\r\n                            var x = new Array();\r\n                            if (this.cellType[A] == \"clist\") {\r\n                                for (var y = 0; y < o.length; y++) {\r\n                                    x[x.length] = o[y].firstChild ? o[y].firstChild.data : \"\"\r\n                                }\r\n                                this.registerCList(A, x)\r\n                            } else {\r\n                                var D = this.getCombo(A);\r\n                                for (var y = 0; y < o.length; y++) {\r\n                                    D.put(o[y].getAttribute(\"value\"), o[y].firstChild ? o[y].firstChild.data : \"\")\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (a[6][A]) {\r\n                            if ((this.cellType[A].toLowerCase().indexOf(\"calendar\") != -1) || (this.fldSort[A] == \"date\")) {\r\n                                this.setDateFormat(a[6][A])\r\n                            } else {\r\n                                this.setNumberFormat(a[6][A], A)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                this.init();\r\n                var e = a[7].join(this.delim);\r\n                if (this.setColHidden && e.replace(/,/g, \"\") != \"\") {\r\n                    this.setColHidden(e)\r\n                }\r\n                if ((w) && (this.splitAt)) {\r\n                    this.splitAt(w)\r\n                }\r\n            }\r\n            this._launchCommands(dhx4.ajax.xpath(\"./afterInit/call\", g[0]))\r\n        }\r\n        var c = dhx4.ajax.xpath(\"//rows/userdata\", h);\r\n        if (c.length > 0) {\r\n            if (!this.UserData.gridglobaluserdata) {\r\n                this.UserData.gridglobaluserdata = new Hashtable()\r\n            }\r\n            for (var y = 0; y < c.length; y++) {\r\n                var E = \"\";\r\n                for (var r = 0; r < c[y].childNodes.length; r++) {\r\n                    E += c[y].childNodes[r].nodeValue\r\n                }\r\n                this.UserData.gridglobaluserdata.put(c[y].getAttribute(\"name\"), E)\r\n            }\r\n        }\r\n    },\r\n    getCheckedRows: function(a) {\r\n        var c = new Array();\r\n        this.forEachRowA(function(g) {\r\n            var e = this.cells(g, a);\r\n            if (e.changeState && e.getValue() != 0) {\r\n                c.push(g)\r\n            }\r\n        }, true);\r\n        return c.join(\",\")\r\n    },\r\n    checkAll: function() {\r\n        var c = arguments.length ? arguments[0] : 1;\r\n        for (var a = 0; a < this.getColumnsNum(); a++) {\r\n            if (this.getColType(a) == \"ch\") {\r\n                this.setCheckedRows(a, c)\r\n            }\r\n        }\r\n    },\r\n    uncheckAll: function() {\r\n        this.checkAll(0)\r\n    },\r\n    setCheckedRows: function(c, a) {\r\n        this.forEachRowA(function(e) {\r\n            if (this.cells(e, c).isCheckbox()) {\r\n                this.cells(e, c).setValue(a)\r\n            }\r\n        })\r\n    },\r\n    _drawTooltip: function(l) {\r\n        var m = this.grid.getFirstParentOfType(l ? l.target : event.srcElement, \"TD\");\r\n        if (!m || ((this.grid.editor) && (this.grid.editor.cell == m))) {\r\n            return true\r\n        }\r\n        var h = m.parentNode;\r\n        if (!h.idd || h.idd == \"__filler__\") {\r\n            return\r\n        }\r\n        var g = (l ? l.target : event.srcElement);\r\n        if (h.idd == window.unknown) {\r\n            return true\r\n        }\r\n        if (!this.grid.callEvent(\"onMouseOver\", [h.idd, m._cellIndex, (l || window.event)])) {\r\n            return true\r\n        }\r\n        if ((this.grid._enbTts) && (!this.grid._enbTts[m._cellIndex])) {\r\n            if (g.title) {\r\n                g.title = \"\"\r\n            }\r\n            return true\r\n        }\r\n        if (m._cellIndex >= this.grid._cCount) {\r\n            return\r\n        }\r\n        var a = this.grid.cells3(h, m._cellIndex);\r\n        if (!a || !a.cell || !a.cell._attrs) {\r\n            return\r\n        }\r\n        if (g._title) {\r\n            a.cell.title = \"\"\r\n        }\r\n        if (!a.cell._attrs.title) {\r\n            g._title = true\r\n        }\r\n        if (a) {\r\n            g.title = a.cell._attrs.title || (a.getTitle ? a.getTitle() : (a.getValue() || \"\").toString().replace(/<[^>]*>/gi, \"\"))\r\n        }\r\n        return true\r\n    },\r\n    enableCellWidthCorrection: function(a) {\r\n        if (_isFF) {\r\n            this._wcorr = parseInt(a)\r\n        }\r\n    },\r\n    getAllRowIds: function(e) {\r\n        var a = [];\r\n        for (var c = 0; c < this.rowsBuffer.length; c++) {\r\n            if (this.rowsBuffer[c]) {\r\n                a.push(this.rowsBuffer[c].idd)\r\n            }\r\n        }\r\n        return a.join(e || this.delim)\r\n    },\r\n    getAllItemIds: function() {\r\n        return this.getAllRowIds()\r\n    },\r\n    setColspan: function(e, x, g) {\r\n        if (!this._ecspn) {\r\n            return\r\n        }\r\n        var a = this.getRowById(e);\r\n        if ((a._childIndexes) && (a.childNodes[a._childIndexes[x]])) {\r\n            var o = a._childIndexes[x];\r\n            var h = a.childNodes[o];\r\n            var l = h.colSpan;\r\n            h.colSpan = 1;\r\n            if ((l) && (l != 1)) {\r\n                for (var u = 1; u < l; u++) {\r\n                    var w = document.createElement(\"TD\");\r\n                    if (h.nextSibling) {\r\n                        a.insertBefore(w, h.nextSibling)\r\n                    } else {\r\n                        a.appendChild(w)\r\n                    }\r\n                    a._childIndexes[x + u] = o + u;\r\n                    w._cellIndex = x + u;\r\n                    w.style.textAlign = this.cellAlign[u];\r\n                    w.style.verticalAlign = this.cellVAlign[u];\r\n                    h = w;\r\n                    this.cells3(a, x + u).setValue(\"\")\r\n                }\r\n            }\r\n            for (var v = x * 1 + 1 * l; v < a._childIndexes.length; v++) {\r\n                a._childIndexes[v] += (l - 1) * 1\r\n            }\r\n        }\r\n        if ((g) && (g > 1)) {\r\n            if (a._childIndexes) {\r\n                var o = a._childIndexes[x]\r\n            } else {\r\n                var o = x;\r\n                a._childIndexes = new Array();\r\n                for (var v = 0; v < a.childNodes.length; v++) {\r\n                    a._childIndexes[v] = v\r\n                }\r\n            }\r\n            a.childNodes[o].colSpan = g;\r\n            for (var v = 1; v < g; v++) {\r\n                a._childIndexes[a.childNodes[o + 1]._cellIndex] = o;\r\n                a.removeChild(a.childNodes[o + 1])\r\n            }\r\n            var s = a.childNodes[a._childIndexes[x]]._cellIndex;\r\n            for (var v = s * 1 + 1 * g; v < a._childIndexes.length; v++) {\r\n                a._childIndexes[v] -= (g - 1)\r\n            }\r\n        }\r\n    },\r\n    preventIECaching: function(a) {\r\n        dhx4.ajax.cache = !a\r\n    },\r\n    enableColumnAutoSize: function(a) {\r\n        this._eCAS = dhx4.s2b(a)\r\n    },\r\n    _onHeaderDblClick: function(g) {\r\n        var c = this.grid;\r\n        var a = c.getFirstParentOfType(_isIE ? event.srcElement : g.target, \"TD\");\r\n        if (!c._eCAS) {\r\n            return false\r\n        }\r\n        c.adjustColumnSize(a._cellIndexS)\r\n    },\r\n    adjustColumnSize: function(o, c) {\r\n        if (this._hrrar && this._hrrar[o]) {\r\n            return\r\n        }\r\n        this._notresize = true;\r\n        var e = 0;\r\n        this._setColumnSizeR(o, 20);\r\n        for (var h = 1; h < this.hdr.rows.length; h++) {\r\n            var s = this.hdr.rows[h];\r\n            s = s.childNodes[(s._childIndexes) ? s._childIndexes[o] : o];\r\n            if ((s) && ((!s.colSpan) || (s.colSpan < 2)) && s._cellIndex == o) {\r\n                if ((s.childNodes[0]) && (s.childNodes[0].className == \"hdrcell\")) {\r\n                    s = s.childNodes[0]\r\n                }\r\n                e = Math.max(e, s.scrollWidth)\r\n            }\r\n        }\r\n        var g = this.obj.rows.length;\r\n        var r = 0;\r\n        var v = this.cellType._dhx_find(\"tree\");\r\n        for (var n = 1; n < g; n++) {\r\n            var u = this.obj.rows[n];\r\n            if (!this.rowsAr[u.idd]) {\r\n                continue\r\n            }\r\n            if (u._childIndexes && u._childIndexes[o] != o || !u.childNodes[o]) {\r\n                continue\r\n            }\r\n            r = (u.childNodes[o].innerText || u.childNodes[o].textContent || \"\").length * this.fontWidth;\r\n            if (this._h2 && o == v) {\r\n                r += this._h2.get[u.idd].level * 22\r\n            }\r\n            if (r > e) {\r\n                e = r\r\n            }\r\n        }\r\n        e += 20 + (c || 0);\r\n        this._setColumnSizeR(o, e);\r\n        this._notresize = false;\r\n        this.setSizes()\r\n    },\r\n    detachHeader: function(a, e) {\r\n        e = e || this.hdr;\r\n        var c = e.rows[a + 1];\r\n        if (c) {\r\n            c.parentNode.removeChild(c)\r\n        }\r\n        this.setSizes()\r\n    },\r\n    detachFooter: function(a) {\r\n        this.detachHeader(a, this.ftr)\r\n    },\r\n    attachHeader: function(a, g, c) {\r\n        if (typeof (a) == \"string\") {\r\n            a = this._eSplit(a)\r\n        }\r\n        if (typeof (g) == \"string\") {\r\n            g = g.split(this.delim)\r\n        }\r\n        c = c || \"_aHead\";\r\n        if (this.hdr.rows.length) {\r\n            if (a) {\r\n                this._createHRow([a, g], this[(c == \"_aHead\") ? \"hdr\" : \"ftr\"])\r\n            } else {\r\n                if (this[c]) {\r\n                    for (var e = 0; e < this[c].length; e++) {\r\n                        this.attachHeader.apply(this, this[c][e])\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (!this[c]) {\r\n                this[c] = new Array()\r\n            }\r\n            this[c][this[c].length] = [a, g, c]\r\n        }\r\n    },\r\n    _createHRow: function(e, r) {\r\n        if (!r) {\r\n            if (this.entBox.style.position != \"absolute\") {\r\n                this.entBox.style.position = \"relative\"\r\n            }\r\n            var m = document.createElement(\"DIV\");\r\n            m.className = \"c_ftr\".substr(2);\r\n            this.entBox.appendChild(m);\r\n            var v = document.createElement(\"TABLE\");\r\n            v.cellPadding = v.cellSpacing = 0;\r\n            if (!_isIE || _isIE == 8) {\r\n                v.width = \"100%\";\r\n                v.style.paddingRight = \"20px\"\r\n            }\r\n            v.style.marginRight = \"20px\";\r\n            v.style.tableLayout = \"fixed\";\r\n            m.appendChild(v);\r\n            v.appendChild(document.createElement(\"TBODY\"));\r\n            this.ftr = r = v;\r\n            var l = v.insertRow(0);\r\n            var a = ((this.hdrLabels.length <= 1) ? e[0].length : this.hdrLabels.length);\r\n            for (var g = 0; g < a; g++) {\r\n                l.appendChild(document.createElement(\"TH\"));\r\n                l.childNodes[g]._cellIndex = g\r\n            }\r\n            if (_isIE && _isIE < 8) {\r\n                l.style.position = \"absolute\"\r\n            } else {\r\n                l.style.height = \"auto\"\r\n            }\r\n        }\r\n        var h = e[1];\r\n        var m = document.createElement(\"TR\");\r\n        r.rows[0].parentNode.appendChild(m);\r\n        for (var g = 0; g < e[0].length; g++) {\r\n            if (e[0][g] == \"#cspan\") {\r\n                var n = m.cells[m.cells.length - 1];\r\n                n.colSpan = (n.colSpan || 1) + 1;\r\n                continue\r\n            }\r\n            if ((e[0][g] == \"#rspan\") && (r.rows.length > 1)) {\r\n                var y = r.rows.length - 2;\r\n                var x = false;\r\n                var n = null ;\r\n                while (!x) {\r\n                    var n = r.rows[y];\r\n                    for (var c = 0; c < n.cells.length; c++) {\r\n                        if (n.cells[c]._cellIndex == g) {\r\n                            x = c + 1;\r\n                            break\r\n                        }\r\n                    }\r\n                    y--\r\n                }\r\n                n = n.cells[x - 1];\r\n                n.rowSpan = (n.rowSpan || 1) + 1;\r\n                continue\r\n            }\r\n            var o = document.createElement(\"TD\");\r\n            o._cellIndex = o._cellIndexS = g;\r\n            if (this._hrrar && this._hrrar[g] && !_isIE) {\r\n                o.style.display = \"none\"\r\n            }\r\n            if (typeof e[0][g] == \"object\") {\r\n                o.appendChild(e[0][g])\r\n            } else {\r\n                if (this.forceDivInHeader) {\r\n                    o.innerHTML = \"<div class='hdrcell'>\" + (e[0][g] || \"&nbsp;\") + \"</div>\"\r\n                } else {\r\n                    o.innerHTML = (e[0][g] || \"&nbsp;\")\r\n                }\r\n                if ((e[0][g] || \"\").indexOf(\"#\") != -1) {\r\n                    var v = e[0][g].match(/(^|{)#([^}]+)(}|$)/);\r\n                    if (v) {\r\n                        var s = \"_in_header_\" + v[2];\r\n                        if (this[s]) {\r\n                            this[s]((this.forceDivInHeader ? o.firstChild : o), g, e[0][g].split(v[0]))\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (h) {\r\n                o.style.cssText = h[g]\r\n            }\r\n            m.appendChild(o)\r\n        }\r\n        var u = r;\r\n        if (_isKHTML) {\r\n            if (r._kTimer) {\r\n                window.clearTimeout(r._kTimer)\r\n            }\r\n            r._kTimer = window.setTimeout(function() {\r\n                r.rows[1].style.display = \"none\";\r\n                window.setTimeout(function() {\r\n                    r.rows[1].style.display = \"\"\r\n                }, 1)\r\n            }, 500)\r\n        }\r\n    },\r\n    attachFooter: function(a, c) {\r\n        this.attachHeader(a, c, \"_aFoot\")\r\n    },\r\n    setCellExcellType: function(e, a, c) {\r\n        this.changeCellType(this.getRowById(e), a, c)\r\n    },\r\n    changeCellType: function(e, g, c) {\r\n        c = c || this.cellType[g];\r\n        var h = this.cells3(e, g);\r\n        var a = h.getValue();\r\n        h.cell._cellType = c;\r\n        var h = this.cells3(e, g);\r\n        h.setValue(a)\r\n    },\r\n    setRowExcellType: function(e, c) {\r\n        var g = this.rowsAr[e];\r\n        for (var a = 0; a < g.childNodes.length; a++) {\r\n            this.changeCellType(g, a, c)\r\n        }\r\n    },\r\n    setColumnExcellType: function(a, e) {\r\n        for (var c = 0; c < this.rowsBuffer.length; c++) {\r\n            if (this.rowsBuffer[c] && this.rowsBuffer[c].tagName == \"TR\") {\r\n                this.changeCellType(this.rowsBuffer[c], a, e)\r\n            }\r\n        }\r\n        if (this.cellType[a] == \"math\") {\r\n            this._strangeParams[c] = e\r\n        } else {\r\n            this.cellType[a] = e\r\n        }\r\n    },\r\n    forEachRow: function(e) {\r\n        for (var c in this.rowsAr) {\r\n            if (this.rowsAr[c] && this.rowsAr[c].idd) {\r\n                e.apply(this, [this.rowsAr[c].idd])\r\n            }\r\n        }\r\n    },\r\n    forEachRowA: function(e) {\r\n        for (var c = 0; c < this.rowsBuffer.length; c++) {\r\n            if (this.rowsBuffer[c]) {\r\n                e.call(this, this.render_row(c).idd)\r\n            }\r\n        }\r\n    },\r\n    forEachCell: function(e, c) {\r\n        var g = this.getRowById(e);\r\n        if (!g) {\r\n            return\r\n        }\r\n        for (var a = 0; a < this._cCount; a++) {\r\n            c(this.cells3(g, a), a)\r\n        }\r\n    },\r\n    enableAutoWidth: function(e, a, c) {\r\n        this._awdth = [dhx4.s2b(e), parseInt(a || 99999), parseInt(c || 0)];\r\n        if (arguments.length == 1) {\r\n            this.objBox.style.overflowX = e ? \"hidden\" : \"auto\"\r\n        }\r\n    },\r\n    updateFromXML: function(a, g, c, e) {\r\n        if (typeof g == \"undefined\") {\r\n            g = true\r\n        }\r\n        this._refresh_mode = [true, g, c];\r\n        this.load(a, e)\r\n    },\r\n    _refreshFromXML: function(g) {\r\n        if (this._f_rowsBuffer) {\r\n            this.filterBy(0, \"\")\r\n        }\r\n        reset = false;\r\n        if (window.eXcell_tree) {\r\n            eXcell_tree.prototype.setValueX = eXcell_tree.prototype.setValue;\r\n            eXcell_tree.prototype.setValue = function(v) {\r\n                var u = this.grid._h2.get[this.cell.parentNode.idd];\r\n                if (u && this.cell.parentNode.valTag) {\r\n                    this.setLabel(v)\r\n                } else {\r\n                    this.setValueX(v)\r\n                }\r\n            }\r\n        }\r\n        var s = this.cellType._dhx_find(\"tree\");\r\n        var l = dhx4.ajax.xmltop(\"rows\", g);\r\n        var h = l.getAttribute(\"parent\") || 0;\r\n        var n = {};\r\n        if (this._refresh_mode[2]) {\r\n            if (s != -1) {\r\n                this._h2.forEachChild(h, function(u) {\r\n                    n[u.id] = true\r\n                }, this)\r\n            } else {\r\n                this.forEachRow(function(u) {\r\n                    n[u] = true\r\n                })\r\n            }\r\n        }\r\n        var r = dhx4.ajax.xpath(\"//row\", l);\r\n        for (var e = 0; e < r.length; e++) {\r\n            var o = r[e];\r\n            var a = o.getAttribute(\"id\");\r\n            n[a] = false;\r\n            var h = o.parentNode.getAttribute(\"id\") || h;\r\n            if (this.rowsAr[a] && this.rowsAr[a].tagName != \"TR\") {\r\n                if (this._h2) {\r\n                    this._h2.get[a].buff.data = o\r\n                } else {\r\n                    this.rowsBuffer[this.getRowIndex(a)].data = o\r\n                }\r\n                this.rowsAr[a] = o\r\n            } else {\r\n                if (this.rowsAr[a]) {\r\n                    this._process_xml_row(this.rowsAr[a], o, -1);\r\n                    this._postRowProcessing(this.rowsAr[a], true);\r\n                    if (this._fake && this._fake.rowsAr[a]) {\r\n                        this._fake._process_xml_row(this._fake.rowsAr[a], o, -1)\r\n                    }\r\n                } else {\r\n                    if (this._refresh_mode[1]) {\r\n                        var m = {\r\n                            idd: a,\r\n                            data: o,\r\n                            _parser: this._process_xml_row,\r\n                            _locator: this._get_xml_data\r\n                        };\r\n                        var c = this.rowsBuffer.length;\r\n                        if (this._refresh_mode[1] == \"top\") {\r\n                            this.rowsBuffer.unshift(m);\r\n                            c = 0\r\n                        } else {\r\n                            this.rowsBuffer.push(m)\r\n                        }\r\n                        if (this._h2) {\r\n                            reset = true;\r\n                            (this._h2.add(a, (o.parentNode.getAttribute(\"id\") || o.parentNode.getAttribute(\"parent\")))).buff = this.rowsBuffer[this.rowsBuffer.length - 1]\r\n                        } else {\r\n                            if (this._srnd) {\r\n                                reset = true\r\n                            }\r\n                        }\r\n                        this.rowsAr[a] = o;\r\n                        o = this.render_row(c);\r\n                        this._insertRowAt(o, c ? -1 : 0)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (this._refresh_mode[2]) {\r\n            for (a in n) {\r\n                if (n[a] && this.rowsAr[a]) {\r\n                    this.deleteRow(a)\r\n                }\r\n            }\r\n        }\r\n        this._refresh_mode = null ;\r\n        if (window.eXcell_tree) {\r\n            eXcell_tree.prototype.setValue = eXcell_tree.prototype.setValueX\r\n        }\r\n        if (reset) {\r\n            if (this._h2) {\r\n                this._renderSort()\r\n            } else {\r\n                this.render_dataset()\r\n            }\r\n        }\r\n        if (this._f_rowsBuffer) {\r\n            this._f_rowsBuffer = null ;\r\n            this.filterByAll()\r\n        }\r\n    },\r\n    getCustomCombo: function(e, c) {\r\n        var a = this.cells(e, c).cell;\r\n        if (!a._combo) {\r\n            a._combo = new dhtmlXGridComboObject()\r\n        }\r\n        return a._combo\r\n    },\r\n    setTabOrder: function(c) {\r\n        var g = c.split(this.delim);\r\n        this._tabOrder = [];\r\n        var a = this._cCount || c.length;\r\n        for (var e = 0; e < a; e++) {\r\n            g[e] = {\r\n                c: parseInt(g[e]),\r\n                ind: e\r\n            }\r\n        }\r\n        g.sort(function(l, h) {\r\n            return ( l.c > h.c ? 1 : -1) \r\n        });\r\n        for (var e = 0; e < a; e++) {\r\n            if (!g[e + 1] || (typeof g[e].c == \"undefined\")) {\r\n                this._tabOrder[g[e].ind] = (g[0].ind + 1) * -1\r\n            } else {\r\n                this._tabOrder[g[e].ind] = g[e + 1].ind\r\n            }\r\n        }\r\n    },\r\n    i18n: {\r\n        loading: \"Loading\",\r\n        decimal_separator: \".\",\r\n        group_separator: \",\"\r\n    },\r\n    _key_events: {\r\n        k13_1_0: function() {\r\n            var a = this.rowsCol._dhx_find(this.row);\r\n            this.selectCell(this.rowsCol[a + 1], this.cell._cellIndex, true)\r\n        },\r\n        k13_0_1: function() {\r\n            var a = this.rowsCol._dhx_find(this.row);\r\n            this.selectCell(this.rowsCol[a - 1], this.cell._cellIndex, true)\r\n        },\r\n        k13_0_0: function() {\r\n            this.editStop();\r\n            this.callEvent(\"onEnter\", [(this.row ? this.row.idd : null ), (this.cell ? this.cell._cellIndex : null )]);\r\n            this._still_active = true\r\n        },\r\n        k9_0_0: function() {\r\n            this.editStop();\r\n            if (!this.callEvent(\"onTab\", [true])) {\r\n                return true\r\n            }\r\n            var a = this._getNextCell(null , 1);\r\n            if (a) {\r\n                this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);\r\n                this._still_active = true\r\n            }\r\n        },\r\n        k9_0_1: function() {\r\n            this.editStop();\r\n            if (!this.callEvent(\"onTab\", [false])) {\r\n                return false\r\n            }\r\n            var a = this._getNextCell(null , -1);\r\n            if (a) {\r\n                this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);\r\n                this._still_active = true\r\n            }\r\n        },\r\n        k113_0_0: function() {\r\n            if (this._f2kE) {\r\n                this.editCell()\r\n            }\r\n        },\r\n        k32_0_0: function() {\r\n            var a = this.cells4(this.cell);\r\n            if (!a.changeState || (a.changeState() === false)) {\r\n                return false\r\n            }\r\n        },\r\n        k27_0_0: function() {\r\n            this.editStop(true)\r\n        },\r\n        k33_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage - 1)\r\n            } else {\r\n                this.scrollPage(-1)\r\n            }\r\n        },\r\n        k34_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage + 1)\r\n            } else {\r\n                this.scrollPage(1)\r\n            }\r\n        },\r\n        k37_0_0: function() {\r\n            if (!this.editor && this.isTreeGrid()) {\r\n                this.collapseKids(this.row)\r\n            } else {\r\n                return false\r\n            }\r\n        },\r\n        k39_0_0: function() {\r\n            if (!this.editor && this.isTreeGrid()) {\r\n                this.expandKids(this.row)\r\n            } else {\r\n                return false\r\n            }\r\n        },\r\n        k40_0_0: function() {\r\n            var c = this._realfake ? this._fake : this;\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftNext()\r\n            } else {\r\n                if (!this.row.idd) {\r\n                    return\r\n                }\r\n                var a = Math.max((c._r_select || 0), this.getRowIndex(this.row.idd));\r\n                var e = this._nextRow(a, 1);\r\n                if (e) {\r\n                    c._r_select = null ;\r\n                    this.selectCell(e, this.cell._cellIndex, true);\r\n                    if (c.pagingOn) {\r\n                        c.showRow(e.idd)\r\n                    }\r\n                } else {\r\n                    if (!this.callEvent(\"onLastRow\", [])) {\r\n                        return false\r\n                    }\r\n                    this._key_events.k34_0_0.apply(this, []);\r\n                    if (this.pagingOn && this.rowsCol[a + 1]) {\r\n                        this.selectCell(a + 1, 0, true)\r\n                    }\r\n                }\r\n            }\r\n            this._still_active = true\r\n        },\r\n        k38_0_0: function() {\r\n            var c = this._realfake ? this._fake : this;\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftPrev()\r\n            } else {\r\n                if (!this.row.idd) {\r\n                    return\r\n                }\r\n                var a = this.getRowIndex(this.row.idd) + 1;\r\n                if (a != -1 && (!this.pagingOn || (a != 1))) {\r\n                    var e = this._nextRow(a - 1, -1);\r\n                    this.selectCell(e, this.cell._cellIndex, true);\r\n                    if (c.pagingOn && e) {\r\n                        c.showRow(e.idd)\r\n                    }\r\n                } else {\r\n                    this._key_events.k33_0_0.apply(this, [])\r\n                }\r\n            }\r\n            this._still_active = true\r\n        }\r\n    },\r\n    _build_master_row: function() {\r\n        var e = document.createElement(\"DIV\");\r\n        var c = [\"<table><tr>\"];\r\n        for (var a = 0; a < this._cCount; a++) {\r\n            c.push(\"<td></td>\")\r\n        }\r\n        c.push(\"</tr></table>\");\r\n        e.innerHTML = c.join(\"\");\r\n        this._master_row = e.firstChild.rows[0]\r\n    },\r\n    _prepareRow: function(a) {\r\n        if (!this._master_row) {\r\n            this._build_master_row()\r\n        }\r\n        var e = this._master_row.cloneNode(true);\r\n        for (var c = 0; c < e.childNodes.length; c++) {\r\n            e.childNodes[c]._cellIndex = c;\r\n            if (this._enbCid) {\r\n                e.childNodes[c].id = \"c_\" + a + \"_\" + c\r\n            }\r\n            if (this.dragAndDropOff) {\r\n                this.dragger.addDraggableItem(e.childNodes[c], this)\r\n            }\r\n        }\r\n        e.idd = a;\r\n        e.grid = this;\r\n        return e\r\n    },\r\n    _process_jsarray_row: function(c, e) {\r\n        c._attrs = {};\r\n        for (var a = 0; a < c.childNodes.length; a++) {\r\n            c.childNodes[a]._attrs = {}\r\n        }\r\n        this._fillRow(c, (this._c_order ? this._swapColumns(e) : e));\r\n        return c\r\n    },\r\n    _get_jsarray_data: function(c, a) {\r\n        return c[a]\r\n    },\r\n    _process_json_row: function(a, c) {\r\n        c = this._c_order ? this._swapColumns(c.data) : c.data;\r\n        return this._process_some_row(a, c)\r\n    },\r\n    _process_some_row: function(c, e) {\r\n        c._attrs = {};\r\n        for (var a = 0; a < c.childNodes.length; a++) {\r\n            c.childNodes[a]._attrs = {}\r\n        }\r\n        this._fillRow(c, e);\r\n        return c\r\n    },\r\n    _get_json_data: function(c, a) {\r\n        return c.data[a]\r\n    },\r\n    _process_js_row: function(e, g) {\r\n        var a = [];\r\n        for (var c = 0; c < this.columnIds.length; c++) {\r\n            a[c] = g[this.columnIds[c]];\r\n            if (!a[c] && a[c] !== 0) {\r\n                a[c] = \"\"\r\n            }\r\n        }\r\n        this._process_some_row(e, a);\r\n        e._attrs = g;\r\n        return e\r\n    },\r\n    _get_js_data: function(c, a) {\r\n        return c[this.columnIds[a]]\r\n    },\r\n    _process_csv_row: function(c, e) {\r\n        c._attrs = {};\r\n        for (var a = 0; a < c.childNodes.length; a++) {\r\n            c.childNodes[a]._attrs = {}\r\n        }\r\n        this._fillRow(c, (this._c_order ? this._swapColumns(e.split(this.csv.cell)) : e.split(this.csv.cell)));\r\n        return c\r\n    },\r\n    _get_csv_data: function(c, a) {\r\n        return c.split(this.csv.cell)[a]\r\n    },\r\n    _process_store_row: function(h, g) {\r\n        var a = [];\r\n        for (var e = 0; e < this.columnIds.length; e++) {\r\n            a[e] = g[this.columnIds[e]]\r\n        }\r\n        for (var c = 0; c < h.childNodes.length; c++) {\r\n            h.childNodes[c]._attrs = {}\r\n        }\r\n        h._attrs = g;\r\n        this._fillRow(h, a)\r\n    },\r\n    _process_xml_row: function(a, l) {\r\n        var u = dhx4.ajax.xpath(this.xml.cell, l);\r\n        var o = [];\r\n        a._attrs = this._xml_attrs(l);\r\n        if (this._ud_enabled) {\r\n            var s = dhx4.ajax.xpath(\"./userdata\", l);\r\n            for (var h = s.length - 1; h >= 0; h--) {\r\n                var n = \"\";\r\n                for (var e = 0; e < s[h].childNodes.length; e++) {\r\n                    n += s[h].childNodes[e].nodeValue\r\n                }\r\n                this.setUserData(a.idd, s[h].getAttribute(\"name\"), n)\r\n            }\r\n        }\r\n        for (var e = 0; e < u.length; e++) {\r\n            var g = u[this._c_order ? this._c_order[e] : e];\r\n            if (!g) {\r\n                continue\r\n            }\r\n            var c = a._childIndexes ? a._childIndexes[e] : e;\r\n            var m = g.getAttribute(\"type\");\r\n            if (a.childNodes[c]) {\r\n                if (m) {\r\n                    a.childNodes[c]._cellType = m\r\n                }\r\n                a.childNodes[c]._attrs = this._xml_attrs(g)\r\n            }\r\n            if (!g.getAttribute(\"xmlcontent\")) {\r\n                if (g.firstChild) {\r\n                    g = g.firstChild.wholeText || g.firstChild.data\r\n                } else {\r\n                    g = \"\"\r\n                }\r\n            }\r\n            o.push(g)\r\n        }\r\n        for (e < u.length; e < a.childNodes.length; e++) {\r\n            a.childNodes[e]._attrs = {}\r\n        }\r\n        if (a.parentNode && a.parentNode.tagName == \"row\") {\r\n            a._attrs.parent = a.parentNode.getAttribute(\"idd\")\r\n        }\r\n        this._fillRow(a, o);\r\n        return a\r\n    },\r\n    _get_xml_data: function(c, a) {\r\n        c = c.firstChild;\r\n        while (true) {\r\n            if (!c) {\r\n                return \"\"\r\n            }\r\n            if (c.tagName == \"cell\") {\r\n                a--\r\n            }\r\n            if (a < 0) {\r\n                break\r\n            }\r\n            c = c.nextSibling\r\n        }\r\n        return ( c.firstChild ? c.firstChild.data : \"\") \r\n    },\r\n    _fillRow: function(g, l) {\r\n        if (this.editor && this.editor.parentNode && this.editor.parentNode.idd == g.idd) {\r\n            this.editStop()\r\n        }\r\n        for (var c = 0; c < g.childNodes.length; c++) {\r\n            if ((c < l.length) || (this.defVal[c])) {\r\n                var e = g.childNodes[c]._cellIndex;\r\n                var h = l[e];\r\n                var a = this.cells4(g.childNodes[c]);\r\n                if ((this.defVal[e]) && ((h == \"\") || (typeof (h) == \"undefined\"))) {\r\n                    h = this.defVal[e]\r\n                }\r\n                if (a) {\r\n                    a.setValue(h)\r\n                }\r\n            } else {\r\n                g.childNodes[c].innerHTML = \"&nbsp;\";\r\n                g.childNodes[c]._clearCell = true\r\n            }\r\n        }\r\n        return g\r\n    },\r\n    _postRowProcessing: function(l, n) {\r\n        if (l._attrs[\"class\"]) {\r\n            l._css = l.className = l._attrs[\"class\"]\r\n        }\r\n        if (l._attrs.locked) {\r\n            l._locked = true\r\n        }\r\n        if (l._attrs.bgColor) {\r\n            l.bgColor = l._attrs.bgColor\r\n        }\r\n        var m = 0;\r\n        for (var e = 0; e < l.childNodes.length; e++) {\r\n            var o = l.childNodes[e];\r\n            var h = o._cellIndex;\r\n            var g = o._attrs.style || l._attrs.style;\r\n            if (g) {\r\n                o.style.cssText += \";\" + g\r\n            }\r\n            if (o._attrs[\"class\"]) {\r\n                o.className = o._attrs[\"class\"]\r\n            }\r\n            g = o._attrs.align || this.cellAlign[h];\r\n            if (g) {\r\n                o.align = g\r\n            }\r\n            o.vAlign = o._attrs.valign || this.cellVAlign[h];\r\n            var a = o._attrs.bgColor || this.columnColor[h];\r\n            if (a) {\r\n                o.bgColor = a\r\n            }\r\n            if (o._attrs.colspan && !n) {\r\n                this.setColspan(l.idd, e + m, o._attrs.colspan);\r\n                m += (o._attrs.colspan - 1)\r\n            }\r\n            if (this._hrrar && this._hrrar[h] && !n) {\r\n                o.style.display = \"none\"\r\n            }\r\n        }\r\n        this.callEvent(\"onRowCreated\", [l.idd, l, null ])\r\n    },\r\n    load: function(a, e, c) {\r\n        this.callEvent(\"onXLS\", [this]);\r\n        if (arguments.length == 2 && typeof e != \"function\") {\r\n            c = e;\r\n            e = null \r\n        }\r\n        c = c || \"xml\";\r\n        if (!this.xmlFileUrl) {\r\n            this.xmlFileUrl = a\r\n        }\r\n        this._data_type = c;\r\n        this.xmlLoader = this.doLoadDetails;\r\n        var g = this;\r\n        this.xmlLoader = function(h) {\r\n            if (!g.callEvent) {\r\n                return\r\n            }\r\n            g[\"_process_\" + c](h.xmlDoc);\r\n            if (!g._contextCallTimer) {\r\n                g.callEvent(\"onXLE\", [g, 0, 0, h.xmlDoc])\r\n            }\r\n            if (e) {\r\n                e();\r\n                e = null \r\n            }\r\n        }\r\n        ;\r\n        return dhx4.ajax.get(a, this.xmlLoader)\r\n    },\r\n    loadXMLString: function(c, a) {\r\n        if (window.console && window.console.info) {\r\n            window.console.info(\"loadXMLString was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n        }\r\n        this.parse({\r\n            responseXML: dhx4.ajax.parse(c)\r\n        }, a, \"xml\")\r\n    },\r\n    loadXML: function(a, c) {\r\n        if (window.console && window.console.info) {\r\n            window.console.info(\"loadXML was deprecated\", \"http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44\")\r\n        }\r\n        this.load(a, c, \"xml\")\r\n    },\r\n    parse: function(e, c, a) {\r\n        if (arguments.length == 2 && typeof c != \"function\") {\r\n            a = c;\r\n            c = null \r\n        }\r\n        a = a || \"xml\";\r\n        this._data_type = a;\r\n        if (a == \"xml\" && typeof e == \"string\") {\r\n            e = {\r\n                responseXML: dhx4.ajax.parse(e)\r\n            }\r\n        }\r\n        this[\"_process_\" + a](e);\r\n        if (!this._contextCallTimer) {\r\n            this.callEvent(\"onXLE\", [this, 0, 0, e])\r\n        }\r\n        if (c) {\r\n            c()\r\n        }\r\n    },\r\n    xml: {\r\n        top: \"rows\",\r\n        row: \"./row\",\r\n        cell: \"./cell\",\r\n        s_row: \"row\",\r\n        s_cell: \"cell\",\r\n        row_attrs: [],\r\n        cell_attrs: []\r\n    },\r\n    csv: {\r\n        row: \"\\n\",\r\n        cell: \",\"\r\n    },\r\n    _xml_attrs: function(c) {\r\n        var e = {};\r\n        if (c.attributes.length) {\r\n            for (var a = 0; a < c.attributes.length; a++) {\r\n                e[c.attributes[a].name] = c.attributes[a].value\r\n            }\r\n        }\r\n        return e\r\n    },\r\n    _process_xml: function(r) {\r\n        if (this._refresh_mode) {\r\n            return this._refreshFromXML(r)\r\n        }\r\n        this._parsing = true;\r\n        var m = dhx4.ajax.xmltop(this.xml.top, r);\r\n        if (m.tagName != this.xml.top) {\r\n            return\r\n        }\r\n        var o = m.getAttribute(\"dhx_security\");\r\n        if (o) {\r\n            dhtmlx.security_key = o\r\n        }\r\n        this._parseHead(m);\r\n        var s = dhx4.ajax.xpath(this.xml.row, m);\r\n        var l = parseInt(m.getAttribute(\"pos\") || 0);\r\n        var n = parseInt(m.getAttribute(\"total_count\") || 0);\r\n        if (!this.pagingOn) {\r\n            var n = Math.min(n, 32000000 / this._srdh)\r\n        }\r\n        var g = false;\r\n        if (n && n != this.rowsBuffer.length) {\r\n            if (!this.rowsBuffer[n - 1]) {\r\n                if (this.rowsBuffer.length) {\r\n                    g = true\r\n                }\r\n                this.rowsBuffer[n - 1] = null \r\n            }\r\n            if (n < this.rowsBuffer.length) {\r\n                this.rowsBuffer.splice(n, this.rowsBuffer.length - n);\r\n                g = true\r\n            }\r\n        }\r\n        if (this.isTreeGrid()) {\r\n            return this._process_tree_xml(m)\r\n        }\r\n        for (var c = 0; c < s.length; c++) {\r\n            if (this.rowsBuffer[c + l]) {\r\n                continue\r\n            }\r\n            var a = s[c].getAttribute(\"id\") || (c + l + 1);\r\n            this.rowsBuffer[c + l] = {\r\n                idd: a,\r\n                data: s[c],\r\n                _parser: this._process_xml_row,\r\n                _locator: this._get_xml_data\r\n            };\r\n            this.rowsAr[a] = s[c]\r\n        }\r\n        this.callEvent(\"onDataReady\", []);\r\n        if (g && this._srnd) {\r\n            var e = this.objBox.scrollTop;\r\n            this._reset_view();\r\n            this.objBox.scrollTop = e\r\n        } else {\r\n            this.render_dataset()\r\n        }\r\n        this._parsing = false\r\n    },\r\n    _process_jsarray: function(data) {\r\n        this._parsing = true;\r\n        data = data.responseText || data;\r\n        if (typeof data == \"string\") {\r\n            eval(\"dhtmlx.temp=\" + data + \";\");\r\n            data = dhtmlx.temp\r\n        }\r\n        for (var i = 0; i < data.length; i++) {\r\n            var id = i + 1;\r\n            this.rowsBuffer.push({\r\n                idd: id,\r\n                data: data[i],\r\n                _parser: this._process_jsarray_row,\r\n                _locator: this._get_jsarray_data\r\n            });\r\n            this.rowsAr[id] = data[i]\r\n        }\r\n        this.render_dataset();\r\n        this._parsing = false\r\n    },\r\n    _process_csv: function(g) {\r\n        this._parsing = true;\r\n        g = g.responseText || g;\r\n        g = g.replace(/\\r/g, \"\");\r\n        g = g.split(this.csv.row);\r\n        if (this._csvHdr) {\r\n            this.clearAll();\r\n            var e = g.splice(0, 1)[0].split(this.csv.cell);\r\n            if (!this._csvAID) {\r\n                e.splice(0, 1)\r\n            }\r\n            this.setHeader(e.join(this.delim));\r\n            this.init()\r\n        }\r\n        for (var c = 0; c < g.length; c++) {\r\n            if (!g[c] && c == g.length - 1) {\r\n                continue\r\n            }\r\n            if (this._csvAID) {\r\n                var h = c + 1;\r\n                this.rowsBuffer.push({\r\n                    idd: h,\r\n                    data: g[c],\r\n                    _parser: this._process_csv_row,\r\n                    _locator: this._get_csv_data\r\n                })\r\n            } else {\r\n                var a = g[c].split(this.csv.cell);\r\n                var h = a.splice(0, 1)[0];\r\n                this.rowsBuffer.push({\r\n                    idd: h,\r\n                    data: a,\r\n                    _parser: this._process_jsarray_row,\r\n                    _locator: this._get_jsarray_data\r\n                })\r\n            }\r\n            this.rowsAr[h] = g[c]\r\n        }\r\n        this.render_dataset();\r\n        this._parsing = false\r\n    },\r\n    _process_js: function(a) {\r\n        return this._process_json(a, \"js\")\r\n    },\r\n    _process_json: function(data, mode) {\r\n        this._parsing = true;\r\n        var data = data.responseText || data;\r\n        if (typeof data == \"string\") {\r\n            eval(\"dhtmlx.temp=\" + data + \";\");\r\n            data = dhtmlx.temp\r\n        }\r\n        if (mode == \"js\") {\r\n            if (data.data) {\r\n                data = data.data\r\n            }\r\n            for (var i = 0; i < data.length; i++) {\r\n                var row = data[i];\r\n                var id = row.id || (i + 1);\r\n                this.rowsBuffer.push({\r\n                    idd: id,\r\n                    data: row,\r\n                    _parser: this._process_js_row,\r\n                    _locator: this._get_js_data\r\n                });\r\n                this.rowsAr[id] = data[i]\r\n            }\r\n        } else {\r\n            if (data.rows) {\r\n                for (var i = 0; i < data.rows.length; i++) {\r\n                    var id = data.rows[i].id;\r\n                    this.rowsBuffer.push({\r\n                        idd: id,\r\n                        data: data.rows[i],\r\n                        _parser: this._process_json_row,\r\n                        _locator: this._get_json_data\r\n                    });\r\n                    this.rowsAr[id] = data.rows[i]\r\n                }\r\n            }\r\n        }\r\n        if (data.dhx_security) {\r\n            dhtmlx.security_key = data.dhx_security\r\n        }\r\n        this.callEvent(\"onDataReady\", []);\r\n        this.render_dataset();\r\n        this._parsing = false\r\n    },\r\n    render_dataset: function(g, a) {\r\n        if (this._srnd) {\r\n            if (this._fillers) {\r\n                return this._update_srnd_view()\r\n            }\r\n            a = Math.min((this._get_view_size() + (this._srnd_pr || 0)), this.rowsBuffer.length)\r\n        }\r\n        if (this.pagingOn) {\r\n            g = Math.max((g || 0), (this.currentPage - 1) * this.rowsBufferOutSize);\r\n            a = Math.min(this.currentPage * this.rowsBufferOutSize, this.rowsBuffer.length)\r\n        } else {\r\n            g = g || 0;\r\n            a = a || this.rowsBuffer.length\r\n        }\r\n        for (var e = g; e < a; e++) {\r\n            var l = this.render_row(e);\r\n            if (l == -1) {\r\n                if (this.xmlFileUrl) {\r\n                    if (this.callEvent(\"onDynXLS\", [e, (this._dpref ? this._dpref : (a - e))])) {\r\n                        this.load(this.xmlFileUrl + dhtmlx.url(this.xmlFileUrl) + \"posStart=\" + e + \"&count=\" + (this._dpref ? this._dpref : (a - e)), this._data_type)\r\n                    }\r\n                }\r\n                a = e;\r\n                break\r\n            }\r\n            if (!l.parentNode || !l.parentNode.tagName) {\r\n                this._insertRowAt(l, e);\r\n                if (l._attrs.selected || l._attrs.select) {\r\n                    this.selectRow(l, l._attrs.call ? true : false, true);\r\n                    l._attrs.selected = l._attrs.select = null \r\n                }\r\n            }\r\n            if (this._ads_count && e - g == this._ads_count) {\r\n                var h = this;\r\n                this._context_parsing = this._context_parsing || this._parsing;\r\n                return this._contextCallTimer = window.setTimeout(function() {\r\n                    h._contextCallTimer = null ;\r\n                    h.render_dataset(e, a);\r\n                    if (!h._contextCallTimer) {\r\n                        if (h._context_parsing) {\r\n                            h.callEvent(\"onXLE\", [])\r\n                        } else {\r\n                            h._fixAlterCss()\r\n                        }\r\n                        h._context_parsing = false\r\n                    }\r\n                }, this._ads_time)\r\n            }\r\n        }\r\n        if (this._ads_count && e == a) {\r\n            this.callEvent(\"onDistributedEnd\", [])\r\n        }\r\n        if (this._srnd && !this._fillers) {\r\n            var c = this.rowsBuffer.length - a;\r\n            this._fillers = [];\r\n            if (this._fake && !this._realfake) {\r\n                this._fake._fillers = []\r\n            }\r\n            while (c > 0) {\r\n                var n = (_isIE || window._FFrv) ? Math.min(c, 30000) : c;\r\n                var m = this._add_filler(a, n);\r\n                if (m) {\r\n                    this._fillers.push(m)\r\n                }\r\n                c -= n;\r\n                a += n\r\n            }\r\n        }\r\n        this.setSizes()\r\n    },\r\n    render_row: function(c) {\r\n        if (!this.rowsBuffer[c]) {\r\n            return -1\r\n        }\r\n        if (this.rowsBuffer[c]._parser) {\r\n            var a = this.rowsBuffer[c];\r\n            if (this.rowsAr[a.idd] && this.rowsAr[a.idd].tagName == \"TR\") {\r\n                return this.rowsBuffer[c] = this.rowsAr[a.idd]\r\n            }\r\n            var e = this._prepareRow(a.idd);\r\n            this.rowsBuffer[c] = e;\r\n            this.rowsAr[a.idd] = e;\r\n            a._parser.call(this, e, a.data);\r\n            this._postRowProcessing(e);\r\n            return e\r\n        }\r\n        return this.rowsBuffer[c]\r\n    },\r\n    _get_cell_value: function(c, a, e) {\r\n        if (c._locator) {\r\n            if (this._c_order) {\r\n                a = this._c_order[a]\r\n            }\r\n            return c._locator.call(this, c.data, a)\r\n        }\r\n        return this.cells3(c, a)[e ? e : \"getValue\"]()\r\n    },\r\n    sortRows: function(e, l, c) {\r\n        this.editStop();\r\n        c = (c || \"asc\").toLowerCase();\r\n        l = (l || this.fldSort[e]);\r\n        e = e || 0;\r\n        if (this.isTreeGrid()) {\r\n            this.sortTreeRows(e, l, c)\r\n        } else {\r\n            var a = {};\r\n            var h = this.cellType[e];\r\n            var m = \"getValue\";\r\n            if (h == \"link\") {\r\n                m = \"getContent\"\r\n            }\r\n            if (h == \"dhxCalendar\" || h == \"dhxCalendarA\") {\r\n                m = \"getDate\"\r\n            }\r\n            for (var g = 0; g < this.rowsBuffer.length; g++) {\r\n                a[this.rowsBuffer[g].idd] = this._get_cell_value(this.rowsBuffer[g], e, m)\r\n            }\r\n            this._sortRows(e, l, c, a)\r\n        }\r\n        this.callEvent(\"onAfterSorting\", [e, l, c])\r\n    },\r\n    _sortCore: function(e, l, c, a, h) {\r\n        var g = \"sort\";\r\n        if (this._sst) {\r\n            h.stablesort = this.rowsCol.stablesort;\r\n            g = \"stablesort\"\r\n        }\r\n        if (l.length > 4) {\r\n            l = window[l]\r\n        }\r\n        if (l == \"cus\") {\r\n            var m = this._customSorts[e];\r\n            h[g](function(o, n) {\r\n                return m(a[o.idd], a[n.idd], c, o.idd, n.idd)\r\n            })\r\n        } else {\r\n            if (typeof (l) == \"function\") {\r\n                h[g](function(o, n) {\r\n                    return l(a[o.idd], a[n.idd], c, o.idd, n.idd)\r\n                })\r\n            } else {\r\n                if (l == \"str\") {\r\n                    h[g](function(o, n) {\r\n                        if (c == \"asc\") {\r\n                            return a[o.idd] > a[n.idd] ? 1 : (a[o.idd] < a[n.idd] ? -1 : 0)\r\n                        } else {\r\n                            return a[o.idd] < a[n.idd] ? 1 : (a[o.idd] > a[n.idd] ? -1 : 0)\r\n                        }\r\n                    })\r\n                } else {\r\n                    if (l == \"int\") {\r\n                        h[g](function(r, o) {\r\n                            var n = parseFloat(a[r.idd]);\r\n                            n = isNaN(n) ? -99999999999999 : n;\r\n                            var s = parseFloat(a[o.idd]);\r\n                            s = isNaN(s) ? -99999999999999 : s;\r\n                            if (c == \"asc\") {\r\n                                return n - s\r\n                            } else {\r\n                                return s - n\r\n                            }\r\n                        })\r\n                    } else {\r\n                        if (l == \"date\") {\r\n                            h[g](function(r, o) {\r\n                                var n = Date.parse(a[r.idd]) || (Date.parse(\"01/01/1900\"));\r\n                                var s = Date.parse(a[o.idd]) || (Date.parse(\"01/01/1900\"));\r\n                                if (c == \"asc\") {\r\n                                    return n - s\r\n                                } else {\r\n                                    return s - n\r\n                                }\r\n                            })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _sortRows: function(e, g, c, a) {\r\n        this._sortCore(e, g, c, a, this.rowsBuffer);\r\n        this._reset_view();\r\n        this.callEvent(\"onGridReconstructed\", [])\r\n    },\r\n    _reset_view: function(e) {\r\n        if (!this.obj.rows[0]) {\r\n            return\r\n        }\r\n        if (this._lahRw) {\r\n            this._unsetRowHover(0, true)\r\n        }\r\n        this.callEvent(\"onResetView\", []);\r\n        var a = this.obj.rows[0].parentNode;\r\n        var g = a.removeChild(a.childNodes[0], true);\r\n        if (_isKHTML) {\r\n            for (var c = a.parentNode.childNodes.length - 1; c >= 0; c--) {\r\n                if (a.parentNode.childNodes[c].tagName == \"TR\") {\r\n                    a.parentNode.removeChild(a.parentNode.childNodes[c], true)\r\n                }\r\n            }\r\n        } else {\r\n            if (_isIE) {\r\n                for (var c = a.childNodes.length - 1; c >= 0; c--) {\r\n                    a.childNodes[c].removeNode(true)\r\n                }\r\n            } else {\r\n                a.innerHTML = \"\"\r\n            }\r\n        }\r\n        a.appendChild(g);\r\n        this.rowsCol = dhtmlxArray();\r\n        if (this._sst) {\r\n            this.enableStableSorting(true)\r\n        }\r\n        this._fillers = this.undefined;\r\n        if (!e) {\r\n            if (_isIE && this._srnd) {\r\n                this.render_dataset()\r\n            } else {\r\n                this.render_dataset()\r\n            }\r\n        }\r\n    },\r\n    deleteRow: function(c, g) {\r\n        if (!g) {\r\n            g = this.getRowById(c)\r\n        }\r\n        if (!g) {\r\n            return\r\n        }\r\n        this.editStop();\r\n        if (!this._realfake) {\r\n            if (this.callEvent(\"onBeforeRowDeleted\", [c]) == false) {\r\n                return false\r\n            }\r\n        }\r\n        var a = 0;\r\n        if (this.cellType._dhx_find(\"tree\") != -1 && !this._realfake) {\r\n            a = this._h2.get[c].parent.id;\r\n            this._removeTrGrRow(g)\r\n        } else {\r\n            if (g.parentNode) {\r\n                g.parentNode.removeChild(g)\r\n            }\r\n            var l = this.rowsCol._dhx_find(g);\r\n            if (l != -1) {\r\n                this.rowsCol._dhx_removeAt(l)\r\n            }\r\n            for (var e = 0; e < this.rowsBuffer.length; e++) {\r\n                if (this.rowsBuffer[e] && this.rowsBuffer[e].idd == c) {\r\n                    this.rowsBuffer._dhx_removeAt(e);\r\n                    l = e;\r\n                    break\r\n                }\r\n            }\r\n        }\r\n        this.rowsAr[c] = null ;\r\n        for (var e = 0; e < this.selectedRows.length; e++) {\r\n            if (this.selectedRows[e].idd == c) {\r\n                this.selectedRows._dhx_removeAt(e)\r\n            }\r\n        }\r\n        if (this._srnd) {\r\n            for (var e = 0; e < this._fillers.length; e++) {\r\n                var h = this._fillers[e];\r\n                if (!h) {\r\n                    continue\r\n                }\r\n                if (h[0] >= l) {\r\n                    this._update_fillers(e, 0, -1)\r\n                } else {\r\n                    if (h[0] + h[1] > l) {\r\n                        this._update_fillers(e, -1, 0)\r\n                    }\r\n                }\r\n            }\r\n            this._update_srnd_view()\r\n        }\r\n        if (this.pagingOn) {\r\n            this.changePage()\r\n        }\r\n        if (!this._realfake) {\r\n            this.callEvent(\"onAfterRowDeleted\", [c, a])\r\n        }\r\n        this.callEvent(\"onGridReconstructed\", []);\r\n        if (this._ahgr) {\r\n            this.setSizes()\r\n        }\r\n        return true\r\n    },\r\n    _addRow: function(l, m, c) {\r\n        if (c == -1 || typeof c == \"undefined\") {\r\n            c = this.rowsBuffer.length\r\n        }\r\n        if (typeof m == \"string\") {\r\n            m = m.split(this.delim)\r\n        }\r\n        var n = this._prepareRow(l);\r\n        n._attrs = {};\r\n        for (var e = 0; e < n.childNodes.length; e++) {\r\n            n.childNodes[e]._attrs = {}\r\n        }\r\n        this.rowsAr[n.idd] = n;\r\n        if (this._h2) {\r\n            this._h2.get[n.idd].buff = n\r\n        }\r\n        this._fillRow(n, m);\r\n        this._postRowProcessing(n);\r\n        if (this._skipInsert) {\r\n            this._skipInsert = false;\r\n            return this.rowsAr[n.idd] = n\r\n        }\r\n        if (this.pagingOn) {\r\n            this.rowsBuffer._dhx_insertAt(c, n);\r\n            this.rowsAr[n.idd] = n;\r\n            return n\r\n        }\r\n        if (this._fillers) {\r\n            this.rowsCol._dhx_insertAt(c, null );\r\n            this.rowsBuffer._dhx_insertAt(c, n);\r\n            if (this._fake) {\r\n                this._fake.rowsCol._dhx_insertAt(c, null )\r\n            }\r\n            this.rowsAr[n.idd] = n;\r\n            var o = false;\r\n            for (var g = 0; g < this._fillers.length; g++) {\r\n                var h = this._fillers[g];\r\n                if (h && h[0] <= c && (h[0] + h[1]) >= c) {\r\n                    h[1] = h[1] + 1;\r\n                    var a = h[2].firstChild.style.height = parseInt(h[2].firstChild.style.height) + this._srdh + \"px\";\r\n                    o = true;\r\n                    if (this._fake) {\r\n                        this._fake._fillers[g][1]++;\r\n                        this._fake._fillers[g][2].firstChild.style.height = a\r\n                    }\r\n                }\r\n                if (h && h[0] > c) {\r\n                    h[0] = h[0] + 1;\r\n                    if (this._fake) {\r\n                        this._fake._fillers[g][0]++\r\n                    }\r\n                }\r\n            }\r\n            if (!o) {\r\n                this._fillers.push(this._add_filler(c, 1, (c == 0 ? {\r\n                    parentNode: this.obj.rows[0].parentNode,\r\n                    nextSibling: (this.rowsCol[1])\r\n                } : this.rowsCol[c - 1])))\r\n            }\r\n            return n\r\n        }\r\n        this.rowsBuffer._dhx_insertAt(c, n);\r\n        return this._insertRowAt(n, c)\r\n    },\r\n    addRow: function(a, g, e) {\r\n        var c = this._addRow(a, g, e);\r\n        if (!this.dragContext) {\r\n            this.callEvent(\"onRowAdded\", [a])\r\n        }\r\n        if (this.pagingOn) {\r\n            this.changePage(this.currentPage)\r\n        }\r\n        if (this._srnd) {\r\n            this._update_srnd_view()\r\n        }\r\n        c._added = true;\r\n        if (this._srnd && !this._fillers) {\r\n            this._fillers = []\r\n        }\r\n        if (this._ahgr) {\r\n            this.setSizes()\r\n        }\r\n        this.callEvent(\"onGridReconstructed\", []);\r\n        return c\r\n    },\r\n    _insertRowAt: function(e, g, c) {\r\n        this.rowsAr[e.idd] = e;\r\n        if (this._skipInsert) {\r\n            this._skipInsert = false;\r\n            return e\r\n        }\r\n        if ((g < 0) || ((!g) && (parseInt(g) !== 0))) {\r\n            g = this.rowsCol.length\r\n        } else {\r\n            if (g > this.rowsCol.length) {\r\n                g = this.rowsCol.length\r\n            }\r\n        }\r\n        if (this._cssEven) {\r\n            var a = e.className.replace(this._cssUnEven, \"\");\r\n            if ((this._cssSP ? this.getLevel(e.idd) : g) % 2 == 1) {\r\n                e.className = a + \" \" + this._cssUnEven + (this._cssSU ? (\" \" + this._cssUnEven + \"_\" + this.getLevel(e.idd)) : \"\")\r\n            } else {\r\n                e.className = a + \" \" + this._cssEven + (this._cssSU ? (\" \" + this._cssEven + \"_\" + this.getLevel(e.idd)) : \"\")\r\n            }\r\n        }\r\n        if (!c) {\r\n            if ((g == (this.obj.rows.length - 1)) || (!this.rowsCol[g])) {\r\n                if (_isKHTML) {\r\n                    this.obj.appendChild(e)\r\n                } else {\r\n                    this.obj.firstChild.appendChild(e)\r\n                }\r\n            } else {\r\n                this.rowsCol[g].parentNode.insertBefore(e, this.rowsCol[g])\r\n            }\r\n        }\r\n        this.rowsCol._dhx_insertAt(g, e);\r\n        this.callEvent(\"onRowInserted\", [e, g]);\r\n        return e\r\n    },\r\n    getRowById: function(e) {\r\n        var c = this.rowsAr[e];\r\n        if (c) {\r\n            if (c.tagName != \"TR\") {\r\n                for (var a = 0; a < this.rowsBuffer.length; a++) {\r\n                    if (this.rowsBuffer[a] && this.rowsBuffer[a].idd == e) {\r\n                        return this.render_row(a)\r\n                    }\r\n                }\r\n                if (this._h2) {\r\n                    return this.render_row(null , c.idd)\r\n                }\r\n            }\r\n            return c\r\n        }\r\n        return null \r\n    },\r\n    cellById: function(c, a) {\r\n        return this.cells(c, a)\r\n    },\r\n    cells: function(g, e) {\r\n        if (arguments.length == 0) {\r\n            return this.cells4(this.cell)\r\n        } else {\r\n            var h = this.getRowById(g)\r\n        }\r\n        var a = (h._childIndexes ? h.childNodes[h._childIndexes[e]] : h.childNodes[e]);\r\n        if (!a && h._childIndexes) {\r\n            a = h.firstChild || {}\r\n        }\r\n        return this.cells4(a)\r\n    },\r\n    cellByIndex: function(c, a) {\r\n        return this.cells2(c, a)\r\n    },\r\n    cells2: function(g, e) {\r\n        var h = this.render_row(g);\r\n        var a = (h._childIndexes ? h.childNodes[h._childIndexes[e]] : h.childNodes[e]);\r\n        if (!a && h._childIndexes) {\r\n            a = h.firstChild || {}\r\n        }\r\n        return this.cells4(a)\r\n    },\r\n    cells3: function(e, c) {\r\n        var a = (e._childIndexes ? e.childNodes[e._childIndexes[c]] : e.childNodes[c]);\r\n        return this.cells4(a)\r\n    },\r\n    cells4: function(a) {\r\n        var c = window[\"eXcell_\" + (a._cellType || this.cellType[a._cellIndex])];\r\n        if (c) {\r\n            return new c(a)\r\n        }\r\n    },\r\n    cells5: function(a, e) {\r\n        var e = e || (a._cellType || this.cellType[a._cellIndex]);\r\n        if (!this._ecache[e]) {\r\n            if (!window[\"eXcell_\" + e]) {\r\n                var c = eXcell_ro\r\n            } else {\r\n                var c = window[\"eXcell_\" + e]\r\n            }\r\n            this._ecache[e] = new c(a)\r\n        }\r\n        this._ecache[e].cell = a;\r\n        return this._ecache[e]\r\n    },\r\n    dma: function(a) {\r\n        if (!this._ecache) {\r\n            this._ecache = {}\r\n        }\r\n        if (a && !this._dma) {\r\n            this._dma = this.cells4;\r\n            this.cells4 = this.cells5\r\n        } else {\r\n            if (!a && this._dma) {\r\n                this.cells4 = this._dma;\r\n                this._dma = null \r\n            }\r\n        }\r\n    },\r\n    getRowsNum: function() {\r\n        return this.rowsBuffer.length\r\n    },\r\n    enableEditTabOnly: function(a) {\r\n        if (arguments.length > 0) {\r\n            this.smartTabOrder = dhx4.s2b(a)\r\n        } else {\r\n            this.smartTabOrder = true\r\n        }\r\n    },\r\n    setExternalTabOrder: function(h, a) {\r\n        var c = this;\r\n        this.tabStart = (typeof (h) == \"object\") ? h : document.getElementById(h);\r\n        var e = this.tabStart.onkeydown;\r\n        this.tabStart.onkeydown = function(m) {\r\n            if (e) {\r\n                e.call(this, m)\r\n            }\r\n            var l = (m || window.event);\r\n            if (l.keyCode == 9 && !l.shiftKey) {\r\n                l.cancelBubble = true;\r\n                c.selectCell(0, 0, 0, 0, 1);\r\n                if (c.smartTabOrder && c.cells2(0, 0).isDisabled()) {\r\n                    c._key_events.k9_0_0.call(c)\r\n                }\r\n                this.blur();\r\n                return false\r\n            }\r\n        }\r\n        ;\r\n        if (_isOpera) {\r\n            this.tabStart.onkeypress = this.tabStart.onkeydown\r\n        }\r\n        this.tabEnd = (typeof (a) == \"object\") ? a : document.getElementById(a);\r\n        var g = this.tabEnd.onkeydown;\r\n        this.tabEnd.onkeydown = this.tabEnd.onkeypress = function(m) {\r\n            if (g) {\r\n                g.call(this, m)\r\n            }\r\n            var l = (m || window.event);\r\n            if (l.keyCode == 9 && l.shiftKey) {\r\n                l.cancelBubble = true;\r\n                c.selectCell((c.getRowsNum() - 1), (c.getColumnCount() - 1), 0, 0, 1);\r\n                if (c.smartTabOrder && c.cells2((c.getRowsNum() - 1), (c.getColumnCount() - 1)).isDisabled()) {\r\n                    c._key_events.k9_0_1.call(c)\r\n                }\r\n                this.blur();\r\n                return false\r\n            }\r\n        }\r\n        ;\r\n        if (_isOpera) {\r\n            this.tabEnd.onkeypress = this.tabEnd.onkeydown\r\n        }\r\n    },\r\n    uid: function() {\r\n        if (!this._ui_seed) {\r\n            this._ui_seed = (new Date()).valueOf()\r\n        }\r\n        return this._ui_seed++\r\n    },\r\n    clearAndLoad: function() {\r\n        if (this._last_load_request) {\r\n            var c = this._last_load_request.xmlDoc;\r\n            if (c.readyState != 4) {\r\n                try {\r\n                    c.onreadystatechange = function() {}\r\n                    ;\r\n                    c.abort()\r\n                } catch (g) {}\r\n            }\r\n        }\r\n        var a = this._pgn_skin;\r\n        this._pgn_skin = null ;\r\n        this.clearAll();\r\n        this._pgn_skin = a;\r\n        this._last_load_request = this.load.apply(this, arguments)\r\n    },\r\n    getStateOfView: function() {\r\n        if (this.pagingOn) {\r\n            var a = (this.currentPage - 1) * this.rowsBufferOutSize;\r\n            return [this.currentPage, a, Math.min(a + this.rowsBufferOutSize, this.rowsBuffer.length), this.rowsBuffer.length]\r\n        }\r\n        return [Math.floor(this.objBox.scrollTop / this._srdh), Math.ceil(parseInt(this.objBox.offsetHeight) / this._srdh), this.rowsBuffer.length]\r\n    }\r\n};\r\n(function() {\r\n    function g(m, n) {\r\n        this[m] = n\r\n    }\r\n    function l(m, n) {\r\n        this[m].call(this, n)\r\n    }\r\n    function e(m, n) {\r\n        this[m].call(this, n.join(this.delim))\r\n    }\r\n    function a(m, r) {\r\n        for (var o = 0; o < r.length; o++) {\r\n            if (typeof r[o] == \"object\") {\r\n                var s = this.getCombo(o);\r\n                for (var n in r[o]) {\r\n                    s.put(n, r[o][n])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function h(m, w, r) {\r\n        var y = 1;\r\n        var v = [];\r\n        function x(C, A, D) {\r\n            if (!v[A]) {\r\n                v[A] = []\r\n            }\r\n            if (typeof D == \"object\") {\r\n                D.toString = function() {\r\n                    return this.text\r\n                }\r\n            }\r\n            v[A][C] = D\r\n        }\r\n        for (var s = 0; s < w.length; s++) {\r\n            if (typeof (w[s]) == \"object\" && w[s].length) {\r\n                for (var o = 0; o < w[s].length; o++) {\r\n                    x(s, o, w[s][o])\r\n                }\r\n            } else {\r\n                x(s, 0, w[s])\r\n            }\r\n        }\r\n        for (var s = 0; s < v.length; s++) {\r\n            for (var o = 0; o < v[0].length; o++) {\r\n                var u = v[s][o];\r\n                v[s][o] = (u || \"\").toString() || \"&nbsp;\";\r\n                if (u && u.colspan) {\r\n                    for (var n = 1; n < u.colspan; n++) {\r\n                        x(o + n, s, \"#cspan\")\r\n                    }\r\n                }\r\n                if (u && u.rowspan) {\r\n                    for (var n = 1; n < u.rowspan; n++) {\r\n                        x(o, s + n, \"#rspan\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.setHeader(v[0]);\r\n        for (var s = 1; s < v.length; s++) {\r\n            this.attachHeader(v[s])\r\n        }\r\n    }\r\n    var c = [{\r\n        name: \"label\",\r\n        def: \"&nbsp;\",\r\n        operation: \"setHeader\",\r\n        type: h\r\n    }, {\r\n        name: \"id\",\r\n        def: \"\",\r\n        operation: \"columnIds\",\r\n        type: g\r\n    }, {\r\n        name: \"width\",\r\n        def: \"*\",\r\n        operation: \"setInitWidths\",\r\n        type: e\r\n    }, {\r\n        name: \"align\",\r\n        def: \"left\",\r\n        operation: \"cellAlign\",\r\n        type: g\r\n    }, {\r\n        name: \"valign\",\r\n        def: \"middle\",\r\n        operation: \"cellVAlign\",\r\n        type: g\r\n    }, {\r\n        name: \"sort\",\r\n        def: \"na\",\r\n        operation: \"fldSort\",\r\n        type: g\r\n    }, {\r\n        name: \"type\",\r\n        def: \"ro\",\r\n        operation: \"setColTypes\",\r\n        type: e\r\n    }, {\r\n        name: \"options\",\r\n        def: \"\",\r\n        operation: \"\",\r\n        type: a\r\n    }];\r\n    dhtmlx.extend_api(\"dhtmlXGridObject\", {\r\n        _init: function(m) {\r\n            return [m.parent]\r\n        },\r\n        image_path: \"setImagePath\",\r\n        columns: \"columns\",\r\n        rows: \"rows\",\r\n        headers: \"headers\",\r\n        skin: \"setSkin\",\r\n        smart_rendering: \"enableSmartRendering\",\r\n        css: \"enableAlterCss\",\r\n        auto_height: \"enableAutoHeight\",\r\n        save_hidden: \"enableAutoHiddenColumnsSaving\",\r\n        save_cookie: \"enableAutoSaving\",\r\n        save_size: \"enableAutoSizeSaving\",\r\n        auto_width: \"enableAutoWidth\",\r\n        block_selection: \"enableBlockSelection\",\r\n        csv_id: \"enableCSVAutoID\",\r\n        csv_header: \"enableCSVHeader\",\r\n        cell_ids: \"enableCellIds\",\r\n        colspan: \"enableColSpan\",\r\n        column_move: \"enableColumnMove\",\r\n        context_menu: \"enableContextMenu\",\r\n        distributed: \"enableDistributedParsing\",\r\n        drag: \"enableDragAndDrop\",\r\n        drag_order: \"enableDragOrder\",\r\n        tabulation: \"enableEditTabOnly\",\r\n        header_images: \"enableHeaderImages\",\r\n        header_menu: \"enableHeaderMenu\",\r\n        keymap: \"enableKeyboardSupport\",\r\n        mouse_navigation: \"enableLightMouseNavigation\",\r\n        markers: \"enableMarkedCells\",\r\n        math_editing: \"enableMathEditing\",\r\n        math_serialization: \"enableMathSerialization\",\r\n        drag_copy: \"enableMercyDrag\",\r\n        multiline: \"enableMultiline\",\r\n        multiselect: \"enableMultiselect\",\r\n        save_column_order: \"enableOrderSaving\",\r\n        hover: \"enableRowsHover\",\r\n        rowspan: \"enableRowspan\",\r\n        smart: \"enableSmartRendering\",\r\n        save_sorting: \"enableSortingSaving\",\r\n        stable_sorting: \"enableStableSorting\",\r\n        undo: \"enableUndoRedo\",\r\n        csv_cell: \"setCSVDelimiter\",\r\n        date_format: \"setDateFormat\",\r\n        drag_behavior: \"setDragBehavior\",\r\n        editable: \"setEditable\",\r\n        without_header: \"setNoHeader\",\r\n        submit_changed: \"submitOnlyChanged\",\r\n        submit_serialization: \"submitSerialization\",\r\n        submit_selected: \"submitOnlySelected\",\r\n        submit_id: \"submitOnlyRowID\",\r\n        xml: \"load\"\r\n    }, {\r\n        columns: function(s) {\r\n            for (var m = 0; m < c.length; m++) {\r\n                var r = [];\r\n                for (var n = 0; n < s.length; n++) {\r\n                    r[n] = s[n][c[m].name] || c[m].def\r\n                }\r\n                var o = c[m].type || l;\r\n                o.call(this, c[m].operation, r, s)\r\n            }\r\n            this.init()\r\n        },\r\n        rows: function(m) {},\r\n        headers: function(n) {\r\n            for (var m = 0; m < n.length; m++) {\r\n                this.attachHeader(n[m])\r\n            }\r\n        }\r\n    })\r\n})();\r\ndhtmlXGridObject.prototype._dp_init = function(a) {\r\n    a.attachEvent(\"insertCallback\", function(c, g) {\r\n        if (this.obj._h2) {\r\n            this.obj.addRow(g, e, null , parent)\r\n        } else {\r\n            this.obj.addRow(g, [], 0)\r\n        }\r\n        var e = this.obj.getRowById(g);\r\n        if (e) {\r\n            this.obj._process_xml_row(e, c.firstChild);\r\n            this.obj._postRowProcessing(e)\r\n        }\r\n    });\r\n    a.attachEvent(\"updateCallback\", function(c, g) {\r\n        var e = this.obj.getRowById(g);\r\n        if (e) {\r\n            this.obj._process_xml_row(e, c.firstChild);\r\n            this.obj._postRowProcessing(e)\r\n        }\r\n    });\r\n    a.attachEvent(\"deleteCallback\", function(c, e) {\r\n        this.obj.setUserData(e, this.action_param, \"true_deleted\");\r\n        this.obj.deleteRow(e)\r\n    });\r\n    a._methods = [\"setRowTextStyle\", \"setCellTextStyle\", \"changeRowId\", \"deleteRow\"];\r\n    this.attachEvent(\"onEditCell\", function(g, h, e) {\r\n        if (a._columns && !a._columns[e]) {\r\n            return true\r\n        }\r\n        var c = this.cells(h, e);\r\n        if (g == 1) {\r\n            if (c.isCheckbox()) {\r\n                a.setUpdated(h, true)\r\n            }\r\n        } else {\r\n            if (g == 2) {\r\n                if (c.wasChanged()) {\r\n                    a.setUpdated(h, true)\r\n                }\r\n            }\r\n        }\r\n        return true\r\n    });\r\n    this.attachEvent(\"onRowPaste\", function(c) {\r\n        a.setUpdated(c, true)\r\n    });\r\n    this.attachEvent(\"onUndo\", function(c) {\r\n        a.setUpdated(c, true)\r\n    });\r\n    this.attachEvent(\"onRowIdChange\", function(g, c) {\r\n        var e = a.findRow(g);\r\n        if (e < a.updatedRows.length) {\r\n            a.updatedRows[e] = c\r\n        }\r\n    });\r\n    this.attachEvent(\"onSelectStateChanged\", function(c) {\r\n        if (a.updateMode == \"row\") {\r\n            a.sendData()\r\n        }\r\n        return true\r\n    });\r\n    this.attachEvent(\"onEnter\", function(e, c) {\r\n        if (a.updateMode == \"row\") {\r\n            a.sendData()\r\n        }\r\n        return true\r\n    });\r\n    this.attachEvent(\"onBeforeRowDeleted\", function(c) {\r\n        if (a._silent_mode || (!this.rowsAr[c])) {\r\n            return true\r\n        }\r\n        if (this.dragContext && a.dnd) {\r\n            window.setTimeout(function() {\r\n                a.setUpdated(c, true)\r\n            }, 1);\r\n            return true\r\n        }\r\n        var e = a.getState(c);\r\n        if (this._h2) {\r\n            this._h2.forEachChild(c, function(g) {\r\n                a.setUpdated(g.id, false);\r\n                a.markRow(g.id, true, \"deleted\")\r\n            }, this)\r\n        }\r\n        if (e == \"inserted\") {\r\n            a.set_invalid(c, false);\r\n            a.setUpdated(c, false);\r\n            return true\r\n        }\r\n        if (e == \"deleted\") {\r\n            return false\r\n        }\r\n        if (e == \"true_deleted\") {\r\n            a.setUpdated(c, false);\r\n            return true\r\n        }\r\n        a.setUpdated(c, true, \"deleted\");\r\n        return false\r\n    });\r\n    this.attachEvent(\"onBindUpdate\", function(c) {\r\n        if (typeof c == \"object\") {\r\n            c = c.id\r\n        }\r\n        a.setUpdated(c, true)\r\n    });\r\n    this.attachEvent(\"onRowAdded\", function(c) {\r\n        if (this.dragContext && a.dnd) {\r\n            return true\r\n        }\r\n        a.setUpdated(c, true, \"inserted\");\r\n        return true\r\n    });\r\n    a._getRowData = function(g, u) {\r\n        var m = [];\r\n        m.gr_id = g;\r\n        if (this.obj.isTreeGrid()) {\r\n            m.gr_pid = this.obj.getParentId(g)\r\n        }\r\n        var e = this.obj.getRowById(g);\r\n        for (var n = 0; n < this.obj._cCount; n++) {\r\n            if (this.obj._c_order) {\r\n                var o = this.obj._c_order[n]\r\n            } else {\r\n                var o = n\r\n            }\r\n            var s = this.obj.cells(e.idd, n);\r\n            if (this._changed && !s.wasChanged()) {\r\n                continue\r\n            }\r\n            if (this._endnm) {\r\n                m[this.obj.getColumnId(n)] = s.getValue()\r\n            } else {\r\n                m[\"c\" + o] = s.getValue()\r\n            }\r\n        }\r\n        var h = this.obj.UserData[g];\r\n        if (h) {\r\n            for (var l = 0; l < h.keys.length; l++) {\r\n                if (h.keys[l] && h.keys[l].indexOf(\"__\") != 0) {\r\n                    m[h.keys[l]] = h.values[l]\r\n                }\r\n            }\r\n        }\r\n        var h = this.obj.UserData.gridglobaluserdata;\r\n        if (h) {\r\n            for (var l = 0; l < h.keys.length; l++) {\r\n                m[h.keys[l]] = h.values[l]\r\n            }\r\n        }\r\n        return m\r\n    }\r\n    ;\r\n    a._clearUpdateFlag = function(e) {\r\n        var g = this.obj.getRowById(e);\r\n        if (g) {\r\n            for (var c = 0; c < this.obj._cCount; c++) {\r\n                this.obj.cells(e, c).cell.wasChanged = false\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    a.checkBeforeUpdate = function(l) {\r\n        var h = true;\r\n        var c = [];\r\n        for (var g = 0; g < this.obj._cCount; g++) {\r\n            if (this.mandatoryFields[g]) {\r\n                var e = this.mandatoryFields[g].call(this.obj, this.obj.cells(l, g).getValue(), l, g);\r\n                if (typeof e == \"string\") {\r\n                    this.messages.push(e);\r\n                    h = false\r\n                } else {\r\n                    h &= e;\r\n                    c[g] = !e\r\n                }\r\n            }\r\n        }\r\n        if (!h) {\r\n            this.set_invalid(l, \"invalid\", c);\r\n            this.setUpdated(l, false)\r\n        }\r\n        return h\r\n    }\r\n}\r\n;\r\ndhx4.attachEvent(\"onGridCreated\", function(c) {\r\n    c._con_f_used = [].concat(c._con_f_used);\r\n    dhtmlXGridObject.prototype._con_f_used = [];\r\n    var a = function(l) {\r\n        l = l.replace(/(\\?|\\&)connector[^\\f]*/g, \"\");\r\n        return l + (l.indexOf(\"?\") != -1 ? \"&\" : \"?\") + \"connector=true\" + (this.hdr.rows.length > 0 ? \"&dhx_no_header=1\" : \"\")\r\n    }\r\n    ;\r\n    var h = function(l) {\r\n        return a.call(this, l) + (this._connector_sorting || \"\") + (this._connector_filter || \"\")\r\n    }\r\n    ;\r\n    var g = function(m, n, l) {\r\n        this._connector_sorting = \"&dhx_sort[\" + n + \"]=\" + l;\r\n        return h.call(this, m)\r\n    }\r\n    ;\r\n    var e = function(m, l, o) {\r\n        var r = [];\r\n        for (var n = 0; n < l.length; n++) {\r\n            r[n] = \"dhx_filter[\" + l[n] + \"]=\" + encodeURIComponent(o[n])\r\n        }\r\n        this._connector_filter = \"&\" + r.join(\"&\");\r\n        return h.call(this, m)\r\n    }\r\n    ;\r\n    c.attachEvent(\"onCollectValues\", function(l) {\r\n        if (this._con_f_used[l]) {\r\n            if (typeof (this._con_f_used[l]) == \"object\") {\r\n                return this._con_f_used[l]\r\n            } else {\r\n                return false\r\n            }\r\n        }\r\n        return true\r\n    });\r\n    c.attachEvent(\"onDynXLS\", function() {\r\n        if (this.xmlFileUrl) {\r\n            this.xmlFileUrl = h.call(this, this.xmlFileUrl)\r\n        }\r\n        return true\r\n    });\r\n    c.attachEvent(\"onBeforeSorting\", function(o, n, m) {\r\n        if (n == \"connector\") {\r\n            var l = this;\r\n            this.clearAndLoad(g.call(this, this.xmlFileUrl, o, m), function() {\r\n                l.setSortImgState(true, o, m)\r\n            });\r\n            return false\r\n        }\r\n        return true\r\n    });\r\n    c.attachEvent(\"onFilterStart\", function(m, l) {\r\n        if (this._con_f_used.length) {\r\n            var o = this.getSortingState();\r\n            var n = this;\r\n            this.clearAndLoad(e.call(this, this.xmlFileUrl, m, l));\r\n            if (o.length) {\r\n                n.setSortImgState(true, o[0], o[1])\r\n            }\r\n            return false\r\n        }\r\n        return true\r\n    })\r\n});\r\ndhtmlXGridObject.prototype._con_f_used = [];\r\ndhtmlXGridObject.prototype._in_header_connector_text_filter = function(c, a) {\r\n    if (!this._con_f_used[a]) {\r\n        this._con_f_used[a] = 1\r\n    }\r\n    return this._in_header_text_filter(c, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_connector_select_filter = function(c, a) {\r\n    if (!this._con_f_used[a]) {\r\n        this._con_f_used[a] = 2\r\n    }\r\n    return this._in_header_select_filter(c, a)\r\n}\r\n;\r\nif (!dhtmlXGridObject.prototype.load_connector) {\r\n    dhtmlXGridObject.prototype.load_connector = dhtmlXGridObject.prototype.load;\r\n    dhtmlXGridObject.prototype.load = function(c, h, g) {\r\n        if (!this._colls_loaded && this.cellType) {\r\n            var a = [];\r\n            for (var e = 0; e < this.cellType.length; e++) {\r\n                if (this.cellType[e].indexOf(\"co\") == 0 || this.cellType[e].indexOf(\"clist\") == 0 || this._con_f_used[e] == 2) {\r\n                    a.push(e)\r\n                }\r\n            }\r\n            if (a.length) {\r\n                arguments[0] += (arguments[0].indexOf(\"?\") != -1 ? \"&\" : \"?\") + \"connector=true&dhx_colls=\" + a.join(\",\")\r\n            }\r\n        }\r\n        return this.load_connector.apply(this, arguments)\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype._parseHead_connector = dhtmlXGridObject.prototype._parseHead;\r\n    dhtmlXGridObject.prototype._parseHead = function(c, w, r) {\r\n        this._parseHead_connector.apply(this, arguments);\r\n        if (!this._colls_loaded) {\r\n            var s = dhx4.ajax.xpath(\"./coll_options\", arguments[0]);\r\n            for (var m = 0; m < s.length; m++) {\r\n                var o = s[m].getAttribute(\"for\");\r\n                var u = [];\r\n                var g = null ;\r\n                if (this.cellType[o] == \"combo\") {\r\n                    g = this.getColumnCombo(o)\r\n                } else {\r\n                    if (this.cellType[o].indexOf(\"co\") == 0) {\r\n                        g = this.getCombo(o)\r\n                    }\r\n                }\r\n                var l = dhx4.ajax.xpath(\"./item\", s[m]);\r\n                var a = [];\r\n                for (var h = 0; h < l.length; h++) {\r\n                    var e = l[h].getAttribute(\"value\");\r\n                    if (g) {\r\n                        var n = l[h].getAttribute(\"label\") || e;\r\n                        if (g.addOption) {\r\n                            a.push([e, n])\r\n                        } else {\r\n                            g.put(e, n)\r\n                        }\r\n                        u[u.length] = n\r\n                    } else {\r\n                        u[u.length] = e\r\n                    }\r\n                }\r\n                if (a.length) {\r\n                    if (g) {\r\n                        g.addOption(a)\r\n                    }\r\n                } else {\r\n                    if (u.length && !g) {\r\n                        if (this.registerCList) {\r\n                            this.registerCList(o * 1, u)\r\n                        }\r\n                    }\r\n                }\r\n                if (this._con_f_used[o * 1]) {\r\n                    this._con_f_used[o * 1] = u\r\n                }\r\n            }\r\n            this._colls_loaded = true\r\n        }\r\n    }\r\n}\r\nfunction dhtmlXGridCellObject(a) {\r\n    this.destructor = function() {\r\n        this.cell.obj = null ;\r\n        this.cell = null ;\r\n        this.grid = null ;\r\n        this.base = null ;\r\n        return null \r\n    }\r\n    ;\r\n    this.cell = a;\r\n    this.getValue = function() {\r\n        if ((this.cell.textContent) && (this.cell.textContent.tagName == \"TEXTAREA\")) {\r\n            return this.cell.textContent.value\r\n        } else {\r\n            return this.cell.innerHTML._dhx_trim()\r\n        }\r\n    }\r\n    ;\r\n    this.getMathValue = function() {\r\n        if (this.cell.original) {\r\n            return this.cell.original\r\n        } else {\r\n            return this.getValue()\r\n        }\r\n    }\r\n    ;\r\n    this.getFont = function() {\r\n        arOut = new Array(3);\r\n        if (this.cell.style.fontFamily) {\r\n            arOut[0] = this.cell.style.fontFamily\r\n        }\r\n        if (this.cell.style.fontWeight == \"bold\" || this.cell.parentNode.style.fontWeight == \"bold\") {\r\n            arOut[1] = \"bold\"\r\n        }\r\n        if (this.cell.style.fontStyle == \"italic\" || this.cell.parentNode.style.fontWeight == \"italic\") {\r\n            arOut[1] += \"italic\"\r\n        }\r\n        if (this.cell.style.fontSize) {\r\n            arOut[2] = this.cell.style.fontSize\r\n        } else {\r\n            arOut[2] = \"\"\r\n        }\r\n        return arOut.join(\"-\")\r\n    }\r\n    ;\r\n    this.getTextColor = function() {\r\n        if (this.cell.style.color) {\r\n            return this.cell.style.color\r\n        } else {\r\n            return \"#000000\"\r\n        }\r\n    }\r\n    ;\r\n    this.getBgColor = function() {\r\n        return this.cell.style.backgroundColor || \"#FFFFFF\"\r\n    }\r\n    ;\r\n    this.getHorAlign = function() {\r\n        if (this.cell.style.textAlign) {\r\n            return this.cell.style.textAlign\r\n        } else {\r\n            if (this.cell.style.textAlign) {\r\n                return this.cell.style.textAlign\r\n            } else {\r\n                return \"left\"\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getWidth = function() {\r\n        return this.cell.scrollWidth\r\n    }\r\n    ;\r\n    this.setFont = function(c) {\r\n        fntAr = c.split(\"-\");\r\n        this.cell.style.fontFamily = fntAr[0];\r\n        this.cell.style.fontSize = fntAr[fntAr.length - 1];\r\n        if (fntAr.length == 3) {\r\n            if (/bold/.test(fntAr[1])) {\r\n                this.cell.style.fontWeight = \"bold\"\r\n            }\r\n            if (/italic/.test(fntAr[1])) {\r\n                this.cell.style.fontStyle = \"italic\"\r\n            }\r\n            if (/underline/.test(fntAr[1])) {\r\n                this.cell.style.textDecoration = \"underline\"\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setTextColor = function(c) {\r\n        this.cell.style.color = c\r\n    }\r\n    ;\r\n    this.setBgColor = function(c) {\r\n        if (c == \"\") {\r\n            c = null \r\n        }\r\n        this.cell.style.background = c\r\n    }\r\n    ;\r\n    this.setHorAlign = function(c) {\r\n        if (c.length == 1) {\r\n            if (c == \"c\") {\r\n                this.cell.style.textAlign = \"center\"\r\n            } else {\r\n                if (c == \"l\") {\r\n                    this.cell.style.textAlign = \"left\"\r\n                } else {\r\n                    this.cell.style.textAlign = \"right\"\r\n                }\r\n            }\r\n        } else {\r\n            this.cell.style.textAlign = c\r\n        }\r\n    }\r\n    ;\r\n    this.wasChanged = function() {\r\n        if (this.cell.wasChanged) {\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.isCheckbox = function() {\r\n        var c = this.cell.firstChild;\r\n        if (c && c.tagName == \"INPUT\") {\r\n            type = c.type;\r\n            if (type == \"radio\" || type == \"checkbox\") {\r\n                return true\r\n            } else {\r\n                return false\r\n            }\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.isChecked = function() {\r\n        if (this.isCheckbox()) {\r\n            return this.cell.firstChild.checked\r\n        }\r\n    }\r\n    ;\r\n    this.isDisabled = function() {\r\n        return this.cell._disabled\r\n    }\r\n    ;\r\n    this.setChecked = function(c) {\r\n        if (this.isCheckbox()) {\r\n            if (c != \"true\" && c != 1) {\r\n                c = false\r\n            }\r\n            this.cell.firstChild.checked = c\r\n        }\r\n    }\r\n    ;\r\n    this.setDisabled = function(c) {\r\n        if (c != \"true\" && c != 1) {\r\n            c = false\r\n        }\r\n        if (this.isCheckbox()) {\r\n            this.cell.firstChild.disabled = c;\r\n            if (this.disabledF) {\r\n                this.disabledF(c)\r\n            }\r\n        }\r\n        this.cell._disabled = c\r\n    }\r\n}\r\ndhtmlXGridCellObject.prototype = {\r\n    getAttribute: function(a) {\r\n        return this.cell._attrs[a]\r\n    },\r\n    setAttribute: function(a, c) {\r\n        this.cell._attrs[a] = c\r\n    },\r\n    getInput: function() {\r\n        if (this.obj && (this.obj.tagName == \"INPUT\" || this.obj.tagName == \"TEXTAREA\")) {\r\n            return this.obj\r\n        }\r\n        var a = (this.obj || this.cell).getElementsByTagName(\"TEXTAREA\");\r\n        if (!a.length) {\r\n            a = (this.obj || this.cell).getElementsByTagName(\"INPUT\")\r\n        }\r\n        return a[0]\r\n    }\r\n};\r\ndhtmlXGridCellObject.prototype.setValue = function(a) {\r\n    if ((typeof (a) != \"number\") && (!a || a.toString()._dhx_trim() == \"\")) {\r\n        a = \"&nbsp;\";\r\n        this.cell._clearCell = true\r\n    } else {\r\n        this.cell._clearCell = false\r\n    }\r\n    this.setCValue(a)\r\n}\r\n;\r\ndhtmlXGridCellObject.prototype.getTitle = function() {\r\n    return ( _isIE ? this.cell.innerText : this.cell.textContent) \r\n}\r\n;\r\ndhtmlXGridCellObject.prototype.setCValue = function(c, a) {\r\n    this.cell.innerHTML = c;\r\n    this.grid.callEvent(\"onCellChanged\", [this.cell.parentNode.idd, this.cell._cellIndex, (arguments.length > 1 ? a : c)])\r\n}\r\n;\r\ndhtmlXGridCellObject.prototype.setCTxtValue = function(a) {\r\n    this.cell.innerHTML = \"\";\r\n    this.cell.appendChild(document.createTextNode(a));\r\n    this.grid.callEvent(\"onCellChanged\", [this.cell.parentNode.idd, this.cell._cellIndex, a])\r\n}\r\n;\r\ndhtmlXGridCellObject.prototype.setLabel = function(a) {\r\n    this.cell.innerHTML = a\r\n}\r\n;\r\ndhtmlXGridCellObject.prototype.getMath = function() {\r\n    if (this._val) {\r\n        return this.val\r\n    } else {\r\n        return this.getValue()\r\n    }\r\n}\r\n;\r\nfunction eXcell() {\r\n    this.obj = null ;\r\n    this.val = null ;\r\n    this.changeState = function() {\r\n        return false\r\n    }\r\n    ;\r\n    this.edit = function() {\r\n        this.val = this.getValue()\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        return false\r\n    }\r\n    ;\r\n    this.getPosition = function(g) {\r\n        var a = g;\r\n        var e = 0;\r\n        var c = 0;\r\n        while (a.tagName != \"BODY\") {\r\n            e += a.offsetLeft;\r\n            c += a.offsetTop;\r\n            a = a.offsetParent\r\n        }\r\n        return new Array(e,c)\r\n    }\r\n}\r\neXcell.prototype = new dhtmlXGridCellObject;\r\nfunction eXcell_ed(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.edit = function() {\r\n        this.cell.atag = (!this.grid.multiLine) ? \"INPUT\" : \"TEXTAREA\";\r\n        this.val = this.getValue();\r\n        this.obj = document.createElement(this.cell.atag);\r\n        this.obj.setAttribute(\"autocomplete\", \"off\");\r\n        this.obj.style.height = (this.cell.offsetHeight - (_isIE ? 4 : 4)) + \"px\";\r\n        this.obj.className = \"dhx_combo_edit\";\r\n        this.obj.wrap = \"soft\";\r\n        this.obj.style.textAlign = this.cell.style.textAlign;\r\n        this.obj.onclick = function(c) {\r\n            (c || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.obj.onmousedown = function(c) {\r\n            (c || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.obj.value = this.val;\r\n        this.cell.innerHTML = \"\";\r\n        this.cell.appendChild(this.obj);\r\n        this.obj.onselectstart = function(c) {\r\n            if (!c) {\r\n                c = event\r\n            }\r\n            c.cancelBubble = true;\r\n            return true\r\n        }\r\n        ;\r\n        if (_isIE) {\r\n            this.obj.focus();\r\n            this.obj.blur()\r\n        }\r\n        this.obj.focus()\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        if ((this.cell.firstChild) && ((this.cell.atag) && (this.cell.firstChild.tagName == this.cell.atag))) {\r\n            return this.cell.firstChild.value\r\n        }\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        return this.cell.innerHTML.toString()._dhx_trim()\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        this.setValue(this.obj.value);\r\n        return this.val != this.getValue()\r\n    }\r\n}\r\neXcell_ed.prototype = new eXcell;\r\nfunction eXcell_edtxt(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.getValue = function() {\r\n        if ((this.cell.firstChild) && ((this.cell.atag) && (this.cell.firstChild.tagName == this.cell.atag))) {\r\n            return this.cell.firstChild.value\r\n        }\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        return ( _isIE ? this.cell.innerText : this.cell.textContent) \r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        if (!c || c.toString()._dhx_trim() == \"\") {\r\n            c = \" \";\r\n            this.cell._clearCell = true\r\n        } else {\r\n            this.cell._clearCell = false\r\n        }\r\n        this.setCTxtValue(c)\r\n    }\r\n}\r\neXcell_edtxt.prototype = new eXcell_ed;\r\nfunction eXcell_edn(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.getValue = function() {\r\n        if ((this.cell.firstChild) && (this.cell.firstChild.tagName == \"TEXTAREA\")) {\r\n            return this.cell.firstChild.value\r\n        }\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        return this.cell._orig_value || this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(), this.cell._cellIndex)\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        var c = this.obj.value;\r\n        this.setValue(c);\r\n        return this.val != this.getValue()\r\n    }\r\n}\r\neXcell_edn.prototype = new eXcell_ed;\r\neXcell_edn.prototype.setValue = function(a) {\r\n    if (!a || a.toString()._dhx_trim() == \"\") {\r\n        this.cell._clearCell = true;\r\n        return this.setCValue(\"&nbsp;\", 0)\r\n    } else {\r\n        this.cell._clearCell = false;\r\n        this.cell._orig_value = a\r\n    }\r\n    this.setCValue(this.grid._aplNF(a, this.cell._cellIndex), a)\r\n}\r\n;\r\nfunction eXcell_ch(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.disabledF = function(c) {\r\n        if ((c == true) || (c == 1)) {\r\n            this.cell.innerHTML = this.cell.innerHTML.replace(\"item_chk0.\", \"item_chk0_dis.\").replace(\"item_chk1.\", \"item_chk1_dis.\")\r\n        } else {\r\n            this.cell.innerHTML = this.cell.innerHTML.replace(\"item_chk0_dis.\", \"item_chk0.\").replace(\"item_chk1_dis.\", \"item_chk1.\")\r\n        }\r\n    }\r\n    ;\r\n    this.changeState = function(c) {\r\n        if (c === true && !this.grid.isActive) {\r\n            if (window.globalActiveDHTMLGridObject != null  && window.globalActiveDHTMLGridObject != this.grid && window.globalActiveDHTMLGridObject.isActive) {\r\n                window.globalActiveDHTMLGridObject.setActive(false)\r\n            }\r\n            this.grid.setActive(true)\r\n        }\r\n        if ((!this.grid.isEditable) || (this.cell.parentNode._locked) || (this.isDisabled())) {\r\n            return\r\n        }\r\n        if (this.grid.callEvent(\"onEditCell\", [0, this.cell.parentNode.idd, this.cell._cellIndex])) {\r\n            this.val = this.getValue();\r\n            if (this.val == \"1\") {\r\n                this.setValue(\"0\")\r\n            } else {\r\n                this.setValue(\"1\")\r\n            }\r\n            this.cell.wasChanged = true;\r\n            this.grid.callEvent(\"onEditCell\", [1, this.cell.parentNode.idd, this.cell._cellIndex]);\r\n            this.grid.callEvent(\"onCheckbox\", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != \"1\")]);\r\n            this.grid.callEvent(\"onCheck\", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != \"1\")])\r\n        } else {\r\n            this.editor = null \r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.cell.chstate ? this.cell.chstate.toString() : \"0\"\r\n    }\r\n    ;\r\n    this.isCheckbox = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.isChecked = function() {\r\n        if (this.getValue() == \"1\") {\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.setChecked = function(c) {\r\n        this.setValue(c.toString())\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        return this.val != this.getValue()\r\n    }\r\n    ;\r\n    this.edit = null \r\n}\r\neXcell_ch.prototype = new eXcell;\r\neXcell_ch.prototype.setValue = function(c) {\r\n    this.cell.style.verticalAlign = \"middle\";\r\n    if (c) {\r\n        c = c.toString()._dhx_trim();\r\n        if ((c == \"false\") || (c == \"0\")) {\r\n            c = \"\"\r\n        }\r\n    }\r\n    if (c) {\r\n        c = \"1\";\r\n        this.cell.chstate = \"1\"\r\n    } else {\r\n        c = \"0\";\r\n        this.cell.chstate = \"0\"\r\n    }\r\n    var a = this;\r\n    this.setCValue(\"<img src='\" + this.grid.imgURL + \"item_chk\" + c + \".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>\", this.cell.chstate)\r\n}\r\n;\r\nfunction eXcell_ra(a) {\r\n    this.base = eXcell_ch;\r\n    this.base(a);\r\n    this.grid = a.parentNode.grid;\r\n    this.disabledF = function(c) {\r\n        if ((c == true) || (c == 1)) {\r\n            this.cell.innerHTML = this.cell.innerHTML.replace(\"radio_chk0.\", \"radio_chk0_dis.\").replace(\"radio_chk1.\", \"radio_chk1_dis.\")\r\n        } else {\r\n            this.cell.innerHTML = this.cell.innerHTML.replace(\"radio_chk0_dis.\", \"radio_chk0.\").replace(\"radio_chk1_dis.\", \"radio_chk1.\")\r\n        }\r\n    }\r\n    ;\r\n    this.changeState = function(c) {\r\n        if (c === false && this.getValue() == 1) {\r\n            return\r\n        }\r\n        if ((!this.grid.isEditable) || (this.cell.parentNode._locked) || (this.isDisabled())) {\r\n            return\r\n        }\r\n        if (this.grid.callEvent(\"onEditCell\", [0, this.cell.parentNode.idd, this.cell._cellIndex]) != false) {\r\n            this.val = this.getValue();\r\n            if (this.val == \"1\") {\r\n                this.setValue(\"0\")\r\n            } else {\r\n                this.setValue(\"1\")\r\n            }\r\n            this.cell.wasChanged = true;\r\n            this.grid.callEvent(\"onEditCell\", [1, this.cell.parentNode.idd, this.cell._cellIndex]);\r\n            this.grid.callEvent(\"onCheckbox\", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != \"1\")]);\r\n            this.grid.callEvent(\"onCheck\", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != \"1\")])\r\n        } else {\r\n            this.editor = null \r\n        }\r\n    }\r\n    ;\r\n    this.edit = null \r\n}\r\neXcell_ra.prototype = new eXcell_ch;\r\neXcell_ra.prototype.setValue = function(c) {\r\n    this.cell.style.verticalAlign = \"middle\";\r\n    if (c) {\r\n        c = c.toString()._dhx_trim();\r\n        if ((c == \"false\") || (c == \"0\")) {\r\n            c = \"\"\r\n        }\r\n    }\r\n    if (c) {\r\n        if (!this.grid._RaSeCol) {\r\n            this.grid._RaSeCol = []\r\n        }\r\n        if (this.grid._RaSeCol[this.cell._cellIndex]) {\r\n            var a = this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);\r\n            a.setValue(\"0\");\r\n            if (this.grid.rowsAr[a.cell.parentNode.idd]) {\r\n                this.grid.callEvent(\"onEditCell\", [1, a.cell.parentNode.idd, a.cell._cellIndex])\r\n            }\r\n        }\r\n        this.grid._RaSeCol[this.cell._cellIndex] = this.cell;\r\n        c = \"1\";\r\n        this.cell.chstate = \"1\"\r\n    } else {\r\n        c = \"0\";\r\n        this.cell.chstate = \"0\"\r\n    }\r\n    this.setCValue(\"<img src='\" + this.grid.imgURL + \"radio_chk\" + c + \".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>\", this.cell.chstate)\r\n}\r\n;\r\nfunction eXcell_txt(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.edit = function() {\r\n        this.val = this.getValue();\r\n        this.obj = document.createElement(\"TEXTAREA\");\r\n        this.obj.className = \"dhx_textarea\";\r\n        this.obj.onclick = function(g) {\r\n            (g || event).cancelBubble = true\r\n        }\r\n        ;\r\n        var c = this.grid.getPosition(this.cell);\r\n        this.obj.value = this.val;\r\n        this.obj.style.display = \"\";\r\n        this.obj.style.textAlign = this.cell.style.textAlign;\r\n        document.body.appendChild(this.obj);\r\n        if (_isOpera) {\r\n            this.obj.onkeypress = function(g) {\r\n                if (g.keyCode == 9 || g.keyCode == 27) {\r\n                    return false\r\n                }\r\n            }\r\n        }\r\n        this.obj.onkeydown = function(h) {\r\n            var g = (h || event);\r\n            if (g.keyCode == 9 || g.keyCode == 27) {\r\n                globalActiveDHTMLGridObject.entBox.focus();\r\n                globalActiveDHTMLGridObject.doKey({\r\n                    keyCode: g.keyCode,\r\n                    shiftKey: g.shiftKey,\r\n                    srcElement: \"0\"\r\n                });\r\n                return false\r\n            }\r\n        }\r\n        ;\r\n        this.obj.style.left = c[0] + \"px\";\r\n        this.obj.style.top = c[1] + this.cell.offsetHeight + \"px\";\r\n        if (this.cell.offsetWidth < 200) {\r\n            var e = 200\r\n        } else {\r\n            var e = this.cell.offsetWidth\r\n        }\r\n        this.obj.style.width = e + 16 + \"px\";\r\n        if (_isIE) {\r\n            this.obj.select();\r\n            this.obj.value = this.obj.value\r\n        }\r\n        this.obj.focus()\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        var c = \"\";\r\n        c = this.obj.value;\r\n        if (c == \"\") {\r\n            this.cell._clearCell = true\r\n        } else {\r\n            this.cell._clearCell = false\r\n        }\r\n        this.setValue(c);\r\n        document.body.removeChild(this.obj);\r\n        this.obj = null ;\r\n        return this.val != this.getValue()\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        if (this.obj) {\r\n            return this.obj.value\r\n        }\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        if (typeof this.cell._brval != \"undefined\") {\r\n            return this.cell._brval\r\n        }\r\n        if ((!this.grid.multiLine) ) {\r\n            return this.cell._brval || this.cell.innerHTML\r\n        } else {\r\n            return this.cell._brval || this.cell.innerHTML.replace(/<br[^>]*>/gi, \"\\n\")._dhx_trim()\r\n        }\r\n    }\r\n}\r\neXcell_txt.prototype = new eXcell;\r\nfunction eXcell_txttxt(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.getValue = function() {\r\n        if ((this.cell.firstChild) && (this.cell.firstChild.tagName == \"TEXTAREA\")) {\r\n            return this.cell.firstChild.value\r\n        }\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        if ((!this.grid.multiLine) && this.cell._brval) {\r\n            return this.cell._brval\r\n        }\r\n        return ( _isIE ? this.cell.innerText : this.cell.textContent) \r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        this.cell._brval = c;\r\n        if (!c || c.toString()._dhx_trim() == \"\") {\r\n            c = \" \";\r\n            this.cell._clearCell = true\r\n        } else {\r\n            this.cell._clearCell = false\r\n        }\r\n        this.setCTxtValue(c)\r\n    }\r\n}\r\neXcell_txttxt.prototype = new eXcell_txt;\r\neXcell_txt.prototype.setValue = function(a) {\r\n    this.cell._brval = a;\r\n    if (!a || a.toString()._dhx_trim() == \"\") {\r\n        a = \"&nbsp;\";\r\n        this.cell._clearCell = true\r\n    } else {\r\n        this.cell._clearCell = false\r\n    }\r\n    if ((!this.grid.multiLine) || this.cell._clearCell) {\r\n        this.setCValue(a, this.cell._brval)\r\n    } else {\r\n        this.setCValue(a.replace(/\\n/g, \"<br/>\"), a)\r\n    }\r\n}\r\n;\r\nfunction eXcell_co(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        this.combo = (this.cell._combo || this.grid.getCombo(this.cell._cellIndex));\r\n        this.editable = true\r\n    }\r\n    this.shiftNext = function() {\r\n        var c = this.list.options[this.list.selectedIndex + 1];\r\n        if (c) {\r\n            c.selected = true\r\n        }\r\n        this.obj.value = this.list.options[this.list.selectedIndex].text;\r\n        return true\r\n    }\r\n    ;\r\n    this.shiftPrev = function() {\r\n        if (this.list.selectedIndex != 0) {\r\n            var c = this.list.options[this.list.selectedIndex - 1];\r\n            if (c) {\r\n                c.selected = true\r\n            }\r\n            this.obj.value = this.list.options[this.list.selectedIndex].text\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    this.edit = function() {\r\n        this.val = this.getValue();\r\n        this.text = this.getText()._dhx_trim();\r\n        var g = this.grid.getPosition(this.cell);\r\n        this.obj = document.createElement(\"TEXTAREA\");\r\n        this.obj.className = \"dhx_combo_edit\";\r\n        this.obj.style.height = (this.cell.offsetHeight - (_isIE ? 4 : 4)) + \"px\";\r\n        this.obj.wrap = \"soft\";\r\n        this.obj.style.textAlign = this.cell.style.textAlign;\r\n        this.obj.onclick = function(o) {\r\n            (o || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.obj.onmousedown = function(o) {\r\n            (o || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.obj.value = this.text;\r\n        this.obj.onselectstart = function(o) {\r\n            if (!o) {\r\n                o = event\r\n            }\r\n            o.cancelBubble = true;\r\n            return true\r\n        }\r\n        ;\r\n        var l = this;\r\n        this.obj.onkeyup = function(s) {\r\n            var r = (s || event).keyCode;\r\n            if (r == 38 || r == 40 || r == 9) {\r\n                return\r\n            }\r\n            var u = this.readonly ? String.fromCharCode(r) : this.value;\r\n            var v = l.list.options;\r\n            for (var o = 0; o < v.length; o++) {\r\n                if (v[o].text.indexOf(u) == 0) {\r\n                    return v[o].selected = true\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        this.list = document.createElement(\"SELECT\");\r\n        this.list.className = \"dhx_combo_select\";\r\n        this.list.style.width = this.cell.offsetWidth + \"px\";\r\n        this.list.style.left = g[0] + \"px\";\r\n        this.list.style.top = g[1] + this.cell.offsetHeight + \"px\";\r\n        this.list.onclick = function(s) {\r\n            var r = s || window.event;\r\n            var o = r.target || r.srcElement;\r\n            if (o.tagName == \"OPTION\") {\r\n                o = o.parentNode\r\n            }\r\n            l.editable = false;\r\n            l.grid.editStop();\r\n            r.cancelBubble = true\r\n        }\r\n        ;\r\n        var c = this.combo.getKeys();\r\n        var h = false;\r\n        var n = 0;\r\n        for (var e = 0; e < c.length; e++) {\r\n            var m = this.combo.get(c[e]);\r\n            this.list.options[this.list.options.length] = new Option(m,c[e]);\r\n            if (c[e] == this.val) {\r\n                n = this.list.options.length - 1;\r\n                h = true\r\n            }\r\n        }\r\n        if (h == false) {\r\n            this.list.options[this.list.options.length] = new Option(this.text,this.val === null  ? \"\" : this.val);\r\n            n = this.list.options.length - 1\r\n        }\r\n        document.body.appendChild(this.list);\r\n        this.list.size = \"6\";\r\n        this.cstate = 1;\r\n        if (this.editable) {\r\n            this.cell.innerHTML = \"\"\r\n        } else {\r\n            this.obj.style.width = \"1px\";\r\n            this.obj.style.height = \"1px\"\r\n        }\r\n        this.cell.appendChild(this.obj);\r\n        this.list.options[n].selected = true;\r\n        if (this.editable) {\r\n            this.obj.focus();\r\n            this.obj.focus()\r\n        }\r\n        if (!this.editable) {\r\n            this.obj.style.visibility = \"hidden\";\r\n            this.list.focus();\r\n            this.list.onkeydown = function(o) {\r\n                o = o || window.event;\r\n                l.grid.setActive(true);\r\n                if (o.keyCode < 30) {\r\n                    return l.grid.doKey({\r\n                        target: l.cell,\r\n                        keyCode: o.keyCode,\r\n                        shiftKey: o.shiftKey,\r\n                        ctrlKey: o.ctrlKey\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return ( (this.cell.combo_value == window.undefined) ? \"\" : this.cell.combo_value) \r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        if (this.val != this.getValue()) {\r\n            this.cell.wasChanged = true\r\n        }\r\n        if (this.list.parentNode != null ) {\r\n            if (this.editable) {\r\n                var c = this.list.options[this.list.selectedIndex];\r\n                if (c && c.text == this.obj.value) {\r\n                    this.setValue(this.list.value)\r\n                } else {\r\n                    var e = (this.cell._combo || this.grid.getCombo(this.cell._cellIndex));\r\n                    var g = e.values._dhx_find(this.obj.value);\r\n                    if (g != -1) {\r\n                        this.setValue(e.keys[g])\r\n                    } else {\r\n                        this.setValue(this.cell.combo_value = this.obj.value)\r\n                    }\r\n                }\r\n            } else {\r\n                this.setValue(this.list.value)\r\n            }\r\n        }\r\n        if (this.list.parentNode) {\r\n            this.list.parentNode.removeChild(this.list)\r\n        }\r\n        if (this.obj.parentNode) {\r\n            this.obj.parentNode.removeChild(this.obj)\r\n        }\r\n        return this.val != this.getValue()\r\n    }\r\n}\r\neXcell_co.prototype = new eXcell;\r\neXcell_co.prototype.getText = function() {\r\n    return this.cell.innerHTML\r\n}\r\n;\r\neXcell_co.prototype.setValue = function(g) {\r\n    if (typeof (g) == \"object\") {\r\n        var e = dhx4.ajax.xpath(\"./option\", g);\r\n        if (e.length) {\r\n            this.cell._combo = new dhtmlXGridComboObject()\r\n        }\r\n        for (var c = 0; c < e.length; c++) {\r\n            this.cell._combo.put(e[c].getAttribute(\"value\"), e[c].firstChild ? e[c].firstChild.data : \"\")\r\n        }\r\n        g = g.firstChild.data\r\n    }\r\n    if ((g || \"\").toString()._dhx_trim() == \"\") {\r\n        g = null \r\n    }\r\n    this.cell.combo_value = g;\r\n    if (g !== null ) {\r\n        var a = (this.cell._combo || this.grid.getCombo(this.cell._cellIndex)).get(g);\r\n        this.setCValue(a === null  ? g : a, g)\r\n    } else {\r\n        this.setCValue(\"&nbsp;\", g)\r\n    }\r\n}\r\n;\r\nfunction eXcell_coro(a) {\r\n    this.base = eXcell_co;\r\n    this.base(a);\r\n    this.editable = false\r\n}\r\neXcell_coro.prototype = new eXcell_co;\r\nfunction eXcell_cotxt(a) {\r\n    this.base = eXcell_co;\r\n    this.base(a)\r\n}\r\neXcell_cotxt.prototype = new eXcell_co;\r\neXcell_cotxt.prototype.getText = function() {\r\n    return ( _isIE ? this.cell.innerText : this.cell.textContent) \r\n}\r\n;\r\neXcell_cotxt.prototype.setValue = function(e) {\r\n    if (typeof (e) == \"object\") {\r\n        var c = dhx4.ajax.xpath(\"./option\", e);\r\n        if (c.length) {\r\n            this.cell._combo = new dhtmlXGridComboObject()\r\n        }\r\n        for (var a = 0; a < c.length; a++) {\r\n            this.cell._combo.put(c[a].getAttribute(\"value\"), c[a].firstChild ? c[a].firstChild.data : \"\")\r\n        }\r\n        e = e.firstChild.data\r\n    }\r\n    if ((e || \"\").toString()._dhx_trim() == \"\") {\r\n        e = null \r\n    }\r\n    if (e !== null ) {\r\n        this.setCTxtValue((this.cell._combo || this.grid.getCombo(this.cell._cellIndex)).get(e) || e, e)\r\n    } else {\r\n        this.setCTxtValue(\" \", e)\r\n    }\r\n    this.cell.combo_value = e\r\n}\r\n;\r\nfunction eXcell_corotxt(a) {\r\n    this.base = eXcell_co;\r\n    this.base(a);\r\n    this.editable = false\r\n}\r\neXcell_corotxt.prototype = new eXcell_cotxt;\r\nfunction eXcell_cp(a) {\r\n    try {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    } catch (c) {}\r\n    this.edit = function() {\r\n        this.val = this.getValue();\r\n        this.obj = document.createElement(\"SPAN\");\r\n        this.obj.style.border = \"1px solid black\";\r\n        this.obj.style.position = \"absolute\";\r\n        var e = this.grid.getPosition(this.cell);\r\n        this.colorPanel(4, this.obj);\r\n        document.body.appendChild(this.obj);\r\n        this.obj.style.left = e[0] + \"px\";\r\n        this.obj.style.zIndex = 1000;\r\n        this.obj.style.top = e[1] + this.cell.offsetHeight + \"px\"\r\n    }\r\n    ;\r\n    this.toolDNum = function(e) {\r\n        if (e.length == 1) {\r\n            e = \"0\" + e\r\n        }\r\n        return e\r\n    }\r\n    ;\r\n    this.colorPanel = function(s, w) {\r\n        var m = document.createElement(\"TABLE\");\r\n        w.appendChild(m);\r\n        m.cellSpacing = 0;\r\n        m.editor_obj = this;\r\n        m.style.cursor = \"default\";\r\n        m.onclick = function(y) {\r\n            var x = y || window.event;\r\n            var n = x.target || x.srcElement;\r\n            var r = n.parentNode.parentNode.parentNode.editor_obj;\r\n            if (r) {\r\n                r.setValue(n._bg);\r\n                r.grid.editStop()\r\n            }\r\n        }\r\n        ;\r\n        var h = 256 / s;\r\n        for (var l = 0; l <= (256 / h); l++) {\r\n            var e = m.insertRow(l);\r\n            for (var o = 0; o <= (256 / h); o++) {\r\n                for (var g = 0; g <= (256 / h); g++) {\r\n                    R = new Number(h * l) - (l == 0 ? 0 : 1);\r\n                    G = new Number(h * o) - (o == 0 ? 0 : 1);\r\n                    B = new Number(h * g) - (g == 0 ? 0 : 1);\r\n                    var v = this.toolDNum(R.toString(16)) + \"\" + this.toolDNum(G.toString(16)) + \"\" + this.toolDNum(B.toString(16));\r\n                    var u = e.insertCell(o);\r\n                    u.width = \"10px\";\r\n                    u.innerHTML = \"&nbsp;\";\r\n                    u.title = v.toUpperCase();\r\n                    u.style.backgroundColor = \"#\" + v;\r\n                    u._bg = \"#\" + v;\r\n                    if (this.val != null  && \"#\" + v.toUpperCase() == this.val.toUpperCase()) {\r\n                        u.style.border = \"2px solid white\"\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.cell.firstChild._bg || \"\"\r\n    }\r\n    ;\r\n    this.getRed = function() {\r\n        return Number(parseInt(this.getValue().substr(1, 2), 16))\r\n    }\r\n    ;\r\n    this.getGreen = function() {\r\n        return Number(parseInt(this.getValue().substr(3, 2), 16))\r\n    }\r\n    ;\r\n    this.getBlue = function() {\r\n        return Number(parseInt(this.getValue().substr(5, 2), 16))\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        if (this.obj.offsetParent != null ) {\r\n            document.body.removeChild(this.obj)\r\n        }\r\n        return this.val != this.getValue()\r\n    }\r\n}\r\neXcell_cp.prototype = new eXcell;\r\neXcell_cp.prototype.setValue = function(a) {\r\n    this.setCValue(\"<div style='width:100%;height:\" + ((this.grid.multiLine ? \"100%\" : 23)) + \";background-color:\" + (a || \"\") + \";border:0px;'>&nbsp;</div>\", a);\r\n    this.cell.firstChild._bg = a\r\n}\r\n;\r\nfunction eXcell_img(a) {\r\n    try {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    } catch (c) {}\r\n    this.getValue = function() {\r\n        if (this.cell.firstChild.tagName == \"IMG\") {\r\n            return this.cell.firstChild.src + (this.cell.titFl != null  ? \"^\" + this.cell._brval : \"\")\r\n        } else {\r\n            if (this.cell.firstChild.tagName == \"A\") {\r\n                var e = this.cell.firstChild.firstChild.src + (this.cell.titFl != null  ? \"^\" + this.cell._brval : \"\");\r\n                e += \"^\" + this.cell.lnk;\r\n                if (this.cell.trg) {\r\n                    e += \"^\" + this.cell.trg\r\n                }\r\n                return e\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n}\r\neXcell_img.prototype = new eXcell;\r\neXcell_img.prototype.getTitle = function() {\r\n    return this.cell._brval\r\n}\r\n;\r\neXcell_img.prototype.setValue = function(e) {\r\n    var c = e;\r\n    if ((e || \"\").indexOf(\"^\") != -1) {\r\n        var a = e.split(\"^\");\r\n        e = a[0];\r\n        c = this.cell._attrs.title || a[1];\r\n        if (a.length > 2) {\r\n            this.cell.lnk = a[2];\r\n            if (a[3]) {\r\n                this.cell.trg = a[3]\r\n            }\r\n        }\r\n        this.cell.titFl = \"1\"\r\n    }\r\n    if (!this.grid.multiLine) {\r\n        this.setCValue(\"<img src='\" + this.grid.iconURL + (e || \"\")._dhx_trim() + \"' border='0' style='max-height:\" + (this.grid._srdh - 4) + \"px'>\", e)\r\n    } else {\r\n        this.setCValue(\"<img src='\" + this.grid.iconURL + (e || \"\")._dhx_trim() + \"' border='0'>\", e)\r\n    }\r\n    if (this.cell.lnk) {\r\n        this.cell.innerHTML = \"<a href='\" + this.cell.lnk + \"' target='\" + this.cell.trg + \"'>\" + this.cell.innerHTML + \"</a>\"\r\n    }\r\n    this.cell._brval = c\r\n}\r\n;\r\nfunction eXcell_price(a) {\r\n    this.base = eXcell_ed;\r\n    this.base(a);\r\n    this.getValue = function() {\r\n        if (this.cell.childNodes.length > 1) {\r\n            return this.cell.childNodes[1].innerHTML.toString()._dhx_trim()\r\n        } else {\r\n            return \"0\"\r\n        }\r\n    }\r\n}\r\neXcell_price.prototype = new eXcell_ed;\r\neXcell_price.prototype.setValue = function(c) {\r\n    if (isNaN(parseFloat(c))) {\r\n        c = this.val || 0\r\n    }\r\n    var a = \"green\";\r\n    if (c < 0) {\r\n        a = \"red\"\r\n    }\r\n    this.setCValue(\"<span>$</span><span style='padding-right:2px;color:\" + a + \";'>\" + c + \"</span>\", c)\r\n}\r\n;\r\nfunction eXcell_dyn(a) {\r\n    this.base = eXcell_ed;\r\n    this.base(a);\r\n    this.getValue = function() {\r\n        return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()\r\n    }\r\n}\r\neXcell_dyn.prototype = new eXcell_ed;\r\neXcell_dyn.prototype.setValue = function(e) {\r\n    if (!e || isNaN(Number(e))) {\r\n        if (e !== \"\") {\r\n            e = 0\r\n        }\r\n    }\r\n    if (e > 0) {\r\n        var c = \"green\";\r\n        var a = \"dyn_up.gif\"\r\n    } else {\r\n        if (e == 0) {\r\n            var c = \"black\";\r\n            var a = \"dyn_.gif\"\r\n        } else {\r\n            var c = \"red\";\r\n            var a = \"dyn_down.gif\"\r\n        }\r\n    }\r\n    this.setCValue(\"<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='\" + this.grid.imgURL + \"\" + a + \"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:\" + c + \";'>\" + e + \"</span></div>\", e)\r\n}\r\n;\r\nfunction eXcell_ro(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.edit = function() {}\r\n    ;\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.cell._clearCell ? \"\" : this.cell.innerHTML.toString()._dhx_trim()\r\n    }\r\n}\r\neXcell_ro.prototype = new eXcell;\r\nwindow.eXcell_hidden = function(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.edit = function() {}\r\n    ;\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.cell.val\r\n    }\r\n}\r\n;\r\neXcell_hidden.prototype = new eXcell;\r\neXcell_hidden.prototype.setValue = function(a) {\r\n    this.cell.val = a\r\n}\r\n;\r\nfunction eXcell_ron(a) {\r\n    this.cell = a;\r\n    this.grid = this.cell.parentNode.grid;\r\n    this.edit = function() {}\r\n    ;\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.cell._clearCell ? \"\" : this.cell._orig_value || this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(), this.cell._cellIndex).toString()\r\n    }\r\n}\r\neXcell_ron.prototype = new eXcell;\r\neXcell_ron.prototype.setValue = function(a) {\r\n    if (a === 0) {} else {\r\n        if (!a || a.toString()._dhx_trim() == \"\") {\r\n            this.setCValue(\"&nbsp;\");\r\n            return this.cell._clearCell = true\r\n        }\r\n    }\r\n    this.cell._orig_value = a;\r\n    this.cell._clearCell = false;\r\n    this.setCValue(a ? this.grid._aplNF(a, this.cell._cellIndex) : \"0\")\r\n}\r\n;\r\nfunction eXcell_rotxt(a) {\r\n    this.cell = a;\r\n    this.grid = this.cell.parentNode.grid;\r\n    this.edit = function() {}\r\n    ;\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        if (!c) {\r\n            c = \" \";\r\n            this.cell._clearCell = true\r\n        } else {\r\n            this.cell._clearCell = false\r\n        }\r\n        this.setCTxtValue(c)\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        return ( _isIE ? this.cell.innerText : this.cell.textContent) \r\n    }\r\n}\r\neXcell_rotxt.prototype = new eXcell;\r\nfunction dhtmlXGridComboObject() {\r\n    this.keys = new dhtmlxArray();\r\n    this.values = new dhtmlxArray();\r\n    this.put = function(c, e) {\r\n        for (var a = 0; a < this.keys.length; a++) {\r\n            if (this.keys[a] == c) {\r\n                this.values[a] = e;\r\n                return true\r\n            }\r\n        }\r\n        this.values[this.values.length] = e;\r\n        this.keys[this.keys.length] = c\r\n    }\r\n    ;\r\n    this.get = function(c) {\r\n        for (var a = 0; a < this.keys.length; a++) {\r\n            if (this.keys[a] == c) {\r\n                return this.values[a]\r\n            }\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this.clear = function() {\r\n        this.keys = new dhtmlxArray();\r\n        this.values = new dhtmlxArray()\r\n    }\r\n    ;\r\n    this.remove = function(c) {\r\n        for (var a = 0; a < this.keys.length; a++) {\r\n            if (this.keys[a] == c) {\r\n                this.keys._dhx_removeAt(a);\r\n                this.values._dhx_removeAt(a);\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.size = function() {\r\n        var a = 0;\r\n        for (var c = 0; c < this.keys.length; c++) {\r\n            if (this.keys[c] != null ) {\r\n                a++\r\n            }\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this.getKeys = function() {\r\n        var a = new Array(0);\r\n        for (var c = 0; c < this.keys.length; c++) {\r\n            if (this.keys[c] != null ) {\r\n                a[a.length] = this.keys[c]\r\n            }\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    this.save = function() {\r\n        this._save = new Array();\r\n        for (var a = 0; a < this.keys.length; a++) {\r\n            this._save[a] = [this.keys[a], this.values[a]]\r\n        }\r\n    }\r\n    ;\r\n    this.restore = function() {\r\n        if (this._save) {\r\n            this.keys[a] = new Array();\r\n            this.values[a] = new Array();\r\n            for (var a = 0; a < this._save.length; a++) {\r\n                this.keys[a] = this._save[a][0];\r\n                this.values[a] = this._save[a][1]\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    return this\r\n}\r\nfunction Hashtable() {\r\n    this.keys = new dhtmlxArray();\r\n    this.values = new dhtmlxArray();\r\n    return this\r\n}\r\nHashtable.prototype = new dhtmlXGridComboObject;\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachGrid = function() {\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"grid\"]);\r\n        var a = document.createElement(\"DIV\");\r\n        a.style.width = \"100%\";\r\n        a.style.height = \"100%\";\r\n        a.style.position = \"relative\";\r\n        a.style.overflow = \"hidden\";\r\n        this._attachObject(a);\r\n        this.dataType = \"grid\";\r\n        this.dataObj = new dhtmlXGridObject(a);\r\n        this.dataObj.setSkin(this.conf.skin);\r\n        if (typeof (window.dhtmlXTabBarCell) == \"function\" && this instanceof window.dhtmlXTabBarCell && navigator.userAgent.match(/7[\\.\\d]* mobile/gi) != null  && navigator.userAgent.match(/AppleWebKit/gi) != null ) {\r\n            this.dataObj.objBox.style.webkitOverflowScrolling = \"auto\"\r\n        }\r\n        if (this.conf.skin == \"dhx_skyblue\" && typeof (window.dhtmlXWindowsCell) == \"function\" && this instanceof window.dhtmlXWindowsCell) {\r\n            this.dataObj.entBox.style.border = \"1px solid #a4bed4\";\r\n            this.dataObj._sizeFix = 0\r\n        } else {\r\n            this.dataObj.entBox.style.border = \"0px solid white\";\r\n            this.dataObj._sizeFix = 2\r\n        }\r\n        a = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataObj\r\n    }\r\n}\r\ndhtmlXGridObject.prototype.enableDragAndDrop = function(a) {\r\n    if (a == \"temporary_disabled\") {\r\n        this.dADTempOff = false;\r\n        a = true\r\n    } else {\r\n        this.dADTempOff = true\r\n    }\r\n    this.dragAndDropOff = dhx4.s2b(a);\r\n    this._drag_validate = true;\r\n    if (a) {\r\n        this.objBox.ondragstart = function(c) {\r\n            (c || event).cancelBubble = true;\r\n            return false\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setDragBehavior = function(a) {\r\n    this.dadmodec = this.dadmodefix = 0;\r\n    switch (a) {\r\n    case \"child\":\r\n        this.dadmode = 0;\r\n        this._sbmod = false;\r\n        break;\r\n    case \"sibling\":\r\n        this.dadmode = 1;\r\n        this._sbmod = false;\r\n        break;\r\n    case \"sibling-next\":\r\n        this.dadmode = 1;\r\n        this._sbmod = true;\r\n        break;\r\n    case \"complex\":\r\n        this.dadmode = 2;\r\n        this._sbmod = false;\r\n        break;\r\n    case \"complex-next\":\r\n        this.dadmode = 2;\r\n        this._sbmod = true;\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableDragOrder = function(a) {\r\n    this._dndorder = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._checkParent = function(g, c) {\r\n    var e = this._h2.get[g.idd].parent;\r\n    if (!e.parent) {\r\n        return\r\n    }\r\n    for (var a = 0; a < c.length; a++) {\r\n        if (c[a] == e.id) {\r\n            return true\r\n        }\r\n    }\r\n    return this._checkParent(this.rowsAr[e.id], c)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._createDragNode = function(g, h) {\r\n    this.editStop();\r\n    if (window.dhtmlDragAndDrop.dragNode) {\r\n        return null \r\n    }\r\n    if (!this.dADTempOff) {\r\n        return null \r\n    }\r\n    g.parentObject = new Object();\r\n    g.parentObject.treeNod = this;\r\n    var o = this.callEvent(\"onBeforeDrag\", [g.parentNode.idd, g._cellIndex, h]);\r\n    if (!o) {\r\n        return null \r\n    }\r\n    var l = new Array();\r\n    l = this.getSelectedId();\r\n    l = (((l) && (l != \"\")) ? l.split(this.delim) : []);\r\n    var m = false;\r\n    for (var c = 0; c < l.length; c++) {\r\n        if (l[c] == g.parentNode.idd) {\r\n            m = true\r\n        }\r\n    }\r\n    if (!m) {\r\n        this.selectRow(this.rowsAr[g.parentNode.idd], false, h.ctrlKey, false);\r\n        if (!h.ctrlKey) {\r\n            l = []\r\n        }\r\n        l[this.selMultiRows ? l.length : 0] = g.parentNode.idd\r\n    }\r\n    if (this.isTreeGrid()) {\r\n        for (var c = l.length - 1; c >= 0; c--) {\r\n            if (this._checkParent(this.rowsAr[l[c]], l)) {\r\n                l.splice(c, 1)\r\n            }\r\n        }\r\n    }\r\n    var r = this;\r\n    if (l.length && this._dndorder) {\r\n        l.sort(function(s, e) {\r\n            return ( r.rowsAr[s].rowIndex > r.rowsAr[e].rowIndex ? 1 : -1) \r\n        })\r\n    }\r\n    var a = this.getFirstParentOfType(_isIE ? h.srcElement : h.target, \"TD\");\r\n    if (a) {\r\n        this._dndExtra = a._cellIndex\r\n    }\r\n    this._dragged = new Array();\r\n    for (var c = 0; c < l.length; c++) {\r\n        if (this.rowsAr[l[c]]) {\r\n            this._dragged[this._dragged.length] = this.rowsAr[l[c]];\r\n            this.rowsAr[l[c]].treeNod = this\r\n        }\r\n    }\r\n    g.parentObject.parentNode = g.parentNode;\r\n    var n = document.createElement(\"div\");\r\n    n.innerHTML = (o !== true ? o : this.rowToDragElement(g.parentNode.idd));\r\n    n.style.position = \"absolute\";\r\n    n.className = \"dragSpanDiv\";\r\n    return n\r\n}\r\n;\r\ndhtmlXGridObject.prototype._createSdrgc = function() {\r\n    this._sdrgc = document.createElement(\"DIV\");\r\n    this._sdrgc.innerHTML = \"&nbsp;\";\r\n    this._sdrgc.className = \"gridDragLine\";\r\n    this.objBox.appendChild(this._sdrgc)\r\n}\r\n;\r\nfunction dragContext(x, w, v, u, s, r, n, o, m, g) {\r\n    this.source = x || \"grid\";\r\n    this.target = w || \"grid\";\r\n    this.mode = v || \"move\";\r\n    this.dropmode = u || \"child\";\r\n    this.sid = s || 0;\r\n    this.tid = r;\r\n    this.sobj = n || null ;\r\n    this.tobj = o || null ;\r\n    this.sExtra = m || null ;\r\n    this.tExtra = g || null ;\r\n    return this\r\n}\r\ndragContext.prototype.valid = function() {\r\n    if (this.sobj != this.tobj) {\r\n        return true\r\n    }\r\n    if (this.sid == this.tid) {\r\n        return false\r\n    }\r\n    if (this.target == \"treeGrid\") {\r\n        var a = this.tid;\r\n        while (a = this.tobj.getParentId(a)) {\r\n            if (this.sid == a) {\r\n                return false\r\n            }\r\n        }\r\n    }\r\n    return true\r\n}\r\n;\r\ndragContext.prototype.close = function() {\r\n    this.sobj = null ;\r\n    this.tobj = null \r\n}\r\n;\r\ndragContext.prototype.copy = function() {\r\n    return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra)\r\n}\r\n;\r\ndragContext.prototype.set = function(e, c) {\r\n    this[e] = c;\r\n    return this\r\n}\r\n;\r\ndragContext.prototype.uid = function(e, c) {\r\n    this.nid = this.sid;\r\n    while (this.tobj.rowsAr[this.nid]) {\r\n        this.nid = this.nid + ((new Date()).valueOf())\r\n    }\r\n    return this\r\n}\r\n;\r\ndragContext.prototype.data = function() {\r\n    if (this.sobj == this.tobj) {\r\n        return this.sobj._getRowArray(this.sobj.rowsAr[this.sid])\r\n    }\r\n    if (this.source == \"tree\") {\r\n        return this.tobj.treeToGridElement(this.sobj, this.sid, this.tid)\r\n    } else {\r\n        return this.tobj.gridToGrid(this.sid, this.sobj, this.tobj)\r\n    }\r\n}\r\n;\r\ndragContext.prototype.attrs = function() {\r\n    if (this.source == \"tree\") {\r\n        return {}\r\n    } else {\r\n        return this.sobj.rowsAr[this.sid]._attrs\r\n    }\r\n}\r\n;\r\ndragContext.prototype.childs = function() {\r\n    if (this.source == \"treeGrid\") {\r\n        return this.sobj._h2.get[this.sid]._xml_await ? this.sobj._h2.get[this.sid].has_kids : null \r\n    }\r\n    return null \r\n}\r\n;\r\ndragContext.prototype.pid = function() {\r\n    if (!this.tid) {\r\n        return 0\r\n    }\r\n    if (!this.tobj._h2) {\r\n        return 0\r\n    }\r\n    if (this.target == \"treeGrid\") {\r\n        if (this.dropmode == \"child\") {\r\n            return this.tid\r\n        } else {\r\n            var c = this.tobj.rowsAr[this.tid];\r\n            var a = this.tobj._h2.get[c.idd].parent.id;\r\n            if ((this.alfa) && (this.tobj._sbmod) && (c.nextSibling)) {\r\n                var e = this.tobj._h2.get[c.nextSibling.idd].parent.id;\r\n                if (e == this.tid) {\r\n                    return this.tid\r\n                }\r\n                if (e != a) {\r\n                    return e\r\n                }\r\n            }\r\n            return a\r\n        }\r\n    }\r\n}\r\n;\r\ndragContext.prototype.ind = function() {\r\n    if (this.tid == window.unknown) {\r\n        return this.tobj.rowsBuffer.length\r\n    }\r\n    if (this.target == \"treeGrid\") {\r\n        if (this.dropmode == \"child\") {\r\n            this.tobj.openItem(this.tid)\r\n        } else {\r\n            this.tobj.openItem(this.tobj.getParentId(this.tid))\r\n        }\r\n    }\r\n    var a = this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);\r\n    if ((this.alfa) && (this.tobj._sbmod) && (this.dropmode == \"sibling\")) {\r\n        var c = this.tobj.rowsAr[this.tid];\r\n        if ((c.nextSibling) && (this._h2.get[c.nextSibling.idd].parent.id == this.tid)) {\r\n            return a + 1\r\n        }\r\n    }\r\n    return ( a + 1 + ((this.target == \"treeGrid\" && a >= 0 && this.tobj._h2.get[this.tobj.rowsBuffer[a].idd].state == \"minus\") ? this.tobj._getOpenLenght(this.tobj.rowsBuffer[a].idd, 0) : 0)) \r\n}\r\n;\r\ndragContext.prototype.img = function() {\r\n    if ((this.target != \"grid\") && (this.sobj._h2)) {\r\n        return this.sobj.getItemImage(this.sid)\r\n    } else {\r\n        return null \r\n    }\r\n}\r\n;\r\ndragContext.prototype.slist = function() {\r\n    var c = new Array();\r\n    for (var a = 0; a < this.sid.length; a++) {\r\n        c[c.length] = this.sid[a][(this.source == \"tree\") ? \"id\" : \"idd\"]\r\n    }\r\n    return c.join(\",\")\r\n}\r\n;\r\ndhtmlXGridObject.prototype._drag = function(s, h, r, u) {\r\n    if (this._realfake) {\r\n        return this._fake._drag()\r\n    }\r\n    var o = (this.lastLanding);\r\n    if (this._autoOpenTimer) {\r\n        window.clearTimeout(this._autoOpenTimer)\r\n    }\r\n    var g = r.parentNode;\r\n    var e = s.parentObject;\r\n    if (!g.idd) {\r\n        g.grid = this;\r\n        this.dadmodefix = 0\r\n    }\r\n    var n = new dragContext(0,0,0,((g.grid.dadmode == 1 || g.grid.dadmodec) ? \"sibling\" : \"child\"));\r\n    if (e && e.childNodes) {\r\n        n.set(\"source\", \"tree\").set(\"sobj\", e.treeNod).set(\"sid\", n.sobj._dragged)\r\n    } else {\r\n        if (!e) {\r\n            return true\r\n        }\r\n        if (e.treeNod.isTreeGrid && e.treeNod.isTreeGrid()) {\r\n            n.set(\"source\", \"treeGrid\")\r\n        }\r\n        n.set(\"sobj\", e.treeNod).set(\"sid\", n.sobj._dragged)\r\n    }\r\n    if (g.grid.isTreeGrid()) {\r\n        n.set(\"target\", \"treeGrid\")\r\n    } else {\r\n        n.set(\"dropmode\", \"sibling\")\r\n    }\r\n    n.set(\"tobj\", g.grid).set(\"tid\", g.idd);\r\n    if (((n.tobj.dadmode == 2) && (n.tobj.dadmodec == 1)) && (n.tobj.dadmodefix < 0)) {\r\n        if (n.tobj.obj.rows[1].idd != n.tid) {\r\n            n.tid = g.previousSibling.idd\r\n        } else {\r\n            n.tid = 0\r\n        }\r\n    }\r\n    var a = this.getFirstParentOfType(u, \"TD\");\r\n    if (a) {\r\n        n.set(\"tExtra\", a._cellIndex)\r\n    }\r\n    if (a) {\r\n        n.set(\"sExtra\", n.sobj._dndExtra)\r\n    }\r\n    if (n.sobj.dpcpy) {\r\n        n.set(\"mode\", \"copy\")\r\n    }\r\n    if (n.tobj._realfake) {\r\n        n.tobj = n.tobj._fake\r\n    }\r\n    if (n.sobj._realfake) {\r\n        n.sobj = n.sobj._fake\r\n    }\r\n    n.tobj._clearMove();\r\n    if (e && e.treeNod && e.treeNod._nonTrivialRow) {\r\n        e.treeNod._nonTrivialRow(this, n.tid, n.dropmode, e)\r\n    } else {\r\n        n.tobj.dragContext = n;\r\n        if (!n.tobj.callEvent(\"onDrag\", [n.slist(), n.tid, n.sobj, n.tobj, n.sExtra, n.tExtra])) {\r\n            return n.tobj.dragContext = null \r\n        }\r\n        var v = new Array();\r\n        if (typeof (n.sid) == \"object\") {\r\n            var m = n.copy();\r\n            for (var l = 0; l < n.sid.length; l++) {\r\n                if (!m.set(\"alfa\", (!l)).set(\"sid\", n.sid[l][(n.source == \"tree\" ? \"id\" : \"idd\")]).valid()) {\r\n                    continue\r\n                }\r\n                m.tobj._dragRoutine(m);\r\n                if (m.target == \"treeGrid\" && m.dropmode == \"child\") {\r\n                    m.tobj.openItem(m.tid)\r\n                }\r\n                v[v.length] = m.nid;\r\n                m.set(\"dropmode\", \"sibling\").set(\"tid\", m.nid)\r\n            }\r\n            m.close()\r\n        } else {\r\n            n.tobj._dragRoutine(n)\r\n        }\r\n        if (n.tobj.laterLink) {\r\n            n.tobj.laterLink()\r\n        }\r\n        n.tobj.callEvent(\"onDrop\", [n.slist(), n.tid, v.join(\",\"), n.sobj, n.tobj, n.sExtra, n.tExtra])\r\n    }\r\n    n.tobj.dragContext = null ;\r\n    n.close()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._dragRoutine = function(s) {\r\n    if ((s.sobj == s.tobj) && (s.source == \"grid\") && (s.mode == \"move\") && !this._fake) {\r\n        if (s.sobj._dndProblematic) {\r\n            return\r\n        }\r\n        var o = s.sobj.rowsAr[s.sid];\r\n        var r = s.sobj.rowsCol._dhx_find(o);\r\n        s.sobj.rowsCol._dhx_removeAt(s.sobj.rowsCol._dhx_find(o));\r\n        s.sobj.rowsBuffer._dhx_removeAt(s.sobj.rowsBuffer._dhx_find(o));\r\n        s.sobj.rowsBuffer._dhx_insertAt(s.ind(), o);\r\n        if (s.tobj._fake) {\r\n            s.tobj._fake.rowsCol._dhx_removeAt(r);\r\n            var u = s.tobj._fake.rowsAr[s.sid];\r\n            u.parentNode.removeChild(u)\r\n        }\r\n        s.sobj._insertRowAt(o, s.ind() - (this.pagingOn ? ((this.currentPage - 1) * this.rowsBufferOutSize) : 0));\r\n        s.nid = s.sid;\r\n        s.sobj.callEvent(\"onGridReconstructed\", []);\r\n        return\r\n    }\r\n    var n;\r\n    if (this._h2 && typeof s.tid != \"undefined\" && s.dropmode == \"sibling\" && (this._sbmod || s.tid)) {\r\n        if (s.alfa && this._sbmod && this._h2.get[s.tid].childs.length) {\r\n            this.openItem(s.tid);\r\n            n = s.uid().tobj.addRowBefore(s.nid, s.data(), this._h2.get[s.tid].childs[0].id, s.img(), s.childs())\r\n        } else {\r\n            n = s.uid().tobj.addRowAfter(s.nid, s.data(), s.tid, s.img(), s.childs())\r\n        }\r\n    } else {\r\n        n = s.uid().tobj.addRow(s.nid, s.data(), s.ind(), s.pid(), s.img(), s.childs())\r\n    }\r\n    n._attrs = s.attrs();\r\n    if (s.source == \"tree\") {\r\n        this.callEvent(\"onRowAdded\", [s.nid]);\r\n        var a = s.sobj._globalIdStorageFind(s.sid);\r\n        if (a.childsCount) {\r\n            var m = s.copy().set(\"tid\", s.nid).set(\"dropmode\", s.target == \"grid\" ? \"sibling\" : \"child\");\r\n            for (var g = 0; g < a.childsCount; g++) {\r\n                s.tobj._dragRoutine(m.set(\"sid\", a.childNodes[g].id));\r\n                if (s.mode == \"move\") {\r\n                    g--\r\n                }\r\n            }\r\n            m.close()\r\n        }\r\n    } else {\r\n        s.tobj._copyUserData(s);\r\n        this.callEvent(\"onRowAdded\", [s.nid]);\r\n        if ((s.source == \"treeGrid\") ) {\r\n            if (s.sobj == s.tobj) {\r\n                n._xml = s.sobj.rowsAr[s.sid]._xml\r\n            }\r\n            var h = s.sobj._h2.get[s.sid];\r\n            if ((h) && (h.childs.length)) {\r\n                var m = s.copy().set(\"tid\", s.nid);\r\n                if (s.target == \"grid\") {\r\n                    m.set(\"dropmode\", \"sibling\")\r\n                } else {\r\n                    if (!m.tobj.kidsXmlFile) {\r\n                        m.tobj.openItem(s.tid)\r\n                    }\r\n                    m.set(\"dropmode\", \"child\")\r\n                }\r\n                var e = h.childs.length;\r\n                if (!m.tobj.kidsXmlFile) {\r\n                    for (var g = 0; g < e; g++) {\r\n                        s.sobj.render_row_tree(null , h.childs[g].id);\r\n                        s.tobj._dragRoutine(m.set(\"sid\", h.childs[g].id));\r\n                        if (e != h.childs.length) {\r\n                            g--;\r\n                            e = h.childs.length\r\n                        }\r\n                    }\r\n                }\r\n                m.close()\r\n            }\r\n        }\r\n    }\r\n    if (s.mode == \"move\") {\r\n        s.sobj[(s.source == \"tree\") ? \"deleteItem\" : \"deleteRow\"](s.sid);\r\n        if ((s.sobj == s.tobj) && (!s.tobj.rowsAr[s.sid])) {\r\n            s.tobj.changeRowId(s.nid, s.sid);\r\n            s.nid = s.sid\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.gridToGrid = function(g, a, e) {\r\n    var h = new Array();\r\n    for (var c = 0; c < a.hdr.rows[0].cells.length; c++) {\r\n        h[c] = a.cells(g, c).getValue()\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXGridObject.prototype.checkParentLine = function(a, c) {\r\n    if ((!this._h2) || (!c) || (!a)) {\r\n        return false\r\n    }\r\n    if (a.id == c) {\r\n        return true\r\n    } else {\r\n        return this.checkParentLine(a.parent, c)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._dragIn = function(l, g, c, m) {\r\n    if (!this.dADTempOff) {\r\n        return 0\r\n    }\r\n    var a = this.isTreeGrid();\r\n    var h = g.parentNode.idd ? g.parentNode : g.parentObject;\r\n    if (this._drag_validate) {\r\n        if (l.parentNode == g.parentNode) {\r\n            return 0\r\n        }\r\n        if ((a) && (this == h.grid) && ((this.checkParentLine(this._h2.get[l.parentNode.idd], g.parentNode.idd)))) {\r\n            return 0\r\n        }\r\n    }\r\n    if (!this.callEvent(\"onDragIn\", [h.idd || h.id, l.parentNode.idd, h.grid || h.treeNod, (l.grid || l.parentNode.grid)])) {\r\n        return this._setMove(l, c, m, true)\r\n    }\r\n    this._setMove(l, c, m);\r\n    if ((a) && (l.parentNode.expand != \"\")) {\r\n        var e = this;\r\n        this._autoOpenTimer = window.setTimeout(function() {\r\n            e._autoOpenItem(null , e);\r\n            e = null \r\n        }, 1000);\r\n        this._autoOpenId = l.parentNode.idd\r\n    } else {\r\n        if (this._autoOpenTimer) {\r\n            window.clearTimeout(this._autoOpenTimer)\r\n        }\r\n    }\r\n    return l\r\n}\r\n;\r\ndhtmlXGridObject.prototype._autoOpenItem = function(a, c) {\r\n    c.openItem(c._autoOpenId)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._dragOut = function(c) {\r\n    this._clearMove();\r\n    var a = c.parentNode.parentObject ? c.parentObject.id : c.parentNode.idd;\r\n    this.callEvent(\"onDragOut\", [a]);\r\n    if (this._autoOpenTimer) {\r\n        window.clearTimeout(this._autoOpenTimer)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._setMove = function(l, c, n, h) {\r\n    if (!l.parentNode.idd) {\r\n        return\r\n    }\r\n    var e = dhx4.absTop(l);\r\n    var a = dhx4.absTop(this.objBox);\r\n    if ((e - a) > (parseInt(this.objBox.offsetHeight) - 50)) {\r\n        this.objBox.scrollTop = parseInt(this.objBox.scrollTop) + 20\r\n    }\r\n    if ((e - a + parseInt(this.objBox.scrollTop)) < (parseInt(this.objBox.scrollTop) + 30)) {\r\n        this.objBox.scrollTop = parseInt(this.objBox.scrollTop) - 20\r\n    }\r\n    if (h) {\r\n        return 0\r\n    }\r\n    if (this.dadmode == 2) {\r\n        var m = n - e + (document.body.scrollTop || document.documentElement.scrollTop) - 2 - l.offsetHeight / 2;\r\n        if ((Math.abs(m) - l.offsetHeight / 6) > 0) {\r\n            this.dadmodec = 1;\r\n            if (m < 0) {\r\n                this.dadmodefix = -1\r\n            } else {\r\n                this.dadmodefix = 1\r\n            }\r\n        } else {\r\n            this.dadmodec = 0\r\n        }\r\n    } else {\r\n        this.dadmodec = this.dadmode\r\n    }\r\n    if (this.dadmodec) {\r\n        if (!this._sdrgc) {\r\n            this._createSdrgc()\r\n        }\r\n        this._sdrgc.style.display = \"block\";\r\n        this._sdrgc.style.top = e - a + parseInt(this.objBox.scrollTop) + ((this.dadmodefix >= 0) ? l.offsetHeight : 0) + \"px\"\r\n    } else {\r\n        this._llSelD = l;\r\n        if (l.parentNode.tagName == \"TR\") {\r\n            for (var g = 0; g < l.parentNode.childNodes.length; g++) {\r\n                var m = l.parentNode.childNodes[g];\r\n                m._bgCol = m.style.backgroundColor;\r\n                m.style.backgroundColor = \"#FFCCCC\"\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._clearMove = function() {\r\n    if (this._sdrgc) {\r\n        this._sdrgc.style.display = \"none\"\r\n    }\r\n    if ((this._llSelD) && (this._llSelD.parentNode.tagName == \"TR\")) {\r\n        var c = this._llSelD.parentNode.childNodes;\r\n        for (var a = 0; a < c.length; a++) {\r\n            c[a].style.backgroundColor = c[a]._bgCol\r\n        }\r\n    }\r\n    this._llSelD = null \r\n}\r\n;\r\ndhtmlXGridObject.prototype.rowToDragElement = function(a) {\r\n    var c = this.cells(a, 0).getValue();\r\n    return c\r\n}\r\n;\r\ndhtmlXGridObject.prototype._copyUserData = function(g) {\r\n    if (!g.tobj.UserData[g.nid] || g.tobj != g.sobj) {\r\n        g.tobj.UserData[g.nid] = new Hashtable()\r\n    } else {\r\n        return\r\n    }\r\n    var e = g.sobj.UserData[g.sid];\r\n    var a = g.tobj.UserData[g.nid];\r\n    if (e) {\r\n        a.keys = a.keys.concat(e.keys);\r\n        a.values = a.values.concat(e.values)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.moveRow = function(e, g, a, c) {\r\n    switch (g) {\r\n    case \"row_sibling\":\r\n        this.moveRowTo(e, a, \"move\", \"sibling\", this, c);\r\n        break;\r\n    case \"up\":\r\n        this.moveRowUp(e);\r\n        break;\r\n    case \"down\":\r\n        this.moveRowDown(e);\r\n        break\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._nonTrivialNode = function(s, r, m, n, e) {\r\n    if ((s.callEvent) && (!e)) {\r\n        if (!s.callEvent(\"onDrag\", [n.idd, r.id, (m ? m.id : null ), this, s])) {\r\n            return false\r\n        }\r\n    }\r\n    var o = n.idd;\r\n    var a = o;\r\n    while (s._idpull[a]) {\r\n        a += (new Date()).getMilliseconds().toString()\r\n    }\r\n    var h = (this.isTreeGrid() ? this.getItemImage(o) : \"\");\r\n    if (m) {\r\n        for (g = 0; g < r.childsCount; g++) {\r\n            if (r.childNodes[g] == m) {\r\n                break\r\n            }\r\n        }\r\n        if (g != 0) {\r\n            m = r.childNodes[g - 1]\r\n        } else {\r\n            st = \"TOP\";\r\n            m = \"\"\r\n        }\r\n    }\r\n    var c = s._attachChildNode(r, a, this.gridToTreeElement(s, a, o), \"\", h, h, h, \"\", \"\", m);\r\n    if (this._h2) {\r\n        var l = this._h2.get[o];\r\n        if (l.childs.length) {\r\n            for (var g = 0; g < l.childs.length; g++) {\r\n                this._nonTrivialNode(s, c, 0, this.rowsAr[l.childs[g].id], 1);\r\n                if (!this.dpcpy) {\r\n                    g--\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (!this.dpcpy) {\r\n        this.deleteRow(o)\r\n    }\r\n    if ((s.callEvent) && (!e)) {\r\n        s.callEvent(\"onDrop\", [a, r.id, (m ? m.id : null ), this, s])\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.gridToTreeElement = function(c, e, a) {\r\n    return this.cells(a, 0).getValue()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.treeToGridElement = function(g, h, a) {\r\n    var c = new Array();\r\n    var l = this.cellType._dhx_find(\"tree\");\r\n    if (l == -1) {\r\n        l = 0\r\n    }\r\n    for (var e = 0; e < this.getColumnCount(); e++) {\r\n        c[c.length] = (e != l) ? (g.getUserData(h, this.getColumnId(e)) || \"\") : g.getItemText(h)\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXGridObject.prototype.moveRowTo = function(g, e, m, l, a, h) {\r\n    var n = new dragContext((a || this).isTreeGrid() ? \"treeGrid\" : \"grid\",(h || this).isTreeGrid() ? \"treeGrid\" : \"grid\",m,l || \"sibling\",g,e,a || this,h || this);\r\n    n.tobj._dragRoutine(n);\r\n    n.close();\r\n    return n.nid\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableMercyDrag = function(a) {\r\n    this.dpcpy = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.toPDF = function(g, r, w, u, n, D) {\r\n    var h = {\r\n        row: (this.getSelectedRowId() || \"\").split(this.delim),\r\n        col: this.getSelectedCellIndex()\r\n    };\r\n    if (h.row === null  || h.col === -1) {\r\n        h = false\r\n    } else {\r\n        if (h.row) {\r\n            for (var x = 0; x < h.row.length; x++) {\r\n                if (h.row[x]) {\r\n                    var c = this.cells(h.row[x], h.col).cell;\r\n                    c.parentNode.className = c.parentNode.className.replace(\" rowselected\", \"\");\r\n                    c.className = c.className.replace(\" cellselected\", \"\");\r\n                    h.row[x] = c\r\n                }\r\n            }\r\n        } else {\r\n            h = false\r\n        }\r\n    }\r\n    r = r || \"color\";\r\n    var y = r == \"full_color\";\r\n    var a = this;\r\n    a._asCDATA = true;\r\n    if (typeof (D) === \"undefined\") {\r\n        this.target = ' target=\"_blank\"'\r\n    } else {\r\n        this.target = D\r\n    }\r\n    eXcell_ch.prototype.getContent = function() {\r\n        return this.getValue()\r\n    }\r\n    ;\r\n    eXcell_ra.prototype.getContent = function() {\r\n        return this.getValue()\r\n    }\r\n    ;\r\n    function C(H) {\r\n        var N = [];\r\n        for (var L = 1; L < a.hdr.rows.length; L++) {\r\n            N[L] = [];\r\n            for (var K = 0; K < a._cCount; K++) {\r\n                var P = a.hdr.rows[L].childNodes[K];\r\n                if (!N[L][K]) {\r\n                    N[L][K] = [0, 0]\r\n                }\r\n                if (P) {\r\n                    N[L][P._cellIndexS] = [P.colSpan, P.rowSpan]\r\n                }\r\n            }\r\n        }\r\n        var M = \"<rows profile='\" + H + \"'\";\r\n        if (w) {\r\n            M += \" header='\" + w + \"'\"\r\n        }\r\n        if (u) {\r\n            M += \" footer='\" + u + \"'\"\r\n        }\r\n        M += \"><head>\" + a._serialiseExportConfig(N).replace(/^<head/, \"<columns\").replace(/head>$/, \"columns>\");\r\n        for (var L = 2; L < a.hdr.rows.length; L++) {\r\n            var E = 0;\r\n            var T = a.hdr.rows[L];\r\n            var O = \"\";\r\n            for (var K = 0; K < a._cCount; K++) {\r\n                if ((a._srClmn && !a._srClmn[K]) || (a._hrrar[K] && (!a._fake || K >= a._fake.hdrLabels.length))) {\r\n                    E++;\r\n                    continue\r\n                }\r\n                var S = N[L][K];\r\n                var Q = ((S[0] && S[0] > 1) ? ' colspan=\"' + S[0] + '\" ' : \"\");\r\n                if (S[1] && S[1] > 1) {\r\n                    Q += ' rowspan=\"' + S[1] + '\" ';\r\n                    E = -1\r\n                }\r\n                var F = \"\";\r\n                var J = T;\r\n                if (a._fake && K < a._fake._cCount) {\r\n                    J = a._fake.hdr.rows[L]\r\n                }\r\n                for (var I = 0; I < J.cells.length; I++) {\r\n                    if (J.cells[I]._cellIndexS == K) {\r\n                        if (J.cells[I].getElementsByTagName(\"SELECT\").length) {\r\n                            F = \"\"\r\n                        } else {\r\n                            F = _isIE ? J.cells[I].innerText : J.cells[I].textContent\r\n                        }\r\n                        F = F.replace(/[ \\n\\r\\t\\xA0]+/, \" \");\r\n                        break\r\n                    }\r\n                }\r\n                if (!F || F == \" \") {\r\n                    E++\r\n                }\r\n                O += \"<column\" + Q + \"><![CDATA[\" + F + \"]]></column>\"\r\n            }\r\n            if (E != a._cCount) {\r\n                M += \"\\n<columns>\" + O + \"</columns>\"\r\n            }\r\n        }\r\n        M += \"</head>\\n\";\r\n        M += o();\r\n        return M\r\n    }\r\n    function e() {\r\n        var E = [];\r\n        if (n) {\r\n            for (var F = 0; F < n.length; F++) {\r\n                E.push(v(a.getRowIndex(n[F])))\r\n            }\r\n        } else {\r\n            for (var F = 0; F < a.getRowsNum(); F++) {\r\n                E.push(v(F))\r\n            }\r\n        }\r\n        return E.join(\"\\n\")\r\n    }\r\n    function o() {\r\n        var H = [\"<foot>\"];\r\n        if (!a.ftr) {\r\n            return \"\"\r\n        }\r\n        for (var I = 1; I < a.ftr.rows.length; I++) {\r\n            H.push(\"<columns>\");\r\n            var L = a.ftr.rows[I];\r\n            for (var F = 0; F < a._cCount; F++) {\r\n                if (a._srClmn && !a._srClmn[F]) {\r\n                    continue\r\n                }\r\n                if (a._hrrar[F] && (!a._fake || F >= a._fake.hdrLabels.length)) {\r\n                    continue\r\n                }\r\n                for (var E = 0; E < L.cells.length; E++) {\r\n                    var K = \"\";\r\n                    var J = \"\";\r\n                    if (L.cells[E]._cellIndexS == F) {\r\n                        K = _isIE ? L.cells[E].innerText : L.cells[E].textContent;\r\n                        K = K.replace(/[ \\n\\r\\t\\xA0]+/, \" \");\r\n                        if (L.cells[E].colSpan && L.cells[E].colSpan != 1) {\r\n                            J = \" colspan='\" + L.cells[E].colSpan + \"' \"\r\n                        }\r\n                        if (L.cells[E].rowSpan && L.cells[E].rowSpan != 1) {\r\n                            J = \" rowspan='\" + L.cells[E].rowSpan + \"' \"\r\n                        }\r\n                        break\r\n                    }\r\n                }\r\n                H.push(\"<column\" + J + \"><![CDATA[\" + K + \"]]></column>\")\r\n            }\r\n            H.push(\"</columns>\")\r\n        }\r\n        H.push(\"</foot>\");\r\n        return H.join(\"\\n\")\r\n    }\r\n    function m(F, E) {\r\n        return (window.getComputedStyle ? (window.getComputedStyle(F, null )[E]) : (F.currentStyle ? F.currentStyle[E] : null )) || \"\"\r\n    }\r\n    function v(I) {\r\n        if (!a.rowsBuffer[I]) {\r\n            return \"\"\r\n        }\r\n        var E = a.render_row(I);\r\n        if (E.style.display == \"none\") {\r\n            return \"\"\r\n        }\r\n        var F = a.isTreeGrid() ? ' level=\"' + a.getLevel(E.idd) + '\"' : \"\";\r\n        var M = \"<row\" + F + \">\";\r\n        for (var K = 0; K < a._cCount; K++) {\r\n            if (((!a._srClmn) || (a._srClmn[K])) && (!a._hrrar[K] || (a._fake && K < a._fake.hdrLabels.length))) {\r\n                var Q = a.cells(E.idd, K);\r\n                if (y) {\r\n                    var J = m(Q.cell, \"color\");\r\n                    var P = m(Q.cell, \"backgroundColor\");\r\n                    var O = m(Q.cell, \"font-weight\") || m(Q.cell, \"fontWeight\");\r\n                    var L = m(Q.cell, \"font-style\") || m(Q.cell, \"fontStyle\");\r\n                    var N = m(Q.cell, \"text-align\") || m(Q.cell, \"textAlign\");\r\n                    var H = m(Q.cell, \"font-family\") || m(Q.cell, \"fontFamily\");\r\n                    if (P == \"transparent\" || P == \"rgba(0, 0, 0, 0)\") {\r\n                        P = \"rgb(255,255,255)\"\r\n                    }\r\n                    M += \"<cell bgColor='\" + P + \"' textColor='\" + J + \"' bold='\" + O + \"' italic='\" + L + \"' align='\" + N + \"' font='\" + H + \"'>\"\r\n                } else {\r\n                    M += \"<cell>\"\r\n                }\r\n                M += \"<![CDATA[\" + (Q.getContent ? Q.getContent() : Q.getTitle()) + \"]]></cell>\"\r\n            }\r\n        }\r\n        return M + \"</row>\"\r\n    }\r\n    function s() {\r\n        var E = \"</rows>\";\r\n        return E\r\n    }\r\n    var A = document.createElement(\"div\");\r\n    A.style.display = \"none\";\r\n    document.body.appendChild(A);\r\n    var l = \"form_\" + a.uid();\r\n    A.innerHTML = '<form id=\"' + l + '\" method=\"post\" action=\"' + g + '\" accept-charset=\"utf-8\"  enctype=\"application/x-www-form-urlencoded\"' + this.target + '><input type=\"hidden\" name=\"grid_xml\" id=\"grid_xml\"/> </form>';\r\n    document.getElementById(l).firstChild.value = encodeURIComponent(C(r).replace(\"\\u2013\", \"-\") + e() + s());\r\n    document.getElementById(l).submit();\r\n    A.parentNode.removeChild(A);\r\n    a = null ;\r\n    if (h && h.row.length) {\r\n        for (var x = 0; x < h.row.length; x++) {\r\n            h.row[x].parentNode.className += \" rowselected\";\r\n            if (h.row.length == 1) {\r\n                h.row[x].className += \" cellselected\"\r\n            }\r\n        }\r\n    }\r\n    h = null \r\n}\r\n;\r\ndhtmlXGridObject.prototype._serialiseExportConfig = function(l) {\r\n    function h(r) {\r\n        if (typeof (r) !== \"string\") {\r\n            return r\r\n        }\r\n        r = r.replace(/&/g, \"&amp;\");\r\n        r = r.replace(/\"/g, \"&quot;\");\r\n        r = r.replace(/'/g, \"&apos;\");\r\n        r = r.replace(/</g, \"&lt;\");\r\n        r = r.replace(/>/g, \"&gt;\");\r\n        return r\r\n    }\r\n    var c = \"<head>\";\r\n    for (var e = 0; e < this.hdr.rows[0].cells.length; e++) {\r\n        if (this._srClmn && !this._srClmn[e]) {\r\n            continue\r\n        }\r\n        if (this._hrrar[e] && (!this._fake || e >= this._fake.hdrLabels.length)) {\r\n            continue\r\n        }\r\n        var g = this.fldSort[e];\r\n        if (g == \"cus\") {\r\n            g = this._customSorts[e].toString();\r\n            g = g.replace(/function[\\ ]*/, \"\").replace(/\\([^\\f]*/, \"\")\r\n        }\r\n        var o = l[1][e];\r\n        var m = ((o[1] && o[1] > 1) ? ' rowspan=\"' + o[1] + '\" ' : \"\") + ((o[0] && o[0] > 1) ? ' colspan=\"' + o[0] + '\" ' : \"\");\r\n        c += \"<column \" + m + \" width='\" + this.getColWidth(e) + \"' align='\" + this.cellAlign[e] + \"' type='\" + this.cellType[e] + \"' hidden='\" + ((this.isColumnHidden && this.isColumnHidden(e)) ? \"true\" : \"false\") + \"' sort='\" + (g || \"na\") + \"' color='\" + (this.columnColor[e] || \"\") + \"'\" + (this.columnIds[e] ? (\" id='\" + this.columnIds[e] + \"'\") : \"\") + \">\";\r\n        if (this._asCDATA) {\r\n            c += \"<![CDATA[\" + this.getColumnLabel(e) + \"]]>\"\r\n        } else {\r\n            c += this.getColumnLabel(e)\r\n        }\r\n        var n = this.combos[e] ? this.getCombo(e) : null ;\r\n        if (n) {\r\n            for (var a = 0; a < n.keys.length; a++) {\r\n                c += \"<option value='\" + h(n.keys[a]) + \"'><![CDATA[\" + n.values[a] + \"]]></option>\"\r\n            }\r\n        }\r\n        c += \"</column>\"\r\n    }\r\n    return c += \"</head>\"\r\n}\r\n;\r\nif (window.eXcell_sub_row_grid) {\r\n    window.eXcell_sub_row_grid.prototype.getContent = function() {\r\n        return \"\"\r\n    }\r\n}\r\ndhtmlXGridObject.prototype.toExcel = function(a, g, m, l, c) {\r\n    if (!document.getElementById(\"ifr\")) {\r\n        var h = document.createElement(\"iframe\");\r\n        h.style.display = \"none\";\r\n        h.setAttribute(\"name\", \"dhx_export_iframe\");\r\n        h.setAttribute(\"src\", \"\");\r\n        h.setAttribute(\"id\", \"dhx_export_iframe\");\r\n        document.body.appendChild(h)\r\n    }\r\n    var e = ' target=\"dhx_export_iframe\"';\r\n    this.toPDF(a, g, m, l, c, e)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.filterBy = function(e, g, c) {\r\n    if (this.isTreeGrid()) {\r\n        return this.filterTreeBy(e, g, c)\r\n    }\r\n    if (this._f_rowsBuffer) {\r\n        if (!c) {\r\n            this.rowsBuffer = dhtmlxArray([].concat(this._f_rowsBuffer));\r\n            if (this._fake) {\r\n                this._fake.rowsBuffer = this.rowsBuffer\r\n            }\r\n        }\r\n    } else {\r\n        this._f_rowsBuffer = [].concat(this.rowsBuffer)\r\n    }\r\n    if (!this.rowsBuffer.length) {\r\n        return\r\n    }\r\n    var h = true;\r\n    this.dma(true);\r\n    if (typeof (e) == \"object\") {\r\n        for (var a = 0; a < g.length; a++) {\r\n            this._filterA(e[a], g[a])\r\n        }\r\n    } else {\r\n        this._filterA(e, g)\r\n    }\r\n    this.dma(false);\r\n    if (this.pagingOn && this.rowsBuffer.length / this.rowsBufferOutSize < (this.currentPage - 1)) {\r\n        this.changePage(0)\r\n    }\r\n    this._reset_view();\r\n    this.callEvent(\"onGridReconstructed\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._filterA = function(c, e) {\r\n    if (e == \"\") {\r\n        return\r\n    }\r\n    var g = true;\r\n    if (typeof (e) == \"function\") {\r\n        g = false\r\n    } else {\r\n        e = (e || \"\").toString().toLowerCase()\r\n    }\r\n    if (!this.rowsBuffer.length) {\r\n        return\r\n    }\r\n    for (var a = this.rowsBuffer.length - 1; a >= 0; a--) {\r\n        if (g ? (this._get_cell_value(this.rowsBuffer[a], c).toString().toLowerCase().indexOf(e) == -1) : (!e.call(this, this._get_cell_value(this.rowsBuffer[a], c), this.rowsBuffer[a].idd))) {\r\n            this.rowsBuffer.splice(a, 1)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getFilterElement = function(a) {\r\n    if (!this.filters) {\r\n        return\r\n    }\r\n    for (var c = 0; c < this.filters.length; c++) {\r\n        if (this.filters[c][1] == a) {\r\n            return ( this.filters[c][0].combo || this.filters[c][0]) \r\n        }\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXGridObject.prototype.collectValues = function(g) {\r\n    var u = this.dhxevs.data.oncollectvalues;\r\n    if (u) {\r\n        var r = true;\r\n        for (var s in u) {\r\n            var v = u[s].call(this, g);\r\n            if (v !== true) {\r\n                r = v || r\r\n            }\r\n        }\r\n        if (r !== true) {\r\n            return r\r\n        }\r\n    }\r\n    if (this.isTreeGrid()) {\r\n        return this.collectTreeValues(g)\r\n    }\r\n    this.dma(true);\r\n    this._build_m_order();\r\n    g = this._m_order ? this._m_order[g] : g;\r\n    var n = {};\r\n    var l = [];\r\n    var e = this._f_rowsBuffer || this.rowsBuffer;\r\n    for (var h = 0; h < e.length; h++) {\r\n        var a = this._get_cell_value(e[h], g);\r\n        if (a && (!e[h]._childIndexes || e[h]._childIndexes[g] != e[h]._childIndexes[g - 1])) {\r\n            n[a] = true\r\n        }\r\n    }\r\n    this.dma(false);\r\n    var o = (this.combos[g] || (this._col_combos ? this._col_combos[g] : false));\r\n    for (var m in n) {\r\n        if (n[m] === true) {\r\n            if (o) {\r\n                if (o.get && o.get(m)) {\r\n                    m = o.get(m)\r\n                } else {\r\n                    if (o.getOption && o.getOption(m)) {\r\n                        m = o.getOption(m).text\r\n                    }\r\n                }\r\n            }\r\n            l.push(m)\r\n        }\r\n    }\r\n    return l.sort()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._build_m_order = function() {\r\n    if (this._c_order) {\r\n        this._m_order = [];\r\n        for (var a = 0; a < this._c_order.length; a++) {\r\n            this._m_order[this._c_order[a]] = a\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.filterByAll = function() {\r\n    var e = [];\r\n    var c = [];\r\n    this._build_m_order();\r\n    for (var g = 0; g < this.filters.length; g++) {\r\n        var l = this._m_order ? this._m_order[this.filters[g][1]] : this.filters[g][1];\r\n        if (l >= this._cCount) {\r\n            continue\r\n        }\r\n        c.push(l);\r\n        var m = this.filters[g][0].old_value = this.filters[g][0].value;\r\n        if (this.filters[g][0]._filter) {\r\n            m = this.filters[g][0]._filter()\r\n        }\r\n        var h;\r\n        if (typeof m != \"function\" && (h = (this.combos[l] || (this._col_combos ? this._col_combos[l] : false)))) {\r\n            if (h.values) {\r\n                l = h.values._dhx_find(m);\r\n                m = (l == -1) ? m : h.keys[l]\r\n            } else {\r\n                if (h.getOptionByLabel) {\r\n                    m = (h.getOptionByLabel(m) ? h.getOptionByLabel(m).value : m)\r\n                }\r\n            }\r\n        }\r\n        e.push(m)\r\n    }\r\n    if (!this.callEvent(\"onFilterStart\", [c, e])) {\r\n        return\r\n    }\r\n    this.filterBy(c, e);\r\n    if (this._cssEven) {\r\n        this._fixAlterCss()\r\n    }\r\n    this.callEvent(\"onFilterEnd\", [this.filters]);\r\n    if (this._f_rowsBuffer && this.rowsBuffer.length == this._f_rowsBuffer.length) {\r\n        this._f_rowsBuffer = null \r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.makeFilter = function(h, e, c) {\r\n    if (!this.filters) {\r\n        this.filters = []\r\n    }\r\n    if (typeof (h) != \"object\") {\r\n        h = document.getElementById(h)\r\n    }\r\n    if (!h) {\r\n        return\r\n    }\r\n    var a = this;\r\n    if (!h.style.width) {\r\n        h.style.width = \"90%\"\r\n    }\r\n    if (h.tagName == \"SELECT\") {\r\n        this.filters.push([h, e]);\r\n        this._loadSelectOptins(h, e);\r\n        h.onchange = function() {\r\n            a.filterByAll()\r\n        }\r\n        ;\r\n        if (_isIE) {\r\n            h.style.marginTop = \"1px\"\r\n        }\r\n        this.attachEvent(\"onEditCell\", function(m, l, n) {\r\n            this._build_m_order();\r\n            if (m == 2 && this.filters && (this._m_order ? (n == this._m_order[e]) : (n == e))) {\r\n                this._loadSelectOptins(h, e)\r\n            }\r\n            return true\r\n        })\r\n    } else {\r\n        if (h.tagName == \"INPUT\") {\r\n            this.filters.push([h, e]);\r\n            h.old_value = h.value = \"\";\r\n            h.onkeydown = function() {\r\n                if (this._timer) {\r\n                    window.clearTimeout(this._timer)\r\n                }\r\n                this._timer = window.setTimeout(function() {\r\n                    if (h.value != h.old_value) {\r\n                        a.filterByAll();\r\n                        h.old_value = h.value\r\n                    }\r\n                }, 500)\r\n            }\r\n        } else {\r\n            if (h.tagName == \"DIV\") {\r\n                this.filters.push([h, e]);\r\n                h.style.padding = \"0px\";\r\n                h.style.margin = \"0px\";\r\n                if (!window.dhx_globalImgPath) {\r\n                    window.dhx_globalImgPath = this.imgURL\r\n                }\r\n                var g = new dhtmlXCombo(h,\"_filter\",\"90%\");\r\n                g.filterSelfA = g.filterSelf;\r\n                g.filterSelf = function() {\r\n                    if (this.getSelectedIndex() == 0) {\r\n                        this.setComboText(\"\")\r\n                    }\r\n                    this.filterSelfA.apply(this, arguments);\r\n                    this.optionsArr[0].hide(false)\r\n                }\r\n                ;\r\n                g.enableFilteringMode(true);\r\n                h.combo = g;\r\n                h.value = \"\";\r\n                this._loadComboOptins(h, e);\r\n                g.attachEvent(\"onChange\", function() {\r\n                    h.value = g.getSelectedValue();\r\n                    if (h.value === null ) {\r\n                        h.value = \"\"\r\n                    }\r\n                    a.filterByAll()\r\n                })\r\n            }\r\n        }\r\n    }\r\n    if (h.parentNode) {\r\n        h.parentNode.className += \" filter\"\r\n    }\r\n    this._filters_ready()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.findCell = function(l, m, g, h) {\r\n    var h = h || (function(o, n) {\r\n        return n.toString().toLowerCase().indexOf(o) != -1\r\n    }\r\n    );\r\n    if (h === true) {\r\n        h = function(o, n) {\r\n            return n.toString().toLowerCase() == o\r\n        }\r\n    }\r\n    var e = new Array();\r\n    l = l.toString().toLowerCase();\r\n    if (typeof g != \"number\") {\r\n        g = g ? 1 : 0\r\n    }\r\n    if (!this.rowsBuffer.length) {\r\n        return e\r\n    }\r\n    for (var c = (m || 0); c < this._cCount; c++) {\r\n        if (this._h2) {\r\n            this._h2.forEachChild(0, function(n) {\r\n                if (g && e.length == g) {\r\n                    return e\r\n                }\r\n                if (h(l, this._get_cell_value(n.buff, c))) {\r\n                    e.push([n.id, c])\r\n                }\r\n            }, this)\r\n        } else {\r\n            for (var a = 0; a < this.rowsBuffer.length; a++) {\r\n                if (h(l, this._get_cell_value(this.rowsBuffer[a], c))) {\r\n                    e.push([this.rowsBuffer[a].idd, c]);\r\n                    if (g && e.length == g) {\r\n                        return e\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof (m) != \"undefined\") {\r\n            return e\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXGridObject.prototype.makeSearch = function(g, e, a) {\r\n    if (typeof (g) != \"object\") {\r\n        g = document.getElementById(g)\r\n    }\r\n    if (!g) {\r\n        return\r\n    }\r\n    var c = this;\r\n    if (g.tagName == \"INPUT\") {\r\n        g.onkeypress = function() {\r\n            if (this._timer) {\r\n                window.clearTimeout(this._timer)\r\n            }\r\n            this._timer = window.setTimeout(function() {\r\n                if (g.value == \"\") {\r\n                    return\r\n                }\r\n                var h = c.findCell(g.value, e, true, a);\r\n                if (h.length) {\r\n                    if (c._h2) {\r\n                        c.openItem(h[0][0])\r\n                    }\r\n                    c.selectCell(c.getRowIndex(h[0][0]), (e || 0))\r\n                }\r\n            }, 500)\r\n        }\r\n    }\r\n    if (g.parentNode) {\r\n        g.parentNode.className += \" filter\"\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._loadSelectOptins = function(h, n) {\r\n    var a = this.collectValues(n);\r\n    var e = h.value;\r\n    h.innerHTML = \"\";\r\n    h.options[0] = new Option(\"\",\"\");\r\n    var m = this._filter_tr ? this._filter_tr[n] : null ;\r\n    for (var g = 0; g < a.length; g++) {\r\n        h.options[h.options.length] = new Option(m ? m(a[g]) : a[g],a[g])\r\n    }\r\n    h.value = e\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setSelectFilterLabel = function(c, a) {\r\n    if (!this._filter_tr) {\r\n        this._filter_tr = []\r\n    }\r\n    this._filter_tr[c] = a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._loadComboOptins = function(g, m) {\r\n    if (!g.combo) {\r\n        return\r\n    }\r\n    var a = this.collectValues(m);\r\n    g.combo.clearAll();\r\n    var h = [[\"\", \"\"]];\r\n    for (var e = 0; e < a.length; e++) {\r\n        h.push([a[e], a[e]])\r\n    }\r\n    g.combo.addOption(h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.refreshFilters = function() {\r\n    if (!this.filters) {\r\n        return\r\n    }\r\n    for (var a = 0; a < this.filters.length; a++) {\r\n        switch (this.filters[a][0].tagName.toLowerCase()) {\r\n        case \"input\":\r\n            break;\r\n        case \"select\":\r\n            this._loadSelectOptins.apply(this, this.filters[a]);\r\n            break;\r\n        case \"div\":\r\n            this._loadComboOptins.apply(this, this.filters[a]);\r\n            break\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._filters_ready = function(c, a) {\r\n    this.attachEvent(\"onXLE\", this.refreshFilters);\r\n    this.attachEvent(\"onRowCreated\", function(h, g) {\r\n        if (this._f_rowsBuffer) {\r\n            for (var e = 0; e < this._f_rowsBuffer.length; e++) {\r\n                if (this._f_rowsBuffer[e].idd == h) {\r\n                    return this._f_rowsBuffer[e] = g\r\n                }\r\n            }\r\n        }\r\n    });\r\n    this.attachEvent(\"onClearAll\", function() {\r\n        this._f_rowsBuffer = null ;\r\n        if (!this.hdr.rows.length) {\r\n            this.filters = []\r\n        }\r\n    });\r\n    this.attachEvent(\"onSetSizes\", this._filters_resize_combo);\r\n    this.attachEvent(\"onResize\", this._filters_resize_combo);\r\n    this._filters_ready = function() {}\r\n}\r\n;\r\ndhtmlXGridObject.prototype._filters_resize_combo = function() {\r\n    if (!this.filters) {\r\n        return\r\n    }\r\n    for (var a = 0; a < this.filters.length; a++) {\r\n        if (this.filters[a][0].combo != null ) {\r\n            this.filters[a][0].combo.setSize(Math.round(this.filters[a][0].offsetWidth * 90 / 100))\r\n        }\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_text_filter = function(c, a) {\r\n    c.innerHTML = \"<input type='text'>\";\r\n    c.onclick = c.onmousedown = function(g) {\r\n        (g || event).cancelBubble = true;\r\n        return true\r\n    }\r\n    ;\r\n    c.onselectstart = function() {\r\n        return ( event.cancelBubble = true) \r\n    }\r\n    ;\r\n    this.makeFilter(c.firstChild, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_text_filter_inc = function(c, a) {\r\n    c.innerHTML = \"<input type='text'>\";\r\n    c.onclick = c.onmousedown = function(g) {\r\n        (g || event).cancelBubble = true;\r\n        return true\r\n    }\r\n    ;\r\n    c.onselectstart = function() {\r\n        return ( event.cancelBubble = true) \r\n    }\r\n    ;\r\n    this.makeFilter(c.firstChild, a);\r\n    c.firstChild._filter = function() {\r\n        if (c.firstChild.value == \"\") {\r\n            return \"\"\r\n        }\r\n        return function(e) {\r\n            return ( e.toString().toLowerCase().indexOf(c.firstChild.value.toLowerCase()) == 0) \r\n        }\r\n    }\r\n    ;\r\n    this._filters_ready()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_select_filter = function(c, a) {\r\n    c.innerHTML = \"<select></select>\";\r\n    c.onclick = function(g) {\r\n        (g || event).cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    this.makeFilter(c.firstChild, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_select_filter_strict = function(e, c) {\r\n    e.innerHTML = \"<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>\";\r\n    e.onclick = function(g) {\r\n        (g || event).cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    this.makeFilter(e.firstChild, c);\r\n    var a = this.combos;\r\n    e.firstChild._filter = function() {\r\n        var g = e.firstChild.value;\r\n        if (!g) {\r\n            return \"\"\r\n        }\r\n        if (a[c]) {\r\n            g = a[c].keys[a[c].values._dhx_find(g)]\r\n        }\r\n        g = g.toLowerCase();\r\n        return function(h) {\r\n            return ( h.toString().toLowerCase() == g) \r\n        }\r\n    }\r\n    ;\r\n    this._filters_ready()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_combo_filter = function(c, a) {\r\n    c.innerHTML = \"<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>\";\r\n    c.onselectstart = function() {\r\n        return ( event.cancelBubble = true) \r\n    }\r\n    ;\r\n    c.onclick = c.onmousedown = function(g) {\r\n        (g || event).cancelBubble = true;\r\n        return true\r\n    }\r\n    ;\r\n    this.makeFilter(c.firstChild, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._search_common = function(c, a) {\r\n    c.innerHTML = \"<input type='text' style='width:90%; '>\";\r\n    c.onclick = c.onmousedown = function(g) {\r\n        (g || event).cancelBubble = true;\r\n        return true\r\n    }\r\n    ;\r\n    c.onselectstart = function() {\r\n        return ( event.cancelBubble = true) \r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_text_search = function(e, c, a) {\r\n    this._search_common(e, c);\r\n    this.makeSearch(e.firstChild, c)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_text_search_strict = function(c, a) {\r\n    this._search_common(c, a);\r\n    this.makeSearch(c.firstChild, a, true)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_numeric_filter = function(c, a) {\r\n    this._in_header_text_filter.call(this, c, a);\r\n    c.firstChild._filter = function() {\r\n        var e = this.value;\r\n        var h;\r\n        var m = \"==\";\r\n        var g = parseFloat(e.replace(\"=\", \"\"));\r\n        var l = null ;\r\n        if (e) {\r\n            if (e.indexOf(\"..\") != -1) {\r\n                e = e.split(\"..\");\r\n                g = parseFloat(e[0]);\r\n                l = parseFloat(e[1]);\r\n                return function(n) {\r\n                    if (n >= g && n <= l) {\r\n                        return true\r\n                    }\r\n                    return false\r\n                }\r\n            }\r\n            h = e.match(/>=|<=|>|</);\r\n            if (h) {\r\n                m = h[0];\r\n                g = parseFloat(e.replace(m, \"\"))\r\n            }\r\n            return Function(\"v\", \" if (v \" + m + \" \" + g + \" ) return true; return false;\")\r\n        }\r\n        return \"\"\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_master_checkbox = function(g, e, h) {\r\n    g.innerHTML = h[0] + \"<input type='checkbox' />\" + h[1];\r\n    var a = this;\r\n    g.getElementsByTagName(\"input\")[0].onclick = function(l) {\r\n        a._build_m_order();\r\n        var c = a._m_order ? a._m_order[e] : e;\r\n        var m = this.checked ? 1 : 0;\r\n        a.forEachRowA(function(o) {\r\n            var n = this.cells(o, c);\r\n            if (n.isCheckbox()) {\r\n                n.setValue(m);\r\n                n.cell.wasChanged = true\r\n            }\r\n            this.callEvent(\"onEditCell\", [1, o, c, m]);\r\n            this.callEvent(\"onCheckbox\", [o, c, m])\r\n        });\r\n        (l || event).cancelBubble = true\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_total = function(e, a, h) {\r\n    var g = function() {\r\n        var n = 0;\r\n        this._build_m_order();\r\n        var m = this._m_order ? this._m_order[a] : a;\r\n        for (var l = 0; l < this.rowsBuffer.length; l++) {\r\n            var c = parseFloat(this._get_cell_value(this.rowsBuffer[l], m));\r\n            n += isNaN(c) ? 0 : c\r\n        }\r\n        return this._maskArr[m] ? this._aplNF(n, m) : (Math.round(n * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_multi_total = function(h, g, o) {\r\n    var n = o[1].split(\":\");\r\n    o[1] = \"\";\r\n    for (var e = 0; e < n.length; e++) {\r\n        n[e] = parseInt(n[e])\r\n    }\r\n    var l = function() {\r\n        var u = 0;\r\n        for (var s = 0; s < this.rowsBuffer.length; s++) {\r\n            var r = 1;\r\n            for (var c = 0; c < n.length; c++) {\r\n                r *= parseFloat(this._get_cell_value(this.rowsBuffer[s], n[c]))\r\n            }\r\n            u += isNaN(r) ? 0 : r\r\n        }\r\n        return this._maskArr[g] ? this._aplNF(u, g) : (Math.round(u * 100) / 100)\r\n    }\r\n    ;\r\n    var a = [];\r\n    for (var m = 0; m < n.length; m++) {\r\n        a[n[m]] = true\r\n    }\r\n    this._stat_in_header(h, l, a, o, o)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_max = function(e, a, h) {\r\n    var g = function() {\r\n        this._build_m_order();\r\n        var l = this._m_order ? this._m_order[a] : a;\r\n        var m = -999999999;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"&nbsp;\"\r\n        }\r\n        for (var c = 0; c < this.rowsBuffer.length; c++) {\r\n            m = Math.max(m, parseFloat(this._get_cell_value(this.rowsBuffer[c], l)))\r\n        }\r\n        return this._maskArr[a] ? this._aplNF(m, a) : m\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_min = function(e, a, h) {\r\n    var g = function() {\r\n        this._build_m_order();\r\n        var l = this._m_order ? this._m_order[a] : a;\r\n        var m = 999999999;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"&nbsp;\"\r\n        }\r\n        for (var c = 0; c < this.rowsBuffer.length; c++) {\r\n            m = Math.min(m, parseFloat(this._get_cell_value(this.rowsBuffer[c], l)))\r\n        }\r\n        return this._maskArr[a] ? this._aplNF(m, a) : m\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_average = function(e, a, h) {\r\n    var g = function() {\r\n        this._build_m_order();\r\n        var m = this._m_order ? this._m_order[a] : a;\r\n        var o = 0;\r\n        var n = 0;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"&nbsp;\"\r\n        }\r\n        for (var l = 0; l < this.rowsBuffer.length; l++) {\r\n            var c = parseFloat(this._get_cell_value(this.rowsBuffer[l], m));\r\n            if (!isNaN(c)) {\r\n                o += c;\r\n                n++\r\n            }\r\n        }\r\n        return this._maskArr[a] ? this._aplNF(o / n, a) : (Math.round(o / n * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_count = function(e, a, h) {\r\n    var g = function() {\r\n        return this.getRowsNum()\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._stat_in_header = function(e, g, a, m) {\r\n    var h = this;\r\n    var l = function() {\r\n        this.dma(true);\r\n        e.innerHTML = (m[0] ? m[0] : \"\") + g.call(this) + (m[1] ? m[1] : \"\");\r\n        this.dma(false);\r\n        this.callEvent(\"onStatReady\", [])\r\n    }\r\n    ;\r\n    if (!this._stat_events) {\r\n        this._stat_events = [];\r\n        this.attachEvent(\"onClearAll\", function() {\r\n            if (!this.hdr.rows[1]) {\r\n                for (var n = 0; n < this._stat_events.length; n++) {\r\n                    for (var c = 0; c < 4; c++) {\r\n                        this.detachEvent(this._stat_events[n][c])\r\n                    }\r\n                }\r\n                this._stat_events = []\r\n            }\r\n        })\r\n    }\r\n    this._stat_events.push([this.attachEvent(\"onGridReconstructed\", l), this.attachEvent(\"onXLE\", l), this.attachEvent(\"onFilterEnd\", l), this.attachEvent(\"onEditCell\", function(c, o, n) {\r\n        if (c == 2 && (n == a || (a && a[n]))) {\r\n            l.call(this)\r\n        }\r\n        return true\r\n    })]);\r\n    e.innerHTML = \"\"\r\n}\r\n;\r\ndhtmlXGridObject.prototype.loadCSVFile = function(c, a) {\r\n    this.load(c, a, \"csv\")\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableCSVAutoID = function(a) {\r\n    this._csvAID = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableCSVHeader = function(a) {\r\n    this._csvHdr = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setCSVDelimiter = function(a) {\r\n    this.csv.cell = a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._csvAID = true;\r\ndhtmlXGridObject.prototype.loadCSVString = function(a) {\r\n    this.parse(a, \"csv\")\r\n}\r\n;\r\ndhtmlXGridObject.prototype.serializeToCSV = function(n) {\r\n    this.editStop();\r\n    if (this._mathSerialization) {\r\n        this._agetm = \"getMathValue\"\r\n    } else {\r\n        if (this._strictText || n) {\r\n            this._agetm = \"getTitle\"\r\n        } else {\r\n            this._agetm = \"getValue\"\r\n        }\r\n    }\r\n    var l = [];\r\n    if (this._csvHdr) {\r\n        for (var h = 1; h < this.hdr.rows.length; h++) {\r\n            var c = [];\r\n            for (var m = 0; m < this._cCount; m++) {\r\n                if ((!this._srClmn) || (this._srClmn[m])) {\r\n                    c.push(this.getColumnLabel(m, h - 1))\r\n                }\r\n            }\r\n            l.push(this.csvParser.str(c, this.csv.cell, this.csv.row))\r\n        }\r\n    }\r\n    var m = 0;\r\n    var g = this.rowsBuffer.length;\r\n    for (m; m < g; m++) {\r\n        var e = this._serializeRowToCVS(null , m);\r\n        if (e != \"\") {\r\n            l.push(e)\r\n        }\r\n    }\r\n    return this.csvParser.block(l, this.csv.row)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._serializeRowToCVS = function(a, o, e, m) {\r\n    var n = new Array();\r\n    if (!a) {\r\n        a = this.render_row(o);\r\n        if (this._fake && !this._fake.rowsAr[a.idd]) {\r\n            this._fake.render_row(o)\r\n        }\r\n    }\r\n    if (!this._csvAID) {\r\n        n[n.length] = a.idd\r\n    }\r\n    e = e || 0;\r\n    m = m || this._cCount;\r\n    var v = false;\r\n    var g = e;\r\n    while (a.childNodes[e]._cellIndex > g && e) {\r\n        e--\r\n    }\r\n    for (var s = e; g < m; s++) {\r\n        if (!a.childNodes[s]) {\r\n            break\r\n        }\r\n        var c = a.childNodes[s]._cellIndex;\r\n        if (((!this._srClmn) || (this._srClmn[c])) && (!this._serialize_visible || !this._hrrar[c])) {\r\n            var h = a.childNodes[s];\r\n            var l = this.cells(a.idd, c);\r\n            while (g != c) {\r\n                g++;\r\n                n.push(\"\");\r\n                if (g >= m) {\r\n                    break\r\n                }\r\n            }\r\n            if (g >= m) {\r\n                break\r\n            }\r\n            g++;\r\n            if (l.cell) {\r\n                zxVal = l[this._agetm]()\r\n            } else {\r\n                zxVal = \"\"\r\n            }\r\n            if ((this._chAttr) && (l.wasChanged())) {\r\n                v = true\r\n            }\r\n            n[n.length] = ((zxVal === null ) ? \"\" : zxVal);\r\n            if (this._ecspn && h.colSpan && h.colSpan > 1) {\r\n                h = h.colSpan - 1;\r\n                for (var w = 0; w < h; w++) {\r\n                    n[n.length] = \"\";\r\n                    g++\r\n                }\r\n            }\r\n        } else {\r\n            g++\r\n        }\r\n    }\r\n    if ((this._onlChAttr) && (!v)) {\r\n        return \"\"\r\n    }\r\n    return this.csvParser.str(n, this.csv.cell, this.csv.row)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.toClipBoard = function(a) {\r\n    if (window.clipboardData) {\r\n        window.clipboardData.setData(\"Text\", a)\r\n    } else {\r\n        (new Clipboard()).copy(a)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.fromClipBoard = function() {\r\n    if (window.clipboardData) {\r\n        return window.clipboardData.getData(\"Text\")\r\n    } else {\r\n        return (new Clipboard()).paste()\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.cellToClipboard = function(e, c) {\r\n    if ((!e) || (!c && c !== 0)) {\r\n        if (!this.selectedRows[0]) {\r\n            return\r\n        }\r\n        e = this.selectedRows[0].idd;\r\n        c = this.cell._cellIndex\r\n    }\r\n    var a = this.cells(e, c);\r\n    this.toClipBoard(((a.getLabel ? a.getLabel() : a.getValue()) || \"\").toString())\r\n}\r\n;\r\ndhtmlXGridObject.prototype.updateCellFromClipboard = function(e, c) {\r\n    if ((!e) || (!c)) {\r\n        if (!this.selectedRows[0]) {\r\n            return\r\n        }\r\n        e = this.selectedRows[0].idd;\r\n        c = this.cell._cellIndex\r\n    }\r\n    var a = this.cells(e, c);\r\n    a[a.setImage ? \"setLabel\" : \"setValue\"](this.fromClipBoard())\r\n}\r\n;\r\ndhtmlXGridObject.prototype.rowToClipboard = function(g) {\r\n    var a = \"\";\r\n    if (this._mathSerialization) {\r\n        this._agetm = \"getMathValue\"\r\n    } else {\r\n        if (this._strictText) {\r\n            this._agetm = \"getTitle\"\r\n        } else {\r\n            this._agetm = \"getValue\"\r\n        }\r\n    }\r\n    this._serialize_visible = !this._fake;\r\n    if (g) {\r\n        a = this._serializeRowToCVS(this.getRowById(g))\r\n    } else {\r\n        var e = [];\r\n        for (var c = 0; c < this.selectedRows.length; c++) {\r\n            e[e.length] = this._serializeRowToCVS(this.selectedRows[c]);\r\n            a = this.csvParser.block(e, this.csv.row)\r\n        }\r\n    }\r\n    this._serialize_visible = false;\r\n    this.toClipBoard(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.updateRowFromClipboard = function(h) {\r\n    var a = this.fromClipBoard();\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (h) {\r\n        var g = this.getRowById(h)\r\n    } else {\r\n        var g = this.selectedRows[0]\r\n    }\r\n    if (!g) {\r\n        return\r\n    }\r\n    var l = this.csvParser;\r\n    a = l.unblock(a, this.csv.cell, this.csv.row)[0];\r\n    if (!this._csvAID) {\r\n        a.splice(0, 1)\r\n    }\r\n    for (var e = 0; e < a.length; e++) {\r\n        var c = this.cells3(g, e);\r\n        c[c.setImage ? \"setLabel\" : \"setValue\"](a[e])\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.csvParser = {\r\n    block: function(a, c) {\r\n        return a.join(c)\r\n    },\r\n    unblock: function(l, a, h) {\r\n        var g = (l || \"\").split(h);\r\n        for (var c = 0; c < g.length; c++) {\r\n            g[c] = (g[c] || \"\").split(a)\r\n        }\r\n        var e = g.length - 1;\r\n        if (g[e].length == 1 && g[e][0] == \"\") {\r\n            g.splice(e, 1)\r\n        }\r\n        return g\r\n    },\r\n    str: function(c, a, e) {\r\n        return c.join(a)\r\n    }\r\n};\r\ndhtmlXGridObject.prototype.csvExtParser = {\r\n    _quote: RegExp('\"', \"g\"),\r\n    _quote_esc: RegExp('\\\\\\\\\"', \"g\"),\r\n    block: function(a, c) {\r\n        return a.join(c)\r\n    },\r\n    unblock: function(n, s, v) {\r\n        var e = [[]];\r\n        var c = 0;\r\n        if (!n) {\r\n            return e\r\n        }\r\n        var o = /^[ ]*\"/;\r\n        var m = /\"[ ]*$/;\r\n        var a = new RegExp(\".*\" + v + \".*$\");\r\n        var h = n.split(s);\r\n        for (var g = 0; g < h.length; g++) {\r\n            if (h[g].match(o)) {\r\n                var u = h[g].replace(o, \"\");\r\n                while (!h[g].match(m)) {\r\n                    g++;\r\n                    u += h[g]\r\n                }\r\n                e[c].push(u.replace(m, \"\").replace(this._quote_esc, '\"'))\r\n            } else {\r\n                if (h[g].match(a)) {\r\n                    var l = h[g].indexOf(v);\r\n                    e[c].push(h[g].substr(0, l));\r\n                    c++;\r\n                    e[c] = [];\r\n                    h[g] = h[g].substr(l + 1);\r\n                    g--\r\n                } else {\r\n                    if (h[g] || g != h.length - 1) {\r\n                        e[c].push(h[g])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var r = e.length - 1;\r\n        if (r > 0 && !e[r].length) {\r\n            e.splice(r, 1)\r\n        }\r\n        return e\r\n    },\r\n    str: function(e, a, g) {\r\n        for (var c = 0; c < e.length; c++) {\r\n            e[c] = '\"' + e[c].replace(this._quote, '\\\\\"') + '\"'\r\n        }\r\n        return e.join(a)\r\n    }\r\n};\r\ndhtmlXGridObject.prototype.addRowFromClipboard = function() {\r\n    var a = this.fromClipBoard();\r\n    if (!a) {\r\n        return\r\n    }\r\n    var e = this.csvParser.unblock(a, this.csv.cell, this.csv.row);\r\n    for (var c = 0; c < e.length; c++) {\r\n        if (e[c]) {\r\n            a = e[c];\r\n            if (!a.length) {\r\n                continue\r\n            }\r\n            if (this._csvAID) {\r\n                this.addRow(this.getRowsNum() + 2, a)\r\n            } else {\r\n                if (this.rowsAr[a[0]]) {\r\n                    a[0] = this.uid()\r\n                }\r\n                this.addRow(a[0], a.slice(1))\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.gridToClipboard = function() {\r\n    this.toClipBoard(this.serializeToCSV())\r\n}\r\n;\r\ndhtmlXGridObject.prototype.gridFromClipboard = function() {\r\n    var a = this.fromClipBoard();\r\n    if (!a) {\r\n        return\r\n    }\r\n    this.loadCSVString(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getXLS = function(m) {\r\n    if (!this.xslform) {\r\n        this.xslform = document.createElement(\"FORM\");\r\n        this.xslform.action = (m || \"\") + \"xls.php\";\r\n        this.xslform.method = \"post\";\r\n        this.xslform.target = (_isIE ? \"_blank\" : \"\");\r\n        document.body.appendChild(this.xslform);\r\n        var h = document.createElement(\"INPUT\");\r\n        h.type = \"hidden\";\r\n        h.name = \"csv\";\r\n        this.xslform.appendChild(h);\r\n        var g = document.createElement(\"INPUT\");\r\n        g.type = \"hidden\";\r\n        g.name = \"csv_header\";\r\n        this.xslform.appendChild(g)\r\n    }\r\n    var n = this.serializeToCSV();\r\n    this.xslform.childNodes[0].value = n;\r\n    var e = [];\r\n    var a = this._cCount;\r\n    for (var c = 0; c < a; c++) {\r\n        e.push(this.getHeaderCol(c))\r\n    }\r\n    e = e.join(\",\");\r\n    this.xslform.childNodes[1].value = e;\r\n    this.xslform.submit()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.printView = function(v, e) {\r\n    var r = \"<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \\n td.filter input, td.filter select { display:none; }\t\\n  </style>\";\r\n    var E = null ;\r\n    if (this._fake) {\r\n        E = [].concat(this._hrrar);\r\n        for (var D = 0; D < this._fake._cCount; D++) {\r\n            this._hrrar[D] = null \r\n        }\r\n    }\r\n    var o = document.location.port;\r\n    var s = document.location.hostname;\r\n    r += \"<base  href='\" + (document.location.protocol + \"//\" + s + (o ? (\":\" + o) : \"\") + document.location.pathname) + \"'></base>\";\r\n    if (!this.parentGrid) {\r\n        r += (v || \"\")\r\n    }\r\n    r += '<table width=\"100%\" border=\"2px\" cellpadding=\"0\" cellspacing=\"0\">';\r\n    var u = Math.max(this.rowsBuffer.length, this.rowsCol.length);\r\n    var n = this._cCount;\r\n    var w = this._printWidth();\r\n    r += '<tr class=\"header_row_1\">';\r\n    for (var D = 0; D < n; D++) {\r\n        if (this._hrrar && this._hrrar[D]) {\r\n            continue\r\n        }\r\n        var h = this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes ? this.hdr.rows[1]._childIndexes[parseInt(D)] : D];\r\n        var a = (h.colSpan || 1);\r\n        var J = (h.rowSpan || 1);\r\n        for (var C = 1; C < a; C++) {\r\n            w[D] += w[C]\r\n        }\r\n        r += '<td rowspan=\"' + J + '\" width=\"' + w[D] + '%\" style=\"background-color:lightgrey;\" colspan=\"' + a + '\">' + this.getHeaderCol(D) + \"</td>\";\r\n        D += a - 1\r\n    }\r\n    r += \"</tr>\";\r\n    for (var D = 2; D < this.hdr.rows.length; D++) {\r\n        if (_isIE) {\r\n            r += \"<tr style='background-color:lightgrey' class='header_row_\" + D + \"'>\";\r\n            var g = this.hdr.rows[D].childNodes;\r\n            for (var C = 0; C < g.length; C++) {\r\n                if (!this._hrrar || !this._hrrar[g[C]._cellIndex]) {\r\n                    r += g[C].outerHTML\r\n                }\r\n            }\r\n            r += \"</tr>\"\r\n        } else {\r\n            r += \"<tr class='header_row_\" + D + \"' style='background-color:lightgrey'>\" + (this._fake ? this._fake.hdr.rows[D].innerHTML : \"\") + this.hdr.rows[D].innerHTML + \"</tr>\"\r\n        }\r\n    }\r\n    for (var D = 0; D < u; D++) {\r\n        r += \"<tr>\";\r\n        if (this.rowsCol[D] && this.rowsCol[D]._cntr) {\r\n            r += this.rowsCol[D].innerHTML.replace(/<img[^>]*>/gi, \"\") + \"</tr>\";\r\n            continue\r\n        }\r\n        if (this.rowsCol[D] && this.rowsCol[D].style.display == \"none\") {\r\n            continue\r\n        }\r\n        var m;\r\n        if (this.rowsCol[D]) {\r\n            m = this.rowsCol[D].idd\r\n        } else {\r\n            if (this.rowsBuffer[D]) {\r\n                m = this.rowsBuffer[D].idd\r\n            } else {\r\n                continue\r\n            }\r\n        }\r\n        for (var C = 0; C < n; C++) {\r\n            if (this._hrrar && this._hrrar[C]) {\r\n                continue\r\n            }\r\n            if (this.rowsAr[m] && this.rowsAr[m].tagName == \"TR\") {\r\n                var I = this.cells(m, C);\r\n                if (I._setState) {\r\n                    var x = \"\"\r\n                } else {\r\n                    if (I.getContent) {\r\n                        x = I.getContent()\r\n                    } else {\r\n                        if (I.getImage || I.combo) {\r\n                            var x = I.cell.innerHTML\r\n                        } else {\r\n                            var x = I.getValue()\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                var x = this._get_cell_value(this.rowsBuffer[D], C)\r\n            }\r\n            var y = this.columnColor[C] ? \"background-color:\" + this.columnColor[C] + \";\" : \"\";\r\n            var A = this.cellAlign[C] ? \"text-align:\" + this.cellAlign[C] + \";\" : \"\";\r\n            var F = I.getAttribute(\"colspan\");\r\n            r += '<td style=\"' + y + A + '\" ' + (F ? 'colSpan=\"' + F + '\"' : \"\") + \">\" + (x === \"\" ? \"&nbsp;\" : x) + \"</td>\";\r\n            if (F) {\r\n                C += F - 1\r\n            }\r\n        }\r\n        r += \"</tr>\";\r\n        if (this.rowsCol[D] && this.rowsCol[D]._expanded) {\r\n            var l = this.cells4(this.rowsCol[D]._expanded.ctrl);\r\n            if (l.getSubGrid) {\r\n                r += '<tr><td colspan=\"' + n + '\">' + l.getSubGrid().printView() + \"</td></tr>\"\r\n            } else {\r\n                r += '<tr><td colspan=\"' + n + '\">' + this.rowsCol[D]._expanded.innerHTML + \"</td></tr>\"\r\n            }\r\n        }\r\n    }\r\n    if (this.ftr) {\r\n        for (var D = 1; D < this.ftr.childNodes[0].rows.length; D++) {\r\n            r += \"<tr style='background-color:lightgrey'>\" + ((this._fake) ? this._fake.ftr.childNodes[0].rows[D].innerHTML : \"\") + this.ftr.childNodes[0].rows[D].innerHTML + \"</tr>\"\r\n        }\r\n    }\r\n    r += \"</table>\";\r\n    if (this.parentGrid) {\r\n        return r\r\n    }\r\n    r += (e || \"\");\r\n    var H = window.open(\"\", \"_blank\");\r\n    H.document.write(r);\r\n    H.document.write(\"<script>window.onerror=function(){return true;}<\\/script>\");\r\n    H.document.close();\r\n    if (this._fake) {\r\n        this._hrrar = E\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._printWidth = function() {\r\n    var h = [];\r\n    var g = 0;\r\n    for (var e = 0; e < this._cCount; e++) {\r\n        var a = this.getColWidth(e);\r\n        h.push(a);\r\n        g += a\r\n    }\r\n    var m = [];\r\n    var c = 0;\r\n    for (var e = 0; e < h.length; e++) {\r\n        var l = Math.floor((h[e] / g) * 100);\r\n        c += l;\r\n        m.push(l)\r\n    }\r\n    m[m.length - 1] += 100 - c;\r\n    return m\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableBlockSelection = function(e) {\r\n    if (typeof this._bs_mode == \"undefined\") {\r\n        var a = this;\r\n        this.obj.onmousedown = function(g) {\r\n            if (a._bs_mode) {\r\n                a._OnSelectionStart((g || event), this)\r\n            }\r\n            return true\r\n        }\r\n        ;\r\n        this._CSVRowDelimiter = this.csv.row;\r\n        this.attachEvent(\"onResize\", function() {\r\n            a._HideSelection();\r\n            return true\r\n        });\r\n        this.attachEvent(\"onGridReconstructed\", function() {\r\n            a._HideSelection();\r\n            return true\r\n        });\r\n        this.attachEvent(\"onFilterEnd\", this._HideSelection)\r\n    }\r\n    if (e === false) {\r\n        this._bs_mode = false;\r\n        return this._HideSelection()\r\n    } else {\r\n        this._bs_mode = true\r\n    }\r\n    if (!window.dhx4.isIPad) {\r\n        var c = this._clip_area = document.createElement(\"textarea\");\r\n        c.style.cssText = \"position:absolute; width:1px; height:1px; overflow:hidden; color:transparent; background-color:transparent; bottom:1px; right:1px; border:none;\";\r\n        c.onkeydown = function(g) {\r\n            g = g || event;\r\n            if (g.keyCode == 86 && (g.ctrlKey || g.metaKey)) {\r\n                a.pasteBlockFromClipboard()\r\n            }\r\n        }\r\n        ;\r\n        document.body.insertBefore(this._clip_area, document.body.firstChild);\r\n        dhtmlxEvent(this.entBox, \"click\", function() {\r\n            if (!a.editor && a._clip_area) {\r\n                a._clip_area.select()\r\n            }\r\n        })\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.forceLabelSelection = function(a) {\r\n    this._strictText = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._OnSelectionStart = function(e, g) {\r\n    var c = this;\r\n    if (e.button == 2) {\r\n        return\r\n    }\r\n    var h = e.srcElement || e.target;\r\n    if (this.editor) {\r\n        if (h.tagName && (h.tagName == \"INPUT\" || h.tagName == \"TEXTAREA\")) {\r\n            return\r\n        }\r\n        this.editStop()\r\n    }\r\n    c.setActive(true);\r\n    var m = this.getPosition(this.obj);\r\n    var a = e.clientX - m[0] + (document.body.scrollLeft || (document.documentElement ? document.documentElement.scrollLeft : 0));\r\n    var l = e.clientY - m[1] + (document.body.scrollTop || (document.documentElement ? document.documentElement.scrollTop : 0));\r\n    this._CreateSelection(a - 4, l - 4);\r\n    if (h == this._selectionObj) {\r\n        this._HideSelection();\r\n        this._startSelectionCell = null \r\n    } else {\r\n        while (h && (!h.tagName || h.tagName.toLowerCase() != \"td\")) {\r\n            h = h.parentNode\r\n        }\r\n        this._startSelectionCell = h\r\n    }\r\n    if (this._startSelectionCell) {\r\n        if (!this.callEvent(\"onBeforeBlockSelected\", [this._startSelectionCell.parentNode.idd, this._startSelectionCell._cellIndex])) {\r\n            return this._startSelectionCell = null \r\n        }\r\n    }\r\n    this.obj.onmousedown = null ;\r\n    this.obj[_isIE ? \"onmouseleave\" : \"onmouseout\"] = function(n) {\r\n        if (c._blsTimer) {\r\n            window.clearTimeout(c._blsTimer)\r\n        }\r\n    }\r\n    ;\r\n    this.obj.onmmold = this.obj.onmousemove;\r\n    this._init_pos = [a, l];\r\n    this._selectionObj.onmousemove = this.obj.onmousemove = function(n) {\r\n        n = n || e;\r\n        if (n.preventDefault) {\r\n            n.preventDefault()\r\n        } else {\r\n            n.returnValue = false\r\n        }\r\n        c._OnSelectionMove(n)\r\n    }\r\n    ;\r\n    this._oldDMP = document.body.onmouseup;\r\n    document.body.onmouseup = function(n) {\r\n        n = n || e;\r\n        c._OnSelectionStop(n, this);\r\n        return true\r\n    }\r\n    ;\r\n    this.callEvent(\"onBeforeBlockSelection\", []);\r\n    document.body.onselectstart = function() {\r\n        return false\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._getCellByPos = function(a, g) {\r\n    a = a;\r\n    if (this._fake) {\r\n        a += this._fake.objBox.scrollWidth\r\n    }\r\n    g = g;\r\n    var c = 0;\r\n    for (var e = 0; e < this.obj.rows.length; e++) {\r\n        g -= this.obj.rows[e].offsetHeight;\r\n        if (g <= 0) {\r\n            c = this.obj.rows[e];\r\n            break\r\n        }\r\n    }\r\n    if (!c || !c.idd) {\r\n        return null \r\n    }\r\n    for (var e = 0; e < this._cCount; e++) {\r\n        a -= this.getColWidth(e);\r\n        if (a <= 0) {\r\n            while (true) {\r\n                if (c._childIndexes && c._childIndexes[e + 1] == c._childIndexes[e]) {\r\n                    c = c.previousSibling\r\n                } else {\r\n                    return this.cells(c.idd, e).cell\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXGridObject.prototype._OnSelectionMove = function(g) {\r\n    var x = this;\r\n    this._ShowSelection();\r\n    var s = this.getPosition(this.obj);\r\n    var m = g.clientX - s[0] + (document.body.scrollLeft || (document.documentElement ? document.documentElement.scrollLeft : 0));\r\n    var l = g.clientY - s[1] + (document.body.scrollTop || (document.documentElement ? document.documentElement.scrollTop : 0));\r\n    if ((Math.abs(this._init_pos[0] - m) < 5) && (Math.abs(this._init_pos[1] - l) < 5)) {\r\n        return this._HideSelection()\r\n    }\r\n    var v = this._endSelectionCell;\r\n    if (this._startSelectionCell == null ) {\r\n        this._endSelectionCell = this._startSelectionCell = this.getFirstParentOfType(g.srcElement || g.target, \"TD\")\r\n    } else {\r\n        if (g.srcElement || g.target) {\r\n            if ((g.srcElement || g.target).className == \"dhtmlxGrid_selection\") {\r\n                this._endSelectionCell = (this._getCellByPos(m, l) || this._endSelectionCell)\r\n            } else {\r\n                var w = this.getFirstParentOfType(g.srcElement || g.target, \"TD\");\r\n                if (w.parentNode.idd) {\r\n                    this._endSelectionCell = w\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (this._endSelectionCell) {\r\n        if (!this.callEvent(\"onBeforeBlockSelected\", [this._endSelectionCell.parentNode.idd, this._endSelectionCell._cellIndex])) {\r\n            this._endSelectionCell = v\r\n        }\r\n    }\r\n    var h = this.objBox.scrollLeft + this.objBox.clientWidth;\r\n    var c = this.objBox.scrollTop + this.objBox.clientHeight;\r\n    var o = this.objBox.scrollLeft;\r\n    var n = this.objBox.scrollTop;\r\n    var e = false;\r\n    if (this._blsTimer) {\r\n        window.clearTimeout(this._blsTimer)\r\n    }\r\n    if (m + 20 >= h) {\r\n        this.objBox.scrollLeft = this.objBox.scrollLeft + 20;\r\n        e = true\r\n    } else {\r\n        if (m - 20 < o) {\r\n            this.objBox.scrollLeft = this.objBox.scrollLeft - 20;\r\n            e = true\r\n        }\r\n    }\r\n    if (l + 20 >= c && !this._realfake) {\r\n        this.objBox.scrollTop = this.objBox.scrollTop + 20;\r\n        e = true\r\n    } else {\r\n        if (l - 20 < n && !this._realfake) {\r\n            this.objBox.scrollTop = this.objBox.scrollTop - 20;\r\n            e = true\r\n        }\r\n    }\r\n    this._selectionArea = this._RedrawSelectionPos(this._startSelectionCell, this._endSelectionCell);\r\n    if (e) {\r\n        var u = g.clientX;\r\n        var r = g.clientY;\r\n        this._blsTimer = window.setTimeout(function() {\r\n            x._OnSelectionMove({\r\n                clientX: u,\r\n                clientY: r\r\n            })\r\n        }, 100)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._OnSelectionStop = function(c) {\r\n    var a = this;\r\n    if (this._blsTimer) {\r\n        window.clearTimeout(this._blsTimer)\r\n    }\r\n    this.obj.onmousedown = function(g) {\r\n        if (a._bs_mode) {\r\n            a._OnSelectionStart((g || c), this)\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    this.obj.onmousemove = this.obj.onmmold || null ;\r\n    this._selectionObj.onmousemove = null ;\r\n    document.body.onmouseup = this._oldDMP || null ;\r\n    if (parseInt(this._selectionObj.style.width) < 2 && parseInt(this._selectionObj.style.height) < 2) {\r\n        this._HideSelection()\r\n    } else {\r\n        var e = this.getFirstParentOfType(c.srcElement || c.target, \"TD\");\r\n        if ((!e) || (!e.parentNode.idd)) {\r\n            e = this._endSelectionCell\r\n        }\r\n        while (e && (!e.tagName || e.tagName.toLowerCase() != \"td\")) {\r\n            e = e.parentNode\r\n        }\r\n        if (!e) {\r\n            return this._HideSelection()\r\n        }\r\n        this._stopSelectionCell = e;\r\n        this._selectionArea = this._RedrawSelectionPos(this._startSelectionCell, this._stopSelectionCell);\r\n        this.callEvent(\"onBlockSelected\", [])\r\n    }\r\n    document.body.onselectstart = function() {}\r\n}\r\n;\r\ndhtmlXGridObject.prototype._RedrawSelectionPos = function(u, m) {\r\n    if (u.parentNode.grid != m.parentNode.grid) {\r\n        return this._selectionArea\r\n    }\r\n    var r = {};\r\n    r.LeftTopCol = u._cellIndex;\r\n    r.LeftTopRow = this.getRowIndex(u.parentNode.idd);\r\n    r.RightBottomCol = m._cellIndex;\r\n    r.RightBottomRow = this.getRowIndex(m.parentNode.idd);\r\n    var g = u.offsetWidth;\r\n    var e = u.offsetHeight;\r\n    u = this.getPosition(u, this.obj);\r\n    var v = m.offsetWidth;\r\n    var n = m.offsetHeight;\r\n    m = this.getPosition(m, this.obj);\r\n    if (u[0] < m[0]) {\r\n        var h = u[0];\r\n        var l = m[0] + v\r\n    } else {\r\n        var o = r.RightBottomCol;\r\n        r.RightBottomCol = r.LeftTopCol;\r\n        r.LeftTopCol = o;\r\n        var h = m[0];\r\n        var l = u[0] + g\r\n    }\r\n    if (u[1] < m[1]) {\r\n        var s = u[1];\r\n        var a = m[1] + n\r\n    } else {\r\n        var o = r.RightBottomRow;\r\n        r.RightBottomRow = r.LeftTopRow;\r\n        r.LeftTopRow = o;\r\n        var s = m[1];\r\n        var a = u[1] + e\r\n    }\r\n    var w = l - h;\r\n    var c = a - s;\r\n    this._selectionObj.style.left = h + \"px\";\r\n    this._selectionObj.style.top = s + \"px\";\r\n    this._selectionObj.style.width = w + \"px\";\r\n    this._selectionObj.style.height = c + \"px\";\r\n    return r\r\n}\r\n;\r\ndhtmlXGridObject.prototype._CreateSelection = function(a, e) {\r\n    if (this._selectionObj == null ) {\r\n        var c = document.createElement(\"div\");\r\n        c.style.position = \"absolute\";\r\n        c.style.display = \"none\";\r\n        c.className = \"dhtmlxGrid_selection\";\r\n        this._selectionObj = c;\r\n        this._selectionObj.onmousedown = function(g) {\r\n            g = g || event;\r\n            if (g.button == 2 || (_isMacOS && g.ctrlKey)) {\r\n                return this.parentNode.grid.callEvent(\"onBlockRightClick\", [\"BLOCK\", g])\r\n            }\r\n        }\r\n        ;\r\n        this._selectionObj.oncontextmenu = function(g) {\r\n            (g || event).cancelBubble = true;\r\n            return false\r\n        }\r\n        ;\r\n        this.objBox.appendChild(this._selectionObj)\r\n    }\r\n    this._selectionObj.style.width = \"0px\";\r\n    this._selectionObj.style.height = \"0px\";\r\n    this._selectionObj.style.left = a + \"px\";\r\n    this._selectionObj.style.top = e + \"px\";\r\n    this._selectionObj.startX = a;\r\n    this._selectionObj.startY = e\r\n}\r\n;\r\ndhtmlXGridObject.prototype._ShowSelection = function() {\r\n    if (this._selectionObj) {\r\n        this._selectionObj.style.display = \"\"\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._HideSelection = function() {\r\n    if (this._selectionObj) {\r\n        this._selectionObj.style.display = \"none\"\r\n    }\r\n    this._selectionArea = null ;\r\n    if (this._clip_area) {\r\n        this._clip_area.value = \"\";\r\n        this._clip_area.blur()\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.copyBlockToClipboard = function() {\r\n    if (!this._clip_area) {\r\n        return\r\n    }\r\n    if (this._selectionArea != null ) {\r\n        var e = new Array();\r\n        if (this._mathSerialization) {\r\n            this._agetm = \"getMathValue\"\r\n        } else {\r\n            if (this._strictText) {\r\n                this._agetm = \"getTitle\"\r\n            } else {\r\n                this._agetm = \"getValue\"\r\n            }\r\n        }\r\n        this._serialize_visible = true;\r\n        for (var a = this._selectionArea.LeftTopRow; a <= this._selectionArea.RightBottomRow; a++) {\r\n            var c = this._serializeRowToCVS(this.rowsBuffer[a], null , this._selectionArea.LeftTopCol, this._selectionArea.RightBottomCol + 1);\r\n            if (!this._csvAID) {\r\n                e[e.length] = c.substr(c.indexOf(this.csv.cell) + 1)\r\n            } else {\r\n                e[e.length] = c\r\n            }\r\n        }\r\n        e = e.join(this._CSVRowDelimiter);\r\n        this._clip_area.value = e;\r\n        this._clip_area.select();\r\n        this._serialize_visible = false\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.pasteBlockFromClipboard = function() {\r\n    if (!this._clip_area) {\r\n        return\r\n    }\r\n    this._clip_area.select();\r\n    var a = this;\r\n    window.setTimeout(function() {\r\n        a._pasteBlockFromClipboard();\r\n        a = null \r\n    }, 1)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pasteBlockFromClipboard = function() {\r\n    var m = this._clip_area.value;\r\n    if (!m) {\r\n        return\r\n    }\r\n    if (this._selectionArea != null ) {\r\n        var w = this._selectionArea.LeftTopRow;\r\n        var a = this._selectionArea.LeftTopCol\r\n    } else {\r\n        if (this.cell != null  && !this.editor) {\r\n            var w = this.getRowIndex(this.cell.parentNode.idd);\r\n            var a = this.cell._cellIndex\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    m = this.csvParser.unblock(m, this.csv.cell, this.csv.row);\r\n    var o = w + m.length;\r\n    var u = a + m[0].length;\r\n    if (u > this._cCount) {\r\n        u = this._cCount\r\n    }\r\n    var g = 0;\r\n    for (var r = w; r < o; r++) {\r\n        var x = this.render_row(r);\r\n        if (x == -1) {\r\n            continue\r\n        }\r\n        var e = 0;\r\n        for (var h = a; h < u; h++) {\r\n            if (this._hrrar[h] && !this._fake) {\r\n                u = Math.min(u + 1, this._cCount);\r\n                continue\r\n            }\r\n            var s = this.cells3(x, h);\r\n            if (s.isDisabled()) {\r\n                e++;\r\n                continue\r\n            }\r\n            if (this._onEditUndoRedo) {\r\n                this._onEditUndoRedo(2, x.idd, h, m[g][e], s.getValue())\r\n            }\r\n            if (s.combo) {\r\n                var v = s.combo.values;\r\n                for (var c = 0; c < v.length; c++) {\r\n                    if (m[g][e] == v[c]) {\r\n                        s.setValue(s.combo.keys[c]);\r\n                        v = null ;\r\n                        break\r\n                    }\r\n                }\r\n                if (v != null  && s.editable) {\r\n                    s.setValue(m[g][e++])\r\n                } else {\r\n                    e++\r\n                }\r\n            } else {\r\n                s[s.setImage ? \"setLabel\" : \"setValue\"](m[g][e++])\r\n            }\r\n            s.cell.wasChanged = true\r\n        }\r\n        this.callEvent(\"onRowPaste\", [x.idd]);\r\n        g++\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getSelectedBlock = function() {\r\n    if (this._selectionArea) {\r\n        return this._selectionArea\r\n    } else {\r\n        if (this.getSelectedRowId() !== null ) {\r\n            return {\r\n                LeftTopRow: this.getSelectedRowId(),\r\n                LeftTopCol: this.getSelectedCellIndex(),\r\n                RightBottomRow: this.getSelectedRowId(),\r\n                RightBottomCol: this.getSelectedCellIndex()\r\n            }\r\n        } else {\r\n            return null \r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableSmartRendering = function(e, c, a) {\r\n    if (arguments.length > 2) {\r\n        if (c && !this.rowsBuffer[c - 1]) {\r\n            this.rowsBuffer[c - 1] = 0\r\n        }\r\n        c = a\r\n    }\r\n    this._srnd = dhx4.s2b(e);\r\n    this._srdh = this._srdh || 20;\r\n    this._dpref = c || 0\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enablePreRendering = function(a) {\r\n    this._srnd_pr = parseInt(a || 50)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.forceFullLoading = function(a, h) {\r\n    for (var e = 0; e < this.rowsBuffer.length; e++) {\r\n        if (!this.rowsBuffer[e]) {\r\n            var g = a || (this.rowsBuffer.length - e);\r\n            if (this.callEvent(\"onDynXLS\", [e, g])) {\r\n                var c = this;\r\n                this.load(this.xmlFileUrl + dhtmlx.url(this.xmlFileUrl) + \"posStart=\" + e + \"&count=\" + g, function() {\r\n                    window.setTimeout(function() {\r\n                        c.forceFullLoading(a, h)\r\n                    }, 100)\r\n                }, this._data_type)\r\n            }\r\n            return\r\n        }\r\n    }\r\n    if (h) {\r\n        h.call(this)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setAwaitedRowHeight = function(a) {\r\n    this._srdh = parseInt(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_view_size = function() {\r\n    return Math.floor(parseInt(this.entBox.offsetHeight) / this._srdh) + 2\r\n}\r\n;\r\ndhtmlXGridObject.prototype._add_filler = function(m, a, c, g) {\r\n    if (!a) {\r\n        return null \r\n    }\r\n    var l = \"__filler__\";\r\n    var h = this._prepareRow(l);\r\n    h.firstChild.style.width = \"1px\";\r\n    h.firstChild.style.borderWidth = h.firstChild.style.padding = h.firstChild.style.margin = \"0px\";\r\n    for (var e = 1; e < h.childNodes.length; e++) {\r\n        h.childNodes[e].style.display = \"none\"\r\n    }\r\n    h.firstChild.style.height = a * this._srdh + \"px\";\r\n    c = c || this.rowsCol[m];\r\n    if (c && c.nextSibling) {\r\n        c.parentNode.insertBefore(h, c.nextSibling)\r\n    } else {\r\n        if (_isKHTML) {\r\n            this.obj.appendChild(h)\r\n        } else {\r\n            this.obj.rows[0].parentNode.appendChild(h)\r\n        }\r\n    }\r\n    this.callEvent(\"onAddFiller\", [m, a, h, c, g]);\r\n    return [m, a, h]\r\n}\r\n;\r\ndhtmlXGridObject.prototype._update_srnd_view = function() {\r\n    var l = Math.floor(this.objBox.scrollTop / this._srdh);\r\n    var c = l + this._get_view_size();\r\n    if (this.multiLine) {\r\n        var m = this.objBox.scrollTop;\r\n        l = 0;\r\n        while (m > 0) {\r\n            m -= this.rowsCol[l] ? this.rowsCol[l].offsetHeight : this._srdh;\r\n            l++\r\n        }\r\n        c = l + this._get_view_size();\r\n        if (l > 0) {\r\n            l--\r\n        }\r\n    }\r\n    c += (this._srnd_pr || 0);\r\n    if (c > this.rowsBuffer.length) {\r\n        c = this.rowsBuffer.length\r\n    }\r\n    for (var g = l; g < c; g++) {\r\n        if (!this.rowsCol[g]) {\r\n            var h = this._add_from_buffer(g);\r\n            if (h == -1) {\r\n                if (this.xmlFileUrl) {\r\n                    if (this._dpref && this.rowsBuffer[c - 1]) {\r\n                        var e = this._dpref ? this._dpref : (c - g);\r\n                        var a = Math.max(0, Math.min(g, c - this._dpref));\r\n                        this._current_load = [a, c - a]\r\n                    } else {\r\n                        this._current_load = [g, (this._dpref ? this._dpref : (c - g))]\r\n                    }\r\n                    if (this.callEvent(\"onDynXLS\", this._current_load)) {\r\n                        this.load(this.xmlFileUrl + dhtmlx.url(this.xmlFileUrl) + \"posStart=\" + this._current_load[0] + \"&count=\" + this._current_load[1], this._data_type)\r\n                    }\r\n                }\r\n                return\r\n            } else {\r\n                if (this._tgle) {\r\n                    this._updateLine(this._h2.get[this.rowsBuffer[g].idd], this.rowsBuffer[g]);\r\n                    this._updateParentLine(this._h2.get[this.rowsBuffer[g].idd], this.rowsBuffer[g])\r\n                }\r\n                if (g && g == (this._realfake ? this._fake : this)[\"_r_select\"]) {\r\n                    this.selectCell(g, this.cell ? this.cell._cellIndex : 0, true)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (this._fake && !this._realfake && this.multiLine) {\r\n        this._fake.objBox.scrollTop = this.objBox.scrollTop\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._add_from_buffer = function(g) {\r\n    var h = this.render_row(g);\r\n    if (h == -1) {\r\n        return -1\r\n    }\r\n    if (h._attrs.selected || h._attrs.select) {\r\n        this.selectRow(h, false, true);\r\n        h._attrs.selected = h._attrs.select = null \r\n    }\r\n    if (!this._cssSP) {\r\n        if (this._cssEven && g % 2 == 0) {\r\n            h.className = this._cssEven + ((h.className.indexOf(\"rowselected\") != -1) ? \" rowselected \" : \" \") + (h._css || \"\")\r\n        } else {\r\n            if (this._cssUnEven && g % 2 == 1) {\r\n                h.className = this._cssUnEven + ((h.className.indexOf(\"rowselected\") != -1) ? \" rowselected \" : \" \") + (h._css || \"\")\r\n            }\r\n        }\r\n    } else {\r\n        if (this._h2) {\r\n            var a = this._h2.get[h.idd];\r\n            h.className += \" \" + ((a.level % 2) ? (this._cssUnEven + \" \" + this._cssUnEven) : (this._cssEven + \" \" + this._cssEven)) + \"_\" + a.level + (this.rowsAr[a.id]._css || \"\")\r\n        }\r\n    }\r\n    for (var c = 0; c < this._fillers.length; c++) {\r\n        var e = this._fillers[c];\r\n        if (e && e[0] <= g && (e[0] + e[1]) > g) {\r\n            var l = g - e[0];\r\n            if (l == 0) {\r\n                this._insert_before(g, h, e[2]);\r\n                this._update_fillers(c, -1, 1)\r\n            } else {\r\n                if (l == e[1] - 1) {\r\n                    this._insert_after(g, h, e[2]);\r\n                    this._update_fillers(c, -1, 0)\r\n                } else {\r\n                    this._fillers.push(this._add_filler(g + 1, e[1] - l - 1, e[2], 1));\r\n                    this._insert_after(g, h, e[2]);\r\n                    this._update_fillers(c, -e[1] + l, 0)\r\n                }\r\n            }\r\n            return\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._update_fillers = function(e, a, g) {\r\n    var c = this._fillers[e];\r\n    c[1] = c[1] + a;\r\n    c[0] = c[0] + g;\r\n    if (!c[1]) {\r\n        this.callEvent(\"onRemoveFiller\", [c[2]]);\r\n        c[2].parentNode.removeChild(c[2]);\r\n        this._fillers.splice(e, 1)\r\n    } else {\r\n        c[2].firstChild.style.height = parseFloat(c[2].firstChild.style.height) + a * this._srdh + \"px\";\r\n        this.callEvent(\"onUpdateFiller\", [c[2]])\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._insert_before = function(c, e, a) {\r\n    a.parentNode.insertBefore(e, a);\r\n    this.rowsCol[c] = e;\r\n    this.callEvent(\"onRowInserted\", [e, null , a, \"before\"])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._insert_after = function(c, e, a) {\r\n    if (a.nextSibling) {\r\n        a.parentNode.insertBefore(e, a.nextSibling)\r\n    } else {\r\n        a.parentNode.appendChild(e)\r\n    }\r\n    this.rowsCol[c] = e;\r\n    this.callEvent(\"onRowInserted\", [e, null , a, \"after\"])\r\n}\r\n;\r\nif (typeof (window.dhtmlxValidation) != \"undefined\") {\r\n    dhtmlxValidation.trackInput = function(e, g, c, a) {\r\n        dhtmlxEvent(e, \"keyup\", function(h) {\r\n            if (dhtmlxValidation._timer) {\r\n                window.clearTimeout(dhtmlxValidation._timer);\r\n                dhtmlxValidation._timer = null \r\n            }\r\n            dhtmlxValidation._timer = window.setTimeout(function() {\r\n                if (!dhtmlxValidation.checkInput(e, g)) {\r\n                    if (!c || c(e, e.value, g)) {\r\n                        e.className += \" dhtmlx_live_validation_error\"\r\n                    }\r\n                } else {\r\n                    e.className = e.className.replace(/[ ]*dhtmlx_live_validation_error/g, \"\");\r\n                    if (a) {\r\n                        a(e, e.value, g)\r\n                    }\r\n                }\r\n            }, 250)\r\n        })\r\n    }\r\n    ;\r\n    dhtmlxValidation.checkInput = function(a, c) {\r\n        return dhtmlxValidation.checkValue(a.value, c)\r\n    }\r\n    ;\r\n    dhtmlxValidation.checkValue = function(e, g) {\r\n        if (typeof g == \"string\") {\r\n            g = g.split(\",\")\r\n        }\r\n        var a = true;\r\n        for (var c = 0; c < g.length; c++) {\r\n            if (!this[\"is\" + g[c]]) {\r\n                alert(\"Incorrect validation rule: \" + g[c])\r\n            } else {\r\n                a = a && this[\"is\" + g[c]](e)\r\n            }\r\n        }\r\n        return a\r\n    }\r\n}\r\ndhtmlXGridObject.prototype.enableValidation = function(c, a) {\r\n    c = dhx4.s2b(c);\r\n    if (c) {\r\n        this._validators = {\r\n            data: []\r\n        }\r\n    } else {\r\n        this._validators = false\r\n    }\r\n    if (arguments.length > 1) {\r\n        this._validators._live = a\r\n    }\r\n    if (!this._validators._event) {\r\n        this._validators._event = this.attachEvent(\"onEditCell\", this.validationEvent)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setColValidators = function(a) {\r\n    if (!this._validators) {\r\n        this.enableValidation(true)\r\n    }\r\n    if (typeof a == \"string\") {\r\n        a = a.split(this.delim)\r\n    }\r\n    this._validators.data = a\r\n}\r\n;\r\ndhtmlXGridObject.prototype.validationEvent = function(l, c, g, e, n) {\r\n    var o = this._validators;\r\n    if (!o) {\r\n        return true\r\n    }\r\n    var m = (o.data[g] || this.cells(c, g).getAttribute(\"validate\")) || \"\";\r\n    if (l == 1 && m) {\r\n        var h = this.editor || (this._fake || {}).editor;\r\n        if (!h) {\r\n            return true\r\n        }\r\n        h.cell.className = h.cell.className.replace(/[ ]*dhtmlx_validation_error/g, \"\");\r\n        if (o._live) {\r\n            var a = this;\r\n            dhtmlxValidation.trackInput(h.getInput(), m, function(r, s, u) {\r\n                return a.callEvent(\"onLiveValidationError\", [c, g, s, r, u])\r\n            }, function(r, s, u) {\r\n                return a.callEvent(\"onLiveValidationCorrect\", [c, g, s, r, u])\r\n            })\r\n        }\r\n    }\r\n    if (l == 2) {\r\n        this.validateCell(c, g, m, e)\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype.validateCell = function(m, h, l, g) {\r\n    l = l || (this._validators.data[h] || this.cells(m, h).getAttribute(\"validate\"));\r\n    g = g || this.cells(m, h).getValue();\r\n    if (!l) {\r\n        return\r\n    }\r\n    var c = this.cells(m, h).cell;\r\n    var a = true;\r\n    if (typeof l == \"string\") {\r\n        l = l.split(this.delim)\r\n    }\r\n    for (var e = 0; e < l.length; e++) {\r\n        if (!dhtmlxValidation.checkValue(g, l[e])) {\r\n            if (this.callEvent(\"onValidationError\", [m, h, g, l[e]])) {\r\n                c.className += \" dhtmlx_validation_error\"\r\n            }\r\n            a = false\r\n        }\r\n    }\r\n    if (a) {\r\n        this.callEvent(\"onValidationCorrect\", [m, h, g, l]);\r\n        c.className = c.className.replace(/[ ]*dhtmlx_validation_error/g, \"\")\r\n    }\r\n    return a\r\n}\r\n;\r\nfunction eXcell_stree(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        if (!this.grid._sub_trees) {\r\n            return\r\n        }\r\n        this._sub = this.grid._sub_trees[a._cellIndex];\r\n        if (!this._sub) {\r\n            return\r\n        }\r\n        this._sub = this._sub[0]\r\n    }\r\n    this.getValue = function() {\r\n        return this.cell._val\r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        this.cell._val = c;\r\n        c = this._sub.getItemText(this.cell._val);\r\n        this.setCValue((c || \"&nbsp;\"), c)\r\n    }\r\n    ;\r\n    this.edit = function() {\r\n        this._sub.parentObject.style.display = \"block\";\r\n        var e = this.grid.getPosition(this.cell);\r\n        this._sub.parentObject.style.top = e[1] + \"px\";\r\n        this._sub.parentObject.style.left = e[0] + \"px\";\r\n        this._sub.parentObject.style.position = \"absolute\";\r\n        var c = this.grid.editStop;\r\n        this.grid.editStop = function() {}\r\n        ;\r\n        this.grid.editStop = c\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        this._sub.parentObject.style.display = \"none\";\r\n        if (this.grid._sub_id != null ) {\r\n            var c = this.cell._val;\r\n            this.setValue(this._sub.getSelectedItemId());\r\n            this.grid._sub_id = null ;\r\n            return this.cell._val != c\r\n        }\r\n    }\r\n}\r\neXcell_stree.prototype = new eXcell;\r\ndhtmlXGridObject.prototype.setSubTree = function(a, c) {\r\n    if (!this._sub_trees) {\r\n        this._sub_trees = []\r\n    }\r\n    this._sub_trees[c] = [a];\r\n    a.parentObject.style.display = \"none\";\r\n    var e = this;\r\n    a.parentObject.onclick = function(g) {\r\n        (g || window.event).cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    a.ev_onDblClick = null ;\r\n    a.attachEvent(\"onDblClick\", function(g) {\r\n        e._sub_id = g;\r\n        e.editStop();\r\n        return true\r\n    });\r\n    a._chRRS = true\r\n}\r\n;\r\nfunction eXcell_link(a) {\r\n    this.cell = a;\r\n    this.grid = this.cell.parentNode.grid;\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.edit = function() {}\r\n    ;\r\n    this.getValue = function() {\r\n        if (this.cell.firstChild.getAttribute) {\r\n            var c = this.cell.firstChild.getAttribute(\"target\");\r\n            return this.cell.firstChild.innerHTML + \"^\" + this.cell.firstChild.getAttribute(\"href\") + (c ? (\"^\" + c) : \"\")\r\n        } else {\r\n            return \"\"\r\n        }\r\n    }\r\n    ;\r\n    this.setValue = function(e) {\r\n        if ((typeof (e) != \"number\") && (!e || e.toString()._dhx_trim() == \"\")) {\r\n            this.setCValue(\"&nbsp;\", c);\r\n            return ( this.cell._clearCell = true) \r\n        }\r\n        var c = e.split(\"^\");\r\n        if (c.length == 1) {\r\n            c[1] = \"\"\r\n        } else {\r\n            if (c.length > 1) {\r\n                c[1] = \"href='\" + c[1] + \"'\";\r\n                if (c.length == 3) {\r\n                    c[1] += \" target='\" + c[2] + \"'\"\r\n                } else {\r\n                    c[1] += \" target='_blank'\"\r\n                }\r\n            }\r\n        }\r\n        this.setCValue(\"<a \" + c[1] + \" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>\" + c[0] + \"</a>\", c)\r\n    }\r\n}\r\neXcell_link.prototype = new eXcell;\r\neXcell_link.prototype.getTitle = function() {\r\n    var a = this.cell.firstChild;\r\n    return ( (a && a.tagName) ? a.getAttribute(\"href\") : \"\") \r\n}\r\n;\r\neXcell_link.prototype.getContent = function() {\r\n    var a = this.cell.firstChild;\r\n    return ( (a && a.tagName) ? a.innerHTML : \"\") \r\n}\r\n;\r\nfunction eXcell_grid(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        if (!this.grid._sub_grids) {\r\n            return\r\n        }\r\n        this._sub = this.grid._sub_grids[a._cellIndex];\r\n        if (!this._sub) {\r\n            return\r\n        }\r\n        this._sindex = this._sub[1];\r\n        this._sub = this._sub[0]\r\n    }\r\n    this.getValue = function() {\r\n        return this.cell.val\r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        this.cell.val = c;\r\n        if (this._sub.getRowById(c)) {\r\n            c = this._sub.cells(c, this._sindex);\r\n            if (c) {\r\n                c = c.getValue()\r\n            } else {\r\n                c = \"\"\r\n            }\r\n        }\r\n        this.setCValue((c || \"&nbsp;\"), c)\r\n    }\r\n    ;\r\n    this.edit = function() {\r\n        this.val = this.cell.val;\r\n        this._sub.entBox.style.display = \"block\";\r\n        var e = this.grid.getPosition(this.cell);\r\n        this._sub.entBox.style.top = e[1] + \"px\";\r\n        this._sub.entBox.style.left = e[0] + \"px\";\r\n        this._sub.entBox.style.position = \"absolute\";\r\n        this._sub.setSizes();\r\n        var c = this.grid.editStop;\r\n        this.grid.editStop = function() {}\r\n        ;\r\n        if (this._sub.getRowById(this.cell.val)) {\r\n            this._sub.setSelectedRow(this.cell.val)\r\n        }\r\n        this._sub.setActive(true);\r\n        this.grid.editStop = c\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        var c = this.cell.val;\r\n        this._sub.entBox.style.display = \"none\";\r\n        if (this._sub.getSelectedId() === null ) {\r\n            return false\r\n        }\r\n        this.setValue(this._sub.getSelectedId());\r\n        this.grid.setActive(true);\r\n        return this.cell.val != c\r\n    }\r\n}\r\neXcell_grid.prototype = new eXcell;\r\ndhtmlXGridObject.prototype.setSubGrid = function(c, a, g) {\r\n    if (!this._sub_grids) {\r\n        this._sub_grids = []\r\n    }\r\n    this._sub_grids[a] = [c, g];\r\n    c.entBox.style.display = \"none\";\r\n    var e = this;\r\n    c.entBox.onclick = function(h) {\r\n        (h || window.event).cancelBubble = true;\r\n        return false\r\n    }\r\n    ;\r\n    c.attachEvent(\"onRowSelect\", function(h) {\r\n        e.editStop();\r\n        return true\r\n    });\r\n    c._chRRS = false\r\n}\r\n;\r\nfunction eXcell_dhxCalendar(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        if (!this.grid._grid_calendarA) {\r\n            var e = this.grid._grid_calendarA = new dhtmlxCalendarObject();\r\n            this.grid.callEvent(\"onDhxCalendarCreated\", [e]);\r\n            var c = this.grid;\r\n            e.attachEvent(\"onClick\", function() {\r\n                this._last_operation_calendar = true;\r\n                window.setTimeout(function() {\r\n                    c.editStop()\r\n                }, 1);\r\n                return true\r\n            });\r\n            var g = function(h) {\r\n                (h || event).cancelBubble = true\r\n            }\r\n            ;\r\n            dhtmlxEvent(e.base, \"click\", g);\r\n            e = null \r\n        }\r\n    }\r\n}\r\neXcell_dhxCalendar.prototype = new eXcell;\r\neXcell_dhxCalendar.prototype.edit = function() {\r\n    var c = this.grid.getPosition(this.cell);\r\n    this.grid._grid_calendarA._show(false, false);\r\n    this.grid._grid_calendarA.setPosition(c[0], c[1] + this.cell.offsetHeight);\r\n    this.grid._grid_calendarA._last_operation_calendar = false;\r\n    this.grid.callEvent(\"onCalendarShow\", [this.grid._grid_calendarA, this.cell.parentNode.idd, this.cell._cellIndex]);\r\n    this.cell._cediton = true;\r\n    this.val = this.cell.val;\r\n    this._val = this.cell.innerHTML;\r\n    var a = this.grid._grid_calendarA.draw;\r\n    this.grid._grid_calendarA.draw = function() {}\r\n    ;\r\n    this.grid._grid_calendarA.setDateFormat((this.grid._dtmask || \"%d/%m/%Y\"));\r\n    this.grid._grid_calendarA.setDate(this.val || (new Date()));\r\n    this.grid._grid_calendarA.draw = a\r\n}\r\n;\r\neXcell_dhxCalendar.prototype.getDate = function() {\r\n    if (this.cell.val) {\r\n        return this.cell.val\r\n    }\r\n    return null \r\n}\r\n;\r\neXcell_dhxCalendar.prototype.getValue = function() {\r\n    if (this.cell._clearCell) {\r\n        return \"\"\r\n    }\r\n    if (this.grid._dtmask_inc && this.cell.val) {\r\n        return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc, this.cell.val).toString()\r\n    }\r\n    return this.cell.innerHTML.toString()._dhx_trim()\r\n}\r\n;\r\neXcell_dhxCalendar.prototype.detach = function() {\r\n    if (!this.grid._grid_calendarA) {\r\n        return\r\n    }\r\n    this.grid._grid_calendarA.hide();\r\n    if (this.cell._cediton) {\r\n        this.cell._cediton = false\r\n    } else {\r\n        return\r\n    }\r\n    if (this.grid._grid_calendarA._last_operation_calendar) {\r\n        var e = this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || \"%d/%m/%Y\"));\r\n        var c = this.grid._grid_calendarA.getDate();\r\n        this.cell.val = new Date(c);\r\n        this.setCValue(e, c);\r\n        this.cell._clearCell = !e;\r\n        var a = this.val;\r\n        this.val = this._val;\r\n        return ( this.cell.val.valueOf() != (a || \"\").valueOf()) \r\n    }\r\n    return false\r\n}\r\n;\r\neXcell_dhxCalendar.prototype.setValue = function(a) {\r\n    if (a && typeof a == \"object\") {\r\n        this.cell.val = a;\r\n        this.cell._clearCell = false;\r\n        this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || \"%d/%m/%Y\"), a).toString(), this.cell.val);\r\n        return\r\n    }\r\n    if (!a || a.toString()._dhx_trim() == \"\") {\r\n        a = \"&nbsp\";\r\n        this.cell._clearCell = true;\r\n        this.cell.val = \"\"\r\n    } else {\r\n        this.cell._clearCell = false;\r\n        this.cell.val = new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc || this.grid._dtmask || \"%d/%m/%Y\"), a.toString(), null , true));\r\n        if (this.grid._dtmask_inc) {\r\n            a = this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || \"%d/%m/%Y\"), this.cell.val)\r\n        }\r\n    }\r\n    if ((this.cell.val == \"NaN\") || (this.cell.val == \"Invalid Date\")) {\r\n        this.cell._clearCell = true;\r\n        this.cell.val = new Date();\r\n        this.setCValue(\"&nbsp;\", 0)\r\n    } else {\r\n        this.setCValue((a || \"\").toString(), this.cell.val)\r\n    }\r\n}\r\n;\r\nfunction eXcell_dhxCalendarA(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        if (!this.grid._grid_calendarA) {\r\n            var e = this.grid._grid_calendarA = new dhtmlxCalendarObject();\r\n            this.grid.callEvent(\"onDhxCalendarCreated\", [e]);\r\n            var c = this.grid;\r\n            e.attachEvent(\"onClick\", function() {\r\n                this._last_operation_calendar = true;\r\n                window.setTimeout(function() {\r\n                    c.editStop()\r\n                }, 1);\r\n                return true\r\n            });\r\n            var g = function(h) {\r\n                (h || event).cancelBubble = true\r\n            }\r\n            ;\r\n            dhtmlxEvent(e.base, \"click\", g)\r\n        }\r\n    }\r\n}\r\neXcell_dhxCalendarA.prototype = new eXcell;\r\neXcell_dhxCalendarA.prototype.edit = function() {\r\n    var c = this.grid.getPosition(this.cell);\r\n    this.grid._grid_calendarA._show(false, false);\r\n    this.grid._grid_calendarA.setPosition(c[0] * 1 + this.cell.offsetWidth, c[1] * 1);\r\n    this.grid.callEvent(\"onCalendarShow\", [this.grid._grid_calendarA, this.cell.parentNode.idd, this.cell._cellIndex]);\r\n    this.grid._grid_calendarA._last_operation_calendar = false;\r\n    this.cell._cediton = true;\r\n    this.val = this.cell.val;\r\n    this._val = this.cell.innerHTML;\r\n    var a = this.grid._grid_calendarA.draw;\r\n    this.grid._grid_calendarA.draw = function() {}\r\n    ;\r\n    this.grid._grid_calendarA.setDateFormat((this.grid._dtmask || \"%d/%m/%Y\"));\r\n    this.grid._grid_calendarA.setDate(this.val);\r\n    this.grid._grid_calendarA.draw = a;\r\n    this.cell.atag = ((!this.grid.multiLine) && (_isKHTML || _isMacOS || _isFF)) ? \"INPUT\" : \"TEXTAREA\";\r\n    this.obj = document.createElement(this.cell.atag);\r\n    this.obj.style.height = (this.cell.offsetHeight - 4) + \"px\";\r\n    this.obj.className = \"dhx_combo_edit\";\r\n    this.obj.wrap = \"soft\";\r\n    this.obj.style.textAlign = this.cell.align;\r\n    this.obj.onclick = function(g) {\r\n        (g || event).cancelBubble = true\r\n    }\r\n    ;\r\n    this.obj.onmousedown = function(g) {\r\n        (g || event).cancelBubble = true\r\n    }\r\n    ;\r\n    this.obj.value = this.getValue();\r\n    this.cell.innerHTML = \"\";\r\n    this.cell.appendChild(this.obj);\r\n    if (window.dhx4.isIE) {\r\n        this.obj.style.overflow = \"visible\";\r\n        if ((this.grid.multiLine) && (this.obj.offsetHeight >= 18) && (this.obj.offsetHeight < 40)) {\r\n            this.obj.style.height = \"36px\";\r\n            this.obj.style.overflow = \"scroll\"\r\n        }\r\n    }\r\n    this.obj.onselectstart = function(g) {\r\n        if (!g) {\r\n            g = event\r\n        }\r\n        g.cancelBubble = true;\r\n        return true\r\n    }\r\n    ;\r\n    this.obj.focus();\r\n    this.obj.focus()\r\n}\r\n;\r\neXcell_dhxCalendarA.prototype.getDate = function() {\r\n    if (this.cell.val) {\r\n        return this.cell.val\r\n    }\r\n    return null \r\n}\r\n;\r\neXcell_dhxCalendarA.prototype.getValue = function() {\r\n    if (this.cell._clearCell) {\r\n        return \"\"\r\n    }\r\n    if (this.grid._dtmask_inc && this.cell.val) {\r\n        return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc, this.cell.val).toString()\r\n    }\r\n    return this.cell.innerHTML.toString()._dhx_trim()\r\n}\r\n;\r\neXcell_dhxCalendarA.prototype.detach = function() {\r\n    if (!this.grid._grid_calendarA) {\r\n        return\r\n    }\r\n    this.grid._grid_calendarA.hide();\r\n    if (this.cell._cediton) {\r\n        this.cell._cediton = false\r\n    } else {\r\n        return\r\n    }\r\n    if (this.grid._grid_calendarA._last_operation_calendar) {\r\n        this.grid._grid_calendarA._last_operation_calendar = false;\r\n        var e = this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask || \"%d/%m/%Y\");\r\n        var c = this.grid._grid_calendarA.getDate();\r\n        this.cell.val = new Date(c);\r\n        this.setCValue(e, c);\r\n        this.cell._clearCell = !e;\r\n        var a = this.val;\r\n        this.val = this._val;\r\n        return ( this.cell.val.valueOf() != (a || \"\").valueOf()) \r\n    }\r\n    this.setValue(this.obj.value);\r\n    var a = this.val;\r\n    this.val = this._val;\r\n    return ( this.cell.val.valueOf() != (a || \"\").valueOf()) \r\n}\r\n;\r\neXcell_dhxCalendarA.prototype.setValue = function(a) {\r\n    if (a && typeof a == \"object\") {\r\n        this.cell.val = a;\r\n        this.cell._clearCell = false;\r\n        this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || \"%d/%m/%Y\"), a).toString(), this.cell.val);\r\n        return\r\n    }\r\n    if (!a || a.toString()._dhx_trim() == \"\") {\r\n        a = \"&nbsp\";\r\n        this.cell._clearCell = true;\r\n        this.cell.val = \"\"\r\n    } else {\r\n        this.cell._clearCell = false;\r\n        this.cell.val = new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc || this.grid._dtmask || \"%d/%m/%Y\"), a.toString(), null , true));\r\n        if (this.grid._dtmask_inc) {\r\n            a = this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || \"%d/%m/%Y\"), this.cell.val)\r\n        }\r\n    }\r\n    if ((this.cell.val == \"NaN\") || (this.cell.val == \"Invalid Date\")) {\r\n        this.cell.val = new Date();\r\n        this.cell._clearCell = true;\r\n        this.setCValue(\"&nbsp;\", 0)\r\n    } else {\r\n        this.setCValue((a || \"\").toString(), this.cell.val)\r\n    }\r\n}\r\n;\r\nfunction eXcell_cntr(a) {\r\n    this.cell = a;\r\n    this.grid = this.cell.parentNode.grid;\r\n    if (!this.grid._ex_cntr_ready && !this._realfake) {\r\n        this.grid._ex_cntr_ready = true;\r\n        if (this.grid._h2) {\r\n            this.grid.attachEvent(\"onOpenEn\", function(e) {\r\n                this.resetCounter(a._cellIndex)\r\n            })\r\n        }\r\n        var c = function() {\r\n            var e = this;\r\n            window.setTimeout(function() {\r\n                if (!e.resetCounter) {\r\n                    return\r\n                }\r\n                if (e._fake && !e._realfake && a._cellIndex < e._fake._cCount) {\r\n                    e._fake.resetCounter(a._cellIndex)\r\n                } else {\r\n                    e.resetCounter(a._cellIndex)\r\n                }\r\n            }, 1);\r\n            return true\r\n        }\r\n        ;\r\n        this.grid.attachEvent(\"onBeforeSorting\", c);\r\n        this.grid.attachEvent(\"onFilterEnd\", c)\r\n    }\r\n    this.edit = function() {}\r\n    ;\r\n    this.getValue = function() {\r\n        return this.cell.innerHTML\r\n    }\r\n    ;\r\n    this.setValue = function(g) {\r\n        this.cell.style.paddingRight = \"2px\";\r\n        var e = this.cell;\r\n        window.setTimeout(function() {\r\n            if (!e.parentNode) {\r\n                return\r\n            }\r\n            var h = e.parentNode.rowIndex;\r\n            if (e.parentNode.grid.currentPage || h < 0 || e.parentNode.grid._srnd) {\r\n                h = e.parentNode.grid.rowsBuffer._dhx_find(e.parentNode) + 1\r\n            }\r\n            if (h <= 0) {\r\n                return\r\n            }\r\n            e.innerHTML = h;\r\n            if (e.parentNode.grid._fake && e._cellIndex < e.parentNode.grid._fake._cCount && e.parentNode.grid._fake.rowsAr[e.parentNode.idd]) {\r\n                e.parentNode.grid._fake.cells(e.parentNode.idd, e._cellIndex).setCValue(h)\r\n            }\r\n            e = null \r\n        }, 100)\r\n    }\r\n}\r\ndhtmlXGridObject.prototype.resetCounter = function(c) {\r\n    if (this._fake && !this._realfake && c < this._fake._cCount) {\r\n        this._fake.resetCounter(c, this.currentPage)\r\n    }\r\n    var a = arguments[0] || 0;\r\n    if (this.currentPage) {\r\n        a = (this.currentPage - 1) * this.rowsBufferOutSize\r\n    }\r\n    for (a = 0; a < this.rowsBuffer.length; a++) {\r\n        if (this.rowsBuffer[a] && this.rowsBuffer[a].tagName == \"TR\" && this.rowsAr[this.rowsBuffer[a].idd]) {\r\n            this.rowsAr[this.rowsBuffer[a].idd].childNodes[c].innerHTML = a + 1\r\n        }\r\n    }\r\n}\r\n;\r\neXcell_cntr.prototype = new eXcell;\r\nfunction eXcell_acheck(a) {\r\n    try {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        this.cell.obj = this\r\n    } catch (c) {}\r\n    this.changeState = function() {\r\n        if ((!this.grid.isEditable) || (this.cell.parentNode._locked) || (this.isDisabled())) {\r\n            return\r\n        }\r\n        if (this.grid.callEvent(\"onEditCell\", [0, this.cell.parentNode.idd, this.cell._cellIndex]) != false) {\r\n            this.val = this.getValue();\r\n            if (this.val == \"1\") {\r\n                this.setValue(\"<checkbox state='false'>\")\r\n            } else {\r\n                this.setValue(\"<checkbox state='true'>\")\r\n            }\r\n            this.cell.wasChanged = true;\r\n            this.grid.callEvent(\"onEditCell\", [1, this.cell.parentNode.idd, this.cell._cellIndex]);\r\n            this.grid.callEvent(\"onCheck\", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != \"1\")]);\r\n            this.grid.callEvent(\"onCheckbox\", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != \"1\")])\r\n        } else {\r\n            this.editor = null \r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        try {\r\n            return this.cell.chstate.toString()\r\n        } catch (e) {\r\n            return null \r\n        }\r\n    }\r\n    ;\r\n    this.isCheckbox = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.isChecked = function() {\r\n        if (this.getValue() == \"1\") {\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this.setChecked = function(e) {\r\n        this.setValue(e.toString())\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        return this.val != this.getValue()\r\n    }\r\n    ;\r\n    this.drawCurrentState = function() {\r\n        if (this.cell.chstate == 1) {\r\n            return \"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;'  style='cursor:pointer; font-weight:bold; text-align:center; '><span style='height:8px; width:8px; background:green; display:inline-block;'></span>&nbsp;Yes</div>\"\r\n        } else {\r\n            return \"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;' style='cursor:pointer;  text-align:center; '><span style='height:8px; width:8px; background:red; display:inline-block;'></span>&nbsp;No</div>\"\r\n        }\r\n    }\r\n}\r\neXcell_acheck.prototype = new eXcell;\r\neXcell_acheck.prototype.setValue = function(c) {\r\n    c = (c || \"\").toString();\r\n    if (c.indexOf(\"1\") != -1 || c.indexOf(\"true\") != -1) {\r\n        c = \"1\";\r\n        this.cell.chstate = \"1\"\r\n    } else {\r\n        c = \"0\";\r\n        this.cell.chstate = \"0\"\r\n    }\r\n    var a = this;\r\n    this.setCValue(this.drawCurrentState(), this.cell.chstate)\r\n}\r\n;\r\nfunction eXcell_context(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid;\r\n        if (!this.grid._sub_context) {\r\n            return\r\n        }\r\n        this._sub = this.grid._sub_context[a._cellIndex];\r\n        if (!this._sub) {\r\n            return\r\n        }\r\n        this._sindex = this._sub[1];\r\n        this._sub = this._sub[0]\r\n    }\r\n    this.getValue = function() {\r\n        return _isIE ? this.cell.innerText : this.cell.textContent\r\n    }\r\n    ;\r\n    this.setValue = function(e) {\r\n        this.cell._val = e;\r\n        var c = this._sub.itemPull[this._sub.idPrefix + this.cell._val];\r\n        e = c ? c.title : e;\r\n        this.setCValue((e || \"&nbsp;\"), e)\r\n    }\r\n    ;\r\n    this.edit = function() {\r\n        var e = this.grid.getPosition(this.cell);\r\n        this._sub.showContextMenu(e[0] + this.cell.offsetWidth, e[1]);\r\n        var c = this.grid.editStop;\r\n        this.grid.editStop = function() {}\r\n        ;\r\n        this.grid.editStop = c\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        if (this.grid._sub_id != null ) {\r\n            var c = this.cell._val;\r\n            this.setValue(this.grid._sub_id);\r\n            this.grid._sub_id = null ;\r\n            return this.cell._val != c\r\n        }\r\n        this._sub.hideContextMenu()\r\n    }\r\n}\r\neXcell_context.prototype = new eXcell;\r\ndhtmlXGridObject.prototype.setSubContext = function(a, c, g) {\r\n    var e = this;\r\n    a.attachEvent(\"onClick\", function(l, h) {\r\n        e._sub_id = l;\r\n        e.editStop();\r\n        a.hideContextMenu();\r\n        return true\r\n    });\r\n    if (!this._sub_context) {\r\n        this._sub_context = []\r\n    }\r\n    this._sub_context[c] = [a, g];\r\n    a.hideContextMenu()\r\n}\r\n;\r\nfunction dhtmlXGridFromTable(obj, init) {\r\n    if (typeof (obj) != \"object\") {\r\n        obj = document.getElementById(obj)\r\n    }\r\n    var w = document.createElement(\"DIV\");\r\n    w.setAttribute(\"width\", obj.getAttribute(\"gridWidth\") || (obj.offsetWidth ? (obj.offsetWidth + \"px\") : 0) || (window.getComputedStyle ? window.getComputedStyle(obj, null )[\"width\"] : (obj.currentStyle ? obj.currentStyle.width : 0)));\r\n    w.setAttribute(\"height\", obj.getAttribute(\"gridHeight\") || (obj.offsetHeight ? (obj.offsetHeight + \"px\") : 0) || (window.getComputedStyle ? window.getComputedStyle(obj, null )[\"height\"] : (obj.currentStyle ? obj.currentStyle.height : 0)));\r\n    w.className = obj.className;\r\n    obj.className = \"\";\r\n    if (obj.id) {\r\n        w.id = obj.id\r\n    }\r\n    var mr = obj;\r\n    var drag = obj.getAttribute(\"dragAndDrop\");\r\n    mr.parentNode.insertBefore(w, mr);\r\n    var f = mr.getAttribute(\"name\") || (\"name_\" + (new Date()).valueOf());\r\n    var windowf = new dhtmlXGridObject(w);\r\n    window[f] = windowf;\r\n    var acs = mr.getAttribute(\"onbeforeinit\");\r\n    var acs2 = mr.getAttribute(\"oninit\");\r\n    if (acs) {\r\n        eval(acs)\r\n    }\r\n    windowf.setImagePath(windowf.imgURL || (mr.getAttribute(\"imgpath\") || mr.getAttribute(\"image_path\") || \"\"));\r\n    var skin = mr.getAttribute(\"skin\");\r\n    if (skin) {\r\n        windowf.setSkin(skin)\r\n    }\r\n    if (init) {\r\n        init(windowf)\r\n    }\r\n    var hrow = mr.rows[0];\r\n    var za = \"\";\r\n    var zb = \"\";\r\n    var zc = \"\";\r\n    var zd = \"\";\r\n    var ze = \"\";\r\n    for (var i = 0; i < hrow.cells.length; i++) {\r\n        za += (za ? \",\" : \"\") + hrow.cells[i].innerHTML;\r\n        var width = hrow.cells[i].getAttribute(\"width\") || hrow.cells[i].offsetWidth || (window.getComputedStyle ? window.getComputedStyle(hrow.cells[i], null )[\"width\"] : (hrow.cells[i].currentStyle ? hrow.cells[i].currentStyle.width : 0));\r\n        zb += (zb ? \",\" : \"\") + (width == \"*\" ? width : parseInt(width));\r\n        zc += (zc ? \",\" : \"\") + (hrow.cells[i].getAttribute(\"align\") || \"left\");\r\n        zd += (zd ? \",\" : \"\") + (hrow.cells[i].getAttribute(\"type\") || \"ed\");\r\n        ze += (ze ? \",\" : \"\") + (hrow.cells[i].getAttribute(\"sort\") || \"str\");\r\n        var f_a = hrow.cells[i].getAttribute(\"format\");\r\n        if (f_a) {\r\n            if (hrow.cells[i].getAttribute(\"type\").toLowerCase().indexOf(\"calendar\") != -1) {\r\n                windowf._dtmask = f_a\r\n            } else {\r\n                windowf.setNumberFormat(f_a, i)\r\n            }\r\n        }\r\n    }\r\n    windowf.setHeader(za);\r\n    windowf.setInitWidths(zb);\r\n    windowf.setColAlign(zc);\r\n    windowf.setColTypes(zd);\r\n    windowf.setColSorting(ze);\r\n    if (obj.getAttribute(\"gridHeight\") == \"auto\") {\r\n        windowf.enableAutoHeigth(true)\r\n    }\r\n    if (obj.getAttribute(\"multiline\")) {\r\n        windowf.enableMultiline(true)\r\n    }\r\n    var lmn = mr.getAttribute(\"lightnavigation\");\r\n    if (lmn) {\r\n        windowf.enableLightMouseNavigation(lmn)\r\n    }\r\n    var evr = mr.getAttribute(\"evenrow\");\r\n    var uevr = mr.getAttribute(\"unevenrow\");\r\n    if (evr || uevr) {\r\n        windowf.enableAlterCss(evr, uevr)\r\n    }\r\n    if (drag) {\r\n        windowf.enableDragAndDrop(true)\r\n    }\r\n    windowf.init();\r\n    if (obj.getAttribute(\"split\")) {\r\n        windowf.splitAt(obj.getAttribute(\"split\"))\r\n    }\r\n    windowf._process_inner_html(mr, 1);\r\n    if (acs2) {\r\n        eval(acs2)\r\n    }\r\n    if (obj.parentNode && obj.parentNode.removeChild) {\r\n        obj.parentNode.removeChild(obj)\r\n    }\r\n    return windowf\r\n}\r\ndhtmlXGridObject.prototype._process_html = function(c) {\r\n    if (c.tagName && c.tagName == \"TABLE\") {\r\n        return this._process_inner_html(c, 0)\r\n    }\r\n    var a = document.createElement(\"DIV\");\r\n    a.innerHTML = c.xmlDoc.responseText;\r\n    var e = a.getElementsByTagName(\"TABLE\")[0];\r\n    this._process_inner_html(e, 0)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_inner_html = function(e, h) {\r\n    var c = e.rows.length;\r\n    for (var a = h; a < c; a++) {\r\n        var g = e.rows[a].getAttribute(\"id\") || a;\r\n        this.rowsBuffer.push({\r\n            idd: g,\r\n            data: e.rows[a],\r\n            _parser: this._process_html_row,\r\n            _locator: this._get_html_data\r\n        })\r\n    }\r\n    this.render_dataset();\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_html_row = function(n, h) {\r\n    var m = h.getElementsByTagName(\"TD\");\r\n    var c = [];\r\n    n._attrs = this._xml_attrs(h);\r\n    for (var g = 0; g < m.length; g++) {\r\n        var l = m[g];\r\n        var a = l.getAttribute(\"type\");\r\n        if (n.childNodes[g]) {\r\n            if (a) {\r\n                n.childNodes[g]._cellType = a\r\n            }\r\n            n.childNodes[g]._attrs = this._xml_attrs(m[g])\r\n        }\r\n        if (l.firstChild) {\r\n            c.push(l.innerHTML)\r\n        } else {\r\n            c.push(\"\")\r\n        }\r\n        if (l.colSpan > 1) {\r\n            n.childNodes[g]._attrs.colspan = l.colSpan;\r\n            for (var e = 1; e < l.colSpan; e++) {\r\n                c.push(\"\")\r\n            }\r\n        }\r\n    }\r\n    for (g < m.length; g < n.childNodes.length; g++) {\r\n        n.childNodes[g]._attrs = {}\r\n    }\r\n    this._fillRow(n, (this._c_order ? this._swapColumns(c) : c));\r\n    return n\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_html_data = function(c, a) {\r\n    c = c.firstChild;\r\n    while (true) {\r\n        if (!c) {\r\n            return \"\"\r\n        }\r\n        if (c.tagName == \"TD\") {\r\n            a--\r\n        }\r\n        if (a < 0) {\r\n            break\r\n        }\r\n        c = c.nextSibling\r\n    }\r\n    return ( c.firstChild ? c.firstChild.data : \"\") \r\n}\r\n;\r\ndhtmlxEvent(window, \"load\", function() {\r\n    var e = document.getElementsByTagName(\"table\");\r\n    for (var c = 0; c < e.length; c++) {\r\n        if (e[c].className == \"dhtmlxGrid\") {\r\n            dhtmlXGridFromTable(e[c])\r\n        }\r\n    }\r\n});\r\ndhtmlXGridObject.prototype._process_xmlA = function(a) {\r\n    this._parsing = true;\r\n    var l = dhx4.ajax.xmltop(this.xml.top, a);\r\n    this._parseHead(l);\r\n    var h = dhx4.ajax.xpath(this.xml.row, l);\r\n    var g = parseInt(l.getAttribute(\"pos\") || 0);\r\n    var e = parseInt(l.getAttribute(\"total_count\") || 0);\r\n    if (e && !this.rowsBuffer[e - 1]) {\r\n        this.rowsBuffer[e - 1] = null \r\n    }\r\n    if (this.isTreeGrid()) {\r\n        this._get_xml_data = this._get_xml_dataA;\r\n        this._process_xml_row = this._process_xml_rowA;\r\n        return this._process_tree_xml(a)\r\n    }\r\n    for (var c = 0; c < h.length; c++) {\r\n        if (this.rowsBuffer[c + g]) {\r\n            continue\r\n        }\r\n        var m = h[c].getAttribute(\"id\") || this.uid();\r\n        this.rowsBuffer[c + g] = {\r\n            idd: m,\r\n            data: h[c],\r\n            _parser: this._process_xml_rowA,\r\n            _locator: this._get_xml_dataA\r\n        };\r\n        this.rowsAr[m] = h[c]\r\n    }\r\n    this.render_dataset();\r\n    this._parsing = false\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_xmlB = function(a) {\r\n    this._parsing = true;\r\n    var l = dhx4.ajax.xmltop(this.xml.top, a);\r\n    this._parseHead(l);\r\n    var h = dhx4.ajax.xpath(this.xml.row, l);\r\n    var g = parseInt(l.getAttribute(\"pos\") || 0);\r\n    var e = parseInt(l.getAttribute(\"total_count\") || 0);\r\n    if (e && !this.rowsBuffer[e - 1]) {\r\n        this.rowsBuffer[e - 1] = null \r\n    }\r\n    if (this.isTreeGrid()) {\r\n        this._get_xml_data = this._get_xml_dataB;\r\n        this._process_xml_row = this._process_xml_rowB;\r\n        return this._process_tree_xml(a)\r\n    }\r\n    for (var c = 0; c < h.length; c++) {\r\n        if (this.rowsBuffer[c + g]) {\r\n            continue\r\n        }\r\n        var m = h[c].getAttribute(\"id\") || this.uid();\r\n        this.rowsBuffer[c + g] = {\r\n            idd: m,\r\n            data: h[c],\r\n            _parser: this._process_xml_rowB,\r\n            _locator: this._get_xml_dataB\r\n        };\r\n        this.rowsAr[m] = h[c]\r\n    }\r\n    this.render_dataset();\r\n    this._parsing = false\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_xml_rowA = function(h, e) {\r\n    var a = [];\r\n    h._attrs = this._xml_attrs(e);\r\n    for (var c = 0; c < this.columnIds.length; c++) {\r\n        var l = this.columnIds[c];\r\n        var g = h._attrs[l] || \"\";\r\n        if (h.childNodes[c]) {\r\n            h.childNodes[c]._attrs = {}\r\n        }\r\n        a.push(g)\r\n    }\r\n    this._fillRow(h, (this._c_order ? this._swapColumns(a) : a));\r\n    return h\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_xml_dataA = function(c, a) {\r\n    return c.getAttribute(this.getColumnId(a))\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_xml_rowB = function(a, h) {\r\n    var n = [];\r\n    a._attrs = this._xml_attrs(h);\r\n    if (this._ud_enabled) {\r\n        var o = dhx4.ajax.xpath(\"./userdata\", h);\r\n        for (var e = o.length - 1; e >= 0; e--) {\r\n            this.setUserData(o[e].getAttribute(\"name\"), o[e].firstChild ? o[e].firstChild.data : \"\")\r\n        }\r\n    }\r\n    for (var m = 0; m < h.childNodes.length; m++) {\r\n        var g = h.childNodes[m];\r\n        if (!g.tagName) {\r\n            continue\r\n        }\r\n        var c = this.getColIndexById(g.tagName);\r\n        if (isNaN(c)) {\r\n            continue\r\n        }\r\n        var l = g.getAttribute(\"type\");\r\n        if (l) {\r\n            a.childNodes[c]._cellType = l\r\n        }\r\n        a.childNodes[c]._attrs = this._xml_attrs(g);\r\n        if (g.getAttribute(\"xmlcontent\")) {} else {\r\n            if (g.firstChild) {\r\n                g = g.firstChild.data\r\n            } else {\r\n                g = \"\"\r\n            }\r\n        }\r\n        n[c] = g\r\n    }\r\n    for (var e = 0; e < a.childNodes.length; e++) {\r\n        if (!a.childNodes[e]._attrs) {\r\n            a.childNodes[e]._attrs = {}\r\n        }\r\n    }\r\n    this._fillRow(a, n);\r\n    return a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_xml_dataB = function(c, a) {\r\n    var e = this.getColumnId(a);\r\n    c = c.firstChild;\r\n    while (true) {\r\n        if (!c) {\r\n            return \"\"\r\n        }\r\n        if (c.tagName == e) {\r\n            return ( c.firstChild ? c.firstChild.data : \"\") \r\n        }\r\n        c = c.nextSibling\r\n    }\r\n    return \"\"\r\n}\r\n;\r\ndhtmlXGridObject.prototype.startFastOperations = function() {\r\n    this._disF = [\"setSizes\", \"callEvent\", \"_fixAlterCss\", \"cells4\", \"forEachRow\", \"_correctMonolite\"];\r\n    this._disA = [];\r\n    for (var a = this._disF.length - 1; a >= 0; a--) {\r\n        this._disA[a] = this[this._disF[a]];\r\n        this[this._disF[a]] = function() {\r\n            return true\r\n        }\r\n    }\r\n    this._cellCache = [];\r\n    this.cells4 = function(e) {\r\n        var g = this._cellCache[e._cellIndex];\r\n        if (!g) {\r\n            g = this._cellCache[e._cellIndex] = this._disA[3].apply(this, [e]);\r\n            g.destructor = function() {\r\n                return true\r\n            }\r\n            ;\r\n            g.setCValue = function(c) {\r\n                g.cell.innerHTML = c\r\n            }\r\n        }\r\n        g.cell = e;\r\n        g.combo = e._combo || this.combos[e._cellIndex];\r\n        return g\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.stopFastOperations = function() {\r\n    if (!this._disF) {\r\n        return\r\n    }\r\n    for (var a = this._disF.length - 1; a >= 0; a--) {\r\n        this[this._disF[a]] = this._disA[a]\r\n    }\r\n    if (this._correctMonolite) {\r\n        this._correctMonolite()\r\n    }\r\n    this.setSizes();\r\n    this.callEvent(\"onGridReconstructed\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_number_filter = function(e, c) {\r\n    this._in_header_text_filter.call(this, e, c);\r\n    var a = this;\r\n    e.firstChild._filter = function() {\r\n        var g = a._get_filters(this.value, \"num\");\r\n        return function(m) {\r\n            var h = g.length > 0 ? false : true;\r\n            for (var l = 0; l < g.length; l++) {\r\n                h = h || g[l](m)\r\n            }\r\n            return h\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_string_filter = function(e, c) {\r\n    this._in_header_text_filter.call(this, e, c);\r\n    var a = this;\r\n    e.firstChild._filter = function() {\r\n        var g = a._get_filters(this.value, \"str\");\r\n        return function(m) {\r\n            var h = g.length > 0 ? false : true;\r\n            for (var l = 0; l < g.length; l++) {\r\n                h = h || g[l](m)\r\n            }\r\n            return h\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_filters = function(l, e) {\r\n    var a = l.split(\",\");\r\n    var g = [];\r\n    for (var c = 0; c < a.length; c++) {\r\n        if (a[c] == \"\") {\r\n            continue\r\n        }\r\n        var h = this[\"_get_\" + e + \"_filter\"](a[c]);\r\n        g.push(h)\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_str_filter = function(c) {\r\n    if (c == \"null\" || c == \"empty\") {\r\n        return new Function(\"value\",'if (value == null || value == \"\") return true; return false;')\r\n    }\r\n    if (c == \"!null\" || c == \"!empty\") {\r\n        return new Function(\"value\",'if (value == null || value == \"\") return false; return true;')\r\n    }\r\n    if (c.substr(0, 1) === \"!\") {\r\n        var a = c.substr(1);\r\n        return new Function(\"value\",'if (value !== \"' + a + '\") return true; return false;')\r\n    }\r\n    if (c.substr(0, 1) === \"~\") {\r\n        var a = c.substr(1);\r\n        return new Function(\"value\",'if (value.indexOf(\"' + a + '\") !== -1) return true; return false;')\r\n    }\r\n    if (c.substr(0, 1) === \"^\" && c.substr(c.length - 1, 1) === \"&\") {\r\n        c = \"=\" + c.substr(1, c.length - 2)\r\n    }\r\n    if (c.substr(0, 1) === \"^\") {\r\n        var a = c.substr(1);\r\n        return new Function(\"value\",\"if (value.substr(0, \" + a.length + ') === \"' + a + '\") return true; return false;')\r\n    }\r\n    if (c.substr(c.length - 1, 1) === \"&\") {\r\n        var a = c.substr(0, c.length - 1);\r\n        return new Function(\"value\",\"if (value.substr(value.length - \" + a.length + ') === \"' + a + '\") return true; return false;')\r\n    }\r\n    if (c.substr(0, 1) === \"=\") {\r\n        var a = c.substr(1)\r\n    } else {\r\n        var a = c\r\n    }\r\n    return new Function(\"value\",'if (value === \"' + a + '\") return true; return false;')\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_num_filter = function(h) {\r\n    if (h == \"null\" || h == \"empty\") {\r\n        return new Function(\"value\",'if (value == null || value == \"\") return true; return false;')\r\n    }\r\n    if (h == \"!null\" || h == \"!empty\") {\r\n        return new Function(\"value\",'if (value == null || value == \"\") return false; return true;')\r\n    }\r\n    var a = h.split(\"..\");\r\n    if (a.length == 2) {\r\n        var l = parseFloat(a[0]);\r\n        var g = parseFloat(a[1]);\r\n        return new Function(\"value\",\"if (value >= \" + l + \" && value <= \" + g + \") return true; return false;\")\r\n    }\r\n    var e = h.match(/<>|>=|<=|>|<|=/);\r\n    if (e) {\r\n        var m = e[0];\r\n        var c = parseFloat(h.replace(m, \"\"))\r\n    } else {\r\n        var m = \"==\";\r\n        c = parseFloat(h)\r\n    }\r\n    if (m == \"<>\") {\r\n        m = \"!=\"\r\n    }\r\n    if (m == \"=\") {\r\n        m = \"==\"\r\n    }\r\n    return new Function(\"value\",\" if (value \" + m + \" \" + c + \" ) return true; return false;\")\r\n}\r\n;\r\ndhtmlXGridObject.prototype.attachHeaderA = dhtmlXGridObject.prototype.attachHeader;\r\ndhtmlXGridObject.prototype.attachHeader = function() {\r\n    this.attachHeaderA.apply(this, arguments);\r\n    if (this._realfake) {\r\n        return true\r\n    }\r\n    this.formAutoSubmit();\r\n    if (typeof (this.FormSubmitOnlyChanged) == \"undefined\") {\r\n        this.submitOnlyChanged(true)\r\n    }\r\n    if (typeof (this._submitAR) == \"undefined\") {\r\n        this.submitAddedRows(true)\r\n    }\r\n    var a = this;\r\n    this._added_rows = [];\r\n    this._deleted_rows = [];\r\n    this.attachEvent(\"onRowAdded\", function(c) {\r\n        a._added_rows.push(c);\r\n        a.forEachCell(c, function(e) {\r\n            e.cell.wasChanged = true\r\n        });\r\n        return true\r\n    });\r\n    this.attachEvent(\"onBeforeRowDeleted\", function(c) {\r\n        a._deleted_rows.push(c);\r\n        return true\r\n    });\r\n    this.attachHeader = this.attachHeaderA\r\n}\r\n;\r\ndhtmlXGridObject.prototype.formAutoSubmit = function() {\r\n    this.parentForm = this.detectParentFormPresent();\r\n    if (this.parentForm === false) {\r\n        return false\r\n    }\r\n    if (this.formEventAttached) {\r\n        return\r\n    }\r\n    this.formInputs = new Array();\r\n    var a = this;\r\n    dhtmlxEvent(this.parentForm, \"submit\", function() {\r\n        if (a.entBox) {\r\n            a.parentFormOnSubmit()\r\n        }\r\n    });\r\n    this.formEventAttached = true\r\n}\r\n;\r\ndhtmlXGridObject.prototype.parentFormOnSubmit = function() {\r\n    this.formCreateInputCollection();\r\n    if (!this.callEvent(\"onBeforeFormSubmit\", [])) {\r\n        return false\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.submitOnlyChanged = function(a) {\r\n    this.FormSubmitOnlyChanged = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.submitColumns = function(a) {\r\n    if (typeof a == \"string\") {\r\n        a = a.split(this.delim)\r\n    }\r\n    this._submit_cols = a\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setFieldName = function(a) {\r\n    a = a.replace(/\\{GRID_ID\\}/g, \"'+a1+'\");\r\n    a = a.replace(/\\{ROW_ID\\}/g, \"'+a2+'\");\r\n    a = a.replace(/\\{ROW_INDEX\\}/g, \"'+this.getRowIndex(a2)+'\");\r\n    a = a.replace(/\\{COLUMN_INDEX\\}/g, \"'+a3+'\");\r\n    a = a.replace(/\\{COLUMN_ID\\}/g, \"'+this.getColumnId(a3)+'\");\r\n    this._input_mask = Function(\"a1\", \"a2\", \"a3\", \"return '\" + a + \"';\")\r\n}\r\n;\r\ndhtmlXGridObject.prototype.submitSerialization = function(a) {\r\n    this.FormSubmitSerialization = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.submitAddedRows = function(a) {\r\n    this._submitAR = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.submitOnlySelected = function(a) {\r\n    this.FormSubmitOnlySelected = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.submitOnlyRowID = function(a) {\r\n    this.FormSubmitOnlyRowID = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.createFormInput = function(c, e) {\r\n    var a = document.createElement(\"input\");\r\n    a.type = \"hidden\";\r\n    if (this._input_mask && (typeof c != \"string\")) {\r\n        a.name = this._input_mask.apply(this, c)\r\n    } else {\r\n        a.name = ((this.globalBox || this.entBox).id || \"dhtmlXGrid\") + \"_\" + c\r\n    }\r\n    a.value = e;\r\n    this.parentForm.appendChild(a);\r\n    this.formInputs.push(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.createFormInputRow = function(e) {\r\n    var g = (this.globalBox || this.entBox).id;\r\n    for (var c = 0; c < this._cCount; c++) {\r\n        var a = this.cells3(e, c);\r\n        if (((!this.FormSubmitOnlyChanged) || a.wasChanged()) && (!this._submit_cols || this._submit_cols[c])) {\r\n            this.createFormInput(this._input_mask ? [g, e.idd, c] : (e.idd + \"_\" + c), a.getValue())\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.formCreateInputCollection = function() {\r\n    if (this.parentForm == false) {\r\n        return false\r\n    }\r\n    for (var a = 0; a < this.formInputs.length; a++) {\r\n        this.parentForm.removeChild(this.formInputs[a])\r\n    }\r\n    this.formInputs = new Array();\r\n    if (this.FormSubmitSerialization) {\r\n        this.createFormInput(\"serialized\", this.serialize())\r\n    } else {\r\n        if (this.FormSubmitOnlySelected) {\r\n            if (this.FormSubmitOnlyRowID) {\r\n                this.createFormInput(\"selected\", this.getSelectedId())\r\n            } else {\r\n                for (var a = 0; a < this.selectedRows.length; a++) {\r\n                    this.createFormInputRow(this.selectedRows[a])\r\n                }\r\n            }\r\n        } else {\r\n            if (this._submitAR) {\r\n                if (this._added_rows.length) {\r\n                    this.createFormInput(\"rowsadded\", this._added_rows.join(\",\"))\r\n                }\r\n                if (this._deleted_rows.length) {\r\n                    this.createFormInput(\"rowsdeleted\", this._deleted_rows.join(\",\"))\r\n                }\r\n            }\r\n            this.forEachRow(function(c) {\r\n                if (this.getRowById(c) !== -1) {\r\n                    this.createFormInputRow(this.rowsAr[c])\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.detectParentFormPresent = function() {\r\n    var a = false;\r\n    var c = this.entBox;\r\n    while (c && c.tagName && c != document.body) {\r\n        if (c.tagName.toLowerCase() == \"form\") {\r\n            a = c;\r\n            break\r\n        } else {\r\n            c = c.parentNode\r\n        }\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXGridObject.prototype.unGroup = function() {\r\n    if (!this._groups) {\r\n        return\r\n    }\r\n    this._dndProblematic = false;\r\n    delete this._groups;\r\n    delete this._gIndex;\r\n    if (this._fake) {\r\n        this._mirror_rowsCol()\r\n    }\r\n    this.forEachRow(function(a) {\r\n        this.rowsAr[a].style.display = \"\"\r\n    });\r\n    this._reset_view();\r\n    this.callEvent(\"onGridReconstructed\", []);\r\n    this.callEvent(\"onUnGroup\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._mirror_rowsCol = function() {\r\n    this._fake._groups = this._groups;\r\n    this._fake._gIndex = this._gIndex;\r\n    this.rowsBuffer = dhtmlxArray();\r\n    for (var a = 0; a < this.rowsCol.length; a++) {\r\n        if (!this.rowsCol[a]._cntr) {\r\n            this.rowsBuffer.push(this.rowsCol[a])\r\n        }\r\n    }\r\n    this._fake.rowsBuffer = dhtmlxArray();\r\n    for (var a = 0; a < this._fake.rowsCol.length; a++) {\r\n        if (!this._fake.rowsCol[a]._cntr) {\r\n            this._fake.rowsBuffer.push(this._fake.rowsCol[a])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.groupBy = function(m, g) {\r\n    if (this._groups) {\r\n        this.unGroup()\r\n    }\r\n    this._dndProblematic = true;\r\n    this._groups = {};\r\n    if (!g) {\r\n        g = [\"#title\"];\r\n        for (var h = 1; h < this._cCount; h++) {\r\n            g.push(\"#cspan\")\r\n        }\r\n    }\r\n    this._gmask = document.createElement(\"TR\");\r\n    this._gmask.origin = g;\r\n    var l, e = 0;\r\n    for (var h = 0; h < g.length; h++) {\r\n        if (g[h] == \"#cspan\") {\r\n            l.colSpan = (parseInt(l.colSpan) || 1) + 1\r\n        } else {\r\n            l = document.createElement(\"TD\");\r\n            l._cellIndex = h;\r\n            if (this._hrrar[h]) {\r\n                l.style.display = \"none\"\r\n            }\r\n            l.className = \"group_row\";\r\n            l.innerHTML = \"&nbsp;\";\r\n            if (g[h] == \"#title\") {\r\n                this._gmask._title = e\r\n            } else {\r\n                l.align = this.cellAlign[h] || \"left\"\r\n            }\r\n            this._gmask.appendChild(l);\r\n            if (g[h].indexOf(\"#stat\") == 0) {\r\n                this._gmask._math = true;\r\n                l._counter = [this[\"_g_\" + g[h].replace(\"#\", \"\")], h, e]\r\n            }\r\n            e++\r\n        }\r\n    }\r\n    for (var c in this._groups) {\r\n        this._groups[c] = this.undefined\r\n    }\r\n    this._gIndex = m;\r\n    if (this._fake && !this._realfake) {\r\n        this._fake._groups = [];\r\n        this._fake._gIndex = this._gIndex\r\n    }\r\n    this._nextRow = function(o, a) {\r\n        var n = this.rowsCol[o + a];\r\n        if (n && (n.style.display == \"none\" || n._cntr)) {\r\n            return this._nextRow(o + a, a)\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    if (!this.__sortRowsBG) {\r\n        this._key_events = dhtmlx.extend({}, this._key_events);\r\n        this._key_events.k38_0_0 = function() {\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftPrev()\r\n            } else {\r\n                var a = this.row.rowIndex;\r\n                if (!a) {\r\n                    return\r\n                }\r\n                var n = this._nextRow(a - 1, -1);\r\n                if (n) {\r\n                    this.selectCell(n, this.cell._cellIndex, true)\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        this._key_events.k13_1_0 = this._key_events.k13_0_1 = function() {}\r\n        ;\r\n        this._key_events.k40_0_0 = function() {\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftNext()\r\n            } else {\r\n                var a = this.row.rowIndex;\r\n                if (!a) {\r\n                    return\r\n                }\r\n                var n = this._nextRow(a - 1, 1);\r\n                if (n) {\r\n                    this.selectCell(n, this.cell._cellIndex, true)\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        this.attachEvent(\"onFilterStart\", function() {\r\n            if (this._groups) {\r\n                this._groups = this.undefined\r\n            }\r\n            return true\r\n        });\r\n        this.attachEvent(\"onFilterEnd\", function() {\r\n            if (typeof this._gIndex != \"undefined\") {\r\n                this.groupBy(this._gIndex, this._gmask.origin)\r\n            }\r\n        });\r\n        this.sortRows_bg = this.sortRows;\r\n        this.sortRows = function(o, n, a) {\r\n            if (typeof (this._groups) == \"undefined\") {\r\n                return this.sortRows_bg.apply(this, arguments)\r\n            }\r\n            n = n || \"str\";\r\n            a = a || \"asc\";\r\n            if (this.callEvent(\"onBeforeSorting\", [o, n, a])) {\r\n                if (typeof (this._groups) == \"undefined\") {\r\n                    return true\r\n                }\r\n                if (o == this._gIndex) {\r\n                    this._sortByGroup(o, n, a)\r\n                } else {\r\n                    this._sortInGroup(o, n, a)\r\n                }\r\n                this.setSortImgState(true, o, a);\r\n                if (this._fake) {\r\n                    this._mirror_rowsCol();\r\n                    this._fake._groups = [];\r\n                    this._fake._reset_view()\r\n                }\r\n                this.setSortImgState(true, o, a);\r\n                this.callEvent(\"onAfterSorting\", [o, n, a])\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        this.attachEvent(\"onClearAll\", function() {\r\n            this.unGroup()\r\n        });\r\n        this.attachEvent(\"onBeforeRowDeleted\", function(o) {\r\n            if (!this._groups) {\r\n                return true\r\n            }\r\n            if (!this.rowsAr[o]) {\r\n                return true\r\n            }\r\n            var n = this.cells(o, this._gIndex).getValue();\r\n            if (n === \"\") {\r\n                n = \" \"\r\n            }\r\n            var a = this._groups[n];\r\n            this._dec_group(a);\r\n            return true\r\n        });\r\n        this.attachEvent(\"onAfterRowDeleted\", function(a) {\r\n            this.updateGroups()\r\n        });\r\n        this.attachEvent(\"onCheckbox\", function(o, a, n) {\r\n            this.callEvent(\"onEditCell\", [2, o, a, (n ? 1 : 0), (n ? 0 : 1)])\r\n        });\r\n        this.attachEvent(\"onXLE\", this.updateGroups);\r\n        this.attachEvent(\"onColumnHidden\", this.hideGroupColumn);\r\n        this.attachEvent(\"onEditCell\", function(D, u, A, y, E) {\r\n            if (!this._groups) {\r\n                return true\r\n            }\r\n            if (D == 2 && y != E && A == this._gIndex) {\r\n                if (E === \"\") {\r\n                    E = \" \"\r\n                }\r\n                this._dec_group(this._groups[E]);\r\n                var a = this.rowsAr[u];\r\n                var C = this.rowsCol._dhx_find(a);\r\n                var w = this._inc_group(y);\r\n                var x = this.rowsCol[w];\r\n                if (a == x) {\r\n                    x = x.nextSibling\r\n                }\r\n                var s = a.parentNode;\r\n                var v = a.rowIndex;\r\n                s.removeChild(a);\r\n                if (x) {\r\n                    s.insertBefore(a, x)\r\n                } else {\r\n                    s.appendChild(a)\r\n                }\r\n                this.rowsCol._dhx_insertAt(w, a);\r\n                if (w < C) {\r\n                    C++\r\n                }\r\n                this.rowsCol._dhx_removeAt(C, a);\r\n                this._fixAlterCss()\r\n            } else {\r\n                if (D == 2 && y != E) {\r\n                    this.updateGroups();\r\n                    this._updateGroupView(this._groups[this.cells(u, this._gIndex).getValue() || \" \"])\r\n                }\r\n            }\r\n            return true\r\n        });\r\n        this.__sortRowsBG = true\r\n    }\r\n    this._groupExisting();\r\n    if (this._hrrar) {\r\n        for (var h = 0; h < this._hrrar.length; h++) {\r\n            if (this._hrrar[h]) {\r\n                this.hideGroupColumn(h, true)\r\n            }\r\n        }\r\n    }\r\n    this.callEvent(\"onGroup\", []);\r\n    if (this._ahgr || this._awdth) {\r\n        this.setSizes()\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._sortInGroup = function(e, n, g) {\r\n    var o = this._groups_get();\r\n    o.reverse();\r\n    for (var l = 0; l < o.length; l++) {\r\n        var m = o[l]._cntr._childs;\r\n        var r = {};\r\n        for (var h = 0; h < m.length; h++) {\r\n            var s = this.cells3(m[h], e);\r\n            r[m[h].idd] = s.getDate ? s.getDate() : s.getValue()\r\n        }\r\n        this._sortCore(e, n, g, r, m)\r\n    }\r\n    this._groups_put(o);\r\n    this.setSizes();\r\n    this.callEvent(\"onGridReconstructed\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._sortByGroup = function(h, m, e) {\r\n    var c = this._groups_get();\r\n    var g = [];\r\n    for (var l = 0; l < c.length; l++) {\r\n        c[l].idd = \"_sort_\" + l;\r\n        g[\"_sort_\" + l] = c[l]._cntr.text\r\n    }\r\n    this._sortCore(h, m, e, g, c);\r\n    this._groups_put(c);\r\n    this.callEvent(\"onGridReconstructed\", []);\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._inc_group = function(h, e, a) {\r\n    if (h === \"\") {\r\n        h = \" \"\r\n    }\r\n    if (!this._groups[h]) {\r\n        this._groups[h] = {\r\n            text: h,\r\n            row: this._addPseudoRow(),\r\n            count: 0,\r\n            state: e ? \"plus\" : \"minus\"\r\n        }\r\n    }\r\n    var g = this._groups[h];\r\n    g.row._cntr = g;\r\n    var c = this.rowsCol._dhx_find(g.row) + g.count + 1;\r\n    g.count++;\r\n    if (!a) {\r\n        this._updateGroupView(g);\r\n        this.updateGroups()\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXGridObject.prototype._dec_group = function(a) {\r\n    if (!a) {\r\n        return\r\n    }\r\n    a.count--;\r\n    if (a.count == 0) {\r\n        a.row.parentNode.removeChild(a.row);\r\n        this.rowsCol._dhx_removeAt(this.rowsCol._dhx_find(a.row));\r\n        delete this._groups[a.text]\r\n    } else {\r\n        this._updateGroupView(a)\r\n    }\r\n    if (this._fake && !this._realfake) {\r\n        this._fake._dec_group(this._fake._groups[a.text])\r\n    }\r\n    this.updateGroups();\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype._insertRowAt_gA = dhtmlXGridObject.prototype._insertRowAt;\r\ndhtmlXGridObject.prototype._insertRowAt = function(e, g, c) {\r\n    if (typeof (this._groups) != \"undefined\") {\r\n        if (this._realfake) {\r\n            var h = this._fake._bfs_cells(e.idd, this._gIndex).getValue()\r\n        } else {\r\n            if (this._bfs_cells3) {\r\n                var h = this._bfs_cells3(e, this._gIndex).getValue()\r\n            } else {\r\n                var h = this.cells3(e, this._gIndex).getValue()\r\n            }\r\n        }\r\n        if (!h) {\r\n            h = \" \"\r\n        }\r\n        g = this._inc_group(h, e.style.display == \"none\")\r\n    }\r\n    var a = this._insertRowAt_gA(e, g, c);\r\n    if (typeof (this._groups) != \"undefined\") {\r\n        this.expandGroup(h);\r\n        this._updateGroupView(this._groups[h]);\r\n        this.updateGroups()\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._updateGroupView = function(e) {\r\n    if (this._fake && !this._realfake) {\r\n        return e.row.firstChild.innerHTML = \"&nbsp;\"\r\n    }\r\n    var a = this._gmask || this._fake._gmask;\r\n    var c = \"<img style='margin-bottom:-4px' src='\" + this.imgURL + e.state + \".gif'> \";\r\n    if (this.customGroupFormat) {\r\n        c += this.customGroupFormat(e.text, e.count)\r\n    } else {\r\n        c += e.text + \" ( \" + e.count + \" ) \"\r\n    }\r\n    e.row.childNodes[a._title].innerHTML = c\r\n}\r\n;\r\ndhtmlXGridObject.prototype._addPseudoRow = function(h) {\r\n    var a = this._gmask || this._fake._gmask;\r\n    var g = a.cloneNode(true);\r\n    for (var c = 0; c < g.childNodes.length; c++) {\r\n        g.childNodes[c]._cellIndex = a.childNodes[c]._cellIndex;\r\n        if (this._realfake) {\r\n            g.childNodes[c].style.display = \"\"\r\n        }\r\n    }\r\n    var e = this;\r\n    g.onclick = function(l) {\r\n        if (!e.callEvent(\"onGroupClick\", [this._cntr.text])) {\r\n            return\r\n        }\r\n        if (e._fake && e._realfake) {\r\n            e._fake._switchGroupState(e._fake._groups[this._cntr.text].row)\r\n        } else {\r\n            e._switchGroupState(this)\r\n        }\r\n        (l || event).cancelBubble = \"true\"\r\n    }\r\n    ;\r\n    g.ondblclick = function(l) {\r\n        (l || event).cancelBubble = \"true\"\r\n    }\r\n    ;\r\n    if (!h) {\r\n        if (_isKHTML) {\r\n            this.obj.appendChild(g)\r\n        } else {\r\n            this.obj.firstChild.appendChild(g)\r\n        }\r\n        this.rowsCol.push(g)\r\n    }\r\n    return g\r\n}\r\n;\r\ndhtmlXGridObject.prototype._groups_get = function() {\r\n    var c = [];\r\n    this._temp_par = this.obj.parentNode;\r\n    this._temp_par.removeChild(this.obj);\r\n    var e = [];\r\n    for (var g = this.rowsCol.length - 1; g >= 0; g--) {\r\n        if (this.rowsCol[g]._cntr) {\r\n            this.rowsCol[g]._cntr._childs = e;\r\n            e = [];\r\n            c.push(this.rowsCol[g])\r\n        } else {\r\n            e.push(this.rowsCol[g])\r\n        }\r\n        this.rowsCol[g].parentNode.removeChild(this.rowsCol[g])\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXGridObject.prototype._groups_put = function(a) {\r\n    var h = this.rowsCol.stablesort;\r\n    this.rowsCol = new dhtmlxArray(0);\r\n    this.rowsCol.stablesort = h;\r\n    for (var g = 0; g < a.length; g++) {\r\n        var e = a[g]._cntr;\r\n        this.obj.firstChild.appendChild(e.row);\r\n        this.rowsCol.push(e.row);\r\n        e.row.idd = null ;\r\n        for (var c = 0; c < e._childs.length; c++) {\r\n            this.obj.firstChild.appendChild(e._childs[c]);\r\n            this.rowsCol.push(e._childs[c])\r\n        }\r\n        delete e._childs\r\n    }\r\n    this._temp_par.appendChild(this.obj)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._groupExisting = function(c) {\r\n    if (!this.getRowsNum()) {\r\n        return\r\n    }\r\n    var c = [];\r\n    this._temp_par = this.obj.parentNode;\r\n    this._temp_par.removeChild(this.obj);\r\n    var e = [];\r\n    var g = this.rowsCol.length;\r\n    for (var h = 0; h < g; h++) {\r\n        var m = this.cells4(this.rowsCol[h].childNodes[this._gIndex]).getValue();\r\n        this.rowsCol[h].style.display = \"\";\r\n        if (!m) {\r\n            m = \" \"\r\n        }\r\n        if (!this._groups[m]) {\r\n            this._groups[m] = {\r\n                text: m,\r\n                row: this._addPseudoRow(true),\r\n                count: 0,\r\n                state: \"minus\"\r\n            };\r\n            var l = this._groups[m];\r\n            l.row._cntr = l;\r\n            this._groups[m]._childs = [];\r\n            c.push(l.row)\r\n        }\r\n        this._groups[m].count++;\r\n        this._groups[m]._childs.push(this.rowsCol[h]);\r\n        this.rowsCol[h].parentNode.removeChild(this.rowsCol[h])\r\n    }\r\n    for (var h = 0; h < c.length; h++) {\r\n        this._updateGroupView(c[h]._cntr)\r\n    }\r\n    this._groups_put(c);\r\n    if (this._fake && !this._realfake) {\r\n        this._mirror_rowsCol();\r\n        this._fake._groups = [];\r\n        this._fake._reset_view()\r\n    }\r\n    this.callEvent(\"onGridReconstructed\", []);\r\n    this.updateGroups()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._switchGroupState = function(g) {\r\n    var e = g._cntr;\r\n    if (this._fake && !this._realfake) {\r\n        e.state = this._fake._groups[g._cntr.text].row._cntr.state;\r\n        this._fake._switchGroupState(this._fake._groups[g._cntr.text].row)\r\n    }\r\n    var c = this.rowsCol._dhx_find(e.row) + 1;\r\n    e.state = e.state == \"minus\" ? \"plus\" : \"minus\";\r\n    var a = e.state == \"plus\" ? \"none\" : \"\";\r\n    while (this.rowsCol[c] && !this.rowsCol[c]._cntr) {\r\n        this.rowsCol[c].style.display = a;\r\n        c++\r\n    }\r\n    this._updateGroupView(e);\r\n    this.callEvent(\"onGroupStateChanged\", [e.text, (e.state == \"minus\")]);\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.expandGroup = function(a) {\r\n    if (this._groups[a].state == \"plus\") {\r\n        this._switchGroupState(this._groups[a].row)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.collapseGroup = function(a) {\r\n    if (this._groups[a].state == \"minus\") {\r\n        this._switchGroupState(this._groups[a].row)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.expandAllGroups = function() {\r\n    for (var a in this._groups) {\r\n        if (this._groups[a] && this._groups[a].state == \"plus\") {\r\n            this._switchGroupState(this._groups[a].row)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.collapseAllGroups = function() {\r\n    for (var a in this._groups) {\r\n        if (this._groups[a] && this._groups[a].state == \"minus\") {\r\n            this._switchGroupState(this._groups[a].row)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.hideGroupColumn = function(l, h) {\r\n    if (this._fake) {\r\n        return\r\n    }\r\n    var g = -1;\r\n    var m = this._gmask.childNodes;\r\n    for (var e = 0; e < m.length; e++) {\r\n        if (m[e]._cellIndex == l) {\r\n            g = e;\r\n            break\r\n        }\r\n    }\r\n    if (g == -1) {\r\n        return\r\n    }\r\n    for (var c in this._groups) {\r\n        this._groups[c].row.childNodes[g].style.display = h ? \"none\" : \"\"\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.groupStat = function(c, g, e) {\r\n    e = this[\"_g_\" + (e || \"stat_total\")];\r\n    var h = 0;\r\n    var a = 0;\r\n    this.forEachRowInGroup(c, function(l) {\r\n        h = e(h, this.cells(l, g).getValue() * 1, a);\r\n        a++\r\n    });\r\n    return h\r\n}\r\n;\r\ndhtmlXGridObject.prototype.forEachRowInGroup = function(a, g) {\r\n    var h = this._groups[a].row.nextSibling;\r\n    if (h) {\r\n        while (h && !h._cntr) {\r\n            g.call(this, h.idd);\r\n            h = h.nextSibling\r\n        }\r\n    } else {\r\n        var e = this._groups[a]._childs;\r\n        if (e) {\r\n            for (var c = 0; c < e.length; c++) {\r\n                g.call(this, e[c].idd)\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.updateGroups = function() {\r\n    if (!this._gmask || !this._gmask._math || this._parsing) {\r\n        return\r\n    }\r\n    var c = this._gmask.childNodes;\r\n    for (var a = 0; a < c.length; a++) {\r\n        if (c[a]._counter) {\r\n            this._b_processing.apply(this, c[a]._counter)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._b_processing = function(e, m, l) {\r\n    var n = 0\r\n      , g = 0;\r\n    if (!this._ecache[this.cellType[m]]) {\r\n        this.cells5({\r\n            parentNode: {\r\n                grid: this\r\n            }\r\n        }, this.cellType[m])\r\n    }\r\n    for (var h = this.rowsCol.length - 1; h >= 0; h--) {\r\n        if (!this.rowsCol[h]._cntr) {\r\n            n = e(n, this.cells3(this.rowsCol[h], m).getValue() * 1, g);\r\n            g++\r\n        } else {\r\n            this.cells5(this.rowsCol[h].childNodes[l], this.cellType[m]).setValue(n);\r\n            g = n = 0\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._g_stat_total = function(g, e, a) {\r\n    return g + e\r\n}\r\n;\r\ndhtmlXGridObject.prototype._g_stat_min = function(g, e, a) {\r\n    if (!a) {\r\n        g = Infinity\r\n    }\r\n    return Math.min(g, e)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._g_stat_max = function(g, e, a) {\r\n    if (!a) {\r\n        g = -Infinity\r\n    }\r\n    return Math.max(g, e)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._g_stat_average = function(g, e, a) {\r\n    return (g * a + e) / (a + 1)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._g_stat_count = function(g, e, a) {\r\n    return g++\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_collapse = function(h, g, n) {\r\n    var a = h.tagName == \"TD\" ? h : h.parentNode;\r\n    g = a._cellIndexS;\r\n    if (!this._column_groups) {\r\n        this._column_groups = []\r\n    }\r\n    var m = n[1].split(\":\");\r\n    var m = n[1].split(\":\");\r\n    m = [m.shift(), m.join(\":\")];\r\n    var l = parseInt(m[0]);\r\n    h.innerHTML = n[0] + \"<img src='\" + this.imgURL + \"minus.gif' style='padding-right:10px;height:16px'/><span style='position:relative; top:-6px;'>\" + (m[1] || \"\") + \"<span>\";\r\n    h.style.paddingBottom = \"0px\";\r\n    var e = this;\r\n    this._column_groups[g] = h.getElementsByTagName(\"IMG\")[0];\r\n    this._column_groups[g].onclick = function(o) {\r\n        (o || event).cancelBubble = true;\r\n        this._cstate = !this._cstate;\r\n        for (var c = g + 1; c < (g + l); c++) {\r\n            e.setColumnHidden(c, this._cstate)\r\n        }\r\n        if (this._cstate) {\r\n            if (a.colSpan && a.colSpan > 0) {\r\n                a._exp_colspan = a.colSpan;\r\n                var u = Math.max(1, a.colSpan - l);\r\n                if (!_isFF) {\r\n                    for (var r = 0; r < a.colSpan - u; r++) {\r\n                        var s = document.createElement(\"TD\");\r\n                        if (a.nextSibling) {\r\n                            a.parentNode.insertBefore(s, a.nextSibling)\r\n                        } else {\r\n                            a.parentNode.appendChild(s)\r\n                        }\r\n                    }\r\n                }\r\n                a.colSpan = u\r\n            }\r\n            e.callEvent(\"onColumnCollapse\", [g, this._cstate])\r\n        } else {\r\n            if (a._exp_colspan) {\r\n                a.colSpan = a._exp_colspan;\r\n                if (!_isFF) {\r\n                    for (var r = 1; r < a._exp_colspan; r++) {\r\n                        a.parentNode.removeChild(a.nextSibling)\r\n                    }\r\n                }\r\n                e.callEvent(\"onColumnCollapse\", [g, this._cstate])\r\n            }\r\n        }\r\n        this.src = e.imgURL + (this._cstate ? \"plus.gif\" : \"minus.gif\");\r\n        if (e.sortImg.style.display != \"none\") {\r\n            e.setSortImgPos()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.collapseColumns = function(a) {\r\n    if (!this._column_groups[a] || this._column_groups[a]._cstate) {\r\n        return\r\n    }\r\n    this._column_groups[a].onclick({})\r\n}\r\n;\r\ndhtmlXGridObject.prototype.expandColumns = function(a) {\r\n    if (!this._column_groups[a] || !this._column_groups[a]._cstate) {\r\n        return\r\n    }\r\n    this._column_groups[a].onclick({})\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableHeaderMenu = function(a) {\r\n    if (!window.dhtmlXMenuObject) {\r\n        return dhtmlx.message(\"You need to include DHTMLX Menu\")\r\n    }\r\n    if (!this._header_menu) {\r\n        var e = this._header_menu = new dhtmlXMenuObject();\r\n        e.renderAsContextMenu();\r\n        var c = this;\r\n        e.attachEvent(\"onBeforeContextMenu\", function() {\r\n            c._showHContext(a);\r\n            return true\r\n        });\r\n        e.attachEvent(\"onClick\", function(r) {\r\n            var m = this.getCheckboxState(r);\r\n            var n = c.hdr.rows[1];\r\n            for (var h = 0; h < n.cells.length; h++) {\r\n                var o = n.cells[h];\r\n                if (o._cellIndexS == r) {\r\n                    var g = o.colSpan || 1;\r\n                    for (var l = 0; l < g; l++) {\r\n                        c.setColumnHidden(r * 1 + l, !m)\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        this.attachEvent(\"onInit\", function() {\r\n            e.addContextZone(this.hdr)\r\n        });\r\n        if (this.hdr.rows.length) {\r\n            this.callEvent(\"onInit\", [])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getHeaderMenu = function(a) {\r\n    return this._header_menu\r\n}\r\n;\r\ndhtmlXGridObject.prototype._hideHContext = function() {\r\n    if (this._header_menu) {\r\n        this._header_menu.hide()\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._showHContext = function(g) {\r\n    if (typeof g == \"string\") {\r\n        g = g.split(this.delim)\r\n    }\r\n    var h = 0;\r\n    var a = 0;\r\n    this._header_menu.clearAll();\r\n    for (var e = 0; e < this.hdr.rows[1].cells.length; e++) {\r\n        var n = this.hdr.rows[1].cells[e];\r\n        if (!g || (g[h] && g[h] != \"false\")) {\r\n            if (n.firstChild && n.firstChild.tagName == \"DIV\") {\r\n                var m = n.firstChild.innerHTML\r\n            } else {\r\n                var m = n.innerHTML\r\n            }\r\n            m = m.replace(/<[^>]*>/gi, \"\");\r\n            var l = !(this.isColumnHidden(h) || (this.getColWidth(h) == 0));\r\n            this._header_menu.addCheckbox(\"child\", this._header_menu.topId, a, h, m, l);\r\n            a++\r\n        }\r\n        h += (n.colSpan || 1)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_json_row = function(h, l) {\r\n    h._attrs = l;\r\n    for (var e = 0; e < h.childNodes.length; e++) {\r\n        h.childNodes[e]._attrs = {}\r\n    }\r\n    if (l.userdata) {\r\n        for (var c in l.userdata) {\r\n            this.setUserData(h.idd, c, l.userdata[c])\r\n        }\r\n    }\r\n    l = this._c_order ? this._swapColumns(l.data) : l.data;\r\n    for (var g = 0; g < l.length; g++) {\r\n        if (typeof l[g] == \"object\" && l[g] != null ) {\r\n            h.childNodes[g]._attrs = l[g];\r\n            if (l[g].type) {\r\n                h.childNodes[g]._cellType = l[g].type\r\n            }\r\n            l[g] = l[g].value\r\n        }\r\n    }\r\n    this._fillRow(h, l);\r\n    return h\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_js_row = function(l, m) {\r\n    l._attrs = m;\r\n    for (var g = 0; g < l.childNodes.length; g++) {\r\n        l.childNodes[g]._attrs = {}\r\n    }\r\n    if (m.userdata) {\r\n        for (var e in m.userdata) {\r\n            this.setUserData(l.idd, e, m.userdata[e])\r\n        }\r\n    }\r\n    var c = [];\r\n    for (var h = 0; h < this.columnIds.length; h++) {\r\n        c[h] = m[this.columnIds[h]];\r\n        if (typeof c[h] == \"object\" && c[h] != null ) {\r\n            l.childNodes[h]._attrs = c[h];\r\n            if (c[h].type) {\r\n                l.childNodes[h]._cellType = c[h].type\r\n            }\r\n            c[h] = c[h].value\r\n        }\r\n        if (!c[h] && c[h] !== 0) {\r\n            c[h] = \"\"\r\n        }\r\n    }\r\n    this._fillRow(l, c);\r\n    return l\r\n}\r\n;\r\ndhtmlXGridObject.prototype.updateFromJSON = function(a, g, c, e) {\r\n    if (typeof g == \"undefined\") {\r\n        g = true\r\n    }\r\n    this._refresh_mode = [true, g, c];\r\n    this.load(a, e, \"json\")\r\n}\r\n,\r\ndhtmlXGridObject.prototype._refreshFromJSON = function(e) {\r\n    if (this._f_rowsBuffer) {\r\n        this.filterBy(0, \"\")\r\n    }\r\n    reset = false;\r\n    if (window.eXcell_tree) {\r\n        eXcell_tree.prototype.setValueX = eXcell_tree.prototype.setValue;\r\n        eXcell_tree.prototype.setValue = function(u) {\r\n            var s = this.grid._h2.get[this.cell.parentNode.idd];\r\n            if (s && this.cell.parentNode.valTag) {\r\n                this.setLabel(u)\r\n            } else {\r\n                this.setValueX(u)\r\n            }\r\n        }\r\n    }\r\n    var r = this.cellType._dhx_find(\"tree\");\r\n    var h = e.parent || 0;\r\n    var m = {};\r\n    if (this._refresh_mode[2]) {\r\n        if (r != -1) {\r\n            this._h2.forEachChild(h, function(s) {\r\n                m[s.id] = true\r\n            }, this)\r\n        } else {\r\n            this.forEachRow(function(s) {\r\n                m[s] = true\r\n            })\r\n        }\r\n    }\r\n    var o = e.rows;\r\n    for (var g = 0; g < o.length; g++) {\r\n        var n = o[g];\r\n        var a = n.id;\r\n        m[a] = false;\r\n        if (this.rowsAr[a] && this.rowsAr[a].tagName != \"TR\") {\r\n            if (this._h2) {\r\n                this._h2.get[a].buff.data = n\r\n            } else {\r\n                this.rowsBuffer[this.getRowIndex(a)].data = n\r\n            }\r\n            this.rowsAr[a] = n\r\n        } else {\r\n            if (this.rowsAr[a]) {\r\n                this._process_json_row(this.rowsAr[a], n, -1);\r\n                this._postRowProcessing(this.rowsAr[a], true)\r\n            } else {\r\n                if (this._refresh_mode[1]) {\r\n                    var l = {\r\n                        idd: a,\r\n                        data: n,\r\n                        _parser: this._process_json_row,\r\n                        _locator: this._get_json_data\r\n                    };\r\n                    var c = this.rowsBuffer.length;\r\n                    if (this._refresh_mode[1] == \"top\") {\r\n                        this.rowsBuffer.unshift(l);\r\n                        c = 0\r\n                    } else {\r\n                        this.rowsBuffer.push(l)\r\n                    }\r\n                    if (this._h2) {\r\n                        reset = true;\r\n                        (this._h2.add(a, h)).buff = this.rowsBuffer[this.rowsBuffer.length - 1]\r\n                    }\r\n                    this.rowsAr[a] = n;\r\n                    n = this.render_row(c);\r\n                    this._insertRowAt(n, c ? -1 : 0)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (this._refresh_mode[2]) {\r\n        for (a in m) {\r\n            if (m[a] && this.rowsAr[a]) {\r\n                this.deleteRow(a)\r\n            }\r\n        }\r\n    }\r\n    this._refresh_mode = null ;\r\n    if (window.eXcell_tree) {\r\n        eXcell_tree.prototype.setValue = eXcell_tree.prototype.setValueX\r\n    }\r\n    if (reset) {\r\n        this._renderSort()\r\n    }\r\n    if (this._f_rowsBuffer) {\r\n        this._f_rowsBuffer = null ;\r\n        this.filterByAll()\r\n    }\r\n}\r\n,\r\ndhtmlXGridObject.prototype._process_js = function(a) {\r\n    return this._process_json(a, \"js\")\r\n}\r\n,\r\ndhtmlXGridObject.prototype._parseHeadJson = function(s) {\r\n    if (!s.head || !s.head.length) {\r\n        return\r\n    }\r\n    var a = s.head;\r\n    var g = s.settings;\r\n    var m = \"setInitWidths\";\r\n    var o = false;\r\n    if (g && g.colwidth == \"%\") {\r\n        m = \"setInitWidthsP\"\r\n    }\r\n    if (g && g.splitat == \"%\") {\r\n        o = g.splitat\r\n    }\r\n    if (this.hdr.rows.length > 0) {\r\n        this.clearAll(true)\r\n    }\r\n    var n = [[], [], [], [], [], [], []];\r\n    var r = [\"value\", \"width\", \"type\", \"align\", \"sort\", \"hidden\", \"id\"];\r\n    var v = [\"\", m, \"setColTypes\", \"setColAlign\", \"setColSorting\", \"\", \"setColumnIds\"];\r\n    for (var l = 0; l < a.length; l++) {\r\n        for (var h = 0; h < r.length; h++) {\r\n            n[h].push(a[l][r[h]])\r\n        }\r\n    }\r\n    this.setHeader(n[0]);\r\n    for (var l = 0; l < v.length; l++) {\r\n        if (v[l]) {\r\n            this[v[l]](n[l].join(this.delim))\r\n        }\r\n    }\r\n    for (var l = 0; l < a.length; l++) {\r\n        var u = a[l].options;\r\n        if (a[l].options) {\r\n            if (this.cellType[l] == \"clist\") {\r\n                this.registerCList(l, u)\r\n            } else {\r\n                var c = this.getCombo(l);\r\n                for (var h = 0; h < u.length; h++) {\r\n                    c.put(u[h].id, u[h].value)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    this.init();\r\n    var e = n[5].join(this.delim);\r\n    if (this.setColHidden && e.replace(/,/g, \"\") != \"\") {\r\n        this.setColHidden(e)\r\n    }\r\n    if ((o) && (this.splitAt)) {\r\n        this.splitAt(o)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_json = function(data, mode) {\r\n    this._parsing = true;\r\n    try {\r\n        var data = data.responseText || data;\r\n        if (typeof data == \"string\") {\r\n            eval(\"dhtmlx.temp=\" + data + \";\");\r\n            data = dhtmlx.temp\r\n        }\r\n    } catch (e) {\r\n        dhx4.callEvent(\"onLoadXMLError\", [\"Incorrect JSON\", (data.xmlDoc || data), this]);\r\n        data = {\r\n            rows: []\r\n        }\r\n    }\r\n    if (this._refresh_mode) {\r\n        return this._refreshFromJSON(data)\r\n    }\r\n    if (data.head) {\r\n        this._parseHeadJson(data)\r\n    }\r\n    var cr = parseInt(data.pos || 0);\r\n    var total = parseInt(data.total_count || 0);\r\n    var reset = false;\r\n    if (total) {\r\n        if (!this.rowsBuffer[total - 1]) {\r\n            if (this.rowsBuffer.length) {\r\n                reset = true\r\n            }\r\n            this.rowsBuffer[total - 1] = null \r\n        }\r\n        if (total < this.rowsBuffer.length) {\r\n            this.rowsBuffer.splice(total, this.rowsBuffer.length - total);\r\n            reset = true\r\n        }\r\n    }\r\n    var userdata = mode === \"js\" ? data.userdata : data;\r\n    for (var key in userdata) {\r\n        if (mode === \"js\" || key != \"rows\") {\r\n            this.setUserData(\"\", key, userdata[key])\r\n        }\r\n    }\r\n    if (mode == \"js\" && data.collections) {\r\n        for (var colkey in data.collections) {\r\n            var index = this.getColIndexById(colkey);\r\n            var colrecs = data.collections[colkey];\r\n            if (index !== window.undefined) {\r\n                if (this.cellType[index] == \"clist\") {\r\n                    colplaindata = [];\r\n                    for (var j = 0; j < colrecs.length; j++) {\r\n                        colplaindata.push(colrecs[j].label)\r\n                    }\r\n                    this.registerCList(index, colplaindata)\r\n                } else {\r\n                    var combo = this.getCombo(index);\r\n                    for (var j = 0; j < colrecs.length; j++) {\r\n                        combo.put(colrecs[j].value, colrecs[j].label)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (this.isTreeGrid()) {\r\n        return this._process_tree_json(data, null , null , mode)\r\n    }\r\n    if (mode == \"js\") {\r\n        if (data.data) {\r\n            data = data.data\r\n        }\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (this.rowsBuffer[i + cr]) {\r\n                continue\r\n            }\r\n            var row = data[i];\r\n            var id = row.id || (i + 1);\r\n            this.rowsBuffer[i + cr] = {\r\n                idd: id,\r\n                data: row,\r\n                _parser: this._process_js_row,\r\n                _locator: this._get_js_data\r\n            };\r\n            this.rowsAr[id] = data[i]\r\n        }\r\n    } else {\r\n        for (var i = 0; i < data.rows.length; i++) {\r\n            if (this.rowsBuffer[i + cr]) {\r\n                continue\r\n            }\r\n            var id = data.rows[i].id;\r\n            this.rowsBuffer[i + cr] = {\r\n                idd: id,\r\n                data: data.rows[i],\r\n                _parser: this._process_json_row,\r\n                _locator: this._get_json_data\r\n            };\r\n            this.rowsAr[id] = data.rows[i]\r\n        }\r\n    }\r\n    this.callEvent(\"onDataReady\", []);\r\n    if (reset && this._srnd) {\r\n        var h = this.objBox.scrollTop;\r\n        this._reset_view();\r\n        this.objBox.scrollTop = h\r\n    } else {\r\n        this.render_dataset()\r\n    }\r\n    this._parsing = false\r\n}\r\n;\r\ndhtmlXGridObject.prototype._get_json_data = function(c, a) {\r\n    if (typeof c.data[a] == \"object\") {\r\n        return c.data[a].value\r\n    } else {\r\n        return c.data[a]\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_tree_json = function(g, h, c, m) {\r\n    this._parsing = true;\r\n    var a = false;\r\n    if (!h) {\r\n        this.render_row = this.render_row_tree;\r\n        a = true;\r\n        h = g;\r\n        c = h.parent || 0;\r\n        if (c == \"0\") {\r\n            c = 0\r\n        }\r\n        if (!this._h2) {\r\n            this._h2 = this._createHierarchy()\r\n        }\r\n        if (this._fake) {\r\n            this._fake._h2 = this._h2\r\n        }\r\n    }\r\n    if (m == \"js\") {\r\n        if (h.data && !c) {\r\n            g = h.data\r\n        }\r\n        if (h.rows) {\r\n            h = h.rows\r\n        }\r\n        for (var e = 0; e < h.length; e++) {\r\n            var n = h[e].id;\r\n            var l = this._h2.add(n, c);\r\n            l.buff = {\r\n                idd: n,\r\n                data: h[e],\r\n                _parser: this._process_js_row,\r\n                _locator: this._get_js_data\r\n            };\r\n            if (h[e].open) {\r\n                l.state = \"minus\"\r\n            }\r\n            this.rowsAr[n] = l.buff;\r\n            this._process_tree_json(h[e], h[e], n, m)\r\n        }\r\n    } else {\r\n        if (h.rows) {\r\n            for (var e = 0; e < h.rows.length; e++) {\r\n                var n = h.rows[e].id;\r\n                var l = this._h2.add(n, c);\r\n                l.buff = {\r\n                    idd: n,\r\n                    data: h.rows[e],\r\n                    _parser: this._process_json_row,\r\n                    _locator: this._get_json_data\r\n                };\r\n                if (h.rows[e].open) {\r\n                    l.state = \"minus\"\r\n                }\r\n                this.rowsAr[n] = l.buff;\r\n                this._process_tree_json(h.rows[e], h.rows[e], n, m)\r\n            }\r\n        }\r\n    }\r\n    if (a) {\r\n        if (c != 0) {\r\n            this._h2.change(c, \"state\", \"minus\")\r\n        }\r\n        this._updateTGRState(this._h2.get[c]);\r\n        this._h2_to_buff();\r\n        this.callEvent(\"onDataReady\", []);\r\n        if (c != 0 && (this._srnd || this.pagingOn)) {\r\n            this._renderSort()\r\n        } else {\r\n            this.render_dataset()\r\n        }\r\n        if (this._slowParse === false) {\r\n            this.forEachRow(function(o) {\r\n                this.render_row_tree(0, o)\r\n            })\r\n        }\r\n        this._parsing = false;\r\n        if (c != 0 && !this._srnd) {\r\n            this.callEvent(\"onOpenEnd\", [c, 1])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableMarkedCells = function(a) {\r\n    this.markedRowsArr = new dhtmlxArray(0);\r\n    this.markedCellsArr = new Array(0);\r\n    this.lastMarkedRow = null ;\r\n    this.lastMarkedColumn = null ;\r\n    this.markedCells = true;\r\n    this.lastMarkMethod = 0;\r\n    if (arguments.length > 0) {\r\n        if (!dhx4.s2b(a)) {\r\n            this.markedCells = false\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.doMark = function(e, m) {\r\n    var l = e.parentNode.idd;\r\n    this.setActive(true);\r\n    if (!l) {\r\n        return\r\n    }\r\n    this.editStop();\r\n    this.cell = e;\r\n    this.row = e.parentNode;\r\n    var o = e._cellIndex;\r\n    if (!m) {\r\n        m = 0\r\n    }\r\n    if (m == 0) {\r\n        this.unmarkAll()\r\n    } else {\r\n        if (m == 1) {\r\n            if (this.lastMarkedRow) {\r\n                var c = Math.min(this.getRowIndex(l), this.getRowIndex(this.lastMarkedRow));\r\n                var n = Math.max(this.getRowIndex(l), this.getRowIndex(this.lastMarkedRow));\r\n                var a = Math.min(o, this.lastMarkedColumn);\r\n                var r = Math.max(o, this.lastMarkedColumn);\r\n                for (var h = c; h < n + 1; h++) {\r\n                    for (var g = a; g < r + 1; g++) {\r\n                        this.mark(this.getRowId(h), g, true)\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (m == 2) {\r\n                if (this.markedRowsArr._dhx_find(l) != -1) {\r\n                    for (var s = 0; s < this.markedCellsArr[l].length; s++) {\r\n                        if (this.markedCellsArr[l][s] == o) {\r\n                            this.mark(l, o, false);\r\n                            return true\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (!this.markedCellsArr[l]) {\r\n        this.markedCellsArr[l] = new dhtmlxArray(0)\r\n    }\r\n    if (m != 1) {\r\n        this.mark(l, o)\r\n    }\r\n    this.moveToVisible(this.cells(l, o).cell);\r\n    this.lastMarkedRow = l;\r\n    this.lastMarkedColumn = o;\r\n    this.lastMarkMethod = m\r\n}\r\n;\r\ndhtmlXGridObject.prototype.mark = function(e, c, g) {\r\n    if (arguments.length > 2) {\r\n        if (!dhx4.s2b(g)) {\r\n            this.cells(e, c).cell.className = this.cells(e, c).cell.className.replace(/cellselected/g, \"\");\r\n            if (this.markedRowsArr._dhx_find(e) != -1) {\r\n                var a = this.markedCellsArr[e]._dhx_find(c);\r\n                if (a != -1) {\r\n                    this.markedCellsArr[e]._dhx_removeAt(a);\r\n                    if (this.markedCellsArr[e].length == 0) {\r\n                        this.markedRowsArr._dhx_removeAt(this.markedRowsArr._dhx_find(e))\r\n                    }\r\n                    this.callEvent(\"onCellUnMarked\", [e, c])\r\n                }\r\n            }\r\n            return true\r\n        }\r\n    }\r\n    this.cells(e, c).cell.className += \" cellselected\";\r\n    if (this.markedRowsArr._dhx_find(e) == -1) {\r\n        this.markedRowsArr[this.markedRowsArr.length] = e\r\n    }\r\n    if (!this.markedCellsArr[e]) {\r\n        this.markedCellsArr[e] = new dhtmlxArray(0)\r\n    }\r\n    if (this.markedCellsArr[e]._dhx_find(c) == -1) {\r\n        this.markedCellsArr[e][this.markedCellsArr[e].length] = c;\r\n        this.callEvent(\"onCellMarked\", [e, c])\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.unmarkAll = function() {\r\n    if (this.markedRowsArr) {\r\n        for (var a = 0; a < this.markedRowsArr.length; a++) {\r\n            var e = this.markedRowsArr[a];\r\n            if (this.rowsAr[e]) {\r\n                for (var c = 0; c < this.markedCellsArr[e].length; c++) {\r\n                    this.callEvent(\"onCellUnMarked\", [e, this.markedCellsArr[e][c]]);\r\n                    this.cells(e, this.markedCellsArr[e][c]).cell.className = this.cells(e, this.markedCellsArr[e][c]).cell.className.replace(/cellselected/g, \"\")\r\n                }\r\n            }\r\n        }\r\n        this.markedRowsArr = new dhtmlxArray(0);\r\n        this.markedCellsArr = new Array(0)\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getMarked = function() {\r\n    var e = new Array();\r\n    if (this.markedRowsArr) {\r\n        for (var a = 0; a < this.markedRowsArr.length; a++) {\r\n            var g = this.markedRowsArr[a];\r\n            for (var c = 0; c < this.markedCellsArr[g].length; c++) {\r\n                e[e.length] = [g, this.markedCellsArr[g][c]]\r\n            }\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\nfunction eXcell_math(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.edit = function() {\r\n        this.grid.editor = new eXcell_ed(this.cell);\r\n        this.grid.editor.fix_self = true;\r\n        this.grid.editor.getValue = this.cell.original ? (function() {\r\n            return this.cell.original\r\n        }\r\n        ) : this.getValue;\r\n        this.grid.editor.setValue = this.setValue;\r\n        this.grid.editor.edit()\r\n    }\r\n    ;\r\n    this.isDisabled = function() {\r\n        return !this.grid._mathEdit\r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        c = this.grid._compileSCL(c, this.cell, this.fix_self);\r\n        if (this.grid._strangeParams[this.cell._cellIndex]) {\r\n            this.grid.cells5(this.cell, this.grid._strangeParams[this.cell._cellIndex]).setValue(c)\r\n        } else {\r\n            this.setCValue(c);\r\n            this.cell._clearCell = false\r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        if (this.grid._strangeParams[this.cell._cellIndex]) {\r\n            return this.grid.cells5(this.cell, this.grid._strangeParams[this.cell._cellIndex]).getValue()\r\n        }\r\n        return this.cell.innerHTML\r\n    }\r\n}\r\neXcell_math.prototype = new eXcell;\r\ndhx4.attachEvent(\"onGridCreated\", function(a) {\r\n    a._mat_links = {};\r\n    a._aggregators = [];\r\n    a.attachEvent(\"onClearAll\", function() {\r\n        this._mat_links = {};\r\n        this._aggregators = []\r\n    });\r\n    a.attachEvent(\"onCellChanged\", function(m, l) {\r\n        if (this._mat_links[m]) {\r\n            var c = this._mat_links[m][l];\r\n            if (c) {\r\n                for (var h = 0; h < c.length; h++) {\r\n                    if (c[h].parentNode) {\r\n                        this.cells5(c[h]).setValue(this._calcSCL(c[h]))\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (!this._parsing && this._aggregators[l]) {\r\n            var g = this._h2.get[m].parent.id;\r\n            if (g != 0) {\r\n                var e = this.cells(g, l);\r\n                e.setValue(this._calcSCL(e.cell))\r\n            }\r\n        }\r\n    });\r\n    a.attachEvent(\"onAfterRowDeleted\", function(h, e) {\r\n        if (e != 0) {\r\n            if (!this._parsing && this._aggregators.length) {\r\n                for (var g = 0; g < this._aggregators.length; g++) {\r\n                    if (this._aggregators[g]) {\r\n                        var c = this.cells(e, g);\r\n                        c.setValue(this._calcSCL(c.cell))\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return true\r\n    });\r\n    a.attachEvent(\"onXLE\", function() {\r\n        for (var c = 0; c < this._aggregators.length; c++) {\r\n            if (this._aggregators[c]) {\r\n                this._h2.forEachChild(0, function(g) {\r\n                    if (g.childs.length != 0) {\r\n                        var e = this.cells(g.id, c);\r\n                        e.setValue(this._calcSCL(e.cell))\r\n                    }\r\n                }, this)\r\n            }\r\n        }\r\n    })\r\n});\r\ndhtmlXGridObject.prototype.enableMathSerialization = function(a) {\r\n    this._mathSerialization = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setMathRound = function(a) {\r\n    this._roundDl = a;\r\n    this._roundD = Math.pow(10, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableMathEditing = function(a) {\r\n    this._mathEdit = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._calcSCL = function(cell) {\r\n    if (!cell._code) {\r\n        return this.cells5(cell).getValue()\r\n    }\r\n    try {\r\n        dhtmlx.agrid = this;\r\n        var z = eval(cell._code)\r\n    } catch (e) {\r\n        return ( \"#SCL\") \r\n    }\r\n    if (this._roundD) {\r\n        var pre = Math.abs(z) < 1 ? \"0\" : \"\";\r\n        if (z < 0) {\r\n            pre = \"-\" + pre\r\n        }\r\n        z = Math.round(Math.abs(z) * this._roundD).toString();\r\n        if (z == 0) {\r\n            return 0\r\n        }\r\n        if (this._roundDl > 0) {\r\n            var n = z.length - this._roundDl;\r\n            if (n < 0) {\r\n                z = (\"000000000\" + z).substring(9 + n);\r\n                n = 0\r\n            }\r\n            return ( pre + z.substring(0, n) + \".\" + z.substring(n, z.length)) \r\n        }\r\n        return pre + z\r\n    }\r\n    return z\r\n}\r\n;\r\ndhtmlXGridObject.prototype._countTotal = function(l, c) {\r\n    var a = 0;\r\n    var h = this._h2.get[l];\r\n    for (var e = 0; e < h.childs.length; e++) {\r\n        if (!h.childs[e].buff) {\r\n            return a\r\n        }\r\n        if (h.childs[e].buff._parser) {\r\n            this._h2.forEachChild(l, function(m) {\r\n                if (m.childs.length == 0) {\r\n                    var n = parseFloat(this._get_cell_value(m.buff, c), 10);\r\n                    if (n) {\r\n                        a += n\r\n                    }\r\n                }\r\n            }, this);\r\n            return a\r\n        }\r\n        var g = parseFloat(this._get_cell_value(h.childs[e].buff, c), 10);\r\n        if (g) {\r\n            a += g\r\n        }\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._compileSCL = function(e, c, a) {\r\n    if (e === null  || e === window.undefined) {\r\n        return e\r\n    }\r\n    e = e.toString();\r\n    if (e.indexOf(\"=\") != 0 || !c.parentNode) {\r\n        this._reLink([], c);\r\n        if (a) {\r\n            c._code = c.original = null \r\n        }\r\n        return e\r\n    }\r\n    c.original = e;\r\n    var l = null ;\r\n    e = e.replace(\"=\", \"\");\r\n    if (e.indexOf(\"sum\") != -1) {\r\n        e = e.replace(\"sum\", \"(dhtmlx.agrid._countTotal('\" + c.parentNode.idd + \"',\" + c._cellIndex + \"))\");\r\n        if (!this._aggregators) {\r\n            this._aggregators = []\r\n        }\r\n        this._aggregators[c._cellIndex] = \"sum\";\r\n        c._code = e;\r\n        return this._parsing ? \"\" : this._calcSCL(c)\r\n    }\r\n    if (e.indexOf(\"[[\") != -1) {\r\n        var h = /(\\[\\[([^\\,]*)\\,([^\\]]*)]\\])/g;\r\n        dhtmlx.agrid = this;\r\n        l = l || (new Array());\r\n        e = e.replace(h, function(n, m, r, o) {\r\n            if (r == \"-\") {\r\n                r = c.parentNode.idd\r\n            }\r\n            if (r.indexOf(\"#\") == 0) {\r\n                r = dhtmlx.agrid.getRowId(r.replace(\"#\", \"\"))\r\n            }\r\n            l[l.length] = [r, o];\r\n            return '(parseFloat(dhtmlx.agrid.cells(\"' + r + '\",' + o + \").getValue(),10))\"\r\n        })\r\n    }\r\n    if (e.indexOf(\":\") != -1) {\r\n        var h = /:(\\w+)/g;\r\n        dhtmlx.agrid = this;\r\n        var g = c.parentNode.idd;\r\n        l = l || (new Array());\r\n        e = e.replace(h, function(n, m, r, o) {\r\n            l[l.length] = [g, dhtmlx.agrid.getColIndexById(m)];\r\n            return '(parseFloat(dhtmlx.agrid.cells(\"' + g + '\",dhtmlx.agrid.getColIndexById(\"' + m + '\")).getValue(),10))'\r\n        })\r\n    } else {\r\n        var h = /c([0-9]+)/g;\r\n        dhtmlx.agrid = this;\r\n        var g = c.parentNode.idd;\r\n        l = l || (new Array());\r\n        e = e.replace(h, function(n, m, r, o) {\r\n            l[l.length] = [g, m];\r\n            return '(parseFloat(dhtmlx.agrid.cells(\"' + g + '\",' + m + \").getValue(),10))\"\r\n        })\r\n    }\r\n    this._reLink(l, c);\r\n    c._code = e;\r\n    return this._calcSCL(c)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._reLink = function(c, a) {\r\n    if (!c.length) {\r\n        return\r\n    }\r\n    for (var g = 0; g < c.length; g++) {\r\n        if (!this._mat_links[c[g][0]]) {\r\n            this._mat_links[c[g][0]] = {}\r\n        }\r\n        var e = this._mat_links[c[g][0]];\r\n        if (!e[c[g][1]]) {\r\n            e[c[g][1]] = []\r\n        }\r\n        e[c[g][1]].push(a)\r\n    }\r\n}\r\n;\r\nif (_isKHTML) {\r\n    (function() {\r\n        var a = String.prototype.replace;\r\n        String.prototype.replace = function(r, e) {\r\n            if (typeof e != \"function\") {\r\n                return a.apply(this, arguments)\r\n            }\r\n            var h = \"\" + this;\r\n            var n = e;\r\n            if (!(r instanceof RegExp)) {\r\n                var m = h.indexOf(r);\r\n                return ( m == -1 ? h : a.apply(h, [r, n(r, m, h)])) \r\n            }\r\n            var c = r;\r\n            var s = [];\r\n            var l = c.lastIndex;\r\n            var o;\r\n            while ((o = c.exec(h)) != null ) {\r\n                var m = o.index;\r\n                var g = o.concat(m, h);\r\n                s.push(h.slice(l, m), n.apply(null , g).toString());\r\n                if (!c.global) {\r\n                    l += RegExp.lastMatch.length;\r\n                    break\r\n                } else {\r\n                    l = c.lastIndex\r\n                }\r\n            }\r\n            s.push(h.slice(l));\r\n            return s.join(\"\")\r\n        }\r\n    })()\r\n}\r\ndhtmlXGridObject.prototype.insertColumn = function(e, n, r, a, m, o, u, c, h) {\r\n    e = parseInt(e);\r\n    if (e > this._cCount) {\r\n        e = this._cCount\r\n    }\r\n    if (!this._cMod) {\r\n        this._cMod = this._cCount\r\n    }\r\n    this._processAllArrays(this._cCount, e - 1, [(n || \"&nbsp;\"), (a || 100), (r || \"ed\"), (o || \"left\"), (u || \"\"), (m || \"na\"), (h || \"\"), \"\", this._cMod, (a || 100)]);\r\n    this._processAllRows(\"_addColInRow\", e);\r\n    if (typeof (n) == \"object\") {\r\n        for (var l = 1; l < this.hdr.rows.length; l++) {\r\n            if (n[l - 1] == \"#rspan\") {\r\n                var w = l - 1;\r\n                var v = false;\r\n                var s = null ;\r\n                while (!v) {\r\n                    var s = this.hdr.rows[w];\r\n                    for (var g = 0; g < s.cells.length; g++) {\r\n                        if (s.cells[g]._cellIndex == e) {\r\n                            v = g;\r\n                            break\r\n                        }\r\n                    }\r\n                    w--\r\n                }\r\n                this.hdr.rows[w + 1].cells[g].rowSpan = (this.hdr.rows[w].cells[g].rowSpan || 1) + 1\r\n            } else {\r\n                this.setHeaderCol(e, (n[l - 1] || \"&nbsp;\"), l)\r\n            }\r\n        }\r\n    } else {\r\n        this.setHeaderCol(e, (n || \"&nbsp;\"))\r\n    }\r\n    this.hdr.rows[0].cells[e];\r\n    this._cCount++;\r\n    this._cMod++;\r\n    this._master_row = null ;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.deleteColumn = function(a) {\r\n    a = parseInt(a);\r\n    if (this._cCount == 0) {\r\n        return\r\n    }\r\n    if (!this._cMod) {\r\n        this._cMod = this._cCount\r\n    }\r\n    if (a >= this._cCount) {\r\n        return\r\n    }\r\n    this._processAllArrays(a, this._cCount - 1, [null , null , null , null , null , null , null , null , null , null , null ]);\r\n    this._processAllRows(\"_deleteColInRow\", a);\r\n    this._cCount--;\r\n    this._master_row = null ;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._processAllRows = function(h, a, c) {\r\n    this[h](this.obj.rows[0], a, c, 0);\r\n    var g = this.hdr.rows.length;\r\n    for (var e = 0; e < g; e++) {\r\n        this[h](this.hdr.rows[e], a, c, e)\r\n    }\r\n    if (this.ftr) {\r\n        var g = this.ftr.firstChild.rows.length;\r\n        for (var e = 0; e < g; e++) {\r\n            this[h](this.ftr.firstChild.rows[e], a, c, e)\r\n        }\r\n    }\r\n    this.forEachRow(function(l) {\r\n        if (this.rowsAr[l] && this.rowsAr[l].tagName == \"TR\") {\r\n            this[h](this.rowsAr[l], a, c, -1)\r\n        }\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype._processAllArrays = function(r, a, o) {\r\n    var h = [\"hdrLabels\", \"initCellWidth\", \"cellType\", \"cellAlign\", \"cellVAlign\", \"fldSort\", \"columnColor\", \"_hrrar\", \"_c_order\"];\r\n    if (this.cellWidthPX.length) {\r\n        h.push(\"cellWidthPX\")\r\n    }\r\n    if (this.cellWidthPC.length) {\r\n        h.push(\"cellWidthPC\")\r\n    }\r\n    if (this._col_combos) {\r\n        h.push(\"_col_combos\")\r\n    }\r\n    if (this._mCols) {\r\n        h[h.length] = \"_mCols\"\r\n    }\r\n    if (this.columnIds) {\r\n        h[h.length] = \"columnIds\"\r\n    }\r\n    if (this._maskArr) {\r\n        h.push(\"_maskArr\")\r\n    }\r\n    if (this._drsclmW) {\r\n        h.push(\"_drsclmW\")\r\n    }\r\n    if (this._RaSeCol) {\r\n        h.push(\"_RaSeCol\")\r\n    }\r\n    if (this._hm_config) {\r\n        h.push(\"_hm_config\")\r\n    }\r\n    if (this._drsclmn) {\r\n        h.push(\"_drsclmn\")\r\n    }\r\n    if (this.clists) {\r\n        h.push(\"clists\")\r\n    }\r\n    if (this._validators && this._validators.data) {\r\n        h.push(this._validators.data)\r\n    }\r\n    h.push(\"combos\");\r\n    if (this._customSorts) {\r\n        h.push(\"_customSorts\")\r\n    }\r\n    if (this._aggregators) {\r\n        h.push(\"_aggregators\")\r\n    }\r\n    var n = (r <= a);\r\n    if (!this._c_order) {\r\n        this._c_order = new Array();\r\n        var e = this._cCount;\r\n        for (var m = 0; m < e; m++) {\r\n            this._c_order[m] = m\r\n        }\r\n    }\r\n    for (var m = 0; m < h.length; m++) {\r\n        var s = this[h[m]] || h[m];\r\n        if (s) {\r\n            if (n) {\r\n                var c = s[r];\r\n                for (var g = r; g < a; g++) {\r\n                    s[g] = s[g + 1]\r\n                }\r\n                s[a] = c\r\n            } else {\r\n                var c = s[r];\r\n                for (var g = r; g > (a + 1); g--) {\r\n                    s[g] = s[g - 1]\r\n                }\r\n                s[a + 1] = c\r\n            }\r\n            if (o) {\r\n                s[a + (n ? 0 : 1)] = o[m]\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.moveColumn = function(a, c) {\r\n    c--;\r\n    a = parseInt(a);\r\n    c = parseInt(c);\r\n    if (c < a) {\r\n        var e = c + 1\r\n    } else {\r\n        var e = c\r\n    }\r\n    if (!this.callEvent(\"onBeforeCMove\", [a, e])) {\r\n        return false\r\n    }\r\n    if (a == e) {\r\n        return\r\n    }\r\n    this.editStop();\r\n    this._processAllRows(\"_moveColInRow\", a, c);\r\n    this._processAllArrays(a, c);\r\n    if (this.fldSorted) {\r\n        this.setSortImgPos(this.fldSorted._cellIndex)\r\n    }\r\n    this.callEvent(\"onAfterCMove\", [a, e])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._swapColumns = function(c) {\r\n    var e = new Array();\r\n    for (var a = 0; a < this._cCount; a++) {\r\n        var g = c[this._c_order[a]];\r\n        if (typeof (g) == \"undefined\") {\r\n            g = \"\"\r\n        }\r\n        e[a] = g\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXGridObject.prototype._moveColInRow = function(l, a, e) {\r\n    var m = l.childNodes[a];\r\n    var h = l.childNodes[e + 1];\r\n    if (!m) {\r\n        return\r\n    }\r\n    if (h) {\r\n        l.insertBefore(m, h)\r\n    } else {\r\n        l.appendChild(m)\r\n    }\r\n    for (var g = 0; g < l.childNodes.length; g++) {\r\n        l.childNodes[g]._cellIndex = l.childNodes[g]._cellIndexS = g\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._addColInRow = function(n, l, a, g) {\r\n    var h = l;\r\n    if (n._childIndexes) {\r\n        if (n._childIndexes[l - 1] == n._childIndexes[l] || !n.childNodes[n._childIndexes[l - 1]]) {\r\n            for (var e = n._childIndexes.length; e >= l; e--) {\r\n                n._childIndexes[e] = e ? (n._childIndexes[e - 1] + 1) : 0\r\n            }\r\n            n._childIndexes[l]--\r\n        } else {\r\n            for (var e = n._childIndexes.length; e >= l; e--) {\r\n                n._childIndexes[e] = e ? (n._childIndexes[e - 1] + 1) : 0\r\n            }\r\n        }\r\n        var h = n._childIndexes[l]\r\n    }\r\n    var o = n.childNodes[h];\r\n    var m = document.createElement((g) ? \"TD\" : \"TH\");\r\n    if (g) {\r\n        m._attrs = {}\r\n    } else {\r\n        m.style.width = (parseInt(this.cellWidthPX[l]) || \"100\") + \"px\"\r\n    }\r\n    if (o) {\r\n        n.insertBefore(m, o)\r\n    } else {\r\n        n.appendChild(m)\r\n    }\r\n    if (this.dragAndDropOff && n.idd) {\r\n        this.dragger.addDraggableItem(n.childNodes[h], this)\r\n    }\r\n    for (var e = h + 1; e < n.childNodes.length; e++) {\r\n        n.childNodes[e]._cellIndex = n.childNodes[e]._cellIndexS = n.childNodes[e]._cellIndex + 1\r\n    }\r\n    if (n.childNodes[h]) {\r\n        n.childNodes[h]._cellIndex = n.childNodes[h]._cellIndexS = l\r\n    }\r\n    if (n.idd || typeof (n.idd) != \"undefined\") {\r\n        this.cells3(n, l).setValue(\"\");\r\n        m.align = this.cellAlign[l];\r\n        m.style.verticalAlign = this.cellVAlign[l];\r\n        m.bgColor = this.columnColor[l]\r\n    } else {\r\n        if (m.tagName == \"TD\") {\r\n            if (!n.idd && this.forceDivInHeader) {\r\n                m.innerHTML = \"<div class='hdrcell'>&nbsp;</div>\"\r\n            } else {\r\n                m.innerHTML = \"&nbsp;\"\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._deleteColInRow = function(n, m) {\r\n    var e = m;\r\n    if (n._childIndexes) {\r\n        m = n._childIndexes[m]\r\n    }\r\n    var o = n.childNodes[m];\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (o.colSpan && o.colSpan > 1 && o.parentNode.idd) {\r\n        var h = o.colSpan - 1;\r\n        var a = this.cells4(o).getValue();\r\n        this.setColspan(o.parentNode.idd, o._cellIndex, 1);\r\n        if (h > 1) {\r\n            var l = o._cellIndex * 1;\r\n            this.setColspan(o.parentNode.idd, l + 1, h);\r\n            this.cells(o.parentNode.idd, o._cellIndex * 1 + 1).setValue(a);\r\n            n._childIndexes.splice(l, 1);\r\n            for (var g = l; g < n._childIndexes.length; g++) {\r\n                n._childIndexes[g] -= 1\r\n            }\r\n        }\r\n    } else {\r\n        if (n._childIndexes) {\r\n            n._childIndexes.splice(e, 1);\r\n            for (var g = e; g < n._childIndexes.length; g++) {\r\n                n._childIndexes[g]--\r\n            }\r\n        }\r\n    }\r\n    if (o) {\r\n        n.removeChild(o)\r\n    }\r\n    for (var g = m; g < n.childNodes.length; g++) {\r\n        n.childNodes[g]._cellIndex = n.childNodes[g]._cellIndexS = n.childNodes[g]._cellIndex - 1\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableColumnMove = function(c, a) {\r\n    this._mCol = dhx4.s2b(c);\r\n    if (typeof (a) != \"undefined\") {\r\n        this._mCols = a.split(\",\")\r\n    }\r\n    if (!this._mmevTrue) {\r\n        dhtmlxEvent(this.hdr, \"mousedown\", this._startColumnMove);\r\n        dhtmlxEvent(document.body, \"mousemove\", this._onColumnMove);\r\n        dhtmlxEvent(document.body, \"mouseup\", this._stopColumnMove);\r\n        this._mmevTrue = true\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._startColumnMove = function(h) {\r\n    h = h || event;\r\n    var g = h.target || h.srcElement;\r\n    var a = g;\r\n    while (a.tagName != \"TABLE\") {\r\n        a = a.parentNode\r\n    }\r\n    var c = a.grid;\r\n    if (!c) {\r\n        return\r\n    }\r\n    c.setActive();\r\n    if (!c._mCol || h.button == 2) {\r\n        return\r\n    }\r\n    g = c.getFirstParentOfType(g, \"TD\");\r\n    if (g.style.cursor != \"default\") {\r\n        return true\r\n    }\r\n    if ((c) && (!c._colInMove)) {\r\n        c.resized = null ;\r\n        if ((!c._mCols) || (c._mCols[g._cellIndex] == \"true\")) {\r\n            c._colInMove = g._cellIndex + 1\r\n        }\r\n    }\r\n    c._colInMovePos = {\r\n        x: h.clientX,\r\n        y: h.clientY\r\n    };\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype._onColumnMove = function(m) {\r\n    m = m || event;\r\n    var a = window.globalActiveDHTMLGridObject;\r\n    if ((a) && (a._colInMove)) {\r\n        var l = Math.max(Math.abs(m.clientX - a._colInMovePos.x), Math.abs(m.clientY - a._colInMovePos.y));\r\n        if (l < 20) {\r\n            return\r\n        }\r\n        if (a._hideHContext) {\r\n            a._hideHContext()\r\n        }\r\n        if (typeof (a._colInMove) != \"object\") {\r\n            var n = document.createElement(\"DIV\");\r\n            n._aIndex = (a._colInMove - 1);\r\n            n._bIndex = null ;\r\n            n.innerHTML = a.getHeaderCol(n._aIndex);\r\n            n.className = \"dhx_dragColDiv\";\r\n            n.style.position = \"absolute\";\r\n            document.body.appendChild(n);\r\n            a._colInMove = n\r\n        }\r\n        var h = [];\r\n        h[0] = (document.body.scrollLeft || document.documentElement.scrollLeft);\r\n        h[1] = (document.body.scrollTop || document.documentElement.scrollTop);\r\n        a._colInMove.style.left = m.clientX + h[0] + 8 + \"px\";\r\n        a._colInMove.style.top = m.clientY + h[1] + 8 + \"px\";\r\n        var c = m.target || m.srcElement;\r\n        while ((c) && (typeof (c._cellIndexS) == \"undefined\")) {\r\n            c = c.parentNode\r\n        }\r\n        if (a._colInMove._oldHe) {\r\n            a._colInMove._oldHe.className = a._colInMove._oldHe.className.replace(/columnTarget(L|R)/g, \"\");\r\n            a._colInMove._oldHe = null ;\r\n            a._colInMove._bIndex = null \r\n        }\r\n        if (c) {\r\n            if (a.hdr.rows[1]._childIndexes) {\r\n                var g = a.hdr.rows[1].cells[a.hdr.rows[1]._childIndexes[c._cellIndexS]]\r\n            } else {\r\n                var g = a.hdr.rows[1].cells[c._cellIndexS]\r\n            }\r\n            var n = m.clientX - (dhx4.absLeft(g) - a.hdrBox.scrollLeft);\r\n            if (n / g.offsetWidth > 0.5) {\r\n                g.className += \" columnTargetR\";\r\n                a._colInMove._bIndex = c._cellIndexS\r\n            } else {\r\n                g.className += \" columnTargetL\";\r\n                a._colInMove._bIndex = c._cellIndexS - 1\r\n            }\r\n            if (g.offsetLeft < (a.objBox.scrollLeft + 20)) {\r\n                a.objBox.scrollLeft = Math.max(0, g.offsetLeft - 20)\r\n            }\r\n            if ((g.offsetLeft + g.offsetWidth - a.objBox.scrollLeft) > (a.objBox.offsetWidth - 20)) {\r\n                a.objBox.scrollLeft = Math.min(a.objBox.scrollLeft + g.offsetWidth + 20, a.objBox.scrollWidth - a.objBox.offsetWidth)\r\n            }\r\n            a._colInMove._oldHe = g\r\n        }\r\n        m.cancelBubble = true;\r\n        return false\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype._stopColumnMove = function(c) {\r\n    c = c || event;\r\n    var a = window.globalActiveDHTMLGridObject;\r\n    if ((a) && (a._colInMove)) {\r\n        if (typeof (a._colInMove) == \"object\") {\r\n            a._colInMove.parentNode.removeChild(a._colInMove);\r\n            if (a._colInMove._bIndex != null ) {\r\n                a.moveColumn(a._colInMove._aIndex, a._colInMove._bIndex + 1)\r\n            }\r\n            if (a._colInMove._oldHe) {\r\n                a._colInMove._oldHe.className = a._colInMove._oldHe.className.replace(/columnTarget(L|R)/g, \"\")\r\n            }\r\n            a._colInMove._oldHe = null ;\r\n            a._colInMove.grid = null ;\r\n            a.resized = true\r\n        }\r\n        a._colInMove = 0\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype.mouseOverHeader = function(c) {\r\n    var a = this;\r\n    dhtmlxEvent(this.hdr, \"mousemove\", function(h) {\r\n        h = h || window.event;\r\n        var g = h.target || h.srcElement;\r\n        if (g.tagName != \"TD\") {\r\n            g = a.getFirstParentOfType(g, \"TD\")\r\n        }\r\n        if (g && (typeof (g._cellIndex) != \"undefined\")) {\r\n            c(g.parentNode.rowIndex, g._cellIndex)\r\n        }\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.mouseOver = function(c) {\r\n    var a = this;\r\n    dhtmlxEvent(this.obj, \"mousemove\", function(h) {\r\n        h = h || window.event;\r\n        var g = h.target || h.srcElement;\r\n        if (g.tagName != \"TD\") {\r\n            g = a.getFirstParentOfType(g, \"TD\")\r\n        }\r\n        if (g && (typeof (g._cellIndex) != \"undefined\")) {\r\n            c(g.parentNode.rowIndex, g._cellIndex)\r\n        }\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enablePaging = function(l, g, c, h, a, e) {\r\n    this._pgn_parentObj = typeof (h) == \"string\" ? document.getElementById(h) : h;\r\n    this._pgn_recInfoParentObj = typeof (e) == \"string\" ? document.getElementById(e) : e;\r\n    this.pagingOn = l;\r\n    this.showRecInfo = a;\r\n    this.rowsBufferOutSize = parseInt(g);\r\n    this.currentPage = 1;\r\n    this.pagesInGroup = parseInt(c);\r\n    this._init_pgn_events();\r\n    this.setPagingSkin(\"default\")\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setXMLAutoLoading = function(a, c) {\r\n    this.xmlFileUrl = a;\r\n    this._dpref = c\r\n}\r\n;\r\ndhtmlXGridObject.prototype.changePageRelative = function(a) {\r\n    this.changePage(this.currentPage + a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.changePage = function(a) {\r\n    if (arguments.length == 0) {\r\n        a = this.currentPage || 0\r\n    }\r\n    a = parseInt(a);\r\n    a = Math.max(1, Math.min(a, Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize)));\r\n    if (!this.callEvent(\"onBeforePageChanged\", [this.currentPage, a])) {\r\n        return\r\n    }\r\n    this.currentPage = parseInt(a);\r\n    this._reset_view();\r\n    this._fixAlterCss();\r\n    this.callEvent(\"onPageChanged\", this.getStateOfView())\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setPagingSkin = function(a) {\r\n    this._pgn_skin = this[\"_pgn_\" + a];\r\n    if (a == \"toolbar\") {\r\n        this._pgn_skin_tlb = arguments[1]\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setPagingTemplates = function(e, c) {\r\n    this._pgn_templateA = this._pgn_template_compile(e);\r\n    this._pgn_templateB = this._pgn_template_compile(c);\r\n    this._page_skin_update()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._page_skin_update = function(a) {\r\n    if (!this.pagesInGroup) {\r\n        this.pagesInGroup = Math.ceil(Math.min(5, this.rowsBuffer.length / this.rowsBufferOutSize))\r\n    }\r\n    var c = Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize);\r\n    if (c && c < this.currentPage) {\r\n        return this.changePage(c)\r\n    }\r\n    if (this.pagingOn && this._pgn_skin) {\r\n        this._pgn_skin.apply(this, this.getStateOfView())\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._init_pgn_events = function(a) {\r\n    this.attachEvent(\"onXLE\", this._page_skin_update);\r\n    this.attachEvent(\"onClearAll\", this._page_skin_update);\r\n    this.attachEvent(\"onPageChanged\", this._page_skin_update);\r\n    this.attachEvent(\"onGridReconstructed\", this._page_skin_update);\r\n    this._init_pgn_events = function() {}\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_default = function(e, g, a) {\r\n    if (!this.pagingBlock) {\r\n        this.pagingBlock = document.createElement(\"DIV\");\r\n        this.pagingBlock.className = \"pagingBlock\";\r\n        this.recordInfoBlock = document.createElement(\"SPAN\");\r\n        this.recordInfoBlock.className = \"recordsInfoBlock\";\r\n        if (!this._pgn_parentObj) {\r\n            return\r\n        }\r\n        this._pgn_parentObj.appendChild(this.pagingBlock);\r\n        if (this._pgn_recInfoParentObj && this.showRecInfo) {\r\n            this._pgn_recInfoParentObj.appendChild(this.recordInfoBlock)\r\n        }\r\n        if (!this._pgn_templateA) {\r\n            this._pgn_templateA = this._pgn_template_compile(\"[prevpages:&lt;:&nbsp;] [currentpages:,&nbsp;] [nextpages:&gt;:&nbsp;]\");\r\n            this._pgn_templateB = this._pgn_template_compile(\"Results <b>[from]-[to]</b> of <b>[total]</b>\")\r\n        }\r\n    }\r\n    var c = this.getStateOfView();\r\n    this.pagingBlock.innerHTML = this._pgn_templateA.apply(this, c);\r\n    this.recordInfoBlock.innerHTML = this._pgn_templateB.apply(this, c);\r\n    this._pgn_template_active(this.pagingBlock);\r\n    this._pgn_template_active(this.recordInfoBlock);\r\n    this.callEvent(\"onPaging\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_block = function(c) {\r\n    var h = Math.floor((this.currentPage - 1) / this.pagesInGroup) * this.pagesInGroup;\r\n    var a = Math.min(Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize), h + this.pagesInGroup);\r\n    var g = [];\r\n    for (var e = h + 1; e <= a; e++) {\r\n        if (e == this.currentPage) {\r\n            g.push(\"<a class='dhx_not_active'><b>\" + e + \"</b></a>\")\r\n        } else {\r\n            g.push(\"<a onclick='this.grid.changePage(\" + e + \"); return false;'>\" + e + \"</a>\")\r\n        }\r\n    }\r\n    return g.join(c)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_link = function(g, c, e) {\r\n    if (g == \"prevpages\" || g == \"prev\") {\r\n        if (this.currentPage == 1) {\r\n            return e\r\n        }\r\n        return \"<a onclick='this.grid.changePageRelative(-1*\" + (g == \"prev\" ? \"1\" : \"this.grid.pagesInGroup\") + \"); return false;'>\" + c + \"</a>\"\r\n    }\r\n    if (g == \"nextpages\" || g == \"next\") {\r\n        if (this.rowsBuffer.length / this.rowsBufferOutSize <= this.currentPage) {\r\n            return e\r\n        }\r\n        if (this.rowsBuffer.length / (this.rowsBufferOutSize * (g == \"next\" ? \"1\" : this.pagesInGroup)) <= 1) {\r\n            return e\r\n        }\r\n        return \"<a onclick='this.grid.changePageRelative(\" + (g == \"next\" ? \"1\" : \"this.grid.pagesInGroup\") + \"); return false;'>\" + c + \"</a>\"\r\n    }\r\n    if (g == \"current\") {\r\n        var a = this.currentPage + (c ? parseInt(c) : 0);\r\n        if (a < 1 || Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize) < a) {\r\n            return e\r\n        }\r\n        return \"<a \" + (a == this.currentPage ? \"class='dhx_active_page_link' \" : \"\") + \"onclick='this.grid.changePage(\" + a + \"); return false;'>\" + a + \"</a>\"\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_template_active = function(e) {\r\n    var a = e.getElementsByTagName(\"A\");\r\n    if (a) {\r\n        for (var c = 0; c < a.length; c++) {\r\n            a[c].grid = this\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_template_compile = function(a) {\r\n    a = a.replace(/\\[([^\\]]*)\\]/g, function(e, c) {\r\n        c = c.split(\":\");\r\n        switch (c[0]) {\r\n        case \"from\":\r\n            return '\"+(arguments[1]*1+(arguments[2]*1?1:0))+\"';\r\n        case \"total\":\r\n            return '\"+arguments[3]+\"';\r\n        case \"to\":\r\n            return '\"+arguments[2]+\"';\r\n        case \"current\":\r\n        case \"prev\":\r\n        case \"next\":\r\n        case \"prevpages\":\r\n        case \"nextpages\":\r\n            return \"\\\"+this._pgn_link('\" + c[0] + \"','\" + c[1] + \"','\" + c[2] + \"')+\\\"\";\r\n        case \"currentpages\":\r\n            return \"\\\"+this._pgn_block('\" + c[1] + \"')+\\\"\"\r\n        }\r\n    });\r\n    return new Function('return \"' + a + '\";')\r\n}\r\n;\r\ndhtmlXGridObject.prototype.i18n.paging = {\r\n    results: \"Results\",\r\n    records: \"Records from \",\r\n    to: \" to \",\r\n    page: \"Page \",\r\n    perpage: \"rows per page\",\r\n    first: \"To first Page\",\r\n    previous: \"Previous Page\",\r\n    found: \"Found records\",\r\n    next: \"Next Page\",\r\n    last: \"To last Page\",\r\n    of: \" of \",\r\n    notfound: \"No Records Found\"\r\n};\r\ndhtmlXGridObject.prototype.setPagingWTMode = function(a, c, e, g) {\r\n    this._WTDef = [a, c, e, g]\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_bricks = function(n, a, e) {\r\n    var h = (this.skin_name || \"\").split(\"_\")[1];\r\n    var c = \"\";\r\n    if (h == \"light\" || h == \"modern\" || h == \"skyblue\") {\r\n        c = \"_\" + h\r\n    }\r\n    this.pagerElAr = new Array();\r\n    this.pagerElAr.pagerCont = document.createElement(\"DIV\");\r\n    this.pagerElAr.pagerBord = document.createElement(\"DIV\");\r\n    this.pagerElAr.pagerLine = document.createElement(\"DIV\");\r\n    this.pagerElAr.pagerBox = document.createElement(\"DIV\");\r\n    this.pagerElAr.pagerInfo = document.createElement(\"DIV\");\r\n    this.pagerElAr.pagerInfoBox = document.createElement(\"DIV\");\r\n    var m = (this.globalBox || this.objBox);\r\n    this.pagerElAr.pagerCont.style.width = m.clientWidth + \"px\";\r\n    this.pagerElAr.pagerCont.style.overflow = \"hidden\";\r\n    this.pagerElAr.pagerCont.style.clear = \"both\";\r\n    this.pagerElAr.pagerBord.className = \"dhx_pbox\" + c;\r\n    this.pagerElAr.pagerLine.className = \"dhx_pline\" + c;\r\n    this.pagerElAr.pagerBox.style.clear = \"both\";\r\n    this.pagerElAr.pagerInfo.className = \"dhx_pager_info\" + c;\r\n    this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerBord);\r\n    this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerLine);\r\n    this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerInfo);\r\n    this.pagerElAr.pagerLine.appendChild(this.pagerElAr.pagerBox);\r\n    this.pagerElAr.pagerInfo.appendChild(this.pagerElAr.pagerInfoBox);\r\n    this._pgn_parentObj.innerHTML = \"\";\r\n    this._pgn_parentObj.appendChild(this.pagerElAr.pagerCont);\r\n    if (this.rowsBuffer.length > 0) {\r\n        var l = 20;\r\n        var u = 22;\r\n        if (n > this.pagesInGroup) {\r\n            var r = document.createElement(\"DIV\");\r\n            var o = document.createElement(\"DIV\");\r\n            r.className = \"dhx_page\" + c;\r\n            o.innerHTML = \"&larr;\";\r\n            r.appendChild(o);\r\n            this.pagerElAr.pagerBox.appendChild(r);\r\n            var s = this;\r\n            r.pgnum = (Math.ceil(n / this.pagesInGroup) - 1) * this.pagesInGroup;\r\n            r.onclick = function() {\r\n                s.changePage(this.pgnum)\r\n            }\r\n            ;\r\n            l += u\r\n        }\r\n        for (var g = 1; g <= this.pagesInGroup; g++) {\r\n            var r = document.createElement(\"DIV\");\r\n            var o = document.createElement(\"DIV\");\r\n            r.className = \"dhx_page\" + c;\r\n            pageNumber = ((Math.ceil(n / this.pagesInGroup) - 1) * this.pagesInGroup) + g;\r\n            if (pageNumber > Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize)) {\r\n                break\r\n            }\r\n            o.innerHTML = pageNumber;\r\n            r.appendChild(o);\r\n            if (n == pageNumber) {\r\n                r.className += \" dhx_page_active\" + c;\r\n                o.className = \"dhx_page_active\" + c\r\n            } else {\r\n                var s = this;\r\n                r.pgnum = pageNumber;\r\n                r.onclick = function() {\r\n                    s.changePage(this.pgnum)\r\n                }\r\n            }\r\n            l += (parseInt(u / 3) * pageNumber.toString().length) + 15;\r\n            o.style.width = (parseInt(u / 3) * pageNumber.toString().length) + 8 + \"px\";\r\n            this.pagerElAr.pagerBox.appendChild(r)\r\n        }\r\n        if (Math.ceil(n / this.pagesInGroup) * this.pagesInGroup < Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize)) {\r\n            var r = document.createElement(\"DIV\");\r\n            var o = document.createElement(\"DIV\");\r\n            r.className = \"dhx_page\" + c;\r\n            o.innerHTML = \"&rarr;\";\r\n            r.appendChild(o);\r\n            this.pagerElAr.pagerBox.appendChild(r);\r\n            var s = this;\r\n            r.pgnum = (Math.ceil(n / this.pagesInGroup) * this.pagesInGroup) + 1;\r\n            r.onclick = function() {\r\n                s.changePage(this.pgnum)\r\n            }\r\n            ;\r\n            l += u\r\n        }\r\n        this.pagerElAr.pagerLine.style.width = l + \"px\"\r\n    }\r\n    if (this.rowsBuffer.length > 0 && this.showRecInfo) {\r\n        this.pagerElAr.pagerInfoBox.innerHTML = this.i18n.paging.records + (a + 1) + this.i18n.paging.to + e + this.i18n.paging.of + this.rowsBuffer.length\r\n    } else {\r\n        if (this.rowsBuffer.length == 0) {\r\n            this.pagerElAr.pagerLine.parentNode.removeChild(this.pagerElAr.pagerLine);\r\n            this.pagerElAr.pagerInfoBox.innerHTML = this.i18n.paging.notfound\r\n        }\r\n    }\r\n    this.pagerElAr.pagerBox.appendChild(document.createElement(\"SPAN\")).innerHTML = \"&nbsp;\";\r\n    this.pagerElAr.pagerBord.appendChild(document.createElement(\"SPAN\")).innerHTML = \"&nbsp;\";\r\n    this.pagerElAr.pagerCont.appendChild(document.createElement(\"SPAN\")).innerHTML = \"&nbsp;\";\r\n    this.callEvent(\"onPaging\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_toolbar = function(l, m, c) {\r\n    if (!this.aToolBar) {\r\n        this.aToolBar = this._pgn_createToolBar()\r\n    }\r\n    var h = Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize);\r\n    if (this._WTDef[0]) {\r\n        this.aToolBar.enableItem(\"right\");\r\n        this.aToolBar.enableItem(\"rightabs\");\r\n        this.aToolBar.enableItem(\"left\");\r\n        this.aToolBar.enableItem(\"leftabs\");\r\n        if (this.currentPage >= h) {\r\n            this.aToolBar.disableItem(\"right\");\r\n            this.aToolBar.disableItem(\"rightabs\")\r\n        }\r\n        if (this.currentPage == 1) {\r\n            this.aToolBar.disableItem(\"left\");\r\n            this.aToolBar.disableItem(\"leftabs\")\r\n        }\r\n    }\r\n    if (this._WTDef[2]) {\r\n        var g = this;\r\n        this.aToolBar.forEachListOption(\"pages\", function(n) {\r\n            g.aToolBar.removeListOption(\"pages\", n)\r\n        });\r\n        var a = {\r\n            dhx_skyblue: 4,\r\n            dhx_web: 0,\r\n            dhx_terrace: 14\r\n        }[this.aToolBar.conf.skin];\r\n        for (var e = 0; e < h; e++) {\r\n            this.aToolBar.addListOption(\"pages\", \"pages_\" + (e + 1), NaN, \"button\", \"<span style='padding: 0px \" + a + \"px 0px 0px;'>\" + this.i18n.paging.page + (e + 1) + \"</span>\", \"paging_page.gif\")\r\n        }\r\n        this.aToolBar.setItemText(\"pages\", this.i18n.paging.page + l)\r\n    }\r\n    if (this._WTDef[1]) {\r\n        if (!this.getRowsNum()) {\r\n            this.aToolBar.setItemText(\"results\", this.i18n.paging.notfound)\r\n        } else {\r\n            this.aToolBar.setItemText(\"results\", \"<div style='width:100%; text-align:center'>\" + this.i18n.paging.records + (m + 1) + this.i18n.paging.to + c + \"</div>\")\r\n        }\r\n    }\r\n    if (this._WTDef[3]) {\r\n        this.aToolBar.setItemText(\"perpagenum\", this.rowsBufferOutSize.toString() + \" \" + this.i18n.paging.perpage)\r\n    }\r\n    this.callEvent(\"onPaging\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._pgn_createToolBar = function() {\r\n    this.aToolBar = new dhtmlXToolbarObject({\r\n        parent: this._pgn_parentObj,\r\n        skin: (this._pgn_skin_tlb || this.skin_name),\r\n        icons_path: this.imgURL\r\n    });\r\n    if (!this._WTDef) {\r\n        this.setPagingWTMode(true, true, true, true)\r\n    }\r\n    var g = this;\r\n    this.aToolBar.attachEvent(\"onClick\", function(h) {\r\n        h = h.split(\"_\");\r\n        switch (h[0]) {\r\n        case \"leftabs\":\r\n            g.changePage(1);\r\n            break;\r\n        case \"left\":\r\n            g.changePage(g.currentPage - 1);\r\n            break;\r\n        case \"rightabs\":\r\n            g.changePage(99999);\r\n            break;\r\n        case \"right\":\r\n            g.changePage(g.currentPage + 1);\r\n            break;\r\n        case \"perpagenum\":\r\n            if (h[1] === this.undefined) {\r\n                return\r\n            }\r\n            g.rowsBufferOutSize = parseInt(h[1]);\r\n            g.changePage();\r\n            g.aToolBar.setItemText(\"perpagenum\", h[1] + \" \" + g.i18n.paging.perpage);\r\n            break;\r\n        case \"pages\":\r\n            if (h[1] === this.undefined) {\r\n                return\r\n            }\r\n            g.changePage(h[1]);\r\n            g.aToolBar.setItemText(\"pages\", g.i18n.paging.page + h[1]);\r\n            break\r\n        }\r\n    });\r\n    if (this._WTDef[0]) {\r\n        this.aToolBar.addButton(\"leftabs\", NaN, null , \"ar_left_abs.gif\", \"ar_left_abs_dis.gif\");\r\n        this.aToolBar.addButton(\"left\", NaN, null , \"ar_left.gif\", \"ar_left_dis.gif\")\r\n    }\r\n    if (this._WTDef[1]) {\r\n        this.aToolBar.addText(\"results\", NaN, this.i18n.paging.results);\r\n        this.aToolBar.setWidth(\"results\", \"150\");\r\n        this.aToolBar.disableItem(\"results\")\r\n    }\r\n    if (this._WTDef[0]) {\r\n        this.aToolBar.addButton(\"right\", NaN, null , \"ar_right.gif\", \"ar_right_dis.gif\");\r\n        this.aToolBar.addButton(\"rightabs\", NaN, null , \"ar_right_abs.gif\", \"ar_right_abs_dis.gif\")\r\n    }\r\n    if (this._WTDef[2]) {\r\n        if (this.aToolBar.conf.skin == \"dhx_terrace\") {\r\n            this.aToolBar.addSeparator()\r\n        }\r\n        this.aToolBar.addButtonSelect(\"pages\", NaN, \"select page\", [], \"paging_pages.gif\", null , false, true)\r\n    }\r\n    var a;\r\n    if (a = this._WTDef[3]) {\r\n        if (this.aToolBar.conf.skin == \"dhx_terrace\") {\r\n            this.aToolBar.addSeparator()\r\n        }\r\n        this.aToolBar.addButtonSelect(\"perpagenum\", NaN, \"select size\", [], \"paging_rows.gif\", null , false, true);\r\n        if (typeof a != \"object\") {\r\n            a = [5, 10, 15, 20, 25, 30]\r\n        }\r\n        var c = {\r\n            dhx_skyblue: 4,\r\n            dhx_web: 0,\r\n            dhx_terrace: 18\r\n        }[this.aToolBar.conf.skin];\r\n        for (var e = 0; e < a.length; e++) {\r\n            this.aToolBar.addListOption(\"perpagenum\", \"perpagenum_\" + a[e], NaN, \"button\", \"<span style='padding: 0px \" + c + \"px 0px 0px;'>\" + a[e] + \" \" + this.i18n.paging.perpage + \"</span>\", \"paging_page.gif\")\r\n        }\r\n    }\r\n    return this.aToolBar\r\n}\r\n;\r\ndhtmlXGridObject.prototype.post = function(a, c, g, e) {\r\n    this.callEvent(\"onXLS\", [this]);\r\n    if (arguments.length == 2 && typeof g != \"function\") {\r\n        e = g;\r\n        g = null \r\n    }\r\n    e = e || \"xml\";\r\n    if (!this.xmlFileUrl) {\r\n        this.xmlFileUrl = a\r\n    }\r\n    this._data_type = e;\r\n    this.xmlLoader = this.doLoadDetails;\r\n    var h = this;\r\n    this.xmlLoader = function(l) {\r\n        if (!h.callEvent) {\r\n            return\r\n        }\r\n        h[\"_process_\" + e](l.xmlDoc);\r\n        if (!h._contextCallTimer) {\r\n            h.callEvent(\"onXLE\", [h, 0, 0, l.xmlDoc])\r\n        }\r\n        if (g) {\r\n            g();\r\n            g = null \r\n        }\r\n    }\r\n    ;\r\n    dhx4.ajax.post(a, (c || \"\"), this.xmlLoader)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setRowspan = function(s, v, h) {\r\n    var u = this[this._bfs_cells ? \"_bfs_cells\" : \"cells\"](s, v).cell;\r\n    var a = this.rowsAr[s];\r\n    if (u.rowSpan && u.rowSpan != 1) {\r\n        var l = a.nextSibling;\r\n        for (var n = 1; n < u.rowSpan; n++) {\r\n            var m = l.childNodes[l._childIndexes[u._cellIndex + 1]];\r\n            var e = document.createElement(\"TD\");\r\n            e.innerHTML = \"&nbsp;\";\r\n            e._cellIndex = u._cellIndex;\r\n            e._clearCell = true;\r\n            if (m) {\r\n                m.parentNode.insertBefore(e, m)\r\n            } else {\r\n                l.parentNode.appendChild(e)\r\n            }\r\n            this._shiftIndexes(l, u._cellIndex, -1);\r\n            l = l.nextSibling\r\n        }\r\n    }\r\n    u.rowSpan = h;\r\n    if (!this._h2) {\r\n        a = a.nextSibling || this.rowsCol[this.rowsCol._dhx_find(a) + 1]\r\n    } else {\r\n        a = this.rowsAr[this._h2.get[a.idd].parent.childs[this._h2.get[a.idd].index + 1].id]\r\n    }\r\n    var g = [];\r\n    for (var n = 1; n < h; n++) {\r\n        var o = null ;\r\n        if (this._fake && !this._realfake) {\r\n            o = this._bfs_cells3(a, v).cell\r\n        } else {\r\n            o = this.cells3(a, v).cell\r\n        }\r\n        this._shiftIndexes(a, u._cellIndex, 1);\r\n        if (o) {\r\n            o.parentNode.removeChild(o)\r\n        }\r\n        g.push(a);\r\n        if (!this._h2) {\r\n            a = a.nextSibling || this.rowsCol[this.rowsCol._dhx_find(a) + 1]\r\n        } else {\r\n            var a = this._h2.get[a.idd].parent.childs[this._h2.get[a.idd].index + 1];\r\n            if (a) {\r\n                a = this.rowsAr[a.id]\r\n            }\r\n        }\r\n    }\r\n    this.rowsAr[s]._rowSpan = this.rowsAr[s]._rowSpan || {};\r\n    this.rowsAr[s]._rowSpan[v] = g;\r\n    if (this._fake && !this._realfake && v < this._fake._cCount) {\r\n        this._fake.setRowspan(s, v, h)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._shiftIndexes = function(a, g, c) {\r\n    if (!a._childIndexes) {\r\n        a._childIndexes = new Array();\r\n        for (var e = 0; e < a.childNodes.length; e++) {\r\n            a._childIndexes[e] = e\r\n        }\r\n    }\r\n    for (var e = 0; e < a._childIndexes.length; e++) {\r\n        if (e > g) {\r\n            a._childIndexes[e] = a._childIndexes[e] - c\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableRowspan = function() {\r\n    this._erspan = true;\r\n    this.enableRowspan = function() {}\r\n    ;\r\n    this.attachEvent(\"onAfterSorting\", function() {\r\n        if (this._dload) {\r\n            return\r\n        }\r\n        for (var h = 1; h < this.obj.rows.length; h++) {\r\n            if (this.obj.rows[h]._rowSpan) {\r\n                var a = this.obj.rows[h];\r\n                for (var l in a._rowSpan) {\r\n                    var o = a;\r\n                    var c = o._rowSpan[l];\r\n                    for (var e = 0; e < c.length; e++) {\r\n                        if (o.nextSibling) {\r\n                            o.parentNode.insertBefore(c[e], o.nextSibling)\r\n                        } else {\r\n                            o.parentNode.appendChild(c[e])\r\n                        }\r\n                        if (this._fake) {\r\n                            var g = this._fake.rowsAr[o.idd];\r\n                            var m = this._fake.rowsAr[c[e].idd];\r\n                            if (g.nextSibling) {\r\n                                g.parentNode.insertBefore(m, g.nextSibling)\r\n                            } else {\r\n                                g.parentNode.appendChild(m)\r\n                            }\r\n                            this._correctRowHeight(o.idd)\r\n                        }\r\n                        o = o.nextSibling\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var n = this.rowsCol.stablesort;\r\n        this.rowsCol = new dhtmlxArray();\r\n        this.rowsCol.stablesort = n;\r\n        for (var h = 1; h < this.obj.rows.length; h++) {\r\n            this.rowsCol.push(this.obj.rows[h])\r\n        }\r\n    });\r\n    this.attachEvent(\"onXLE\", function(g, e, r, l) {\r\n        for (var m = 0; m < this.rowsBuffer.length; m++) {\r\n            var o = this.render_row(m);\r\n            var n = o.childNodes;\r\n            for (var h = 0; h < n.length; h++) {\r\n                if (n[h]._attrs.rowspan) {\r\n                    this.setRowspan(o.idd, n[h]._cellIndex, n[h]._attrs.rowspan)\r\n                }\r\n            }\r\n        }\r\n    })\r\n}\r\n;\r\ndhx4.attachEvent(\"onGridCreated\", function(a) {\r\n    if (a._split_later) {\r\n        a.splitAt(a._split_later)\r\n    }\r\n});\r\ndhtmlXGridObject.prototype.splitAt = function(m) {\r\n    if (!this.obj.rows[0]) {\r\n        return this._split_later = m\r\n    }\r\n    m = parseInt(m);\r\n    var x = document.createElement(\"DIV\");\r\n    this.entBox.appendChild(x);\r\n    var y = document.createElement(\"DIV\");\r\n    this.entBox.appendChild(y);\r\n    for (var v = this.entBox.childNodes.length - 3; v >= 0; v--) {\r\n        y.insertBefore(this.entBox.childNodes[v], y.firstChild)\r\n    }\r\n    this.entBox.style.position = \"relative\";\r\n    this.globalBox = this.entBox;\r\n    this.entBox = y;\r\n    y.grid = this;\r\n    x.style.cssText += \"border:0px solid red !important;\";\r\n    y.style.cssText += \"border:0px solid red !important;\";\r\n    y.style.top = \"0px\";\r\n    y.style.position = \"absolute\";\r\n    x.style.position = \"absolute\";\r\n    x.style.top = \"0px\";\r\n    x.style.left = \"0px\";\r\n    x.style.zIndex = 11;\r\n    y.style.height = x.style.height = this.globalBox.clientHeight;\r\n    this._fake = new dhtmlXGridObject(x);\r\n    this.globalBox = this._fake.globalBox = this.globalBox;\r\n    this._fake._fake = this;\r\n    this._fake._realfake = true;\r\n    this._treeC = this.cellType._dhx_find(\"tree\");\r\n    this._fake.delim = this.delim;\r\n    this._fake.customGroupFormat = this.customGroupFormat;\r\n    this._fake.setImagesPath(this._imgURL);\r\n    this._fake.iconURL = this.iconURL;\r\n    this._fake._customSorts = this._customSorts;\r\n    this._fake.noHeader = this.noHeader;\r\n    this._fake._enbTts = this._enbTts;\r\n    this._fake._drsclmW = this._drsclmW;\r\n    this._fake._htkebl = this._htkebl;\r\n    this._fake.clists = this.clists;\r\n    this._fake.fldSort = new Array();\r\n    this._fake.selMultiRows = this.selMultiRows;\r\n    this._fake.multiLine = this.multiLine;\r\n    this._fake._key_events = this._key_events;\r\n    this._fake.smartTabOrder = this.smartTabOrder;\r\n    if (this.multiLine || this._erspan) {\r\n        this.attachEvent(\"onCellChanged\", this._correctRowHeight);\r\n        this.attachEvent(\"onRowAdded\", this._correctRowHeight);\r\n        var c = function() {\r\n            this.forEachRow(function(D) {\r\n                this._correctRowHeight(D)\r\n            })\r\n        }\r\n        ;\r\n        this.attachEvent(\"onPageChanged\", c);\r\n        this.attachEvent(\"onXLE\", c);\r\n        this.attachEvent(\"onResizeEnd\", c);\r\n        if (!this._ads_count) {\r\n            this.attachEvent(\"onAfterSorting\", c)\r\n        }\r\n        if (this._srnd) {\r\n            this.attachEvent(\"onFilterEnd\", c)\r\n        }\r\n        this.attachEvent(\"onDistributedEnd\", c)\r\n    }\r\n    this.attachEvent(\"onGridReconstructed\", function() {\r\n        this._fake.objBox.scrollTop = this.objBox.scrollTop\r\n    });\r\n    this._fake.loadedKidsHash = this.loadedKidsHash;\r\n    if (this._h2) {\r\n        this._fake._h2 = this._h2\r\n    }\r\n    this._fake._dInc = this._dInc;\r\n    var n = [[], [], [], [], [], [], []];\r\n    var s = [\"hdrLabels\", \"initCellWidth\", \"cellType\", \"cellAlign\", \"cellVAlign\", \"fldSort\", \"columnColor\"];\r\n    var h = [\"setHeader\", \"setInitWidths\", \"setColTypes\", \"setColAlign\", \"setColVAlign\", \"setColSorting\", \"setColumnColor\"];\r\n    this._fake.callEvent = function() {\r\n        var D = true;\r\n        this._fake._split_event = true;\r\n        var E = (arguments[0] == \"onScroll\");\r\n        if (arguments[0] == \"onGridReconstructed\" || E) {\r\n            this._fake.callEvent.apply(this, arguments)\r\n        }\r\n        if (!E) {\r\n            D = this._fake.callEvent.apply(this._fake, arguments)\r\n        }\r\n        this._fake._split_event = false;\r\n        return D\r\n    }\r\n    ;\r\n    if (this._elmn) {\r\n        this._fake.enableLightMouseNavigation(true)\r\n    }\r\n    if (this.__cssEven || this._cssUnEven) {\r\n        this._fake.attachEvent(\"onGridReconstructed\", function() {\r\n            this._fixAlterCss()\r\n        })\r\n    }\r\n    this._fake._cssEven = this._cssEven;\r\n    this._fake._cssUnEven = this._cssUnEven;\r\n    this._fake._cssSP = this._cssSP;\r\n    this._fake.isEditable = this.isEditable;\r\n    this._fake._edtc = this._edtc;\r\n    if (this._sst) {\r\n        this._fake.enableStableSorting(true)\r\n    }\r\n    this._fake._sclE = this._sclE;\r\n    this._fake._dclE = this._dclE;\r\n    this._fake._f2kE = this._f2kE;\r\n    this._fake._maskArr = this._maskArr;\r\n    this._fake._dtmask = this._dtmask;\r\n    this._fake.combos = this.combos;\r\n    var o = 0;\r\n    var a = this.globalBox.offsetWidth;\r\n    for (var v = 0; v < m; v++) {\r\n        for (var u = 0; u < s.length; u++) {\r\n            if (this[s[u]]) {\r\n                n[u][v] = this[s[u]][v]\r\n            }\r\n            if (typeof n[u][v] == \"string\") {\r\n                n[u][v] = n[u][v].replace(new RegExp(\"\\\\\" + this.delim,\"g\"), \"\\\\\" + this.delim)\r\n            }\r\n        }\r\n        if (_isFF) {\r\n            n[1][v] = n[1][v] * 1\r\n        }\r\n        if (this.cellWidthType == \"%\") {\r\n            n[1][v] = Math.round(parseInt(this[s[1]][v]) * a / 100);\r\n            o += n[1][v]\r\n        } else {\r\n            o += parseInt(this[s[1]][v])\r\n        }\r\n        this.setColumnHidden(v, true)\r\n    }\r\n    for (var u = 0; u < s.length; u++) {\r\n        var r = n[u].join(this.delim);\r\n        if (h[u] != \"setHeader\") {\r\n            if (r != \"\") {\r\n                this._fake[h[u]](r)\r\n            }\r\n        } else {\r\n            this._fake[h[u]](r, null , this._hstyles)\r\n        }\r\n    }\r\n    this._fake._strangeParams = this._strangeParams;\r\n    this._fake._drsclmn = this._drsclmn;\r\n    o = Math.min(this.globalBox.offsetWidth, o);\r\n    y.style.left = o + \"px\";\r\n    x.style.width = o + \"px\";\r\n    y.style.width = Math.max(this.globalBox.offsetWidth - o, 0);\r\n    if (this._ecspn) {\r\n        this._fake._ecspn = true\r\n    }\r\n    this._fake.init();\r\n    if (this.dragAndDropOff) {\r\n        this.dragger.addDragLanding(this._fake.entBox, this)\r\n    }\r\n    this._fake.objBox.style.overflow = \"hidden\";\r\n    if (!dhtmlx.$customScroll) {\r\n        this._fake.objBox.style.overflowX = \"scroll\"\r\n    } else {\r\n        this._fake.objBox._custom_scroll_mode = \"\"\r\n    }\r\n    this._fake._srdh = this._srdh || 20;\r\n    this._fake._srnd = this._srnd;\r\n    var A = this;\r\n    function C(F) {\r\n        var E = F.wheelDelta / -40;\r\n        if (F.wheelDelta === window.undefined) {\r\n            E = F.detail\r\n        }\r\n        var D = A.objBox;\r\n        D.scrollTop += E * 40;\r\n        if (F.preventDefault) {\r\n            F.preventDefault()\r\n        }\r\n    }\r\n    dhtmlxEvent(this._fake.objBox, \"mousewheel\", C);\r\n    dhtmlxEvent(this._fake.objBox, \"DOMMouseScroll\", C);\r\n    function g(E, D) {\r\n        D.style.whiteSpace = \"\";\r\n        var I = D.nextSibling;\r\n        var F = D.parentNode;\r\n        E.parentNode.insertBefore(D, E);\r\n        if (!I) {\r\n            F.appendChild(E)\r\n        } else {\r\n            F.insertBefore(E, I)\r\n        }\r\n        var H = E.style.display;\r\n        E.style.display = D.style.display;\r\n        D.style.display = H\r\n    }\r\n    function w(L, T, M, E) {\r\n        var F = (new Array(m)).join(this.delim);\r\n        var N = [];\r\n        if (L == 2) {\r\n            for (var J = 0; J < m; J++) {\r\n                var D = T[L - 1].cells[T[L - 1]._childIndexes ? T[L - 1]._childIndexes[J] : J];\r\n                if (D.rowSpan && D.rowSpan > 1) {\r\n                    N[D._cellIndex] = D.rowSpan - 1;\r\n                    E[L - 1].cells[E[L - 1]._childIndexes ? E[L - 1]._childIndexes[J] : J].rowSpan = D.rowSpan;\r\n                    D.rowSpan = 1\r\n                }\r\n            }\r\n        }\r\n        for (L; L < T.length; L++) {\r\n            this._fake.attachHeader(F, null , M);\r\n            E = E || this._fake.ftr.childNodes[0].rows;\r\n            var Q = m;\r\n            var H = 0;\r\n            for (var K = 0; K < Q; K++) {\r\n                if (N[K]) {\r\n                    N[K] = N[K] - 1;\r\n                    if (_isIE || _isOpera) {\r\n                        var I = document.createElement(\"TD\");\r\n                        if (_isFF) {\r\n                            I.style.display = \"none\"\r\n                        }\r\n                        T[L].insertBefore(I, T[L].cells[0])\r\n                    }\r\n                    H++;\r\n                    continue\r\n                }\r\n                var P = E[L].cells[K - H];\r\n                var O = T[L].cells[K - (_isIE ? 0 : H)];\r\n                var S = O.rowSpan;\r\n                g(P, O);\r\n                if (S > 1) {\r\n                    N[K] = S - 1;\r\n                    O.rowSpan = S\r\n                }\r\n                if (E[L].cells[K].colSpan > 1) {\r\n                    T[L].cells[K].colSpan = E[L].cells[K].colSpan;\r\n                    Q -= E[L].cells[K].colSpan - 1;\r\n                    for (var J = 1; J < E[L].cells[K].colSpan; J++) {\r\n                        E[L].removeChild(E[L].cells[K + 1])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (this.hdr.rows.length > 2) {\r\n        w.call(this, 2, this.hdr.rows, \"_aHead\", this._fake.hdr.rows)\r\n    }\r\n    if (this.ftr) {\r\n        w.call(this, 1, this.ftr.childNodes[0].rows, \"_aFoot\");\r\n        this._fake.ftr.parentNode.style.bottom = (_isFF ? 2 : 1) + \"px\"\r\n    }\r\n    if (this.saveSizeToCookie) {\r\n        this.saveSizeToCookie = function(E, D) {\r\n            if (this._realfake) {\r\n                return this._fake.saveSizeToCookie.apply(this._fake, arguments)\r\n            }\r\n            if (!E) {\r\n                E = this.entBox.id\r\n            }\r\n            var H = new Array();\r\n            var I = \"cellWidthPX\";\r\n            for (var F = 0; F < this[I].length; F++) {\r\n                if (F < m) {\r\n                    H[F] = this._fake[I][F]\r\n                } else {\r\n                    H[F] = this[I][F]\r\n                }\r\n            }\r\n            H = H.join(\",\");\r\n            this.setCookie(E, D, 0, H);\r\n            var H = (this.initCellWidth || (new Array)).join(\",\");\r\n            this.setCookie(E, D, 1, H);\r\n            return true\r\n        }\r\n        ;\r\n        this.loadSizeFromCookie = function(D) {\r\n            if (!D) {\r\n                D = this.entBox.id\r\n            }\r\n            var I = this._getCookie(D, 1);\r\n            if (!I) {\r\n                return\r\n            }\r\n            this.initCellWidth = I.split(\",\");\r\n            var I = this._getCookie(D, 0);\r\n            var J = \"cellWidthPX\";\r\n            this.cellWidthType = \"px\";\r\n            var F = 0;\r\n            if ((I) && (I.length)) {\r\n                I = I.split(\",\");\r\n                for (var E = 0; E < I.length; E++) {\r\n                    if (E < m) {\r\n                        this._fake[J][E] = I[E];\r\n                        F += I[E] * 1\r\n                    } else {\r\n                        this[J][E] = I[E]\r\n                    }\r\n                }\r\n            }\r\n            this._fake.entBox.style.width = F + \"px\";\r\n            this._fake.objBox.style.width = F + \"px\";\r\n            var H = this.globalBox.childNodes[1];\r\n            H.style.left = F - (_isFF ? 0 : 0) + \"px\";\r\n            if (this.ftr) {\r\n                this.ftr.style.left = F - (_isFF ? 0 : 0) + \"px\"\r\n            }\r\n            H.style.width = this.globalBox.offsetWidth - F + \"px\";\r\n            this.setSizes();\r\n            return true\r\n        }\r\n        ;\r\n        this._fake.onRSE = this.onRSE\r\n    }\r\n    this.setCellTextStyleA = this.setCellTextStyle;\r\n    this.setCellTextStyle = function(E, F, D) {\r\n        if (F < m) {\r\n            this._fake.setCellTextStyle(E, F, D)\r\n        }\r\n        this.setCellTextStyleA(E, F, D)\r\n    }\r\n    ;\r\n    this.setRowTextBoldA = this.setRowTextBold;\r\n    this.setRowTextBold = function(D) {\r\n        this.setRowTextBoldA(D);\r\n        this._fake.setRowTextBold(D)\r\n    }\r\n    ;\r\n    this.setRowColorA = this.setRowColor;\r\n    this.setRowColor = function(E, D) {\r\n        this.setRowColorA(E, D);\r\n        this._fake.setRowColor(E, D)\r\n    }\r\n    ;\r\n    this.setRowHiddenA = this.setRowHidden;\r\n    this.setRowHidden = function(E, D) {\r\n        this.setRowHiddenA(E, D);\r\n        this._fake.setRowHidden(E, D)\r\n    }\r\n    ;\r\n    this.setRowTextNormalA = this.setRowTextNormal;\r\n    this.setRowTextNormal = function(D) {\r\n        this.setRowTextNormalA(D);\r\n        this._fake.setRowTextNormal(D)\r\n    }\r\n    ;\r\n    this.getChangedRows = function(F) {\r\n        var D = new Array();\r\n        function E(I) {\r\n            for (var H = 0; H < I.childNodes.length; H++) {\r\n                if (I.childNodes[H].wasChanged) {\r\n                    return D[D.length] = I.idd\r\n                }\r\n            }\r\n        }\r\n        this.forEachRow(function(J) {\r\n            var I = this.rowsAr[J];\r\n            var H = this._fake.rowsAr[J];\r\n            if (I.tagName != \"TR\" || !H || H.tagName != \"TR\") {\r\n                return\r\n            }\r\n            if (F && I._added) {\r\n                D[D.length] = I.idd\r\n            } else {\r\n                if (!E(I)) {\r\n                    E(H)\r\n                }\r\n            }\r\n        });\r\n        return D.join(this.delim)\r\n    }\r\n    ;\r\n    this.setRowTextStyleA = this.setRowTextStyle;\r\n    this.setRowTextStyle = function(E, D) {\r\n        this.setRowTextStyleA(E, D);\r\n        if (this._fake.rowsAr[E]) {\r\n            this._fake.setRowTextStyle(E, D)\r\n        }\r\n    }\r\n    ;\r\n    this.lockRowA = this.lockRow;\r\n    this.lockRow = function(E, D) {\r\n        this.lockRowA(E, D);\r\n        this._fake.lockRow(E, D)\r\n    }\r\n    ;\r\n    this.getColWidth = function(D) {\r\n        if (D < m) {\r\n            return parseInt(this._fake.cellWidthPX[D])\r\n        } else {\r\n            return parseInt(this.cellWidthPX[D])\r\n        }\r\n    }\r\n    ;\r\n    this.getColumnLabel = function(D) {\r\n        return this._fake.getColumnLabel.apply(((D < m) ? this._fake : this), arguments)\r\n    }\r\n    ;\r\n    this.setColWidthA = this._fake.setColWidthA = this.setColWidth;\r\n    this.setColWidth = function(D, E) {\r\n        D = D * 1;\r\n        if (D < m) {\r\n            this._fake.setColWidthA(D, E)\r\n        } else {\r\n            this.setColWidthA(D, E)\r\n        }\r\n        if ((D + 1) <= m) {\r\n            this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth, this._fake.obj.offsetWidth))\r\n        }\r\n    }\r\n    ;\r\n    this.adjustColumnSizeA = this.adjustColumnSize;\r\n    this.setColumnLabelA = this.setColumnLabel;\r\n    this.setColumnLabel = function(E, D, I, H) {\r\n        var F = this;\r\n        if (E < m) {\r\n            F = this._fake\r\n        }\r\n        return this.setColumnLabelA.apply(F, [E, D, I, H])\r\n    }\r\n    ;\r\n    this.adjustColumnSize = function(D, E) {\r\n        if (D < m) {\r\n            if (_isIE) {\r\n                this._fake.obj.style.tableLayout = \"\"\r\n            }\r\n            this._fake.adjustColumnSize(D, E);\r\n            if (_isIE) {\r\n                this._fake.obj.style.tableLayout = \"fixed\"\r\n            }\r\n            this._fake._correctSplit()\r\n        } else {\r\n            return this.adjustColumnSizeA(D, E)\r\n        }\r\n    }\r\n    ;\r\n    var e = \"cells\";\r\n    this._bfs_cells = this[e];\r\n    this[e] = function() {\r\n        if (arguments[1] < m) {\r\n            return this._fake.cells.apply(this._fake, arguments)\r\n        } else {\r\n            return this._bfs_cells.apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    this._bfs_isColumnHidden = this.isColumnHidden;\r\n    this.isColumnHidden = function() {\r\n        if (parseInt(arguments[0]) < m) {\r\n            return this._fake.isColumnHidden.apply(this._fake, arguments)\r\n        } else {\r\n            return this._bfs_isColumnHidden.apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    this._bfs_setColumnHidden = this.setColumnHidden;\r\n    this.setColumnHidden = function() {\r\n        if (parseInt(arguments[0]) < m) {\r\n            this._fake.setColumnHidden.apply(this._fake, arguments);\r\n            return this._fake._correctSplit()\r\n        } else {\r\n            return this._bfs_setColumnHidden.apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    var e = \"cells2\";\r\n    this._bfs_cells2 = this[e];\r\n    this[e] = function() {\r\n        if (arguments[1] < m) {\r\n            return this._fake.cells2.apply(this._fake, arguments)\r\n        } else {\r\n            return this._bfs_cells2.apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    var e = \"cells3\";\r\n    this._bfs_cells3 = this[e];\r\n    this[e] = function(E, D) {\r\n        if (arguments[1] < m && this._fake.rowsAr[arguments[0].idd]) {\r\n            if (this._fake.rowsAr[E.idd] && this._fake.rowsAr[E.idd].childNodes.length == 0) {\r\n                return this._bfs_cells3.apply(this, arguments)\r\n            }\r\n            arguments[0] = arguments[0].idd;\r\n            return this._fake.cells.apply(this._fake, arguments)\r\n        } else {\r\n            return this._bfs_cells3.apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    var e = \"changeRowId\";\r\n    this._bfs_changeRowId = this[e];\r\n    this[e] = function() {\r\n        this._bfs_changeRowId.apply(this, arguments);\r\n        if (this._fake.rowsAr[arguments[0]]) {\r\n            this._fake.changeRowId.apply(this._fake, arguments)\r\n        }\r\n    }\r\n    ;\r\n    this._fake.getRowById = function(F) {\r\n        var E = this.rowsAr[F];\r\n        if (!E && this._fake.rowsAr[F]) {\r\n            E = this._fake.getRowById(F)\r\n        }\r\n        if (E) {\r\n            if (E.tagName != \"TR\") {\r\n                for (var D = 0; D < this.rowsBuffer.length; D++) {\r\n                    if (this.rowsBuffer[D] && this.rowsBuffer[D].idd == F) {\r\n                        return this.render_row(D)\r\n                    }\r\n                }\r\n                if (this._h2) {\r\n                    return this.render_row(null , E.idd)\r\n                }\r\n            }\r\n            return E\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    if (this.collapseKids) {\r\n        this._fake._bfs_collapseKids = this.collapseKids;\r\n        this._fake.collapseKids = function() {\r\n            return this._fake.collapseKids.apply(this._fake, [this._fake.rowsAr[arguments[0].idd]])\r\n        }\r\n        ;\r\n        this[\"_bfs_collapseKids\"] = this.collapseKids;\r\n        this[\"collapseKids\"] = function() {\r\n            var D = this[\"_bfs_collapseKids\"].apply(this, arguments);\r\n            this._fake._h2syncModel();\r\n            if (!this._cssSP) {\r\n                this._fake._fixAlterCss()\r\n            }\r\n        }\r\n        ;\r\n        this._fake._bfs_expandKids = this.expandKids;\r\n        this._fake.expandKids = function() {\r\n            this._fake.expandKids.apply(this._fake, [this._fake.rowsAr[arguments[0].idd]]);\r\n            if (!this._cssSP) {\r\n                this._fake._fixAlterCss()\r\n            }\r\n        }\r\n        ;\r\n        this[\"_bfs_expandAll\"] = this.expandAll;\r\n        this[\"expandAll\"] = function() {\r\n            this._bfs_expandAll();\r\n            this._fake._h2syncModel();\r\n            if (!this._cssSP) {\r\n                this._fake._fixAlterCss()\r\n            }\r\n        }\r\n        ;\r\n        this[\"_bfs_collapseAll\"] = this.collapseAll;\r\n        this[\"collapseAll\"] = function() {\r\n            this._bfs_collapseAll();\r\n            this._fake._h2syncModel();\r\n            if (!this._cssSP) {\r\n                this._fake._fixAlterCss()\r\n            }\r\n        }\r\n        ;\r\n        this[\"_bfs_expandKids\"] = this.expandKids;\r\n        this[\"expandKids\"] = function() {\r\n            var D = this[\"_bfs_expandKids\"].apply(this, arguments);\r\n            this._fake._h2syncModel();\r\n            if (!this._cssSP) {\r\n                this._fake._fixAlterCss()\r\n            }\r\n        }\r\n        ;\r\n        this._fake._h2syncModel = function() {\r\n            if (this._fake.pagingOn) {\r\n                this._fake._renderSort()\r\n            } else {\r\n                this._renderSort()\r\n            }\r\n        }\r\n        ;\r\n        this._updateTGRState = function(D) {\r\n            return this._fake._updateTGRState(D)\r\n        }\r\n    }\r\n    if (this._elmnh) {\r\n        this._setRowHoverA = this._fake._setRowHoverA = this._setRowHover;\r\n        this._unsetRowHoverA = this._fake._unsetRowHoverA = this._unsetRowHover;\r\n        this._setRowHover = this._fake._setRowHover = function() {\r\n            var D = this.grid;\r\n            D._setRowHoverA.apply(this, arguments);\r\n            var E = (_isIE ? event.srcElement : arguments[0].target);\r\n            E = D._fake.rowsAr[D.getFirstParentOfType(E, \"TD\").parentNode.idd];\r\n            if (E) {\r\n                D._fake._setRowHoverA.apply(D._fake.obj, [{\r\n                    target: E.childNodes[0]\r\n                }, arguments[1]])\r\n            }\r\n        }\r\n        ;\r\n        this._unsetRowHover = this._fake._unsetRowHover = function() {\r\n            if (arguments[1]) {\r\n                var D = this\r\n            } else {\r\n                var D = this.grid\r\n            }\r\n            D._unsetRowHoverA.apply(this, arguments);\r\n            D._fake._unsetRowHoverA.apply(D._fake.obj, arguments)\r\n        }\r\n        ;\r\n        this._fake.enableRowsHover(true, this._hvrCss);\r\n        this.enableRowsHover(false);\r\n        this.enableRowsHover(true, this._fake._hvrCss)\r\n    }\r\n    this._updateTGRState = function(D) {\r\n        if (!D.update || D.id == 0) {\r\n            return\r\n        }\r\n        if (this.rowsAr[D.id].imgTag) {\r\n            this.rowsAr[D.id].imgTag.src = this.iconTree + D.state + \".gif\"\r\n        }\r\n        if (this._fake.rowsAr[D.id] && this._fake.rowsAr[D.id].imgTag) {\r\n            this._fake.rowsAr[D.id].imgTag.src = this.iconTree + D.state + \".gif\"\r\n        }\r\n        D.update = false\r\n    }\r\n    ;\r\n    this.copy_row = function(I) {\r\n        var D = I.cloneNode(true);\r\n        D._skipInsert = I._skipInsert;\r\n        var J = m;\r\n        D._attrs = {};\r\n        D._css = I._css;\r\n        if (this._ecspn) {\r\n            J = 0;\r\n            for (var H = 0; (J < D.childNodes.length && H < m) ; H += (D.childNodes[J].colSpan || 1)) {\r\n                J++\r\n            }\r\n        }\r\n        while (D.childNodes.length > J) {\r\n            D.removeChild(D.childNodes[D.childNodes.length - 1])\r\n        }\r\n        var F = J;\r\n        for (var H = 0; H < F; H++) {\r\n            if (this.dragAndDropOff) {\r\n                this.dragger.addDraggableItem(D.childNodes[H], this)\r\n            }\r\n            D.childNodes[H].style.display = (this._fake._hrrar ? (this._fake._hrrar[H] ? \"none\" : \"\") : \"\");\r\n            D.childNodes[H]._cellIndex = H;\r\n            D.childNodes[H].combo_value = arguments[0].childNodes[H].combo_value;\r\n            D.childNodes[H]._clearCell = arguments[0].childNodes[H]._clearCell;\r\n            D.childNodes[H]._cellType = arguments[0].childNodes[H]._cellType;\r\n            D.childNodes[H]._brval = arguments[0].childNodes[H]._brval;\r\n            D.childNodes[H].val = arguments[0].childNodes[H].val;\r\n            D.childNodes[H]._combo = arguments[0].childNodes[H]._combo;\r\n            D.childNodes[H]._attrs = arguments[0].childNodes[H]._attrs;\r\n            D.childNodes[H].chstate = arguments[0].childNodes[H].chstate;\r\n            if (I._attrs.style) {\r\n                D.childNodes[H].style.cssText = I._attrs.style + \";\" + D.childNodes[H].style.cssText\r\n            }\r\n            if (D.childNodes[H].colSpan > 1) {\r\n                D._childIndexes = arguments[0]._childIndexes\r\n            }\r\n        }\r\n        if (this._h2 && this._treeC < m) {\r\n            var E = this._h2.get[arguments[0].idd];\r\n            D.imgTag = D.childNodes[this._treeC].childNodes[0].childNodes[E.level];\r\n            D.valTag = D.childNodes[this._treeC].childNodes[0].childNodes[E.level + 2]\r\n        }\r\n        D.idd = I.idd;\r\n        D.grid = this._fake;\r\n        return D\r\n    }\r\n    ;\r\n    var e = \"_insertRowAt\";\r\n    this._bfs_insertRowAt = this[e];\r\n    this[e] = function() {\r\n        var E = this[\"_bfs_insertRowAt\"].apply(this, arguments);\r\n        arguments[0] = this.copy_row(arguments[0]);\r\n        var D = this._fake._insertRowAt.apply(this._fake, arguments);\r\n        if (E._fhd) {\r\n            D.parentNode.removeChild(D);\r\n            this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(D));\r\n            E._fhd = false\r\n        }\r\n        return E\r\n    }\r\n    ;\r\n    this._bfs_setSizes = this.setSizes;\r\n    this.setSizes = function() {\r\n        if (this._notresize) {\r\n            return\r\n        }\r\n        this._bfs_setSizes(this, arguments);\r\n        this.sync_headers();\r\n        if (this.sync_scroll() && this._ahgr) {\r\n            this.setSizes()\r\n        }\r\n        var D = this.dontSetSizes ? (this.entBox.offsetHeight + \"px\") : this.entBox.style.height;\r\n        this._fake.entBox.style.height = D;\r\n        this._fake.objBox.style.height = this.objBox.style.height;\r\n        this._fake.hdrBox.style.height = this.hdrBox.style.height;\r\n        this._fake.objBox.scrollTop = this.objBox.scrollTop;\r\n        this._fake.setColumnSizes(this._fake.entBox.clientWidth);\r\n        this.globalBox.style.width = parseInt(this.entBox.style.width) + parseInt(this._fake.entBox.style.width);\r\n        if (!this.dontSetSizes) {\r\n            this.globalBox.style.height = D\r\n        }\r\n    }\r\n    ;\r\n    this.sync_scroll = this._fake.sync_scroll = function(E) {\r\n        var D = this.objBox.style.overflowX;\r\n        if (this.obj.offsetWidth <= this.objBox.offsetWidth) {\r\n            if (!E) {\r\n                return this._fake.sync_scroll(true)\r\n            }\r\n            this.objBox.style.overflowX = \"hidden\";\r\n            this._fake.objBox.style.overflowX = \"hidden\"\r\n        } else {\r\n            if (!dhtmlx.$customScroll) {\r\n                this.objBox.style.overflowX = \"scroll\";\r\n                this._fake.objBox.style.overflowX = \"scroll\"\r\n            }\r\n        }\r\n        return D != this.objBox.style.overflowX\r\n    }\r\n    ;\r\n    this.sync_headers = this._fake.sync_headers = function() {\r\n        if (this.noHeader || (this._fake.hdr.scrollHeight == this.hdr.offsetHeight) || this.noHeaderResize) {\r\n            return\r\n        }\r\n        for (var E = 1; E < this.hdr.rows.length; E++) {\r\n            var I = m;\r\n            while (!this.hdr.rows[E].childNodes[I]) {\r\n                I--\r\n            }\r\n            var D = Math.min(this.hdr.rows[E].childNodes[I].scrollHeight + 2, this.hdr.rows[E].scrollHeight);\r\n            var H = this._fake.hdr.rows[E].scrollHeight;\r\n            if (D != H) {\r\n                this._fake.hdr.rows[E].style.height = this.hdr.rows[E].style.height = Math.max(D, H) + \"px\"\r\n            }\r\n            if (window._KHTMLrv) {\r\n                var F = 0;\r\n                while (this._fake._hrrar[F]) {\r\n                    F++\r\n                }\r\n                this._fake.hdr.rows[E].childNodes[F].style.height = this.hdr.rows[E].childNodes[I].style.height = Math.max(D, H) + \"px\"\r\n            }\r\n        }\r\n        this._fake.sync_headers\r\n    }\r\n    ;\r\n    this._fake._bfs_setSizes = this._fake.setSizes;\r\n    this._fake.setSizes = function() {\r\n        if (this._fake._notresize) {\r\n            return\r\n        }\r\n        this._fake.setSizes()\r\n    }\r\n    ;\r\n    var e = \"_doOnScroll\";\r\n    this._bfs__doOnScroll = this[e];\r\n    this[e] = function() {\r\n        this._bfs__doOnScroll.apply(this, arguments);\r\n        this._fake.objBox.scrollTop = this.objBox.scrollTop;\r\n        this._fake._doOnScroll.apply(this._fake, arguments)\r\n    }\r\n    ;\r\n    var e = \"selectAll\";\r\n    this._bfs__selectAll = this[e];\r\n    this[e] = function() {\r\n        this._bfs__selectAll.apply(this, arguments);\r\n        this._bfs__selectAll.apply(this._fake, arguments)\r\n    }\r\n    ;\r\n    var e = \"doClick\";\r\n    this._bfs_doClick = this[e];\r\n    this[e] = function() {\r\n        this[\"_bfs_doClick\"].apply(this, arguments);\r\n        if (arguments[0].tagName == \"TD\") {\r\n            var D = (arguments[0]._cellIndex >= m);\r\n            if (!arguments[0].parentNode.idd) {\r\n                return\r\n            }\r\n            if (!D) {\r\n                arguments[0].className = arguments[0].className.replace(/cellselected/g, \"\")\r\n            }\r\n            if (!this._fake.rowsAr[arguments[0].parentNode.idd]) {\r\n                this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd))\r\n            }\r\n            arguments[0] = this._fake.cells(arguments[0].parentNode.idd, (D ? 0 : arguments[0]._cellIndex)).cell;\r\n            if (D) {\r\n                this._fake.cell = null \r\n            }\r\n            this._fake._bfs_doClick.apply(this._fake, arguments);\r\n            if (D) {\r\n                this._fake.cell = this.cell\r\n            } else {\r\n                this.cell = this._fake.cell\r\n            }\r\n            if (this._fake.onRowSelectTime) {\r\n                clearTimeout(this._fake.onRowSelectTime)\r\n            }\r\n            if (D) {\r\n                arguments[0].className = arguments[0].className.replace(/cellselected/g, \"\");\r\n                globalActiveDHTMLGridObject = this;\r\n                this._fake.cell = this.cell\r\n            } else {\r\n                this.objBox.scrollTop = this._fake.objBox.scrollTop\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._fake._bfs_doClick = this._fake[e];\r\n    this._fake[e] = function() {\r\n        this[\"_bfs_doClick\"].apply(this, arguments);\r\n        if (arguments[0].tagName == \"TD\") {\r\n            var D = (arguments[0]._cellIndex < m);\r\n            if (!arguments[0].parentNode.idd) {\r\n                return\r\n            }\r\n            arguments[0] = this._fake._bfs_cells(arguments[0].parentNode.idd, (D ? m : arguments[0]._cellIndex)).cell;\r\n            this._fake.cell = null ;\r\n            this._fake._bfs_doClick.apply(this._fake, arguments);\r\n            this._fake.cell = this.cell;\r\n            if (this._fake.onRowSelectTime) {\r\n                clearTimeout(this._fake.onRowSelectTime)\r\n            }\r\n            if (D) {\r\n                arguments[0].className = arguments[0].className.replace(/cellselected/g, \"\");\r\n                globalActiveDHTMLGridObject = this;\r\n                this._fake.cell = this.cell;\r\n                this._fake.objBox.scrollTop = this.objBox.scrollTop\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.clearSelectionA = this.clearSelection;\r\n    this.clearSelection = function(D) {\r\n        if (D) {\r\n            this._fake.clearSelection()\r\n        }\r\n        this.clearSelectionA()\r\n    }\r\n    ;\r\n    this.moveRowUpA = this.moveRowUp;\r\n    this.moveRowUp = function(D) {\r\n        if (!this._h2) {\r\n            this._fake.moveRowUp(D)\r\n        }\r\n        this.moveRowUpA(D);\r\n        if (this._h2) {\r\n            this._fake._h2syncModel()\r\n        }\r\n    }\r\n    ;\r\n    this.moveRowDownA = this.moveRowDown;\r\n    this.moveRowDown = function(D) {\r\n        if (!this._h2) {\r\n            this._fake.moveRowDown(D)\r\n        }\r\n        this.moveRowDownA(D);\r\n        if (this._h2) {\r\n            this._fake._h2syncModel()\r\n        }\r\n    }\r\n    ;\r\n    this._fake.getUserData = function() {\r\n        return this._fake.getUserData.apply(this._fake, arguments)\r\n    }\r\n    ;\r\n    this._fake.setUserData = function() {\r\n        return this._fake.setUserData.apply(this._fake, arguments)\r\n    }\r\n    ;\r\n    this.getSortingStateA = this.getSortingState;\r\n    this.getSortingState = function() {\r\n        var D = this.getSortingStateA();\r\n        if (D.length != 0) {\r\n            return D\r\n        }\r\n        return this._fake.getSortingState()\r\n    }\r\n    ;\r\n    this.setSortImgStateA = this._fake.setSortImgStateA = this.setSortImgState;\r\n    this.setSortImgState = function(E, D, H, F) {\r\n        this.setSortImgStateA(E, D, H, F);\r\n        if (D * 1 < m) {\r\n            this._fake.setSortImgStateA(E, D, H, F);\r\n            this.setSortImgStateA(false)\r\n        } else {\r\n            this._fake.setSortImgStateA(false)\r\n        }\r\n    }\r\n    ;\r\n    this._fake.doColResizeA = this._fake.doColResize;\r\n    this._fake.doColResize = function(I, H, F, D, K) {\r\n        var E = -1;\r\n        var J = 0;\r\n        if (arguments[1]._cellIndex == (m - 1)) {\r\n            E = this._initalSplR + (I.clientX - D);\r\n            if (!this._initalSplF) {\r\n                this._initalSplF = arguments[3] + this.objBox.scrollWidth - this.objBox.offsetWidth\r\n            }\r\n            if (this.objBox.scrollWidth == this.objBox.offsetWidth && (this._fake.alter_split_resize || (I.clientX - D) > 0)) {\r\n                arguments[3] = (this._initalSplF || arguments[3]);\r\n                J = this.doColResizeA.apply(this, arguments)\r\n            } else {\r\n                J = this.doColResizeA.apply(this, arguments)\r\n            }\r\n        } else {\r\n            if (this.obj.offsetWidth < this.entBox.offsetWidth) {\r\n                E = this.obj.offsetWidth\r\n            }\r\n            J = this.doColResizeA.apply(this, arguments)\r\n        }\r\n        if (J !== false) {\r\n            this._correctSplit(E);\r\n            this.resized = this._fake.resized = 1\r\n        }\r\n        return J\r\n    }\r\n    ;\r\n    this._fake.changeCursorState = function(F) {\r\n        var E = F.target || F.srcElement;\r\n        if (E.tagName != \"TD\") {\r\n            E = this.getFirstParentOfType(E, \"TD\")\r\n        }\r\n        if ((E.tagName == \"TD\") && (this._drsclmn) && (!this._drsclmn[E._cellIndex])) {\r\n            return\r\n        }\r\n        var D = (F.layerX || 0) + (((!_isIE) && (F.target.tagName == \"DIV\")) ? E.offsetLeft : 0);\r\n        var H = parseInt(this.getPosition(E, this.hdrBox));\r\n        if (((E.offsetWidth - (F.offsetX || (H - D) * -1)) < (_isOpera ? 20 : 10)) || ((this.entBox.offsetWidth - (F.offsetX ? (F.offsetX + E.offsetLeft) : D) + this.objBox.scrollLeft - 0) < (_isOpera ? 20 : 10))) {\r\n            E.style.cursor = \"E-resize\"\r\n        } else {\r\n            E.style.cursor = \"default\"\r\n        }\r\n        if (_isOpera) {\r\n            this.hdrBox.scrollLeft = this.objBox.scrollLeft\r\n        }\r\n    }\r\n    ;\r\n    this._fake.startColResizeA = this._fake.startColResize;\r\n    this._fake.startColResize = function(E) {\r\n        var F = this.startColResizeA(E);\r\n        this._initalSplR = this.entBox.offsetWidth;\r\n        this._initalSplF = null ;\r\n        if (this.entBox.onmousemove) {\r\n            var D = this.entBox.parentNode;\r\n            if (D._aggrid) {\r\n                return F\r\n            }\r\n            D._aggrid = D.grid;\r\n            D.grid = this;\r\n            this.entBox.parentNode.onmousemove = this.entBox.onmousemove;\r\n            this.entBox.onmousemove = null \r\n        }\r\n        return F\r\n    }\r\n    ;\r\n    this._fake.stopColResizeA = this._fake.stopColResize;\r\n    this._fake.stopColResize = function(E) {\r\n        if (this.entBox.parentNode.onmousemove) {\r\n            var D = this.entBox.parentNode;\r\n            D.grid = D._aggrid;\r\n            D._aggrid = null ;\r\n            this.entBox.onmousemove = this.entBox.parentNode.onmousemove;\r\n            this.entBox.parentNode.onmousemove = null ;\r\n            if (this.obj.offsetWidth < this.entBox.offsetWidth) {\r\n                this._correctSplit(this.obj.offsetWidth)\r\n            }\r\n        }\r\n        return this.stopColResizeA(E)\r\n    }\r\n    ;\r\n    this.doKeyA = this.doKey;\r\n    this._fake.doKeyA = this._fake.doKey;\r\n    function l(K, J, D, M) {\r\n        var E = M.shiftKey ? -1 : 1;\r\n        var F = M.shiftKey ? -1 : D._cCount;\r\n        var I = false;\r\n        for (var H = K + E; H != F; H += E) {\r\n            if (D.smartTabOrder) {\r\n                I = D.cells2(J, H).isDisabled() ? false : H\r\n            } else {\r\n                I = H\r\n            }\r\n            if (I !== false) {\r\n                var L = !D._key_events.k_other;\r\n                D.selectCell(J, I, false, false, L, true);\r\n                M.cancelBubble = true;\r\n                if (M.preventDefault) {\r\n                    M.preventDefault()\r\n                }\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    this._fake.doKey = this.doKey = function(I) {\r\n        if (!I) {\r\n            return true\r\n        }\r\n        if (this._htkebl) {\r\n            return true\r\n        }\r\n        if ((I.target || I.srcElement).value !== window.undefined) {\r\n            var E = (I.target || I.srcElement);\r\n            if ((!E.parentNode) || (E.parentNode.className.indexOf(\"editable\") == -1)) {\r\n                return true\r\n            }\r\n        }\r\n        switch (I.keyCode) {\r\n        case 9:\r\n            var H = this._realfake ? this._fake : this;\r\n            if (!H.callEvent(\"onTab\", [true])) {\r\n                return true\r\n            }\r\n            if (this.cell) {\r\n                var F = this.cell._cellIndex;\r\n                var D = H.getRowIndex(this.cell.parentNode.idd);\r\n                while (!l(F, D, H, I)) {\r\n                    D += (I.shiftKey ? -1 : 1);\r\n                    if (D < 0 || D >= H.rowsBuffer.length) {\r\n                        return\r\n                    }\r\n                    F = I.shiftKey ? H._cCount : -1\r\n                }\r\n                return\r\n            }\r\n            break\r\n        }\r\n        return this.doKeyA(I)\r\n    }\r\n    ;\r\n    this.editCellA = this.editCell;\r\n    this.editCell = function() {\r\n        if (this.cell && this.cell.parentNode.grid != this) {\r\n            return this._fake.editCell()\r\n        }\r\n        return this.editCellA()\r\n    }\r\n    ;\r\n    this.deleteRowA = this.deleteRow;\r\n    this.deleteRow = function(D, E) {\r\n        if (this.deleteRowA(D, E) === false) {\r\n            return false\r\n        }\r\n        if (this._fake.rowsAr[D]) {\r\n            this._fake.deleteRow(D)\r\n        }\r\n    }\r\n    ;\r\n    this.clearAllA = this.clearAll;\r\n    this.clearAll = function() {\r\n        this.clearAllA();\r\n        this._fake.clearAll()\r\n    }\r\n    ;\r\n    this.editStopA = this.editStop;\r\n    this.editStop = function(D) {\r\n        if (this._fake.editor) {\r\n            this._fake.editStop(D)\r\n        } else {\r\n            this.editStopA(D)\r\n        }\r\n    }\r\n    ;\r\n    this.attachEvent(\"onAfterSorting\", function(E, D, F) {\r\n        if (E >= m) {\r\n            this._fake.setSortImgState(false)\r\n        }\r\n    });\r\n    this._fake.sortField = function(E, D, H) {\r\n        this._fake.sortField.call(this._fake, E, D, this._fake.hdr.rows[0].cells[E]);\r\n        if (this.fldSort[E] != \"na\" && this._fake.fldSorted) {\r\n            var F = this._fake.getSortingState()[1];\r\n            this._fake.setSortImgState(false);\r\n            this.setSortImgState(true, arguments[0], F)\r\n        }\r\n    }\r\n    ;\r\n    this.sortTreeRowsA = this.sortTreeRows;\r\n    this._fake.sortTreeRowsA = this._fake.sortTreeRows;\r\n    this.sortTreeRows = this._fake.sortTreeRows = function(F, H, D, E) {\r\n        if (this._realfake) {\r\n            return this._fake.sortTreeRows(F, H, D, E)\r\n        }\r\n        this.sortTreeRowsA(F, H, D, E);\r\n        this._fake._h2syncModel();\r\n        this._fake.setSortImgStateA(false);\r\n        this._fake.fldSorted = null \r\n    }\r\n    ;\r\n    this._fake._fillers = [];\r\n    this._fake.rowsBuffer = this.rowsBuffer;\r\n    this.attachEvent(\"onClearAll\", function() {\r\n        this._fake.rowsBuffer = this.rowsBuffer\r\n    });\r\n    this._add_filler_s = this._add_filler;\r\n    this._add_filler = function(E, D, I, F) {\r\n        if (!this._fake._fillers) {\r\n            this._fake._fillers = []\r\n        }\r\n        if (this._realfake || !F) {\r\n            var H;\r\n            if (I && I.idd) {\r\n                H = this._fake.rowsAr[I.idd]\r\n            } else {\r\n                if (I && I.nextSibling) {\r\n                    H = {};\r\n                    H.nextSibling = this._fake.rowsAr[I.nextSibling.idd];\r\n                    H.parentNode = H.nextSibling.parentNode\r\n                } else {\r\n                    if (this._fake._fillers.length) {\r\n                        H = this._fake._fillers[this._fake._fillers.length - 1][2]\r\n                    }\r\n                }\r\n            }\r\n            this._fake._fillers.push(this._fake._add_filler(E, D, H))\r\n        }\r\n        return this._add_filler_s.apply(this, arguments)\r\n    }\r\n    ;\r\n    this._add_from_buffer_s = this._add_from_buffer;\r\n    this._add_from_buffer = function() {\r\n        var D = this._add_from_buffer_s.apply(this, arguments);\r\n        if (D != -1) {\r\n            this._fake._add_from_buffer.apply(this._fake, arguments);\r\n            if (this.multiLine) {\r\n                this._correctRowHeight(this.rowsBuffer[arguments[0]].idd)\r\n            }\r\n        }\r\n        return D\r\n    }\r\n    ;\r\n    this._fake.render_row = function(D) {\r\n        var E = this._fake.render_row(D);\r\n        if (E == -1) {\r\n            return -1\r\n        }\r\n        if (E) {\r\n            return this.rowsAr[E.idd] = this.rowsAr[E.idd] || this._fake.copy_row(E)\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this._reset_view_s = this._reset_view;\r\n    this._reset_view = function() {\r\n        this._fake._reset_view(true);\r\n        this._fake._fillers = [];\r\n        this._reset_view_s()\r\n    }\r\n    ;\r\n    this.moveColumn_s = this.moveColumn;\r\n    this.moveColumn = function(E, D) {\r\n        if (D >= m) {\r\n            return this.moveColumn_s(E, D)\r\n        }\r\n    }\r\n    ;\r\n    this.attachEvent(\"onCellChanged\", function(I, F, H) {\r\n        if (this._split_event && F < m && this.rowsAr[I]) {\r\n            var D = this._fake.rowsAr[I];\r\n            if (!D) {\r\n                return\r\n            }\r\n            if (D._childIndexes) {\r\n                D = D.childNodes[D._childIndexes[F]]\r\n            } else {\r\n                D = D.childNodes[F]\r\n            }\r\n            var E = this.rowsAr[I].childNodes[F];\r\n            if (E._treeCell && E.firstChild.lastChild) {\r\n                E.firstChild.lastChild.innerHTML = H\r\n            } else {\r\n                E.innerHTML = D.innerHTML\r\n            }\r\n            E._clearCell = false;\r\n            E.combo_value = D.combo_value;\r\n            E.chstate = D.chstate\r\n        }\r\n    });\r\n    this._fake.combos = this.combos;\r\n    this.setSizes();\r\n    if (this.rowsBuffer[0]) {\r\n        this._reset_view()\r\n    }\r\n    this.attachEvent(\"onXLE\", function() {\r\n        this._fake._correctSplit()\r\n    });\r\n    this._fake._correctSplit()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._correctSplit = function(c) {\r\n    c = c || (this.obj.scrollWidth - this.objBox.scrollLeft);\r\n    c = Math.min(this.globalBox.offsetWidth, c);\r\n    if (c > -1) {\r\n        this.entBox.style.width = c + \"px\";\r\n        this.objBox.style.width = c + \"px\";\r\n        var g = (this.globalBox.offsetWidth - this.globalBox.clientWidth) / 2;\r\n        this._fake.entBox.style.left = c + \"px\";\r\n        this._fake.entBox.style.width = Math.max(0, this.globalBox.offsetWidth - c - (this.quirks ? 0 : 2) * g) + \"px\";\r\n        if (this._fake.ftr) {\r\n            this._fake.ftr.parentNode.style.width = this._fake.entBox.style.width\r\n        }\r\n        if (_isIE) {\r\n            var e = _isIE && !window.xmlHttpRequest;\r\n            var g = (this.globalBox.offsetWidth - this.globalBox.clientWidth);\r\n            this._fake.hdrBox.style.width = this._fake.objBox.style.width = Math.max(0, this.globalBox.offsetWidth - (e ? g : 0) - c) + \"px\"\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._correctRowHeight = function(o, m) {\r\n    if (!this.rowsAr[o] || !this._fake.rowsAr[o]) {\r\n        return\r\n    }\r\n    var l = this.rowsAr[o].offsetHeight;\r\n    var e = this._fake.rowsAr[o].offsetHeight;\r\n    var a = Math.max(l, e) - (this.rowsAr[o].delta_fix || 0);\r\n    if (!a) {\r\n        return\r\n    }\r\n    this.rowsAr[o].style.height = this._fake.rowsAr[o].style.height = Math.round(a + 1) + \"px\";\r\n    this.rowsAr[o].delta_fix = 1;\r\n    if (window._KHTMLrv) {\r\n        var c = this._fake._cCount;\r\n        var n;\r\n        while (!n && c >= 0) {\r\n            n = this.rowsAr[o].childNodes[c];\r\n            c -= 1\r\n        }\r\n        var g = this._fake.rowsAr[o].firstChild;\r\n        if (n && g) {\r\n            n.style.height = g.style.height = a + \"px\";\r\n            n.style.boxSizing = g.style.boxSizing = \"border-box\"\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableAutoSizeSaving = function(c, a) {\r\n    this.attachEvent(\"onResizeEnd\", function() {\r\n        this.saveSizeToCookie(c, a)\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.saveOpenStates = function(c, a) {\r\n    if (!c) {\r\n        c = this.entBox.id\r\n    }\r\n    var e = [];\r\n    this._h2.forEachChild(0, function(h) {\r\n        if (h.state == \"minus\") {\r\n            e.push(h.id)\r\n        }\r\n    });\r\n    var g = \"gridOpen\" + (c || \"\") + \"=\" + e.join(\"|\") + (a ? (\"; \" + a) : \"\");\r\n    document.cookie = g\r\n}\r\n;\r\ndhtmlXGridObject.prototype.loadOpenStates = function(e, a) {\r\n    var h = this.getCookie(e, \"gridOpen\");\r\n    if (!h) {\r\n        return\r\n    }\r\n    h = h.split(\"|\");\r\n    for (var g = 0; g < h.length; g++) {\r\n        var c = this.getParentId(h[g]);\r\n        if (!this.getOpenState(c)) {\r\n            continue\r\n        }\r\n        this.openItem(h[g])\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableAutoHiddenColumnsSaving = function(c, a) {\r\n    this.attachEvent(\"onColumnHidden\", function() {\r\n        this.saveHiddenColumnsToCookie(c, a)\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableSortingSaving = function(c, a) {\r\n    this.attachEvent(\"onBeforeSorting\", function() {\r\n        var e = this;\r\n        window.setTimeout(function() {\r\n            e.saveSortingToCookie(c, a)\r\n        }, 1);\r\n        return true\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableOrderSaving = function(c, a) {\r\n    this.attachEvent(\"onAfterCMove\", function() {\r\n        this.saveOrderToCookie(c, a);\r\n        this.saveSizeToCookie(c, a)\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableAutoSaving = function(c, a) {\r\n    this.enableOrderSaving(c, a);\r\n    this.enableAutoSizeSaving(c, a);\r\n    this.enableSortingSaving(c, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.saveSizeToCookie = function(c, a) {\r\n    if (this.cellWidthType == \"px\") {\r\n        var h = this.cellWidthPX\r\n    } else {\r\n        var h = this.cellWidthPC\r\n    }\r\n    var g = (this.initCellWidth || []).join(\",\");\r\n    if (this._hrrar) {\r\n        for (var e = 0; e < this._hrrar.length; e++) {\r\n            if (this._hrrar[e]) {\r\n                h[e] = \"\"\r\n            }\r\n        }\r\n    }\r\n    this.setCookie(c, a, 0, h.join(\",\"));\r\n    this.setCookie(c, a, 1, g)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.saveHiddenColumnsToCookie = function(c, a) {\r\n    var g = [].concat(this._hrrar || []);\r\n    if (this._fake && this._fake._hrrar) {\r\n        for (var e = 0; e < this._fake._cCount; e++) {\r\n            g[e] = this._fake._hrrar[e] ? \"1\" : \"\"\r\n        }\r\n    }\r\n    this.setCookie(c, a, 4, g.join(\",\").replace(/display:none;/g, \"1\"))\r\n}\r\n;\r\ndhtmlXGridObject.prototype.loadHiddenColumnsFromCookie = function(c) {\r\n    var g = this._getCookie(c, 4);\r\n    var a = (g || \"\").split(\",\");\r\n    for (var e = 0; e < this._cCount; e++) {\r\n        this.setColumnHidden(e, (a[e] ? true : false))\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.saveSortingToCookie = function(c, a) {\r\n    this.setCookie(c, a, 2, (this.getSortingState() || []).join(\",\"))\r\n}\r\n;\r\ndhtmlXGridObject.prototype.loadSortingFromCookie = function(a) {\r\n    var c = this._getCookie(a, 2);\r\n    c = (c || \"\").split(\",\");\r\n    if (c.length > 1 && c[0] < this._cCount) {\r\n        this.sortRows(c[0], null , c[1]);\r\n        this.setSortImgState(true, c[0], c[1])\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.saveOrderToCookie = function(e, a) {\r\n    if (!this._c_order) {\r\n        this._c_order = [];\r\n        var c = this._cCount;\r\n        for (var g = 0; g < c; g++) {\r\n            this._c_order[g] = g\r\n        }\r\n    }\r\n    this.setCookie(e, a, 3, ((this._c_order || []).slice(0, this._cCount)).join(\",\"));\r\n    this.saveSortingToCookie(e, a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.loadOrderFromCookie = function(c) {\r\n    var h = this._getCookie(c, 3);\r\n    h = (h || \"\").split(\",\");\r\n    if (h.length > 1 && h.length <= this._cCount) {\r\n        for (var g = 0; g < h.length; g++) {\r\n            if ((!this._c_order && h[g] != g) || (this._c_order && h[g] != this._c_order[g])) {\r\n                var e = h[g];\r\n                if (this._c_order) {\r\n                    for (var a = 0; a < this._c_order.length; a++) {\r\n                        if (this._c_order[a] == h[g]) {\r\n                            e = a;\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n                this.moveColumn(e * 1, g)\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.loadSizeFromCookie = function(a) {\r\n    var e = this._getCookie(a, 1);\r\n    if (e) {\r\n        this.initCellWidth = e.split(\",\")\r\n    }\r\n    var e = this._getCookie(a, 0);\r\n    if ((e) && (e.length)) {\r\n        e = e.split(\",\");\r\n        if (!this._fake && this._hrrar) {\r\n            for (var c = 0; c < e.length; c++) {\r\n                if (this._hrrar[c]) {\r\n                    e[c] = 0\r\n                }\r\n            }\r\n        }\r\n        if (this.cellWidthType == \"px\") {\r\n            this.cellWidthPX = e\r\n        } else {\r\n            this.cellWidthPC = e\r\n        }\r\n    }\r\n    for (var c = 0; c < e.length; c++) {\r\n        if (e[c] === \"\") {\r\n            e[c] = this.initCellWidth[c];\r\n            this.setColumnHidden(c, true)\r\n        }\r\n    }\r\n    this.setSizes();\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype.clearConfigCookie = function(a) {\r\n    if (!a) {\r\n        a = this.entBox.id\r\n    }\r\n    var c = \"gridSettings\" + a + \"=||||\";\r\n    document.cookie = c\r\n}\r\n;\r\ndhtmlXGridObject.prototype.clearSizeCookie = dhtmlXGridObject.prototype.clearConfigCookie;\r\ndhtmlXGridObject.prototype.setCookie = function(c, a, l, g) {\r\n    if (!c) {\r\n        c = this.entBox.id\r\n    }\r\n    var e = this.getCookie(c);\r\n    e = (e || \"||||\").split(\"|\");\r\n    e[l] = g;\r\n    var h = \"gridSettings\" + c + \"=\" + e.join(\"|\").replace(/,/g, \"-\") + (a ? (\"; \" + a) : \"\");\r\n    document.cookie = h\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getCookie = function(c, g) {\r\n    if (!c) {\r\n        c = this.entBox.id\r\n    }\r\n    c = (g || \"gridSettings\") + c;\r\n    var e = c + \"=\";\r\n    if (document.cookie.length > 0) {\r\n        var h = document.cookie.indexOf(e);\r\n        if (h != -1) {\r\n            h += e.length;\r\n            var a = document.cookie.indexOf(\";\", h);\r\n            if (a == -1) {\r\n                a = document.cookie.length\r\n            }\r\n            return document.cookie.substring(h, a)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._getCookie = function(a, c) {\r\n    return ((this.getCookie(a) || \"||||\").replace(/-/g, \",\").split(\"|\"))[c]\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableUndoRedo = function() {\r\n    var c = this;\r\n    var e = function() {\r\n        return c._onEditUndoRedo.apply(c, arguments)\r\n    }\r\n    ;\r\n    this.attachEvent(\"onEditCell\", e);\r\n    var a = function(h, g, l) {\r\n        return c._onEditUndoRedo.apply(c, [2, h, g, (l ? 1 : 0), (l ? 0 : 1)])\r\n    }\r\n    ;\r\n    this.attachEvent(\"onCheckbox\", a);\r\n    this._IsUndoRedoEnabled = true;\r\n    this._UndoRedoData = [];\r\n    this._UndoRedoPos = -1\r\n}\r\n;\r\ndhtmlXGridObject.prototype.disableUndoRedo = function() {\r\n    this._IsUndoRedoEnabled = false;\r\n    this._UndoRedoData = [];\r\n    this._UndoRedoPos = -1\r\n}\r\n;\r\ndhtmlXGridObject.prototype._onEditUndoRedo = function(e, c, l, g, a) {\r\n    if (this._IsUndoRedoEnabled && e == 2 && a != g) {\r\n        if (this._UndoRedoPos !== -1 && this._UndoRedoPos != (this._UndoRedoData.length - 1)) {\r\n            this._UndoRedoData = this._UndoRedoData.slice(0, this._UndoRedoPos + 1)\r\n        } else {\r\n            if (this._UndoRedoPos === -1 && this._UndoRedoData.length > 0) {\r\n                this._UndoRedoData = []\r\n            }\r\n        }\r\n        var h = {\r\n            old_value: a,\r\n            new_value: g,\r\n            row_id: c,\r\n            cell_index: l\r\n        };\r\n        this._UndoRedoData.push(h);\r\n        this._UndoRedoPos++\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXGridObject.prototype.doUndo = function() {\r\n    if (this._UndoRedoPos === -1) {\r\n        return false\r\n    }\r\n    var a = this._UndoRedoData[this._UndoRedoPos--];\r\n    var e = this.cells(a.row_id, a.cell_index);\r\n    if (this.getColType(a.cell_index) == \"tree\") {\r\n        e.setLabel(a.old_value)\r\n    } else {\r\n        e.setValue(a.old_value)\r\n    }\r\n    this.callEvent(\"onUndo\", [a.row_id])\r\n}\r\n;\r\ndhtmlXGridObject.prototype.doRedo = function() {\r\n    if (this._UndoRedoPos == this._UndoRedoData.length - 1) {\r\n        return false\r\n    }\r\n    var a = this._UndoRedoData[++this._UndoRedoPos];\r\n    this.cells(a.row_id, a.cell_index).setValue(a.new_value);\r\n    this.callEvent(\"onUndo\", [a.row_id])\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getRedo = function() {\r\n    if (this._UndoRedoPos == this._UndoRedoData.length - 1) {\r\n        return []\r\n    }\r\n    return this._UndoRedoData.slice(this._UndoRedoPos + 1)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getUndo = function() {\r\n    if (this._UndoRedoPos == -1) {\r\n        return []\r\n    }\r\n    return this._UndoRedoData.slice(0, this._UndoRedoPos + 1)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableAccessKeyMap = function() {\r\n    this._select_ifpossible = function() {\r\n        if (this.editor && this.editor.obj && this.editor.obj.select) {\r\n            this.editor.obj.select()\r\n        }\r\n    }\r\n    ;\r\n    this._key_events = {\r\n        k13_1_0: function() {\r\n            this.editStop()\r\n        },\r\n        k13_0_1: function() {\r\n            this._key_events.k9_0_1.call(this)\r\n        },\r\n        k13_0_0: function() {\r\n            this._key_events.k9_0_0.call(this)\r\n        },\r\n        k9_0_0: function() {\r\n            this.editStop();\r\n            if (!this.callEvent(\"onTab\", [true])) {\r\n                return true\r\n            }\r\n            var a = this._getNextCell(null , 1);\r\n            if (a) {\r\n                if (this.pagingOn) {\r\n                    this.showRow(a.parentNode.idd)\r\n                }\r\n                this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);\r\n                this._still_active = true\r\n            }\r\n            this._select_ifpossible()\r\n        },\r\n        k9_0_1: function() {\r\n            this.editStop();\r\n            if (!this.callEvent(\"onTab\", [false])) {\r\n                return true\r\n            }\r\n            var a = this._getNextCell(null , -1);\r\n            if (a) {\r\n                this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);\r\n                this._still_active = true\r\n            }\r\n            this._select_ifpossible()\r\n        },\r\n        k113_0_0: function() {\r\n            if (this._f2kE) {\r\n                this.editCell()\r\n            }\r\n        },\r\n        k32_0_0: function() {\r\n            var a = this.cells4(this.cell);\r\n            if (!a.changeState || (a.changeState() === false)) {\r\n                return false\r\n            }\r\n        },\r\n        k27_0_0: function() {\r\n            this.editStop(true)\r\n        },\r\n        k33_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage - 1)\r\n            } else {\r\n                this.scrollPage(-1)\r\n            }\r\n        },\r\n        k34_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage + 1)\r\n            } else {\r\n                this.scrollPage(1)\r\n            }\r\n        },\r\n        k37_0_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            if (this.isTreeGrid()) {\r\n                this.collapseKids(this.row)\r\n            } else {\r\n                this._key_events.k9_0_1.call(this)\r\n            }\r\n        },\r\n        k39_0_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            if (!this.editor && this.isTreeGrid()) {\r\n                this.expandKids(this.row)\r\n            } else {\r\n                this._key_events.k9_0_0.call(this)\r\n            }\r\n        },\r\n        k37_1_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            this.selectCell(this.row, 0, false, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k39_1_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            this.selectCell(this.row, this._cCount - 1, false, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k38_1_0: function() {\r\n            this.selectCell(this.rowsCol[0], this.cell._cellIndex, true, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k40_1_0: function() {\r\n            this.selectCell(this.rowsCol[this.rowsCol.length - 1], this.cell._cellIndex, true, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k38_0_1: function() {\r\n            var a = this.getRowIndex(this.row.idd);\r\n            var c = this._nextRow(a, -1);\r\n            if (!c || c._sRow || c._rLoad) {\r\n                return false\r\n            }\r\n            this.selectCell(c, this.cell._cellIndex, true, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k40_0_1: function() {\r\n            var a = this.getRowIndex(this.row.idd);\r\n            var c = this._nextRow(a, 1);\r\n            if (!c || c._sRow || c._rLoad) {\r\n                return false\r\n            }\r\n            this.selectCell(c, this.cell._cellIndex, true, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k38_1_1: function() {\r\n            var a = this.getRowIndex(this.row.idd);\r\n            for (var c = a; c >= 0; c--) {\r\n                this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, false, true)\r\n            }\r\n        },\r\n        k40_1_1: function() {\r\n            var a = this.getRowIndex(this.row.idd);\r\n            for (var c = a + 1; c < this.rowsCol.length; c++) {\r\n                this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, false, true)\r\n            }\r\n        },\r\n        k40_0_0: function() {\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftNext()\r\n            } else {\r\n                if (!this.row.idd) {\r\n                    return\r\n                }\r\n                var a = a = this.getRowIndex(this.row.idd) + 1;\r\n                if (this.rowsBuffer[a]) {\r\n                    var c = this._nextRow(a - 1, 1);\r\n                    if (this.pagingOn && c) {\r\n                        this.showRow(c.idd)\r\n                    }\r\n                    this._Opera_stop = 0;\r\n                    this.selectCell(c, this.cell._cellIndex, true, false, true)\r\n                } else {\r\n                    if (!this.callEvent(\"onLastRow\", [])) {\r\n                        return false\r\n                    }\r\n                    this._key_events.k34_0_0.apply(this, [])\r\n                }\r\n            }\r\n            this._still_active = true\r\n        },\r\n        k36_0_0: function() {\r\n            return this._key_events.k37_1_0.call(this)\r\n        },\r\n        k35_0_0: function() {\r\n            return this._key_events.k39_1_0.call(this)\r\n        },\r\n        k36_1_0: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            this.selectCell(this.rowsCol[0], 0, true, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k35_1_0: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            this.selectCell(this.rowsCol[this.rowsCol.length - 1], this._cCount - 1, true, false, true);\r\n            this._select_ifpossible()\r\n        },\r\n        k33_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage - 1)\r\n            } else {\r\n                this.scrollPage(-1)\r\n            }\r\n        },\r\n        k34_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage + 1)\r\n            } else {\r\n                this.scrollPage(1)\r\n            }\r\n        },\r\n        k38_0_0: function() {\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftPrev()\r\n            } else {\r\n                if (!this.row.idd) {\r\n                    return\r\n                }\r\n                var a = a = this.getRowIndex(this.row.idd) + 1;\r\n                if (a != -1) {\r\n                    var c = this._nextRow(a - 1, -1);\r\n                    this._Opera_stop = 0;\r\n                    if (this.pagingOn && c) {\r\n                        this.showRow(c.idd)\r\n                    }\r\n                    this.selectCell(c, this.cell._cellIndex, true, false, true)\r\n                } else {\r\n                    this._key_events.k33_0_0.apply(this, [])\r\n                }\r\n            }\r\n            this._still_active = true\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableExcelKeyMap = function() {\r\n    this._key_events = {\r\n        k13_1_0: function() {\r\n            this.editStop()\r\n        },\r\n        k13_0_1: function() {\r\n            this.editStop();\r\n            this._key_events.k38_0_0.call(this)\r\n        },\r\n        k13_0_0: function() {\r\n            this.editStop();\r\n            this.callEvent(\"onEnter\", [(this.row ? this.row.idd : null ), (this.cell ? this.cell._cellIndex : null )]);\r\n            this._still_active = true;\r\n            this._key_events.k40_0_0.call(this)\r\n        },\r\n        k9_0_0: function() {\r\n            this.editStop();\r\n            if (!this.callEvent(\"onTab\", [true])) {\r\n                return true\r\n            }\r\n            if (this.cell && (this.cell._cellIndex + 1) >= this._cCount) {\r\n                return\r\n            }\r\n            var a = this._getNextCell(null , 1);\r\n            if (a && this.row == a.parentNode) {\r\n                this.selectCell(a.parentNode, a._cellIndex, true);\r\n                this._still_active = true\r\n            }\r\n        },\r\n        k9_0_1: function() {\r\n            this.editStop();\r\n            if (!this.callEvent(\"onTab\", [false])) {\r\n                return true\r\n            }\r\n            if (this.cell && (this.cell._cellIndex == 0)) {\r\n                return\r\n            }\r\n            var a = this._getNextCell(null , -1);\r\n            if (a && this.row == a.parentNode) {\r\n                this.selectCell(a.parentNode, a._cellIndex, true);\r\n                this._still_active = true\r\n            }\r\n        },\r\n        k113_0_0: function() {\r\n            if (this._f2kE) {\r\n                this.editCell()\r\n            }\r\n        },\r\n        k32_0_0: function() {\r\n            var a = this.cells4(this.cell);\r\n            if (!a.changeState || (a.changeState() === false)) {\r\n                return false\r\n            }\r\n        },\r\n        k27_0_0: function() {\r\n            this.editStop(true);\r\n            this._still_active = true\r\n        },\r\n        k33_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage - 1)\r\n            } else {\r\n                this.scrollPage(-1)\r\n            }\r\n        },\r\n        k34_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage + 1)\r\n            } else {\r\n                this.scrollPage(1)\r\n            }\r\n        },\r\n        k37_0_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            if (this.isTreeGrid()) {\r\n                this.collapseKids(this.row)\r\n            } else {\r\n                this._key_events.k9_0_1.call(this)\r\n            }\r\n        },\r\n        k39_0_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            if (!this.editor && this.isTreeGrid()) {\r\n                this.expandKids(this.row)\r\n            } else {\r\n                this._key_events.k9_0_0.call(this)\r\n            }\r\n        },\r\n        k37_1_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            this.selectCell(this.row, 0, true)\r\n        },\r\n        k39_1_0: function() {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            this.selectCell(this.row, this._cCount - 1, true)\r\n        },\r\n        k38_1_0: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            this.selectCell(this.rowsCol[0], this.cell._cellIndex, true)\r\n        },\r\n        k40_1_0: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            this.selectCell(this.rowsCol[this.rowsCol.length - 1], this.cell._cellIndex, true)\r\n        },\r\n        k38_0_1: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            var a = this.row.rowIndex;\r\n            var c = this._nextRow(a - 1, -1);\r\n            if (!c || c._sRow || c._rLoad) {\r\n                return false\r\n            }\r\n            this.selectCell(c, this.cell._cellIndex, true, true)\r\n        },\r\n        k40_0_1: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            var a = this.row.rowIndex;\r\n            var c = this._nextRow(a - 1, 1);\r\n            if (!c || c._sRow || c._rLoad) {\r\n                return false\r\n            }\r\n            this.selectCell(c, this.cell._cellIndex, true, true)\r\n        },\r\n        k38_1_1: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            var a = this.row.rowIndex;\r\n            for (var c = a - 1; c >= 0; c--) {\r\n                this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, true)\r\n            }\r\n        },\r\n        k40_1_1: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            var a = this.row.rowIndex;\r\n            for (var c = a; c < this.rowsCol.length; c++) {\r\n                this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, true)\r\n            }\r\n        },\r\n        k40_0_0: function() {\r\n            var c = this._realfake ? this._fake : this;\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftNext()\r\n            } else {\r\n                if (this.editor) {\r\n                    return false\r\n                }\r\n                var a = Math.max((c._r_select || 0), this.getRowIndex(this.row.idd));\r\n                var e = this._nextRow(a, 1);\r\n                if (e) {\r\n                    c._r_select = null ;\r\n                    this.selectCell(e, this.cell._cellIndex, true);\r\n                    if (c.pagingOn) {\r\n                        c.showRow(e.idd)\r\n                    }\r\n                } else {\r\n                    if (!this.callEvent(\"onLastRow\", [])) {\r\n                        return false\r\n                    }\r\n                    this._key_events.k34_0_0.apply(this, [])\r\n                }\r\n            }\r\n        },\r\n        k36_0_0: function() {\r\n            return this._key_events.k37_1_0.call(this)\r\n        },\r\n        k35_0_0: function() {\r\n            return this._key_events.k39_1_0.call(this)\r\n        },\r\n        k36_1_0: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            this.selectCell(this.rowsCol[0], 0, true)\r\n        },\r\n        k35_1_0: function() {\r\n            if (this.editor || !this.rowsCol.length) {\r\n                return false\r\n            }\r\n            this.selectCell(this.rowsCol[this.rowsCol.length - 1], this._cCount - 1, true)\r\n        },\r\n        k33_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage - 1)\r\n            } else {\r\n                this.scrollPage(-1)\r\n            }\r\n        },\r\n        k34_0_0: function() {\r\n            if (this.pagingOn) {\r\n                this.changePage(this.currentPage + 1)\r\n            } else {\r\n                this.scrollPage(1)\r\n            }\r\n        },\r\n        k38_0_0: function() {\r\n            var c = this._realfake ? this._fake : this;\r\n            if (this.editor && this.editor.combo) {\r\n                this.editor.shiftPrev()\r\n            } else {\r\n                if (this.editor) {\r\n                    return false\r\n                }\r\n                if (!this.row.idd) {\r\n                    return\r\n                }\r\n                var a = this.getRowIndex(this.row.idd) + 1;\r\n                if (a != -1 && (!this.pagingOn || (a != 1))) {\r\n                    var e = this._nextRow(a - 1, -1);\r\n                    this.selectCell(e, this.cell._cellIndex, true);\r\n                    if (c.pagingOn && e) {\r\n                        c.showRow(e.idd)\r\n                    }\r\n                } else {\r\n                    this._key_events.k33_0_0.apply(this, [])\r\n                }\r\n            }\r\n        },\r\n        k_other: function(e) {\r\n            if (this.editor) {\r\n                return false\r\n            }\r\n            if (!e.ctrlKey && e.keyCode >= 40 && (e.keyCode < 91 || (e.keyCode > 95 && e.keyCode < 111) || e.keyCode > 187)) {\r\n                if (this.cell) {\r\n                    var g = this.cells4(this.cell);\r\n                    if (g.isDisabled()) {\r\n                        return false\r\n                    }\r\n                    var a = g.getValue();\r\n                    if (g.editable !== false) {\r\n                        g.setValue(\"\")\r\n                    }\r\n                    this.editCell();\r\n                    if (this.editor) {\r\n                        this.editor.val = a;\r\n                        if (this.editor.obj && this.editor.obj.select) {\r\n                            this.editor.obj.select()\r\n                        }\r\n                    } else {\r\n                        g.setValue(a)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\nfunction eXcell_time(a) {\r\n    this.base = eXcell_ed;\r\n    this.base(a);\r\n    this.getValue = function() {\r\n        return this.cell.innerHTML.toString()\r\n    }\r\n    ;\r\n    this.setValue = function(l) {\r\n        var h = new RegExp(\" \",\"i\");\r\n        l = l.replace(h, \":\");\r\n        if ((l == \"\") ) {\r\n            l = \"00:00\"\r\n        } else {\r\n            var h = new RegExp(\"[a-zA-Z]\",\"i\");\r\n            var g = l.match(h);\r\n            if (g) {\r\n                l = \"00:00\"\r\n            } else {\r\n                var h = new RegExp(\"[0-9]+[\\\\.\\\\/;\\\\-,_\\\\]\\\\[\\\\?\\\\: ][0-9]+\",\"i\");\r\n                var g = l.search(h);\r\n                if (g != -1) {\r\n                    var h = new RegExp(\"[\\\\./\\\\;\\\\-\\\\,\\\\_\\\\]\\\\[ \\\\?]\",\"i\");\r\n                    l = l.replace(h, \":\")\r\n                } else {\r\n                    var h = new RegExp(\"[^0-9]\",\"i\");\r\n                    res1 = l.search(h);\r\n                    if (g = l.match(h)) {\r\n                        l = \"00:00\"\r\n                    } else {\r\n                        if (l.length == 1) {\r\n                            l = \"00:0\" + l\r\n                        } else {\r\n                            if (parseInt(l) < 60) {\r\n                                l = \"00:\" + l\r\n                            } else {\r\n                                if (l.length < 5) {\r\n                                    var e = parseInt(l);\r\n                                    var c = Math.floor(e / 60);\r\n                                    e = e - 60 * c;\r\n                                    var c = c.toString();\r\n                                    var e = e.toString();\r\n                                    while (c.length < 2) {\r\n                                        c = \"0\" + c\r\n                                    }\r\n                                    while (e.length < 2) {\r\n                                        e = \"0\" + e\r\n                                    }\r\n                                    l = c + \":\" + e\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.cell.innerHTML = l\r\n    }\r\n}\r\neXcell_time.prototype = new eXcell_ed;\r\nfunction eXcell_sub_row(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.getValue = function() {\r\n        return this.grid.getUserData(this.cell.parentNode.idd, \"__sub_row\")\r\n    }\r\n    ;\r\n    this._setState = function(c, e) {\r\n        (e || this.cell).innerHTML = \"<img src='\" + this.grid.imgURL + c + \"' width='18' height='18' />\";\r\n        (e || this.cell).firstChild.onclick = this.grid._expandMonolite\r\n    }\r\n    ;\r\n    this.open = function() {\r\n        this.cell.firstChild.onclick(null , true)\r\n    }\r\n    ;\r\n    this.close = function() {\r\n        this.cell.firstChild.onclick(null , false, true)\r\n    }\r\n    ;\r\n    this.isOpen = function() {\r\n        return !!this.cell.parentNode._expanded\r\n    }\r\n    ;\r\n    this.setValue = function(c) {\r\n        if (c) {\r\n            this.grid.setUserData(this.cell.parentNode.idd, \"__sub_row\", c)\r\n        }\r\n        this._setState(c ? \"plus.gif\" : \"blank.gif\")\r\n    }\r\n    ;\r\n    this.setContent = function(c) {\r\n        if (this.cell.parentNode._expanded) {\r\n            this.cell.parentNode._expanded.innerHTML = c;\r\n            this.resize()\r\n        } else {\r\n            this.cell._previous_content = null ;\r\n            this.setValue(c);\r\n            this.cell._sub_row_type = null \r\n        }\r\n    }\r\n    ;\r\n    this.resize = function() {\r\n        this.grid._detectHeight(this.cell.parentNode._expanded, this.cell, this.cell.parentNode._expanded.scrollHeight)\r\n    }\r\n    ,\r\n    this.isDisabled = function() {\r\n        return true\r\n    }\r\n    ;\r\n    this.getTitle = function() {\r\n        return this.grid.getUserData(this.cell.parentNode.idd, \"__sub_row\") ? \"click to expand|collapse\" : \"\"\r\n    }\r\n}\r\neXcell_sub_row.prototype = new eXcell;\r\nfunction eXcell_sub_row_ajax(a) {\r\n    this.base = eXcell_sub_row;\r\n    this.base(a);\r\n    this.setValue = function(c) {\r\n        if (c) {\r\n            this.grid.setUserData(this.cell.parentNode.idd, \"__sub_row\", c)\r\n        }\r\n        this.cell._sub_row_type = \"ajax\";\r\n        this.cell._previous_content = null ;\r\n        this._setState(c ? \"plus.gif\" : \"blank.gif\")\r\n    }\r\n}\r\neXcell_sub_row_ajax.prototype = new eXcell_sub_row;\r\nfunction eXcell_sub_row_grid(a) {\r\n    this.base = eXcell_sub_row;\r\n    this.base(a);\r\n    this.setValue = function(c) {\r\n        if (c) {\r\n            this.grid.setUserData(this.cell.parentNode.idd, \"__sub_row\", c)\r\n        }\r\n        this.cell._sub_row_type = \"grid\";\r\n        this._setState(c ? \"plus.gif\" : \"blank.gif\")\r\n    }\r\n    ;\r\n    this.getSubGrid = function() {\r\n        if (!a._sub_grid) {\r\n            return null \r\n        }\r\n        return a._sub_grid\r\n    }\r\n}\r\neXcell_sub_row_grid.prototype = new eXcell_sub_row;\r\ndhtmlXGridObject.prototype._expandMonolite = function(a, u, l) {\r\n    var e = this.parentNode;\r\n    var v = e.parentNode;\r\n    var o = v.grid;\r\n    if (a || window.event) {\r\n        if (!l && !v._expanded) {\r\n            o.editStop()\r\n        }\r\n        (a || event).cancelBubble = true\r\n    }\r\n    var s = o.getUserData(v.idd, \"__sub_row\");\r\n    if (!o._sub_row_editor) {\r\n        o._sub_row_editor = new eXcell_sub_row(e)\r\n    }\r\n    if (!s) {\r\n        return\r\n    }\r\n    if (v._expanded && !u) {\r\n        o._sub_row_editor._setState(\"plus.gif\", e);\r\n        e._previous_content = v._expanded;\r\n        o.objBox.removeChild(v._expanded);\r\n        v._expanded = false;\r\n        v.style.height = (v.oldHeight || 20) + \"px\";\r\n        e.style.height = (v.oldHeight || 20) + \"px\";\r\n        if (o._fake) {\r\n            o._fake.rowsAr[v.idd].style.height = (v.oldHeight || 20) + \"px\";\r\n            o._fake.rowsAr[v.idd].firstChild.style.height = (v.oldHeight || 20) + \"px\"\r\n        }\r\n        for (var h = 0; h < v.cells.length; h++) {\r\n            v.cells[h].style.verticalAlign = \"middle\"\r\n        }\r\n        delete o._flow[v.idd];\r\n        o._correctMonolite();\r\n        v._expanded.ctrl = null \r\n    } else {\r\n        if (!v._expanded && !l) {\r\n            o._sub_row_editor._setState(\"minus.gif\", e);\r\n            v.oldHeight = e.offsetHeight - 4;\r\n            if (e._previous_content) {\r\n                var r = e._previous_content;\r\n                r.ctrl = e;\r\n                o.objBox.appendChild(r);\r\n                o._detectHeight(r, e, parseInt(r.style.height))\r\n            } else {\r\n                var r = document.createElement(\"DIV\");\r\n                r.ctrl = e;\r\n                if (e._sub_row_type) {\r\n                    o._sub_row_render[e._sub_row_type](o, r, e, s)\r\n                } else {\r\n                    r.innerHTML = s\r\n                }\r\n                r.style.cssText = \"position:absolute; left:0px; top:0px; overflow:auto; font-family:Tahoma; font-size:8pt; margin-top:2px; margin-left:4px;\";\r\n                r.className = \"dhx_sub_row\";\r\n                o.objBox.appendChild(r);\r\n                o._detectHeight(r, e)\r\n            }\r\n            if (!o._flow) {\r\n                o.attachEvent(\"onGridReconstructed\", function() {\r\n                    if ((this.pagingOn && !this.parentGrid) || this._srnd) {\r\n                        this._collapsMonolite()\r\n                    } else {\r\n                        this._correctMonolite()\r\n                    }\r\n                });\r\n                o.attachEvent(\"onResizeEnd\", function() {\r\n                    this._correctMonolite(true)\r\n                });\r\n                o.attachEvent(\"onAfterCMove\", function() {\r\n                    this._correctMonolite(true)\r\n                });\r\n                o.attachEvent(\"onDrop\", function() {\r\n                    this._correctMonolite(true)\r\n                });\r\n                o.attachEvent(\"onBeforePageChanged\", function() {\r\n                    this._collapsMonolite();\r\n                    return true\r\n                });\r\n                o.attachEvent(\"onGroupStateChanged\", function() {\r\n                    this._correctMonolite();\r\n                    return true\r\n                });\r\n                o.attachEvent(\"onFilterEnd\", function() {\r\n                    this._collapsMonolite()\r\n                });\r\n                o.attachEvent(\"onUnGroup\", function() {\r\n                    this._collapsMonolite()\r\n                });\r\n                o.attachEvent(\"onPageChanged\", function() {\r\n                    this._collapsMonolite()\r\n                });\r\n                o.attachEvent(\"onXLE\", function() {\r\n                    this._collapsMonolite()\r\n                });\r\n                o.attachEvent(\"onClearAll\", function() {\r\n                    for (var c in this._flow) {\r\n                        if (this._flow[c] && this._flow[c].parentNode) {\r\n                            this._flow[c].parentNode.removeChild(this._flow[c])\r\n                        }\r\n                    }\r\n                    this._flow = []\r\n                });\r\n                o.attachEvent(\"onEditCell\", function(w, n, x) {\r\n                    if ((w !== 2) && this._flow[n] && this.cellType[x] != \"ch\" && this.cellType[x] != \"ra\") {\r\n                        this._expandMonolite.apply(this._flow[n].ctrl.firstChild, [0, false, true])\r\n                    }\r\n                    return true\r\n                });\r\n                o.attachEvent(\"onCellChanged\", function(x, n) {\r\n                    if (!this._flow[x]) {\r\n                        return\r\n                    }\r\n                    var w = this.cells(x, n).cell;\r\n                    w.style.verticalAlign = \"top\"\r\n                });\r\n                o._flow = []\r\n            }\r\n            o._flow[v.idd] = r;\r\n            o._correctMonolite();\r\n            var m = o._srdh > 30 ? 11 : 3;\r\n            if (o.multiLine) {\r\n                m = 0\r\n            }\r\n            for (var h = 0; h < v.cells.length; h++) {\r\n                v.cells[h].style.verticalAlign = \"top\"\r\n            }\r\n            if (o._fake) {\r\n                var g = o._fake.rowsAr[v.idd];\r\n                for (var h = 0; h < g.cells.length; h++) {\r\n                    g.cells[h].style.verticalAlign = \"top\"\r\n                }\r\n            }\r\n            v._expanded = r\r\n        }\r\n    }\r\n    if (o._ahgr) {\r\n        o.setSizes()\r\n    }\r\n    if (o.parentGrid) {\r\n        o.callEvent(\"onGridReconstructed\", [])\r\n    }\r\n    o.callEvent(\"onSubRowOpen\", [v.idd, (!!v._expanded)])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._sub_row_render = {\r\n    ajax: function(that, d, td, c) {\r\n        d.innerHTML = \"Loading...\";\r\n        dhx4.ajax.get(c, function(xml) {\r\n            d.innerHTML = xml.xmlDoc.responseText;\r\n            var z = xml.xmlDoc.responseText.match(/<script[^>]*>([^\\f]+?)<\\/script>/g);\r\n            if (z) {\r\n                for (var i = 0; i < z.length; i++) {\r\n                    eval(z[i].replace(/<([\\/]{0,1})s[^>]*>/g, \"\"))\r\n                }\r\n            }\r\n            that._detectHeight(d, td);\r\n            that._correctMonolite();\r\n            that.setUserData(td.parentNode.idd, \"__sub_row\", xml.xmlDoc.responseText);\r\n            td._sub_row_type = null ;\r\n            if (that._ahgr) {\r\n                that.setSizes()\r\n            }\r\n            that.callEvent(\"onSubAjaxLoad\", [td.parentNode.idd, xml.xmlDoc.responseText])\r\n        })\r\n    },\r\n    grid: function(a, e, h, g) {\r\n        h._sub_grid = new dhtmlXGridObject(e);\r\n        if (a.skin_name) {\r\n            h._sub_grid.setSkin(a.skin_name)\r\n        }\r\n        h._sub_grid.parentGrid = a;\r\n        h._sub_grid.imgURL = a.imgURL;\r\n        h._sub_grid.iconURL = a.iconURL;\r\n        h._sub_grid.enableAutoHeight(true);\r\n        h._sub_grid._delta_x = h._sub_grid._delta_y = null ;\r\n        h._sub_grid.attachEvent(\"onGridReconstructed\", function() {\r\n            a._detectHeight(e, h, h._sub_grid.objBox.scrollHeight + h._sub_grid.hdr.offsetHeight + (this.ftr ? this.ftr.offsetHeight : 0));\r\n            a._correctMonolite();\r\n            this.setSizes();\r\n            if (a.parentGrid) {\r\n                a.callEvent(\"onGridReconstructed\", [])\r\n            }\r\n        });\r\n        if (!a.callEvent(\"onSubGridCreated\", [h._sub_grid, h.parentNode.idd, h._cellIndex, g])) {\r\n            h._sub_grid.objBox.style.overflow = \"hidden\";\r\n            h._sub_row_type = null \r\n        } else {\r\n            h._sub_grid.load(g, function() {\r\n                a._detectHeight(e, h, h._sub_grid.objBox.scrollHeight + h._sub_grid.hdr.offsetHeight + (h._sub_grid.ftr ? h._sub_grid.ftr.offsetHeight : 0));\r\n                h._sub_grid.objBox.style.overflow = \"hidden\";\r\n                a._correctMonolite();\r\n                h._sub_row_type = null ;\r\n                if (!a.callEvent(\"onSubGridLoaded\", [h._sub_grid, h.parentNode.idd, h._cellIndex, g])) {\r\n                    return\r\n                }\r\n                if (a._ahgr) {\r\n                    a.setSizes()\r\n                }\r\n            })\r\n        }\r\n    }\r\n};\r\ndhtmlXGridObject.prototype._detectHeight = function(m, n, c) {\r\n    var a = n.offsetLeft + n.offsetWidth;\r\n    m.style.left = a + \"px\";\r\n    m.style.width = Math.max(0, n.parentNode.offsetWidth - a - 4) + \"px\";\r\n    var c = c || m.scrollHeight;\r\n    m.style.overflow = \"hidden\";\r\n    m.style.height = c + \"px\";\r\n    var g = n.parentNode;\r\n    n.parentNode.style.height = (g.oldHeight || 20) + c * 1 + \"px\";\r\n    n.style.height = (g.oldHeight || 20) + c * 1 + \"px\";\r\n    if (this._fake) {\r\n        var e = this._fake.rowsAr[n.parentNode.idd];\r\n        e.style.height = (g.oldHeight || 20) + c * 1 + \"px\";\r\n        e.firstChild.style.height = (g.oldHeight || 20) + c * 1 + \"px\"\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._correctMonolite = function(g) {\r\n    if (this._in_correction) {\r\n        return\r\n    }\r\n    this._in_correction = true;\r\n    for (var e in this._flow) {\r\n        if (this._flow[e] && this._flow[e].tagName == \"DIV\") {\r\n            if (this.rowsAr[e]) {\r\n                if (this.rowsAr[e].style.display == \"none\") {\r\n                    this.cells4(this._flow[e].ctrl).close();\r\n                    continue\r\n                }\r\n                this._flow[e].style.top = this.rowsAr[e].offsetTop + (this.rowsAr[e].oldHeight || 20) + \"px\";\r\n                if (g) {\r\n                    var c = this._flow[e].ctrl.offsetLeft + this._flow[e].ctrl.offsetWidth;\r\n                    this._flow[e].style.left = c + \"px\";\r\n                    this._flow[e].style.width = this.rowsAr[e].offsetWidth - c - 4 + \"px\"\r\n                }\r\n            } else {\r\n                this._flow[e].ctrl = null ;\r\n                this.objBox.removeChild(this._flow[e]);\r\n                delete this._flow[e]\r\n            }\r\n        }\r\n    }\r\n    this._in_correction = false\r\n}\r\n;\r\ndhtmlXGridObject.prototype._collapsMonolite = function() {\r\n    for (var c in this._flow) {\r\n        if (this._flow[c] && this._flow[c].tagName == \"DIV\") {\r\n            if (this.rowsAr[c]) {\r\n                this.cells4(this._flow[c].ctrl).close()\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\nfunction eXcell_ra_str(a) {\r\n    if (a) {\r\n        this.base = eXcell_ra;\r\n        this.base(a);\r\n        this.grid = a.parentNode.grid\r\n    }\r\n}\r\neXcell_ra_str.prototype = new eXcell_ch;\r\neXcell_ra_str.prototype.setValue = function(e) {\r\n    this.cell.style.verticalAlign = \"middle\";\r\n    if (e) {\r\n        e = e.toString()._dhx_trim();\r\n        if ((e == \"false\") || (e == \"0\")) {\r\n            e = \"\"\r\n        }\r\n    }\r\n    if (e) {\r\n        if (this.grid.rowsAr[this.cell.parentNode.idd]) {\r\n            for (var c = 0; c < this.grid._cCount; c++) {\r\n                if (c !== this.cell._cellIndex) {\r\n                    var a = this.grid.cells(this.cell.parentNode.idd, c);\r\n                    if ((a.cell._cellType || this.grid.cellType[a.cell._cellIndex]) != \"ra_str\") {\r\n                        continue\r\n                    }\r\n                    if (a.getValue()) {\r\n                        a.setValue(\"0\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        e = \"1\";\r\n        this.cell.chstate = \"1\"\r\n    } else {\r\n        e = \"0\";\r\n        this.cell.chstate = \"0\"\r\n    }\r\n    this.setCValue(\"<img src='\" + this.grid.imgURL + \"radio_chk\" + e + \".gif' onclick='new eXcell_ra_str(this.parentNode).changeState()'>\", this.cell.chstate)\r\n}\r\n;\r\ndhx4.attachEvent(\"onGridCreated\", function(c) {\r\n    if (!window.dhx_globalImgPath) {\r\n        window.dhx_globalImgPath = c.imgURL\r\n    }\r\n    c._col_combos = [];\r\n    for (var a = 0; a < c._cCount; a++) {\r\n        if (c.cellType[a].indexOf(\"combo\") == 0) {\r\n            c._col_combos[a] = eXcell_combo.prototype.initCombo.call({\r\n                grid: c\r\n            }, a)\r\n        }\r\n    }\r\n    if (!c._loading_handler_set) {\r\n        c._loading_handler_set = c.attachEvent(\"onXLE\", function(g, e, l, h) {\r\n            eXcell_combo.prototype.fillColumnCombos(this, h);\r\n            this.detachEvent(this._loading_handler_set);\r\n            this._loading_handler_set = null \r\n        })\r\n    }\r\n});\r\nfunction eXcell_combo(a) {\r\n    if (!a) {\r\n        return\r\n    }\r\n    this.cell = a;\r\n    this.grid = a.parentNode.grid;\r\n    this._combo_pre = \"\";\r\n    this.edit = function() {\r\n        if (!window.dhx_globalImgPath) {\r\n            window.dhx_globalImgPath = this.grid.imgURL\r\n        }\r\n        this.val = this.getValue();\r\n        var c = this.getText();\r\n        if (this.cell._clearCell) {\r\n            c = \"\"\r\n        }\r\n        this.cell.innerHTML = \"\";\r\n        if (!this.cell._brval) {\r\n            this.combo = (this.grid._realfake ? this.grid._fake : this.grid)._col_combos[this.cell._cellIndex]\r\n        } else {\r\n            this.combo = this.cell._brval\r\n        }\r\n        this.cell.appendChild(this.combo.DOMParent);\r\n        this.combo.DOMParent.style.margin = \"0\";\r\n        this.combo.DOMelem_input.focus();\r\n        this.combo.setSize(this.cell.offsetWidth - 2);\r\n        if (!this.combo._xml) {\r\n            if (this.combo.getIndexByValue(this.cell.combo_value) != -1) {\r\n                this.combo.selectOption(this.combo.getIndexByValue(this.cell.combo_value))\r\n            } else {\r\n                if (this.combo.getOptionByLabel(c)) {\r\n                    this.combo.selectOption(this.combo.getIndexByValue(this.combo.getOptionByLabel(c).value))\r\n                } else {\r\n                    this.combo.setComboText(c)\r\n                }\r\n            }\r\n        } else {\r\n            this.combo.setComboText(c)\r\n        }\r\n        this.combo.openSelect()\r\n    }\r\n    ;\r\n    this.selectComboOption = function(e, c) {\r\n        c.selectOption(c.getIndexByValue(c.getOptionByLabel(e).value))\r\n    }\r\n    ;\r\n    this.getValue = function(c) {\r\n        return this.cell.combo_value || \"\"\r\n    }\r\n    ;\r\n    this.getText = function(e) {\r\n        var g = this.cell;\r\n        if (this._combo_pre == \"\" && g.childNodes[1]) {\r\n            g = g.childNodes[1]\r\n        } else {\r\n            g.childNodes[0].childNodes[1]\r\n        }\r\n        return ( _isIE ? g.innerText : g.textContent) \r\n    }\r\n    ;\r\n    this.setValue = function(h) {\r\n        if (typeof (h) == \"object\") {\r\n            this.cell._brval = this.initCombo();\r\n            var e = this.cell._cellIndex;\r\n            var g = this.cell.parentNode.idd;\r\n            if (!h.firstChild) {\r\n                this.cell.combo_value = \"&nbsp;\";\r\n                this.cell._clearCell = true\r\n            } else {\r\n                this.cell.combo_value = h.firstChild.data\r\n            }\r\n            this.setComboOptions(this.cell._brval, h, this.grid, e, g)\r\n        } else {\r\n            this.cell.combo_value = h;\r\n            var c = null ;\r\n            if ((c = this.cell._brval) && (typeof (this.cell._brval) == \"object\")) {\r\n                h = (c.getOption(h) || {}).text || h\r\n            } else {\r\n                if (c = this.grid._col_combos[this.cell._cellIndex] || ((this.grid._fake) && (c = this.grid._fake._col_combos[this.cell._cellIndex]))) {\r\n                    h = (c.getOption(h) || {}).text || h\r\n                }\r\n            }\r\n            if ((h || \"\").toString()._dhx_trim() == \"\") {\r\n                h = null \r\n            }\r\n            if (h !== null ) {\r\n                this.setComboCValue(h)\r\n            } else {\r\n                this.setComboCValue(\"&nbsp;\", \"\");\r\n                this.cell._clearCell = true\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        var c = this.combo.getParent();\r\n        if (c.parentNode == this.cell) {\r\n            this.cell.removeChild(c)\r\n        } else {\r\n            return false\r\n        }\r\n        var e = this.cell.combo_value;\r\n        this.combo._confirmSelect(\"blur\");\r\n        if (!this.combo.getComboText() || this.combo.getComboText().toString()._dhx_trim() == \"\") {\r\n            this.setComboCValue(\"&nbsp;\");\r\n            this.cell._clearCell = true\r\n        } else {\r\n            this.setComboCValue(this.combo.getComboText().replace(/\\&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\"), this.combo.getActualValue());\r\n            this.cell._clearCell = false\r\n        }\r\n        this.cell.combo_value = this.combo.getActualValue();\r\n        this.combo.closeAll();\r\n        this.grid._still_active = true;\r\n        this.grid.setActive(1);\r\n        return e != this.cell.combo_value\r\n    }\r\n}\r\neXcell_combo.prototype = new eXcell;\r\neXcell_combo_v = function(a) {\r\n    var c = new eXcell_combo(a);\r\n    c._combo_pre = \"<img src='\" + (window.dhx_globalImgPath ? window.dhx_globalImgPath : this.grid.imgURL) + \"combo_select\" + (dhtmlx.skin ? \"_\" + dhtmlx.skin : \"\") + \".gif' class='dhxgrid_combo_icon'/>\";\r\n    return c\r\n}\r\n;\r\neXcell_combo.prototype.initCombo = function(c) {\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = \"dhxcombo_in_grid_parent\";\r\n    var g = this.grid.defVal[arguments.length ? c : this.cell._cellIndex];\r\n    var h = new dhtmlXCombo(a,\"combo\",0,g);\r\n    this.grid.defVal[arguments.length ? c : this.cell._cellIndex] = \"\";\r\n    var e = this.grid;\r\n    h.DOMelem.onmousedown = h.DOMelem.onclick = function(l) {\r\n        l = l || event;\r\n        l.cancelBubble = true\r\n    }\r\n    ;\r\n    h.DOMelem.onselectstart = function(l) {\r\n        l = l || event;\r\n        l.cancelBubble = true;\r\n        return true\r\n    }\r\n    ;\r\n    this.grid.attachEvent(\"onScroll\", function() {\r\n        if (h._isListVisible()) {\r\n            h._hideList()\r\n        }\r\n    });\r\n    h.attachEvent(\"onKeyPressed\", function(l) {\r\n        if (l == 13 || l == 27) {\r\n            e.editStop();\r\n            if (e._fake) {\r\n                e._fake.editStop()\r\n            }\r\n        }\r\n    });\r\n    return h\r\n}\r\n;\r\neXcell_combo.prototype.fillColumnCombos = function(e, a) {\r\n    if (!a) {\r\n        return\r\n    }\r\n    var g = dhx4.ajax.xmltop(\"rows\", a, -1);\r\n    if (g && g.tagName !== \"DIV\") {\r\n        e.combo_columns = e.combo_columns || [];\r\n        columns = dhx4.ajax.xpath(\"//column\", g);\r\n        for (var c = 0; c < columns.length; c++) {\r\n            if ((columns[c].getAttribute(\"type\") || \"\").indexOf(\"combo\") == 0) {\r\n                e.combo_columns[e.combo_columns.length] = c;\r\n                this.setComboOptions(e._col_combos[c], columns[c], e, c)\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\neXcell_combo.prototype.setComboCValue = function(e, c) {\r\n    if (this._combo_pre != \"\") {\r\n        var a = (this.cell.offsetHeight ? this.cell.offsetHeight + \"px\" : 0);\r\n        e = \"<div style='width:100%;position:relative;height:100%;overflow:hidden;'>\" + this._combo_pre + \"<span>\" + e + \"</span></div>\"\r\n    }\r\n    if (arguments.length > 1) {\r\n        this.setCValue(e, c)\r\n    } else {\r\n        this.setCValue(e)\r\n    }\r\n}\r\n;\r\neXcell_combo.prototype.setComboOptions = function(l, m, e, r, u) {\r\n    if (window.dhx4.s2b(m.getAttribute(\"xmlcontent\"))) {\r\n        if (!m.getAttribute(\"source\")) {\r\n            options = m.childNodes;\r\n            var a = [];\r\n            for (var n = 0; n < options.length; n++) {\r\n                if (options[n].tagName == \"option\") {\r\n                    var g = options[n].firstChild ? options[n].firstChild.data : \"\";\r\n                    a[a.length] = [options[n].getAttribute(\"value\"), g, (options[n].getAttribute(\"css\") || \"\")]\r\n                }\r\n            }\r\n            l.addOption(a);\r\n            if (arguments.length == 4) {\r\n                e.forEachRowA(function(w) {\r\n                    var v = e.cells(w, r);\r\n                    if (!v.cell._brval && !v.cell._cellType && (v.cell._cellIndex == r)) {\r\n                        if (v.cell.combo_value == \"\") {\r\n                            v.setComboCValue(\"&nbsp;\", \"\")\r\n                        } else {\r\n                            if (!l.getOption(v.cell.combo_value)) {\r\n                                v.setComboCValue(v.cell.combo_value)\r\n                            } else {\r\n                                v.setComboCValue(l.getOption(v.cell.combo_value).text, v.cell.combo_value)\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n            } else {\r\n                var s = (this.cell) ? this : e.cells(u, r);\r\n                if (m.getAttribute(\"text\")) {\r\n                    if (m.getAttribute(\"text\")._dhx_trim() == \"\") {\r\n                        s.setComboCValue(\"&nbsp;\", \"\")\r\n                    } else {\r\n                        s.setComboCValue(m.getAttribute(\"text\"))\r\n                    }\r\n                } else {\r\n                    if ((!s.cell.combo_value) || (s.cell.combo_value._dhx_trim() == \"\")) {\r\n                        s.setComboCValue(\"&nbsp;\", \"\")\r\n                    } else {\r\n                        if (!l.getOption(s.cell.combo_value)) {\r\n                            s.setComboCValue(s.cell.combo_value)\r\n                        } else {\r\n                            s.setComboCValue(l.getOption(s.cell.combo_value).text, s.cell.combo_value)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (m.getAttribute(\"source\")) {\r\n        if (m.getAttribute(\"auto\") && window.dhx4.s2b(m.getAttribute(\"auto\"))) {\r\n            if (m.getAttribute(\"xmlcontent\")) {\r\n                var s = (this.cell) ? this : e.cells(u, r);\r\n                if (m.getAttribute(\"text\")) {\r\n                    s.setComboCValue(m.getAttribute(\"text\"))\r\n                }\r\n            } else {\r\n                e.forEachRowA(function(y) {\r\n                    var x = e.cells(y, r);\r\n                    if (!x.cell._brval && !x.cell._cellType) {\r\n                        var w = x.cell.combo_value.toString();\r\n                        if (w.indexOf(\"^\") != -1) {\r\n                            var v = w.split(\"^\");\r\n                            x.cell.combo_value = v[0];\r\n                            x.setComboCValue(v[1])\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n            l.enableFilteringMode(true, m.getAttribute(\"source\"), window.dhx4.s2b(m.getAttribute(\"cache\") || true), window.dhx4.s2b(m.getAttribute(\"sub\") || false))\r\n        } else {\r\n            var o = this;\r\n            var h = arguments.length;\r\n            l.load(m.getAttribute(\"source\"), function() {\r\n                if (h == 4) {\r\n                    e.forEachRow(function(x) {\r\n                        var w = e.cells(x, r);\r\n                        if (!w.cell._brval && !w.cell._cellType) {\r\n                            if (l.getOption(w.cell.combo_value)) {\r\n                                w.setComboCValue(l.getOption(w.cell.combo_value).text, w.cell.combo_value)\r\n                            } else {\r\n                                if ((w.cell.combo_value || \"\").toString()._dhx_trim() == \"\") {\r\n                                    w.setComboCValue(\"&nbsp;\", \"\");\r\n                                    w.cell._clearCell = true\r\n                                } else {\r\n                                    w.setComboCValue(w.cell.combo_value)\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                } else {\r\n                    var v = e.cells(u, r);\r\n                    if (l.getOption(v.cell.combo_value)) {\r\n                        v.setComboCValue(l.getOption(v.cell.combo_value).text, v.cell.combo_value)\r\n                    } else {\r\n                        v.setComboCValue(v.cell.combo_value)\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    }\r\n    if (!m.getAttribute(\"auto\") || !window.dhx4.s2b(m.getAttribute(\"auto\"))) {\r\n        if (m.getAttribute(\"editable\") && !window.dhx4.s2b(m.getAttribute(\"editable\"))) {\r\n            l.readonly(true)\r\n        }\r\n        if (m.getAttribute(\"filter\") && window.dhx4.s2b(m.getAttribute(\"filter\"))) {\r\n            l.enableFilteringMode(true)\r\n        }\r\n    }\r\n}\r\n;\r\neXcell_combo.prototype.getCellCombo = function() {\r\n    if (this.cell._brval) {\r\n        return this.cell._brval\r\n    }\r\n    this.cell._brval = this.initCombo();\r\n    return this.cell._brval\r\n}\r\n;\r\neXcell_combo.prototype.refreshCell = function() {\r\n    this.setValue(this.getValue())\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getColumnCombo = function(a) {\r\n    if (this._col_combos && this._col_combos[a]) {\r\n        return this._col_combos[a]\r\n    }\r\n    if (!this._col_combos) {\r\n        this._col_combos = []\r\n    }\r\n    this._col_combos[a] = eXcell_combo.prototype.initCombo.call({\r\n        grid: this\r\n    }, a);\r\n    return this._col_combos[a]\r\n}\r\n;\r\ndhtmlXGridObject.prototype.refreshComboColumn = function(a) {\r\n    this.forEachRow(function(c) {\r\n        if (this.cells(c, a).refreshCell) {\r\n            this.cells(c, a).refreshCell()\r\n        }\r\n    })\r\n}\r\n;\r\nfunction eXcell_clist(a) {\r\n    try {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    } catch (c) {}\r\n    this.edit = function() {\r\n        this.val = this.getValue();\r\n        var g = (this.cell._combo || this.grid.clists[this.cell._cellIndex]);\r\n        if (!g) {\r\n            return\r\n        }\r\n        this.obj = document.createElement(\"DIV\");\r\n        var e = this.val.split(\",\");\r\n        var o = \"\";\r\n        for (var m = 0; m < g.length; m++) {\r\n            var n = false;\r\n            for (var h = 0; h < e.length; h++) {\r\n                if (g[m] == e[h]) {\r\n                    n = true\r\n                }\r\n            }\r\n            if (n) {\r\n                o += \"<div><input type='checkbox' id='dhx_clist_\" + m + \"' checked='true' /><label for='dhx_clist_\" + m + \"'>\" + g[m] + \"</label></div>\"\r\n            } else {\r\n                o += \"<div><input type='checkbox' id='dhx_clist_\" + m + \"'/><label for='dhx_clist_\" + m + \"'>\" + g[m] + \"</label></div>\"\r\n            }\r\n        }\r\n        o += \"<div><input type='button' value='\" + (this.grid.applyButtonText || \"Apply\") + \"' style='width:100px; font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>\";\r\n        this.obj.editor = this;\r\n        this.obj.innerHTML = o;\r\n        document.body.appendChild(this.obj);\r\n        this.obj.style.position = \"absolute\";\r\n        this.obj.className = \"dhx_clist\";\r\n        this.obj.onclick = function(r) {\r\n            (r || event).cancelBubble = true;\r\n            return true\r\n        }\r\n        ;\r\n        var l = this.grid.getPosition(this.cell);\r\n        this.obj.style.left = l[0] + \"px\";\r\n        this.obj.style.top = l[1] + this.cell.offsetHeight + \"px\";\r\n        this.obj.getValue = function() {\r\n            var s = \"\";\r\n            for (var r = 0; r < this.childNodes.length - 1; r++) {\r\n                if (this.childNodes[r].childNodes[0].checked) {\r\n                    if (s) {\r\n                        s += \", \"\r\n                    }\r\n                    s += this.childNodes[r].childNodes[1].innerHTML\r\n                }\r\n            }\r\n            return s.replace(/&amp;/g, \"&\")\r\n        }\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        if (this.cell._clearCell) {\r\n            return \"\"\r\n        }\r\n        return this.cell.innerHTML.toString()._dhx_trim().replace(/&amp;/g, \"&\").replace(/, /g, \",\")\r\n    }\r\n    ;\r\n    this.detach = function(e) {\r\n        if (this.obj) {\r\n            this.setValue(this.obj.getValue());\r\n            this.obj.editor = null ;\r\n            this.obj.parentNode.removeChild(this.obj);\r\n            this.obj = null \r\n        }\r\n        return this.val != this.getValue()\r\n    }\r\n}\r\neXcell_clist.prototype = new eXcell;\r\neXcell_clist.prototype.setValue = function(e) {\r\n    if (typeof (e) == \"object\") {\r\n        var c = dhx4.ajax.xpath(\"./option\", e);\r\n        if (c.length) {\r\n            this.cell._combo = []\r\n        }\r\n        for (var a = 0; a < c.length; a++) {\r\n            this.cell._combo.push(c[a].firstChild ? c[a].firstChild.data : \"\")\r\n        }\r\n        e = e.firstChild.data\r\n    }\r\n    if (e === \"\" || e === this.undefined) {\r\n        this.setCTxtValue(\" \", e);\r\n        this.cell._clearCell = true\r\n    } else {\r\n        e = e.replace(/,[ ]*/g, \", \");\r\n        this.setCTxtValue(e);\r\n        this.cell._clearCell = false\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.registerCList = function(a, c) {\r\n    if (!this.clists) {\r\n        this.clists = new Array()\r\n    }\r\n    if (typeof (c) != \"object\") {\r\n        c = c.split(\",\")\r\n    }\r\n    this.clists[a] = c\r\n}\r\n;\r\nfunction eXcell_calck(a) {\r\n    try {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    } catch (c) {}\r\n    this.edit = function() {\r\n        this.val = this.getValue();\r\n        var e = this.grid.getPosition(this.cell);\r\n        this.obj = new calcX(e[0],e[1] + this.cell.offsetHeight,this,this.val)\r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(), this.cell._cellIndex)\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        if (this.obj) {\r\n            this.setValue(this.obj.inputZone.value);\r\n            this.obj.removeSelf()\r\n        }\r\n        this.obj = null ;\r\n        return this.val != this.getValue()\r\n    }\r\n}\r\neXcell_calck.prototype = new eXcell;\r\neXcell_calck.prototype.setValue = function(a) {\r\n    if (!a || a.toString()._dhx_trim() == \"\") {\r\n        a = \"0\"\r\n    }\r\n    this.setCValue(this.grid._aplNF(a, this.cell._cellIndex), a)\r\n}\r\n;\r\nfunction calcX(left, top, onReturnSub, val) {\r\n    this.top = top || 0;\r\n    this.left = left || 0;\r\n    this.onReturnSub = onReturnSub || null ;\r\n    this.operandA = 0;\r\n    this.operandB = 0;\r\n    this.operatorA = \"\";\r\n    this.state = 0;\r\n    this.dotState = 0;\r\n    this.calckGo = function() {\r\n        return ( eval(this.operandA + \"*1\" + this.operatorA + this.operandB + \"*1\")) \r\n    }\r\n    ;\r\n    this.isNumeric = function(str) {\r\n        return ( (str.search(/[^1234567890]/gi) == -1) ? (true) : (false)) \r\n    }\r\n    ;\r\n    this.isOperation = function(str) {\r\n        return ( (str.search(/[^\\+\\*\\-\\/]/gi) == -1) ? (true) : (false)) \r\n    }\r\n    ;\r\n    this.onCalcKey = function(e) {\r\n        that = this.calk;\r\n        var z = this.innerHTML;\r\n        var rZone = that.inputZone;\r\n        if (((that.state == 0) || (that.state == 2)) && (that.isNumeric(z))) {\r\n            if (rZone.value != \"0\") {\r\n                rZone.value += z\r\n            } else {\r\n                rZone.value = z\r\n            }\r\n        }\r\n        if ((((that.state == 0) || (that.state == 2)) && (z == \".\")) && (that.dotState == 0)) {\r\n            that.dotState = 1;\r\n            rZone.value += z\r\n        }\r\n        if ((z == \"C\") ) {\r\n            rZone.value = 0;\r\n            that.dotState = 0;\r\n            that.state = 0\r\n        }\r\n        if ((that.state == 0) && (that.isOperation(z))) {\r\n            that.operatorA = z;\r\n            that.operandA = rZone.value;\r\n            that.state = 1\r\n        }\r\n        if ((that.state == 2) && (that.isOperation(z))) {\r\n            that.operandB = rZone.value;\r\n            rZone.value = that.calckGo();\r\n            that.operatorA = z;\r\n            that.operandA = rZone.value;\r\n            that.state = 1\r\n        }\r\n        if ((that.state == 2) && (z == \"=\")) {\r\n            that.operandB = rZone.value;\r\n            rZone.value = that.calckGo();\r\n            that.operatorA = z;\r\n            that.operandA = rZone.value;\r\n            that.state = 3\r\n        }\r\n        if ((that.state == 1) && (that.isNumeric(z))) {\r\n            rZone.value = z;\r\n            that.state = 2;\r\n            that.dotState = 0\r\n        }\r\n        if ((that.state == 3) && (that.isNumeric(z))) {\r\n            rZone.value = z;\r\n            that.state = 0\r\n        }\r\n        if ((that.state == 3) && (that.isOperation(z))) {\r\n            that.operatorA = z;\r\n            that.operandA = rZone.value;\r\n            that.state = 1\r\n        }\r\n        if (z == \"e\") {\r\n            rZone.value = Math.E;\r\n            if (that.state == 1) {\r\n                that.state = 2\r\n            }\r\n            that.dotState = 0\r\n        }\r\n        if (z == \"p\") {\r\n            rZone.value = Math.PI;\r\n            if (that.state == 1) {\r\n                that.state = 2\r\n            }\r\n            that.dotState = 0\r\n        }\r\n        if (z == \"Off\") {\r\n            that.topNod.parentNode.removeChild(that.topNod)\r\n        }\r\n        if (e || event) {\r\n            (e || event).cancelBubble = true\r\n        }\r\n    }\r\n    ;\r\n    this.sendResult = function() {\r\n        that = this.calk;\r\n        if (that.state == 2) {\r\n            var rZone = that.inputZone;\r\n            that.operandB = rZone.value;\r\n            rZone.value = that.calckGo();\r\n            that.operatorA = z;\r\n            that.operandA = rZone.value;\r\n            that.state = 3\r\n        }\r\n        var z = that.inputZone.value;\r\n        that.topNod.parentNode.removeChild(that.topNod);\r\n        that.onReturnSub.grid.editStop(false)\r\n    }\r\n    ;\r\n    this.removeSelf = function() {\r\n        if (this.topNod.parentNode) {\r\n            this.topNod.parentNode.removeChild(this.topNod)\r\n        }\r\n    }\r\n    ;\r\n    this.keyDown = function() {\r\n        this.className = \"calcPressed\"\r\n    }\r\n    ;\r\n    this.keyUp = function() {\r\n        this.className = \"calcButton\"\r\n    }\r\n    ;\r\n    this.init_table = function() {\r\n        var table = this.topNod.childNodes[0];\r\n        if ((!table) || (table.tagName != \"TABLE\")) {\r\n            return\r\n        }\r\n        for (i = 1; i < table.childNodes[0].childNodes.length; i++) {\r\n            for (j = 0; j < table.childNodes[0].childNodes[i].childNodes.length; j++) {\r\n                table.childNodes[0].childNodes[i].childNodes[j].onclick = this.onCalcKey;\r\n                table.childNodes[0].childNodes[i].childNodes[j].onmousedown = this.keyDown;\r\n                table.childNodes[0].childNodes[i].childNodes[j].onmouseout = this.keyUp;\r\n                table.childNodes[0].childNodes[i].childNodes[j].onmouseup = this.keyUp;\r\n                table.childNodes[0].childNodes[i].childNodes[j].calk = this\r\n            }\r\n        }\r\n        this.inputZone = this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];\r\n        if (this.onReturnSub) {\r\n            this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].onclick = this.sendResult;\r\n            this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].calk = this\r\n        } else {\r\n            this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].innerHTML = \"\"\r\n        }\r\n    }\r\n    ;\r\n    this.drawSelf = function() {\r\n        var div = document.createElement(\"div\");\r\n        div.className = \"calcTable\";\r\n        div.style.position = \"absolute\";\r\n        div.style.top = this.top + \"px\";\r\n        div.style.left = this.left + \"px\";\r\n        div.innerHTML = \"<table cellspacing='0' id='calc_01' class='calcTable'><tr><td colspan='4'><table cellpadding='1' cellspacing='0' width='100%'><tr><td width='100%' style='overflow:hidden;'><input style='width:100%' class='calcInput' value='0' align='right' readonly='true' style='text-align:right'></td><td class='calkSubmit'>=</td></tr></table></td></tr><tr><td class='calcButton' width='25%'>Off</td><td class='calcButton' width='25%'>p</td><td class='calcButton' width='25%'>e</td><td class='calcButton' width='25%'>/</td></tr><tr><td class='calcButton'>7</td><td class='calcButton'>8</td><td class='calcButton'>9</td><td class='calcButton'>*</td></tr><tr><td class='calcButton'>4</td><td class='calcButton'>5</td><td class='calcButton'>6</td><td class='calcButton'>+</td></tr><tr><td class='calcButton'>1</td><td class='calcButton'>2</td><td class='calcButton'>3</td><td class='calcButton'>-</td></tr><tr><td class='calcButton'>0</td><td class='calcButton'>.</td><td class='calcButton'>C</td><td class='calcButton'>=</td></tr></table>\";\r\n        div.onclick = function(e) {\r\n            (e || event).cancelBubble = true\r\n        }\r\n        ;\r\n        document.body.appendChild(div);\r\n        this.topNod = div\r\n    }\r\n    ;\r\n    this.drawSelf();\r\n    this.init_table();\r\n    if (val) {\r\n        var rZone = this.inputZone;\r\n        rZone.value = val * 1;\r\n        this.operandA = val * 1;\r\n        this.state = 3\r\n    }\r\n    return this\r\n}\r\ndhtmlXGridObject.prototype._updateTGRState = function(a) {\r\n    if (!a.update || a.id == 0) {\r\n        return\r\n    }\r\n    if (this.rowsAr[a.id].imgTag) {\r\n        this.rowsAr[a.id].imgTag.src = this.iconTree + a.state + \".gif\"\r\n    }\r\n    a.update = false\r\n}\r\n;\r\ndhtmlXGridObject.prototype.doExpand = function(c) {\r\n    this.editStop();\r\n    var e = c.parentNode.parentNode.parentNode;\r\n    var a = this._h2.get[e.idd];\r\n    if (!this.callEvent(\"onOpen\", [e.idd, (a.state == \"plus\" ? -1 : 1)])) {\r\n        return\r\n    }\r\n    if (a.state == \"plus\") {\r\n        this.expandKids(e)\r\n    } else {\r\n        if ((a.state == \"minus\") && (!a._closeable)) {\r\n            this.collapseKids(e)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._createHierarchy = function() {\r\n    if (!this._emptyLineImg) {\r\n        this._emptyLineImg = \"blank\"\r\n    }\r\n    return new dhtmlxHierarchy({\r\n        _emptyLineImg: this._emptyLineImg\r\n    })\r\n}\r\n;\r\nfunction dhtmlxHierarchy(a) {\r\n    var c = {\r\n        id: 0,\r\n        childs: [],\r\n        level: -1,\r\n        parent: null ,\r\n        index: 0,\r\n        state: a._emptyLineImg\r\n    };\r\n    this.order = [c];\r\n    this.get = {\r\n        \"0\": c\r\n    };\r\n    this.swap = function(g, e) {\r\n        var h = g.parent;\r\n        var l = g.index;\r\n        h.childs[l] = e;\r\n        h.childs[e.index] = g;\r\n        g.index = e.index;\r\n        e.index = l\r\n    }\r\n    ;\r\n    this.forEachChildF = function(n, e, l, g) {\r\n        var m = this.get[n];\r\n        for (var h = 0; h < m.childs.length; h++) {\r\n            if (!e.apply((l || this), [m.childs[h]])) {\r\n                continue\r\n            }\r\n            if (m.childs[h].childs.length) {\r\n                this.forEachChildF(m.childs[h].id, e, l, g)\r\n            }\r\n            if (g) {\r\n                g.call((l || this), m.childs[h])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.forEachChild = function(m, e, h) {\r\n        var l = this.get[m];\r\n        for (var g = 0; g < l.childs.length; g++) {\r\n            e.apply((h || this), [l.childs[g]]);\r\n            if (l.childs[g].childs.length) {\r\n                this.forEachChild(l.childs[g].id, e, h)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.change = function(l, e, h) {\r\n        var g = this.get[l];\r\n        if (g[e] == h) {\r\n            return\r\n        }\r\n        g[e] = h;\r\n        g.update = true\r\n    }\r\n    ;\r\n    this.add = function(g, e) {\r\n        return this.addAfter(g, e)\r\n    }\r\n    ;\r\n    this.addAfter = function(r, o, h, g) {\r\n        var n = this.get[o || 0];\r\n        if (h) {\r\n            var m = this.get[h].index + (g ? 0 : 1)\r\n        } else {\r\n            var m = n.childs.length\r\n        }\r\n        var e = {\r\n            id: r,\r\n            childs: [],\r\n            level: n.level + 1,\r\n            parent: n,\r\n            index: m,\r\n            state: a._emptyLineImg\r\n        };\r\n        if (n.state == a._emptyLineImg) {\r\n            this.change(o, \"state\", (o == 0 ? \"minus\" : \"plus\"))\r\n        }\r\n        if (h) {\r\n            for (var l = m; l < n.childs.length; l++) {\r\n                n.childs[l].index++\r\n            }\r\n            n.childs = n.childs.slice(0, m).concat([e]).concat(n.childs.slice(m, n.childs.length))\r\n        } else {\r\n            n.childs.push(e)\r\n        }\r\n        this.get[r] = e;\r\n        return e\r\n    }\r\n    ;\r\n    this.addBefore = function(h, g, e) {\r\n        return this.addAfter(h, g, e, true)\r\n    }\r\n    ;\r\n    this.remove = function(h) {\r\n        var g = this.get[h || 0];\r\n        for (var e = 0; e < g.childs.length; e++) {\r\n            this.deleteAll(g.childs[e].id)\r\n        }\r\n        g.childs = [];\r\n        g.parent.childs = g.parent.childs.slice(0, g.index).concat(g.parent.childs.slice(g.index + 1));\r\n        for (var e = g.index; e < g.parent.childs.length; e++) {\r\n            g.parent.childs[e].index--\r\n        }\r\n        delete this.get[h]\r\n    }\r\n    ;\r\n    this.deleteAll = function(h) {\r\n        var g = this.get[h || 0];\r\n        for (var e = 0; e < g.childs.length; e++) {\r\n            this.deleteAll(g.childs[e].id)\r\n        }\r\n        g.childs = [];\r\n        delete this.get[h]\r\n    }\r\n    ;\r\n    return this\r\n}\r\ndhtmlXGridObject.prototype._getOpenLenght = function(g, e) {\r\n    var c = this._h2.get[g].childs;\r\n    e += c.length;\r\n    for (var a = 0; a < c.length; a++) {\r\n        if (c[a].childs.length && c[a].state == \"minus\") {\r\n            e += this._getOpenLenght(c[a].id, 0)\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXGridObject.prototype.collapseKids = function(e) {\r\n    var g = this._h2.get[e.idd];\r\n    if (g.state != \"minus\") {\r\n        return\r\n    }\r\n    if (!this.callEvent(\"onOpenStart\", [e.idd, 1])) {\r\n        return\r\n    }\r\n    var h = e.rowIndex;\r\n    if (h < 0) {\r\n        h = this.rowsCol._dhx_find(e) + 1\r\n    }\r\n    this._h2.change(g.id, \"state\", \"plus\");\r\n    this._updateTGRState(g);\r\n    if (this._srnd || this.pagingOn) {\r\n        this._h2_to_buff();\r\n        this._renderSort()\r\n    } else {\r\n        var a = this._getOpenLenght(this.rowsCol[h - 1].idd, 0);\r\n        for (var c = 0; c < a; c++) {\r\n            this.rowsCol[h + c].parentNode.removeChild(this.rowsCol[h + c])\r\n        }\r\n        this.rowsCol.splice(h, a)\r\n    }\r\n    this.callEvent(\"onGridReconstructed\", []);\r\n    this.setSizes();\r\n    this._h2_to_buff();\r\n    this.callEvent(\"onOpenEnd\", [e.idd, -1])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._massInsert = function(a, e, g, o) {\r\n    var h = [];\r\n    var n = (_isKHTML ? this.obj : this.obj.rows[0].parentNode);\r\n    this._h2_to_buff();\r\n    if (this._srnd || this.pagingOn) {\r\n        return this._renderSort()\r\n    }\r\n    var m = this._getOpenLenght(a.id, 0);\r\n    for (var l = 0; l < m; l++) {\r\n        var c = this.render_row(g + l);\r\n        if (e) {\r\n            e.parentNode.insertBefore(c, e)\r\n        } else {\r\n            n.appendChild(c)\r\n        }\r\n        h.push(c)\r\n    }\r\n    this.rowsCol = dhtmlxArray(this.rowsCol.slice(0, g).concat(h).concat(this.rowsCol.slice(g)));\r\n    return a.childs.length + h.length\r\n}\r\n;\r\ndhtmlXGridObject.prototype.expandKids = function(c, h) {\r\n    var e = this._h2.get[c.idd];\r\n    if ((!e.childs.length) && (!e._xml_await)) {\r\n        return\r\n    }\r\n    if (e.state != \"plus\") {\r\n        return\r\n    }\r\n    if (!e._loading && !h) {\r\n        if (!this.callEvent(\"onOpenStart\", [e.id, -1])) {\r\n            return\r\n        }\r\n    }\r\n    var g = this.getRowIndex(e.id) + 1;\r\n    if (e.childs.length) {\r\n        e._loading = false;\r\n        this._h2.change(e.id, \"state\", \"minus\");\r\n        this._updateTGRState(e);\r\n        var a = this._massInsert(e, this.rowsCol[g], g);\r\n        this.callEvent(\"onGridReconstructed\", [])\r\n    } else {\r\n        if (e._xml_await) {\r\n            e._loading = true;\r\n            if (this.callEvent(\"onDynXLS\", [e.id])) {\r\n                this.load(this.kidsXmlFile + \"\" + (this.kidsXmlFile.indexOf(\"?\") != -1 ? \"&\" : \"?\") + \"id=\" + encodeURIComponent(e.id), this._data_type)\r\n            }\r\n        }\r\n    }\r\n    this.setSizes();\r\n    if (!e._loading) {\r\n        this.callEvent(\"onOpenEnd\", [e.id, 1])\r\n    }\r\n    this._fixAlterCss()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.kidsXmlFile = \"\";\r\ndhtmlXGridObject.prototype.sortTreeRows = function(g, h, a) {\r\n    var l = \"getValue\";\r\n    if (this.cells5({\r\n        parentNode: {\r\n            grid: this\r\n        }\r\n    }, this.getColType(g)).getDate) {\r\n        l = \"getDate\";\r\n        h = \"str\"\r\n    }\r\n    this.forEachRow(function(s) {\r\n        var r = this._h2.get[s];\r\n        if (!r) {\r\n            return\r\n        }\r\n        var o = this._get_cell_value(r.buff, g, l);\r\n        if (h == \"int\") {\r\n            r._sort = parseFloat(o);\r\n            r._sort = isNaN(r._sort) ? -99999999999999 : r._sort\r\n        } else {\r\n            r._sort = o\r\n        }\r\n    });\r\n    var e = this;\r\n    var n = 1;\r\n    var m = -1;\r\n    if (a == \"des\") {\r\n        n = -1;\r\n        m = 1\r\n    }\r\n    var c = null ;\r\n    if (typeof h == \"function\") {\r\n        c = function(r, o) {\r\n            return h(r._sort, o._sort, a, r.id, o.id)\r\n        }\r\n    } else {\r\n        if (h == \"cus\") {\r\n            c = function(r, o) {\r\n                return e._customSorts[g](r._sort, o._sort, a, r.id, o.id)\r\n            }\r\n        }\r\n        if (h == \"str\") {\r\n            c = function(r, o) {\r\n                return ( r._sort < o._sort ? m : (r._sort == o._sort ? 0 : n)) \r\n            }\r\n        }\r\n        if (h == \"int\") {\r\n            c = function(r, o) {\r\n                return ( r._sort < o._sort ? m : (r._sort == o._sort ? 0 : n)) \r\n            }\r\n        }\r\n        if (h == \"date\") {\r\n            c = function(r, o) {\r\n                return (Date.parse(new Date(r._sort || \"01/01/1900\")) - Date.parse(new Date(o._sort || \"01/01/1900\"))) * n\r\n            }\r\n        }\r\n    }\r\n    this._sortTreeRows(c, 0);\r\n    this._renderSort(0, true);\r\n    this.callEvent(\"onGridReconstructed\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._sortTreeRows = function(a, g) {\r\n    var c = this._h2.get[g].childs;\r\n    if (this.rowsCol.stablesort) {\r\n        this.rowsCol.stablesort.call(c, a)\r\n    } else {\r\n        c.sort(a)\r\n    }\r\n    for (var e = 0; e < c.length; e++) {\r\n        if (c[e].childs.length) {\r\n            this._sortTreeRows(a, c[e].id)\r\n        }\r\n        c[e].index = e\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._renderSort = function(e, c) {\r\n    this._h2_to_buff();\r\n    var a = this.objBox.scrollTop;\r\n    this._reset_view();\r\n    this.objBox.scrollTop = a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._fixAlterCssTGR = function() {\r\n    if (!this._realfake) {\r\n        this._h2.forEachChild(0, function(a) {\r\n            if (a.buff.tagName == \"TR\") {\r\n                var c = (this._cssSP ? (a.level % 2) : (a.index % 2)) ? this._cssUnEven : this._cssEven;\r\n                this.rowsAr[a.id].className = (c + (this._cssSU ? (\" \" + c + \"_\" + a.level) : \"\")) + \" \" + (this.rowsAr[a.id]._css || \"\") + ((this.rowsAr[a.id].className.indexOf(\"rowselected\") != -1) ? \" rowselected\" : \"\")\r\n            }\r\n        }, this)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.moveRowUDTG = function(c, h) {\r\n    var n = this._h2.get[c];\r\n    var e = n.parent.childs[n.index + h];\r\n    if ((!e) || (e.parent != n.parent)) {\r\n        return\r\n    }\r\n    var a = [n.state, e.state];\r\n    this.collapseKids(this.rowsAr[n.id]);\r\n    this.collapseKids(this.rowsAr[e.id]);\r\n    var g = this.rowsCol._dhx_find(this.rowsAr[c]);\r\n    var m = this.rowsBuffer._dhx_find(this.rowsAr[c]);\r\n    var o = this.obj.rows[0].parentNode.removeChild(this.rowsCol[g]);\r\n    var l = this.rowsCol[g + ((h == 1) ? 2 : h)];\r\n    if (l) {\r\n        l.parentNode.insertBefore(o, l)\r\n    } else {\r\n        this.obj.rows[0].parentNode.appendChild(o)\r\n    }\r\n    this.rowsCol._dhx_swapItems(g, g + h);\r\n    this.rowsBuffer._dhx_swapItems(m, m + h);\r\n    this._h2.swap(e, n);\r\n    if (a[0] == \"minus\") {\r\n        this.expandKids(this.rowsAr[n.id])\r\n    }\r\n    if (a[1] == \"minus\") {\r\n        this.expandKids(this.rowsAr[e.id])\r\n    }\r\n    this._fixAlterCss(Math.min(g, g + h))\r\n}\r\n;\r\nfunction eXcell_tree(a) {\r\n    if (a) {\r\n        this.cell = a;\r\n        this.grid = this.cell.parentNode.grid\r\n    }\r\n    this.isDisabled = function() {\r\n        return this.cell._disabled || this.grid._edtc\r\n    }\r\n    ;\r\n    this.edit = function() {\r\n        if ((this.er) || (this.grid._edtc)) {\r\n            return\r\n        }\r\n        this.er = this.cell.parentNode.valTag;\r\n        this.val = this.getLabel();\r\n        this.cell.atag = ((!this.grid.multiLine) && (_isKHTML || _isMacOS || _isFF)) ? \"INPUT\" : \"TEXTAREA\";\r\n        this.er.innerHTML = \"<\" + this.cell.atag + \" class='dhx_combo_edit' type='text' style='height:\" + (this.cell.offsetHeight - 4) + \"px;line-height:\" + (this.cell.offsetHeight - 6) + \"px; width:100%; border:0px; margin:0px; padding:0px; overflow:hidden;'></\" + this.cell.atag + \">\";\r\n        this.er.childNodes[0].onmousedown = function(c) {\r\n            (c || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.er.childNodes[0].onselectstart = function(c) {\r\n            if (!c) {\r\n                c = event\r\n            }\r\n            c.cancelBubble = true;\r\n            return true\r\n        }\r\n        ;\r\n        this.er.className += \" editable\";\r\n        this.er.firstChild.onclick = function(c) {\r\n            (c || event).cancelBubble = true\r\n        }\r\n        ;\r\n        this.er.firstChild.value = this.val;\r\n        this.obj = this.er.firstChild;\r\n        this.er.firstChild.style.width = Math.max(0, this.cell.offsetWidth - this.er.offsetLeft - 2) + \"px\";\r\n        this.er.firstChild.focus();\r\n        if (_isIE) {\r\n            this.er.firstChild.focus()\r\n        }\r\n    }\r\n    ;\r\n    this.detach = function() {\r\n        if (!this.er) {\r\n            return\r\n        }\r\n        this.setLabel(this.er.firstChild.value);\r\n        this.er.className = this.er.className.replace(\"editable\", \"\");\r\n        var c = (this.val != this.er.innerHTML);\r\n        this.obj = this.er = null ;\r\n        return ( c) \r\n    }\r\n    ;\r\n    this.getValue = function() {\r\n        return this.getLabel()\r\n    }\r\n    ;\r\n    this.setImage = function(c) {\r\n        this.cell.parentNode.imgTag.nextSibling.src = this.grid.iconURL + c;\r\n        this.grid._h2.get[this.cell.parentNode.idd].image = c\r\n    }\r\n    ;\r\n    this.getImage = function() {\r\n        return this.grid._h2.get[this.cell.parentNode.idd].image\r\n    }\r\n    ;\r\n    this.setLabel = function(c) {\r\n        this.setValueA(c)\r\n    }\r\n    ;\r\n    this.getLabel = function(c) {\r\n        return this.cell.parentNode.valTag.innerHTML\r\n    }\r\n}\r\neXcell_tree.prototype = new eXcell;\r\neXcell_tree.prototype.setValueA = function(a) {\r\n    this.cell.parentNode.valTag.innerHTML = a;\r\n    this.grid.callEvent(\"onCellChanged\", [this.cell.parentNode.idd, this.cell._cellIndex, a])\r\n}\r\n;\r\neXcell_tree.prototype.setValue = function(a) {\r\n    if (this.cell.parentNode.imgTag) {\r\n        return this.setLabel(a)\r\n    }\r\n    if ((this.grid._tgc.iconTree == null ) || (this.grid._tgc.iconTree != this.grid.iconTree)) {\r\n        var h = {};\r\n        h.spacer = \"<img src='\" + this.grid.iconTree + \"blank.gif'  align='top' class='space'>\";\r\n        h.imst = \"<img style='margin-top:-2px;' src='\" + this.grid.iconTree;\r\n        h.imsti = \"<img style='padding-top:2px;'  src='\" + (this.grid.iconURL || this.grid.iconTree);\r\n        h.imact = \"' align='top' onclick='this.\" + (_isKHTML ? \"\" : \"parentNode.\") + \"parentNode.parentNode.parentNode.parentNode.grid.doExpand(this);event.cancelBubble=true;'>\";\r\n        h.plus = h.imst + \"plus.gif\" + h.imact;\r\n        h.minus = h.imst + \"minus.gif\" + h.imact;\r\n        h.blank = h.imst + \"blank.gif\" + h.imact;\r\n        h.start = \"<div class='treegrid_cell' style='overflow:hidden; white-space : nowrap; line-height:23px; height:\" + (_isIE ? 21 : 23) + \"px;'>\";\r\n        h.itemim = \"' align='top' \" + (this.grid._img_height ? (' height=\"' + this.grid._img_height + '\"') : \"\") + (this.grid._img_width ? (' width=\"' + this.grid._img_width + '\"') : \"\") + \" ><span id='nodeval'>\";\r\n        h.close = \"</span></div>\";\r\n        this.grid._tgc = h\r\n    }\r\n    var l = this.grid._h2;\r\n    var h = this.grid._tgc;\r\n    var g = this.cell.parentNode.idd;\r\n    var m = this.grid._h2.get[g];\r\n    if (this.grid.kidsXmlFile || this.grid._slowParse) {\r\n        m.has_kids = (m.has_kids || (this.cell.parentNode._attrs.xmlkids && (m.state != \"minus\")));\r\n        m._xml_await = !!m.has_kids\r\n    }\r\n    m.image = m.image || (this.cell._attrs.image || \"leaf.gif\");\r\n    m.label = a;\r\n    var e = [h.start];\r\n    for (var c = 0; c < m.level; c++) {\r\n        e.push(h.spacer)\r\n    }\r\n    if (m.has_kids) {\r\n        e.push(h.plus);\r\n        m.state = \"plus\"\r\n    } else {\r\n        e.push(h.imst + m.state + \".gif\" + h.imact)\r\n    }\r\n    e.push(h.imsti);\r\n    e.push(m.image);\r\n    e.push(h.itemim);\r\n    e.push(m.label);\r\n    e.push(h.close);\r\n    this.cell.innerHTML = e.join(\"\");\r\n    this.cell._treeCell = true;\r\n    this.cell.parentNode.imgTag = this.cell.childNodes[0].childNodes[m.level];\r\n    this.cell.parentNode.valTag = this.cell.childNodes[0].childNodes[m.level + 2];\r\n    if (_isKHTML) {\r\n        this.cell.vAlign = \"top\"\r\n    }\r\n    if (m.parent.id != 0 && m.parent.state == \"plus\") {\r\n        this.grid._updateTGRState(m.parent, false);\r\n        this.cell.parentNode._skipInsert = true\r\n    }\r\n    this.grid.callEvent(\"onCellChanged\", [g, this.cell._cellIndex, a])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._process_tree_xml = function(l, c) {\r\n    this._parsing = true;\r\n    var a = false;\r\n    if (!c) {\r\n        this.render_row = this.render_row_tree;\r\n        a = true;\r\n        c = l.getAttribute(\"parent\") || 0;\r\n        if (c == \"0\") {\r\n            c = 0\r\n        }\r\n        if (!this._h2) {\r\n            this._h2 = this._createHierarchy()\r\n        }\r\n        if (this._fake) {\r\n            this._fake._h2 = this._h2\r\n        }\r\n    }\r\n    var h = dhx4.ajax.xpath(this.xml.row, l);\r\n    this._open = this._open || [];\r\n    for (var e = 0; e < h.length; e++) {\r\n        var n = h[e].getAttribute(\"id\");\r\n        if (!n) {\r\n            n = this.uid();\r\n            h[e].setAttribute(\"id\", n)\r\n        }\r\n        var m = this._h2.add(n, c);\r\n        m.buff = {\r\n            idd: n,\r\n            data: h[e],\r\n            _parser: this._process_xml_row,\r\n            _locator: this._get_xml_data\r\n        };\r\n        if (h[e].getAttribute(\"open\")) {\r\n            m.state = \"minus\";\r\n            this._open.push(n)\r\n        }\r\n        this.rowsAr[n] = m.buff;\r\n        this._process_tree_xml(h[e], n)\r\n    }\r\n    if (a) {\r\n        if (!h.length) {\r\n            this._h2.change(c, \"state\", this._emptyLineImg)\r\n        } else {\r\n            if (c != 0 && !this._srnd) {\r\n                this._h2.change(c, \"state\", \"minus\")\r\n            }\r\n        }\r\n        for (var e = 0; e < this._open.length; e++) {\r\n            var g = this._h2.get[this._open[e]];\r\n            if (!g.childs.length) {\r\n                g.state = this._emptyLineImg\r\n            }\r\n        }\r\n        this._updateTGRState(this._h2.get[c]);\r\n        this._h2_to_buff();\r\n        if (c != 0 && this._srnd) {\r\n            this.openItem(c)\r\n        } else {\r\n            if (this.pagingOn) {\r\n                this._renderSort()\r\n            } else {\r\n                this.render_dataset()\r\n            }\r\n        }\r\n        if (this.kidsXmlFile) {\r\n            for (var e = 0; e < this._open.length; e++) {\r\n                var g = this._h2.get[this._open[e]];\r\n                if (g._xml_await) {\r\n                    this.expandKids({\r\n                        idd: g.id\r\n                    })\r\n                }\r\n            }\r\n        }\r\n        this._open = [];\r\n        if (this._slowParse === false) {\r\n            this.forEachRow(function(o) {\r\n                this.render_row_tree(0, o)\r\n            })\r\n        }\r\n        this._parsing = false;\r\n        if (c != 0 && !this._srnd) {\r\n            this.callEvent(\"onOpenEnd\", [c, 1])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._h2_to_buff = function(c) {\r\n    if (!c) {\r\n        c = this._h2.get[0];\r\n        this.rowsBuffer = new dhtmlxArray();\r\n        if (this._fake && !this._realfake) {\r\n            this._fake.rowsBuffer = this.rowsBuffer\r\n        }\r\n    }\r\n    for (var a = 0; a < c.childs.length; a++) {\r\n        this.rowsBuffer.push(c.childs[a].buff);\r\n        if (c.childs[a].state == \"minus\") {\r\n            this._h2_to_buff(c.childs[a])\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.render_row_tree = function(c, g) {\r\n    if (g) {\r\n        var a = this._h2.get[g];\r\n        a = a ? a.buff : a\r\n    } else {\r\n        var a = this.rowsBuffer[c]\r\n    }\r\n    if (!a) {\r\n        return -1\r\n    }\r\n    if (a._parser) {\r\n        if (this.rowsAr[a.idd] && this.rowsAr[a.idd].tagName == \"TR\") {\r\n            return this._h2.get[a.idd].buff = this.rowsBuffer[c] = this.rowsAr[a.idd]\r\n        }\r\n        var e = this._prepareRow(a.idd);\r\n        this.rowsAr[a.idd] = e;\r\n        if (!g) {\r\n            this.rowsBuffer[c] = e\r\n        }\r\n        this._h2.get[a.idd].buff = e;\r\n        a._parser.call(this, e, a.data);\r\n        this._postRowProcessing(e);\r\n        return e\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._removeTrGrRow = function(g, c) {\r\n    if (c) {\r\n        this._h2.forEachChild(c.id, function(l) {\r\n            this._removeTrGrRow(null , l);\r\n            delete this.rowsAr[l.id]\r\n        }, this);\r\n        return\r\n    }\r\n    var h = this.getRowIndex(g.idd);\r\n    var c = this._h2.get[g.idd];\r\n    if (h != -1 && h !== this.undefined) {\r\n        var a = 1;\r\n        if (c && c.state == \"minus\") {\r\n            a += this._getOpenLenght(c.id, 0)\r\n        }\r\n        for (var e = 0; e < a; e++) {\r\n            if (this.rowsCol[e + h]) {\r\n                this.rowsCol[e + h].parentNode.removeChild(this.rowsCol[e + h])\r\n            }\r\n        }\r\n        if (this._fake) {\r\n            for (var e = 0; e < a; e++) {\r\n                if (this._fake.rowsCol[e + h]) {\r\n                    this._fake.rowsCol[e + h].parentNode.removeChild(this._fake.rowsCol[e + h])\r\n                }\r\n            }\r\n            if (a > 1) {\r\n                this._fake.rowsCol.splice(h + 1, a - 1)\r\n            }\r\n        }\r\n        this.rowsCol.splice(h, a);\r\n        this.rowsBuffer.splice(h, a)\r\n    }\r\n    if (!c) {\r\n        return\r\n    }\r\n    this._removeTrGrRow(null , c);\r\n    delete this.rowsAr[c.id];\r\n    if (c.parent.childs.length == 1) {\r\n        this._h2.change(c.parent.id, \"state\", this._emptyLineImg);\r\n        this._updateTGRState(c.parent)\r\n    }\r\n    this._h2.remove(c.id)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.openItem = function(c) {\r\n    var e = this._h2.get[c || 0];\r\n    var a = this.getRowById(c || 0);\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (e.parent && e.parent.id != 0) {\r\n        this.openItem(e.parent.id)\r\n    }\r\n    this.expandKids(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._addRowClassic = dhtmlXGridObject.prototype.addRow;\r\ndhtmlXGridObject.prototype.addRow = function(c, m, h, g, a, n) {\r\n    if (!this._h2) {\r\n        return this._addRowClassic(c, m, h)\r\n    }\r\n    g = g || 0;\r\n    var e = this.cellType._dhx_find(\"tree\");\r\n    if (typeof (m) == \"string\") {\r\n        m = m.split(this.delim)\r\n    }\r\n    var l = this._h2.get[c];\r\n    if (!l) {\r\n        if (g == 0) {\r\n            h = this.rowsBuffer.length\r\n        } else {\r\n            h = this.getRowIndex(g) + 1;\r\n            if (this._h2.get[g].state == \"minus\") {\r\n                h += this._getOpenLenght(g, 0)\r\n            } else {\r\n                this._skipInsert = true\r\n            }\r\n        }\r\n    }\r\n    l = l || this._h2.add(c, g);\r\n    l.image = a;\r\n    l.has_kids = n;\r\n    return l.buff = this._addRowClassic(c, m, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.addRowBefore = function(e, l, g, c, n) {\r\n    var m = this.rowsAr[g];\r\n    if (!m) {\r\n        return\r\n    }\r\n    if (!this._h2) {\r\n        return this.addRow(e, l, this.getRowIndex(g))\r\n    }\r\n    var a = this._h2.get[g].parent.id;\r\n    var h = this.getRowIndex(g);\r\n    if (h == -1) {\r\n        this._skipInsert = true\r\n    }\r\n    this._h2.addBefore(e, a, g);\r\n    return this.addRow(e, l, h, this._h2.get[g].parent.id, c, n)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.addRowAfter = function(e, l, g, c, n) {\r\n    var m = this.rowsAr[g];\r\n    if (!m) {\r\n        return\r\n    }\r\n    if (!this._h2) {\r\n        return this.addRow(e, l, this.getRowIndex(g) + 1)\r\n    }\r\n    var a = this._h2.get[g].parent.id;\r\n    var h = this.getRowIndex(g);\r\n    if (h == -1) {\r\n        this._skipInsert = true\r\n    }\r\n    if (this._h2.get[g].state == \"minus\") {\r\n        h += this._getOpenLenght(g, 0) + 1\r\n    } else {\r\n        h++\r\n    }\r\n    this._h2.addAfter(e, a, g);\r\n    return this.addRow(e, l, h, a, c, n)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableSmartXMLParsing = function(a) {\r\n    this._slowParse = dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._copyTreeGridRowContent = function(a, c, e) {\r\n    var g = this.cellType._dhx_find(\"tree\");\r\n    for (i = 0; i < a.cells.length; i++) {\r\n        if (i != g) {\r\n            this.cells(e, i).setValue(this.cells(c, i).getValue())\r\n        } else {\r\n            this.cells(e, i).setValueA(this.cells(c, i).getValue())\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.closeItem = function(c) {\r\n    var a = this.getRowById(c);\r\n    if (!a) {\r\n        return\r\n    }\r\n    this.collapseKids(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.deleteChildItems = function(a) {\r\n    var c = this._h2.get[a];\r\n    if (!c) {\r\n        return\r\n    }\r\n    while (c.childs.length) {\r\n        this.deleteRow(c.childs[0].id)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getAllSubItems = function(c) {\r\n    var g = [];\r\n    var e = this._h2.get[c || 0];\r\n    if (e) {\r\n        for (var a = 0; a < e.childs.length; a++) {\r\n            g.push(e.childs[a].id);\r\n            if (e.childs[a].childs.length) {\r\n                g = g.concat(this.getAllSubItems(e.childs[a].id).split(this.delim))\r\n            }\r\n        }\r\n    }\r\n    return g.join(this.delim)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getChildItemIdByIndex = function(c, a) {\r\n    var e = this._h2.get[c || 0];\r\n    if (!e) {\r\n        return null \r\n    }\r\n    return ( e.childs[a] ? e.childs[a].id : null ) \r\n}\r\n;\r\ndhtmlXGridObject.prototype.getItemText = function(a) {\r\n    return this.cells(a, this.cellType._dhx_find(\"tree\")).getLabel()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getOpenState = function(a) {\r\n    var c = this._h2.get[a || 0];\r\n    if (!c) {\r\n        return\r\n    }\r\n    if (c.state == \"minus\") {\r\n        return true\r\n    }\r\n    return false\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getParentId = function(a) {\r\n    var c = this._h2.get[a || 0];\r\n    if ((!c) || (!c.parent)) {\r\n        return null \r\n    }\r\n    return c.parent.id\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getSubItems = function(c) {\r\n    var g = [];\r\n    var e = this._h2.get[c || 0];\r\n    if (e) {\r\n        for (var a = 0; a < e.childs.length; a++) {\r\n            g.push(e.childs[a].id)\r\n        }\r\n    }\r\n    return g.join(this.delim)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.expandAll = function(a) {\r\n    this._renderAllExpand(a || 0);\r\n    this._h2_to_buff();\r\n    this._reset_view();\r\n    this.setSizes();\r\n    this.callEvent(\"onGridReconstructed\", []);\r\n    if (this._redrawLines) {\r\n        this._redrawLines()\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._renderAllExpand = function(e) {\r\n    var a = this._h2.get[e].childs;\r\n    for (var c = 0; c < a.length; c++) {\r\n        if (a[c].childs.length) {\r\n            this._h2.change(a[c].id, \"state\", \"minus\");\r\n            this._updateTGRState(a[c]);\r\n            this._renderAllExpand(a[c].id)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.collapseAll = function(a) {\r\n    this._h2.forEachChild((a || 0), function(c) {\r\n        if (c && c.state == \"minus\") {\r\n            c.state = \"plus\";\r\n            c.update = true;\r\n            this._updateTGRState(c)\r\n        }\r\n    }, this);\r\n    this._h2_to_buff();\r\n    this._reset_view();\r\n    this.setSizes();\r\n    this.callEvent(\"onGridReconstructed\", []);\r\n    if (this._redrawLines) {\r\n        this._redrawLines()\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.hasChildren = function(c) {\r\n    var a = this._h2.get[c];\r\n    if (a && a.childs.length) {\r\n        return a.childs.length\r\n    }\r\n    if (a._xml_await) {\r\n        return -1\r\n    }\r\n    return 0\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setItemCloseable = function(e, c) {\r\n    var a = this._h2.get[e];\r\n    if (!a) {\r\n        return\r\n    }\r\n    a._closeable = (!dhx4.s2b(c))\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setItemText = function(a, c) {\r\n    return this.cells(a, this.cellType._dhx_find(\"tree\")).setLabel(c)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setItemImage = function(c, a) {\r\n    this._h2.get[c].image = a;\r\n    this.rowsAr[c].imgTag.nextSibling.src = (this.iconURL || \"\") + a\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getItemImage = function(a) {\r\n    this.getRowById(a);\r\n    return this._h2.get[a].image\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setImageSize = function(c, a) {\r\n    this._img_width = c;\r\n    this._img_height = a\r\n}\r\n;\r\ndhtmlXGridObject.prototype._getRowImage = function(a) {\r\n    return this._h2.get[a.idd].image\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setOnOpenStartHandler = function(a) {\r\n    this.attachEvent(\"onOpenStart\", a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setOnOpenEndHandler = function(a) {\r\n    this.attachEvent(\"onOpenEnd\", a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableTreeCellEdit = function(a) {\r\n    this._edtc = !dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.getLevel = function(a) {\r\n    var c = this._h2.get[a || 0];\r\n    if (!c) {\r\n        return -1\r\n    }\r\n    return c.level\r\n}\r\n;\r\ndhtmlXGridObject.prototype._fixHiddenRowsAllTG = function(c, a) {\r\n    for (i in this.rowsAr) {\r\n        if ((this.rowsAr[i]) && (this.rowsAr[i].childNodes)) {\r\n            this.rowsAr[i].childNodes[c].style.display = a\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._updateLine = function(e, c) {\r\n    c = c || this.rowsAr[e.id];\r\n    if (!c) {\r\n        return\r\n    }\r\n    var a = c.imgTag;\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (e.state == \"blank\") {\r\n        return a.src = this.iconTree + \"blank.gif\"\r\n    }\r\n    var g = 1;\r\n    if (e.index == 0) {\r\n        if (e.level == 0) {\r\n            if ((e.parent.childs.length - 1) > e.index) {\r\n                g = 3\r\n            } else {\r\n                g = 1\r\n            }\r\n        } else {\r\n            if ((e.parent.childs.length - 1) > e.index) {\r\n                g = 3\r\n            } else {\r\n                g = 2\r\n            }\r\n        }\r\n    } else {\r\n        if ((e.parent.childs.length - 1) > e.index) {\r\n            g = 3\r\n        } else {\r\n            g = 2\r\n        }\r\n    }\r\n    a.src = this.iconTree + e.state + g + \".gif\"\r\n}\r\n;\r\ndhtmlXGridObject.prototype._updateParentLine = function(g, e) {\r\n    e = e || this.rowsAr[g.id];\r\n    if (!e) {\r\n        return\r\n    }\r\n    var a = e.imgTag;\r\n    if (!a) {\r\n        return\r\n    }\r\n    for (var c = g.level; c > 0; c--) {\r\n        if (g.id == 0) {\r\n            break\r\n        }\r\n        a = a.previousSibling;\r\n        g = g.parent;\r\n        if ((g.parent.childs.length - 1) > g.index) {\r\n            a.src = this.iconTree + \"line1.gif\"\r\n        } else {\r\n            a.src = this.iconTree + \"blank.gif\"\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._renderSortA = dhtmlXGridObject.prototype._renderSort;\r\ndhtmlXGridObject.prototype._renderSort = function() {\r\n    this._renderSortA.apply(this, arguments);\r\n    this._redrawLines(0)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._redrawLines = function(a) {\r\n    if (this._tgle) {\r\n        this._h2.forEachChild((a || 0), function(c) {\r\n            this._updateLine(c);\r\n            this._updateParentLine(c)\r\n        }, this)\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype.enableTreeGridLines = function() {\r\n    this._emptyLineImg = \"line\";\r\n    this._updateTGRState = function(c, a) {\r\n        if (a || !c.update || c.id == 0) {\r\n            return\r\n        }\r\n        if (this._tgle) {\r\n            this._updateLine(c, this.rowsAr[c.id])\r\n        }\r\n        c.update = false\r\n    }\r\n    ;\r\n    this._tgle = true;\r\n    this.attachEvent(\"onXLE\", function(e, c, g) {\r\n        this._redrawLines(g)\r\n    });\r\n    this.attachEvent(\"onOpenEnd\", function(a) {\r\n        this._redrawLines(a)\r\n    });\r\n    this.attachEvent(\"onRowAdded\", function(c) {\r\n        var a = this._h2.get[c];\r\n        this._updateLine(a);\r\n        this._updateParentLine(a);\r\n        if (a.index < (a.parent.childs.length - 1)) {\r\n            a = a.parent.childs[a.index + 1];\r\n            this._updateLine(a);\r\n            this._updateParentLine(a)\r\n        } else {\r\n            if (a.index != 0) {\r\n                a = a.parent.childs[a.index - 1];\r\n                this._updateLine(a);\r\n                this._updateParentLine(a);\r\n                if (a.childs.length) {\r\n                    this._h2.forEachChild(a.id, function(e) {\r\n                        this._updateParentLine(e)\r\n                    }, this)\r\n                }\r\n            }\r\n        }\r\n    });\r\n    this.attachEvent(\"onOpen\", function(g, c) {\r\n        if (c) {\r\n            var e = this._h2.get[g];\r\n            for (var a = 0; a < e.childs.length; a++) {\r\n                this._updateParentLine(e.childs[a])\r\n            }\r\n        }\r\n        return true\r\n    });\r\n    this.attachEvent(\"onBeforeRowDeleted\", function(g) {\r\n        var c = this;\r\n        var e = this._h2.get[g];\r\n        var a = null ;\r\n        if (e.index != 0) {\r\n            a = e.parent.childs[e.index - 1]\r\n        }\r\n        e = e.parent;\r\n        window.setTimeout(function() {\r\n            e = c._h2.get[e.id];\r\n            if (!e) {\r\n                return\r\n            }\r\n            c._updateLine(e);\r\n            c._updateParentLine(e);\r\n            if (a) {\r\n                c._updateLine(a);\r\n                if (a.state == \"minus\") {\r\n                    c._h2.forEachChild(a.id, function(h) {\r\n                        c._updateParentLine(h)\r\n                    }, c)\r\n                }\r\n            }\r\n        }, 1);\r\n        return true\r\n    })\r\n}\r\n;\r\ndhtmlXGridObject.prototype.setFiltrationLevel = function(e, a, c) {\r\n    this._tr_strfltr = e;\r\n    this._tr_fltr_c = a;\r\n    this._tr_fltr_d = c;\r\n    this.refreshFilters()\r\n}\r\n;\r\ndhtmlXGridObject.prototype.filterTreeBy = function(g, h, e) {\r\n    var a = this._h2;\r\n    if (typeof this._tr_strfltr == \"undefined\") {\r\n        this._tr_strfltr = -1\r\n    }\r\n    if (this._f_rowsBuffer) {\r\n        if (!e) {\r\n            this._h2 = this._f_rowsBuffer;\r\n            if (this._fake) {\r\n                this._fake._h2 = this._h2\r\n            }\r\n        }\r\n    } else {\r\n        this._f_rowsBuffer = this._h2\r\n    }\r\n    var l = true;\r\n    this.dma(true);\r\n    this._fbf = {};\r\n    if (typeof (g) == \"object\") {\r\n        for (var c = 0; c < h.length; c++) {\r\n            this._filterTreeA(g[c], h[c])\r\n        }\r\n    } else {\r\n        this._filterTreeA(g, h)\r\n    }\r\n    this._fbf = null ;\r\n    this.dma(false);\r\n    this._fix_filtered_images(this._h2, a);\r\n    this._renderSort();\r\n    this.callEvent(\"onGridReconstructed\", [])\r\n}\r\n;\r\ndhtmlXGridObject.prototype._filterTreeA = function(e, o) {\r\n    if (o == \"\") {\r\n        return\r\n    }\r\n    var m = true;\r\n    if (typeof (o) == \"function\") {\r\n        m = false\r\n    } else {\r\n        o = (o || \"\").toString().toLowerCase()\r\n    }\r\n    var c = function(w, v, u) {\r\n        var x = u.get[w.parent.id];\r\n        if (!x) {\r\n            x = c(w.parent, v, u)\r\n        }\r\n        var u = r.get[w.id];\r\n        if (!u) {\r\n            u = {\r\n                id: w.id,\r\n                childs: [],\r\n                level: w.level,\r\n                parent: x,\r\n                index: x.childs.length,\r\n                image: w.image,\r\n                state: w.state,\r\n                buff: w.buff,\r\n                has_kids: w.has_kids,\r\n                _xml_await: w._xml_await\r\n            };\r\n            x.childs.push(u);\r\n            r.get[u.id] = u\r\n        }\r\n        return u\r\n    }\r\n    ;\r\n    var n = this._fbf;\r\n    var r = this._createHierarchy();\r\n    var a;\r\n    var h = this._tr_strfltr;\r\n    var l = this;\r\n    var g = function(u) {\r\n        for (var s = 0; s < u.childs.length; s++) {\r\n            l.temp(u.childs[s])\r\n        }\r\n    }\r\n    ;\r\n    switch (h.toString()) {\r\n    case \"-2\":\r\n        a = function(s) {\r\n            if (n[s.id]) {\r\n                return false\r\n            }\r\n            g(s);\r\n            return true\r\n        }\r\n        ;\r\n        break;\r\n    case \"-1\":\r\n        a = function(s) {\r\n            return !s.childs.length\r\n        }\r\n        ;\r\n        break;\r\n    default:\r\n        a = function(s) {\r\n            return h == s.level\r\n        }\r\n        ;\r\n        break\r\n    }\r\n    this.temp = function(s) {\r\n        if (s.id != 0 && a(s)) {\r\n            if (m ? (this._get_cell_value(s.buff, e).toString().toLowerCase().indexOf(o) == -1) : (!o(this._get_cell_value(s.buff, e), s.id))) {\r\n                n[s.id] = true;\r\n                if (this._tr_fltr_c) {\r\n                    c(s.parent, this._h2, r)\r\n                }\r\n                return false\r\n            } else {\r\n                c(s, this._h2, r);\r\n                if (s.childs && h != -2) {\r\n                    this._h2.forEachChild(s.id, function(u) {\r\n                        c(u, this._h2, r)\r\n                    }, this)\r\n                }\r\n                return true\r\n            }\r\n        } else {\r\n            if (this._tr_fltr_d && this._tr_strfltr > s.level && s.id != 0) {\r\n                c(s, this._h2, r)\r\n            }\r\n            g(s)\r\n        }\r\n    }\r\n    ;\r\n    this.temp(this._h2.get[0]);\r\n    this._h2 = r;\r\n    if (this._fake) {\r\n        this._fake._h2 = this._h2\r\n    }\r\n}\r\n;\r\ndhtmlXGridObject.prototype._fix_filtered_images = function(c, a) {\r\n    c.forEachChild(0, function(e) {\r\n        if (!e.childs.length && !e.has_kids) {\r\n            if (e.state != this._emptyLineImg) {\r\n                e.state = this._emptyLineImg;\r\n                e.update = true;\r\n                this._updateTGRState(e)\r\n            }\r\n        } else {\r\n            if (e.buff.tagName == \"TR\") {\r\n                var g = a.get[e.id];\r\n                if (g && g.state != this._emptyLineImg) {\r\n                    e.state = g.state\r\n                }\r\n                e.update = true;\r\n                this._updateTGRState(e)\r\n            }\r\n        }\r\n    }, this)\r\n}\r\n;\r\ndhtmlXGridObject.prototype.collectTreeValues = function(e) {\r\n    if (typeof this._tr_strfltr == \"undefined\") {\r\n        this._tr_strfltr = -1\r\n    }\r\n    this.dma(true);\r\n    this._build_m_order();\r\n    e = this._m_order ? this._m_order[e] : e;\r\n    var m = {};\r\n    var h = [];\r\n    var a = this._f_rowsBuffer || this._h2;\r\n    a.forEachChild(0, function(c) {\r\n        if (this._tr_strfltr == -2 || (this._tr_strfltr == -1 && !c.childs.length) || (this._tr_strfltr == c.level)) {\r\n            var n = this._get_cell_value(c.buff, e);\r\n            if (n) {\r\n                m[n] = true\r\n            }\r\n        }\r\n    }, this);\r\n    this.dma(false);\r\n    var g = this.combos[e];\r\n    for (var l in m) {\r\n        if (m[l] === true) {\r\n            h.push(g ? (g.get(l) || l) : l)\r\n        }\r\n    }\r\n    return h.sort()\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_total = function(e, a, h) {\r\n    var g = function() {\r\n        var l = 0;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        this._h2.forEachChild(0, function(n) {\r\n            var m = parseFloat(this._get_cell_value((n.buff || this.rowsAr[n.id]), c));\r\n            l += isNaN(m) ? 0 : m\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(l, a) : (Math.round(l * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_total_leaf = function(e, a, h) {\r\n    var g = function() {\r\n        var l = 0;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        this._h2.forEachChild(0, function(n) {\r\n            if (n.childs.length) {\r\n                return\r\n            }\r\n            var m = parseFloat(this._get_cell_value((n.buff || this.rowsAr[n.id]), c));\r\n            l += isNaN(m) ? 0 : m\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(l, a) : (Math.round(l * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_multi_total = function(e, a, l) {\r\n    var h = l[1].split(\":\");\r\n    l[1] = \"\";\r\n    var g = function() {\r\n        var c = 0;\r\n        this._h2.forEachChild(0, function(n) {\r\n            var m = parseFloat(this._get_cell_value((n.buff || this.rowsAr[n.id]), h[0])) * parseFloat(this._get_cell_value((n.buff || this.rowsAr[n.id]), h[1]));\r\n            c += isNaN(m) ? 0 : m\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(c, a) : (Math.round(c * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, l, l)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_multi_total_leaf = function(e, a, l) {\r\n    var h = l[1].split(\":\");\r\n    l[1] = \"\";\r\n    var g = function() {\r\n        var c = 0;\r\n        this._h2.forEachChild(0, function(n) {\r\n            if (n.childs.length) {\r\n                return\r\n            }\r\n            var m = parseFloat(this._get_cell_value((n.buff || this.rowsAr[n.id]), h[0])) * parseFloat(this._get_cell_value((n.buff || this.rowsAr[n.id]), h[1]));\r\n            c += isNaN(m) ? 0 : m\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(c, a) : (Math.round(c * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, l, l)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_max = function(e, a, h) {\r\n    var g = function() {\r\n        var l = -999999999;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"\"\r\n        }\r\n        this._h2.forEachChild(0, function(m) {\r\n            var n = parseFloat(this._get_cell_value((m.buff || this.rowsAr[m.id]), c));\r\n            if (!isNaN(n)) {\r\n                l = Math.max(l, n)\r\n            }\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(l, a) : l\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_min = function(e, a, h) {\r\n    var g = function() {\r\n        var l = 999999999;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"\"\r\n        }\r\n        this._h2.forEachChild(0, function(m) {\r\n            var n = parseFloat(this._get_cell_value((m.buff || this.rowsAr[m.id]), c));\r\n            if (!isNaN(n)) {\r\n                l = Math.min(l, n)\r\n            }\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(l, a) : l\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_average = function(e, a, h) {\r\n    var g = function() {\r\n        var m = 0;\r\n        var l = 0;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        this._h2.forEachChild(0, function(o) {\r\n            var n = parseFloat(this._get_cell_value((o.buff || this.rowsAr[o.id]), c));\r\n            m += isNaN(n) ? 0 : n;\r\n            l++\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(m, a) : (Math.round(m / l * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_max_leaf = function(e, a, h) {\r\n    var g = function() {\r\n        var l = -999999999;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"\"\r\n        }\r\n        this._h2.forEachChild(0, function(m) {\r\n            if (m.childs.length) {\r\n                return\r\n            }\r\n            var n = parseFloat(this._get_cell_value((m.buff || this.rowsAr[m.id]), c));\r\n            if (!isNaN(n)) {\r\n                l = Math.max(l, n)\r\n            }\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(l, a) : l\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_min_leaf = function(e, a, h) {\r\n    var g = function() {\r\n        var l = 999999999;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        if (this.getRowsNum() == 0) {\r\n            return \"\"\r\n        }\r\n        this._h2.forEachChild(0, function(m) {\r\n            if (m.childs.length) {\r\n                return\r\n            }\r\n            var n = parseFloat(this._get_cell_value((m.buff || this.rowsAr[m.id]), c));\r\n            if (!isNaN(n)) {\r\n                l = Math.min(l, n)\r\n            }\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(l, a) : l\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_average_leaf = function(e, a, h) {\r\n    var g = function() {\r\n        var m = 0;\r\n        var l = 0;\r\n        this._build_m_order();\r\n        var c = this._m_order ? this._m_order[a] : a;\r\n        this._h2.forEachChild(0, function(o) {\r\n            if (o.childs.length) {\r\n                return\r\n            }\r\n            var n = parseFloat(this._get_cell_value((o.buff || this.rowsAr[o.id]), c));\r\n            m += isNaN(n) ? 0 : n;\r\n            l++\r\n        }, this);\r\n        return this._maskArr[a] ? this._aplNF(m, a) : (Math.round(m / l * 100) / 100)\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_count = function(e, a, h) {\r\n    var g = function() {\r\n        var c = 0;\r\n        this._h2.forEachChild(0, function(l) {\r\n            c++\r\n        }, this);\r\n        return c\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._in_header_stat_tree_count_leaf = function(e, a, h) {\r\n    var g = function() {\r\n        var c = 0;\r\n        this._h2.forEachChild(0, function(l) {\r\n            if (!l.childs.length) {\r\n                c++\r\n            }\r\n        }, this);\r\n        return c\r\n    }\r\n    ;\r\n    this._stat_in_header(e, g, a, h)\r\n}\r\n;\r\ndhtmlXGridObject.prototype._stat_in_header = function(e, g, a, m) {\r\n    var h = this;\r\n    var l = function() {\r\n        this.dma(true);\r\n        e.innerHTML = (m[0] ? m[0] : \"\") + g.call(this) + (m[1] ? m[1] : \"\");\r\n        this.dma(false);\r\n        this.callEvent(\"onStatReady\", [])\r\n    }\r\n    ;\r\n    if (!this._stat_events) {\r\n        this._stat_events = [];\r\n        this.attachEvent(\"onClearAll\", function() {\r\n            if (!this.hdr.rows[1]) {\r\n                for (var n = 0; n < this._stat_events.length; n++) {\r\n                    for (var c = 0; c < 4; c++) {\r\n                        this.detachEvent(this._stat_events[n][c])\r\n                    }\r\n                }\r\n                this._stat_events = []\r\n            }\r\n        })\r\n    }\r\n    this._stat_events.push([this.attachEvent(\"onGridReconstructed\", l), this.attachEvent(\"onXLE\", l), this.attachEvent(\"onFilterEnd\", l), this.attachEvent(\"onEditCell\", function(c, o, n) {\r\n        if (c == 2 && n == a) {\r\n            l.call(this)\r\n        }\r\n        return true\r\n    })]);\r\n    e.innerHTML = \"\"\r\n}\r\n;\r\ndhtmlXGridObject.prototype._build_m_order = function() {\r\n    if (this._c_order) {\r\n        this._m_order = [];\r\n        for (var a = 0; a < this._c_order.length; a++) {\r\n            this._m_order[this._c_order[a]] = a\r\n        }\r\n    }\r\n}\r\n;\r\nfunction dhtmlXForm(h, g, l) {\r\n    this.idef = {\r\n        position: \"label-left\",\r\n        labelWidth: \"auto\",\r\n        labelHeight: \"auto\",\r\n        inputWidth: \"auto\",\r\n        inputHeight: \"auto\",\r\n        labelAlign: \"left\",\r\n        noteWidth: \"auto\",\r\n        offsetTop: 0,\r\n        offsetLeft: 0,\r\n        blockOffset: 20\r\n    };\r\n    this.idef_const = {\r\n        offsetNested: 20\r\n    };\r\n    this.apos_css = {\r\n        \"label-left\": \"dhxform_item_label_left\",\r\n        \"label-right\": \"dhxform_item_label_right\",\r\n        \"label-top\": \"dhxform_item_label_top\",\r\n        \"label-bottom\": \"dhxform_item_label_bottom\",\r\n        absolute: \"dhxform_item_absolute\"\r\n    };\r\n    this.align_css = {\r\n        left: \"dhxform_label_align_left\",\r\n        center: \"dhxform_label_align_center\",\r\n        right: \"dhxform_label_align_right\"\r\n    };\r\n    var e = this;\r\n    this.setSkin = function(a) {\r\n        this.skin = a;\r\n        this.cont.className = \"dhxform_obj_\" + this.skin;\r\n        this.cont.style.fontSize = (a == \"dhx_terrace\" ? \"13px\" : \"12px\");\r\n        this._updateBlocks();\r\n        this.forEachItem(function(n) {\r\n            var m = e.getItemType(n);\r\n            if (typeof (e.items[m]) != \"undefined\" && typeof (e.items[m].setSkin) == \"function\") {\r\n                e.doWithItem(n, \"setSkin\", a)\r\n            }\r\n        })\r\n    }\r\n    ;\r\n    this.skin = (l || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhx_form\") || \"dhx_skyblue\");\r\n    this.separator = \",\";\r\n    this.live_validate = false;\r\n    this._type = \"checkbox\";\r\n    this._rGroup = \"default\";\r\n    this._idIndex = {};\r\n    this._indexId = [];\r\n    this.cont = (typeof (h) == \"object\" ? h : document.getElementById(h));\r\n    if (!h._isNestedForm) {\r\n        this._parentForm = true;\r\n        this.cont.style.fontSize = (this.skin == \"dhx_terrace\" ? \"13px\" : \"12px\");\r\n        this.cont.className = \"dhxform_obj_\" + this.skin;\r\n        this.setFontSize = function(a) {\r\n            this.cont.style.fontSize = a;\r\n            this._updateBlocks()\r\n        }\r\n        ;\r\n        this.getForm = function() {\r\n            return this\r\n        }\r\n        ;\r\n        this.cont.onkeypress = function(m) {\r\n            m = (m || event);\r\n            if (m.keyCode == 13) {\r\n                var a = (m.target || m.srcElement);\r\n                if (typeof (a.tagName) != \"undefined\" && String(a.tagName).toLowerCase() == \"textarea\" && !m.ctrlKey) {\r\n                    return\r\n                }\r\n                e.callEvent(\"onEnter\", [])\r\n            }\r\n        }\r\n    }\r\n    this.b_index = null ;\r\n    this.base = [];\r\n    this._prepare = function(u, v) {\r\n        if (this.b_index == null ) {\r\n            this.b_index = 0\r\n        } else {\r\n            this.b_index++\r\n        }\r\n        var n = null ;\r\n        var m = null ;\r\n        if (v != null ) {\r\n            if (v < 0) {\r\n                v = 0\r\n            }\r\n            var r = 0;\r\n            for (var a = 0; a < this.cont.childNodes.length; a++) {\r\n                for (var s = 0; s < this.cont.childNodes[a].childNodes.length; s++) {\r\n                    if (m == null  && this.cont.childNodes[a].childNodes[s]._isNestedForm != true) {\r\n                        if (r == v) {\r\n                            n = this.cont.childNodes[a].nextSibling;\r\n                            m = this.cont.childNodes[a].childNodes[s]\r\n                        }\r\n                        r++\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.base[this.b_index] = document.createElement(\"DIV\");\r\n        this.base[this.b_index].className = \"dhxform_base\";\r\n        if (typeof (u) != \"undefined\") {\r\n            this.base[this.b_index].style.cssText += \" margin-left:\" + u + \"px!important;\"\r\n        }\r\n        if (n != null ) {\r\n            this.cont.insertBefore(this.base[this.b_index], n);\r\n            n = null \r\n        } else {\r\n            this.cont.appendChild(this.base[this.b_index])\r\n        }\r\n        if (m != null ) {\r\n            while (m != null ) {\r\n                var o = m;\r\n                m = m.nextSibling;\r\n                this.base[this.b_index].appendChild(o);\r\n                o = null \r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setSizes = function() {}\r\n    ;\r\n    this._mergeSettings = function(s) {\r\n        var n = -1;\r\n        var o = {\r\n            type: \"settings\"\r\n        };\r\n        for (var m in this.idef) {\r\n            o[m] = this.idef[m]\r\n        }\r\n        for (var r = 0; r < s.length; r++) {\r\n            if (typeof (s[r]) != \"undefined\" && s[r].type == \"settings\") {\r\n                for (var m in s[r]) {\r\n                    o[m] = s[r][m]\r\n                }\r\n                n = r\r\n            }\r\n        }\r\n        s[n >= 0 ? n : s.length] = o;\r\n        return s\r\n    }\r\n    ;\r\n    this._genStr = function(a) {\r\n        var m = \"dhxId_\";\r\n        var o = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\r\n        for (var n = 0; n < a; n++) {\r\n            m += o.charAt(Math.floor(Math.random() * o.length))\r\n        }\r\n        return m\r\n    }\r\n    ;\r\n    this.idPrefix = \"dhxForm_\" + this._genStr(12) + \"_\";\r\n    this._rId = (this._parentForm ? this._genStr(12) + \"_\" : h._rId);\r\n    this.objPull = {};\r\n    this.itemPull = {};\r\n    this._ic = 0;\r\n    this._addItem = function(E, r, x, u, C, F, A) {\r\n        if (this.items[E]._index) {\r\n            this.getForm()._indexId.push(r);\r\n            this.getForm()._idIndex[r] = {\r\n                ind: this.getForm()._indexId.length - 1\r\n            }\r\n        }\r\n        if (!E) {\r\n            E = this._type\r\n        }\r\n        if (E == \"list\" && C != null  && this.itemPull[this.idPrefix + C] != null  && typeof (this.itemPull[this.idPrefix + C]._addSubListNode) == \"function\") {\r\n            var D = this.itemPull[this.idPrefix + C]._addSubListNode()\r\n        } else {\r\n            if (E == \"newcolumn\") {\r\n                var D = {}\r\n            } else {\r\n                var s = this.base[this.b_index];\r\n                var m = null ;\r\n                if (typeof (F) != \"undefined\" && !isNaN(F) && E != \"list\") {\r\n                    F = Math.max(parseInt(F), 0) + 1;\r\n                    for (var I = 0; I < this.cont.childNodes.length; I++) {\r\n                        for (var n = 0; n < this.cont.childNodes[I].childNodes.length; n++) {\r\n                            if (m == null  && this.cont.childNodes[I].childNodes[n]._isNestedForm != true) {\r\n                                F--;\r\n                                if (F == 0) {\r\n                                    m = this.cont.childNodes[I].childNodes[n];\r\n                                    s = this.cont.childNodes[I]\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (E == \"list\") {\r\n                        for (var H in this.itemPull) {\r\n                            if (H == this.idPrefix + r) {\r\n                                m = this.itemPull[H].nextSibling;\r\n                                if (this.itemPull[H]._listBase != null  && this.itemPull[H]._listBase.length > 0) {\r\n                                    m = this.itemPull[H]._listBase[this.itemPull[H]._listBase.length - 1]\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                var D = document.createElement(\"DIV\");\r\n                if (A == true && m != null ) {\r\n                    m = m.nextSibling\r\n                }\r\n                if (m != null ) {\r\n                    s.insertBefore(D, m)\r\n                } else {\r\n                    s.appendChild(D)\r\n                }\r\n            }\r\n        }\r\n        D._idd = r;\r\n        D._rId = this._rId;\r\n        if (typeof (D.style) != \"undefined\") {\r\n            if (typeof (x.offsetLeft) == \"undefined\" && this.idef.offsetLeft > 0) {\r\n                x.offsetLeft = this.idef.offsetLeft\r\n            }\r\n            if (typeof (x.offsetTop) == \"undefined\" && this.idef.offsetTop > 0) {\r\n                x.offsetTop = this.idef.offsetTop\r\n            }\r\n            var v = \"\";\r\n            if (typeof (x.offsetLeft) != \"undefined\") {\r\n                v += \" padding-left:\" + x.offsetLeft + \"px!important;\"\r\n            }\r\n            if (typeof (x.offsetTop) != \"undefined\") {\r\n                v += \" padding-top:\" + x.offsetTop + \"px!important;\"\r\n            }\r\n            D.style.cssText += v\r\n        }\r\n        if (E == \"block\") {\r\n            if (isNaN(x.blockOffset)) {\r\n                x.blockOffset = this.idef.blockOffset\r\n            }\r\n        }\r\n        if (E == \"list\") {\r\n            if (typeof (D._ofsNested) == \"undefined\") {\r\n                D._ofsNested = this.idef_const.offsetNested\r\n            }\r\n            if (u != null ) {\r\n                D._sId = u\r\n            }\r\n            var y = this.items[E].render(D, this.skin);\r\n            if (!this.itemPull[this.idPrefix + r]._listObj) {\r\n                this.itemPull[this.idPrefix + r]._listObj = []\r\n            }\r\n            if (!this.itemPull[this.idPrefix + r]._list) {\r\n                this.itemPull[this.idPrefix + r]._list = []\r\n            }\r\n            if (!this.itemPull[this.idPrefix + r]._listBase) {\r\n                this.itemPull[this.idPrefix + r]._listBase = []\r\n            }\r\n            (this.itemPull[this.idPrefix + r]._listObj).push(y[0]);\r\n            (this.itemPull[this.idPrefix + r]._list).push(y[1]);\r\n            (this.itemPull[this.idPrefix + r]._listBase).push(D);\r\n            y[1].checkEvent = function(a) {\r\n                return e.checkEvent(a)\r\n            }\r\n            ;\r\n            y[1].callEvent = function(a, w) {\r\n                return e.callEvent(a, w)\r\n            }\r\n            ;\r\n            y[1].getForm = function() {\r\n                return e.getForm()\r\n            }\r\n            ;\r\n            y[1]._initObj(this._mergeSettings(x));\r\n            if (D._inBlcok) {\r\n                D.className += \" in_block\"\r\n            }\r\n            return y[1]\r\n        }\r\n        if (E == \"newcolumn\") {\r\n            this._prepare(x.offset, F);\r\n            return\r\n        }\r\n        if (E == \"label\" && this._ic++ == 0) {\r\n            x._isTopmost = true\r\n        }\r\n        x.position = this.apos_css[(!x.position || !this.apos_css[x.position] ? this.idef.position : x.position)];\r\n        D.className = x.position + (typeof (x.className) == \"string\" ? \" \" + x.className : \"\");\r\n        if (!x.labelWidth) {\r\n            x.labelWidth = this.idef.labelWidth\r\n        }\r\n        if (!x.labelHeight) {\r\n            x.labelHeight = this.idef.labelHeight\r\n        }\r\n        if (typeof (x.wrap) != \"undefined\") {\r\n            x.wrap = window.dhx4.s2b(x.wrap)\r\n        }\r\n        x.labelAlign = (this.align_css[x.labelAlign] ? this.align_css[x.labelAlign] : this.align_css[this.idef.labelAlign]);\r\n        x.inputWidth = (x.width ? x.width : (x.inputWidth ? x.inputWidth : this.idef.inputWidth));\r\n        if (!x.inputHeight) {\r\n            x.inputHeight = this.idef.inputHeight\r\n        }\r\n        if (typeof (x.note) != \"undefined\") {\r\n            if (x.note.length != null  && x.note[0] != null ) {\r\n                x.note = x.note[0]\r\n            }\r\n            if (typeof (x.note.width) == \"undefined\") {\r\n                x.note.width = this.idef.noteWidth\r\n            }\r\n            if (x.note.width == \"auto\") {\r\n                x.note.width = x.inputWidth\r\n            }\r\n        }\r\n        D.checkEvent = function(a) {\r\n            return e.checkEvent(a)\r\n        }\r\n        ;\r\n        D.callEvent = function(a, w) {\r\n            return e.callEvent(a, w)\r\n        }\r\n        ;\r\n        D.getForm = function() {\r\n            return e.getForm()\r\n        }\r\n        ;\r\n        D._autoCheck = function(a) {\r\n            e._autoCheck(a)\r\n        }\r\n        ;\r\n        if (typeof (x.readonly) == \"string\") {\r\n            x.readonly = window.dhx4.s2b(x.readonly)\r\n        }\r\n        if (typeof (x.autoStart) == \"string\") {\r\n            x.autoStart = window.dhx4.s2b(x.autoStart)\r\n        }\r\n        if (typeof (x.autoRemove) == \"string\") {\r\n            x.autoRemove = window.dhx4.s2b(x.autoRemove)\r\n        }\r\n        if (typeof (x.titleScreen) == \"string\") {\r\n            x.titleScreen = window.dhx4.s2b(x.titleScreen)\r\n        }\r\n        if (typeof (x.info) == \"string\") {\r\n            x.info = window.dhx4.s2b(x.info)\r\n        }\r\n        if (typeof (x.hidden) == \"string\") {\r\n            x.hidden = window.dhx4.s2b(x.hidden)\r\n        }\r\n        if (typeof (x.checked) == \"string\") {\r\n            x.checked = window.dhx4.s2b(x.checked)\r\n        }\r\n        if (typeof (x.userdata) != \"undefined\") {\r\n            for (var H in x.userdata) {\r\n                this.getForm().setUserData(r, H, x.userdata[H])\r\n            }\r\n        }\r\n        if (x.validate) {\r\n            if (typeof (x.validate != \"undefined\") && (typeof (x.validate) == \"function\" || typeof (window[x.validate]) == \"function\")) {\r\n                D._validate = [x.validate]\r\n            } else {\r\n                D._validate = String(x.validate).split(this.separator)\r\n            }\r\n        }\r\n        if (typeof (x.required) != \"undefined\") {\r\n            if (typeof (x.required) == \"string\") {\r\n                x.required = window.dhx4.s2b(x.required)\r\n            }\r\n            D._required = (x.required == true)\r\n        }\r\n        if (D._required) {\r\n            if (!D._validate) {\r\n                D._validate = []\r\n            }\r\n            var o = false;\r\n            for (n = 0; n < D._validate.length; n++) {\r\n                o = (o || (D._validate[n] == \"NotEmpty\"))\r\n            }\r\n            if (!o) {\r\n                D._validate.push(\"NotEmpty\")\r\n            }\r\n        }\r\n        D._ll = (x.position == this.apos_css[\"label-left\"] || x.position == this.apos_css[\"label-top\"]);\r\n        this.objPull[this.idPrefix + r] = this.items[E].render(D, x);\r\n        this.itemPull[this.idPrefix + r] = D\r\n    }\r\n    ;\r\n    this._initObj = function(r, n) {\r\n        if (typeof (r.data) != \"undefined\") {\r\n            var s = null ;\r\n            if (typeof (n) != \"undefined\") {\r\n                s = n.match(/(\\?|\\&)id\\=([a-z0-9_\\-]*)/i);\r\n                if (s != null  && s[0] != null ) {\r\n                    s = s[0].split(\"=\")[1]\r\n                }\r\n            }\r\n            if (this.callEvent(\"onBeforeDataLoad\", [s, window.dhx4._copyObj(r.data)]) === true) {\r\n                this.formId = s;\r\n                this._last_load_data = r;\r\n                this.setFormData(r.data);\r\n                this.resetDataProcessor(\"updated\")\r\n            }\r\n            return\r\n        }\r\n        this._prepare();\r\n        for (var o = 0; o < r.length; o++) {\r\n            if (typeof (r[o]) != \"undefined\" && r[o].type == \"settings\") {\r\n                for (var m in r[o]) {\r\n                    this.idef[m] = r[o][m]\r\n                }\r\n            }\r\n        }\r\n        for (var o = 0; o < r.length; o++) {\r\n            this._prepareItem(r[o])\r\n        }\r\n        this._autoCheck()\r\n    }\r\n    ;\r\n    this._prepareItem = function(r, v, o) {\r\n        var n = (r != null  && r.type != null  ? r.type : \"\");\r\n        if (this.items[n]) {\r\n            if (!r.name) {\r\n                r.name = this._genStr(12)\r\n            }\r\n            var u = r.name;\r\n            if (this.objPull[this.idPrefix + u] != null  || n == \"radio\") {\r\n                u = this._genStr(12)\r\n            }\r\n            var s = r;\r\n            s.label = s.label || \"\";\r\n            s.value = s.value;\r\n            s.checked = window.dhx4.s2b(s.checked);\r\n            s.disabled = window.dhx4.s2b(s.disabled);\r\n            s.name = s.name || this._genStr(12);\r\n            s.options = s.options || [];\r\n            s.rows = s.rows || \"none\";\r\n            s.uid = this._genStr(12);\r\n            this._addItem(n, u, s, null , null , v, o);\r\n            v = null ;\r\n            if (this._parentEnabled === false) {\r\n                this._disableItem(u)\r\n            }\r\n            for (var m = 0; m < s.options.length; m++) {\r\n                if (s.options[m].list != null ) {\r\n                    if (!s.options[m].value) {\r\n                        s.options[m].value = this._genStr()\r\n                    }\r\n                    var a = this._addItem(\"list\", u, s.options[m].list, s.options[m].value, null );\r\n                    a._subSelect = true;\r\n                    a._subSelectId = s.options[m].value\r\n                }\r\n            }\r\n            if (r.list != null ) {\r\n                if (!r.listParent) {\r\n                    r.listParent = s.name\r\n                }\r\n                var a = this._addItem(\"list\", u, r.list, null , r.listParent)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._xmlSubItems = {\r\n        item: \"list\",\r\n        option: \"options\",\r\n        note: \"note\",\r\n        userdata: \"_userdata\"\r\n    };\r\n    this._xmlToObject = function(C, m) {\r\n        if (typeof (m) == \"undefined\") {\r\n            m = true\r\n        }\r\n        if (m) {\r\n            var E = C.getElementsByTagName(\"items\");\r\n            E = (E != null  && E[0] != null  ? E[0] : null );\r\n            var n = C.getElementsByTagName(\"data\");\r\n            n = (n != null  && n[0] != null  ? n[0] : null )\r\n        } else {\r\n            E = C\r\n        }\r\n        var y = (m ? [] : {});\r\n        if (E != null ) {\r\n            for (var r = 0; r < E.childNodes.length; r++) {\r\n                if (typeof (E.childNodes[r].tagName) != \"undefined\") {\r\n                    var s = E.childNodes[r].tagName;\r\n                    if (this._xmlSubItems[s] != null ) {\r\n                        var u = this._xmlSubItems[s];\r\n                        if (typeof (y[u]) == \"undefined\") {\r\n                            y[u] = []\r\n                        }\r\n                        var A = E.childNodes[r];\r\n                        var x = {};\r\n                        for (var J = 0; J < A.attributes.length; J++) {\r\n                            var F = A.attributes[J].name;\r\n                            var D = A.attributes[J].value;\r\n                            x[F] = D\r\n                        }\r\n                        if (u == \"note\") {\r\n                            x.text = A.firstChild.nodeValue\r\n                        }\r\n                        if (u == \"_userdata\") {\r\n                            x.value = (A.firstChild != null  && A.firstChild.nodeValue != null  ? A.firstChild.nodeValue : \"\")\r\n                        }\r\n                        var v = this._xmlToObject(A, false);\r\n                        for (var H in v) {\r\n                            if (H == \"_userdata\") {\r\n                                if (!x.userdata) {\r\n                                    x.userdata = {}\r\n                                }\r\n                                for (var J = 0; J < v[H].length; J++) {\r\n                                    x.userdata[v[H][J].name] = v[H][J].value\r\n                                }\r\n                            } else {\r\n                                x[H] = v[H]\r\n                            }\r\n                        }\r\n                        A = null ;\r\n                        if (m) {\r\n                            y.push(x)\r\n                        } else {\r\n                            y[u].push(x)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (n != null ) {\r\n            y = {\r\n                data: {}\r\n            };\r\n            for (var r = 0; r < n.childNodes.length; r++) {\r\n                if (typeof (n.childNodes[r].tagName) != \"undefined\") {\r\n                    var o = n.childNodes[r].tagName;\r\n                    var I = (n.childNodes[r].firstChild != null  ? n.childNodes[r].firstChild.nodeValue : \"\");\r\n                    y.data[o] = I\r\n                }\r\n            }\r\n        }\r\n        return y\r\n    }\r\n    ;\r\n    this._autoCheck = function(s) {\r\n        if (this._locked === true) {\r\n            s = false\r\n        } else {\r\n            if (typeof (s) == \"undefined\") {\r\n                s = true\r\n            }\r\n        }\r\n        for (var o in this.itemPull) {\r\n            var u = (s && (this.itemPull[o]._udis !== true));\r\n            this[u ? \"_enableItem\" : \"_disableItem\"](this.itemPull[o]._idd);\r\n            if (this.getForm()._idIndex[this.itemPull[o]._idd] != null ) {\r\n                this.getForm()._idIndex[this.itemPull[o]._idd].enabled = u\r\n            }\r\n            var n = (u && (typeof (this.itemPull[o]._checked) == \"boolean\" ? this.itemPull[o]._checked : true));\r\n            if (this.itemPull[o]._list) {\r\n                for (var y = 0; y < this.itemPull[o]._list.length; y++) {\r\n                    var x = true;\r\n                    if (this.itemPull[o]._list[y]._subSelect == true) {\r\n                        x = false;\r\n                        var r = this.getItemValue(this.itemPull[o]._idd);\r\n                        if (!(typeof (r) == \"object\" && typeof (r.length) == \"number\")) {\r\n                            r = [r]\r\n                        }\r\n                        for (var m = 0; m < r.length; m++) {\r\n                            x = (r[m] == this.itemPull[o]._list[y]._subSelectId) || x\r\n                        }\r\n                        this.itemPull[o]._listObj[y][x ? \"show\" : \"hide\"](this.itemPull[o]._listBase[y])\r\n                    }\r\n                    this.itemPull[o]._list[y]._autoCheck(n && x)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.doWithItem = function(o, m, x, w, v, u) {\r\n        if (typeof (o) == \"object\") {\r\n            var A = o[0];\r\n            var y = o[1];\r\n            var C = null ;\r\n            var s = null ;\r\n            for (var r in this.itemPull) {\r\n                if ((this.itemPull[r]._value == y || y === null ) && this.itemPull[r]._group == A) {\r\n                    return this.objPull[r][m](this.itemPull[r], x, w, v, u)\r\n                }\r\n                if (this.itemPull[r]._list != null  && !s) {\r\n                    for (var n = 0; n < this.itemPull[r]._list.length; n++) {\r\n                        s = this.itemPull[r]._list[n].doWithItem(o, m, x, w, v)\r\n                    }\r\n                }\r\n            }\r\n            if (s != null ) {\r\n                return s\r\n            } else {\r\n                if (m == \"getType\") {\r\n                    return this.doWithItem(o[0], \"getType\")\r\n                }\r\n            }\r\n        } else {\r\n            if (!this.itemPull[this.idPrefix + o]) {\r\n                var s = null ;\r\n                for (var r in this.itemPull) {\r\n                    if (this.itemPull[r]._list && !s) {\r\n                        for (var n = 0; n < this.itemPull[r]._list.length; n++) {\r\n                            if (s == null ) {\r\n                                s = this.itemPull[r]._list[n].doWithItem(o, m, x, w, v, u)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return s\r\n            } else {\r\n                return this.objPull[this.idPrefix + o][m](this.itemPull[this.idPrefix + o], x, w, v, u)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._removeItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = this.doWithItem([m, a], \"destruct\")\r\n        } else {\r\n            this.doWithItem(m, \"destruct\")\r\n        }\r\n        this._clearItemData(m)\r\n    }\r\n    ;\r\n    this._clearItemData = function(o) {\r\n        if (this.itemPull[this.idPrefix + o]) {\r\n            o = this.idPrefix + o;\r\n            try {\r\n                this.objPull[o] = null ;\r\n                this.itemPull[o] = null ;\r\n                delete this.objPull[o];\r\n                delete this.itemPull[o]\r\n            } catch (n) {}\r\n        } else {\r\n            for (var a in this.itemPull) {\r\n                if (this.itemPull[a]._list) {\r\n                    for (var m = 0; m < this.itemPull[a]._list.length; m++) {\r\n                        this.itemPull[a]._list[m]._clearItemData(o)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.isItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        return this.doWithItem(m, \"isExist\")\r\n    }\r\n    ;\r\n    this.getItemType = function(m, a) {\r\n        m = [m, (a || null )];\r\n        return this.doWithItem(m, \"getType\")\r\n    }\r\n    ;\r\n    this.forEachItem = function(n) {\r\n        for (var m in this.objPull) {\r\n            if (this.objPull[m].t == \"radio\") {\r\n                n(this.itemPull[m]._group, this.itemPull[m]._value)\r\n            } else {\r\n                n(String(m).replace(this.idPrefix, \"\"))\r\n            }\r\n            if (this.itemPull[m]._list) {\r\n                for (var o = 0; o < this.itemPull[m]._list.length; o++) {\r\n                    this.itemPull[m]._list[o].forEachItem(n)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setItemLabel = function(n, a, m) {\r\n        if (m != null ) {\r\n            n = [n, a]\r\n        } else {\r\n            m = a\r\n        }\r\n        this.doWithItem(n, \"setText\", m)\r\n    }\r\n    ;\r\n    this.getItemLabel = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        return this.doWithItem(m, \"getText\")\r\n    }\r\n    ;\r\n    this._enableItem = function(a) {\r\n        this.doWithItem(a, \"enable\")\r\n    }\r\n    ;\r\n    this._disableItem = function(a) {\r\n        this.doWithItem(a, \"disable\")\r\n    }\r\n    ;\r\n    this._isItemEnabled = function(a) {\r\n        return this.doWithItem(a, \"isEnabled\")\r\n    }\r\n    ;\r\n    this.checkItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"check\");\r\n        this._autoCheck()\r\n    }\r\n    ;\r\n    this.uncheckItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"unCheck\");\r\n        this._autoCheck()\r\n    }\r\n    ;\r\n    this.isItemChecked = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        return this.doWithItem(m, \"isChecked\")\r\n    }\r\n    ;\r\n    this.getCheckedValue = function(a) {\r\n        return this.doWithItem([a, null ], \"getChecked\")\r\n    }\r\n    ;\r\n    this._getRGroup = function(u, s) {\r\n        for (var m in this.itemPull) {\r\n            if (this.itemPull[m]._group == u && (s == null  || this.itemPull[m]._value == s)) {\r\n                return this.itemPull[m]._idd\r\n            }\r\n            if (this.itemPull[m]._list != null ) {\r\n                for (var o = 0; o < this.itemPull[m]._list.length; o++) {\r\n                    var n = this.itemPull[m]._list[o]._getRGroup(u, s);\r\n                    if (n != null ) {\r\n                        return n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this.setItemValue = function(m, a) {\r\n        this.resetValidateCss(m, a);\r\n        if (this.getItemType(m) == \"radio\") {\r\n            if (this._getRGroup(m, a) != null ) {\r\n                this.checkItem(m, a)\r\n            } else {\r\n                this.uncheckItem(m, this.getCheckedValue(m))\r\n            }\r\n            return null \r\n        }\r\n        return this.doWithItem(m, \"setValue\", a)\r\n    }\r\n    ;\r\n    this.getItemValue = function(m, a) {\r\n        if (this.getItemType(m) == \"radio\") {\r\n            return this.getCheckedValue(m)\r\n        }\r\n        return this.doWithItem(m, \"getValue\", a)\r\n    }\r\n    ;\r\n    this.updateValues = function() {\r\n        this._updateValues()\r\n    }\r\n    ;\r\n    this.showItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"show\")\r\n    }\r\n    ;\r\n    this.hideItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"hide\")\r\n    }\r\n    ;\r\n    this.isItemHidden = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        return this.doWithItem(m, \"isHidden\")\r\n    }\r\n    ;\r\n    this.getOptions = function(a) {\r\n        return this.doWithItem(a, \"getOptions\")\r\n    }\r\n    ;\r\n    this.setItemWidth = function(m, a) {\r\n        this.doWithItem(m, \"setWidth\", a)\r\n    }\r\n    ;\r\n    this.getItemWidth = function(a) {\r\n        return this.doWithItem(a, \"getWidth\")\r\n    }\r\n    ;\r\n    this.setItemHeight = function(m, a) {\r\n        this.doWithItem(m, \"setHeight\", a)\r\n    }\r\n    ;\r\n    this.setItemFocus = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"setFocus\")\r\n    }\r\n    ;\r\n    this._updateValues = function() {\r\n        for (var m in this.itemPull) {\r\n            if (this.objPull[m] && typeof (this.objPull[m].updateValue) == \"function\") {\r\n                this.objPull[m].updateValue(this.itemPull[m])\r\n            }\r\n            if (this.itemPull[m]._list) {\r\n                for (var n = 0; n < this.itemPull[m]._list.length; n++) {\r\n                    this.itemPull[m]._list[n]._updateValues()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._getItemByName = function(s) {\r\n        for (var m in this.itemPull) {\r\n            if (this.itemPull[m]._idd == s) {\r\n                return this.itemPull[m]\r\n            }\r\n            if (this.itemPull[m]._list != null ) {\r\n                for (var o = 0; o < this.itemPull[m]._list.length; o++) {\r\n                    var n = this.itemPull[m]._list[o]._getItemByName(s);\r\n                    if (n != null ) {\r\n                        return n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this._resetValidateCss = function(a) {\r\n        a.className = (a.className).replace(a._vcss, \"\");\r\n        a._vcss = null \r\n    }\r\n    ;\r\n    this.setValidateCss = function(a, o, n) {\r\n        var m = this[this.getItemType(a) == \"radio\" ? \"_getRGroup\" : \"_getItemByName\"](a);\r\n        if (!m) {\r\n            return\r\n        }\r\n        if (m._vcss != null ) {\r\n            this._resetValidateCss(m)\r\n        }\r\n        m._vcss = (typeof (n) == \"string\" ? n : \"validate_\" + (o === true ? \"ok\" : \"error\"));\r\n        m.className += \" \" + m._vcss\r\n    }\r\n    ;\r\n    this.resetValidateCss = function(n) {\r\n        for (var m in this.itemPull) {\r\n            if (this.itemPull[m]._vcss != null ) {\r\n                this._resetValidateCss(this.itemPull[m])\r\n            }\r\n            if (this.itemPull[m]._list != null ) {\r\n                for (var o = 0; o < this.itemPull[m]._list.length; o++) {\r\n                    this.itemPull[m]._list[o].resetValidateCss()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.validate = function(m) {\r\n        if (this.callEvent(\"onBeforeValidate\", []) == false) {\r\n            return\r\n        }\r\n        var a = true;\r\n        this.forEachItem(function(o, r) {\r\n            if (typeof (r) != \"undefined\") {\r\n                o = [o, r]\r\n            }\r\n            var n = e.doWithItem(o, \"_validate\");\r\n            if (typeof (n) != \"boolean\") {\r\n                n = true\r\n            }\r\n            a = n && a\r\n        });\r\n        this.callEvent(\"onAfterValidate\", [a]);\r\n        return a\r\n    }\r\n    ;\r\n    this.validateItem = function(a, m) {\r\n        if (typeof (m) != \"undefined\") {\r\n            a = [a, m]\r\n        }\r\n        return this.doWithItem(a, \"_validate\")\r\n    }\r\n    ;\r\n    this.enableLiveValidation = function(a) {\r\n        this.live_validate = (a == true)\r\n    }\r\n    ;\r\n    this.setReadonly = function(m, a) {\r\n        this.doWithItem(m, \"setReadonly\", a)\r\n    }\r\n    ;\r\n    this.isReadonly = function(a) {\r\n        return this.doWithItem(a, \"isReadonly\")\r\n    }\r\n    ;\r\n    this.getFirstActive = function(m) {\r\n        for (var o = 0; o < this._indexId.length; o++) {\r\n            var a = true;\r\n            if (m == true) {\r\n                var n = this.getItemType(this._indexId[o]);\r\n                if (!dhtmlXForm.prototype.items[n].setFocus) {\r\n                    a = false\r\n                }\r\n            }\r\n            if (a && this._idIndex[this._indexId[o]].enabled) {\r\n                return this._indexId[o]\r\n            }\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this.setFocusOnFirstActive = function() {\r\n        var a = this.getFirstActive(true);\r\n        if (a != null ) {\r\n            this.setItemFocus(a)\r\n        }\r\n    }\r\n    ;\r\n    this.enableItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"userEnable\");\r\n        this._autoCheck()\r\n    }\r\n    ;\r\n    this.disableItem = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        this.doWithItem(m, \"userDisable\");\r\n        this._autoCheck()\r\n    }\r\n    ;\r\n    this.isItemEnabled = function(m, a) {\r\n        if (a != null ) {\r\n            m = [m, a]\r\n        }\r\n        return this.doWithItem(m, \"isUserEnabled\")\r\n    }\r\n    ;\r\n    this.clear = function() {\r\n        var m = {};\r\n        this.formId = (new Date()).valueOf();\r\n        this.resetDataProcessor(\"inserted\");\r\n        for (var n in this.itemPull) {\r\n            var o = this.itemPull[n]._idd;\r\n            if (this.itemPull[n]._type == \"ch\") {\r\n                this.uncheckItem(o)\r\n            }\r\n            if (this.itemPull[n]._type in {\r\n                ta: 1,\r\n                editor: 1,\r\n                calendar: 1,\r\n                pw: 1,\r\n                hd: 1\r\n            }) {\r\n                this.setItemValue(o, \"\")\r\n            }\r\n            if (this.itemPull[n]._type == \"combo\") {\r\n                this.itemPull[n]._apiChange = true;\r\n                var v = this.getCombo(o);\r\n                v.selectOption(0);\r\n                v = null ;\r\n                this.itemPull[n]._apiChange = false\r\n            }\r\n            if (this.itemPull[n]._type == \"se\") {\r\n                var s = this.getOptions(o);\r\n                if (s.length > 0) {\r\n                    s[0].selected = true\r\n                }\r\n            }\r\n            if (this.itemPull[n]._type == \"ra\") {\r\n                var r = this.itemPull[n]._group;\r\n                if (!m[r]) {\r\n                    this.checkItem(r, this.doWithItem(o, \"_getFirstValue\"));\r\n                    m[r] = true\r\n                }\r\n            }\r\n            if (this.itemPull[n]._list) {\r\n                for (var u = 0; u < this.itemPull[n]._list.length; u++) {\r\n                    this.itemPull[n]._list[u].clear()\r\n                }\r\n            }\r\n            if (this[\"setFormData_\" + this.itemPull[n]._type]) {\r\n                this[\"setFormData_\" + this.itemPull[n]._type](o, \"\")\r\n            }\r\n        }\r\n        m = null ;\r\n        if (this._parentForm) {\r\n            this._autoCheck()\r\n        }\r\n        this.resetValidateCss()\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        window.dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n        window.dhx4._eventable(this, \"clear\");\r\n        for (var m in this.objPull) {\r\n            this._removeItem(String(m).replace(this.idPrefix, \"\"))\r\n        }\r\n        if (this._ccTm) {\r\n            window.clearTimeout(this._ccTm)\r\n        }\r\n        this._formLS = null ;\r\n        for (var n = 0; n < this.base.length; n++) {\r\n            while (this.base[n].childNodes.length > 0) {\r\n                this.base[n].removeChild(this.base[n].childNodes[0])\r\n            }\r\n            if (this.base[n].parentNode) {\r\n                this.base[n].parentNode.removeChild(this.base[n])\r\n            }\r\n            this.base[n] = null \r\n        }\r\n        this.base = null ;\r\n        this.cont.onkeypress = null ;\r\n        this.cont.className = \"\";\r\n        this.cont = null ;\r\n        for (var m in this) {\r\n            this[m] = null \r\n        }\r\n        e = null \r\n    }\r\n    ;\r\n    for (var c in this.items) {\r\n        this.items[c].t = c;\r\n        if (typeof (this.items[c]._index) == \"undefined\") {\r\n            this.items[c]._index = true\r\n        }\r\n        if (!this.items[c].show) {\r\n            this.items[c].show = function(a) {\r\n                a.style.display = \"\";\r\n                if (a._listObj) {\r\n                    for (var m = 0; m < a._listObj.length; m++) {\r\n                        a._listObj[m].show(a._listBase[m])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (!this.items[c].hide) {\r\n            this.items[c].hide = function(a) {\r\n                a.style.display = \"none\";\r\n                if (a._listObj) {\r\n                    for (var m = 0; m < a._listObj.length; m++) {\r\n                        a._listObj[m].hide(a._listBase[m])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (!this.items[c].isHidden) {\r\n            this.items[c].isHidden = function(a) {\r\n                return ( a.style.display == \"none\") \r\n            }\r\n        }\r\n        if (!this.items[c].userEnable) {\r\n            this.items[c].userEnable = function(a) {\r\n                a._udis = false\r\n            }\r\n        }\r\n        if (!this.items[c].userDisable) {\r\n            this.items[c].userDisable = function(a) {\r\n                a._udis = true\r\n            }\r\n        }\r\n        if (!this.items[c].isUserEnabled) {\r\n            this.items[c].isUserEnabled = function(a) {\r\n                return ( a._udis !== true) \r\n            }\r\n        }\r\n        if (!this.items[c].getType) {\r\n            this.items[c].getType = function() {\r\n                return this.t\r\n            }\r\n        }\r\n        if (!this.items[c].isExist) {\r\n            this.items[c].isExist = function() {\r\n                return true\r\n            }\r\n        }\r\n        if (!this.items[c]._validate) {\r\n            this.items[c]._validate = function(n) {\r\n                if (!n._validate || !n._enabled) {\r\n                    return true\r\n                }\r\n                if (n._type == \"ch\") {\r\n                    var u = (this.isChecked(n) ? this.getValue(n) : 0)\r\n                } else {\r\n                    var u = this.getValue(n)\r\n                }\r\n                var m = true;\r\n                for (var s = 0; s < n._validate.length; s++) {\r\n                    var a = \"is\" + n._validate[s];\r\n                    if ((u == null  || u.length == 0) && a != \"isNotEmpty\" && n._type != \"container\") {} else {\r\n                        var o = dhtmlxValidation[a];\r\n                        if (n._type == \"container\" && typeof (o) == \"function\") {\r\n                            o = function() {\r\n                                return true\r\n                            }\r\n                        }\r\n                        if (typeof (o) != \"function\" && typeof (n._validate[s]) == \"function\") {\r\n                            o = n._validate[s]\r\n                        }\r\n                        if (typeof (o) != \"function\" && typeof (window[n._validate[s]]) == \"function\") {\r\n                            o = window[n._validate[s]]\r\n                        }\r\n                        m = ((typeof (o) == \"function\" ? o(u, n._idd) : new RegExp(n._validate[s]).test(u)) && m);\r\n                        o = null \r\n                    }\r\n                }\r\n                if (!(n.callEvent(\"onValidate\" + (m ? \"Success\" : \"Error\"), [n._idd, u, m]) === false)) {\r\n                    n.getForm().setValidateCss(n._idd, m)\r\n                }\r\n                return m\r\n            }\r\n        }\r\n    }\r\n    this._locked = false;\r\n    this._doLock = function(m) {\r\n        var a = (m === true ? true : false);\r\n        if (this._locked == a) {\r\n            return\r\n        } else {\r\n            this._locked = a\r\n        }\r\n        this._autoCheck(!this._locked)\r\n    }\r\n    ;\r\n    this.lock = function() {\r\n        this._doLock(true)\r\n    }\r\n    ;\r\n    this.unlock = function() {\r\n        this._doLock(false)\r\n    }\r\n    ;\r\n    this.isLocked = function() {\r\n        return this._locked\r\n    }\r\n    ;\r\n    this.setNumberFormat = function(o, m, a, n) {\r\n        return this.doWithItem(o, \"setNumberFormat\", m, a, n)\r\n    }\r\n    ;\r\n    window.dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToObject\", \"items\", {\r\n        struct: true,\r\n        data: true\r\n    });\r\n    window.dhx4._eventable(this);\r\n    this.attachEvent(\"_onButtonClick\", function(a, m) {\r\n        this.callEvent(\"onButtonClick\", [a, m])\r\n    });\r\n    this._updateBlocks = function() {\r\n        this.forEachItem(function(a) {\r\n            if (e.getItemType(a) == \"block\" || e.getItemType(a) == \"combo\") {\r\n                e.doWithItem(a, \"_setCss\", e.skin, e.cont.style.fontSize)\r\n            }\r\n        })\r\n    }\r\n    ;\r\n    this._isObj = function(a) {\r\n        return ( a != null  && typeof (a) == \"object\" && typeof (a.length) == \"undefined\") \r\n    }\r\n    ;\r\n    this._copyObj = function(o) {\r\n        if (this._isObj(o)) {\r\n            var n = {};\r\n            for (var m in o) {\r\n                if (typeof (o[m]) == \"object\" && o[m] != null ) {\r\n                    n[m] = this._copyObj(o[m])\r\n                } else {\r\n                    n[m] = o[m]\r\n                }\r\n            }\r\n        } else {\r\n            var n = [];\r\n            for (var m = 0; m < o.length; m++) {\r\n                if (typeof (o[m]) == \"object\" && o[m] != null ) {\r\n                    n[m] = this._copyObj(o[m])\r\n                } else {\r\n                    n[m] = o[m]\r\n                }\r\n            }\r\n        }\r\n        return n\r\n    }\r\n    ;\r\n    if (g != null  && typeof (g) == \"object\") {\r\n        this._initObj(this._copyObj(g))\r\n    }\r\n    if (this._parentForm) {\r\n        this._updateBlocks()\r\n    }\r\n    this._ccActive = false;\r\n    this._ccTm = null ;\r\n    return this\r\n}\r\ndhtmlXForm.prototype.getInput = function(a) {\r\n    return this.doWithItem(a, \"getInput\")\r\n}\r\n;\r\ndhtmlXForm.prototype.getSelect = function(a) {\r\n    return this.doWithItem(a, \"getSelect\")\r\n}\r\n;\r\ndhtmlXForm.prototype.items = {};\r\ndhtmlXForm.prototype.items.checkbox = {\r\n    render: function(a, c) {\r\n        a._type = \"ch\";\r\n        a._enabled = true;\r\n        a._checked = false;\r\n        a._value = (typeof (c.value) == \"undefined\" ? null  : String(c.value));\r\n        a._ro = (c.readonly == true);\r\n        if (c._autoInputWidth !== false) {\r\n            c.inputWidth = 14\r\n        }\r\n        this.doAddLabel(a, c);\r\n        this.doAddInput(a, c, \"INPUT\", \"TEXT\", true, true, \"dhxform_textarea\");\r\n        a.childNodes[a._ll ? 1 : 0].className += \" dhxform_img_node\";\r\n        var e = document.createElement(\"DIV\");\r\n        e.className = \"dhxform_img chbx0\";\r\n        a.appendChild(e);\r\n        if (!isNaN(c.inputLeft)) {\r\n            a.childNodes[a._ll ? 1 : 0].style.left = parseInt(c.inputLeft) + \"px\"\r\n        }\r\n        if (!isNaN(c.inputTop)) {\r\n            a.childNodes[a._ll ? 1 : 0].style.top = parseInt(c.inputTop) + \"px\"\r\n        }\r\n        a.childNodes[a._ll ? 1 : 0].appendChild(e);\r\n        a.childNodes[a._ll ? 1 : 0].firstChild.value = String(c.value);\r\n        a._updateImgNode = function(h, l) {\r\n            var g = h.childNodes[h._ll ? 1 : 0].lastChild;\r\n            g.className = (l ? \"dhxform_actv_c\" : \"dhxform_img\") + \" \" + (h._checked ? \"chbx1\" : \"chbx0\");\r\n            h = g = null \r\n        }\r\n        ;\r\n        a._doOnFocus = function(g) {\r\n            g.getForm().callEvent(\"onFocus\", [g._idd])\r\n        }\r\n        ;\r\n        a._doOnBlur = function(g) {\r\n            g.getForm().callEvent(\"onBlur\", [g._idd])\r\n        }\r\n        ;\r\n        a._doOnKeyUpDown = function(h, g) {\r\n            this.callEvent(h, [this.childNodes[this._ll ? 0 : 1].childNodes[0], g, this._idd])\r\n        }\r\n        ;\r\n        if (c.checked == true) {\r\n            this.check(a)\r\n        }\r\n        if (c.hidden == true) {\r\n            this.hide(a)\r\n        }\r\n        if (c.disabled == true) {\r\n            this.userDisable(a)\r\n        }\r\n        this.doAttachEvents(a);\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        a._doOnFocus = a._doOnBlur = a._updateImgNode = null ;\r\n        this.doUnloadNestedLists(a);\r\n        this.doDestruct(a)\r\n    },\r\n    doAddLabel: function(c, e) {\r\n        var a = document.createElement(\"DIV\");\r\n        a.className = \"dhxform_label \" + e.labelAlign;\r\n        if (e.wrap == true) {\r\n            a.style.whiteSpace = \"normal\"\r\n        }\r\n        if (c._ll) {\r\n            c.insertBefore(a, c.firstChild)\r\n        } else {\r\n            c.appendChild(a)\r\n        }\r\n        if (typeof (e.tooltip) != \"undefined\") {\r\n            a.title = e.tooltip\r\n        }\r\n        a.innerHTML = \"<div class='dhxform_label_nav_link' onfocus='if(this.parentNode.parentNode._updateImgNode)this.parentNode.parentNode._updateImgNode(this.parentNode.parentNode,true);this.parentNode.parentNode._doOnFocus(this.parentNode.parentNode);' onblur='if(this.parentNode.parentNode._updateImgNode)this.parentNode.parentNode._updateImgNode(this.parentNode.parentNode,false);this.parentNode.parentNode._doOnBlur(this.parentNode.parentNode);' onkeypress='var e=event||window.arguments[0];if(e.keyCode==32||e.charCode==32){e.cancelBubble=true;if(e.preventDefault)e.preventDefault();else e.returnValue=false;_dhxForm_doClick(this,\\\"mousedown\\\");return false;}' onkeyup='var e=event||window.arguments[0];this.parentNode.parentNode._doOnKeyUpDown(\\\"onKeyUp\\\",e);' onkeydown='var e=event||window.arguments[0];this.parentNode.parentNode._doOnKeyUpDown(\\\"onKeyDown\\\",e);' \" + (window.dhx4.isIPad ? \"ontouchstart='var e=event;e.preventDefault();_dhxForm_doClick(this,\\\"mousedown\\\");' \" : \"\") + \"role='link' tabindex='0'>\" + e.label + (e.info ? \"<span class='dhxform_info'>[?]</span>\" : \"\") + (c._required ? \"<span class='dhxform_item_required'>*</span>\" : \"\") + \"</div>\";\r\n        if (!isNaN(e.labelWidth)) {\r\n            a.firstChild.style.width = parseInt(e.labelWidth) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelHeight)) {\r\n            a.firstChild.style.height = parseInt(e.labelHeight) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelLeft)) {\r\n            a.style.left = parseInt(e.labelLeft) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelTop)) {\r\n            a.style.top = parseInt(e.labelTop) + \"px\"\r\n        }\r\n    },\r\n    doAddInput: function(w, g, c, o, r, h, l) {\r\n        var a = document.createElement(\"DIV\");\r\n        a.className = \"dhxform_control\";\r\n        if (w._ll) {\r\n            w.appendChild(a)\r\n        } else {\r\n            w.insertBefore(a, w.firstChild)\r\n        }\r\n        var v = document.createElement(c);\r\n        v.className = l;\r\n        v.name = w._idd;\r\n        v._idd = w._idd;\r\n        v.id = g.uid;\r\n        if (typeof (o) == \"string\") {\r\n            v.type = o\r\n        }\r\n        if (c == \"INPUT\" || c == \"TEXTAREA\") {\r\n            v.onkeyup = function(u) {\r\n                u = u || event;\r\n                w.callEvent(\"onKeyUp\", [this, u, this._idd])\r\n            }\r\n            ;\r\n            v.onkeydown = function(u) {\r\n                u = u || event;\r\n                w.callEvent(\"onKeyDown\", [this, u, this._idd])\r\n            }\r\n        }\r\n        a.appendChild(v);\r\n        if (r) {\r\n            if (!isNaN(g.inputLeft)) {\r\n                a.style.left = parseInt(g.inputLeft) + \"px\"\r\n            }\r\n            if (!isNaN(g.inputTop)) {\r\n                a.style.top = parseInt(g.inputTop) + \"px\"\r\n            }\r\n        }\r\n        var s = \"\";\r\n        var m = false;\r\n        if (h) {\r\n            if (!isNaN(g.inputWidth)) {\r\n                s += \"width:\" + parseInt(g.inputWidth) + \"px;\";\r\n                m = true\r\n            }\r\n            if (!isNaN(g.inputHeight)) {\r\n                s += \"height:\" + parseInt(g.inputHeight) + \"px;\"\r\n            }\r\n        }\r\n        if (typeof (g.style) == \"string\") {\r\n            s += g.style\r\n        }\r\n        v.style.cssText = s;\r\n        if (g.maxLength) {\r\n            v.setAttribute(\"maxLength\", g.maxLength)\r\n        }\r\n        if (g.connector) {\r\n            v.setAttribute(\"connector\", g.connector)\r\n        }\r\n        var e = (dhtmlXForm.prototype.items[this.t] != null  ? dhtmlXForm.prototype.items[this.t]._dimFix == true : false);\r\n        if (m && ({\r\n            input: 1,\r\n            password: 1,\r\n            select: 1,\r\n            multiselect: 1,\r\n            calendar: 1,\r\n            colorpicker: 1\r\n        }[this.t] == 1 || e)) {\r\n            if (dhtmlXForm.prototype.items[this.t]._dim == null ) {\r\n                dhtmlXForm.prototype.items[this.t]._dim = w.getForm()._checkDim(a, v)\r\n            }\r\n            v.style.width = parseInt(v.style.width) - dhtmlXForm.prototype.items[this.t]._dim + \"px\"\r\n        }\r\n        if (typeof (g.note) == \"object\") {\r\n            var n = document.createElement(\"DIV\");\r\n            n.className = \"dhxform_note\";\r\n            n.style.width = (isNaN(g.note.width) ? v.offsetWidth : parseInt(g.note.width)) + \"px\";\r\n            n._w = g.note.width;\r\n            n.innerHTML = g.note.text;\r\n            a.appendChild(n);\r\n            n = null \r\n        }\r\n        if (g.readonly) {\r\n            this.setReadonly(w, true)\r\n        }\r\n        if (g.disabled == true) {\r\n            this.userDisable(w)\r\n        }\r\n        if (g.hidden == true && this.t != \"combo\") {\r\n            this.hide(w)\r\n        }\r\n    },\r\n    doUnloadNestedLists: function(a) {\r\n        if (!a._list) {\r\n            return\r\n        }\r\n        for (var c = 0; c < a._list.length; c++) {\r\n            a._list[c].unload();\r\n            a._list[c] = null ;\r\n            a._listObj[c] = null ;\r\n            a._listBase[c].parentNode.removeChild(a._listBase[c]);\r\n            a._listBase[c] = null \r\n        }\r\n        a._list = null ;\r\n        a._listObj = null ;\r\n        a._listBase = null \r\n    },\r\n    doDestruct: function(a) {\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        a._autoCheck = null ;\r\n        a._checked = null ;\r\n        a._enabled = null ;\r\n        a._idd = null ;\r\n        a._type = null ;\r\n        a._value = null ;\r\n        a._group = null ;\r\n        a.onselectstart = null ;\r\n        a.childNodes[a._ll ? 1 : 0].onmousedown = null ;\r\n        a.childNodes[a._ll ? 1 : 0].ontouchstart = null ;\r\n        a.childNodes[a._ll ? 0 : 1].onmousedown = null ;\r\n        a.childNodes[a._ll ? 0 : 1].ontouchstart = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onfocus = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onblur = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onkeypress = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onkeyup = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onkeydown = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onmousedown = null ;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].ontouchstart = null ;\r\n        a.childNodes[a._ll ? 0 : 1].removeChild(a.childNodes[a._ll ? 0 : 1].childNodes[0]);\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.childNodes[0])\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    doAttachEvents: function(c) {\r\n        var a = this;\r\n        c.childNodes[c._ll ? 1 : 0][window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(h) {\r\n            h = h || event;\r\n            if (h.preventDefault) {\r\n                h.preventDefault()\r\n            }\r\n            var g = (h.target || h.srcElement);\r\n            if (!this.parentNode._enabled || this.parentNode._ro || (typeof (g.className) != \"undefined\" && g.className == \"dhxform_note\")) {\r\n                h.cancelBubble = true;\r\n                if (h.preventDefault) {\r\n                    h.preventDefault()\r\n                } else {\r\n                    h.returnValue = false\r\n                }\r\n                return false\r\n            }\r\n            a.doClick(this.parentNode)\r\n        }\r\n        ;\r\n        c.childNodes[c._ll ? 0 : 1].childNodes[0][window.dhx4.isIPad ? \"ontouchstart\" : \"onmousedown\"] = function(h) {\r\n            h = h || event;\r\n            if (h.preventDefault) {\r\n                h.preventDefault()\r\n            }\r\n            if (!this.parentNode.parentNode._enabled) {\r\n                h.cancelBubble = true;\r\n                if (h.preventDefault) {\r\n                    h.preventDefault()\r\n                } else {\r\n                    h.returnValue = false\r\n                }\r\n                return false\r\n            }\r\n            var g = h.target || h.srcElement;\r\n            if (typeof (g.className) != \"undefined\" && g.className == \"dhxform_info\") {\r\n                this.parentNode.parentNode.callEvent(\"onInfo\", [this.parentNode.parentNode._idd, h]);\r\n                h.cancelBubble = true;\r\n                if (h.preventDefault) {\r\n                    h.preventDefault()\r\n                } else {\r\n                    h.returnValue = false\r\n                }\r\n                return false\r\n            }\r\n            a.doClick(this.parentNode.parentNode)\r\n        }\r\n    },\r\n    doClick: function(a) {\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].focus();\r\n        if (!a._enabled || a._ro) {\r\n            return\r\n        }\r\n        if (a.checkEvent(\"onBeforeChange\")) {\r\n            if (a.callEvent(\"onBeforeChange\", [a._idd, a._value, a._checked]) !== true) {\r\n                return\r\n            }\r\n        }\r\n        this.setChecked(a, !a._checked);\r\n        a._autoCheck();\r\n        a.callEvent(\"onChange\", [a._idd, a._value, a._checked])\r\n    },\r\n    doCheckValue: function(a) {\r\n        if (a._checked && a._enabled) {\r\n            a.childNodes[a._ll ? 1 : 0].firstChild.name = String(a._idd);\r\n            a.childNodes[a._ll ? 1 : 0].firstChild.value = this.getValue(a)\r\n        } else {\r\n            a.childNodes[a._ll ? 1 : 0].firstChild.name = \"\";\r\n            a.childNodes[a._ll ? 1 : 0].firstChild.value = \"\"\r\n        }\r\n    },\r\n    setChecked: function(a, c) {\r\n        a._checked = (c === true ? true : false);\r\n        a.childNodes[a._ll ? 1 : 0].lastChild.className = a.childNodes[a._ll ? 1 : 0].lastChild.className.replace(/chbx[0-1]{1}/gi, \"\") + (a._checked ? \" chbx1\" : \" chbx0\");\r\n        this.doCheckValue(a)\r\n    },\r\n    check: function(a) {\r\n        this.setChecked(a, true)\r\n    },\r\n    unCheck: function(a) {\r\n        this.setChecked(a, false)\r\n    },\r\n    isChecked: function(a) {\r\n        return a._checked\r\n    },\r\n    enable: function(a) {\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._enabled = true;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].tabIndex = 0;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].removeAttribute(\"disabled\");\r\n        this.doCheckValue(a)\r\n    },\r\n    disable: function(a) {\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._enabled = false;\r\n        if (a._updateImgNode != null ) {\r\n            a._updateImgNode(a, false)\r\n        }\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].tabIndex = -1;\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].setAttribute(\"disabled\", \"true\");\r\n        this.doCheckValue(a)\r\n    },\r\n    isEnabled: function(a) {\r\n        return a._enabled\r\n    },\r\n    setText: function(a, c) {\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML = c + (a._required ? \"<span class='dhxform_item_required'>*</span>\" : \"\")\r\n    },\r\n    getText: function(a) {\r\n        return a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML.replace(/<span class=\\\"dhxform_item_required\\\">[^<]*<\\/span>/g, \"\")\r\n    },\r\n    setValue: function(a, c) {\r\n        this.setChecked(a, (c === true || parseInt(c) == 1 || c == \"true\" || a._value === c))\r\n    },\r\n    getValue: function(a, c) {\r\n        if (c == \"realvalue\") {\r\n            return a._value\r\n        }\r\n        return ( (typeof (a._value) == \"undefined\" || a._value == null ) ? (a._checked ? 1 : 0) : a._value) \r\n    },\r\n    setReadonly: function(a, c) {\r\n        a._ro = (c === true)\r\n    },\r\n    isReadonly: function(a) {\r\n        return a._ro\r\n    },\r\n    setFocus: function(a) {\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].focus()\r\n    }\r\n};\r\ndhtmlXForm.prototype.items.radio = {\r\n    input: {},\r\n    r: {},\r\n    firstValue: {},\r\n    render: function(e, g, c) {\r\n        e._type = \"ra\";\r\n        e._enabled = true;\r\n        e._checked = false;\r\n        e._group = g.name;\r\n        e._value = g.value;\r\n        e._uid = c;\r\n        e._ro = (g.readonly == true);\r\n        e._rName = e._rId + e._group;\r\n        this.r[e._idd] = e;\r\n        g.inputWidth = 14;\r\n        this.doAddLabel(e, g);\r\n        this.doAddInput(e, g, \"INPUT\", \"TEXT\", true, true, \"dhxform_textarea\");\r\n        e.childNodes[e._ll ? 1 : 0].className += \" dhxform_img_node\";\r\n        var h = document.createElement(\"DIV\");\r\n        h.className = \"dhxform_img rdbt0\";\r\n        e.appendChild(h);\r\n        if (!isNaN(g.inputLeft)) {\r\n            e.childNodes[e._ll ? 1 : 0].style.left = parseInt(g.inputLeft) + \"px\"\r\n        }\r\n        if (!isNaN(g.inputTop)) {\r\n            e.childNodes[e._ll ? 1 : 0].style.top = parseInt(g.inputTop) + \"px\"\r\n        }\r\n        e.childNodes[e._ll ? 1 : 0].appendChild(h);\r\n        e.childNodes[e._ll ? 1 : 0].firstChild.name = \"\";\r\n        e.childNodes[e._ll ? 1 : 0].firstChild.value = \"\";\r\n        e._updateImgNode = function(m, n) {\r\n            var l = m.childNodes[m._ll ? 1 : 0].lastChild;\r\n            l.className = (n ? \"dhxform_actv_r\" : \"dhxform_img\") + \" \" + (m._checked ? \"rdbt1\" : \"rdbt0\");\r\n            m = l = null \r\n        }\r\n        ;\r\n        e._doOnFocus = function(l) {\r\n            l.getForm().callEvent(\"onFocus\", [l._group, l._value])\r\n        }\r\n        ;\r\n        e._doOnBlur = function(l) {\r\n            l.getForm().callEvent(\"onBlur\", [l._group, l._value])\r\n        }\r\n        ;\r\n        e._doOnKeyUpDown = function(m, l) {\r\n            this.callEvent(m, [this.childNodes[this._ll ? 0 : 1].childNodes[0], l, this._group, this._value])\r\n        }\r\n        ;\r\n        if (this.input[e._rName] == null ) {\r\n            var a = document.createElement(\"INPUT\");\r\n            a.type = \"HIDDEN\";\r\n            a.name = g.name;\r\n            a.firstValue = e._value;\r\n            e.appendChild(a);\r\n            this.input[e._rName] = a\r\n        }\r\n        if (!this.firstValue[e._rName]) {\r\n            this.firstValue[e._rName] = g.value\r\n        }\r\n        if (g.checked == true) {\r\n            this.check(e)\r\n        }\r\n        if (g.hidden == true) {\r\n            this.hide(e)\r\n        }\r\n        if (g.disabled == true) {\r\n            this.userDisable(e)\r\n        }\r\n        this.doAttachEvents(e);\r\n        return this\r\n    },\r\n    destruct: function(g, h) {\r\n        if (g.lastChild == this.input[g._rName]) {\r\n            var e = false;\r\n            for (var c in this.r) {\r\n                if (!e && this.r[c]._group == g._group && this.r[c]._idd != g._idd) {\r\n                    this.r[c].appendChild(this.input[g._rName]);\r\n                    e = true\r\n                }\r\n            }\r\n            if (!e) {\r\n                this.input[g._rName].parentNode.removeChild(this.input[g._rName]);\r\n                this.input[g._rName] = null ;\r\n                this.firstValue[g._rName] = null \r\n            }\r\n        }\r\n        var l = g._idd;\r\n        g._doOnFocus = g._doOnBlur = g._updateImgNode = null ;\r\n        this.doUnloadNestedLists(g);\r\n        this.doDestruct(g);\r\n        return l\r\n    },\r\n    doClick: function(c) {\r\n        c.childNodes[c._ll ? 0 : 1].childNodes[0].focus();\r\n        if (!(c._enabled && !c._checked)) {\r\n            return\r\n        }\r\n        if (c._ro) {\r\n            return\r\n        }\r\n        var a = [c._group, c._value, true];\r\n        if (c.checkEvent(\"onBeforeChange\")) {\r\n            if (c.callEvent(\"onBeforeChange\", a) !== true) {\r\n                return\r\n            }\r\n        }\r\n        this.setChecked(c, true);\r\n        c.getForm()._autoCheck();\r\n        c.callEvent(\"onChange\", a)\r\n    },\r\n    doCheckValue: function(e) {\r\n        var g = null ;\r\n        for (var c in this.r) {\r\n            if (this.r[c]._checked && this.r[c]._group == e._group && this.r[c]._rId == e._rId) {\r\n                g = this.r[c]._value\r\n            }\r\n        }\r\n        if (g != null  && this.r[c]._enabled) {\r\n            this.input[e._rName].name = String(e._group);\r\n            this.input[e._rName].value = g\r\n        } else {\r\n            this.input[e._rName].name = \"\";\r\n            this.input[e._rName].value = \"\"\r\n        }\r\n        this.input[e._rName]._value = g\r\n    },\r\n    setChecked: function(h, l) {\r\n        l = (l === true);\r\n        for (var c in this.r) {\r\n            if (this.r[c]._group == h._group && this.r[c]._rId == h._rId) {\r\n                var g = false;\r\n                if (this.r[c]._idd == h._idd) {\r\n                    if (this.r[c]._checked != l) {\r\n                        this.r[c]._checked = l;\r\n                        g = true\r\n                    }\r\n                } else {\r\n                    if (this.r[c]._checked) {\r\n                        this.r[c]._checked = false;\r\n                        g = true\r\n                    }\r\n                }\r\n                if (g) {\r\n                    var e = this.r[c].childNodes[this.r[c]._ll ? 1 : 0].childNodes[1];\r\n                    e.className = e.className.replace(/rdbt[0-1]{1}/gi, \"\") + (this.r[c]._checked ? \" rdbt1\" : \" rdbt0\");\r\n                    e = null \r\n                }\r\n            }\r\n        }\r\n        this.doCheckValue(h)\r\n    },\r\n    getChecked: function(a) {\r\n        return this.input[a._rName]._value\r\n    },\r\n    _getFirstValue: function(a) {\r\n        return this.firstValue[a._rName]\r\n    },\r\n    _getId: function(a) {\r\n        return a._idd\r\n    },\r\n    setValue: function(a, c) {}\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doDestruct: 1,\r\n        doUnloadNestedLists: 1,\r\n        doAttachEvents: 1,\r\n        check: 1,\r\n        unCheck: 1,\r\n        isChecked: 1,\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        getValue: 1,\r\n        setReadonly: 1,\r\n        isReadonly: 1,\r\n        setFocus: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.radio[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.select = {\r\n    render: function(a, c) {\r\n        a._type = \"se\";\r\n        a._enabled = true;\r\n        a._value = null ;\r\n        a._newValue = null ;\r\n        this.doAddLabel(a, c);\r\n        this.doAddInput(a, c, \"SELECT\", null , true, true, \"dhxform_select\");\r\n        this.doAttachEvents(a);\r\n        this.doLoadOpts(a, c);\r\n        if (c.connector != null ) {\r\n            this.doLoadOptsConnector(a, c.connector)\r\n        }\r\n        if (typeof (c.value) != \"undefined\" && c.value != null ) {\r\n            this.setValue(a, c.value)\r\n        }\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        this.doUnloadNestedLists(a);\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        a._autoCheck = null ;\r\n        a._enabled = null ;\r\n        a._idd = null ;\r\n        a._type = null ;\r\n        a._value = null ;\r\n        a._newValue = null ;\r\n        a.onselectstart = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onclick = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onkeydown = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onchange = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onfocus = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onblur = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onkeyup = null ;\r\n        a.childNodes[a._ll ? 1 : 0].removeChild(a.childNodes[a._ll ? 1 : 0].childNodes[0]);\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.childNodes[0])\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    doAddLabel: function(c, e) {\r\n        var a = document.createElement(\"DIV\");\r\n        a.className = \"dhxform_label \" + e.labelAlign;\r\n        a.innerHTML = \"<label for='\" + e.uid + \"'>\" + e.label + (e.info ? \"<span class='dhxform_info'>[?]</span>\" : \"\") + (c._required ? \"<span class='dhxform_item_required'>*</span>\" : \"\") + \"</label>\";\r\n        if (e.wrap == true) {\r\n            a.style.whiteSpace = \"normal\"\r\n        }\r\n        if (typeof (e.tooltip) != \"undefined\") {\r\n            a.title = e.tooltip\r\n        }\r\n        c.appendChild(a);\r\n        if (typeof (e.label) == \"undefined\" || e.label == null  || e.label.length == 0) {\r\n            a.style.display = \"none\"\r\n        }\r\n        if (!isNaN(e.labelWidth)) {\r\n            a.style.width = parseInt(e.labelWidth) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelHeight)) {\r\n            a.style.height = parseInt(e.labelHeight) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelLeft)) {\r\n            a.style.left = parseInt(e.labelLeft) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelTop)) {\r\n            a.style.top = parseInt(e.labelTop) + \"px\"\r\n        }\r\n        if (e.info) {\r\n            a.onclick = function(h) {\r\n                h = h || event;\r\n                var g = h.target || h.srcElement;\r\n                if (typeof (g.className) != \"undefined\" && g.className == \"dhxform_info\") {\r\n                    this.parentNode.callEvent(\"onInfo\", [this.parentNode._idd, h]);\r\n                    h.cancelBubble = true;\r\n                    if (h.preventDefault) {\r\n                        h.preventDefault()\r\n                    } else {\r\n                        h.returnValue = false\r\n                    }\r\n                    return false\r\n                }\r\n            }\r\n        }\r\n    },\r\n    doAttachEvents: function(e) {\r\n        var a = e.childNodes[e._ll ? 1 : 0].childNodes[0];\r\n        var c = this;\r\n        a.onclick = function() {\r\n            c.doOnChange(this)\r\n        }\r\n        ;\r\n        a.onkeydown = function(g) {\r\n            g = g || event;\r\n            c.doOnChange(this);\r\n            this.parentNode.parentNode.callEvent(\"onKeyDown\", [this, g, this.parentNode.parentNode._idd])\r\n        }\r\n        ;\r\n        a.onchange = function() {\r\n            c.doOnChange(this)\r\n        }\r\n        ;\r\n        a.onkeyup = function(g) {\r\n            g = g || event;\r\n            this.parentNode.parentNode.callEvent(\"onKeyUp\", [this, g, this.parentNode.parentNode._idd])\r\n        }\r\n        ;\r\n        a = null ;\r\n        this.doAttachChangeLS(e)\r\n    },\r\n    doAttachChangeLS: function(c) {\r\n        var a = c.childNodes[c._ll ? 1 : 0].childNodes[0];\r\n        a.onfocus = function() {\r\n            var e = this.parentNode.parentNode;\r\n            e.getForm()._ccActivate(e._idd, this, e.getForm().getItemValue(e._idd, true));\r\n            e.getForm().callEvent(\"onFocus\", [e._idd]);\r\n            e = null \r\n        }\r\n        ;\r\n        a.onblur = function() {\r\n            var e = this.parentNode.parentNode;\r\n            e.getForm()._ccDeactivate(e._idd);\r\n            e.getForm().callEvent(\"onBlur\", [e._idd]);\r\n            e = null \r\n        }\r\n        ;\r\n        a = null \r\n    },\r\n    doValidate: function(a) {\r\n        if (a.getForm().live_validate) {\r\n            this._validate(a)\r\n        }\r\n    },\r\n    doLoadOpts: function(m, h, o) {\r\n        var n = m.childNodes[m._ll ? 1 : 0].childNodes[0];\r\n        var a = h.options;\r\n        var g = false;\r\n        for (var c = 0; c < a.length; c++) {\r\n            var l = a[c].text || a[c].label;\r\n            if (!l || typeof (l) == \"undefined\") {\r\n                l = \"\"\r\n            }\r\n            var e = new Option(l,a[c].value);\r\n            if (typeof (a[c].img_src) == \"string\") {\r\n                e.setAttribute(\"img_src\", a[c].img_src)\r\n            }\r\n            n.options.add(e);\r\n            if (typeof (a[c].selected) != \"undefined\" && window.dhx4.s2b(a[c].selected) == true) {\r\n                e.selected = true;\r\n                m._value = a[c].value;\r\n                g = true\r\n            }\r\n            if (typeof (a[c].checked) != \"undefined\" && window.dhx4.s2b(a[c].checked) == true) {\r\n                e.setAttribute(\"checked\", \"1\")\r\n            }\r\n            if (typeof (a[c].img) != \"undefined\") {\r\n                e.setAttribute(\"img\", a[c].img)\r\n            }\r\n            if (typeof (a[c].img_dis) != \"undefined\") {\r\n                e.setAttribute(\"img_dis\", a[c].img_dis)\r\n            }\r\n            if (typeof (a[c].css) != \"undefined\") {\r\n                e.setAttribute(\"css\", a[c].css)\r\n            }\r\n        }\r\n        if (!g && n.selectedIndex >= 0) {\r\n            m._value = n.options[n.selectedIndex].value\r\n        }\r\n        if (o === true) {\r\n            m.callEvent(\"onOptionsLoaded\", [m._idd])\r\n        }\r\n        this._checkNoteWidth(m)\r\n    },\r\n    doLoadOptsConnector: function(e, a) {\r\n        var c = this;\r\n        e._connector_working = true;\r\n        window.dhx4.ajax.get(a, function(m) {\r\n            m = m.xmlDoc.responseXML;\r\n            if (m == null ) {\r\n                return\r\n            }\r\n            var g = m.getElementsByTagName(\"data\");\r\n            if (g == null  || g[0] == null ) {\r\n                return\r\n            }\r\n            g = g[0];\r\n            var l = [];\r\n            for (var n = 0; n < g.childNodes.length; n++) {\r\n                if (typeof (g.childNodes[n].tagName) != \"undefined\" && String(g.childNodes[n].tagName).toLowerCase() == \"item\") {\r\n                    var h = g.childNodes[n];\r\n                    l.push({\r\n                        label: h.getAttribute(\"label\"),\r\n                        value: h.getAttribute(\"value\"),\r\n                        selected: (h.getAttribute(\"selected\") != null )\r\n                    });\r\n                    h = null \r\n                }\r\n            }\r\n            c.doLoadOpts(e, {\r\n                options: l\r\n            }, true);\r\n            e._connector_working = false;\r\n            if (e._connector_value != null ) {\r\n                c.setValue(e, e._connector_value);\r\n                e._connector_value = null \r\n            }\r\n            c = e = null \r\n        })\r\n    },\r\n    doOnChange: function(e) {\r\n        var a = e.parentNode.parentNode;\r\n        a._newValue = (e.selectedIndex >= 0 ? e.options[e.selectedIndex].value : null );\r\n        if (a._newValue != a._value) {\r\n            if (a.checkEvent(\"onBeforeChange\")) {\r\n                if (a.callEvent(\"onBeforeChange\", [a._idd, a._value, a._newValue]) !== true) {\r\n                    for (var c = 0; c < e.options.length; c++) {\r\n                        if (e.options[c].value == a._value) {\r\n                            e.options[c].selected = true\r\n                        }\r\n                    }\r\n                    return\r\n                }\r\n            }\r\n            a._value = a._newValue;\r\n            a.callEvent(\"onChange\", [a._idd, a._value]);\r\n            if (a._type == \"se\" && a.getForm().live_validate) {\r\n                this._validate(a)\r\n            }\r\n        }\r\n        a._autoCheck()\r\n    },\r\n    setText: function(a, c) {\r\n        if (!c) {\r\n            c = \"\"\r\n        }\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML = c + (a._required ? \"<span class='dhxform_item_required'>*</span>\" : \"\");\r\n        a.childNodes[a._ll ? 0 : 1].style.display = (c.length == 0 || c == null  ? \"none\" : \"\")\r\n    },\r\n    getText: function(a) {\r\n        return a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML.replace(/<span class=\\\"dhxform_item_required\\\">[^<]*<\\/span>/g, \"\")\r\n    },\r\n    enable: function(a) {\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._enabled = true;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].removeAttribute(\"disabled\")\r\n    },\r\n    disable: function(a) {\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._enabled = false;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].setAttribute(\"disabled\", true)\r\n    },\r\n    getOptions: function(a) {\r\n        return a.childNodes[a._ll ? 1 : 0].childNodes[0].options\r\n    },\r\n    setValue: function(c, g) {\r\n        if (c._connector_working) {\r\n            c._connector_value = g;\r\n            return\r\n        }\r\n        var a = this.getOptions(c);\r\n        for (var e = 0; e < a.length; e++) {\r\n            if (a[e].value == g) {\r\n                a[e].selected = true;\r\n                c._value = a[e].value\r\n            }\r\n        }\r\n        if (c._list != null  && c._list.length > 0) {\r\n            c.getForm()._autoCheck()\r\n        }\r\n        c.getForm()._ccReload(c._idd, c._value)\r\n    },\r\n    getValue: function(e) {\r\n        var a = -1;\r\n        var c = this.getOptions(e);\r\n        for (var g = 0; g < c.length; g++) {\r\n            if (c[g].selected) {\r\n                a = c[g].value\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    setWidth: function(c, a) {\r\n        c.childNodes[c._ll ? 1 : 0].childNodes[0].style.width = a + \"px\"\r\n    },\r\n    getSelect: function(a) {\r\n        return a.childNodes[a._ll ? 1 : 0].childNodes[0]\r\n    },\r\n    setFocus: function(a) {\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].focus()\r\n    },\r\n    _checkNoteWidth: function(c) {\r\n        var a;\r\n        if (c.childNodes[c._ll ? 1 : 0].childNodes[1] != null ) {\r\n            a = c.childNodes[c._ll ? 1 : 0].childNodes[1];\r\n            if (a.className != null  && a.className.search(/dhxform_note/gi) >= 0 && a._w == \"auto\") {\r\n                a.style.width = c.childNodes[c._ll ? 1 : 0].childNodes[0].offsetWidth + \"px\"\r\n            }\r\n        }\r\n        a = null \r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddInput: 1,\r\n        doUnloadNestedLists: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.select[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.multiselect = {\r\n    doLoadOpts: function(g, l, m) {\r\n        var c = g.childNodes[g._ll ? 1 : 0].childNodes[0];\r\n        c.multiple = true;\r\n        if (!isNaN(l.size)) {\r\n            c.size = Number(l.size)\r\n        }\r\n        g._value = [];\r\n        g._newValue = [];\r\n        var e = l.options;\r\n        for (var h = 0; h < e.length; h++) {\r\n            var a = new Option(e[h].text || e[h].label,e[h].value);\r\n            c.options.add(a);\r\n            if (e[h].selected == true || e[h].selected == \"true\") {\r\n                a.selected = true;\r\n                g._value.push(e[h].value)\r\n            }\r\n        }\r\n        if (m === true) {\r\n            g.callEvent(\"onOptionsLoaded\", [g._idd])\r\n        }\r\n        this._checkNoteWidth(g)\r\n    },\r\n    doAttachEvents: function(e) {\r\n        var a = e.childNodes[e._ll ? 1 : 0].childNodes[0];\r\n        var c = this;\r\n        a.onfocus = function() {\r\n            c.doOnChange(this);\r\n            var g = this.parentNode.parentNode;\r\n            g.getForm().callEvent(\"onFocus\", [g._idd]);\r\n            g = null \r\n        }\r\n        ;\r\n        a.onblur = function() {\r\n            c.doOnChange(this);\r\n            var g = this.parentNode.parentNode;\r\n            g.getForm().callEvent(\"onBlur\", [g._idd]);\r\n            g = null \r\n        }\r\n        ;\r\n        a.onclick = function() {\r\n            c.doOnChange(this);\r\n            var g = this.parentNode.parentNode;\r\n            g._autoCheck();\r\n            g = null \r\n        }\r\n    },\r\n    doOnChange: function(g) {\r\n        var c = g.parentNode.parentNode;\r\n        c._newValue = [];\r\n        for (var e = 0; e < g.options.length; e++) {\r\n            if (g.options[e].selected) {\r\n                c._newValue.push(g.options[e].value)\r\n            }\r\n        }\r\n        if ((c._value).sort().toString() != (c._newValue).sort().toString()) {\r\n            if (c.checkEvent(\"onBeforeChange\")) {\r\n                if (c.callEvent(\"onBeforeChange\", [c._idd, c._value, c._newValue]) !== true) {\r\n                    var a = {};\r\n                    for (var e = 0; e < c._value.length; e++) {\r\n                        a[c._value[e]] = true\r\n                    }\r\n                    for (var e = 0; e < g.options.length; e++) {\r\n                        g.options[e].selected = (a[g.options[e].value] == true)\r\n                    }\r\n                    a = null ;\r\n                    return\r\n                }\r\n            }\r\n            c._value = [];\r\n            for (var e = 0; e < c._newValue.length; e++) {\r\n                c._value.push(c._newValue[e])\r\n            }\r\n            c.callEvent(\"onChange\", [c._idd, c._value])\r\n        }\r\n        c._autoCheck()\r\n    },\r\n    setValue: function(e, h) {\r\n        var a = {};\r\n        if (typeof (h) == \"string\") {\r\n            h = h.split(\",\")\r\n        }\r\n        if (typeof (h) != \"object\") {\r\n            h = [h]\r\n        }\r\n        for (var g = 0; g < h.length; g++) {\r\n            a[h[g]] = true\r\n        }\r\n        var c = this.getOptions(e);\r\n        for (var g = 0; g < c.length; g++) {\r\n            c[g].selected = (a[c[g].value] == true)\r\n        }\r\n        e._autoCheck()\r\n    },\r\n    getValue: function(e) {\r\n        var a = [];\r\n        var c = this.getOptions(e);\r\n        for (var g = 0; g < c.length; g++) {\r\n            if (c[g].selected) {\r\n                a.push(c[g].value)\r\n            }\r\n        }\r\n        return a\r\n    }\r\n};\r\n(function() {\r\n    for (var c in dhtmlXForm.prototype.items.select) {\r\n        if (!dhtmlXForm.prototype.items.multiselect[c]) {\r\n            dhtmlXForm.prototype.items.multiselect[c] = dhtmlXForm.prototype.items.select[c]\r\n        }\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.input = {\r\n    render: function(l, m) {\r\n        var h = (!isNaN(m.rows));\r\n        l._type = \"ta\";\r\n        l._enabled = true;\r\n        this.doAddLabel(l, m);\r\n        this.doAddInput(l, m, (h ? \"TEXTAREA\" : \"INPUT\"), (h ? null  : \"TEXT\"), true, true, \"dhxform_textarea\");\r\n        this.doAttachEvents(l);\r\n        if (h) {\r\n            l.childNodes[l._ll ? 1 : 0].childNodes[0].rows = Number(m.rows) + (window.dhx4.isIE6 ? 1 : 0)\r\n        }\r\n        if (typeof (m.numberFormat) != \"undefined\") {\r\n            var g, e = null , n = null ;\r\n            if (typeof (m.numberFormat) != \"string\") {\r\n                g = m.numberFormat[0];\r\n                e = m.numberFormat[1] || null ;\r\n                n = m.numberFormat[2] || null \r\n            } else {\r\n                g = m.numberFormat;\r\n                if (typeof (m.groupSep) == \"string\") {\r\n                    e = m.groupSep\r\n                }\r\n                if (typeof (m.decSep) == \"string\") {\r\n                    n = m.decSep\r\n                }\r\n            }\r\n            this.setNumberFormat(l, g, e, n, false)\r\n        }\r\n        this.setValue(l, m.value);\r\n        return this\r\n    },\r\n    doAttachEvents: function(e) {\r\n        var c = e.childNodes[e._ll ? 1 : 0].childNodes[0];\r\n        if (typeof (c.tagName) != \"undefined\" && c.tagName.toLowerCase() == \"input\") {\r\n            var a = this;\r\n            c.onfocus = function() {\r\n                var g = this.parentNode.parentNode;\r\n                if (g._df != null ) {\r\n                    this.value = g._value || \"\"\r\n                }\r\n                g.getForm()._ccActivate(g._idd, this, this.value);\r\n                g.getForm().callEvent(\"onFocus\", [g._idd]);\r\n                g = null \r\n            }\r\n            ;\r\n            c.onblur = function() {\r\n                var g = this.parentNode.parentNode;\r\n                g.getForm()._ccDeactivate(g._idd);\r\n                a.updateValue(g, true);\r\n                if (g.getForm().live_validate) {\r\n                    a._validate(g)\r\n                }\r\n                g.getForm().callEvent(\"onBlur\", [g._idd]);\r\n                g = null \r\n            }\r\n        }\r\n        c = null \r\n    },\r\n    updateValue: function(h, a) {\r\n        var l = h.childNodes[h._ll ? 1 : 0].childNodes[0].value;\r\n        var g = h.getForm();\r\n        var c = (g._ccActive == true && g._formLS != null  && g._formLS[h._idd] != null );\r\n        g = null ;\r\n        if (!c && h._df != null  && l == window.dhx4.template._getFmtValue(h._value, h._df)) {\r\n            return\r\n        }\r\n        if (!a && h._df != null  && h._value == l && l == window.dhx4.template._getFmtValue(l, h._df)) {\r\n            return\r\n        }\r\n        var e = this;\r\n        if (h._value != l) {\r\n            if (h.checkEvent(\"onBeforeChange\")) {\r\n                if (h.callEvent(\"onBeforeChange\", [h._idd, h._value, l]) !== true) {\r\n                    if (h._df != null ) {\r\n                        e.setValue(h, h._value)\r\n                    } else {\r\n                        h.childNodes[h._ll ? 1 : 0].childNodes[0].value = h._value\r\n                    }\r\n                    return\r\n                }\r\n            }\r\n            if (h._df != null  && a) {\r\n                e.setValue(h, l)\r\n            } else {\r\n                h._value = l\r\n            }\r\n            h.callEvent(\"onChange\", [h._idd, l]);\r\n            return\r\n        }\r\n        if (h._df != null  && a) {\r\n            this.setValue(h, h._value)\r\n        }\r\n    },\r\n    setValue: function(e, g) {\r\n        e._value = (typeof (g) != \"undefined\" && g != null  ? g : \"\");\r\n        var c = (String(e._value) || \"\");\r\n        var a = e.childNodes[e._ll ? 1 : 0].childNodes[0];\r\n        if (e._df != null ) {\r\n            c = window.dhx4.template._getFmtValue(c, e._df)\r\n        }\r\n        if (a.value != c) {\r\n            a.value = c;\r\n            e.getForm()._ccReload(e._idd, c)\r\n        }\r\n        a = null \r\n    },\r\n    getValue: function(a) {\r\n        var c = a.getForm();\r\n        if (c._formLS && c._formLS[a._idd] != null ) {\r\n            this.updateValue(a)\r\n        }\r\n        c = null ;\r\n        return ( typeof (a._value) != \"undefined\" && a._value != null  ? a._value : \"\") \r\n    },\r\n    setReadonly: function(a, c) {\r\n        a._ro = (c === true);\r\n        if (a._ro) {\r\n            a.childNodes[a._ll ? 1 : 0].childNodes[0].setAttribute(\"readOnly\", \"true\")\r\n        } else {\r\n            a.childNodes[a._ll ? 1 : 0].childNodes[0].removeAttribute(\"readOnly\")\r\n        }\r\n    },\r\n    isReadonly: function(a) {\r\n        if (!a._ro) {\r\n            a._ro = false\r\n        }\r\n        return a._ro\r\n    },\r\n    getInput: function(a) {\r\n        return a.childNodes[a._ll ? 1 : 0].childNodes[0]\r\n    },\r\n    setNumberFormat: function(g, h, e, l, c) {\r\n        if (typeof (c) != \"boolean\") {\r\n            c = true\r\n        }\r\n        if (h == \"\") {\r\n            g._df = null ;\r\n            if (c) {\r\n                this.setValue(g, g._value)\r\n            }\r\n            return true\r\n        }\r\n        if (typeof (h) != \"string\") {\r\n            return\r\n        }\r\n        var a = window.dhx4.template._parseFmt(h, e, l);\r\n        if (a == false) {\r\n            return false\r\n        } else {\r\n            g._df = a\r\n        }\r\n        if (c) {\r\n            this.setValue(g, g._value)\r\n        }\r\n        return true\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        destruct: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1,\r\n        setFocus: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.input[c] = dhtmlXForm.prototype.items.select[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.password = {\r\n    render: function(a, c) {\r\n        a._type = \"pw\";\r\n        a._enabled = true;\r\n        this.doAddLabel(a, c);\r\n        this.doAddInput(a, c, \"INPUT\", \"PASSWORD\", true, true, \"dhxform_textarea\");\r\n        this.doAttachEvents(a);\r\n        this.setValue(a, c.value);\r\n        return this\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doAttachEvents: 1,\r\n        destruct: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        setValue: 1,\r\n        getValue: 1,\r\n        updateValue: 1,\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1,\r\n        setReadonly: 1,\r\n        isReadonly: 1,\r\n        setFocus: 1,\r\n        getInput: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.password[c] = dhtmlXForm.prototype.items.input[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.file = {\r\n    render: function(e, g) {\r\n        e._type = \"fl\";\r\n        e._enabled = true;\r\n        this.doAddLabel(e, g);\r\n        this.doAddInput(e, g, \"INPUT\", \"FILE\", true, false, \"dhxform_textarea\");\r\n        var a = e.childNodes[e._ll ? 1 : 0].childNodes[0];\r\n        var c = this;\r\n        a.onfocus = function() {\r\n            var h = this.parentNode.parentNode;\r\n            h.getForm().callEvent(\"onFocus\", [h._idd]);\r\n            h = null \r\n        }\r\n        ;\r\n        a.onblur = function() {\r\n            var h = this.parentNode.parentNode;\r\n            if (h.getForm().live_validate) {\r\n                c._validate(h)\r\n            }\r\n            h.getForm().callEvent(\"onBlur\", [h._idd]);\r\n            h = null \r\n        }\r\n        ;\r\n        a = null ;\r\n        e.childNodes[e._ll ? 1 : 0].childNodes[0].onchange = function() {\r\n            e.callEvent(\"onChange\", [e._idd, this.value])\r\n        }\r\n        ;\r\n        return this\r\n    },\r\n    setValue: function() {},\r\n    getValue: function(a) {\r\n        return a.childNodes[a._ll ? 1 : 0].childNodes[0].value\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        destruct: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        getInput: 1,\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.file[c] = dhtmlXForm.prototype.items.input[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.label = {\r\n    _index: false,\r\n    render: function(c, e) {\r\n        c._type = \"lb\";\r\n        c._enabled = true;\r\n        c._checked = true;\r\n        var a = document.createElement(\"DIV\");\r\n        a.className = \"dhxform_txt_label2\" + (e._isTopmost ? \" topmost\" : \"\");\r\n        a.innerHTML = e.label;\r\n        c.appendChild(a);\r\n        if (e.hidden == true) {\r\n            this.hide(c)\r\n        }\r\n        if (e.disabled == true) {\r\n            this.userDisable(c)\r\n        }\r\n        if (!isNaN(e.labelWidth)) {\r\n            a.style.width = parseInt(e.labelWidth) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelHeight)) {\r\n            a.style.height = parseInt(e.labelHeight) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelLeft)) {\r\n            a.style.left = parseInt(e.labelLeft) + \"px\"\r\n        }\r\n        if (!isNaN(e.labelTop)) {\r\n            a.style.top = parseInt(e.labelTop) + \"px\"\r\n        }\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        this.doUnloadNestedLists(a);\r\n        a._autoCheck = null ;\r\n        a._enabled = null ;\r\n        a._type = null ;\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        a.onselectstart = null ;\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    enable: function(a) {\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._enabled = true\r\n    },\r\n    disable: function(a) {\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._enabled = false\r\n    },\r\n    setText: function(a, c) {\r\n        a.firstChild.innerHTML = c\r\n    },\r\n    getText: function(a) {\r\n        return a.firstChild.innerHTML\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doUnloadNestedLists: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.label[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.button = {\r\n    render: function(c, e) {\r\n        c._type = \"bt\";\r\n        c._enabled = true;\r\n        c._name = e.name;\r\n        c.className = String(c.className).replace(\"item_label_top\", \"item_label_left\").replace(\"item_label_right\", \"item_label_left\");\r\n        c._doOnKeyUpDown = function(h, g) {\r\n            this.callEvent(h, [this.childNodes[0].childNodes[0], g, this._idd])\r\n        }\r\n        ;\r\n        c.innerHTML = '<div class=\"dhxform_btn\" role=\"link\" tabindex=\"0\" dir=\"ltr\"><div class=\"dhxform_btn_txt\">' + e.value + '</div><div class=\"dhxform_btn_filler\" disabled=\"true\"></div></div>';\r\n        if (!isNaN(e.width)) {\r\n            var a = Math.max(e.width, 10);\r\n            if (dhtmlXForm.prototype.items[this.t]._dim == null ) {\r\n                c.firstChild.style.width = a + \"px\";\r\n                dhtmlXForm.prototype.items[this.t]._dim = c.getForm()._checkDim(c, c.firstChild)\r\n            }\r\n            c.firstChild.style.width = a - dhtmlXForm.prototype.items[this.t]._dim + \"px\";\r\n            c.firstChild.firstChild.className += \" dhxform_btn_txt_autowidth\"\r\n        }\r\n        if (!isNaN(e.inputLeft)) {\r\n            c.childNodes[0].style.left = parseInt(e.inputLeft) + \"px\"\r\n        }\r\n        if (!isNaN(e.inputTop)) {\r\n            c.childNodes[0].style.top = parseInt(e.inputTop) + \"px\"\r\n        }\r\n        if (e.hidden == true) {\r\n            this.hide(c)\r\n        }\r\n        if (e.disabled == true) {\r\n            this.userDisable(c)\r\n        }\r\n        if (typeof (e.tooltip) != \"undefined\") {\r\n            c.firstChild.title = e.tooltip\r\n        }\r\n        c.onselectstart = function(g) {\r\n            g = g || event;\r\n            g.cancelBubble = true;\r\n            if (g.preventDefault) {\r\n                g.preventDefault()\r\n            } else {\r\n                g.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        c.firstChild.onselectstart = function(g) {\r\n            g = g || event;\r\n            g.cancelBubble = true;\r\n            if (g.preventDefault) {\r\n                g.preventDefault()\r\n            } else {\r\n                g.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        c.firstChild.onkeypress = function(g) {\r\n            g = g || event;\r\n            if ((g.keyCode == 32 || g.charCode == 32 || g.keyCode == 13 || g.charCode == 13) && !this.parentNode._busy) {\r\n                this.parentNode._busy = true;\r\n                g.cancelBubble = true;\r\n                if (g.preventDefault) {\r\n                    g.preventDefault()\r\n                } else {\r\n                    g.returnValue = false\r\n                }\r\n                _dhxForm_doClick(this.childNodes[0], [\"mousedown\", \"mouseup\"]);\r\n                return false\r\n            }\r\n        }\r\n        ;\r\n        c.firstChild.onfocus = function() {\r\n            this.parentNode._doOnFocus(this.parentNode)\r\n        }\r\n        ;\r\n        c.firstChild.onblur = function() {\r\n            _dhxForm_doClick(this.childNodes[0], \"mouseout\");\r\n            this.parentNode._doOnBlur(this.parentNode)\r\n        }\r\n        ;\r\n        c.firstChild.onkeyup = function(g) {\r\n            this.parentNode._doOnKeyUpDown(\"onKeyUp\", g || event)\r\n        }\r\n        ;\r\n        c.firstChild.onkeydown = function(g) {\r\n            this.parentNode._doOnKeyUpDown(\"onKeyDown\", g || event)\r\n        }\r\n        ;\r\n        c.firstChild.onmouseover = function() {\r\n            var g = this.parentNode;\r\n            if (!g._enabled) {\r\n                return\r\n            }\r\n            this._isOver = true;\r\n            this.className = \"dhxform_btn dhxform_btn_over\";\r\n            g = null \r\n        }\r\n        ;\r\n        c.firstChild.onmouseout = function() {\r\n            var g = this.parentNode;\r\n            if (!g._enabled) {\r\n                return\r\n            }\r\n            this.className = \"dhxform_btn\";\r\n            this._allowClick = false;\r\n            this._pressed = false;\r\n            this._isOver = false;\r\n            g = null \r\n        }\r\n        ;\r\n        c.firstChild.ontouchstart = c.firstChild.onmousedown = function(h) {\r\n            h = h || event;\r\n            if (h.type == \"touchstart\" && h.preventDefault) {\r\n                h.preventDefault()\r\n            }\r\n            if (h.button >= 2) {\r\n                return\r\n            }\r\n            if (this._pressed) {\r\n                return\r\n            }\r\n            var g = this.parentNode;\r\n            if (!g._enabled) {\r\n                return\r\n            }\r\n            this.className = \"dhxform_btn dhxform_btn_pressed\";\r\n            this._allowClick = true;\r\n            this._pressed = true;\r\n            g = null \r\n        }\r\n        ;\r\n        c.firstChild.ontouchend = c.firstChild.onmouseup = function(h) {\r\n            h = h || event;\r\n            if (h.button >= 2) {\r\n                return\r\n            }\r\n            if (!this._pressed) {\r\n                return\r\n            }\r\n            var g = this.parentNode;\r\n            if (!g._enabled) {\r\n                return\r\n            }\r\n            g._busy = false;\r\n            this.className = \"dhxform_btn\" + (this._isOver ? \" dhxform_btn_over\" : \"\");\r\n            if (this._pressed && this._allowClick) {\r\n                g.callEvent(\"_onButtonClick\", [g._name, g._cmd])\r\n            }\r\n            this._allowClick = false;\r\n            this._pressed = false;\r\n            g = null \r\n        }\r\n        ;\r\n        c._doOnFocus = function(g) {\r\n            g.getForm().callEvent(\"onFocus\", [g._idd])\r\n        }\r\n        ;\r\n        c._doOnBlur = function(g) {\r\n            g.getForm().callEvent(\"onBlur\", [g._idd])\r\n        }\r\n        ;\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        this.doUnloadNestedLists(a);\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        a._autoCheck = null ;\r\n        a._type = null ;\r\n        a._enabled = null ;\r\n        a._cmd = null ;\r\n        a._name = null ;\r\n        a._doOnFocus = null ;\r\n        a._doOnBlur = null ;\r\n        a._doOnKeyUpDown = null ;\r\n        a.onselectstart = null ;\r\n        a.firstChild.onselectstart = null ;\r\n        a.firstChild.onkeypress = null ;\r\n        a.firstChild.ontouchstart = null ;\r\n        a.firstChild.ontouchend = null ;\r\n        a.firstChild.onfocus = null ;\r\n        a.firstChild.onblur = null ;\r\n        a.firstChild.onkeyup = null ;\r\n        a.firstChild.onkeydown = null ;\r\n        a.firstChild.onmouseover = null ;\r\n        a.firstChild.onmouseout = null ;\r\n        a.firstChild.onmousedown = null ;\r\n        a.firstChild.onmouseup = null ;\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.childNodes[0])\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    enable: function(a) {\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._enabled = true;\r\n        a.childNodes[0].removeAttribute(\"disabled\");\r\n        a.childNodes[0].setAttribute(\"role\", \"link\");\r\n        a.childNodes[0].setAttribute(\"tabIndex\", \"0\")\r\n    },\r\n    disable: function(a) {\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._enabled = false;\r\n        a.childNodes[0].setAttribute(\"disabled\", \"true\");\r\n        a.childNodes[0].removeAttribute(\"role\");\r\n        a.childNodes[0].removeAttribute(\"tabIndex\")\r\n    },\r\n    setText: function(a, c) {\r\n        a.childNodes[0].childNodes[0].innerHTML = c\r\n    },\r\n    getText: function(a) {\r\n        return a.childNodes[0].childNodes[0].innerHTML\r\n    },\r\n    setFocus: function(a) {\r\n        a.childNodes[0].focus()\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doUnloadNestedLists: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.button[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.hidden = {\r\n    _index: false,\r\n    render: function(c, e) {\r\n        c.style.display = \"none\";\r\n        c._name = e.name;\r\n        c._type = \"hd\";\r\n        c._enabled = true;\r\n        var a = document.createElement(\"INPUT\");\r\n        a.type = \"HIDDEN\";\r\n        a.name = e.name;\r\n        a.value = (e.value || \"\");\r\n        c.appendChild(a);\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        this.doUnloadNestedLists(a);\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.childNodes[0])\r\n        }\r\n        a._autoCheck = null ;\r\n        a._name = null ;\r\n        a._type = null ;\r\n        a._enabled = null ;\r\n        a.onselectstart = null ;\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    enable: function(a) {\r\n        a._enabled = true;\r\n        a.childNodes[0].setAttribute(\"name\", a._name)\r\n    },\r\n    disable: function(a) {\r\n        a._enabled = false;\r\n        a.childNodes[0].removeAttribute(\"name\")\r\n    },\r\n    show: function() {},\r\n    hide: function() {},\r\n    isHidden: function() {\r\n        return true\r\n    },\r\n    setValue: function(a, c) {\r\n        a.childNodes[0].value = c\r\n    },\r\n    getValue: function(a) {\r\n        return a.childNodes[0].value\r\n    },\r\n    getInput: function(a) {\r\n        return a.childNodes[0]\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doUnloadNestedLists: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.hidden[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.list = {\r\n    _index: false,\r\n    render: function(a, c) {\r\n        a._type = \"list\";\r\n        a._enabled = true;\r\n        a._isNestedForm = true;\r\n        a.style.paddingLeft = a._ofsNested + \"px\";\r\n        a.className = \"dhxform_base_nested\" + (a._custom_css || \"\");\r\n        return [this, new dhtmlXForm(a,null ,c)]\r\n    },\r\n    destruct: function(a) {}\r\n};\r\ndhtmlXForm.prototype.items.fieldset = {\r\n    _index: false,\r\n    render: function(c, g) {\r\n        c._type = \"fs\";\r\n        if (typeof (parseInt(g.inputWidth)) == \"number\") {}\r\n        c._width = g.width;\r\n        c._enabled = true;\r\n        c._checked = true;\r\n        c.className = \"fs_\" + g.position + (typeof (g.className) == \"string\" ? \" \" + g.className : \"\");\r\n        var e = document.createElement(\"FIELDSET\");\r\n        e.className = \"dhxform_fs\";\r\n        var h = String(g.labelAlign).replace(\"align_\", \"\");\r\n        e.innerHTML = \"<legend class='fs_legend' align='\" + h + \"' style='text-align:\" + h + \"'>\" + g.label + \"</legend>\";\r\n        c.appendChild(e);\r\n        if (!isNaN(g.inputLeft)) {\r\n            e.style.left = parseInt(g.inputLeft) + \"px\"\r\n        }\r\n        if (!isNaN(g.inputTop)) {\r\n            e.style.top = parseInt(g.inputTop) + \"px\"\r\n        }\r\n        if (g.inputWidth != \"auto\") {\r\n            if (!isNaN(g.inputWidth)) {\r\n                e.style.width = parseInt(g.inputWidth) + \"px\";\r\n                var a = parseInt(e.style.width);\r\n                if (e.offsetWidth > a) {\r\n                    e.style.width = a + (a - e.offsetWidth) + \"px\"\r\n                }\r\n            }\r\n        }\r\n        c._addSubListNode = function() {\r\n            var l = document.createElement(\"DIV\");\r\n            l._custom_css = \" dhxform_fs_nested\";\r\n            this.childNodes[0].appendChild(l);\r\n            return l\r\n        }\r\n        ;\r\n        if (g.hidden == true) {\r\n            this.hide(c)\r\n        }\r\n        if (g.disabled == true) {\r\n            this.userDisable(c)\r\n        }\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        this.doUnloadNestedLists(a);\r\n        a._checked = null ;\r\n        a._enabled = null ;\r\n        a._idd = null ;\r\n        a._type = null ;\r\n        a._width = null ;\r\n        a.onselectstart = null ;\r\n        a._addSubListNode = null ;\r\n        a._autoCheck = null ;\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.childNodes[0])\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    setText: function(a, c) {\r\n        a.childNodes[0].childNodes[0].innerHTML = c\r\n    },\r\n    getText: function(a) {\r\n        return a.childNodes[0].childNodes[0].innerHTML\r\n    },\r\n    enable: function(a) {\r\n        a._enabled = true;\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n    },\r\n    disable: function(a) {\r\n        a._enabled = false;\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n    },\r\n    setWidth: function(c, a) {\r\n        c.childNodes[0].style.width = a + \"px\";\r\n        c._width = a\r\n    },\r\n    getWidth: function(a) {\r\n        return a._width\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doUnloadNestedLists: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.fieldset[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.block = {\r\n    _index: false,\r\n    render: function(c, e) {\r\n        c._type = \"bl\";\r\n        c._width = e.width;\r\n        c._enabled = true;\r\n        c._checked = true;\r\n        c.className = \"block_\" + e.position + (typeof (e.className) == \"string\" ? \" \" + e.className : \"\");\r\n        var a = document.createElement(\"DIV\");\r\n        a.className = \"dhxform_obj_\" + c.getForm().skin + \" dhxform_block\";\r\n        a.style.fontSize = c.getForm().cont.style.fontSize;\r\n        if (e.style) {\r\n            a.style.cssText = e.style\r\n        }\r\n        if (typeof (e.id) != \"undefined\") {\r\n            a.id = e.id\r\n        }\r\n        c.appendChild(a);\r\n        if (!isNaN(e.inputLeft)) {\r\n            a.style.left = parseInt(e.inputLeft) + \"px\"\r\n        }\r\n        if (!isNaN(e.inputTop)) {\r\n            a.style.top = parseInt(e.inputTop) + \"px\"\r\n        }\r\n        if (e.inputWidth != \"auto\") {\r\n            if (!isNaN(e.inputWidth)) {\r\n                a.style.width = parseInt(e.inputWidth) + \"px\"\r\n            }\r\n        }\r\n        if (!isNaN(e.blockOffset)) {\r\n            c._ofsNested = e.blockOffset\r\n        }\r\n        c._addSubListNode = function() {\r\n            var g = document.createElement(\"DIV\");\r\n            g._inBlcok = true;\r\n            if (typeof (this._ofsNested) != \"undefined\") {\r\n                g._ofsNested = this._ofsNested\r\n            }\r\n            this.childNodes[0].appendChild(g);\r\n            return g\r\n        }\r\n        ;\r\n        if (e.hidden == true) {\r\n            this.hide(c)\r\n        }\r\n        if (e.disabled == true) {\r\n            this.userDisable(c)\r\n        }\r\n        return this\r\n    },\r\n    _setCss: function(a, e, c) {\r\n        a.firstChild.className = \"dhxform_obj_\" + e + \" dhxform_block\";\r\n        a.firstChild.style.fontSize = c\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1,\r\n        getWidth: 1,\r\n        doUnloadNestedLists: 1,\r\n        destruct: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.block[c] = dhtmlXForm.prototype.items.fieldset[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.newcolumn = {\r\n    _index: false\r\n};\r\ndhtmlXForm.prototype.items.template = {\r\n    render: function(c, e) {\r\n        var a = (!isNaN(e.rows));\r\n        c._type = \"tp\";\r\n        c._enabled = true;\r\n        if (e.format != null ) {\r\n            if (typeof (e.format) == \"function\") {\r\n                c.format = e.format\r\n            } else {\r\n                if (typeof (e.format) == \"string\" && typeof (window[e.format]) == \"function\") {\r\n                    c.format = window[e.format]\r\n                }\r\n            }\r\n        }\r\n        if (c.format == null ) {\r\n            c.format = function(g, h) {\r\n                return h\r\n            }\r\n        }\r\n        this.doAddLabel(c, e);\r\n        this.doAddInput(c, e, \"DIV\", null , true, true, \"dhxform_item_template\");\r\n        this.setValue(c, e.value || \"\");\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        a.format = null ;\r\n        this.d2(a);\r\n        a = null \r\n    },\r\n    setValue: function(a, c) {\r\n        a._value = c;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].innerHTML = a.format(a._idd, a._value)\r\n    },\r\n    getValue: function(a) {\r\n        return a._value\r\n    },\r\n    enable: function(a) {\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._enabled = true\r\n    },\r\n    disable: function(a) {\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._enabled = false\r\n    }\r\n};\r\n(function() {\r\n    dhtmlXForm.prototype.items.template.d2 = dhtmlXForm.prototype.items.input.destruct;\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.template[c] = dhtmlXForm.prototype.items.select[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype._ulToObject = function(l, r) {\r\n    var m = [];\r\n    for (var c = 0; c < l.childNodes.length; c++) {\r\n        if (String(l.childNodes[c].tagName || \"\").toLowerCase() == \"li\") {\r\n            var g = {};\r\n            var u = l.childNodes[c];\r\n            for (var s = 0; s < r.length; s++) {\r\n                if (u.getAttribute(r[s]) != null ) {\r\n                    g[String(r[s]).replace(\"ftype\", \"type\")] = u.getAttribute(r[s])\r\n                }\r\n            }\r\n            if (!g.label) {\r\n                try {\r\n                    g.label = u.firstChild.nodeValue\r\n                } catch (o) {}\r\n            }\r\n            var h = u.getElementsByTagName(\"UL\");\r\n            if (h[0] != null ) {\r\n                g[(g.type == \"select\" ? \"options\" : \"list\")] = dhtmlXForm.prototype._ulToObject(h[0], r)\r\n            }\r\n            for (var s = 0; s < u.childNodes.length; s++) {\r\n                if (String(u.childNodes[s].tagName || \"\").toLowerCase() == \"userdata\") {\r\n                    if (!g.userdata) {\r\n                        g.userdata = {}\r\n                    }\r\n                    g.userdata[u.childNodes[s].getAttribute(\"name\")] = u.childNodes[s].firstChild.nodeValue\r\n                }\r\n            }\r\n            m[m.length] = g\r\n        }\r\n        if (String(l.childNodes[c].tagName || \"\").toLowerCase() == \"div\") {\r\n            var g = {};\r\n            g.type = \"label\";\r\n            try {\r\n                g.label = l.childNodes[c].firstChild.nodeValue\r\n            } catch (o) {}\r\n            m[m.length] = g\r\n        }\r\n    }\r\n    return m\r\n}\r\n;\r\ndhtmlXForm.prototype.setUserData = function(h, e, g, a) {\r\n    if (typeof (a) != \"undefined\") {\r\n        var c = this.doWithItem([h, e], \"_getId\");\r\n        if (c != null ) {\r\n            h = c;\r\n            e = g;\r\n            g = a\r\n        }\r\n    }\r\n    if (!this._userdata) {\r\n        this._userdata = {}\r\n    }\r\n    this._userdata[h] = (this._userdata[h] || {});\r\n    this._userdata[h][e] = g\r\n}\r\n;\r\ndhtmlXForm.prototype.getUserData = function(g, e, a) {\r\n    if (typeof (a) != \"undefined\") {\r\n        var c = this.doWithItem([g, e], \"_getId\");\r\n        if (c != null ) {\r\n            g = c;\r\n            e = a\r\n        }\r\n    }\r\n    if (this._userdata != null  && typeof (this._userdata[g]) != \"undefined\" && typeof (this._userdata[g][e]) != \"undefined\") {\r\n        return this._userdata[g][e]\r\n    }\r\n    return \"\"\r\n}\r\n;\r\ndhtmlXForm.prototype.setRTL = function(a) {\r\n    this._rtl = (a === true ? true : false);\r\n    if (this._rtl) {\r\n        if (String(this.cont).search(/dhxform_rtl/gi) < 0) {\r\n            this.cont.className += \" dhxform_rtl\"\r\n        }\r\n    } else {\r\n        if (String(this.cont).search(/dhxform_rtl/gi) >= 0) {\r\n            this.cont.className = String(this.cont.className).replace(/dhxform_rtl/gi, \"\")\r\n        }\r\n    }\r\n}\r\n;\r\n_dhxForm_doClick = function(h, c) {\r\n    if (typeof (c) == \"object\") {\r\n        var a = c[1];\r\n        c = c[0]\r\n    }\r\n    if (document.createEvent) {\r\n        var g = document.createEvent(\"MouseEvents\");\r\n        g.initEvent(c, true, false);\r\n        h.dispatchEvent(g)\r\n    } else {\r\n        if (document.createEventObject) {\r\n            var g = document.createEventObject();\r\n            g.button = 1;\r\n            h.fireEvent(\"on\" + c, g)\r\n        }\r\n    }\r\n    if (a) {\r\n        window.setTimeout(function() {\r\n            _dhxForm_doClick(h, a)\r\n        }, 100)\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.setFormData = function(e) {\r\n    for (var c in e) {\r\n        var g = this.getItemType(c);\r\n        switch (g) {\r\n        case \"checkbox\":\r\n            this[e[c] == true || parseInt(e[c]) == 1 || e[c] == \"true\" || e[c] == this.getItemValue(c, \"realvalue\") ? \"checkItem\" : \"uncheckItem\"](c);\r\n            break;\r\n        case \"radio\":\r\n            this.checkItem(c, e[c]);\r\n            break;\r\n        case \"input\":\r\n        case \"textarea\":\r\n        case \"password\":\r\n        case \"select\":\r\n        case \"multiselect\":\r\n        case \"hidden\":\r\n        case \"template\":\r\n        case \"combo\":\r\n        case \"calendar\":\r\n        case \"colorpicker\":\r\n        case \"editor\":\r\n            this.setItemValue(c, e[c]);\r\n            break;\r\n        default:\r\n            if (this[\"setFormData_\" + g]) {\r\n                this[\"setFormData_\" + g](c, e[c])\r\n            } else {\r\n                if (!this.hId) {\r\n                    this.hId = this._genStr(12)\r\n                }\r\n                this.setUserData(this.hId, c, e[c])\r\n            }\r\n            break\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.getFormData = function(v, l) {\r\n    this.updateValues();\r\n    var c = {};\r\n    var o = this;\r\n    for (var u in this.itemPull) {\r\n        var n = this.itemPull[u]._idd;\r\n        var w = this.itemPull[u]._type;\r\n        if (w == \"ch\") {\r\n            c[n] = (this.isItemChecked(n) ? this.getItemValue(n) : 0)\r\n        }\r\n        if (w == \"ra\" && !c[this.itemPull[u]._group]) {\r\n            c[this.itemPull[u]._group] = this.getCheckedValue(this.itemPull[u]._group)\r\n        }\r\n        if (w in {\r\n            se: 1,\r\n            ta: 1,\r\n            pw: 1,\r\n            hd: 1,\r\n            tp: 1,\r\n            fl: 1,\r\n            calendar: 1,\r\n            combo: 1,\r\n            editor: 1,\r\n            colorpicker: 1\r\n        }) {\r\n            c[n] = this.getItemValue(n, v)\r\n        }\r\n        if (this[\"getFormData_\" + w]) {\r\n            c[n] = this[\"getFormData_\" + w](n)\r\n        }\r\n        if (w == \"up\") {\r\n            var h = this.getItemValue(n);\r\n            for (var g in h) {\r\n                c[g] = h[g]\r\n            }\r\n        }\r\n        if (this.itemPull[u]._list) {\r\n            for (var e = 0; e < this.itemPull[u]._list.length; e++) {\r\n                var m = this.itemPull[u]._list[e].getFormData(v, l);\r\n                for (var s in m) {\r\n                    c[s] = m[s]\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (!l && this.hId && this._userdata[this.hId]) {\r\n        for (var u in this._userdata[this.hId]) {\r\n            if (!c[u]) {\r\n                c[u] = this._userdata[this.hId][u]\r\n            }\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXForm.prototype.adjustParentSize = function() {\r\n    var l = 0;\r\n    var h = -1;\r\n    for (var m = 0; m < this.base.length; m++) {\r\n        l += this.base[m].firstChild.offsetWidth;\r\n        if (this.base[m].offsetHeight > h) {\r\n            h = this.base[m].offsetHeight\r\n        }\r\n    }\r\n    var g = false;\r\n    try {\r\n        g = (this.cont.parentNode.parentNode.parentNode.parentNode._isCell == true);\r\n        if (g) {\r\n            var a = this.cont.parentNode.parentNode.parentNode.parentNode\r\n        }\r\n    } catch (n) {}\r\n    if (g && typeof (a) != \"undefined\") {\r\n        if (l > 0) {\r\n            a.setWidth(l + 10)\r\n        }\r\n        if (h > 0) {\r\n            a.setHeight(h + a.firstChild.firstChild.offsetHeight + 5)\r\n        }\r\n        g = a = null ;\r\n        return\r\n    }\r\n    var c = false;\r\n    try {\r\n        c = (this.cont.parentNode.parentNode.parentNode._isWindow == true);\r\n        if (c) {\r\n            var o = this.cont.parentNode.parentNode;\r\n            if (typeof (o.callEvent) == \"function\") {\r\n                this.cont.style.display = \"none\";\r\n                o.callEvent(\"_setCellSize\", [l + 15, h + 15]);\r\n                this.cont.style.display = \"\"\r\n            }\r\n        }\r\n    } catch (n) {}\r\n}\r\n;\r\ndhtmlXForm.prototype.reset = function() {\r\n    if (this.callEvent(\"onBeforeReset\", [this.formId, this.getFormData()])) {\r\n        if (this._last_load_data) {\r\n            this.setFormData(this._last_load_data)\r\n        }\r\n        this.callEvent(\"onAfterReset\", [this.formId])\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.send = function(c, m, n, g) {\r\n    if (typeof m == \"function\") {\r\n        n = m;\r\n        m = \"post\"\r\n    } else {\r\n        m = (m == \"get\" ? \"get\" : \"post\")\r\n    }\r\n    if (g !== true && !this.validate()) {\r\n        return\r\n    }\r\n    var l = this.getFormData(true);\r\n    var h = [];\r\n    for (var e in l) {\r\n        h.push(e + \"=\" + encodeURIComponent(l[e]))\r\n    }\r\n    var a = function(o) {\r\n        if (n) {\r\n            n.call(this, o, o.xmlDoc.responseText)\r\n        }\r\n    }\r\n    ;\r\n    if (m == \"get\") {\r\n        window.dhx4.ajax.get(c + (c.indexOf(\"?\") == -1 ? \"?\" : \"&\") + h.join(\"&\"), a)\r\n    } else {\r\n        window.dhx4.ajax.post(c, h.join(\"&\"), a)\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.save = function(a, c) {}\r\n;\r\ndhtmlXForm.prototype.dummy = function() {}\r\n;\r\ndhtmlXForm.prototype._changeFormId = function(c, a) {\r\n    this.formId = a\r\n}\r\n;\r\ndhtmlXForm.prototype._dp_init = function(a) {\r\n    a._methods = [\"dummy\", \"dummy\", \"_changeFormId\", \"dummy\"];\r\n    a._getRowData = function(g, c) {\r\n        var e = this.obj.getFormData(true);\r\n        e[this.action_param] = this.obj.getUserData(g, this.action_param);\r\n        return e\r\n    }\r\n    ;\r\n    a._clearUpdateFlag = function() {}\r\n    ;\r\n    a.attachEvent(\"onAfterUpdate\", function(e, g, h, c) {\r\n        if (g == \"inserted\" || g == \"updated\" || g == \"error\" || g == \"invalid\") {\r\n            this.obj.resetDataProcessor(\"updated\")\r\n        }\r\n        if (g == \"inserted\" || g == \"updated\") {\r\n            this.obj._last_load_data = this.obj.getFormData(true)\r\n        }\r\n        this.obj.callEvent(\"onAfterSave\", [this.obj.formId, c]);\r\n        return true\r\n    });\r\n    a.autoUpdate = false;\r\n    a.setTransactionMode(\"POST\", true);\r\n    this.dp = a;\r\n    this.formId = (new Date()).valueOf();\r\n    this.resetDataProcessor(\"inserted\");\r\n    this.save = function() {\r\n        if (!this.callEvent(\"onBeforeSave\", [this.formId, this.getFormData()])) {\r\n            return\r\n        }\r\n        if (!this.validate()) {\r\n            return\r\n        }\r\n        a.sendData()\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.resetDataProcessor = function(a) {\r\n    if (!this.dp) {\r\n        return\r\n    }\r\n    this.dp.updatedRows = [];\r\n    this.dp._in_progress = [];\r\n    this.dp.setUpdated(this.formId, true, a)\r\n}\r\n;\r\ndhtmlXForm.prototype._ccActivate = function(e, a, c) {\r\n    if (!this._formLS) {\r\n        this._formLS = {}\r\n    }\r\n    if (!this._formLS[e]) {\r\n        this._formLS[e] = {\r\n            input: a,\r\n            value: c\r\n        }\r\n    }\r\n    if (!this._ccActive) {\r\n        this._ccActive = true;\r\n        this._ccDo()\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXForm.prototype._ccDeactivate = function(a) {\r\n    if (this._ccTm) {\r\n        window.clearTimeout(this._ccTm)\r\n    }\r\n    this._ccActive = false;\r\n    if (this._formLS != null  && this._formLS[a] != null ) {\r\n        this._formLS[a].input = null ;\r\n        this._formLS[a] = null ;\r\n        delete this._formLS[a]\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype._ccDo = function() {\r\n    if (this._ccTm) {\r\n        window.clearTimeout(this._ccTm)\r\n    }\r\n    for (var c in this._formLS) {\r\n        var h = this._formLS[c].input;\r\n        if (String(h.tagName).toLowerCase() == \"select\") {\r\n            var e = \"\";\r\n            if (h.selectedIndex >= 0 && h.selectedIndex < h.options.length) {\r\n                e = h.options[h.selectedIndex].value\r\n            }\r\n        } else {\r\n            var e = h.value\r\n        }\r\n        if (e != this._formLS[c].value) {\r\n            this._formLS[c].value = e;\r\n            this.callEvent(\"onInputChange\", [h._idd, e, this])\r\n        }\r\n        h = null \r\n    }\r\n    if (this._ccActive) {\r\n        var g = this;\r\n        this._ccTm = window.setTimeout(function() {\r\n            g._ccDo();\r\n            g = null \r\n        }, 100)\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype._ccReload = function(c, a) {\r\n    if (this._formLS && this._formLS[c]) {\r\n        this._formLS[c].value = a\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype._checkDim = function(m, l) {\r\n    var g = document.createElement(\"DIV\");\r\n    g.className = \"dhxform_obj_\" + this.skin;\r\n    g.style.cssText += (dhx4.isIE6 == true ? \"visibility:hidden;\" : \"position:absolute;left:-2000px;top:-1000px;\");\r\n    document.body.appendChild(g);\r\n    var h = m.parentNode;\r\n    var c = m.nextSibling;\r\n    g.appendChild(m);\r\n    var e = parseInt(l.style.width);\r\n    var a = (dhx4.isFF || dhx4.isIE || dhx4.isChrome || dhx4.isOpera ? l.offsetWidth : l.clientWidth);\r\n    var n = a - e;\r\n    if (c != null ) {\r\n        h.insertBefore(m, c)\r\n    } else {\r\n        h.appendChild(m)\r\n    }\r\n    g.parentNode.removeChild(g);\r\n    h = c = g = m = l = null ;\r\n    return n\r\n}\r\n;\r\ndhtmlXForm.prototype._autoload = function() {\r\n    var c = [\"ftype\", \"name\", \"value\", \"label\", \"check\", \"checked\", \"disabled\", \"text\", \"rows\", \"select\", \"selected\", \"width\", \"style\", \"className\", \"labelWidth\", \"labelHeight\", \"labelLeft\", \"labelTop\", \"inputWidth\", \"inputHeight\", \"inputLeft\", \"inputTop\", \"position\", \"size\"];\r\n    var e = document.getElementsByTagName(\"UL\");\r\n    var g = [];\r\n    for (var m = 0; m < e.length; m++) {\r\n        if (e[m].className == \"dhtmlxForm\") {\r\n            var l = document.createElement(\"DIV\");\r\n            g[g.length] = {\r\n                nodeUL: e[m],\r\n                nodeForm: l,\r\n                data: dhtmlXForm.prototype._ulToObject(e[m], c),\r\n                name: (e[m].getAttribute(\"name\") || null )\r\n            }\r\n        }\r\n    }\r\n    for (var m = 0; m < g.length; m++) {\r\n        g[m].nodeUL.parentNode.insertBefore(g[m].nodeForm, g[m].nodeUL);\r\n        var n = new dhtmlXForm(g[m].nodeForm,g[m].data);\r\n        if (g[m].name !== null ) {\r\n            window[g[m].name] = n\r\n        }\r\n        var h = (g[m].nodeUL.getAttribute(\"oninit\") || null );\r\n        g[m].nodeUL.parentNode.removeChild(g[m].nodeUL);\r\n        g[m].nodeUL = null ;\r\n        g[m].nodeForm = null ;\r\n        g[m].data = null ;\r\n        g[m] = null ;\r\n        if (h) {\r\n            if (typeof (h) == \"function\") {\r\n                h()\r\n            } else {\r\n                if (typeof (window[h]) == \"function\") {\r\n                    window[h]()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        window.removeEventListener(\"load\", dhtmlXForm.prototype._autoload, false)\r\n    } else {\r\n        window.detachEvent(\"onload\", dhtmlXForm.prototype._autoload)\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.getButton = function(a) {\r\n    return this.doWithItem(a, \"getButton\")\r\n}\r\n;\r\ndhtmlXForm.prototype.items.button.getButton = function(a) {\r\n    return a\r\n}\r\n;\r\nif (typeof (window.addEventListener) == \"function\") {\r\n    window.addEventListener(\"load\", dhtmlXForm.prototype._autoload, false)\r\n} else {\r\n    window.attachEvent(\"onload\", dhtmlXForm.prototype._autoload)\r\n}\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachForm = function(a) {\r\n        this.callEvent(\"_onBeforeContentAttach\", [\"form\"]);\r\n        var c = document.createElement(\"DIV\");\r\n        c.style.width = \"100%\";\r\n        c.style.height = \"100%\";\r\n        c.style.position = \"relative\";\r\n        if (window.dhtmlx && dhtmlx.$customScroll) {\r\n            dhtmlx.CustomScroll.enable(c)\r\n        } else {\r\n            c.style.overflow = \"auto\"\r\n        }\r\n        this._attachObject(c);\r\n        this.dataType = \"form\";\r\n        this.dataObj = new dhtmlXForm(c,a);\r\n        this.dataObj.setSkin(this.conf.skin);\r\n        c = null ;\r\n        this.callEvent(\"_onContentAttach\", []);\r\n        return this.dataObj\r\n    }\r\n}\r\ndhtmlXForm.prototype.items.combo = {\r\n    render: function(c, e) {\r\n        c._type = \"combo\";\r\n        c._enabled = true;\r\n        c._value = null ;\r\n        c._newValue = null ;\r\n        this.doAddLabel(c, e);\r\n        this.doAddInput(c, e, \"SELECT\", null , true, true, \"dhxform_select\");\r\n        this.doAttachEvents(c);\r\n        this.doLoadOpts(c, e);\r\n        c.onselectstart = function(g) {\r\n            return true\r\n        }\r\n        ;\r\n        c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute(\"mode\", e.comboType || \"\");\r\n        if (e.comboImagePath) {\r\n            c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute(\"imagePath\", e.comboImagePath)\r\n        }\r\n        if (e.comboDefaultImage) {\r\n            c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute(\"defaultImage\", e.comboDefaultImage)\r\n        }\r\n        if (e.comboDefaultImageDis) {\r\n            c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute(\"defaultImageDis\", e.comboDefaultImageDis)\r\n        }\r\n        c._combo = new dhtmlXComboFromSelect(c.childNodes[c._ll ? 1 : 0].childNodes[0]);\r\n        c._combo.setSkin(c.getForm().skin);\r\n        c._combo._currentComboValue = c._combo.getSelectedValue();\r\n        c._combo.getInput().id = e.uid;\r\n        var a = this;\r\n        c._combo.attachEvent(\"onChange\", function() {\r\n            a.doOnChange(this)\r\n        });\r\n        if (e.connector) {\r\n            this.doLoadOptsConnector(c, e.connector)\r\n        }\r\n        if (e.filtering) {\r\n            c._combo.enableFilteringMode(true)\r\n        } else {\r\n            if (e.serverFiltering) {\r\n                c._combo.enableFilteringMode(true, e.serverFiltering, e.filterCache, e.filterSubLoad)\r\n            }\r\n        }\r\n        if (e.readonly == true) {\r\n            this.setReadonly(c, true)\r\n        }\r\n        if (e.hidden == true) {\r\n            this.hide(c)\r\n        }\r\n        if (e.style) {\r\n            c._combo.DOMelem_input.style.cssText += e.style\r\n        }\r\n        c._combo.attachEvent(\"onFocus\", function() {\r\n            var g = this.cont.parentNode.parentNode;\r\n            var h = g.getForm();\r\n            if (h.skin == \"dhx_terrace\" && this.cont.className.search(/combo_in_focus/) < 0) {\r\n                this.cont.className += \" combo_in_focus\"\r\n            }\r\n            h.callEvent(\"onFocus\", [g._idd]);\r\n            h = g = null \r\n        });\r\n        c._combo.attachEvent(\"onBlur\", function() {\r\n            var g = this.cont.parentNode.parentNode;\r\n            var h = g.getForm();\r\n            if (h.skin == \"dhx_terrace\" && this.cont.className.search(/combo_in_focus/) >= 0) {\r\n                this.cont.className = this.cont.className.replace(/\\s{0,}combo_in_focus/gi, \"\")\r\n            }\r\n            h.callEvent(\"onBlur\", [g._idd]);\r\n            h = g = null \r\n        });\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onchange = null ;\r\n        a._combo._currentComboValue = null ;\r\n        a._combo.unload();\r\n        a._combo = null ;\r\n        a._apiChange = null ;\r\n        this.d2(a);\r\n        a = null \r\n    },\r\n    doAttachEvents: function(c) {\r\n        var a = this;\r\n        c.childNodes[c._ll ? 1 : 0].childNodes[0].onchange = function() {\r\n            a.doOnChange(this);\r\n            a.doValidate(this.DOMParent.parentNode.parentNode)\r\n        }\r\n    },\r\n    doValidate: function(a) {\r\n        if (a.getForm().hot_validate) {\r\n            this._validate(a)\r\n        }\r\n    },\r\n    doOnChange: function(c) {\r\n        var a = c.base.parentNode.parentNode.parentNode;\r\n        if (a._apiChange) {\r\n            return\r\n        }\r\n        c._newComboValue = c.getSelectedValue();\r\n        if (c._newComboValue != c._currentComboValue) {\r\n            if (a.checkEvent(\"onBeforeChange\")) {\r\n                if (a.callEvent(\"onBeforeChange\", [a._idd, c._currentComboValue, c._newComboValue]) !== true) {\r\n                    window.setTimeout(function() {\r\n                        c.setComboValue(c._currentComboValue)\r\n                    }, 1);\r\n                    return false\r\n                }\r\n            }\r\n            c._currentComboValue = c._newComboValue;\r\n            a.callEvent(\"onChange\", [a._idd, c._currentComboValue])\r\n        }\r\n        a._autoCheck(a._enabled)\r\n    },\r\n    doLoadOptsConnector: function(g, a) {\r\n        var e = this;\r\n        var c = g;\r\n        g._connector_working = true;\r\n        g._apiChange = true;\r\n        g._combo.load(a, function() {\r\n            c.callEvent(\"onOptionsLoaded\", [c._idd]);\r\n            c._connector_working = false;\r\n            if (c._connector_value != null ) {\r\n                e.setValue(c, c._connector_value);\r\n                c._connector_value = null \r\n            }\r\n            c._apiChange = false;\r\n            e = c = null \r\n        })\r\n    },\r\n    enable: function(a) {\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._enabled = true;\r\n        a._combo.enable()\r\n    },\r\n    disable: function(a) {\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._enabled = false;\r\n        a._combo.disable()\r\n    },\r\n    getCombo: function(a) {\r\n        return a._combo\r\n    },\r\n    setValue: function(a, c) {\r\n        if (a._connector_working) {\r\n            a._connector_value = c;\r\n            return\r\n        }\r\n        a._apiChange = true;\r\n        a._combo.setComboValue(c);\r\n        a._combo._currentComboValue = a._combo.getActualValue();\r\n        a._apiChange = false\r\n    },\r\n    getValue: function(a) {\r\n        return a._combo.getActualValue()\r\n    },\r\n    setWidth: function(c, a) {\r\n        c.childNodes[c._ll ? 1 : 0].childNodes[0].style.width = a + \"px\"\r\n    },\r\n    setReadonly: function(a, c) {\r\n        if (!a._combo) {\r\n            return\r\n        }\r\n        a._combo_ro = c;\r\n        a._combo.readonly(a._combo_ro)\r\n    },\r\n    isReadonly: function(a, c) {\r\n        return a._combo_ro || false\r\n    },\r\n    setFocus: function(a) {\r\n        if (a._enabled) {\r\n            a._combo.setFocus()\r\n        }\r\n    },\r\n    _setCss: function(a, e, c) {\r\n        a._combo.setFontSize(c, c)\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doLoadOpts: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        isEnabled: 1,\r\n        _checkNoteWidth: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.combo[c] = dhtmlXForm.prototype.items.select[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.combo.d2 = dhtmlXForm.prototype.items.select.destruct;\r\ndhtmlXForm.prototype.getCombo = function(a) {\r\n    return this.doWithItem(a, \"getCombo\")\r\n}\r\n;\r\ndhtmlXForm.prototype.items.calendar = {\r\n    render: function(e, h) {\r\n        var c = this;\r\n        e._type = \"calendar\";\r\n        e._enabled = true;\r\n        var l = navigator.userAgent;\r\n        var a = (l.indexOf(\"MSIE 6.0\") >= 0 || l.indexOf(\"MSIE 7.0\") >= 0 || l.indexOf(\"MSIE 8.0\") >= 0);\r\n        this.doAddLabel(e, h);\r\n        this.doAddInput(e, h, \"INPUT\", \"TEXT\", true, true, \"dhxform_textarea calendar\");\r\n        this.doAttachChangeLS(e);\r\n        if (a) {\r\n            e.childNodes[e._ll ? 1 : 0].childNodes[0].onfocus2 = e.childNodes[e._ll ? 1 : 0].childNodes[0].onfocus;\r\n            e.childNodes[e._ll ? 1 : 0].childNodes[0].onfocus = function() {\r\n                if (this._skipOnFocus == true) {\r\n                    this._skipOnFocus = false;\r\n                    return\r\n                }\r\n                this.onfocus2.apply(this, arguments)\r\n            }\r\n        }\r\n        e.childNodes[e._ll ? 1 : 0].childNodes[0]._idd = e._idd;\r\n        e.childNodes[e._ll ? 1 : 0].childNodes[0].onblur = function() {\r\n            var m = this.parentNode.parentNode;\r\n            if (m._c.base._formMouseDown) {\r\n                m._c.base._formMouseDown = false;\r\n                this._skipOnFocus = true;\r\n                this.focus();\r\n                this.value = this.value;\r\n                m = null ;\r\n                return true\r\n            }\r\n            var n = m.getForm();\r\n            n._ccDeactivate(m._idd);\r\n            c.checkEnteredValue(this.parentNode.parentNode);\r\n            if (n.live_validate) {\r\n                c._validate(m)\r\n            }\r\n            n.callEvent(\"onBlur\", [m._idd]);\r\n            if (!m._c.isVisible()) {\r\n                m._tempValue = null \r\n            }\r\n            n = m = null \r\n        }\r\n        ;\r\n        e._f = (h.dateFormat || null );\r\n        e._f0 = (h.serverDateFormat || e._f);\r\n        var g = e.getForm();\r\n        e._c = new dhtmlXCalendarObject(e.childNodes[e._ll ? 1 : 0].childNodes[0],h.skin || g.skin || \"dhx_skyblue\");\r\n        e._c._nullInInput = true;\r\n        e._c.enableListener(e.childNodes[e._ll ? 1 : 0].childNodes[0]);\r\n        if (e._f != null ) {\r\n            e._c.setDateFormat(e._f)\r\n        }\r\n        if (!window.dhx4.s2b(h.enableTime)) {\r\n            e._c.hideTime()\r\n        }\r\n        if (window.dhx4.s2b(h.showWeekNumbers)) {\r\n            e._c.showWeekNumbers()\r\n        }\r\n        if (!isNaN(h.weekStart)) {\r\n            e._c.setWeekStartDay(h.weekStart)\r\n        }\r\n        if (typeof (h.calendarPosition) != \"undefined\") {\r\n            e._c.setPosition(h.calendarPosition)\r\n        }\r\n        if (h.minutesInterval != null ) {\r\n            e._c.setMinutesInterval(h.minutesInterval)\r\n        }\r\n        e._c._itemIdd = e._idd;\r\n        e._c.attachEvent(\"onBeforeChange\", function(m) {\r\n            if (e._value != m) {\r\n                if (e.checkEvent(\"onBeforeChange\")) {\r\n                    if (e.callEvent(\"onBeforeChange\", [e._idd, e._value, m]) !== true) {\r\n                        return false\r\n                    }\r\n                }\r\n                e._tempValue = e._value = m;\r\n                c.setValue(e, m, false);\r\n                e.callEvent(\"onChange\", [this._itemIdd, e._value])\r\n            }\r\n            return true\r\n        });\r\n        e._c.attachEvent(\"onClick\", function() {\r\n            e._tempValue = null \r\n        });\r\n        e._c.attachEvent(\"onHide\", function() {\r\n            e._tempValue = null \r\n        });\r\n        if (a) {\r\n            e._c.base.onmousedown = function() {\r\n                this._formMouseDown = true;\r\n                return false\r\n            }\r\n        }\r\n        this.setValue(e, h.value);\r\n        g = null ;\r\n        return this\r\n    },\r\n    getCalendar: function(a) {\r\n        return a._c\r\n    },\r\n    setSkin: function(a, c) {\r\n        a._c.setSkin(c)\r\n    },\r\n    setValue: function(c, e, a) {\r\n        if (!e || e == null  || typeof (e) == \"undefined\" || e == \"\") {\r\n            c._value = null ;\r\n            c.childNodes[c._ll ? 1 : 0].childNodes[0].value = \"\"\r\n        } else {\r\n            c._value = (e instanceof Date ? e : c._c._strToDate(e, c._f0 || c._c._dateFormat));\r\n            c.childNodes[c._ll ? 1 : 0].childNodes[0].value = c._c._dateToStr(c._value, c._f || c._c._dateFormat)\r\n        }\r\n        if (a !== false) {\r\n            c._c.setDate(c._value)\r\n        }\r\n    },\r\n    getValue: function(c, a) {\r\n        var e = c._tempValue || c._c.getDate();\r\n        if (a === true && e == null ) {\r\n            return \"\"\r\n        }\r\n        return ( a === true ? c._c._dateToStr(e, c._f0 || c._c._dateFormat) : e) \r\n    },\r\n    setDateFormat: function(c, a, e) {\r\n        c._f = a;\r\n        c._f0 = (e || c._f);\r\n        c._c.setDateFormat(c._f);\r\n        this.setValue(c, this.getValue(c))\r\n    },\r\n    destruct: function(a) {\r\n        a._c.disableListener(a.childNodes[a._ll ? 1 : 0].childNodes[0]);\r\n        a._c.unload();\r\n        a._c = null ;\r\n        try {\r\n            delete a._c\r\n        } catch (c) {}\r\n        a._f = null ;\r\n        try {\r\n            delete a._f\r\n        } catch (c) {}\r\n        a._f0 = null ;\r\n        try {\r\n            delete a._f0\r\n        } catch (c) {}\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0]._idd = null ;\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0].onblur = null ;\r\n        this.d2(a);\r\n        a = null \r\n    },\r\n    checkEnteredValue: function(a) {\r\n        this.setValue(a, a._c.getDate())\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1,\r\n        setReadonly: 1,\r\n        isReadonly: 1,\r\n        setFocus: 1,\r\n        getInput: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.calendar[c] = dhtmlXForm.prototype.items.input[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.calendar.doAttachChangeLS = dhtmlXForm.prototype.items.select.doAttachChangeLS;\r\ndhtmlXForm.prototype.items.calendar.d2 = dhtmlXForm.prototype.items.input.destruct;\r\ndhtmlXForm.prototype.getCalendar = function(a) {\r\n    return this.doWithItem(a, \"getCalendar\")\r\n}\r\n;\r\ndhtmlXForm.prototype.setCalendarDateFormat = function(c, a, e) {\r\n    this.doWithItem(c, \"setDateFormat\", a, e)\r\n}\r\n;\r\ndhtmlXForm.prototype.items.btn2state = {\r\n    setChecked: function(a, c) {\r\n        a._checked = (c === true ? true : false);\r\n        a.childNodes[a._ll ? 1 : 0].lastChild.className = \"dhxform_img \" + a._cssName + \"_\" + (a._checked ? \"1\" : \"0\");\r\n        this.doCheckValue(a)\r\n    }\r\n};\r\n(function() {\r\n    for (var c in dhtmlXForm.prototype.items.checkbox) {\r\n        if (!dhtmlXForm.prototype.items.btn2state[c]) {\r\n            dhtmlXForm.prototype.items.btn2state[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n        }\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.btn2state.render2 = dhtmlXForm.prototype.items.btn2state.render;\r\ndhtmlXForm.prototype.items.btn2state.render = function(a, c) {\r\n    c._autoInputWidth = false;\r\n    this.render2(a, c);\r\n    a._type = \"btn2state\";\r\n    a._cssName = (typeof (c.cssName) == \"undefined\" ? \"btn2state\" : c.cssName);\r\n    a._updateImgNode = function() {}\r\n    ;\r\n    a._doOnFocus = function() {\r\n        a.getForm().callEvent(\"onFocus\", [a._idd])\r\n    }\r\n    ;\r\n    a._doOnBlur = function() {\r\n        a.getForm().callEvent(\"onBlur\", [a._idd])\r\n    }\r\n    ;\r\n    a._doOnKeyUpDown = function(g, e, h) {\r\n        this.callEvent(g, [this.childNodes[this._ll ? 0 : 1].childNodes[0], e, this._idd])\r\n    }\r\n    ;\r\n    this.setChecked(a, a._checked);\r\n    return this\r\n}\r\n;\r\ndhtmlXForm.prototype.setFormData_btn2state = function(a, c) {\r\n    this[c == true || parseInt(c) == 1 || c == \"true\" || c == this.getItemValue(a) ? \"checkItem\" : \"uncheckItem\"](a)\r\n}\r\n;\r\ndhtmlXForm.prototype.getFormData_btn2state = function(a) {\r\n    return ( this.isItemChecked(a) ? this.getItemValue(a) : 0) \r\n}\r\n;\r\ndhtmlXForm.prototype.items.colorpicker = {\r\n    colorpicker: {},\r\n    render: function(e, g) {\r\n        var c = this;\r\n        e._type = \"colorpicker\";\r\n        e._enabled = true;\r\n        this.doAddLabel(e, g);\r\n        this.doAddInput(e, g, \"INPUT\", \"TEXT\", true, true, \"dhxform_textarea\");\r\n        e._value = (g.value || \"\");\r\n        e.childNodes[e._ll ? 1 : 0].childNodes[0].value = e._value;\r\n        var a = {\r\n            input: e.childNodes[e._ll ? 1 : 0].childNodes[0],\r\n            custom_colors: (window.dhx4.s2b(g.enableCustomColors) == true),\r\n            skin: e.getForm().skin\r\n        };\r\n        this.colorpicker[e._idd] = new dhtmlXColorPicker(a);\r\n        this.colorpicker[e._idd]._nodes[0].valueColor = null ;\r\n        this.colorpicker[e._idd].base.className += \" dhtmlxcp_in_form\";\r\n        if (typeof (g.customColors) != \"undefined\") {\r\n            this.colorpicker[e._idd].setCustomColors(g.customColors)\r\n        }\r\n        if (typeof (g.cpPosition) == \"string\") {\r\n            this.colorpicker[e._idd].setPosition(g.cpPosition)\r\n        }\r\n        this.colorpicker[e._idd].attachEvent(\"onSelect\", function(h) {\r\n            if (e._value != h) {\r\n                if (e.checkEvent(\"onBeforeChange\")) {\r\n                    if (e.callEvent(\"onBeforeChange\", [e._idd, e._value, h]) !== true) {\r\n                        e.childNodes[e._ll ? 1 : 0].childNodes[0].value = e._value;\r\n                        return\r\n                    }\r\n                }\r\n                e._value = h;\r\n                c.setValue(e, h);\r\n                e.callEvent(\"onChange\", [e._idd, e._value])\r\n            }\r\n        });\r\n        this.colorpicker[e._idd].attachEvent(\"onHide\", function(h) {\r\n            var l = e.childNodes[e._ll ? 1 : 0].childNodes[0];\r\n            if (l.value != e._value) {\r\n                l.value = e._value\r\n            }\r\n            l = null \r\n        });\r\n        e.childNodes[e._ll ? 1 : 0].childNodes[0]._idd = e._idd;\r\n        return this\r\n    },\r\n    getColorPicker: function(a) {\r\n        return this.colorpicker[a._idd]\r\n    },\r\n    destruct: function(a) {\r\n        if (this.colorpicker[a._idd].unload) {\r\n            this.colorpicker[a._idd].unload()\r\n        }\r\n        this.colorpicker[a._idd] = null ;\r\n        try {\r\n            delete this.colorpicker[a._idd]\r\n        } catch (c) {}\r\n        a.childNodes[a._ll ? 1 : 0].childNodes[0]._idd = null ;\r\n        this.d2(a);\r\n        a = null \r\n    },\r\n    setSkin: function(a, c) {\r\n        this.colorpicker[a._idd].setSkin(c)\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        enable: 1,\r\n        disable: 1,\r\n        isEnabled: 1,\r\n        setWidth: 1,\r\n        setReadonly: 1,\r\n        isReadonly: 1,\r\n        setValue: 1,\r\n        getValue: 1,\r\n        updateValue: 1,\r\n        setFocus: 1,\r\n        getInput: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.colorpicker[c] = dhtmlXForm.prototype.items.input[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.colorpicker.d2 = dhtmlXForm.prototype.items.input.destruct;\r\ndhtmlXForm.prototype.getColorPicker = function(a) {\r\n    return this.doWithItem(a, \"getColorPicker\")\r\n}\r\n;\r\ndhtmlXForm.prototype.items.container = {\r\n    render: function(a, c) {\r\n        a._type = \"container\";\r\n        a._enabled = true;\r\n        this.doAddLabel(a, c);\r\n        this.doAddInput(a, c, \"DIV\", null , true, true, \"dhxform_container\");\r\n        return this\r\n    },\r\n    getContainer: function(a) {\r\n        return a.childNodes[a._ll ? 1 : 0].childNodes[0]\r\n    },\r\n    enable: function(a) {\r\n        a._enabled = true;\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a.callEvent(\"onEnable\", [a._idd])\r\n    },\r\n    disable: function(a) {\r\n        a._enabled = false;\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a.callEvent(\"onDisable\", [a._idd])\r\n    },\r\n    doAttachEvents: function() {},\r\n    setValue: function() {},\r\n    getValue: function() {\r\n        return null \r\n    }\r\n};\r\ndhtmlXForm.prototype.getContainer = function(a) {\r\n    return this.doWithItem(a, \"getContainer\")\r\n}\r\n;\r\n(function() {\r\n    for (var c in dhtmlXForm.prototype.items.input) {\r\n        if (!dhtmlXForm.prototype.items.container[c]) {\r\n            dhtmlXForm.prototype.items.container[c] = dhtmlXForm.prototype.items.input[c]\r\n        }\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.editor = {\r\n    editor: {},\r\n    render: function(e, g) {\r\n        var a = (!isNaN(g.rows));\r\n        e._type = \"editor\";\r\n        e._enabled = true;\r\n        e._editor_id = e.getForm().idPrefix + e._idd;\r\n        this.doAddLabel(e, g);\r\n        this.doAddInput(e, g, \"DIV\", null , true, true, \"dhxform_item_template\");\r\n        e._value = (g.value || \"\");\r\n        var c = this;\r\n        this.editor[e._editor_id] = new dhtmlXEditor({\r\n            parent: e.childNodes[e._ll ? 1 : 0].childNodes[0],\r\n            content: e._value,\r\n            iconsPath: g.iconsPath,\r\n            toolbar: g.toolbar\r\n        });\r\n        this.editor[e._editor_id].attachEvent(\"onAccess\", function(l, m) {\r\n            e.callEvent(\"_onBeforeEditorAccess\", []);\r\n            _dhxForm_doClick(document.body, \"click\");\r\n            if (l == \"blur\") {\r\n                c.doOnBlur(e, this);\r\n                e.callEvent(\"onBlur\", [e._idd]);\r\n                if (e.getForm().skin == \"dhx_terrace\") {\r\n                    var h = e.childNodes[e._ll ? 1 : 0].className;\r\n                    if (h.indexOf(\"dhxeditor_focus\") >= 0) {\r\n                        e.childNodes[e._ll ? 1 : 0].className = (h).replace(/\\s{0,}dhxeditor_focus/gi, \"\")\r\n                    }\r\n                }\r\n            } else {\r\n                e.callEvent(\"onEditorAccess\", [e._idd, l, m, this, e.getForm()]);\r\n                e.callEvent(\"onFocus\", [e._idd]);\r\n                if (e.getForm().skin == \"dhx_terrace\") {\r\n                    var h = e.childNodes[e._ll ? 1 : 0].className;\r\n                    if (h.indexOf(\"dhxeditor_focus\") == -1) {\r\n                        e.childNodes[e._ll ? 1 : 0].className += \" dhxeditor_focus\"\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        this.editor[e._editor_id].attachEvent(\"onToolbarClick\", function(h) {\r\n            e.callEvent(\"onEditorToolbarClick\", [e._idd, h, this, e.getForm()])\r\n        });\r\n        if (g.readonly) {\r\n            this.setReadonly(e, true)\r\n        }\r\n        e.childNodes[e._ll ? 0 : 1].childNodes[0].removeAttribute(\"for\");\r\n        e.childNodes[e._ll ? 0 : 1].childNodes[0].onclick = function() {\r\n            c.editor[e._editor_id]._focus()\r\n        }\r\n        ;\r\n        return this\r\n    },\r\n    doOnBlur: function(e, c) {\r\n        var a = c.getContent();\r\n        if (e._value != a) {\r\n            if (e.checkEvent(\"onBeforeChange\")) {\r\n                if (e.callEvent(\"onBeforeChange\", [e._idd, e._value, a]) !== true) {\r\n                    c.setContent(e._value);\r\n                    return\r\n                }\r\n            }\r\n            e._value = a;\r\n            e.callEvent(\"onChange\", [e._idd, a])\r\n        }\r\n    },\r\n    setValue: function(a, c) {\r\n        if (a._value == c) {\r\n            return\r\n        }\r\n        a._value = c;\r\n        this.editor[a._editor_id].setContent(a._value)\r\n    },\r\n    getValue: function(a) {\r\n        a._value = this.editor[a._editor_id].getContent();\r\n        return a._value\r\n    },\r\n    enable: function(a) {\r\n        if (this.isEnabled(a) != true) {\r\n            this.editor[a._editor_id].setReadonly(false);\r\n            this.doEn(a)\r\n        }\r\n    },\r\n    disable: function(a) {\r\n        if (this.isEnabled(a) == true) {\r\n            this.editor[a._editor_id].setReadonly(true);\r\n            this.doDis(a)\r\n        }\r\n    },\r\n    setReadonly: function(a, c) {\r\n        this.editor[a._editor_id].setReadonly(c)\r\n    },\r\n    getEditor: function(a) {\r\n        return ( this.editor[a._editor_id] || null ) \r\n    },\r\n    destruct: function(a) {\r\n        a.childNodes[a._ll ? 0 : 1].childNodes[0].onclick = null ;\r\n        this.editor[a._editor_id].unload();\r\n        this.editor[a._editor_id] = null ;\r\n        this.d2(a);\r\n        a = null \r\n    },\r\n    setFocus: function(a) {\r\n        this.editor[a._editor_id]._focus()\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doAddLabel: 1,\r\n        doAddInput: 1,\r\n        doUnloadNestedLists: 1,\r\n        setText: 1,\r\n        getText: 1,\r\n        setWidth: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.editor[c] = dhtmlXForm.prototype.items.template[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.editor.d2 = dhtmlXForm.prototype.items.select.destruct;\r\ndhtmlXForm.prototype.items.editor.doEn = dhtmlXForm.prototype.items.select.enable;\r\ndhtmlXForm.prototype.items.editor.doDis = dhtmlXForm.prototype.items.select.disable;\r\ndhtmlXForm.prototype.getEditor = function(a) {\r\n    return this.doWithItem(a, \"getEditor\")\r\n}\r\n;\r\ndhtmlXForm.prototype.items.image = {\r\n    _dimFix: true,\r\n    render: function(l, m) {\r\n        l._type = \"image\";\r\n        l._enabled = true;\r\n        l._fr_name = \"dhxform_image_\" + window.dhx4.newId();\r\n        l._url = m.url;\r\n        if (m.inputWidth == \"auto\") {\r\n            m.inputWidth = 120\r\n        }\r\n        if (m.inputHeight == \"auto\") {\r\n            m.inputHeight = m.inputWidth\r\n        }\r\n        this.doAddLabel(l, m);\r\n        this.doAddInput(l, m, \"DIV\", null , true, true, \"dhxform_image\");\r\n        var c = l.childNodes[l._ll ? 1 : 0].childNodes[0];\r\n        c.style.height = parseInt(c.style.height) - dhtmlXForm.prototype.items[this.t]._dim + \"px\";\r\n        var a = (typeof (m.imageWidth) != \"undefined\" ? parseInt(m.imageWidth) : m.inputWidth);\r\n        var e = (typeof (m.imageHeight) != \"undefined\" ? parseInt(m.imageHeight) : m.inputHeight);\r\n        if (e == \"auto\") {\r\n            e = a\r\n        }\r\n        l._dim = {\r\n            mw: m.inputWidth - this._dim,\r\n            mh: m.inputHeight - this._dim,\r\n            w: a,\r\n            h: e\r\n        };\r\n        c.innerHTML = \"<img class='dhxform_image_img' border='0' style='visibility:hidden;'><iframe name='\" + l._fr_name + \"' style='position: absolute; width:0px; height:0px; top:-10px; left:-10px;' frameBorder='0' border='0'></iframe><div class='dhxform_image_wrap'><form action='\" + l._url + \"' method='POST' enctype='multipart/form-data' target='\" + l._fr_name + \"' class='dhxform_image_form'><input type='hidden' name='action' value='uploadImage'><input type='hidden' name='itemId' value='\" + l._idd + \"'><input type='file' name='file' class='dhxform_image_input'></form>\";\r\n        \"</div>\";\r\n        this.adjustImage(l);\r\n        c.childNodes[2].firstChild.lastChild.onchange = function() {\r\n            l._is_uploading = true;\r\n            this.parentNode.submit();\r\n            this.parentNode.parentNode.className = \"dhxform_image_wrap dhxform_image_in_progress\";\r\n            this.value = \"\"\r\n        }\r\n        ;\r\n        var g = this;\r\n        if (window.navigator.userAgent.indexOf(\"MSIE\") >= 0) {\r\n            c.childNodes[1].onreadystatechange = function() {\r\n                if (this.readyState == \"complete\") {\r\n                    g.doOnUpload(l)\r\n                }\r\n            }\r\n        } else {\r\n            c.childNodes[1].onload = function() {\r\n                g.doOnUpload(l)\r\n            }\r\n        }\r\n        this._moreClear = function() {\r\n            g = null \r\n        }\r\n        ;\r\n        this.setValue(l, m.value || \"\");\r\n        c = null ;\r\n        return this\r\n    },\r\n    destruct: function(c) {\r\n        var a = c.childNodes[c._ll ? 1 : 0].childNodes[0];\r\n        a.childNodes[2].firstChild.lastChild.onchange = null ;\r\n        a.childNodes[1].onreadystatechange = null ;\r\n        a.childNodes[1].onload = null ;\r\n        this._moreClear();\r\n        this.d2(c);\r\n        c = null \r\n    },\r\n    doAttachEvents: function() {},\r\n    setValue: function(e, h) {\r\n        e._value = (h == null  ? \"\" : h);\r\n        var c = e._url + (e._url.indexOf(\"?\") >= 0 ? \"&\" : \"?\") + \"action=loadImage&itemId=\" + encodeURIComponent(e._idd) + \"&itemValue=\" + encodeURIComponent(e._value) + window.dhx4.ajax._dhxr(\"&\");\r\n        var g = e.childNodes[e._ll ? 1 : 0].childNodes[0].firstChild;\r\n        if (g.nextSibling.tagName.toLowerCase() == \"img\") {\r\n            g.nextSibling.src = c\r\n        } else {\r\n            var a = document.createElement(\"IMG\");\r\n            a.className = \"dhxform_image_img\";\r\n            a.style.visibility = \"hidden\";\r\n            a.onload = function() {\r\n                this.style.visibility = \"visible\";\r\n                this.parentNode.removeChild(this.nextSibling);\r\n                this.onload = this.onerror = null \r\n            }\r\n            ;\r\n            a.onerror = function() {\r\n                this.onload.apply(this, arguments);\r\n                this.style.visibility = \"hidden\"\r\n            }\r\n            ;\r\n            g.parentNode.insertBefore(a, g);\r\n            a.src = c;\r\n            a = null ;\r\n            this.adjustImage(e)\r\n        }\r\n        g = null \r\n    },\r\n    getValue: function(a) {\r\n        return a._value\r\n    },\r\n    doOnUpload: function(e) {\r\n        if (e._is_uploading == true) {\r\n            var a = e.childNodes[e._ll ? 1 : 0].childNodes[0].lastChild.previousSibling;\r\n            var c = dhx4.s2j(a.contentWindow.document.body.innerHTML);\r\n            if (typeof (c) == \"object\" && c != null  && c.state == true && c.itemId == e._idd) {\r\n                this.setValue(e, c.itemValue, true);\r\n                e.getForm().callEvent(\"onImageUploadSuccess\", [c.itemId, c.itemVaule, c.extra])\r\n            } else {\r\n                e.getForm().callEvent(\"onImageUploadFail\", [e._idd, (c ? c.extra : null )])\r\n            }\r\n            c = a = null ;\r\n            window.setTimeout(function() {\r\n                e.childNodes[e._ll ? 1 : 0].childNodes[0].lastChild.className = \"dhxform_image_wrap\";\r\n                e._is_uploading = false\r\n            }, 50)\r\n        }\r\n    },\r\n    adjustImage: function(g) {\r\n        var c = g.childNodes[g._ll ? 1 : 0].childNodes[0].firstChild;\r\n        var a = Math.min(g._dim.mw, g._dim.w);\r\n        var e = Math.min(g._dim.mh, g._dim.h);\r\n        c.style.width = a + \"px\";\r\n        c.style.height = e + \"px\";\r\n        c.style.marginLeft = Math.max(0, Math.round(g._dim.mw / 2 - a / 2)) + \"px\";\r\n        c.style.marginTop = Math.max(0, Math.round(g._dim.mh / 2 - e / 2)) + \"px\";\r\n        c = g = null \r\n    }\r\n};\r\n(function() {\r\n    for (var c in dhtmlXForm.prototype.items.input) {\r\n        if (!dhtmlXForm.prototype.items.image[c]) {\r\n            dhtmlXForm.prototype.items.image[c] = dhtmlXForm.prototype.items.input[c]\r\n        }\r\n    }\r\n})();\r\ndhtmlXForm.prototype.items.image.d2 = dhtmlXForm.prototype.items.input.destruct;\r\ndhtmlXForm.prototype.setFormData_image = function(a, c) {\r\n    this.setItemValue(a, c)\r\n}\r\n;\r\ndhtmlXForm.prototype.getFormData_image = function(a) {\r\n    return this.getItemValue(a)\r\n}\r\n;\r\ndhtmlXForm.prototype.items.upload = {\r\n    render: function(c, e) {\r\n        c._type = \"up\";\r\n        c._enabled = true;\r\n        c._checked = true;\r\n        c.className = e.position + (typeof (e.className) == \"string\" ? \" \" + e.className : \"\");\r\n        var a = document.createElement(\"DIV\");\r\n        c.appendChild(a);\r\n        if (!isNaN(e.inputLeft)) {\r\n            c.style.left = parseInt(e.inputLeft) + \"px\"\r\n        }\r\n        if (!isNaN(e.inputTop)) {\r\n            c.style.top = parseInt(e.inputTop) + \"px\"\r\n        }\r\n        if (e.inputWidth != \"auto\") {\r\n            if (!isNaN(e.inputWidth)) {\r\n                a.style.width = parseInt(e.inputWidth) + \"px\"\r\n            }\r\n        }\r\n        c._uploader = new dhtmlXFileUploader(a,e.swfPath || \"\",e.swfUrl || \"\",e.mode || null ,e.swfLogs,e.slXap || \"\",e.slUrl || \"\",e.slLogs || \"\",e.multiple);\r\n        c._uploader.setURL(e.url || \"\");\r\n        c._uploader.callEvent = c.callEvent;\r\n        if (typeof (e.autoStart) != \"undefined\") {\r\n            c._uploader.setAutoStart(e.autoStart)\r\n        }\r\n        if (typeof (e.autoRemove) != \"undefined\") {\r\n            c._uploader.setAutoRemove(e.autoRemove)\r\n        }\r\n        if (typeof (e.titleScreen) != \"undefined\") {\r\n            c._uploader.enableTitleScreen(e.titleScreen)\r\n        }\r\n        if (typeof (e.titleText) != \"undefined\") {\r\n            c._uploader.setTitleText(e.titleText)\r\n        }\r\n        if (e.hidden == true) {\r\n            this.hide(c)\r\n        }\r\n        if (e.disabled == true) {\r\n            this.userDisable(c)\r\n        }\r\n        if (!(e.inputHeight == \"auto\" || parseInt(e.inputHeight) == NaN)) {\r\n            c._uploader.p_files.style.height = parseInt(e.inputHeight) + \"px\"\r\n        }\r\n        return this\r\n    },\r\n    destruct: function(a) {\r\n        this.doUnloadNestedLists(a);\r\n        a._uploader.callEvent = function() {\r\n            return true\r\n        }\r\n        ;\r\n        a._uploader.unload();\r\n        a._uploader.callEvent = null ;\r\n        a._uploader = null ;\r\n        a._checked = null ;\r\n        a._enabled = null ;\r\n        a._idd = null ;\r\n        a._type = null ;\r\n        a.onselectstart = null ;\r\n        a._autoCheck = null ;\r\n        a.callEvent = null ;\r\n        a.checkEvent = null ;\r\n        a.getForm = null ;\r\n        while (a.childNodes.length > 0) {\r\n            a.removeChild(a.childNodes[0])\r\n        }\r\n        a.parentNode.removeChild(a);\r\n        a = null \r\n    },\r\n    setText: function(a, c) {},\r\n    getText: function(a) {},\r\n    enable: function(a) {\r\n        a._enabled = true;\r\n        if (String(a.className).search(\"disabled\") >= 0) {\r\n            a.className = String(a.className).replace(/disabled/gi, \"\")\r\n        }\r\n        a._uploader.enable()\r\n    },\r\n    disable: function(a) {\r\n        a._enabled = false;\r\n        if (String(a.className).search(\"disabled\") < 0) {\r\n            a.className += \" disabled\"\r\n        }\r\n        a._uploader.disable()\r\n    },\r\n    setWidth: function(c, a) {\r\n        c.childNodes[0].style.width = a + \"px\";\r\n        c._width = a\r\n    },\r\n    getWidth: function(a) {\r\n        return a._width || parseInt(a.childNodes[0].style.width)\r\n    },\r\n    setValue: function(a) {\r\n        a._uploader.clear()\r\n    },\r\n    getValue: function(l) {\r\n        var g = l._uploader.getData();\r\n        var h = {};\r\n        var e = 0;\r\n        for (var c in g) {\r\n            h[l._idd + \"_r_\" + e] = g[c].realName;\r\n            h[l._idd + \"_s_\" + e] = g[c].serverName;\r\n            e++\r\n        }\r\n        h[l._idd + \"_count\"] = e;\r\n        return h\r\n    },\r\n    getUploader: function(a) {\r\n        return a._uploader\r\n    },\r\n    getStatus: function(a) {\r\n        return a._uploader.getStatus()\r\n    }\r\n};\r\n(function() {\r\n    for (var c in {\r\n        doUnloadNestedLists: 1,\r\n        isEnabled: 1\r\n    }) {\r\n        dhtmlXForm.prototype.items.upload[c] = dhtmlXForm.prototype.items.checkbox[c]\r\n    }\r\n})();\r\ndhtmlXForm.prototype.setFormData_upload = function(a) {\r\n    this.doWithItem(a, \"setValue\")\r\n}\r\n;\r\ndhtmlXForm.prototype.getUploader = function(a) {\r\n    return this.doWithItem(a, \"getUploader\")\r\n}\r\n;\r\ndhtmlXForm.prototype.getUploaderStatus = function(a) {\r\n    return this.doWithItem(a, \"getStatus\")\r\n}\r\n;\r\nfunction dhtmlXFileUploader(c, n, m, o, u, l, w, h, x) {\r\n    var r = this;\r\n    if (typeof (o) == \"string\" && typeof (this[o]) == \"function\") {\r\n        this.engine = o\r\n    } else {\r\n        this.engine = \"html4\";\r\n        var g = null ;\r\n        if (typeof (window.FormData) != \"undefined\" && typeof (window.XMLHttpRequest) != \"undefined\") {\r\n            g = new XMLHttpRequest();\r\n            if (typeof (g.upload) == \"undefined\") {\r\n                g = null \r\n            }\r\n        }\r\n        if (g != null ) {\r\n            this.engine = \"html5\"\r\n        } else {\r\n            if (typeof (window.swfobject) != \"undefined\" || g === false) {\r\n                var g = swfobject.getFlashPlayerVersion();\r\n                if (g.major >= 10) {\r\n                    this.engine = \"flash\"\r\n                }\r\n            } else {\r\n                this._sl_v = this.getSLVersion();\r\n                if (this._sl_v) {\r\n                    this.engine = \"sl\"\r\n                }\r\n            }\r\n        }\r\n        g = null \r\n    }\r\n    if (typeof (c) == \"string\") {\r\n        c = document.getElementById(c)\r\n    }\r\n    this._upload_mp = (typeof (x) != \"undefined\" ? x == true : true);\r\n    this._upload_dnd = true;\r\n    this._swf_file_url = n || \"\";\r\n    this._swf_upolad_url = m || \"\";\r\n    this._swf_logs = u;\r\n    this._sl_xap = l;\r\n    this._sl_upload_url = w;\r\n    this._sl_logs = h;\r\n    this.p = document.createElement(\"DIV\");\r\n    this.p.className += \" dhx_file_uploader\";\r\n    c.appendChild(this.p);\r\n    this.p_files = document.createElement(\"DIV\");\r\n    this.p_files.className = \"dhx_upload_files\";\r\n    this.p.appendChild(this.p_files);\r\n    this.p_controls = document.createElement(\"DIV\");\r\n    this.p_controls.className = \"dhx_upload_controls\";\r\n    this.p.appendChild(this.p_controls);\r\n    this._files = {};\r\n    this._items = {};\r\n    this._data = {};\r\n    this._autoStart = false;\r\n    this._autoRemove = false;\r\n    this._titleScreen = true;\r\n    this._enabled = true;\r\n    this._uploaded_count = 0;\r\n    this._initToolbar = function() {\r\n        this.b_opts = {\r\n            info: {\r\n                onclick: null \r\n            },\r\n            browse: {\r\n                onclick: null ,\r\n                tooltip: \"Browse\"\r\n            },\r\n            upload: {\r\n                onclick: function() {\r\n                    if (!r._enabled) {\r\n                        return\r\n                    }\r\n                    if (!r._uploading) {\r\n                        r._uploadStart()\r\n                    }\r\n                },\r\n                tooltip: \"Upload\"\r\n            },\r\n            cancel: {\r\n                onclick: function() {\r\n                    if (!r._enabled) {\r\n                        return\r\n                    }\r\n                    r._uploadStop();\r\n                    r._switchButton(false)\r\n                },\r\n                tooltip: \"Stop\"\r\n            },\r\n            clear: {\r\n                onclick: function() {\r\n                    if (!r._enabled) {\r\n                        return\r\n                    }\r\n                    r.clear()\r\n                },\r\n                tooltip: \"Clear list\"\r\n            }\r\n        };\r\n        this.buttons = {};\r\n        for (var e in this.b_opts) {\r\n            var y = document.createElement(\"DIV\");\r\n            y.innerHTML = \"&nbsp;\";\r\n            y.className = \"dhx_file_uploader_button button_\" + e;\r\n            y.onclick = this.b_opts[e].onclick;\r\n            if (this.b_opts[e].tooltip) {\r\n                y.title = this.b_opts[e].tooltip\r\n            }\r\n            this.p_controls.appendChild(y);\r\n            this.buttons[e] = y;\r\n            y = null \r\n        }\r\n        this.buttons.cancel.style.display = \"none\"\r\n    }\r\n    ;\r\n    this._readableSize = function(y) {\r\n        var e = false;\r\n        var a = [\"b\", \"Kb\", \"Mb\", \"Gb\", \"Tb\", \"Pb\", \"Eb\"];\r\n        for (var A = 0; A < a.length; A++) {\r\n            if (y > 1024) {\r\n                y = y / 1024\r\n            } else {\r\n                if (e === false) {\r\n                    e = A\r\n                }\r\n            }\r\n        }\r\n        if (e === false) {\r\n            e = a.length - 1\r\n        }\r\n        return Math.round(y * 100) / 100 + \" \" + a[e]\r\n    }\r\n    ;\r\n    this._beforeAddFileToList = function(a, e) {\r\n        return ( this.callEvent(\"onBeforeFileAdd\", [a, e]) === true) \r\n    }\r\n    ;\r\n    this._addFileToList = function(D, e, A, C, a) {\r\n        this._checkTitleScreen();\r\n        var y = document.createElement(\"DIV\");\r\n        y._idd = D;\r\n        y.className = \"dhx_file dhx_file_\" + C;\r\n        y.innerHTML = \"<div class='dhx_file_param dhx_file_name'>&nbsp;</div><div class='dhx_file_param dhx_file_progress'>\" + a + \"%</div><div class='dhx_file_param dhx_file_delete' title='Remove from list'>&nbsp;</div>\";\r\n        this.p_files.appendChild(y);\r\n        y.childNodes[0].style.width = y.offsetWidth - 127 + \"px\";\r\n        this._items[D] = y;\r\n        this._updateFileNameSize(D);\r\n        y.childNodes[2].onclick = function() {\r\n            if (!r._enabled) {\r\n                return\r\n            }\r\n            var E = this.parentNode._idd;\r\n            r._removeFileFromQueue(E)\r\n        }\r\n        ;\r\n        this.callEvent(\"onFileAdd\", [e])\r\n    }\r\n    ;\r\n    this._removeFileFromList = function(a) {\r\n        if (!this._items[a]) {\r\n            return\r\n        }\r\n        this._items[a].childNodes[2].onclick = null ;\r\n        this._items[a].parentNode.removeChild(this._items[a]);\r\n        this._items[a] = null ;\r\n        delete this._items[a];\r\n        if (this._data[a]) {\r\n            this._data[a] = null ;\r\n            delete this._data[a]\r\n        }\r\n        this._checkTitleScreen()\r\n    }\r\n    ;\r\n    this._updateFileNameSize = function(a) {\r\n        this._items[a].childNodes[0].innerHTML = this._files[a].name + (!isNaN(this._files[a].size) ? \" (\" + this._readableSize(this._files[a].size) + \")\" : \"&nbsp;\");\r\n        this._items[a].childNodes[0].title = this._files[a].name + (!isNaN(this._files[a].size) ? \" (\" + this._readableSize(this._files[a].size) + \")\" : \"\")\r\n    }\r\n    ;\r\n    this._updateFileInList = function(y, e, a) {\r\n        if (!this._items[y]) {\r\n            return\r\n        }\r\n        this._items[y].className = \"dhx_file dhx_file_\" + e;\r\n        this._updateProgress(y, e, a);\r\n        this._updateFileNameSize(y)\r\n    }\r\n    ;\r\n    this._updateProgress = function(y, e, a) {\r\n        if (e == \"uploading\" && a < 100 && this._progress_type == \"loader\") {\r\n            this._items[y].childNodes[1].className = \"dhx_file_param dhx_file_uploading\";\r\n            this._items[y].childNodes[1].innerHTML = \"&nbsp;\"\r\n        } else {\r\n            this._items[y].childNodes[1].className = \"dhx_file_param dhx_file_progress\";\r\n            this._items[y].childNodes[1].innerHTML = a + \"%\"\r\n        }\r\n        this._updateFileNameSize(y)\r\n    }\r\n    ;\r\n    this._removeFilesByState = function(y) {\r\n        for (var e in this._files) {\r\n            if (y === true || this._files[e].state == y) {\r\n                this._removeFileFromQueue(e)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._switchButton = function(e) {\r\n        if (e == true) {\r\n            this.buttons.upload.style.display = \"none\";\r\n            this.buttons.cancel.style.display = \"\"\r\n        } else {\r\n            var a = this._uploaded_count;\r\n            this.buttons.upload.style.display = \"\";\r\n            this.buttons.cancel.style.display = \"none\";\r\n            this._uploaded_count = 0;\r\n            if (a > 0) {\r\n                this.callEvent(\"onUploadComplete\", [a])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._uploadStart = function() {\r\n        this._switchButton(true);\r\n        if (!this._uploading) {\r\n            for (var e in this._files) {\r\n                if (this._files[e].state == \"fail\") {\r\n                    this._files[e].state = \"added\";\r\n                    this._updateFileInList(e, \"added\", 0)\r\n                }\r\n            }\r\n        }\r\n        this._uploading = true;\r\n        var y = false;\r\n        for (var e in this._files) {\r\n            if (!y && [this._files[e].state] == \"added\") {\r\n                y = true;\r\n                this._files[e].state = \"uploading\";\r\n                this._updateFileInList(e, \"uploading\", 0);\r\n                this._doUploadFile(e)\r\n            }\r\n        }\r\n        if (!y) {\r\n            this._uploading = false;\r\n            this._switchButton(false)\r\n        }\r\n    }\r\n    ;\r\n    this._onUploadSuccess = function(C, A, y, a) {\r\n        if (typeof (y) != \"undefined\" && this.engine == \"flash\") {\r\n            var e = dhx4.s2j(y.data);\r\n            if (e != null  && e.state == true && e.name != null ) {\r\n                A = e.name;\r\n                if (e.extra != null ) {\r\n                    a = e.extra\r\n                }\r\n            } else {\r\n                this._onUploadFail(C, (e != null  && e.extra != null  ? e.extra : null ));\r\n                return\r\n            }\r\n        }\r\n        this._uploaded_count++;\r\n        this._data[C] = {\r\n            realName: this._files[C].name,\r\n            serverName: A\r\n        };\r\n        this._files[C].state = \"uploaded\";\r\n        this._updateFileInList(C, \"uploaded\", 100);\r\n        this.callEvent(\"onUploadFile\", [this._files[C].name, A, a]);\r\n        if (this._autoRemove) {\r\n            this._removeFileFromQueue(C)\r\n        }\r\n        if (this._uploading) {\r\n            this._uploadStart()\r\n        }\r\n    }\r\n    ;\r\n    this._onUploadFail = function(e, a) {\r\n        this._files[e].state = \"fail\";\r\n        this._updateFileInList(e, \"fail\", 0);\r\n        this.callEvent(\"onUploadFail\", [this._files[e].name, a]);\r\n        if (this._uploading) {\r\n            this._uploadStart()\r\n        }\r\n    }\r\n    ;\r\n    this._onUploadAbort = function(a) {\r\n        this._uploading = false;\r\n        this._files[a].state = \"added\";\r\n        this._updateFileInList(a, \"added\", 0);\r\n        this.callEvent(\"onUploadCancel\", [this._files[a].name])\r\n    }\r\n    ;\r\n    this._checkTitleScreen = function() {\r\n        var y = 0;\r\n        for (var e in this._files) {\r\n            y++\r\n        }\r\n        if (y == 0 && this.p.className.search(\"dhx_file_uploader_title\") < 0 && this._titleScreen) {\r\n            this.p.className += \" dhx_file_uploader_title\";\r\n            this.buttons.info.innerHTML = this._titleText;\r\n            this.buttons.info.style.width = Math.max(this.p_controls.offsetWidth - 134, 0) + \"px\"\r\n        }\r\n        if ((y > 0 || !this._titleScreen) && this.p.className.search(\"dhx_file_uploader_title\") >= 0) {\r\n            this.p.className = this.p.className.replace(/dhx_file_uploader_title/g, \"\");\r\n            this.buttons.info.innerHTML = \"\"\r\n        }\r\n    }\r\n    ;\r\n    this.callEvent = function() {}\r\n    ;\r\n    this.upload = function() {\r\n        if (!this._uploading) {\r\n            this._uploadStart()\r\n        }\r\n    }\r\n    ;\r\n    this.setAutoStart = function(a) {\r\n        this._autoStart = (a == true)\r\n    }\r\n    ;\r\n    this.setAutoRemove = function(a) {\r\n        this._autoRemove = (a == true)\r\n    }\r\n    ;\r\n    this.enableTitleScreen = function(a) {\r\n        this._titleScreen = (a == true);\r\n        this._checkTitleScreen()\r\n    }\r\n    ;\r\n    this.setTitleText = function(a) {\r\n        this._titleText = a;\r\n        if (this.p.className.search(\"dhx_file_uploader_title\") >= 0) {\r\n            this.buttons.info.innerHTML = this._titleText\r\n        }\r\n    }\r\n    ;\r\n    this.setURL = function(a) {\r\n        this._url = a\r\n    }\r\n    ;\r\n    this.setSWFURL = function(a) {\r\n        this._swf_upolad_url = a\r\n    }\r\n    ;\r\n    this.enable = function() {\r\n        this._enabled = true;\r\n        this.p_files.className = \"dhx_upload_files\";\r\n        this.p_controls.className = \"dhx_upload_controls\"\r\n    }\r\n    ;\r\n    this.disable = function() {\r\n        this._enabled = false;\r\n        this.p_files.className = \"dhx_upload_files dhx_uploader_dis\";\r\n        this.p_controls.className = \"dhx_upload_controls dhx_uploader_dis\"\r\n    }\r\n    ;\r\n    this.getStatus = function() {\r\n        var y = 0;\r\n        for (var e in this._files) {\r\n            if (this._files[e].state != \"uploaded\") {\r\n                return -1\r\n            }\r\n            y = 1\r\n        }\r\n        return y\r\n    }\r\n    ;\r\n    this.getData = function() {\r\n        return this._data\r\n    }\r\n    ;\r\n    this.clear = function() {\r\n        if (this.callEvent(\"onBeforeClear\", []) !== true) {\r\n            return\r\n        }\r\n        if (this._uploading) {\r\n            r._uploadStop()\r\n        }\r\n        r._switchButton(false);\r\n        r._removeFilesByState(true);\r\n        this.callEvent(\"onClear\", [])\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this._removeFilesByState(true);\r\n        this._data = null ;\r\n        this._files = null ;\r\n        this._items = null ;\r\n        this._unloadEngine();\r\n        for (var e in this.buttons) {\r\n            this.buttons[e].onclick = null ;\r\n            this.buttons[e].parentNode.removeChild(this.buttons[e]);\r\n            this.buttons[e] = null ;\r\n            delete this.buttons[e]\r\n        }\r\n        this.buttons = null ;\r\n        for (var e in this.b_opts) {\r\n            this.b_opts[e].onclick = null ;\r\n            this.b_opts[e] = null ;\r\n            delete this.b_opts[e]\r\n        }\r\n        this.b_opts = null ;\r\n        this.p_controls.parentNode.removeChild(this.p_controls);\r\n        this.p_files.parentNode.removeChild(this.p_files);\r\n        this.p.className = this.p.className.replace(/dhx_file_uploader_title/gi, \"\").replace(/dhx_file_uploader/gi, \"\");\r\n        for (var e in this) {\r\n            this[e] = null \r\n        }\r\n        r = e = null \r\n    }\r\n    ;\r\n    var s = new this[this.engine]();\r\n    for (var v in s) {\r\n        this[v] = s[v];\r\n        s[v] = null \r\n    }\r\n    v = s = c = null ;\r\n    this._initToolbar();\r\n    this._initEngine();\r\n    this._checkTitleScreen();\r\n    this._sendParams = {};\r\n    this.setSendParams = function(a, e) {\r\n        this._sendParams[a] = e\r\n    }\r\n    ;\r\n    this._doCompress = false;\r\n    this._imageQuality = 1;\r\n    this._imageMaxWidth = 0;\r\n    this._imageMaxHeight = 0;\r\n    this.setDoCompress = function(a) {\r\n        this._doCompress = (a == true)\r\n    }\r\n    ;\r\n    this.setImageQuality = function(a) {\r\n        if (isNaN(a)) {\r\n            return\r\n        }\r\n        if (0 > a || 1 < a) {\r\n            return\r\n        }\r\n        this._imageQuality = a\r\n    }\r\n    ;\r\n    this.setImageMaxWidth = function(a) {\r\n        if (isNaN(a)) {\r\n            return\r\n        }\r\n        this._imageMaxWidth = a\r\n    }\r\n    ;\r\n    this.setImageMaxHeight = function(a) {\r\n        if (isNaN(a)) {\r\n            return\r\n        }\r\n        this._imageMaxHeight = a\r\n    }\r\n    ;\r\n    return this\r\n}\r\ndhtmlXFileUploader.prototype.html5 = function() {}\r\n;\r\ndhtmlXFileUploader.prototype.html5.prototype = {\r\n    _initEngine: function() {\r\n        var c = this;\r\n        this.buttons.browse.onclick = function() {\r\n            if (c._enabled) {\r\n                c.f.click()\r\n            }\r\n        }\r\n        ;\r\n        this._progress_type = \"percentage\";\r\n        var a = window.navigator.userAgent;\r\n        if (a.match(/Windows/gi) != null  && a.match(/AppleWebKit/gi) != null  && a.match(/Safari/gi) != null ) {\r\n            if (a.match(/Version\\/5\\.1\\.5/gi)) {\r\n                this._upload_mp = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1[^\\.\\d{1,}]/gi)) {\r\n                this._upload_dnd = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1\\.1/gi)) {\r\n                this._upload_mp = false;\r\n                this._upload_dnd = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1\\.2/gi)) {\r\n                this._upload_dnd = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1\\.7/gi)) {\r\n                this._upload_mp = false\r\n            }\r\n        }\r\n        this._addFileInput();\r\n        if (this._upload_dnd) {\r\n            this.p.ondragenter = function(g) {\r\n                if (!g.dataTransfer) {\r\n                    return\r\n                }\r\n                g.stopPropagation();\r\n                g.preventDefault()\r\n            }\r\n            ;\r\n            this.p.ondragover = function(g) {\r\n                if (!g.dataTransfer) {\r\n                    return\r\n                }\r\n                g.stopPropagation();\r\n                g.preventDefault()\r\n            }\r\n            ;\r\n            this.p.ondrop = function(g) {\r\n                if (!g.dataTransfer) {\r\n                    return\r\n                }\r\n                g.stopPropagation();\r\n                g.preventDefault();\r\n                if (c._enabled) {\r\n                    c._parseFilesInInput(g.dataTransfer.files)\r\n                }\r\n            }\r\n            ;\r\n            this._titleText = \"Drag-n-Drop files here or<br>click to select files for upload.\"\r\n        } else {\r\n            this._titleText = \"Click to select files for upload.\"\r\n        }\r\n    },\r\n    _addFileInput: function() {\r\n        if (this.f != null ) {\r\n            this.f.onchange = null ;\r\n            this.f.parentNode.removeChild(this.f);\r\n            this.f = null \r\n        }\r\n        var a = this;\r\n        this.f = document.createElement(\"INPUT\");\r\n        this.f.type = \"file\";\r\n        if (this._upload_mp) {\r\n            this.f.multiple = \"1\"\r\n        }\r\n        this.f.className = \"dhx_uploader_input\";\r\n        this.p_controls.appendChild(this.f);\r\n        this.f.onchange = function() {\r\n            a._parseFilesInInput(this.files);\r\n            if (window.dhx4.isOpera) {\r\n                a._addFileInput()\r\n            } else {\r\n                this.value = \"\"\r\n            }\r\n        }\r\n    },\r\n    _doUploadFile: function(e) {\r\n        var s = this;\r\n        if (!this._loader) {\r\n            this._loader = new XMLHttpRequest();\r\n            this._loader.upload.onprogress = function(w) {\r\n                if (s._files[this._idd].state == \"uploading\") {\r\n                    s._updateFileInList(this._idd, \"uploading\", Math.round(w.loaded * 100 / w.total))\r\n                }\r\n            }\r\n            ;\r\n            this._loader.onload = function(x) {\r\n                var w = dhx4.s2j(this.responseText);\r\n                if (typeof (w) == \"object\" && w != null  && typeof (w.state) != \"undefined\" && w.state == true) {\r\n                    s._onUploadSuccess(this.upload._idd, w.name, null , w.extra);\r\n                    w = null \r\n                } else {\r\n                    s._onUploadFail(this.upload._idd, (w != null  && w.extra != null  ? w.extra : null ))\r\n                }\r\n            }\r\n            ;\r\n            this._loader.onerror = function(w) {\r\n                s._onUploadFail(this.upload._idd)\r\n            }\r\n            ;\r\n            this._loader.onabort = function(w) {\r\n                s._onUploadAbort(this.upload._idd)\r\n            }\r\n        }\r\n        this._loader.upload._idd = e;\r\n        var g = new FormData();\r\n        for (var v in this._sendParams) {\r\n            console.log(\"��?信パラメータ:\" + v, this._sendParams[v]);\r\n            g.append(v, this._sendParams[v])\r\n        }\r\n        var h = \"\";\r\n        var o = String(this._files[e].file.name).match(/(.*)(?:\\.([^.]+$))/);\r\n        if (o != null ) {\r\n            h = o[2]\r\n        }\r\n        if ((_.indexOf([\"bmp\", \"gif\", \"jpeg\", \"jpg\", \"png\"], h.toLowerCase()) >= 0) && this._doCompress) {\r\n            var r = new FileReader();\r\n            r.onload = function(y) {\r\n                var w = y.target.result;\r\n                var x = new Image();\r\n                x.onload = function() {\r\n                    var X = this.naturalWidth;\r\n                    var U = this.naturalHeight;\r\n                    var F = this.naturalWidth;\r\n                    var O = this.naturalHeight;\r\n                    var V = F;\r\n                    var T = O;\r\n                    var D;\r\n                    if (s._imageMaxWidth > 0) {\r\n                        X = s._imageMaxWidth\r\n                    }\r\n                    if (s._imageMaxHeight > 0) {\r\n                        U = s._imageMaxHeight\r\n                    }\r\n                    if (w.split(\",\")[0].match(\"jpeg\")) {\r\n                        D = m(w)\r\n                    }\r\n                    D = D || 1;\r\n                    if (D > 4) {\r\n                        var P = X;\r\n                        X = U;\r\n                        U = P\r\n                    }\r\n                    if (V > X || T > U) {\r\n                        var K = V / X;\r\n                        if (K <= T / U) {\r\n                            K = T / U\r\n                        }\r\n                        V = Math.floor(this.width / K);\r\n                        T = Math.floor(this.height / K)\r\n                    }\r\n                    var I = $(\"<canvas>\");\r\n                    var H = I[0].getContext(\"2d\");\r\n                    H.save();\r\n                    u(I, V, T, D);\r\n                    if (c(this)) {\r\n                        F /= 2;\r\n                        O /= 2\r\n                    }\r\n                    var Z = 1024;\r\n                    var C = $(\"<canvas>\");\r\n                    C[0].width = C[0].height = Z;\r\n                    var E = C[0].getContext(\"2d\");\r\n                    var W = l(this, F, O);\r\n                    var N = Math.ceil(Z * V / F);\r\n                    var Y = Math.ceil(Z * T / O / W);\r\n                    var Q = 0;\r\n                    var L = 0;\r\n                    while (Q < O) {\r\n                        var S = 0;\r\n                        var M = 0;\r\n                        while (S < F) {\r\n                            E.clearRect(0, 0, Z, Z);\r\n                            E.drawImage(this, -S, -Q);\r\n                            H.drawImage(C[0], 0, 0, Z, Z, M, L, N, Y);\r\n                            S += Z;\r\n                            M += N\r\n                        }\r\n                        Q += Z;\r\n                        L += Y\r\n                    }\r\n                    H.restore();\r\n                    C = E = null ;\r\n                    var J = I[0].toDataURL(\"image/jpeg\", s._imageQuality);\r\n                    var A = n(J);\r\n                    g.append(\"file\", A, o[1] + \".jpg\");\r\n                    s._loader.open(\"POST\", s._url + (String(s._url).indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"mode=html5&dhxr\" + new Date().getTime(), true);\r\n                    s._loader.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n                    s._loader.send(g)\r\n                }\r\n                ;\r\n                x.onerror = function() {\r\n                    console.log(\"画��?ファイル���?�込�?�エラー\", s._files[e].file);\r\n                    s._onUploadFail(e)\r\n                }\r\n                ;\r\n                x.src = w\r\n            }\r\n            ;\r\n            r.readAsDataURL(this._files[e].file)\r\n        } else {\r\n            g.append(\"file\", this._files[e].file);\r\n            this._loader.open(\"POST\", this._url + (String(this._url).indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"mode=html5\" + window.dhx4.ajax._dhxr(\"&\"), true);\r\n            this._loader.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n            this._loader.send(g)\r\n        }\r\n        function m(w) {\r\n            var A = atob(w.split(\",\")[1]);\r\n            var y = x(A);\r\n            return y;\r\n            function x(F) {\r\n                var J = 0;\r\n                var C;\r\n                while (1) {\r\n                    if (F.charCodeAt(J) == 255 & F.charCodeAt(J + 1) == 218) {\r\n                        break\r\n                    }\r\n                    if (F.charCodeAt(J) == 255 & F.charCodeAt(J + 1) == 216) {\r\n                        J += 2\r\n                    } else {\r\n                        var D = F.charCodeAt(J + 2) * 256 + F.charCodeAt(J + 3);\r\n                        var K = J + D + 2;\r\n                        if (F.charCodeAt(J) == 255 & F.charCodeAt(J + 1) == 225) {\r\n                            var H = F.slice(J, K);\r\n                            var E = H.charCodeAt(10) == 77;\r\n                            if (E) {\r\n                                var I = H.charCodeAt(18) * 256 + H.charCodeAt(19)\r\n                            } else {\r\n                                var I = H.charCodeAt(18) + H.charCodeAt(19) * 256\r\n                            }\r\n                            for (i = 0; i < I; i++) {\r\n                                var L = H.slice(20 + 12 * i, 32 + 12 * i);\r\n                                if ((E && L.charCodeAt(1) == 18) || (!E && L.charCodeAt(0) == 18)) {\r\n                                    C = E ? L.charCodeAt(9) : L.charCodeAt(8)\r\n                                }\r\n                            }\r\n                            break\r\n                        }\r\n                        J = K\r\n                    }\r\n                    if (J > F.length) {\r\n                        break\r\n                    }\r\n                }\r\n                return C\r\n            }\r\n        }\r\n        function c(y) {\r\n            var x = y.naturalWidth\r\n              , C = y.naturalHeight;\r\n            if (x * C > 1024 * 1024) {\r\n                var A = $(\"<canvas>\");\r\n                A[0].width = A[0].height = 1;\r\n                var w = A[0].getContext(\"2d\");\r\n                w.drawImage(y, -x + 1, 0);\r\n                return w.getImageData(0, 0, 1, 1).data[3] === 0\r\n            } else {\r\n                return false\r\n            }\r\n        }\r\n        function l(C, x, I) {\r\n            var w = $(\"<canvas>\");\r\n            w[0].width = 1;\r\n            w[0].height = I;\r\n            var J = w[0].getContext(\"2d\");\r\n            J.drawImage(C, 0, 0);\r\n            var A = J.getImageData(0, 0, 1, I).data;\r\n            var F = 0;\r\n            var D = I;\r\n            var H = I;\r\n            while (H > F) {\r\n                var y = A[(H - 1) * 4 + 3];\r\n                if (y === 0) {\r\n                    D = H\r\n                } else {\r\n                    F = H\r\n                }\r\n                H = (D + F) >> 1\r\n            }\r\n            var E = (H / I);\r\n            return (E === 0) ? 1 : E\r\n        }\r\n        function u(A, C, w, y) {\r\n            if (y > 4) {\r\n                A[0].width = w;\r\n                A[0].height = C\r\n            } else {\r\n                A[0].width = C;\r\n                A[0].height = w\r\n            }\r\n            var x = A[0].getContext(\"2d\");\r\n            switch (y) {\r\n            case 2:\r\n                x.translate(C, 0);\r\n                x.scale(-1, 1);\r\n                break;\r\n            case 3:\r\n                x.translate(C, w);\r\n                x.rotate(Math.PI);\r\n                break;\r\n            case 4:\r\n                x.translate(0, w);\r\n                x.scale(1, -1);\r\n                break;\r\n            case 5:\r\n                x.rotate(0.5 * Math.PI);\r\n                x.scale(1, -1);\r\n                break;\r\n            case 6:\r\n                x.rotate(0.5 * Math.PI);\r\n                x.translate(0, -w);\r\n                break;\r\n            case 7:\r\n                x.rotate(0.5 * Math.PI);\r\n                x.translate(C, -w);\r\n                x.scale(-1, 1);\r\n                break;\r\n            case 8:\r\n                x.rotate(-0.5 * Math.PI);\r\n                x.translate(-C, 0);\r\n                break;\r\n            default:\r\n                break\r\n            }\r\n        }\r\n        function a(A) {\r\n            var C = atob(A.split(\",\")[1]);\r\n            var y = new ArrayBuffer(C.length);\r\n            var w = new Uint8Array(y);\r\n            for (var x = 0; x < C.length; x++) {\r\n                w[x] = C.charCodeAt(x)\r\n            }\r\n            return y\r\n        }\r\n        function n(y) {\r\n            var w = y.split(\",\")[0].split(\":\")[1].split(\";\")[0];\r\n            var x = a(y);\r\n            var A = (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder);\r\n            if (A) {\r\n                A = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder)();\r\n                A.append(x);\r\n                return A.getBlob(w)\r\n            } else {\r\n                A = new Blob([x],{\r\n                    type: (w)\r\n                });\r\n                return A\r\n            }\r\n        }\r\n    },\r\n    _uploadStop: function() {\r\n        if (!this._uploading || !this._loader) {\r\n            return\r\n        }\r\n        this._loader.abort()\r\n    },\r\n    _parseFilesInInput: function(c) {\r\n        for (var a = 0; a < c.length; a++) {\r\n            this._addFileToQueue(c[a])\r\n        }\r\n    },\r\n    _addFileToQueue: function(a) {\r\n        if (!this._beforeAddFileToList(a.name, a.size)) {\r\n            return\r\n        }\r\n        var c = (a._idd || window.dhx4.newId());\r\n        this._files[c] = {\r\n            file: a,\r\n            name: a.name,\r\n            size: a.size,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(c, a.name, a.size, \"added\", 0);\r\n        if (this._autoStart && !this._uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(g) {\r\n        if (!this._files[g]) {\r\n            return\r\n        }\r\n        var c = this._files[g].name;\r\n        var e = (this._data != null  && this._data[g] != null  ? this._data[g].serverName : null );\r\n        if (this.callEvent(\"onBeforeFileRemove\", [c, e]) !== true) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this._uploading && g == this._loader.upload._idd && this._files[g].state == \"uploading\") {\r\n            this._uploadStop();\r\n            a = true\r\n        }\r\n        this._files[g].file = null ;\r\n        this._files[g].name = null ;\r\n        this._files[g].size = null ;\r\n        this._files[g].state = null ;\r\n        this._files[g] = null ;\r\n        delete this._files[g];\r\n        this._removeFileFromList(g);\r\n        this.callEvent(\"onFileRemove\", [c, e]);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _unloadEngine: function() {\r\n        this.buttons.browse.onclick = null ;\r\n        this.f.onchange = null ;\r\n        this.f.parentNode.removeChild(this.f);\r\n        this.f = null ;\r\n        this.p.ondragenter = null ;\r\n        this.p.ondragover = null ;\r\n        this.p.ondrop = null ;\r\n        if (this._loader) {\r\n            this._loader.upload.onprogress = null ;\r\n            this._loader.onload = null ;\r\n            this._loader.onerror = null ;\r\n            this._loader.onabort = null ;\r\n            this._loader.upload._idd = null ;\r\n            this._loader = null \r\n        }\r\n        this._initEngine = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._parseFilesInInput = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXFileUploader.prototype.html4 = function() {}\r\n;\r\ndhtmlXFileUploader.prototype.html4.prototype = {\r\n    _initEngine: function() {\r\n        this._addForm();\r\n        this._progress_type = \"loader\";\r\n        this._titleText = \"Click button<br>to select files for upload.\"\r\n    },\r\n    _addForm: function() {\r\n        var a = this;\r\n        var e = window.dhx4.newId();\r\n        if (!this.k) {\r\n            this.k = document.createElement(\"DIV\");\r\n            this.k.className = \"dhx_file_form_cont\";\r\n            this.buttons.browse.appendChild(this.k);\r\n            this.fr_name = \"dhx_file_\" + window.dhx4.newId();\r\n            this.k.innerHTML = '<iframe name=\"' + this.fr_name + '\" style=\"height:0px;width:0px;\" frameBorder=\"0\"></iframe>';\r\n            this.fr = this.k.firstChild;\r\n            if (window.navigator.userAgent.indexOf(\"MSIE\") >= 0) {\r\n                this.fr.onreadystatechange = function() {\r\n                    if (this.readyState == \"complete\") {\r\n                        a._onLoad()\r\n                    }\r\n                }\r\n            } else {\r\n                this.fr.onload = function() {\r\n                    a._onLoad()\r\n                }\r\n            }\r\n        }\r\n        var c = document.createElement(\"DIV\");\r\n        c.innerHTML = \"<form method='POST' enctype='multipart/form-data' target='\" + this.fr_name + \"' class='dhx_file_form' name='dhx_file_form_\" + window.dhx4.newId() + \"'><input type='hidden' name='mode' value='html4'><input type='hidden' name='uid' value='\" + e + \"'><input type='file' name='file' class='dhx_file_input'></form>\";\r\n        this.k.appendChild(c);\r\n        c.firstChild.lastChild._idd = e;\r\n        c.firstChild.lastChild.onchange = function() {\r\n            if (!a._beforeAddFileToList(this.value, null )) {\r\n                return\r\n            }\r\n            a._addFileToQueue(this);\r\n            this.onchange = null ;\r\n            this.parentNode.parentNode.style.display = \"none\";\r\n            a._addForm()\r\n        }\r\n        ;\r\n        c = null \r\n    },\r\n    _onLoad: function() {\r\n        if (this._uploading) {\r\n            var a = dhx4.s2j(this.fr.contentWindow.document.body.innerHTML);\r\n            if (typeof (a) == \"object\" && a != null ) {\r\n                if (typeof (a.state) != \"undefined\") {\r\n                    if (a.state == \"cancelled\") {\r\n                        this._onUploadAbort(this.fr._idd);\r\n                        a = null ;\r\n                        return\r\n                    } else {\r\n                        if (a.state == true) {\r\n                            if (typeof (a.size) != \"undefined\" && !isNaN(a.size)) {\r\n                                this._files[this.fr._idd].size = a.size\r\n                            }\r\n                            this._onUploadSuccess(this.fr._idd, a.name, null , a.extra);\r\n                            a = null ;\r\n                            return\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._onUploadFail(this.fr._idd, (a != null  && a.extra != null  ? a.extra : null ))\r\n        }\r\n    },\r\n    _addFileToQueue: function(c) {\r\n        var a = c.value.match(/[^\\\\\\/]*$/g);\r\n        if (a[0] != null ) {\r\n            a = a[0]\r\n        } else {\r\n            a = c.value\r\n        }\r\n        this._files[c._idd] = {\r\n            name: a,\r\n            form: c.parentNode,\r\n            node: c.parentNode.parentNode,\r\n            input: c,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(c._idd, c.value, false, \"added\", 0);\r\n        if (this._autoStart && !this._uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(e) {\r\n        var a = this._files[e].name;\r\n        var c = (this._data != null  && this._data[e] != null  ? this._data[e].serverName : null );\r\n        if (this.callEvent(\"onBeforeFileRemove\", [a, c]) !== true) {\r\n            return\r\n        }\r\n        this._files[e].input.onchange = null ;\r\n        this._files[e].form.removeChild(this._files[e].input);\r\n        this._files[e].node.removeChild(this._files[e].form);\r\n        this._files[e].node.parentNode.removeChild(this._files[e].node);\r\n        this._files[e].input = null ;\r\n        this._files[e].name = null ;\r\n        this._files[e].form = null ;\r\n        this._files[e].node = null ;\r\n        this._files[e].size = null ;\r\n        this._files[e].state = null ;\r\n        this._files[e] = null ;\r\n        delete this._files[e];\r\n        this._removeFileFromList(e);\r\n        this.callEvent(\"onFileRemove\", [a, c])\r\n    },\r\n    _doUploadFile: function(a) {\r\n        this.fr._idd = a;\r\n        this._files[a].form.action = this._url;\r\n        this._files[a].form.submit()\r\n    },\r\n    _uploadStop: function() {\r\n        if (!this._uploading) {\r\n            return\r\n        }\r\n        this.fr.contentWindow.location.href = (this._url) + (this._url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"mode=html4&action=cancel\" + window.dhx4.ajax._dhxr(\"&\")\r\n    },\r\n    _unloadEngine: function() {\r\n        if (this.k) {\r\n            this.fr_name = null ;\r\n            this.fr.onreadystatechange = null ;\r\n            this.fr.onload = null ;\r\n            this.fr.parentNode.removeChild(this.fr);\r\n            this.fr = null ;\r\n            this.k.firstChild.firstChild.lastChild.onchange = null ;\r\n            this.k.parentNode.removeChild(this.k);\r\n            this.k = null \r\n        }\r\n        this._initEngine = null ;\r\n        this._addForm = null ;\r\n        this._onLoad = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXFileUploader.prototype.flash = function() {}\r\n;\r\ndhtmlXFileUploader.prototype.flash.prototype = {\r\n    _initEngine: function() {\r\n        if (window.dhtmlXSWFObjectsPull == null ) {\r\n            window.dhtmlXSWFObjectsPull = {\r\n                items: {},\r\n                callEvent: function(h, e, g) {\r\n                    return window.dhtmlXSWFObjectsPull.items[h].uploader[e].apply(window.dhtmlXSWFObjectsPull.items[h].uploader, g)\r\n                }\r\n            }\r\n        }\r\n        var c = this;\r\n        this._swf_obj_id = \"dhtmlXFileUploaderSWFObject_\" + window.dhx4.newId();\r\n        this._swf_file_url = this._swf_file_url + window.dhx4.ajax._dhxr(this._swf_file_url);\r\n        this.buttons.browse.innerHTML = \"<div id='\" + this._swf_obj_id + \"' style='width:100%;height:100%;'></div>\";\r\n        swfobject.embedSWF(this._swf_file_url, this._swf_obj_id, \"100%\", \"100%\", \"9\", null , {\r\n            ID: this._swf_obj_id,\r\n            enableLogs: this._swf_logs\r\n        }, {\r\n            wmode: \"transparent\"\r\n        });\r\n        var a = swfobject.getFlashPlayerVersion();\r\n        this._titleText = \"Engine successfuly inited<br>Flash Player: \" + a.major + \".\" + a.minor + \".\" + a.release;\r\n        this._progress_type = \"percentage\";\r\n        window.dhtmlXSWFObjectsPull.items[this._swf_obj_id] = {\r\n            id: this._swf_obj_id,\r\n            uploader: this\r\n        }\r\n    },\r\n    _beforeAddFileToQueue: function(a, c) {\r\n        return ( this.callEvent(\"onBeforeFileAdd\", [a, c]) === true) \r\n    },\r\n    _addFileToQueue: function(g, c, e) {\r\n        if (window.dhx4.isIE) {\r\n            var a = document.createElement(\"INPUT\");\r\n            a.type = \"TEXT\";\r\n            a.style.position = \"absolute\";\r\n            a.style.left = \"0px\";\r\n            a.style.top = window.dhx4.absTop(this.buttons.browse) + \"px\";\r\n            a.style.width = \"10px\";\r\n            document.body.appendChild(a);\r\n            a.focus();\r\n            document.body.removeChild(a);\r\n            a = null \r\n        }\r\n        this._files[g] = {\r\n            name: c,\r\n            size: e,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(g, c, e, \"added\", 0);\r\n        if (this._autoStart && !this._uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(g) {\r\n        if (!this._files[g]) {\r\n            return\r\n        }\r\n        var c = this._files[g].name;\r\n        var e = (this._data != null  && this._data[g] != null  ? this._data[g].serverName : null );\r\n        if (this.callEvent(\"onBeforeFileRemove\", [c, e]) !== true) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this._uploading && this._files[g].state == \"uploading\") {\r\n            this._uploadStop();\r\n            a = true\r\n        }\r\n        swfobject.getObjectById(this._swf_obj_id).removeFileById(g);\r\n        this._files[g].name = null ;\r\n        this._files[g].size = null ;\r\n        this._files[g].state = null ;\r\n        this._files[g] = null ;\r\n        delete this._files[g];\r\n        this._removeFileFromList(g);\r\n        this.callEvent(\"onFileRemove\", [c, e]);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _doUploadFile: function(a) {\r\n        swfobject.getObjectById(this._swf_obj_id).upload(a, this._swf_upolad_url)\r\n    },\r\n    _uploadStop: function(e) {\r\n        for (var c in this._files) {\r\n            if (this._files[c].state == \"uploading\") {\r\n                swfobject.getObjectById(this._swf_obj_id).uploadStop(c)\r\n            }\r\n        }\r\n    },\r\n    _unloadEngine: function() {\r\n        if (window.dhtmlXSWFObjectsPull.items[this._swf_obj_id]) {\r\n            window.dhtmlXSWFObjectsPull.items[this._swf_obj_id].id = null ;\r\n            window.dhtmlXSWFObjectsPull.items[this._swf_obj_id].uploader = null ;\r\n            window.dhtmlXSWFObjectsPull.items[this._swf_obj_id] = null ;\r\n            delete window.dhtmlXSWFObjectsPull.items[this._swf_obj_id]\r\n        }\r\n        this._swf_obj_id = null ;\r\n        this._initEngine = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXFileUploader.prototype.sl = function() {}\r\n;\r\ndhtmlXFileUploader.prototype.sl.prototype = {\r\n    _initEngine: function() {\r\n        if (typeof (this._sl_v) == \"undefined\") {\r\n            this._sl_v = this.getSLVersion()\r\n        }\r\n        if (!window.dhtmlXFileUploaderSLObjects) {\r\n            window.dhtmlXFileUploaderSLObjects = {\r\n                items: {},\r\n                callEvent: function(e, a, c) {\r\n                    window.dhtmlXFileUploaderSLObjects.items[e].uploader[a].apply(window.dhtmlXFileUploaderSLObjects.items[e].uploader, c)\r\n                }\r\n            }\r\n        }\r\n        this._sl_obj_id = \"dhtmlXFileUploaderSLObject_\" + window.dhx4.newId();\r\n        if (this._sl_v != false) {\r\n            this._titleText = \"Engine successfuly inited<br>Silverlight version: \" + this._sl_v[0] + \".\" + this._sl_v[1];\r\n            this.buttons.browse.innerHTML = '<div style=\"width:100%;height:100%;\"><object data=\"data:application/x-silverlight-2,\" type=\"application/x-silverlight-2\" width=\"100%\" height=\"100%\" id=\"' + this._sl_obj_id + '\"><param name=\"source\" value=\"' + this._sl_xap + '\"/><param name=\"background\" value=\"Transparent\"/><param name=\"windowless\" value=\"true\"/><param name=\"initParams\" value=\"SLID=' + this._sl_obj_id + \",LOGS=\" + this._sl_logs + '\"/><param name=\"minRuntimeVersion\" value=\"5.0\"/></object></div>'\r\n        } else {\r\n            this._titleText = \"Silverlight plugin not found<br>or version less than 4.0\";\r\n            this.buttons.browse.style.cursor = \"wait\";\r\n            this.buttons.browse.title = \"\"\r\n        }\r\n        this._progress_type = \"percentage\";\r\n        window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id] = {\r\n            id: this._sl_obj_id,\r\n            uploader: this\r\n        }\r\n    },\r\n    _addFileToQueue: function(e, a, c) {\r\n        this._files[e] = {\r\n            name: a,\r\n            size: c,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(e, a, c, \"added\", 0);\r\n        if (this._autoStart && !this._uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(c) {\r\n        if (!this._files[c]) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this._uploading && this._files[c].state == \"uploading\") {\r\n            this._uploadStop();\r\n            a = true\r\n        }\r\n        document.getElementById([this._sl_obj_id]).Content.a.removeFileById(c);\r\n        this._files[c].name = null ;\r\n        this._files[c].size = null ;\r\n        this._files[c].state = null ;\r\n        this._files[c] = null ;\r\n        delete this._files[c];\r\n        this._removeFileFromList(c);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _doUploadFile: function(c) {\r\n        var a = this._sl_upload_url.split(\"?\");\r\n        a = (a[1] != null  ? \"&\" + a[1] : \"\");\r\n        document.getElementById(this._sl_obj_id).Content.a.upload(c, this._sl_upload_url, a + \"&mode=sl\" + window.dhx4.ajax._dhxr(\"&\"))\r\n    },\r\n    _uploadStop: function(e) {\r\n        this._uploading = false;\r\n        for (var c in this._files) {\r\n            if (this._files[c].state == \"uploading\") {\r\n                document.getElementById(this._sl_obj_id).Content.a.uploadStop(c)\r\n            }\r\n        }\r\n    },\r\n    _unloadEngine: function() {\r\n        if (window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id]) {\r\n            window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id].id = null ;\r\n            window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id].uploader = null ;\r\n            window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id] = null ;\r\n            delete window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id]\r\n        }\r\n        this._sl_obj_id = null ;\r\n        this._initEngine = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXFileUploader.prototype.setSLURL = function(a) {\r\n    this._sl_upload_url = a\r\n}\r\n;\r\ndhtmlXFileUploader.prototype.getSLVersion = function() {\r\n    var a = false;\r\n    if (window.dhx4.isIE) {\r\n        try {\r\n            var c = new ActiveXObject(\"AgControl.AgControl\");\r\n            if (c != null ) {\r\n                var l = 4\r\n                  , h = 0;\r\n                while (c.isVersionSupported([l, h].join(\".\"))) {\r\n                    a = [l, h];\r\n                    if (++h > 9) {\r\n                        l++;\r\n                        h = 0\r\n                    }\r\n                }\r\n            }\r\n            c = null \r\n        } catch (g) {}\r\n    } else {\r\n        if (navigator.plugins[\"Silverlight Plug-In\"] != null ) {\r\n            a = navigator.plugins[\"Silverlight Plug-In\"].description.split(\".\")\r\n        }\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXForm.prototype.saveBackup = function() {\r\n    if (!this._backup) {\r\n        this._backup = {};\r\n        this._backupId = new Date().getTime()\r\n    }\r\n    this._backup[++this._backupId] = this.getFormData();\r\n    return this._backupId\r\n}\r\n;\r\ndhtmlXForm.prototype.restoreBackup = function(a) {\r\n    if (this._backup != null  && this._backup[a] != null ) {\r\n        this.setFormData(this._backup[a])\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.clearBackup = function(a) {\r\n    if (this._backup != null  && this._backup[a] != null ) {\r\n        this._backup[a] = null ;\r\n        delete this._backup[a]\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.addItem = function(e, a, l, g) {\r\n    var c = null ;\r\n    if (e instanceof Array) {\r\n        c = e[1];\r\n        e = e[0]\r\n    }\r\n    var h = null ;\r\n    if (e != null ) {\r\n        var h = this._getParentForm(e, c);\r\n        if (h != null ) {\r\n            if (h.item._list == null ) {\r\n                if (!a.listParent) {\r\n                    a.listParent = h.item._idd\r\n                }\r\n                h.form._addItem(\"list\", h.item._idd, [a], null , h.item._idd, l, g)\r\n            } else {\r\n                h.item._list[0].addItem(null , a, l, g)\r\n            }\r\n            h.form = h.item = null ;\r\n            h = null ;\r\n            this._autoCheck();\r\n            return\r\n        }\r\n    }\r\n    this._prepareItem(a, l, g);\r\n    this._autoCheck()\r\n}\r\n;\r\ndhtmlXForm.prototype.removeItem = function(c, a) {\r\n    this._removeItem(c, a)\r\n}\r\n;\r\ndhtmlXForm.prototype.removeColumn = function(m, l, g, e) {\r\n    var o = null ;\r\n    if (m instanceof Array) {\r\n        o = m[1];\r\n        m = m[0]\r\n    }\r\n    if (m != null ) {\r\n        var h = this._getParentForm(m, o);\r\n        if (h != null ) {\r\n            if (h.item._list != null  && h.item._list[0] != null ) {\r\n                h.item._list[0].removeColumn(null , l, g, e)\r\n            }\r\n            h.form = h.item = null ;\r\n            h = null \r\n        }\r\n        return\r\n    }\r\n    l = Math.min(Math.max(l, 0), this.cont.childNodes.length - 1);\r\n    if (this.cont.childNodes.length == 1) {\r\n        if (g == true) {\r\n            this._removeItemsInColumn(this.cont.childNodes[l])\r\n        }\r\n    } else {\r\n        if (g == true) {\r\n            this._removeItemsInColumn(this.cont.childNodes[l])\r\n        } else {\r\n            if (!e) {\r\n                var a = l - 1;\r\n                if (a < 0) {\r\n                    a = l + 1\r\n                }\r\n            } else {\r\n                var a = l + 1;\r\n                if (a > this.cont.childNodes.length - 1) {\r\n                    a = l - 1\r\n                }\r\n            }\r\n            while (this.cont.childNodes[l].childNodes.length > 0) {\r\n                this.cont.childNodes[a].appendChild(this.cont.childNodes[l].childNodes[0])\r\n            }\r\n        }\r\n        var n = [];\r\n        for (var c = 0; c < this.base.length; c++) {\r\n            if (this.cont.childNodes[l] != this.base[c]) {\r\n                n.push(this.base[c])\r\n            }\r\n        }\r\n        this.base = n;\r\n        this.cont.removeChild(this.cont.childNodes[l]);\r\n        this.b_index--;\r\n        n = null \r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.getColumnNode = function(e, c) {\r\n    var g = null ;\r\n    var a = null ;\r\n    if (e instanceof Array) {\r\n        a = e[1];\r\n        e = e[0]\r\n    }\r\n    if (e != null ) {\r\n        var h = this._getParentForm(e, a);\r\n        if (h != null ) {\r\n            if (h.item._list != null  && h.item._list[0] != null  && g == null ) {\r\n                g = h.item._list[0].getColumnNode(null , c)\r\n            }\r\n            h.form = h.item = null ;\r\n            h = null \r\n        }\r\n        return g\r\n    }\r\n    if (c < 0 || c > this.cont.childNodes.length - 1) {\r\n        return null \r\n    }\r\n    return this.cont.childNodes[c]\r\n}\r\n;\r\ndhtmlXForm.prototype._removeItemsInColumn = function(g) {\r\n    var a = [];\r\n    for (var e = 0; e < g.childNodes.length; e++) {\r\n        var c = g.childNodes[e];\r\n        if (c._idd != null  && c._type != null ) {\r\n            a.push([c._idd, (c._type == \"ra\" ? c._value : null )])\r\n        }\r\n        c = null \r\n    }\r\n    for (var e = 0; e < a.length; e++) {\r\n        this.removeItem(a[e][0], a[e][1])\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype._getParentForm = function(l, h) {\r\n    if (this.itemPull[this.idPrefix + l] != null ) {\r\n        return {\r\n            form: this,\r\n            item: this.itemPull[this.idPrefix + l]\r\n        }\r\n    }\r\n    for (var c in this.itemPull) {\r\n        if (this.itemPull[c]._type == \"ra\" && this.itemPull[c]._group == l && this.itemPull[c]._value == h) {\r\n            return {\r\n                form: this,\r\n                item: this.itemPull[c]\r\n            }\r\n        }\r\n    }\r\n    var g = null ;\r\n    for (var c in this.itemPull) {\r\n        if (!g && this.itemPull[c]._list != null ) {\r\n            for (var e = 0; e < this.itemPull[c]._list.length; e++) {\r\n                if (!g) {\r\n                    g = this.itemPull[c]._list[e]._getParentForm(l, h)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return g\r\n}\r\n;\r\n(function() {\r\n    for (var c in dhtmlXForm.prototype.items) {\r\n        if (!dhtmlXForm.prototype.items[c]._getItemNode) {\r\n            dhtmlXForm.prototype.items[c]._getItemNode = function(a) {\r\n                return a\r\n            }\r\n        }\r\n    }\r\n})();\r\ndhtmlXForm.prototype._getItemNode = function(c, a) {\r\n    if (a != null ) {\r\n        c = [c, a]\r\n    }\r\n    return this.doWithItem(c, \"_getItemNode\")\r\n}\r\n;\r\ndhtmlXForm.prototype.setRequired = function(n, l, h) {\r\n    if (typeof (h) == \"undefined\") {\r\n        h = l\r\n    } else {\r\n        n = [n, l]\r\n    }\r\n    var e = this._getItemNode(n);\r\n    if (!e) {\r\n        return\r\n    }\r\n    h = window.dhx4.s2b(h);\r\n    e._required = (h == true);\r\n    if (e._required) {\r\n        if (!e._validate) {\r\n            e._validate = []\r\n        }\r\n        var c = false;\r\n        for (var g = 0; g < e._validate.length; g++) {\r\n            c = (e._validate[g] == \"NotEmpty\" || c)\r\n        }\r\n        if (!c) {\r\n            e._validate.push(\"NotEmpty\")\r\n        }\r\n        var m = e.childNodes[e._ll ? 0 : 1].childNodes[0];\r\n        if (!(m.lastChild && m.lastChild.className && m.lastChild.className.search(/required/) >= 0)) {\r\n            var a = document.createElement(\"SPAN\");\r\n            a.className = \"dhxform_item_required\";\r\n            a.innerHTML = \"*\";\r\n            m.appendChild(a);\r\n            a = m = null \r\n        }\r\n    } else {\r\n        if (e._validate != null ) {\r\n            var c = e._validate;\r\n            e._validate = [];\r\n            for (var g = 0; g < c.length; g++) {\r\n                if (c[g] != \"NotEmpty\") {\r\n                    e._validate.push(c[g])\r\n                }\r\n            }\r\n            if (e._validate.length == 0) {\r\n                e._validate = null \r\n            }\r\n        }\r\n        var m = e.childNodes[e._ll ? 0 : 1].childNodes[0];\r\n        if (m.lastChild && m.lastChild.className && m.lastChild.className.search(/required/) >= 0) {\r\n            m.removeChild(m.lastChild);\r\n            m = null \r\n        }\r\n    }\r\n    this._resetValidateCss(e);\r\n    e = null \r\n}\r\n;\r\ndhtmlXForm.prototype.setNote = function(h, e, a) {\r\n    if (typeof (a) == \"undefined\") {\r\n        a = e\r\n    } else {\r\n        h = [h, e]\r\n    }\r\n    var c = this._getItemNode(h);\r\n    if (!c) {\r\n        return\r\n    }\r\n    var g = this._getNoteNode(c);\r\n    if (!g) {\r\n        if (!a.width) {\r\n            a.width = c.childNodes[c._ll ? 1 : 0].childNodes[0].offsetWidth\r\n        }\r\n        g = document.createElement(\"DIV\");\r\n        g.className = \"dhxform_note\";\r\n        if ({\r\n            ch: 1,\r\n            ra: 1\r\n        }[c._type]) {\r\n            c.childNodes[c._ll ? 1 : 0].insertBefore(g, c.childNodes[c._ll ? 1 : 0].lastChild)\r\n        } else {\r\n            c.childNodes[c._ll ? 1 : 0].appendChild(g)\r\n        }\r\n    }\r\n    g.innerHTML = a.text;\r\n    if (a.width != null ) {\r\n        g.style.width = a.width + \"px\";\r\n        g._w = a.width\r\n    }\r\n    g = null \r\n}\r\n;\r\ndhtmlXForm.prototype.clearNote = function(g, c) {\r\n    if (typeof (c) != \"undefined\") {\r\n        g = [g, c]\r\n    }\r\n    var a = this._getItemNode(g);\r\n    if (!a) {\r\n        return\r\n    }\r\n    var e = this._getNoteNode(a);\r\n    if (e != null ) {\r\n        e.parentNode.removeChild(e);\r\n        e = null \r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype._getNoteNode = function(a) {\r\n    var e = null ;\r\n    for (var c = 0; c < a.childNodes[a._ll ? 1 : 0].childNodes.length; c++) {\r\n        if (String(a.childNodes[a._ll ? 1 : 0].childNodes[c].className).search(/dhxform_note/) >= 0) {\r\n            e = a.childNodes[a._ll ? 1 : 0].childNodes[c]\r\n        }\r\n    }\r\n    a = null ;\r\n    return e\r\n}\r\n;\r\ndhtmlXForm.prototype.setValidation = function(l, g, h) {\r\n    if (typeof (note) == \"undefined\") {\r\n        h = g\r\n    } else {\r\n        l = [l, g]\r\n    }\r\n    var c = this._getItemNode(l);\r\n    if (!c) {\r\n        return\r\n    }\r\n    if (c._validate != null ) {\r\n        for (var e = 0; e < c._validate.length; e++) {\r\n            c._validate[e] = null \r\n        }\r\n    }\r\n    c._validate = [];\r\n    if (typeof (h) == \"function\" || typeof (window[h]) == \"function\") {\r\n        c._validate = [h]\r\n    } else {\r\n        c._validate = String(h).split(this.separator)\r\n    }\r\n    if (c._required) {\r\n        var a = false;\r\n        for (var e = 0; e < c._validate.length; e++) {\r\n            a = (c._validate[e] == \"NotEmpty\" || a)\r\n        }\r\n        if (!a) {\r\n            c._validate.push(\"NotEmpty\")\r\n        }\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXForm.prototype.clearValidation = function(g, e) {\r\n    if (typeof (e) != \"undefined\") {\r\n        g = [g, e]\r\n    }\r\n    var a = this._getItemNode(g);\r\n    if (!a) {\r\n        return\r\n    }\r\n    if (a._validate != null ) {\r\n        for (var c = 0; c < a._validate.length; c++) {\r\n            a._validate[c] = null \r\n        }\r\n    }\r\n    a._validate = a._required ? [\"NotEmpty\"] : null ;\r\n    a = null \r\n}\r\n;\r\ndhtmlXForm.prototype.reloadOptions = function(a, l) {\r\n    var c = this.getItemType(a);\r\n    if (!{\r\n        select: 1,\r\n        multiselect: 1,\r\n        combo: 1\r\n    }[c]) {\r\n        return\r\n    }\r\n    if (c == \"select\" || c == \"multiselect\") {\r\n        var g = this.getOptions(a);\r\n        while (g.length > 0) {\r\n            g.remove(0)\r\n        }\r\n        g.length = 0;\r\n        g = null ;\r\n        if (typeof (l) == \"string\") {\r\n            this.doWithItem(a, \"doLoadOptsConnector\", l)\r\n        } else {\r\n            if (l instanceof Array) {\r\n                this.doWithItem(a, \"doLoadOpts\", {\r\n                    options: l\r\n                })\r\n            }\r\n        }\r\n    }\r\n    if (c == \"combo\") {\r\n        var m = this.getCombo(a);\r\n        m.clearAll();\r\n        m.setComboValue(\"\");\r\n        if (typeof (l) == \"string\") {\r\n            this.doWithItem(a, \"doLoadOptsConnector\", l)\r\n        } else {\r\n            if (l instanceof Array) {\r\n                var e = null ;\r\n                for (var h = 0; h < l.length; h++) {\r\n                    if (window.dhx4.s2b(l[h].selected)) {\r\n                        e = l[h].value\r\n                    }\r\n                }\r\n                m.addOption(l);\r\n                if (e != null ) {\r\n                    this.setItemValue(a, e)\r\n                }\r\n                m = null \r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXForm.prototype.setTooltip = function(l, h, g) {\r\n    if (typeof (g) == \"undefined\") {\r\n        g = h\r\n    } else {\r\n        l = [l, h]\r\n    }\r\n    var c = this._getItemNode(l);\r\n    if (!c) {\r\n        return\r\n    }\r\n    var a = null ;\r\n    if (c.childNodes.length == 1) {\r\n        a = c.childNodes[0]\r\n    } else {\r\n        for (var e = 0; e < c.childNodes.length; e++) {\r\n            if (c.childNodes[e].className != null  && c.childNodes[e].className.search(\"dhxform_label\") >= 0) {\r\n                a = c.childNodes[e]\r\n            }\r\n        }\r\n    }\r\n    if (a != null ) {\r\n        if (g == null  || g.length == 0) {\r\n            a.removeAttribute(\"title\")\r\n        } else {\r\n            a.title = g\r\n        }\r\n    }\r\n    a = null \r\n}\r\n;\r\nfunction dhtmlXAccordion(h, m) {\r\n    var g = this;\r\n    var e = window.dhx4.transDetect();\r\n    this.conf = {\r\n        skin: (m || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxacc\") || \"dhx_skyblue\"),\r\n        css: \"dhxacc\",\r\n        icons_path: \"\",\r\n        multi_mode: false,\r\n        last_opened: null ,\r\n        on_active_id: null ,\r\n        on_active_click: false,\r\n        size_changed: true,\r\n        def_height: 90,\r\n        total_count: 0,\r\n        hiden_count: 0,\r\n        cont_w: null \r\n    };\r\n    this.conf.tr = {\r\n        prop: e.transProp,\r\n        ev: e.transEv,\r\n        height_open: \"height 0.2s cubic-bezier(0.25,0.1,0.25,1)\",\r\n        height_close: \"height 0.18s cubic-bezier(0.25,0.1,0.25,1)\",\r\n        op_open: \"opacity 0.16s ease-in\",\r\n        op_close: \"opacity 0.2s ease-out\",\r\n        op_v_open: \"1\",\r\n        op_v_close: \"0.4\",\r\n        dnd_top: \"top 0.16s\"\r\n    };\r\n    this.ofs = {\r\n        m: {},\r\n        s: {},\r\n        def: {\r\n            m: {\r\n                left: 0,\r\n                right: 0,\r\n                first: 0,\r\n                between: 8\r\n            },\r\n            s: {\r\n                left: 0,\r\n                right: 0,\r\n                first: 0,\r\n                between: -1,\r\n                last: 0\r\n            }\r\n        },\r\n        base: {\r\n            s: {},\r\n            m: {}\r\n        },\r\n        skin: {\r\n            dhx_web: {\r\n                s: {\r\n                    between: 3\r\n                },\r\n                m: {\r\n                    between: 3\r\n                }\r\n            },\r\n            dhx_terrace: {\r\n                m: {\r\n                    between: 12,\r\n                    left: 0,\r\n                    right: 0\r\n                }\r\n            }\r\n        }\r\n    };\r\n    if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\r\n        this.conf.tr.height_open = this.conf.tr.height_close\r\n    } else {\r\n        this.conf.tr.height_open = this.conf.tr.height_close\r\n    }\r\n    var l = null ;\r\n    if (typeof (h) == \"object\" && !h.tagName) {\r\n        l = {};\r\n        for (var c in h) {\r\n            l[c] = h[c];\r\n            h[c] = null \r\n        }\r\n        h = l.parent;\r\n        l.parent = null \r\n    }\r\n    window.dhtmlXCellTop.apply(this, [h, h._ofs]);\r\n    this._adjustCont();\r\n    if (this.base._ofs != null ) {\r\n        for (var n in this.ofs.base) {\r\n            if (this.base._ofs[n] != null ) {\r\n                for (var c in this.base._ofs[n]) {\r\n                    this.ofs.base[n][c] = this.base._ofs[n][c]\r\n                }\r\n            }\r\n        }\r\n    }\r\n    this._applyOffsets = function() {\r\n        for (var v in this.ofs.def) {\r\n            var s = this.ofs.def[v];\r\n            var u = (this.ofs.skin[this.conf.skin] != null  && this.ofs.skin[this.conf.skin][v] != null  ? this.ofs.skin[this.conf.skin][v] : null );\r\n            var r = (this.base._ofs != null  ? this.base._ofs[v] : null );\r\n            for (var o in s) {\r\n                if (u != null  && u[o] != null ) {\r\n                    this.ofs[v][o] = u[o]\r\n                } else {\r\n                    if (r != null  && r[o] != null ) {\r\n                        this.ofs[v][o] = r[o]\r\n                    } else {\r\n                        this.ofs[v][o] = s[o]\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._applyOffsets();\r\n    this.t = {};\r\n    this.addItem = function(x, w, r, o, v) {\r\n        if (x == null ) {\r\n            x = \"a\" + window.dhx4.newId()\r\n        }\r\n        while (this.t[x] != null ) {\r\n            x = \"a\" + window.dhx4.newId()\r\n        }\r\n        var a = new dhtmlXAccordionCell(x,this);\r\n        a.conf.skin = this.conf.skin;\r\n        a.setText(w);\r\n        if (v != null ) {\r\n            a.setIcon(v)\r\n        }\r\n        a.cell._accId = x;\r\n        a.cell.childNodes[a.conf.idx.hdr].onselectstart = function(y) {\r\n            y = y || event;\r\n            if (y.preventDefault) {\r\n                y.preventDefault()\r\n            } else {\r\n                y.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        a.cell.childNodes[a.conf.idx.hdr].onclick = function(A) {\r\n            A = A || event;\r\n            if (A.preventDefault) {\r\n                A.preventDefault()\r\n            } else {\r\n                A.returnValue = false\r\n            }\r\n            if (g._dnd != null  && g._dnd.ofs == true) {\r\n                return\r\n            }\r\n            var y = (A.target || A.srcElement);\r\n            var C = null ;\r\n            while (y._accId != this && C == null ) {\r\n                if (y._accId != null ) {\r\n                    C = y._accId\r\n                } else {\r\n                    y = y.parentNode\r\n                }\r\n            }\r\n            if (C != null ) {\r\n                g._hdrClick(C)\r\n            }\r\n        }\r\n        ;\r\n        this.t[x] = {\r\n            cell: a\r\n        };\r\n        this.conf.total_count++;\r\n        if (this.conf.multi_mode) {\r\n            if (typeof (r) == \"undefined\") {\r\n                r = true\r\n            }\r\n            this.cont.appendChild(a.cell);\r\n            a.conf.opened = (r == true);\r\n            if (typeof (o) == \"undefined\" || o == null  || o == \"*\") {\r\n                if (o == \"*\") {\r\n                    a.conf.h_auto = true\r\n                }\r\n                o = this.conf.def_height\r\n            } else {\r\n                o = Math.max(parseInt(o), 30)\r\n            }\r\n            a._setSize(this.ofs.m.left, 0, this.conf.cont_w || this._getAvailItemWidth(), a.conf.opened ? o : a._getHdrHeight());\r\n            a.cell.style.marginTop = (a.cell == this.cont.firstChild ? this.ofs.m.first : this.ofs.m.between) + \"px\";\r\n            if (r != true) {\r\n                a.conf.size.h = o;\r\n                a._adjustCell();\r\n                a.cell.className += \" dhx_cell_closed\"\r\n            }\r\n            this._adjustOpened();\r\n            if (this._dnd != null ) {\r\n                this._dndAttachEvent(x)\r\n            }\r\n        } else {\r\n            r = (this.conf.last_opened == null  ? true : window.dhx4.s2b(r));\r\n            var u = this._updateCellsHeight();\r\n            if (this.conf.last_opened != null ) {\r\n                if (r) {\r\n                    this._closeItem(this.conf.last_opened, false)\r\n                } else {\r\n                    var s = this.t[this.conf.last_opened].cell;\r\n                    s._setSize(s.conf.size.x, s.conf.size.y, s.conf.size.w, u);\r\n                    s = null \r\n                }\r\n            }\r\n            this.cont.appendChild(a.cell);\r\n            a.conf.opened = r;\r\n            a.cell.style.marginTop = String(a.cell == this.cont.firstChild ? this.ofs.s.first : this.ofs.s.between) + \"px\";\r\n            a._setSize(this.ofs.s.left, 0, this.conf.cont_w || this._getAvailItemWidth(), r ? u : a._getHdrHeight());\r\n            if (r) {\r\n                this.conf.last_opened = x\r\n            } else {\r\n                a.conf.size.h = u;\r\n                a._adjustCell();\r\n                a.cell.className += \" dhx_cell_closed\"\r\n            }\r\n        }\r\n        a = null ;\r\n        return this.t[x].cell\r\n    }\r\n    ;\r\n    this.removeItem = function(a) {\r\n        if (!this.t[a]) {\r\n            return\r\n        }\r\n        if (this.conf.last_opened == a) {\r\n            this.conf.last_opened = null \r\n        }\r\n        if (this.conf.on_active_id == a) {\r\n            this.conf.on_active_id = null \r\n        }\r\n        if (this._dnd != null ) {\r\n            this._dndClearCell(a)\r\n        }\r\n        this.conf.total_count--;\r\n        if (!this.conf.multi_mode && !this.t[a].cell.conf.visible) {\r\n            this.conf.hiden_count--\r\n        }\r\n        this.t[a].cell._unload();\r\n        this.t[a].cell = null ;\r\n        this.t[a] = null ;\r\n        delete this.t[a];\r\n        if (!this.conf.unloading) {\r\n            if (!this.conf.multi_mode) {\r\n                this._updateCellsMargin()\r\n            }\r\n            this.setSizes()\r\n        }\r\n    }\r\n    ;\r\n    this.cells = function(a) {\r\n        return this.t[a].cell\r\n    }\r\n    ;\r\n    this.enableMultiMode = function(a, o) {\r\n        this.conf.multi_mode = true;\r\n        if (!isNaN(o)) {\r\n            this.conf.def_height = o\r\n        }\r\n        if (a == \"auto\" || a == \"scroll\") {\r\n            this.cont.style.overflowX = \"hidden\";\r\n            this.cont.style.overflowY = a\r\n        } else {\r\n            this.cont.style.overflow = \"visible\"\r\n        }\r\n    }\r\n    ;\r\n    this.forEachItem = function(r) {\r\n        for (var o in this.t) {\r\n            if (typeof (r) == \"function\") {\r\n                r.apply(this, [this.t[o].cell])\r\n            } else {\r\n                if (typeof (r) == \"string\" && typeof (window[r]) == \"function\") {\r\n                    window[r].apply(this, [this.t[o].cell])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._openItem = function(o, a) {\r\n        if (typeof (a) == \"undefined\") {\r\n            a = true\r\n        }\r\n        if (this.t[o].cell.conf.opened == false) {\r\n            if (this.conf.multi_mode) {\r\n                this.t[o].cell._open(a)\r\n            } else {\r\n                if (this.conf.tr.prop == false) {\r\n                    if (this.conf.last_opened != null ) {\r\n                        this.t[this.conf.last_opened].cell._close(false)\r\n                    }\r\n                    this.t[o].cell._open(false);\r\n                    this.conf.last_opened = o\r\n                } else {\r\n                    this.conf.on_active_id = o;\r\n                    this.t[o].cell._open(a);\r\n                    if (this.conf.last_opened != null ) {\r\n                        this.t[this.conf.last_opened].cell._close(a)\r\n                    }\r\n                    this.conf.last_opened = o\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._closeItem = function(o, a) {\r\n        if (typeof (a) == \"undefined\") {\r\n            a = true\r\n        }\r\n        if (this.t[o].cell.conf.opened == true) {\r\n            this.t[o].cell._close(a);\r\n            this.conf.last_opened = null \r\n        }\r\n    }\r\n    ;\r\n    this._adjustOpened = function() {\r\n        if (this.conf.multi_mode == true) {\r\n            if (this._openCache == null ) {\r\n                var u = this._getDynData();\r\n                for (var r in u) {\r\n                    this.t[r].cell.conf.size.h = Math.max(u[r], 0);\r\n                    this.t[r].cell.cell.style.height = Math.max(u[r], 0) + \"px\"\r\n                }\r\n            } else {\r\n                var v = false;\r\n                for (var r in this._openCache) {\r\n                    v = (v || this._openCache[r])\r\n                }\r\n                if (v == true) {\r\n                    return\r\n                }\r\n                this._openCache = this._openId = null \r\n            }\r\n            var o = this._getAvailItemWidth();\r\n            for (var r in this.t) {\r\n                var s = true;\r\n                if (o == this.t[r].cell.conf.size.w && (this._openMode == \"close\" || this.t[r].cell.conf.opened == false)) {\r\n                    s = false\r\n                }\r\n                if (s) {\r\n                    this.t[r].cell._setWidth(o)\r\n                }\r\n            }\r\n            this._openMode = null \r\n        } else {\r\n            if (this.conf.last_opened != null ) {\r\n                var w = this.conf.last_opened;\r\n                this.t[w].cell._setSize(this.t[w].cell.conf.size.x, this.t[w].cell.conf.size.y, this.t[w].cell.conf.size.w, this.t[w].cell.conf.size.h)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._getDynData = function(D, C) {\r\n        if (typeof (D) == \"undefined\" || D == null ) {\r\n            D = {}\r\n        }\r\n        if (typeof (C) == \"undefined\" || C == null ) {\r\n            C = {}\r\n        }\r\n        var w = {};\r\n        var A = 0;\r\n        var v = 0;\r\n        var s = 0;\r\n        for (var o = 0; o < this.cont.childNodes.length; o++) {\r\n            var r = this.cont.childNodes[o]._accId;\r\n            var F = this.t[r].cell;\r\n            if (F.conf.visible == true) {\r\n                var x = this.ofs.m[s == 0 ? \"first\" : \"between\"];\r\n                if (D[r] == true || C[r] == true || (F.conf.opened == true && F.conf.h_auto == true)) {\r\n                    if (C[r] == true) {\r\n                        var y = F._getHdrHeight();\r\n                        w[r] = y;\r\n                        v += y + x\r\n                    } else {\r\n                        if (F.conf.h_auto == true) {\r\n                            w[r] = true;\r\n                            v += x;\r\n                            A++\r\n                        } else {\r\n                            if (D[r] == true) {\r\n                                w[r] = F.conf.size.h;\r\n                                v += F.conf.size.h + x\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    v += F.cell.offsetHeight + x\r\n                }\r\n                s++\r\n            }\r\n            F = null \r\n        }\r\n        if (A > 0) {\r\n            var u = this.cont.offsetHeight - v;\r\n            var v = Math.floor(u / A);\r\n            for (var E in w) {\r\n                if (w[E] == true) {\r\n                    if (A > 1) {\r\n                        u -= v\r\n                    } else {\r\n                        v = u\r\n                    }\r\n                    w[E] = v;\r\n                    A--\r\n                }\r\n            }\r\n        }\r\n        return w\r\n    }\r\n    ;\r\n    this.setSizes = function() {\r\n        this._adjustCont();\r\n        if (this.conf.multi_mode == true) {\r\n            this._adjustOpened()\r\n        } else {\r\n            this.conf.cont_w = null ;\r\n            var r = this._updateCellsHeight();\r\n            for (var o in this.t) {\r\n                if (this.t[o].cell.conf.visible == true) {\r\n                    this.t[o].cell._setSize(this.ofs.s.left, 0, this.conf.cont_w || this._getAvailItemWidth(), this.t[o].cell.conf.opened ? r : this.t[o].cell._getHdrHeight());\r\n                    if (this.t[o].cell.conf.opened != true) {\r\n                        this.t[o].cell.conf.size.h = r;\r\n                        this.t[o].cell._adjustCell()\r\n                    }\r\n                }\r\n            }\r\n            this.conf.size_changed = true\r\n        }\r\n        this.callEvent(\"_onSetSizes\", [])\r\n    }\r\n    ;\r\n    this.setSkin = function(r) {\r\n        this._setBaseSkin(r);\r\n        this.conf.skin = r;\r\n        for (var o in this.t) {\r\n            this.t[o].cell.conf.cells_cont = null ;\r\n            this.t[o].cell.conf.skin = this.conf.skin\r\n        }\r\n        this._applyOffsets();\r\n        this._updateCellsMargin();\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.setIconsPath = function(a) {\r\n        this.conf.icons_path = a\r\n    }\r\n    ;\r\n    this._getAvailItemWidth = function() {\r\n        var o = this.ofs[(this.conf.multi_mode ? \"m\" : \"s\")];\r\n        var a = Math.max(this.cont.clientWidth - o.left - o.right, 10);\r\n        this.conf.cont_w = a;\r\n        o = null ;\r\n        return a\r\n    }\r\n    ;\r\n    this._updateCellsHeight = function() {\r\n        if (this.conf.multi_mode == true) {\r\n            return\r\n        }\r\n        var r = this.conf.total_count - this.conf.hiden_count;\r\n        var s = this.cont.offsetHeight - this.ofs.s.last;\r\n        if (r == 0) {\r\n            return s\r\n        }\r\n        var v = false;\r\n        for (var u = 0; u < this.cont.childNodes.length; u++) {\r\n            if (v == false) {\r\n                var w = this.cont.childNodes[u]._accId;\r\n                if (this.t[w].cell.conf.visible) {\r\n                    s -= this.t[w].cell._getHdrHeight() * (r - 1);\r\n                    v = true\r\n                }\r\n            }\r\n        }\r\n        s -= (r - 1) * this.ofs.s.between + this.ofs.s.first;\r\n        for (var o in this.t) {\r\n            if (this.t[o].cell.conf.size != null ) {\r\n                this.t[o].cell.conf.size.h = s;\r\n                this.t[o].cell._adjustCell()\r\n            }\r\n        }\r\n        return s\r\n    }\r\n    ;\r\n    this._updateCellsMargin = function() {\r\n        var a = 0;\r\n        for (var o = 0; o < this.cont.childNodes.length; o++) {\r\n            var r = this.cont.childNodes[o]._accId;\r\n            if (this.t[r].cell.conf.visible) {\r\n                this.t[r].cell.cell.style.marginTop = String(this.ofs[this.conf.multi_mode ? \"m\" : \"s\"][a++ == 0 ? \"first\" : \"between\"]) + \"px\"\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._hdrClick = function(o) {\r\n        if (!this.conf.multi_mode && this.t[o].cell.conf.opened) {\r\n            return\r\n        }\r\n        var a = this.t[o].cell.conf.opened;\r\n        if (this.callEvent(\"onBeforeActive\", [o, (a ? false : true)]) !== true) {\r\n            return\r\n        }\r\n        this.conf.on_active_click = true;\r\n        this[a ? \"_closeItem\" : \"_openItem\"](o);\r\n        if (this.conf.multi_mode && this.conf.tr.prop == false) {\r\n            this._adjustOpened()\r\n        }\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this.conf.unloading = true;\r\n        for (var o in this.t) {\r\n            this.removeItem(o)\r\n        }\r\n        this.t = null ;\r\n        if (typeof (this._unloadDND) == \"function\") {\r\n            this._unloadDND()\r\n        }\r\n        if (this.dhxWins) {\r\n            this.dhxWins.unload();\r\n            this.dhxWins = null \r\n        }\r\n        this._unloadTop();\r\n        window.dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.ofs = this.conf = null ;\r\n        for (var o in this) {\r\n            this[o] = null \r\n        }\r\n        g = null \r\n    }\r\n    ;\r\n    this.setOffset = function(a) {\r\n        this.ofs.s.between = a;\r\n        this.ofs.m.between = a;\r\n        this._updateCellsMargin();\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this._initObj = function(o) {\r\n        if (o.skin != null ) {\r\n            this.setSkin(o.skin)\r\n        }\r\n        if (window.dhx4.s2b(o.multi_mode)) {\r\n            this.enableMultiMode()\r\n        }\r\n        if (o.icons_path != null ) {\r\n            this.setIconsPath(o.icons_path)\r\n        }\r\n        if (o.icon_path != null ) {\r\n            this.setIconsPath(o.icon_path)\r\n        }\r\n        if (o.items != null ) {\r\n            for (var a = 0; a < o.items.length; a++) {\r\n                this.addItem(o.items[a].id, o.items[a].text, o.items[a].open, o.items[a].height, o.items[a].icon || o.items[a].img)\r\n            }\r\n        }\r\n        if (window.dhx4.s2b(o.dnd) == true && typeof (this.enableDND) == \"function\") {\r\n            this.enableDND()\r\n        }\r\n    }\r\n    ;\r\n    this._xmlToObj = function(u) {\r\n        var r = {\r\n            items: []\r\n        };\r\n        var a = u.getElementsByTagName(\"accordion\")[0];\r\n        if (a.getAttribute(\"skin\") != null ) {\r\n            r.skin = a.getAttribute(\"skin\")\r\n        }\r\n        if (a.getAttribute(\"mode\") == \"multi\") {\r\n            r.multi_mode = true\r\n        }\r\n        if (a.getAttribute(\"multiMode\") != null ) {\r\n            r.multi_mode = window.dhx4.s2b(a.getAttribute(\"multiMode\"))\r\n        }\r\n        if (a.getAttribute(\"iconsPath\") != null ) {\r\n            r.icons_path = a.getAttribute(\"iconsPath\")\r\n        }\r\n        for (var s = 0; s < a.childNodes.length; s++) {\r\n            var v = a.childNodes[s];\r\n            if (typeof (v.tagName) != \"undefined\" && String(v.tagName).toLowerCase() == \"cell\") {\r\n                var o = {};\r\n                if (v.getAttribute(\"id\") != null ) {\r\n                    o.id = v.getAttribute(\"id\")\r\n                }\r\n                if (v.getAttribute(\"icon\") != null ) {\r\n                    o.icon = v.getAttribute(\"icon\")\r\n                }\r\n                if (v.getAttribute(\"height\") != null ) {\r\n                    o.height = v.getAttribute(\"height\")\r\n                }\r\n                if (v.getAttribute(\"open\") != null ) {\r\n                    o.open = window.dhx4.s2b(v.getAttribute(\"open\"))\r\n                }\r\n                o.text = v.firstChild.nodeValue;\r\n                r.items.push(o)\r\n            }\r\n            v = null \r\n        }\r\n        return r\r\n    }\r\n    ;\r\n    window.dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToObj\", \"accordion\", {\r\n        struct: true\r\n    });\r\n    window.dhx4._eventable(this);\r\n    this._callMainEvent = function(o, a) {\r\n        return this.callEvent(o, a)\r\n    }\r\n    ;\r\n    this.attachEvent(\"onActive\", function(a) {\r\n        if (a != null  && this.t[a] != null  && this.t[a].cell.dataObj != null  && this.t[a].cell.dataType == \"editor\") {\r\n            this.t[a].cell.dataObj._prepareContent(true)\r\n        }\r\n        if (a != null  && this.t[a] != null  && this.t[a].cell.conf.opened == true) {\r\n            this.t[a].cell._adjustProgress()\r\n        }\r\n    });\r\n    if (typeof (window.dhtmlXWindows) == \"function\") {\r\n        this.dhxWins = new dhtmlXWindows();\r\n        this.dhxWins.setSkin(this.conf.skin)\r\n    }\r\n    if (l != null ) {\r\n        this._initObj(l);\r\n        l = null \r\n    }\r\n    return this\r\n}\r\ndhtmlXAccordion.prototype = new dhtmlXCellTop();\r\nfunction dhtmlXAccordionCell(g, e) {\r\n    dhtmlXCellObject.apply(this, [g, \"_acc\"]);\r\n    this.acc = e;\r\n    this.conf.visible = true;\r\n    this.conf.docked = true;\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        this._trDetachEv();\r\n        this._unloadDocking();\r\n        this.acc = null ;\r\n        this.cell._accObj = null ;\r\n        this.cell.childNodes[this.conf.idx.hdr].onselectstart = null ;\r\n        this.cell.childNodes[this.conf.idx.hdr].onclick = null ;\r\n        this._initHeader = null ;\r\n        this._getHdrHeight = null ;\r\n        this._setWidth = null ;\r\n        this._adjustCell = null ;\r\n        this._open = null ;\r\n        this._close = null ;\r\n        this._isOpened = null ;\r\n        this._trInitEv = null ;\r\n        this._trAttachEv = null ;\r\n        this._trDetachEv = null ;\r\n        this._trOnEnd = null ;\r\n        this._onActiveCall = null ;\r\n        this.setText = null ;\r\n        this.getText = null ;\r\n        this.setIcon = null ;\r\n        this.clearIcon = null ;\r\n        this.show = null ;\r\n        this.hide = null ;\r\n        this.isVisible = null ;\r\n        this.setHeight = null ;\r\n        this.moveOnTop = null \r\n    });\r\n    this.acc.attachEvent(\"onBeforeDrag\", function(l) {\r\n        if (this.t[l].cell.dataObj != null  && this.t[l].cell.dataType == \"editor\") {\r\n            if (this.conf.editor_data == null ) {\r\n                this.conf.editor_data = {}\r\n            }\r\n            this.conf.editor_data[l] = this.t[l].cell.dataObj.getContent()\r\n        }\r\n        for (var h in this.t) {\r\n            this.t[h].cell._showCellCover()\r\n        }\r\n        return true\r\n    });\r\n    this.acc.attachEvent(\"onDrop\", function(l) {\r\n        if (this.t[l].cell.dataObj != null  && this.t[l].cell.dataType == \"editor\") {\r\n            this.t[l].cell.dataObj._prepareContent(true);\r\n            if (this.conf.editor_data != null  && this.conf.editor_data[l] != null ) {\r\n                this.t[l].cell.dataObj.setContent(this.conf.editor_data[l]);\r\n                this.conf.editor_data[l] = null \r\n            }\r\n        }\r\n        for (var h in this.t) {\r\n            this.t[h].cell._hideCellCover()\r\n        }\r\n    });\r\n    this.attachEvent(\"_onContentLoaded\", function() {\r\n        this.acc._callMainEvent(\"onContentLoaded\", arguments)\r\n    });\r\n    this.attachEvent(\"_onBeforeContentAttach\", function(a) {\r\n        if (a == \"sidebar\" && this.conf.skin != \"dhx_skyblue\") {\r\n            this._hideBorders()\r\n        }\r\n    });\r\n    this._initHeader();\r\n    this.conf.tr = {};\r\n    for (var c in this.acc.conf.tr) {\r\n        this.conf.tr[c] = this.acc.conf.tr[c]\r\n    }\r\n    if (this.conf.tr.prop != false) {\r\n        this.attachEvent(\"_onIdxUpdated\", function() {\r\n            this._cellSetOpacity((this.conf.opened ? \"open\" : \"close\"), false)\r\n        })\r\n    }\r\n    this.open = function(a) {\r\n        if (window.dhx4.s2b(a) == true) {\r\n            this.acc.conf.on_active_click = true\r\n        }\r\n        this.acc._openItem(this._idd)\r\n    }\r\n    ;\r\n    this.close = function(a) {\r\n        if (window.dhx4.s2b(a) == true) {\r\n            this.acc.conf.on_active_click = true\r\n        }\r\n        this.acc._closeItem(this._idd)\r\n    }\r\n    ;\r\n    this._setWidth = function(a) {\r\n        if (a != this.conf.size.w) {\r\n            this.conf.size.w = a;\r\n            this.cell.style.width = a + \"px\"\r\n        }\r\n        this._adjustCell()\r\n    }\r\n    ;\r\n    this._adjustCell = function() {\r\n        this._adjustCont();\r\n        if (this.dataObj != null  && typeof (this.dataObj.setSizes) == \"function\") {\r\n            this.dataObj.setSizes()\r\n        }\r\n    }\r\n    ;\r\n    this._initDocking();\r\n    return this\r\n}\r\ndhtmlXAccordionCell.prototype = new dhtmlXCellObject();\r\ndhtmlXAccordionCell.prototype._initHeader = function() {\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = \"dhx_cell_hdr\";\r\n    a.innerHTML = \"<div class='dhx_cell_hdr_text'></div><div class='dhx_cell_hdr_arrow'></div>\";\r\n    this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cont]);\r\n    a = null ;\r\n    this.conf.ofs_nodes.t._getHdrHeight = \"func\";\r\n    this.conf.hdr = {\r\n        visible: true\r\n    };\r\n    this.conf.idx_data.hdr = \"dhx_cell_hdr\";\r\n    this._updateIdx()\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._getHdrHeight = function() {\r\n    var a = this.cell.childNodes[this.conf.idx.hdr];\r\n    var c = a.offsetHeight || a.offsetHeight;\r\n    a = null ;\r\n    return c\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.showHeader = function() {\r\n    if (this.conf.hdr.visible == true) {\r\n        return\r\n    }\r\n    this.conf.hdr.visible = true;\r\n    this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_hdr\";\r\n    this._adjustCont(this._idd)\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.hideHeader = function() {\r\n    if (this.conf.hdr.visible != true) {\r\n        return\r\n    }\r\n    this.conf.hdr.visible = false;\r\n    this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_hdr dhx_cell_hdr_hidden\";\r\n    this._adjustCont(this._idd)\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.isHeaderVisible = function() {\r\n    return ( this.conf.hdr.visible == true) \r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.setText = function(c) {\r\n    this.conf.text = c;\r\n    var a = this.cell.childNodes[this.conf.idx.hdr];\r\n    a.childNodes[(a.firstChild.className == \"dhx_cell_hdr_icon\" ? 1 : 0)].innerHTML = \"<span>\" + c + \"</span>\";\r\n    a = null \r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.getText = function() {\r\n    return this.conf.text\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.setIcon = function(e) {\r\n    var c = this.cell.childNodes[this.conf.idx.hdr];\r\n    if (c.firstChild.className != \"dhx_cell_hdr_icon\") {\r\n        c.firstChild.className += \" dhx_cell_hdr_icon\";\r\n        var a = document.createElement(\"IMG\");\r\n        a.className = \"dhx_cell_hdr_icon\";\r\n        c.insertBefore(a, c.firstChild);\r\n        a = null \r\n    }\r\n    c.firstChild.src = this.acc.conf.icons_path + e;\r\n    c = null \r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.clearIcon = function() {\r\n    var a = this.cell.childNodes[this.conf.idx.hdr];\r\n    if (a.firstChild.className == \"dhx_cell_hdr_icon\") {\r\n        a.removeChild(a.firstChild);\r\n        a.firstChild.className = String(a.firstChild.className).replace(/\\s{1,}dhx_cell_hdr_icon/gi, \"\")\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._open = function(c) {\r\n    var h = {};\r\n    if (this.acc.conf.multi_mode) {\r\n        var g = {};\r\n        g[this._idd] = true;\r\n        h = this.acc._getDynData(g);\r\n        this.acc._openId = this._idd;\r\n        this.acc._openCache = {};\r\n        this.acc._openMode = \"open\"\r\n    } else {\r\n        h[this._idd] = this.conf.size.h\r\n    }\r\n    for (var e in h) {\r\n        if (this.acc._openCache != null ) {\r\n            this.acc._openCache[e] = true\r\n        }\r\n        var l = this.acc.t[e].cell;\r\n        l.cell.className = String(l.cell.className).replace(/\\s{1,}dhx_cell_closed/gi, \"\");\r\n        l.conf.opened = true;\r\n        l._trInitEv(\"open\", c);\r\n        l.conf.size.h = h[e];\r\n        l.cell.style.height = l.conf.size.h + \"px\";\r\n        l = null \r\n    }\r\n    if (this.conf.tr.prop == false) {\r\n        this.acc._openId = this.acc._openCache = this.acc._openMode = null ;\r\n        this._onActiveCall(true)\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._close = function(c) {\r\n    var g = {};\r\n    if (this.acc.conf.multi_mode) {\r\n        var h = {};\r\n        h[this._idd] = true;\r\n        g = this.acc._getDynData(null , h);\r\n        this.acc._openId = this._idd;\r\n        this.acc._openCache = {};\r\n        this.acc._openMode = \"close\"\r\n    } else {\r\n        g[this._idd] = this._getHdrHeight()\r\n    }\r\n    for (var e in g) {\r\n        var l = this.acc.t[e].cell;\r\n        if (this.acc._openCache != null ) {\r\n            this.acc._openCache[e] = true\r\n        }\r\n        if (e == this._idd) {\r\n            l.cell.className += \" dhx_cell_closed\";\r\n            l.conf.opened = false;\r\n            l._trInitEv(\"close\", c)\r\n        } else {\r\n            l.conf.size.h = g[e];\r\n            l._adjustCell();\r\n            l._trInitEv(\"open\", c)\r\n        }\r\n        l.cell.style.height = g[e] + \"px\";\r\n        l = null \r\n    }\r\n    if (this.conf.tr.prop == false) {\r\n        this.acc._openId = this.acc._openCache = this.acc._openMode = null ;\r\n        this._onActiveCall(false)\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.isOpened = function() {\r\n    return ( this.conf.opened == true) \r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._trInitEv = function(c, a) {\r\n    if (this.conf.tr.prop == false) {\r\n        return\r\n    }\r\n    this._trAttachEv();\r\n    if (!this.cell._accObj) {\r\n        this.cell._accObj = this.acc\r\n    }\r\n    if (a) {\r\n        this.cell.style[this.conf.tr.prop] = this.conf.tr[\"height_\" + c]\r\n    }\r\n    this._cellSetOpacity(c, a)\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._trAttachEv = function() {\r\n    if (!this.conf.tr.ev_attached) {\r\n        this.cell._trProp = this.conf.tr.prop;\r\n        this.cell.addEventListener(this.conf.tr.ev, this._trOnEnd, false);\r\n        this.conf.tr.ev_attached = true\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._trDetachEv = function() {\r\n    if (this.conf.tr.ev_attached) {\r\n        this.cell.addEventListener(this.conf.tr.ev, this._trOnEnd, false);\r\n        this.conf.tr.ev_attached = false\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._trOnEnd = function(a) {\r\n    if (a.stopPropagation) {\r\n        a.stopPropagation()\r\n    }\r\n    if (a.propertyName == \"height\" && this._accObj != null ) {\r\n        this.style[this._trProp] = \"\";\r\n        if (this._accObj.conf.multi_mode) {\r\n            if (this._accObj._openCache != null ) {\r\n                this._accObj._openCache[this._accId] = false\r\n            }\r\n            this._accObj._adjustOpened()\r\n        }\r\n        if (this._accObj.conf.on_active_click == true) {\r\n            if (this._accObj.conf.multi_mode) {\r\n                this._accObj._callMainEvent(\"onActive\", [this._accId, this._accObj.t[this._accId].cell.conf.opened]);\r\n                this._accObj.conf.on_active_click = false\r\n            } else {\r\n                if (this._accObj.conf.on_active_id != null ) {\r\n                    this._accObj._callMainEvent(\"onActive\", [this._accObj.conf.on_active_id, true])\r\n                }\r\n                this._accObj.conf.on_active_id = null ;\r\n                this._accObj.conf.on_active_click = false\r\n            }\r\n        }\r\n        this._accObj = null \r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._cellSetOpacity = function(g, c) {\r\n    for (var e in this.conf.idx) {\r\n        if ({\r\n            hdr: true,\r\n            pr1: true,\r\n            pr2: true,\r\n            cover: true\r\n        }[e] != true) {\r\n            if (c) {\r\n                this.cell.childNodes[this.conf.idx[e]].style[this.conf.tr.prop] = this.conf.tr[\"op_\" + g]\r\n            }\r\n            this.cell.childNodes[this.conf.idx[e]].style.opacity = this.conf.tr[\"op_v_\" + g]\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._onActiveCall = function(a) {\r\n    if (this.acc.conf.on_active_click == false) {\r\n        return\r\n    }\r\n    if (this.acc.conf.multi_mode == true) {\r\n        this.acc._callMainEvent(\"onActive\", [this._idd, this.conf.opened]);\r\n        this.acc.conf.on_active_click = false\r\n    } else {\r\n        if (a == true) {\r\n            this.acc._callMainEvent(\"onActive\", [this._idd, true]);\r\n            this.acc.conf.on_active_click = false\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.show = function() {\r\n    if (this.conf.visible) {\r\n        return\r\n    }\r\n    if (this.conf.docked == false) {\r\n        this.dock();\r\n        return\r\n    }\r\n    this.cell.style.display = \"\";\r\n    this.conf.visible = true;\r\n    if (!this.acc.conf.multi_mode) {\r\n        this.acc.conf.hiden_count--;\r\n        this.acc._updateCellsHeight();\r\n        this.acc._updateCellsMargin()\r\n    }\r\n    if (this.acc.conf.size_changed) {\r\n        this.acc.setSizes();\r\n        this.acc.conf.size_changed = false\r\n    } else {\r\n        this.acc._adjustOpened()\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.hide = function() {\r\n    if (!this.conf.visible) {\r\n        return\r\n    }\r\n    if (!this.acc.conf.multi_mode && this.conf.opened) {\r\n        this._close(false);\r\n        this.acc.conf.last_opened = null \r\n    }\r\n    this.cell.style.display = \"none\";\r\n    this.conf.visible = false;\r\n    if (!this.acc.conf.multi_mode) {\r\n        this.acc.conf.hiden_count++;\r\n        this.acc._updateCellsHeight();\r\n        this.acc._updateCellsMargin()\r\n    }\r\n    this.acc._adjustOpened()\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.isVisible = function() {\r\n    return ( this.conf.visible == true) \r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.setHeight = function(a) {\r\n    if (!this.acc.conf.multi_mode) {\r\n        return\r\n    }\r\n    if (a == \"*\") {\r\n        this.conf.h_auto = true\r\n    } else {\r\n        this.conf.h_auto = false;\r\n        this.conf.size.h = a\r\n    }\r\n    if (this.conf.opened) {\r\n        if (a != \"*\") {\r\n            this.cell.style.height = a + \"px\"\r\n        }\r\n        this.acc._adjustOpened()\r\n    }\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype.moveOnTop = function() {\r\n    if (this.cell.parentNode.firstChild == this.cell) {\r\n        return\r\n    }\r\n    this.cell.parentNode.insertBefore(this.cell, this.cell.parentNode.firstChild);\r\n    this.acc._updateCellsMargin()\r\n}\r\n;\r\ndhtmlXAccordionCell.prototype._initDocking = function() {\r\n    var a = this;\r\n    this.dock = function() {\r\n        if (this.acc.dhxWins == null  || this.conf.docked == true) {\r\n            return\r\n        }\r\n        var c = this.acc.dhxWins.window(this._idd);\r\n        c.close();\r\n        this._attachFromCell(c);\r\n        this.conf.docked = true;\r\n        this.show();\r\n        if (this.conf.dock_opened) {\r\n            this.open()\r\n        }\r\n        c = null ;\r\n        this.acc._callMainEvent(\"onDock\", [this._idd])\r\n    }\r\n    ;\r\n    this.undock = function(c, m, g, l) {\r\n        if (this.acc.dhxWins == null  || this.conf.docked == false) {\r\n            return\r\n        }\r\n        this.conf.dock_opened = this.conf.opened;\r\n        if (this.acc.dhxWins.window(this._idd) != null ) {\r\n            var e = this.acc.dhxWins.window(this._idd);\r\n            e.show()\r\n        } else {\r\n            if (c == null ) {\r\n                c = 20\r\n            }\r\n            if (m == null ) {\r\n                m = 20\r\n            }\r\n            if (g == null ) {\r\n                g = 320\r\n            }\r\n            if (l == null ) {\r\n                l = 200\r\n            }\r\n            var e = this.acc.dhxWins.createWindow(this._idd, c, m, g, l);\r\n            e.button(\"close\").hide();\r\n            e.addUserButton(\"dock\", 99, \"Dock\");\r\n            e.button(\"dock\").show();\r\n            e.button(\"dock\").attachEvent(\"onClick\", this._doOnDockClick);\r\n            e.setText(this.getText());\r\n            e.attachEvent(\"onClose\", this._doOnDockWinClose)\r\n        }\r\n        this.conf.docked = false;\r\n        this.hide();\r\n        e._attachFromCell(this);\r\n        e = null ;\r\n        this.acc._callMainEvent(\"onUnDock\", [this._idd])\r\n    }\r\n    ;\r\n    this._doOnDockClick = function() {\r\n        a.dock()\r\n    }\r\n    ;\r\n    this._doOnDockWinClose = function(c) {\r\n        c.hide();\r\n        return false\r\n    }\r\n    ;\r\n    this._unloadDocking = function() {\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachAccordion = function(a) {\r\n    this.callEvent(\"_onBeforeContentAttach\", [\"acc\"]);\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.width = \"100%\";\r\n    c.style.height = \"100%\";\r\n    c.style.position = \"relative\";\r\n    this._attachObject(c);\r\n    if (typeof (a) == \"undefined\") {\r\n        a = {}\r\n    }\r\n    if (typeof (a.skin) == \"undefined\") {\r\n        a.skin = this.conf.skin\r\n    }\r\n    a.parent = c;\r\n    if (typeof (window.dhtmlXAccordionCell) == \"function\" && this instanceof window.dhtmlXAccordionCell) {\r\n        c._ofs = {\r\n            s: {\r\n                first: -1\r\n            },\r\n            m: {\r\n                first: 4\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXTabBarCell) == \"function\" && this instanceof window.dhtmlXTabBarCell) {\r\n        if (this.conf.skin == \"dhx_skyblue\") {\r\n            c._ofs = {\r\n                t: -1,\r\n                r: -1,\r\n                b: -1,\r\n                l: -1\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXSideBarCell) == \"function\" && this instanceof window.dhtmlXSideBarCell) {\r\n        if (this.conf.skin == \"dhx_web\") {\r\n            c._ofs = {};\r\n            if (this.sidebar.conf.autohide != true) {\r\n                c._ofs.l = 2\r\n            }\r\n            if (this.sidebar.conf.header == true) {\r\n                c._ofs.t = 3\r\n            }\r\n        } else {\r\n            c._ofs = {\r\n                l: -1\r\n            };\r\n            if (this.conf.skin == \"dhx_terrace\") {\r\n                if (this.sidebar.conf.autohide == true) {\r\n                    c._ofs.l = 0\r\n                }\r\n                if (this.sidebar.conf.header == true) {\r\n                    c._ofs.t = -1\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXCarouselCell) == \"function\" && this instanceof window.dhtmlXCarouselCell) {\r\n        this._hideBorders()\r\n    }\r\n    this.dataType = \"acc\";\r\n    this.dataObj = new dhtmlXAccordion(a);\r\n    a.parent = null ;\r\n    c = a = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\ndhtmlXAccordion.prototype.enableDND = function() {\r\n    if (this.conf.multi_mode == false || this._dnd != null ) {\r\n        return\r\n    }\r\n    var e = this;\r\n    this._dnd = {\r\n        tr_count: 0,\r\n        tr_items: {}\r\n    };\r\n    this._dndAttachEvent = function(g) {\r\n        var a = this.t[g].cell;\r\n        if (a.conf.dnd_inited != true) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                a.cell.childNodes[a.conf.idx.hdr].addEventListener(\"mousedown\", this._dndOnMouseDown, false)\r\n            } else {\r\n                a.cell.childNodes[a.conf.idx.hdr].attachEvent(\"onmousedown\", this._dndOnMouseDown)\r\n            }\r\n            a.conf.dnd_inited = true\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._dndDetachEvent = function(g) {\r\n        var a = this.t[g].cell;\r\n        if (a.conf.dnd_inited == true) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                a.cell.childNodes[a.conf.idx.hdr].removeEventListener(\"mousedown\", this._dndOnMouseDown, false)\r\n            } else {\r\n                a.cell.childNodes[a.conf.idx.hdr].detachEvent(\"onmousedown\", this._dndOnMouseDown)\r\n            }\r\n            a.conf.dnd_inited = false\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._dndOnMouseDown = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        }\r\n        var a = (g.target || g.srcElement);\r\n        while (a != null  && a.parentNode != e.cont) {\r\n            a = a.parentNode\r\n        }\r\n        if (a != null ) {\r\n            e._dndDragStart(g, a)\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this._dndDragStart = function(m, h) {\r\n        if (this._dnd.tr_waiting == true) {\r\n            return\r\n        }\r\n        var a = -1;\r\n        for (var l = 0; l < h.parentNode.childNodes.length; l++) {\r\n            if (h.parentNode.childNodes[l] == h) {\r\n                a = l\r\n            }\r\n        }\r\n        if (this.callEvent(\"onBeforeDrag\", [h._accId, a]) !== true) {\r\n            return\r\n        }\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            document.body.addEventListener(\"mousemove\", this._dndOnMouseMove, false);\r\n            document.body.addEventListener(\"mouseup\", this._dndOnMouseUp, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousemove\", this._dndOnMouseMove, false);\r\n            document.body.attachEvent(\"onmouseup\", this._dndOnMouseUp, false)\r\n        }\r\n        this._dnd.dragObj = h;\r\n        this._dnd.dy = m.clientY;\r\n        var g = 0;\r\n        for (var l = 0; l < this._dnd.dragObj.parentNode.childNodes.length; l++) {\r\n            this._dnd.dragObj.parentNode.childNodes[l]._ind = l;\r\n            if (this._dnd.dragObj.parentNode.childNodes[l] == this._dnd.dragObj) {\r\n                this._dnd.dragObj._k0 = g;\r\n                if (l > 0) {\r\n                    this._dnd.dragObj._k0 += this.ofs.m.between - this.ofs.m.first\r\n                }\r\n                g = 0\r\n            } else {\r\n                g += this._dnd.dragObj.parentNode.childNodes[l].offsetHeight + parseInt(this._dnd.dragObj.parentNode.childNodes[l].style.marginTop)\r\n            }\r\n        }\r\n        this._dnd.dragObj._k1 = g;\r\n        this._dnd.h = this._dnd.dragObj.offsetHeight;\r\n        this._dnd.ofs = false\r\n    }\r\n    ;\r\n    this._dndDoDrag = function(u) {\r\n        if (!this._dnd.dragObj) {\r\n            return\r\n        }\r\n        if (this._dnd.tr_waiting == true) {\r\n            return\r\n        }\r\n        var m = u.clientY - this._dnd.dy;\r\n        if (this._dnd.ofs == false && Math.abs(m) > 5) {\r\n            this._dnd.dragObj.className += \" acc_cell_dragged\";\r\n            this._dnd.ofs = true\r\n        }\r\n        if (m < 0) {\r\n            if (m < -this._dnd.dragObj._k0) {\r\n                m = -this._dnd.dragObj._k0\r\n            }\r\n        } else {\r\n            if (m > this._dnd.dragObj._k1) {\r\n                m = this._dnd.dragObj._k1\r\n            }\r\n        }\r\n        this._dnd.dragObj.style.top = m + \"px\";\r\n        var o = u.clientY - this._dnd.dy;\r\n        var l = 0;\r\n        var g = 0;\r\n        for (var n = this._dnd.dragObj._ind + 1; n <= this._dnd.dragObj.parentNode.lastChild._ind; n++) {\r\n            var a = this._dnd.dragObj.parentNode.childNodes[n].offsetHeight;\r\n            if (o > l + a * 2 / 3) {\r\n                g++\r\n            }\r\n            l += a\r\n        }\r\n        var h = this._dnd.dragObj.nextSibling;\r\n        var n = 0;\r\n        while (h != null ) {\r\n            if (++n <= g && h != null ) {\r\n                if (!h._ontop) {\r\n                    if (h._tm) {\r\n                        window.clearTimeout(h._tm)\r\n                    }\r\n                    this._dndAnim(h, false, parseInt(h.style.top || 0), -this._dnd.h - this.ofs.m.between);\r\n                    h._ontop = true\r\n                }\r\n            } else {\r\n                if (h._ontop) {\r\n                    if (h._tm) {\r\n                        window.clearTimeout(h._tm)\r\n                    }\r\n                    this._dndAnim(h, true, parseInt(h.style.top || 0), 0);\r\n                    h._ontop = false\r\n                }\r\n            }\r\n            h = h.nextSibling\r\n        }\r\n        var o = this._dnd.dy - u.clientY;\r\n        var l = 0;\r\n        var g = 0;\r\n        for (var n = this._dnd.dragObj._ind - 1; n >= this._dnd.dragObj.parentNode.firstChild._ind; n--) {\r\n            var a = this._dnd.dragObj.parentNode.childNodes[n].offsetHeight;\r\n            if (o > l + a * 2 / 3) {\r\n                g++\r\n            }\r\n            l += a\r\n        }\r\n        var h = this._dnd.dragObj.previousSibling;\r\n        var n = 0;\r\n        while (h != null ) {\r\n            if (++n <= g && h != null ) {\r\n                if (!h._onbottom) {\r\n                    if (h._tm) {\r\n                        window.clearTimeout(h._tm)\r\n                    }\r\n                    this._dndAnim(h, true, parseInt(h.style.top || 0), this._dnd.h + this.ofs.m.between);\r\n                    h._onbottom = true\r\n                }\r\n            } else {\r\n                if (h._onbottom) {\r\n                    if (h._tm) {\r\n                        window.clearTimeout(h._tm)\r\n                    }\r\n                    this._dndAnim(h, false, parseInt(h.style.top), 0);\r\n                    h._onbottom = false\r\n                }\r\n            }\r\n            h = h.previousSibling\r\n        }\r\n    }\r\n    ;\r\n    this._dndDragStop = function(o, m) {\r\n        if (m) {} else {\r\n            if (this._dnd.tr_count > 0) {\r\n                this._dnd.tr_waiting = true;\r\n                return\r\n            }\r\n        }\r\n        if (!this._dnd.dragObj) {\r\n            return\r\n        }\r\n        this._dnd.dragObj.className = String(this._dnd.dragObj.className).replace(/\\s{0,}acc_cell_dragged/gi, \"\");\r\n        this._dnd.dragObj.style.top = \"0px\";\r\n        var n = false;\r\n        for (var l = 0; l < this._dnd.dragObj.parentNode.childNodes.length; l++) {\r\n            var h = this._dnd.dragObj.parentNode.childNodes[l];\r\n            if (h != this._dnd.dragObj) {\r\n                if (h._tm) {\r\n                    window.clearTimeout(h._tm)\r\n                }\r\n                h.style.top = \"0px\";\r\n                if (h._ontop && ((h.nextSibling != null  && h.nextSibling._ontop != true) || !h.nextSibling)) {\r\n                    n = (h.nextSibling || null )\r\n                }\r\n                if (h._onbottom && ((h.previousSibling != null  && h.previousSibling._onbottom != true) || !h.previousSibling)) {\r\n                    n = h\r\n                }\r\n            }\r\n            h = null \r\n        }\r\n        for (var l = 0; l < this._dnd.dragObj.parentNode.childNodes.length; l++) {\r\n            this._dnd.dragObj.parentNode.childNodes[l]._ontop = null ;\r\n            this._dnd.dragObj.parentNode.childNodes[l]._onbottom = null \r\n        }\r\n        if (n !== false) {\r\n            if (n == null ) {\r\n                this._dnd.dragObj.parentNode.appendChild(this._dnd.dragObj)\r\n            } else {\r\n                this._dnd.dragObj.parentNode.insertBefore(this._dnd.dragObj, n)\r\n            }\r\n        }\r\n        var r = this._dnd.dragObj._accId;\r\n        var g = this._dnd.dragObj._ind;\r\n        var a = g;\r\n        for (var l = 0; l < this._dnd.dragObj.parentNode.childNodes.length; l++) {\r\n            if (this._dnd.dragObj.parentNode.childNodes[l] == this._dnd.dragObj) {\r\n                a = l\r\n            }\r\n        }\r\n        this._dnd.dragObj = null ;\r\n        this._dnd.tr_waiting = false;\r\n        this._updateCellsMargin();\r\n        if (g != a) {\r\n            this.setSizes();\r\n            this.callEvent(\"onDrop\", [r, g, a])\r\n        }\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            document.body.removeEventListener(\"mousemove\", this._dndOnMouseMove, false);\r\n            document.body.removeEventListener(\"mouseup\", this._dndOnMouseUp, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousemove\", this._dndOnMouseMove, false);\r\n            document.body.detachEvent(\"onmouseup\", this._dndOnMouseUp, false)\r\n        }\r\n    }\r\n    ;\r\n    this._dndAnim = function(m, a, l, h) {\r\n        if (this.conf.tr.prop != false) {\r\n            if (!m._dnd_ev) {\r\n                m._dnd_ev = true;\r\n                m._dnd_tr_prop = this.conf.tr.prop;\r\n                m.addEventListener(this.conf.tr.ev, this._dndOnTrEnd, false)\r\n            }\r\n            if (this._dnd.tr_items[m._accId] != true) {\r\n                this._dnd.tr_items[m._accId] = true;\r\n                this._dnd.tr_count++\r\n            }\r\n            m.style[this.conf.tr.prop] = this.conf.tr.dnd_top;\r\n            m.style.top = h + \"px\";\r\n            return\r\n        }\r\n        var g = false;\r\n        if (a) {\r\n            l += 5;\r\n            if (l >= h) {\r\n                l = h;\r\n                g = true\r\n            }\r\n        } else {\r\n            l -= 5;\r\n            if (l <= h) {\r\n                l = h;\r\n                g = true\r\n            }\r\n        }\r\n        m.style.top = l + \"px\";\r\n        if (m._tm) {\r\n            window.clearTimeout(m._tm)\r\n        }\r\n        if (!g) {\r\n            m._tm = window.setTimeout(function() {\r\n                e._dndAnim(m, a, l, h)\r\n            }, 5)\r\n        } else {\r\n            m._tm = null \r\n        }\r\n    }\r\n    ;\r\n    this._dndOnTrEnd = function(a) {\r\n        if (a.stopPropagation) {\r\n            a.stopPropagation()\r\n        }\r\n        if (a.propertyName == \"top\") {\r\n            if (e._dnd.tr_items[this._accId] == true) {\r\n                e._dnd.tr_count--;\r\n                e._dnd.tr_items[this._accId] = false\r\n            }\r\n            this.style[this._dnd_tr_prop] = \"\";\r\n            if (e._dnd.tr_count == 0 && e._dnd.tr_waiting == true) {\r\n                e._dndDragStop(null , true)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._dndOnMouseMove = function(a) {\r\n        e._dndDoDrag(a || event)\r\n    }\r\n    ;\r\n    this._dndOnMouseUp = function(a) {\r\n        e._dndDragStop(a || event)\r\n    }\r\n    ;\r\n    this._dndClearCell = function(a) {\r\n        if (this.t[a].cell.cell._dnd_ev) {\r\n            this.t[a].cell.cell.addEventListener(this.conf.tr.ev, this._dndOnTrEnd, false)\r\n        }\r\n        this._dndDetachEvent(a)\r\n    }\r\n    ;\r\n    this._unloadDND = function() {\r\n        for (var g in this) {\r\n            if (String(g).indexOf(\"_dnd\") == 0 && typeof (this[g]) == \"function\") {\r\n                this[g] = null \r\n            }\r\n        }\r\n        this._dnd = null ;\r\n        e = null \r\n    }\r\n    ;\r\n    for (var c in this.t) {\r\n        this._dndAttachEvent(c)\r\n    }\r\n}\r\n;\r\nfunction dhtmlXLayoutObject(e, o, w) {\r\n    var u = null ;\r\n    if (e != null  && typeof (e) == \"object\" && typeof (e.tagName) == \"undefined\" && e._isCell != true) {\r\n        u = {};\r\n        if (e.autosize != null ) {\r\n            u.autosize = e.autosize\r\n        }\r\n        if (e.cells != null ) {\r\n            u.cells = e.cells\r\n        }\r\n        if (e.pattern != null ) {\r\n            o = e.pattern\r\n        }\r\n        if (e.skin != null ) {\r\n            w = e.skin\r\n        }\r\n        if (e.offsets != null ) {\r\n            u.offsets = e.offsets\r\n        }\r\n        e = e.parent\r\n    }\r\n    this.cdata = {};\r\n    this.conf = {\r\n        skin: (w || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxlayout\") || \"dhx_skyblue\"),\r\n        css: \"dhxlayout\",\r\n        hh: 20,\r\n        autosize: \"b\",\r\n        nextCell: {\r\n            a: \"b\",\r\n            b: \"a\"\r\n        },\r\n        inited: false,\r\n        b_size: {\r\n            w: -1,\r\n            h: -1\r\n        }\r\n    };\r\n    if (typeof (e) == \"object\" && e._isCell == true) {\r\n        var n = (typeof (u) != \"undefined\" && u != null  ? u : {});\r\n        if (n.pattern == null  && o != null ) {\r\n            n.pattern = o\r\n        }\r\n        if (n.skin == null  && w != null ) {\r\n            n.skin = w\r\n        }\r\n        var l = e.attachLayout(n);\r\n        return l\r\n    }\r\n    window.dhtmlXCellTop.apply(this, [e, (u == null  ? null  : u.offsets)]);\r\n    this.conf.sw = this._detectSW();\r\n    var m = this;\r\n    this._getLayout = function() {\r\n        return this\r\n    }\r\n    ;\r\n    this.mainInst = (e._layoutMainInst != null  ? e._layoutMainInst : null );\r\n    this._getMainInst = function() {\r\n        if (this.mainInst != null ) {\r\n            return this.mainInst._getMainInst()\r\n        }\r\n        return this\r\n    }\r\n    ;\r\n    this._init = function(C) {\r\n        var A = (typeof (C) == \"string\" ? this.tplData[C] : C);\r\n        this.conf.mode = A.mode;\r\n        if (this.conf.mode == \"c\") {\r\n            this.cdata.a = new dhtmlXLayoutCell(\"a\",this)\r\n        } else {\r\n            this.cdata.a = new dhtmlXLayoutCell(\"a\",this);\r\n            this.cdata.b = new dhtmlXLayoutCell(\"b\",this)\r\n        }\r\n        for (var y in this.cdata) {\r\n            this.cont.appendChild(this.cdata[y].cell);\r\n            this.cdata[y].conf.init = {\r\n                w: 0.5,\r\n                h: 0.5\r\n            }\r\n        }\r\n        if (this.conf.mode != \"c\") {\r\n            var x = this._getMainInst();\r\n            if (x.conf.sep_idx == null ) {\r\n                x.conf.sep_idx = 1\r\n            } else {\r\n                x.conf.sep_idx++\r\n            }\r\n            this.sep = new dhtmlXLayoutSepObject(this.conf.mode,x.conf.sep_idx);\r\n            this.cont.appendChild(this.sep.sep);\r\n            this.sep._getLayout = function() {\r\n                return m._getLayout()\r\n            }\r\n            ;\r\n            x = null \r\n        }\r\n        if (A.cells != null ) {\r\n            for (var y in A.cells) {\r\n                if (A.cells[y].width != null ) {\r\n                    this.cdata[y].conf.init.w = A.cells[y].width\r\n                }\r\n                if (A.cells[y].height != null ) {\r\n                    this.cdata[y].conf.init.h = A.cells[y].height\r\n                }\r\n                if (A.cells[y].name != null ) {\r\n                    this.cdata[y].conf.name = A.cells[y].name;\r\n                    this.cdata[y].setText(A.cells[y].name)\r\n                }\r\n                if (A.cells[y].fsize != null ) {\r\n                    this.cdata[y].conf.fsize = A.cells[y].fsize\r\n                }\r\n            }\r\n        }\r\n        this.setSizes();\r\n        for (var y in this.cdata) {\r\n            this.cdata[y].conf.init = {}\r\n        }\r\n        if (A.cells != null ) {\r\n            for (var y in A.cells) {\r\n                if (A.cells[y].layout != null ) {\r\n                    this.cdata[y].dataNested = true;\r\n                    this.cdata[y]._layoutMainInst = this;\r\n                    this.cdata[y].attachLayout({\r\n                        pattern: A.cells[y].layout\r\n                    });\r\n                    this.cdata[y]._layoutMainInst = null \r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.setSizes = function(F, N, J, y) {\r\n        var H = (this.conf.inited == true && this._getMainInst() == this && this.checkEvent(\"onResizeFinish\") == true ? {} : false);\r\n        this._adjustCont();\r\n        var M = this.cont.offsetWidth;\r\n        var D = this.cont.offsetHeight;\r\n        if (this.conf.mode == \"c\") {\r\n            var a = 0;\r\n            var O = 0;\r\n            var x = M;\r\n            var L = D;\r\n            this.cdata.a._setSize(a, O, x, L, F, J, y);\r\n            this.callEvent(\"_onSetSizes\", []);\r\n            if (H && (!(this.conf.b_size.w == M && this.conf.b_size.h == D))) {\r\n                this._callMainEvent(\"onResizeFinish\", [])\r\n            }\r\n            this.conf.b_size = {\r\n                w: M,\r\n                h: D\r\n            };\r\n            return\r\n        }\r\n        if (typeof (N) == \"undefined\") {\r\n            var A = (this.conf.mode == \"v\" ? \"w\" : \"h\");\r\n            N = this.conf.autosize;\r\n            if (this.cdata.a.conf.collapsed) {\r\n                N = \"b\"\r\n            } else {\r\n                if (this.cdata.b.conf.collapsed) {\r\n                    N = \"a\"\r\n                } else {\r\n                    if (F == \"a\" || F == \"b\") {\r\n                        N = this.conf.nextCell[F]\r\n                    }\r\n                }\r\n            }\r\n        } else {}\r\n        if (this.conf.mode == \"v\") {\r\n            if (N == \"a\") {\r\n                if (this.cdata.b.conf.init.w != null ) {\r\n                    var K = Math.round(M * this.cdata.b.conf.init.w - this.conf.sw / 2)\r\n                } else {\r\n                    var K = this.cdata.b.conf.size.w\r\n                }\r\n                var I = M - K;\r\n                var E = 0;\r\n                var C = D;\r\n                var a = 0;\r\n                var O = E;\r\n                var x = I - a - this.conf.sw;\r\n                var L = C\r\n            } else {\r\n                var a = 0;\r\n                var O = 0;\r\n                if (this.cdata.a.conf.init.w != null ) {\r\n                    var x = Math.round(M * this.cdata.a.conf.init.w - this.conf.sw / 2) - a\r\n                } else {\r\n                    var x = this.cdata.a.conf.size.w\r\n                }\r\n                var L = D - O;\r\n                var I = a + x + this.conf.sw;\r\n                var E = O;\r\n                var K = M - I;\r\n                var C = L\r\n            }\r\n            this.cdata.a._setSize(a, O, x, L, F, J, y);\r\n            this.cdata.b._setSize(I, E, K, C, F, J, y);\r\n            this.sep._setSize(a + x, O, this.conf.sw, L)\r\n        } else {\r\n            if (N == \"a\") {\r\n                if (this.cdata.b.conf.init.h != null ) {\r\n                    var C = Math.round(D * this.cdata.b.conf.init.h - this.conf.sw / 2)\r\n                } else {\r\n                    var C = this.cdata.b.conf.size.h\r\n                }\r\n                var I = 0;\r\n                var E = D - C;\r\n                var K = M - I;\r\n                var a = I;\r\n                var O = 0;\r\n                var x = K;\r\n                var L = E - O - this.conf.sw\r\n            } else {\r\n                var a = 0;\r\n                var O = 0;\r\n                var x = M - a;\r\n                if (this.cdata.a.conf.init.h != null ) {\r\n                    var L = Math.round(D * this.cdata.a.conf.init.h - this.conf.sw / 2)\r\n                } else {\r\n                    var L = this.cdata.a.conf.size.h\r\n                }\r\n                var I = a;\r\n                var E = O + L + this.conf.sw;\r\n                var K = x;\r\n                var C = D - E\r\n            }\r\n            this.cdata.a._setSize(a, O, x, L, F, J, y);\r\n            this.cdata.b._setSize(I, E, K, C, F, J, y);\r\n            this.sep._setSize(a, O + L, x, this.conf.sw)\r\n        }\r\n        this.callEvent(\"_onSetSizes\", []);\r\n        if (H && (!(this.conf.b_size.w == M && this.conf.b_size.h == D))) {\r\n            this._callMainEvent(\"onResizeFinish\", [])\r\n        }\r\n        this.conf.b_size = {\r\n            w: M,\r\n            h: D\r\n        }\r\n    }\r\n    ;\r\n    this._getAvailWidth = function() {\r\n        var A = [];\r\n        for (var E = 0; E < this.conf.as_cells.h.length; E++) {\r\n            var x = this.cells(this.conf.as_cells.h[E]);\r\n            var C = x.layout;\r\n            var y = C.conf.autosize;\r\n            if (x.conf.collapsed) {\r\n                x = C.cdata[C.conf.nextCell[x._idd]];\r\n                y = C.conf.nextCell[y]\r\n            }\r\n            A.push(Math.max(0, x.getWidth() - x._getMinWidth(y)));\r\n            C = x = null \r\n        }\r\n        var D = (A.length > 0 ? Math.min.apply(window, A) : 0);\r\n        return this.cont.offsetWidth - D\r\n    }\r\n    ;\r\n    this._getAvailHeight = function() {\r\n        var C = [];\r\n        for (var E = 0; E < this.conf.as_cells.v.length; E++) {\r\n            var x = this.cells(this.conf.as_cells.v[E]);\r\n            var A = x.layout;\r\n            var y = A.conf.autosize;\r\n            if (x.conf.collapsed) {\r\n                x = A.cdata[A.conf.nextCell[x._idd]];\r\n                y = A.conf.nextCell[y]\r\n            }\r\n            C.push(Math.max(0, x.getHeight() - x._getHdrHeight() - x._getMinHeight(y)));\r\n            A = x = null \r\n        }\r\n        var D = Math.min.apply(window, C);\r\n        return this.cont.offsetHeight - D\r\n    }\r\n    ;\r\n    this.setSkin = function(a) {\r\n        this._setBaseSkin(a);\r\n        this.conf.skin = a\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this.conf.unloading = true;\r\n        this.mainInst = null ;\r\n        this.parentLayout = null ;\r\n        if (this.items != null ) {\r\n            for (var y = 0; y < this.items.length; y++) {\r\n                this.items[y] = null \r\n            }\r\n            this.items = null \r\n        }\r\n        if (this.dhxWins != null ) {\r\n            this.dhxWins.unload();\r\n            this.dhxWins = null \r\n        }\r\n        if (this.sep != null ) {\r\n            this.sep._unload();\r\n            this.sep = null \r\n        }\r\n        for (var x in this.cdata) {\r\n            this.cdata[x]._unload();\r\n            this.cdata[x] = null \r\n        }\r\n        this._unloadTop();\r\n        window.dhx4._eventable(this, \"clear\");\r\n        for (var x in this) {\r\n            this[x] = null \r\n        }\r\n        m = null \r\n    }\r\n    ;\r\n    this._getWindowMinDimension = function(A) {\r\n        var a = m._getAvailWidth() + 7 + 7;\r\n        var y = m._getAvailHeight() + 7 + 31;\r\n        var x = {\r\n            w: Math.max(a, 200),\r\n            h: Math.max(y, 140)\r\n        };\r\n        A = null ;\r\n        return x\r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    this._callMainEvent = function(x, a) {\r\n        return this.callEvent(x, a)\r\n    }\r\n    ;\r\n    this._init(o || \"3E\");\r\n    var r = this._availAutoSize[o];\r\n    if (r != null ) {\r\n        this.conf.pattern = o;\r\n        this.setAutoSize(r.h[r.h.length - 1], r.v[r.v.length - 1])\r\n    }\r\n    if (typeof (window.dhtmlXWindows) == \"function\" && this.mainInst == null ) {\r\n        var g = {\r\n            vp_overflow: (this.conf.fs_mode == true ? false : \"auto\")\r\n        };\r\n        this.dhxWins = new dhtmlXWindows(g);\r\n        this.dhxWins.setSkin(this.conf.skin)\r\n    }\r\n    this.conf.inited = true;\r\n    if (this == this._getMainInst()) {\r\n        var s = 0;\r\n        this.items = [];\r\n        this.forEachItem(function(a) {\r\n            m.items.push(a);\r\n            a.conf.index = s++\r\n        })\r\n    }\r\n    if (this == this._getMainInst() && u != null ) {\r\n        if (u.autosize != null ) {\r\n            this.setAutoSize.apply(this, u.autosize)\r\n        }\r\n        if (u.cells != null ) {\r\n            for (var c = 0; c < u.cells.length; c++) {\r\n                var h = u.cells[c];\r\n                var v = this.cells(h.id);\r\n                if (h.width) {\r\n                    v.setWidth(h.width)\r\n                }\r\n                if (h.height) {\r\n                    v.setHeight(h.height)\r\n                }\r\n                if (h.text) {\r\n                    v.setText(h.text)\r\n                }\r\n                if (h.collapsed_text) {\r\n                    v.setCollapsedText(h.collapsed_text)\r\n                }\r\n                if (h.collapse) {\r\n                    v.collapse()\r\n                }\r\n                if (h.fix_size) {\r\n                    v.fixSize(h.fix_size[0], h.fix_size[1])\r\n                }\r\n                if (typeof (h.header) != \"undefined\" && window.dhx4.s2b(h.header) == false) {\r\n                    v.hideHeader()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    u = null ;\r\n    return this\r\n}\r\ndhtmlXLayoutObject.prototype = new dhtmlXCellTop();\r\ndhtmlXLayoutObject.prototype.cells = function(g) {\r\n    for (var c in this.cdata) {\r\n        if (this.cdata[c].conf.name == g) {\r\n            return this.cdata[c]\r\n        }\r\n        if (this.cdata[c].dataType == \"layout\" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null ) {\r\n            var e = this.cdata[c].dataObj.cells(g);\r\n            if (e != null ) {\r\n                return e\r\n            }\r\n        }\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXLayoutObject.prototype.forEachItem = function(g, e) {\r\n    if (typeof (g) != \"function\") {\r\n        return\r\n    }\r\n    if (typeof (e) == \"undefined\") {\r\n        e = this\r\n    }\r\n    for (var c in this.cdata) {\r\n        if (typeof (this.cdata[c].conf.name) != \"undefined\") {\r\n            g.apply(e, [this.cdata[c]])\r\n        }\r\n        if (this.cdata[c].dataType == \"layout\" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null ) {\r\n            this.cdata[c].dataObj.forEachItem(g, e)\r\n        }\r\n    }\r\n    e = null \r\n}\r\n;\r\ndhtmlXLayoutObject.prototype._forEachSep = function(g, e) {\r\n    if (typeof (g) != \"function\") {\r\n        return\r\n    }\r\n    if (typeof (e) == \"undefined\") {\r\n        e = this\r\n    }\r\n    if (this.sep != null ) {\r\n        g.apply(e, [this.sep])\r\n    }\r\n    for (var c in this.cdata) {\r\n        if (this.cdata[c].dataType == \"layout\" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null ) {\r\n            this.cdata[c].dataObj._forEachSep(g, e)\r\n        }\r\n    }\r\n    e = null \r\n}\r\n;\r\ndhtmlXLayoutObject.prototype._detectSW = function() {\r\n    if (this._confGlob.sw == null ) {\r\n        this._confGlob.sw = {}\r\n    }\r\n    if (this._confGlob.sw[this.conf.skin] == null ) {\r\n        this._confGlob.sw[this.conf.skin] = window.dhx4.readFromCss(\"dhxlayout_sep_sw_\" + this.conf.skin)\r\n    }\r\n    return this._confGlob.sw[this.conf.skin]\r\n}\r\n;\r\ndhtmlXLayoutObject.prototype._confGlob = {};\r\ndhtmlXLayoutObject.prototype.listPatterns = function() {\r\n    var e = [];\r\n    for (var c in this.tplData) {\r\n        e.push(c)\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXLayoutObject.prototype.listAutoSizes = function() {\r\n    var g = (this.conf.as_cells != null  ? (this.conf.as_cells.h).join(\";\") : \"\");\r\n    var e = (this.conf.as_cells != null  ? (this.conf.as_cells.v).join(\";\") : \"\");\r\n    var c = this._availAutoSize[this.conf.pattern].h;\r\n    var a = this._availAutoSize[this.conf.pattern].v;\r\n    return [g, e, c, a]\r\n}\r\n;\r\ndhtmlXLayoutObject.prototype._getCellsNames = function(g) {\r\n    var h = {};\r\n    if (this.cdata[g].conf.name != null ) {\r\n        h[this.cdata[g].conf.name] = true\r\n    }\r\n    if (this.cdata[g].dataType == \"layout\" && this.cdata[g].dataObj != null  && this.cdata[g].dataObj.mainInst == this) {\r\n        var c = this.cdata[g].dataObj._getCellsNames(\"a\");\r\n        var l = this.cdata[g].dataObj._getCellsNames(\"b\");\r\n        for (var e in c) {\r\n            h[e] = c[e]\r\n        }\r\n        for (var e in l) {\r\n            h[e] = l[e]\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXLayoutObject.prototype.setAutoSize = function(c, o, r) {\r\n    if (r !== true) {\r\n        var v = this.listAutoSizes();\r\n        if (v[0] == c && v[1] == o) {\r\n            return\r\n        }\r\n        var n = false;\r\n        var l = false;\r\n        for (var e = 0; e < v[2].length; e++) {\r\n            n = n || v[2][e] == c\r\n        }\r\n        for (var e = 0; e < v[3].length; e++) {\r\n            l = l || v[3][e] == o\r\n        }\r\n        if (!n || !l) {\r\n            return\r\n        }\r\n    }\r\n    this.conf.as_cells = {\r\n        h: c.split(\";\"),\r\n        v: o.split(\";\")\r\n    };\r\n    var g = (this.conf.mode == \"v\" ? \"h\" : \"v\");\r\n    for (var u in this.cdata) {\r\n        var h = this._getCellsNames(u);\r\n        var w = false;\r\n        for (var e = 0; e < this.conf.as_cells[g].length; e++) {\r\n            w = w || h[this.conf.as_cells[g][e]]\r\n        }\r\n        if (w) {\r\n            this.conf.autosize = u\r\n        }\r\n        if (this.cdata[u].dataType == \"layout\" && this.cdata[u].dataObj != null ) {\r\n            this.cdata[u].dataObj.setAutoSize(c, o, true)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXLayoutObject.prototype.tplData = {\r\n    \"1C\": {\r\n        mode: \"c\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\"\r\n            }\r\n        }\r\n    },\r\n    \"2E\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                name: \"b\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"2U\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                name: \"b\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"3E\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                height: 1 / 3,\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                v: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"3W\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 3,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                h: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"3J\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                name: \"b\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"3L\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"3T\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"3U\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                name: \"c\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4H\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 3,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        fsize: {\r\n                                            h: [1, 2],\r\n                                            v: 3\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: [1, 2],\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"d\",\r\n                            fsize: {\r\n                                h: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4I\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                height: 1 / 3,\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: [1, 2]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: [1, 2]\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"d\",\r\n                            fsize: {\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4T\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            width: 1 / 3,\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: [2, 3],\r\n                                            v: 1\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: 1\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4U\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            width: 1 / 3,\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        fsize: {\r\n                                            h: [2, 3],\r\n                                            v: 1\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: 1\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                name: \"d\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4E\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                height: 1 / 4,\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                v: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4W\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 4,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            width: 1 / 3,\r\n                            fsize: {\r\n                                h: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4A\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                width: 1 / 3,\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                h: [1, 3]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"d\",\r\n                            fsize: {\r\n                                h: 3\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4L\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 3,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 2,\r\n                                            v: 3\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 2,\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4J\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                height: 1 / 3,\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                v: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: 2\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: 2\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4F\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                height: 1 / 3,\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"c\",\r\n                            fsize: {\r\n                                v: [1, 3]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"d\",\r\n                            fsize: {\r\n                                v: 3\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4G\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                name: \"d\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"4C\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5H\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                width: 1 / 3,\r\n                name: \"a\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        height: 1 / 3,\r\n                                        fsize: {\r\n                                            h: [1, 2],\r\n                                            v: 3\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    fsize: {\r\n                                                        h: [1, 2],\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    name: \"d\",\r\n                                                    fsize: {\r\n                                                        h: [1, 2],\r\n                                                        v: 4\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"e\",\r\n                            fsize: {\r\n                                h: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5I\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                height: 1 / 3,\r\n                name: \"a\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        width: 1 / 3,\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: [1, 2]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"v\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    fsize: {\r\n                                                        h: [3, 4],\r\n                                                        v: [1, 2]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    name: \"d\",\r\n                                                    fsize: {\r\n                                                        h: 4,\r\n                                                        v: [1, 2]\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"e\",\r\n                            fsize: {\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5U\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            width: 1 / 4,\r\n                            fsize: {\r\n                                h: 2,\r\n                                v: 1\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        width: 1 / 3,\r\n                                        fsize: {\r\n                                            h: [2, 3],\r\n                                            v: 1\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"v\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    fsize: {\r\n                                                        h: [3, 4],\r\n                                                        v: 1\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    name: \"d\",\r\n                                                    fsize: {\r\n                                                        h: 4,\r\n                                                        v: 1\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                name: \"e\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5E\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                height: 1 / 5,\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            height: 1 / 4,\r\n                            fsize: {\r\n                                v: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        height: 1 / 3,\r\n                                        fsize: {\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"d\",\r\n                                                    fsize: {\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    name: \"e\",\r\n                                                    fsize: {\r\n                                                        v: 4\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5W\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 5,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            width: 1 / 4,\r\n                            fsize: {\r\n                                h: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        width: 1 / 3,\r\n                                        fsize: {\r\n                                            h: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"v\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"d\",\r\n                                                    fsize: {\r\n                                                        h: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    name: \"e\",\r\n                                                    fsize: {\r\n                                                        h: 4\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5K\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"d\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 4\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"e\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 4\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5S\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"c\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 3\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [3, 2]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"e\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: 4\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5G\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                width: 1 / 3,\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"c\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: 3\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"d\",\r\n                            fsize: {\r\n                                h: [1, 4]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"e\",\r\n                            fsize: {\r\n                                h: 4\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"5C\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                width: 2 / 3,\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            fsize: {\r\n                                h: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: [2, 1]\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"c\",\r\n                            height: 1 / 3,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 3\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"d\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [3, 4]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        name: \"e\",\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: 4\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6H\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                width: 1 / 3,\r\n                name: \"a\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        height: 1 / 4,\r\n                                        fsize: {\r\n                                            h: [1, 2],\r\n                                            v: 3\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    height: 1 / 3,\r\n                                                    fsize: {\r\n                                                        h: [1, 2],\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"h\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"d\",\r\n                                                                fsize: {\r\n                                                                    h: [1, 2],\r\n                                                                    v: [4, 5]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                name: \"e\",\r\n                                                                fsize: {\r\n                                                                    h: [1, 2],\r\n                                                                    v: 5\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"f\",\r\n                            fsize: {\r\n                                h: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6I\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                height: 1 / 3,\r\n                name: \"a\",\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        width: 1 / 4,\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: [1, 2]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"v\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    width: 1 / 3,\r\n                                                    fsize: {\r\n                                                        h: [3, 4],\r\n                                                        v: [1, 2]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"v\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"d\",\r\n                                                                fsize: {\r\n                                                                    h: [4, 5],\r\n                                                                    v: [1, 2]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                name: \"e\",\r\n                                                                fsize: {\r\n                                                                    h: 5,\r\n                                                                    v: [1, 2]\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"f\",\r\n                            fsize: {\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6A\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            height: 1 / 5,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        height: 1 / 4,\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    height: 1 / 3,\r\n                                                    fsize: {\r\n                                                        h: 1,\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"h\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"d\",\r\n                                                                fsize: {\r\n                                                                    h: 1,\r\n                                                                    v: [4, 5]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                name: \"e\",\r\n                                                                fsize: {\r\n                                                                    h: 1,\r\n                                                                    v: 5\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                name: \"f\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6C\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            height: 1 / 5,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        height: 1 / 4,\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"d\",\r\n                                                    height: 1 / 3,\r\n                                                    fsize: {\r\n                                                        h: 1,\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"h\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"e\",\r\n                                                                fsize: {\r\n                                                                    h: 1,\r\n                                                                    v: [4, 5]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                name: \"f\",\r\n                                                                fsize: {\r\n                                                                    h: 1,\r\n                                                                    v: 5\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6J\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                width: 1 / 3,\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"a\",\r\n                            height: 1 / 4,\r\n                            fsize: {\r\n                                h: 1,\r\n                                v: 2\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        height: 1 / 3,\r\n                                        fsize: {\r\n                                            h: 1,\r\n                                            v: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    fsize: {\r\n                                                        h: 1,\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    name: \"d\",\r\n                                                    fsize: {\r\n                                                        h: 1,\r\n                                                        v: 4\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"e\",\r\n                            fsize: {\r\n                                h: [1, 5]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"f\",\r\n                            fsize: {\r\n                                h: 5\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6E\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 3,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            fsize: {\r\n                                h: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        height: 1 / 4,\r\n                                        fsize: {\r\n                                            h: 2,\r\n                                            v: 3\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"d\",\r\n                                                    height: 1 / 3,\r\n                                                    fsize: {\r\n                                                        h: 2,\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"h\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"e\",\r\n                                                                fsize: {\r\n                                                                    h: 2,\r\n                                                                    v: [4, 5]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                name: \"f\",\r\n                                                                fsize: {\r\n                                                                    h: 2,\r\n                                                                    v: 5\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"6W\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 6,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            name: \"b\",\r\n                            width: 1 / 5,\r\n                            fsize: {\r\n                                h: [1, 2]\r\n                            }\r\n                        },\r\n                        b: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"c\",\r\n                                        width: 1 / 4,\r\n                                        fsize: {\r\n                                            h: [2, 3]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"v\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"d\",\r\n                                                    width: 1 / 3,\r\n                                                    fsize: {\r\n                                                        h: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"v\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"e\",\r\n                                                                fsize: {\r\n                                                                    h: [4, 5]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                name: \"f\",\r\n                                                                fsize: {\r\n                                                                    h: 5\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"7H\": {\r\n        mode: \"v\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                width: 1 / 3,\r\n                fsize: {\r\n                    h: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"v\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"h\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        height: 1 / 5,\r\n                                        fsize: {\r\n                                            h: [1, 2],\r\n                                            v: 3\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"h\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    height: 1 / 4,\r\n                                                    fsize: {\r\n                                                        h: [1, 2],\r\n                                                        v: [3, 4]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"h\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"d\",\r\n                                                                height: 1 / 3,\r\n                                                                fsize: {\r\n                                                                    h: [1, 2],\r\n                                                                    v: [4, 5]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                layout: {\r\n                                                                    mode: \"h\",\r\n                                                                    cells: {\r\n                                                                        a: {\r\n                                                                            name: \"e\",\r\n                                                                            fsize: {\r\n                                                                                h: [1, 2],\r\n                                                                                v: [5, 6]\r\n                                                                            }\r\n                                                                        },\r\n                                                                        b: {\r\n                                                                            name: \"f\",\r\n                                                                            fsize: {\r\n                                                                                h: [1, 2],\r\n                                                                                v: 6\r\n                                                                            }\r\n                                                                        }\r\n                                                                    }\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"g\",\r\n                            fsize: {\r\n                                h: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"7I\": {\r\n        mode: \"h\",\r\n        cells: {\r\n            a: {\r\n                name: \"a\",\r\n                height: 1 / 3,\r\n                fsize: {\r\n                    v: 1\r\n                }\r\n            },\r\n            b: {\r\n                layout: {\r\n                    mode: \"h\",\r\n                    cells: {\r\n                        a: {\r\n                            layout: {\r\n                                mode: \"v\",\r\n                                cells: {\r\n                                    a: {\r\n                                        name: \"b\",\r\n                                        width: 1 / 5,\r\n                                        fsize: {\r\n                                            h: 3,\r\n                                            v: [1, 2]\r\n                                        }\r\n                                    },\r\n                                    b: {\r\n                                        layout: {\r\n                                            mode: \"v\",\r\n                                            cells: {\r\n                                                a: {\r\n                                                    name: \"c\",\r\n                                                    width: 1 / 4,\r\n                                                    fsize: {\r\n                                                        h: [3, 4],\r\n                                                        v: [1, 2]\r\n                                                    }\r\n                                                },\r\n                                                b: {\r\n                                                    layout: {\r\n                                                        mode: \"v\",\r\n                                                        cells: {\r\n                                                            a: {\r\n                                                                name: \"d\",\r\n                                                                width: 1 / 3,\r\n                                                                fsize: {\r\n                                                                    h: [4, 5],\r\n                                                                    v: [1, 2]\r\n                                                                }\r\n                                                            },\r\n                                                            b: {\r\n                                                                layout: {\r\n                                                                    mode: \"v\",\r\n                                                                    cells: {\r\n                                                                        a: {\r\n                                                                            name: \"e\",\r\n                                                                            fsize: {\r\n                                                                                h: [5, 6],\r\n                                                                                v: [1, 2]\r\n                                                                            }\r\n                                                                        },\r\n                                                                        b: {\r\n                                                                            name: \"f\",\r\n                                                                            fsize: {\r\n                                                                                h: 6,\r\n                                                                                v: [1, 2]\r\n                                                                            }\r\n                                                                        }\r\n                                                                    }\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        b: {\r\n                            name: \"g\",\r\n                            fsize: {\r\n                                v: 2\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\ndhtmlXLayoutObject.prototype._availAutoSize = {\r\n    \"1C\": {\r\n        h: [\"a\"],\r\n        v: [\"a\"]\r\n    },\r\n    \"2E\": {\r\n        h: [\"a;b\"],\r\n        v: [\"a\", \"b\"]\r\n    },\r\n    \"2U\": {\r\n        h: [\"a\", \"b\"],\r\n        v: [\"a;b\"]\r\n    },\r\n    \"3E\": {\r\n        h: [\"a;b;c\"],\r\n        v: [\"a\", \"b\", \"c\"]\r\n    },\r\n    \"3W\": {\r\n        h: [\"a\", \"b\", \"c\"],\r\n        v: [\"a;b;c\"]\r\n    },\r\n    \"3J\": {\r\n        h: [\"a;c\", \"b\"],\r\n        v: [\"a;b\", \"b;c\"]\r\n    },\r\n    \"3L\": {\r\n        h: [\"a\", \"b;c\"],\r\n        v: [\"a;b\", \"a;c\"]\r\n    },\r\n    \"3T\": {\r\n        h: [\"a;b\", \"a;c\"],\r\n        v: [\"a\", \"b;c\"]\r\n    },\r\n    \"3U\": {\r\n        h: [\"a;c\", \"b;c\"],\r\n        v: [\"a;b\", \"c\"]\r\n    },\r\n    \"4H\": {\r\n        h: [\"a\", \"b;c\", \"d\"],\r\n        v: [\"a;b;d\", \"a;c;d\"]\r\n    },\r\n    \"4I\": {\r\n        h: [\"a;b;d\", \"a;c;d\"],\r\n        v: [\"a\", \"b;c\", \"d\"]\r\n    },\r\n    \"4T\": {\r\n        h: [\"a;b\", \"a;c\", \"a;d\"],\r\n        v: [\"a\", \"b;c;d\"]\r\n    },\r\n    \"4U\": {\r\n        h: [\"a;d\", \"b;d\", \"c;d\"],\r\n        v: [\"a;b;c\", \"d\"]\r\n    },\r\n    \"4E\": {\r\n        h: [\"a;b;c;d\"],\r\n        v: [\"a\", \"b\", \"c\", \"d\"]\r\n    },\r\n    \"4W\": {\r\n        h: [\"a\", \"b\", \"c\", \"d\"],\r\n        v: [\"a;b;c;d\"]\r\n    },\r\n    \"4A\": {\r\n        h: [\"a;b\", \"c\", \"d\"],\r\n        v: [\"a;c;d\", \"b;c;d\"]\r\n    },\r\n    \"4L\": {\r\n        h: [\"a\", \"b\", \"c;d\"],\r\n        v: [\"a;b;c\", \"a;b;d\"]\r\n    },\r\n    \"4J\": {\r\n        h: [\"a;b;c\", \"a;b;d\"],\r\n        v: [\"a\", \"b\", \"c;d\"]\r\n    },\r\n    \"4F\": {\r\n        h: [\"a;c;d\", \"b;c;d\"],\r\n        v: [\"a;b\", \"c\", \"d\"]\r\n    },\r\n    \"4G\": {\r\n        h: [\"a;b;c\", \"d\"],\r\n        v: [\"a;d\", \"b;d\", \"c;d\"]\r\n    },\r\n    \"4C\": {\r\n        h: [\"a\", \"b;c;d\"],\r\n        v: [\"a;b\", \"a;c\", \"a;d\"]\r\n    },\r\n    \"5H\": {\r\n        h: [\"a\", \"b;c;d\", \"e\"],\r\n        v: [\"a;b;e\", \"a;c;e\", \"a;d;e\"]\r\n    },\r\n    \"5I\": {\r\n        h: [\"a;b;e\", \"a;c;e\", \"a;d;e\"],\r\n        v: [\"a\", \"b;c;d\", \"e\"]\r\n    },\r\n    \"5U\": {\r\n        h: [\"a;e\", \"b;e\", \"c;e\", \"d;e\"],\r\n        v: [\"a;b;c;d\", \"e\"]\r\n    },\r\n    \"5E\": {\r\n        h: [\"a;b;c;d;e\"],\r\n        v: [\"a\", \"b\", \"c\", \"d\", \"e\"]\r\n    },\r\n    \"5W\": {\r\n        h: [\"a\", \"b\", \"c\", \"d\", \"e\"],\r\n        v: [\"a;b;c;d;e\"]\r\n    },\r\n    \"5K\": {\r\n        h: [\"a;b;c\", \"d;e\"],\r\n        v: [\"a;d\", \"b;d\", \"c;d\", \"a;e\", \"b;e\", \"c;e\"]\r\n    },\r\n    \"5S\": {\r\n        h: [\"a;b\", \"c;d;e\"],\r\n        v: [\"a;c\", \"a;d\", \"a;e\", \"b;c\", \"b;d\", \"b;e\"]\r\n    },\r\n    \"5G\": {\r\n        h: [\"a;b;c\", \"d\", \"e\"],\r\n        v: [\"a;d;e\", \"b;d;e\", \"c;d;e\"]\r\n    },\r\n    \"5C\": {\r\n        h: [\"a\", \"b\", \"c;d;e\"],\r\n        v: [\"a;b;c\", \"a;b;d\", \"a;b;e\"]\r\n    },\r\n    \"6H\": {\r\n        h: [\"a\", \"b;c;d;e\", \"f\"],\r\n        v: [\"a;b;f\", \"a;c;f\", \"a;d;f\", \"a;e;f\"]\r\n    },\r\n    \"6I\": {\r\n        h: [\"a;b;f\", \"a;c;f\", \"a;d;f\", \"a;e;f\"],\r\n        v: [\"a\", \"b;c;d;e\", \"f\"]\r\n    },\r\n    \"6A\": {\r\n        h: [\"a;b;c;d;e\", \"f\"],\r\n        v: [\"a;f\", \"b;f\", \"c;f\", \"d;f\", \"e;f\"]\r\n    },\r\n    \"6C\": {\r\n        h: [\"a\", \"b;c;d;e;f\"],\r\n        v: [\"a;b\", \"a;c\", \"a;d\", \"a;e\", \"a;f\"]\r\n    },\r\n    \"6J\": {\r\n        h: [\"a;b;c;d\", \"e\", \"f\"],\r\n        v: [\"a;e;f\", \"b;e;f\", \"c;e;f\", \"d;e;f\"]\r\n    },\r\n    \"6E\": {\r\n        h: [\"a\", \"b\", \"c;d;e;f\"],\r\n        v: [\"a;b;c\", \"a;b;d\", \"a;b;e\", \"a;b;f\"]\r\n    },\r\n    \"6W\": {\r\n        h: [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"],\r\n        v: [\"a;b;c;d;e;f\"]\r\n    },\r\n    \"7H\": {\r\n        h: [\"a\", \"b;c;d;e;f\", \"g\"],\r\n        v: [\"a;b;g\", \"a;c;g\", \"a;d;g\", \"a;e;g\", \"a;f;g\"]\r\n    },\r\n    \"7I\": {\r\n        h: [\"a;b;g\", \"a;c;g\", \"a;d;g\", \"a;e;g\", \"a;f;g\"],\r\n        v: [\"a\", \"b;c;d;e;f\", \"g\"]\r\n    }\r\n};\r\nfunction dhtmlXLayoutSepObject(e, a) {\r\n    var c = this;\r\n    this.conf = {\r\n        mode: e,\r\n        idx: a,\r\n        blocked: false,\r\n        locked: false,\r\n        btn_left: ((window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8) && typeof (window.addEventListener) == \"undefined\" ? 1 : 0)\r\n    };\r\n    if (window.dhx4.isIE && navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0) {\r\n        this.conf.btn_left = 1\r\n    }\r\n    this.sep = document.createElement(\"DIV\");\r\n    this.sep.className = \"dhxlayout_sep\";\r\n    if (window.dhx4.isIE == true) {\r\n        this.sep.onselectstart = function() {\r\n            return false\r\n        }\r\n    }\r\n    this.sep.className = \"dhxlayout_sep dhxlayout_sep_resize_\" + this.conf.mode;\r\n    this._setSize = function(g, n, l, m) {\r\n        this.sep.style.left = g + \"px\";\r\n        this.sep.style.top = n + \"px\";\r\n        this.sep.style.width = Math.max(l, 0) + \"px\";\r\n        this.sep.style.height = Math.max(m, 0) + \"px\"\r\n    }\r\n    ;\r\n    this._lockSep = function(g) {\r\n        this.conf.locked = (g == true);\r\n        this._blockSep()\r\n    }\r\n    ;\r\n    this._setWH = function(g) {\r\n        var h = this._getLayout();\r\n        h.conf.sw = (g == null  ? h._detectSW() : Math.max(parseInt(g) || -1, -1));\r\n        h._getMainInst().setSizes();\r\n        h = null \r\n    }\r\n    ;\r\n    this._blockSep = function() {\r\n        var g = this._getLayout();\r\n        var h = g.cdata.a.conf.collapsed || g.cdata.b.conf.collapsed || this.conf.locked;\r\n        g = null ;\r\n        if (this.conf.blocked == h) {\r\n            return\r\n        }\r\n        this.sep.className = \"dhxlayout_sep\" + (h ? \"\" : \" dhxlayout_sep_resize_\" + this.conf.mode);\r\n        this.conf.blocked = h\r\n    }\r\n    ;\r\n    this._beforeResize = function(h) {\r\n        if (this.conf.blocked) {\r\n            return\r\n        }\r\n        if (this.conf.resize != null  && this.conf.resize.active == true) {\r\n            return\r\n        }\r\n        if (h.type == window.dhx4.dnd.evs.start) {\r\n            this.sep.className += \" dhxlayout_sep_resize_actv\";\r\n            var m = (h.pageX || h.touches[0].pageX);\r\n            var l = (h.pageY || h.touches[0].pageY)\r\n        } else {\r\n            if (h.button !== this.conf.btn_left) {\r\n                return\r\n            }\r\n            var m = h.clientX;\r\n            var l = h.clientY\r\n        }\r\n        if (window.dhx4.dnd.p_en == true) {\r\n            window.dhx4.dnd._touchOff()\r\n        }\r\n        var g = this._getLayout();\r\n        this.conf.resize = {\r\n            sx: m,\r\n            sy: l,\r\n            tx: h.layerX,\r\n            ty: h.layerY,\r\n            sep_x: parseInt(this.sep.style.left),\r\n            sep_y: parseInt(this.sep.style.top),\r\n            min_wa: g.cdata.a._getAvailWidth(\"a\"),\r\n            min_wb: g.cdata.b._getAvailWidth(\"b\"),\r\n            min_ha: g.cdata.a._getAvailHeight(\"a\"),\r\n            min_hb: g.cdata.b._getAvailHeight(\"b\")\r\n        };\r\n        this.conf.resize.nx = this.conf.resize.sep_x;\r\n        this.conf.resize.ny = this.conf.resize.sep_y;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.addEventListener(\"mousemove\", this._doOnMouseMove, false);\r\n            window.addEventListener(\"mouseup\", this._doOnMouseUp, false);\r\n            window.addEventListener(window.dhx4.dnd.evs.move, this._doOnMouseMove, false);\r\n            window.addEventListener(window.dhx4.dnd.evs.end, this._doOnMouseUp, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousemove\", this._doOnMouseMove);\r\n            document.body.attachEvent(\"onmouseup\", this._doOnMouseUp)\r\n        }\r\n        g = null \r\n    }\r\n    ;\r\n    this._onResize = function(l) {\r\n        if (!this.conf.resize.active) {\r\n            this._initResizeArea();\r\n            this.conf.resize.active = true\r\n        }\r\n        if (this.conf.mode == \"v\") {\r\n            var g = (l.type == \"mousemove\" ? l.clientX : (l.pageX || l.touches[0].pageX));\r\n            var h = this.conf.resize.sx - g;\r\n            this.conf.resize.nx = this.conf.resize.sep_x - h;\r\n            if (this.conf.resize.nx > this.conf.resize.sep_x + this.conf.resize.min_wb) {\r\n                this.conf.resize.nx = this.conf.resize.sep_x + this.conf.resize.min_wb\r\n            } else {\r\n                if (this.conf.resize.nx < this.conf.resize.sep_x - this.conf.resize.min_wa) {\r\n                    this.conf.resize.nx = this.conf.resize.sep_x - this.conf.resize.min_wa\r\n                }\r\n            }\r\n            this.r_sep.style.left = this.conf.resize.nx + \"px\"\r\n        } else {\r\n            var m = (l.type == \"mousemove\" ? l.clientY : (l.pageY || l.touches[0].pageY));\r\n            var h = this.conf.resize.sy - m;\r\n            this.conf.resize.ny = this.conf.resize.sep_y - h;\r\n            if (this.conf.resize.ny > this.conf.resize.sep_y + this.conf.resize.min_hb) {\r\n                this.conf.resize.ny = this.conf.resize.sep_y + this.conf.resize.min_hb\r\n            } else {\r\n                if (this.conf.resize.ny < this.conf.resize.sep_y - this.conf.resize.min_ha) {\r\n                    this.conf.resize.ny = this.conf.resize.sep_y - this.conf.resize.min_ha\r\n                }\r\n            }\r\n            this.r_sep.style.top = this.conf.resize.ny + \"px\"\r\n        }\r\n    }\r\n    ;\r\n    this._afterResize = function(r) {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"mousemove\", this._doOnMouseMove, false);\r\n            window.removeEventListener(\"mouseup\", this._doOnMouseUp, false);\r\n            window.removeEventListener(window.dhx4.dnd.evs.move, this._doOnMouseMove, false);\r\n            window.removeEventListener(window.dhx4.dnd.evs.end, this._doOnMouseUp, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousemove\", this._doOnMouseMove);\r\n            document.body.detachEvent(\"onmouseup\", this._doOnMouseUp)\r\n        }\r\n        if (!this.conf.resize.active) {\r\n            this.conf.resize = null ;\r\n            return\r\n        }\r\n        if (r.type == window.dhx4.dnd.evs.end) {\r\n            this.sep.className = this.sep.className.replace(/\\s{0,}dhxlayout_sep_resize_actv/gi, \"\")\r\n        } else {\r\n            if (r.button !== this.conf.btn_left) {\r\n                return\r\n            }\r\n        }\r\n        var m = this._getLayout();\r\n        var h = m._getMainInst();\r\n        var n = (h.checkEvent(\"onPanelResizeFinish\") == true ? {} : false);\r\n        if (n !== false) {\r\n            h.forEachItem(function(u) {\r\n                n[u.conf.name] = {\r\n                    w: u.conf.size.w,\r\n                    h: u.conf.size.h\r\n                };\r\n                u = null \r\n            })\r\n        }\r\n        var l = this.conf.resize.nx - this.conf.resize.sep_x;\r\n        var g = this.conf.resize.ny - this.conf.resize.sep_y;\r\n        m.cdata.a._setSize(m.cdata.a.conf.size.x, m.cdata.a.conf.size.y, m.cdata.a.conf.size.w + l, m.cdata.a.conf.size.h + g, \"a\");\r\n        m.cdata.b._setSize(m.cdata.b.conf.size.x + l, m.cdata.b.conf.size.y + g, m.cdata.b.conf.size.w - l, m.cdata.b.conf.size.h - g, \"b\");\r\n        this._setSize(parseInt(this.r_sep.style.left), parseInt(this.r_sep.style.top), parseInt(this.r_sep.style.width), parseInt(this.r_sep.style.height));\r\n        if (window.dhx4.isIE) {\r\n            var s = this;\r\n            window.setTimeout(function() {\r\n                s._removeResizeArea();\r\n                s = null \r\n            }, 1)\r\n        } else {\r\n            this._removeResizeArea()\r\n        }\r\n        if (n !== false) {\r\n            var o = [];\r\n            h.forEachItem(function(u) {\r\n                var v = n[u.conf.name];\r\n                if (!(v.w == u.conf.size.w && v.h == u.conf.size.h)) {\r\n                    o.push(u.conf.name)\r\n                }\r\n                u = null \r\n            });\r\n            h._callMainEvent(\"onPanelResizeFinish\", [o])\r\n        }\r\n        h = m = null ;\r\n        this.conf.resize.active = false;\r\n        this.conf.resize = null ;\r\n        if (window.dhx4.dnd.p_en == true) {\r\n            window.dhx4.dnd._touchOn()\r\n        }\r\n    }\r\n    ;\r\n    this._initResizeArea = function() {\r\n        if (this.r_sep == null ) {\r\n            this.r_sep = document.createElement(\"DIV\");\r\n            this.r_sep.className = \"dhxlayout_resize_sep\";\r\n            this.r_sep.style.left = this.sep.style.left;\r\n            this.r_sep.style.top = this.sep.style.top;\r\n            this.r_sep.style.width = this.sep.style.width;\r\n            this.r_sep.style.height = this.sep.style.height;\r\n            this.sep.parentNode.appendChild(this.r_sep);\r\n            if (window.dhx4.isIE) {\r\n                this.r_sep.onselectstart = function() {\r\n                    return false\r\n                }\r\n            }\r\n        }\r\n        if (this.r_area == null ) {\r\n            this.r_area = document.createElement(\"DIV\");\r\n            this.r_area.className = \"dhxlayout_resize_area\";\r\n            this.sep.parentNode.appendChild(this.r_area);\r\n            if (window.dhx4.isIE) {\r\n                this.r_area.onselectstart = function() {\r\n                    return false\r\n                }\r\n            }\r\n            if (this.conf.mode == \"v\") {\r\n                var g = parseInt(this.r_sep.style.left) - this.conf.resize.min_wa;\r\n                var n = parseInt(this.r_sep.style.top);\r\n                var l = this.conf.resize.min_wa + this.conf.resize.min_wb + parseInt(this.r_sep.style.width);\r\n                var m = parseInt(this.r_sep.style.height)\r\n            } else {\r\n                var g = parseInt(this.r_sep.style.left);\r\n                var n = parseInt(this.r_sep.style.top) - this.conf.resize.min_ha;\r\n                var l = parseInt(this.r_sep.style.width);\r\n                var m = this.conf.resize.min_ha + this.conf.resize.min_hb + parseInt(this.r_sep.style.height)\r\n            }\r\n            this.r_area.style.left = g + \"px\";\r\n            this.r_area.style.top = n + \"px\";\r\n            if (!dhtmlXLayoutObject.prototype._confGlob.reszieCover) {\r\n                dhtmlXLayoutObject.prototype._confGlob.reszieCover = {};\r\n                this.r_area.style.width = l + \"px\";\r\n                this.r_area.style.height = m + \"px\";\r\n                dhtmlXLayoutObject.prototype._confGlob.reszieCover.w = parseInt(this.r_area.style.width) - this.r_area.offsetWidth;\r\n                dhtmlXLayoutObject.prototype._confGlob.reszieCover.h = parseInt(this.r_area.style.height) - this.r_area.offsetHeight\r\n            }\r\n            this.r_area.style.width = l + dhtmlXLayoutObject.prototype._confGlob.reszieCover.w + \"px\";\r\n            this.r_area.style.height = m + dhtmlXLayoutObject.prototype._confGlob.reszieCover.h + \"px\"\r\n        }\r\n        document.body.className += \" dhxlayout_resize_\" + this.conf.mode\r\n    }\r\n    ;\r\n    this._removeResizeArea = function() {\r\n        this.r_sep.onselectstart = null ;\r\n        this.r_sep.parentNode.removeChild(this.r_sep);\r\n        this.r_sep = null ;\r\n        this.r_area.onselectstart = null ;\r\n        this.r_area.parentNode.removeChild(this.r_area);\r\n        this.r_area = null ;\r\n        document.body.className = String(document.body.className).replace(/\\s{0,}dhxlayout_resize_[vh]/gi, \"\")\r\n    }\r\n    ;\r\n    this._doOnMouseDown = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.cancelBubble = true\r\n        }\r\n        c._beforeResize(g)\r\n    }\r\n    ;\r\n    this._doOnBodyMouseDown = function(g) {\r\n        g = g || event;\r\n        if (c.conf.resize == null ) {\r\n            return\r\n        }\r\n        if (c.conf.resize.active == true && g.button !== c.conf.btn_left) {\r\n            if (g.preventDefault) {\r\n                g.preventDefault()\r\n            }\r\n            g.returnValue = false;\r\n            g.cancelBubble = true;\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this._doOnMouseMove = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.cancelBubble = true\r\n        }\r\n        c._onResize(g)\r\n    }\r\n    ;\r\n    this._doOnMouseUp = function(g) {\r\n        g = g || event;\r\n        if (g.type == \"mouseup\" && g.button !== c.conf.btn_left) {\r\n            return\r\n        }\r\n        c._afterResize(g)\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.sep.addEventListener(\"mousedown\", this._doOnMouseDown, false);\r\n        this.sep.addEventListener(window.dhx4.dnd.evs.start, this._doOnMouseDown, false);\r\n        document.body.addEventListener(\"mousedown\", this._doOnBodyMouseDown, false);\r\n        document.body.addEventListener(\"contextmenu\", this._doOnBodyMouseDown, false)\r\n    } else {\r\n        this.sep.attachEvent(\"onmousedown\", this._doOnMouseDown);\r\n        document.body.attachEvent(\"onmousedown\", this._doOnBodyMouseDown);\r\n        document.body.attachEvent(\"oncontextmenu\", this._doOnBodyMouseDown)\r\n    }\r\n    this._unload = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.sep.removeEventListener(\"mousedown\", this._doOnMouseDown, false);\r\n            this.sep.removeEventListener(window.dhx4.dnd.evs.start, this._doOnMouseDown, false);\r\n            document.body.removeEventListener(\"mousedown\", this._doOnBodyMouseDown, false);\r\n            document.body.removeEventListener(\"contextmenu\", this._doOnBodyMouseDown, false)\r\n        } else {\r\n            this.sep.detachEvent(\"onmousedown\", this._doOnMouseDown);\r\n            document.body.detachEvent(\"onmousedown\", this._doOnBodyMouseDown);\r\n            document.body.detachEvent(\"oncontextmenu\", this._doOnBodyMouseDown)\r\n        }\r\n        if (window.dhx4.isIE == true) {\r\n            this.sep.onselectstart = null \r\n        }\r\n        this.sep.parentNode.removeChild(this.sep);\r\n        this.sep = null ;\r\n        for (var g in this) {\r\n            this[g] = null \r\n        }\r\n        c = null \r\n    }\r\n    ;\r\n    return this\r\n}\r\ndhtmlXLayoutObject.prototype.setSeparatorSize = function(e, g) {\r\n    if (typeof (e) == \"number\") {\r\n        var h = this.setSeparatorSize({\r\n            index: e,\r\n            current: -1\r\n        }, g);\r\n        if (h.sep != null ) {\r\n            h.sep._setWH(g)\r\n        }\r\n        return\r\n    }\r\n    for (var c in this.cdata) {\r\n        if (this.cdata[c].dataType == \"layout\" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null ) {\r\n            e = this.cdata[c].dataObj.setSeparatorSize(e, g);\r\n            if (e.sep != null ) {\r\n                return e\r\n            }\r\n        }\r\n        if (c == \"a\" && this.sep != null ) {\r\n            e.current++;\r\n            if (e.index == e.current) {\r\n                return {\r\n                    sep: this.sep\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\nwindow.dhtmlXLayoutCell = function(g, e) {\r\n    dhtmlXCellObject.apply(this, [g, \"_layout\"]);\r\n    var c = this;\r\n    this.layout = e;\r\n    this.conf.skin = this.layout.conf.skin;\r\n    this.conf.mode = this.layout.conf.mode;\r\n    this.conf.collapsed = false;\r\n    this.conf.fixed = {\r\n        w: false,\r\n        h: false\r\n    };\r\n    this.conf.docked = true;\r\n    this.conf.min_width = 26;\r\n    this.conf.min_height = 26;\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        this.cell.childNodes[this.conf.idx.hdr].ondblclick = null ;\r\n        if (this.conf.mode != \"c\") {\r\n            this.cell.childNodes[this.conf.idx.hdr].lastChild.onclick = null \r\n        }\r\n        this._unloadDocking();\r\n        this.layout = null ;\r\n        c = null \r\n    });\r\n    this._hdrInit();\r\n    this.cell.childNodes[this.conf.idx.hdr].ondblclick = function() {\r\n        var h = c.layout._getMainInst();\r\n        h._callMainEvent(\"onDblClick\", [c.conf.name]);\r\n        h = null \r\n    }\r\n    ;\r\n    this.attachEvent(\"_onContentLoaded\", function() {\r\n        var h = this.layout._getMainInst();\r\n        h._callMainEvent(\"onContentLoaded\", [this.conf.name]);\r\n        h = null \r\n    });\r\n    if (this.conf.mode != \"c\") {\r\n        var a = document.createElement(\"DIV\");\r\n        a.className = \"dhxlayout_arrow dhxlayout_arrow_\" + this.conf.mode + this._idd;\r\n        this.cell.childNodes[this.conf.idx.hdr].appendChild(a);\r\n        a.onclick = function(h) {\r\n            if (c.conf.collapsed) {\r\n                c.expand()\r\n            } else {\r\n                c.collapse()\r\n            }\r\n        }\r\n        ;\r\n        a = null \r\n    }\r\n    this.attachEvent(\"_onBeforeContentAttach\", function(h) {\r\n        if (h == \"tabbar\" || h == \"layout\" || h == \"acc\") {\r\n            this._hideBorders()\r\n        }\r\n        if (h == \"sidebar\" && this.conf.skin != \"dhx_skyblue\") {\r\n            this._hideBorders();\r\n            this.showHeader()\r\n        }\r\n    });\r\n    this._initDocking();\r\n    return this\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype = new dhtmlXCellObject();\r\ndhtmlXLayoutCell.prototype.getId = function() {\r\n    return this.conf.name\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._initDocking = function() {\r\n    var a = this;\r\n    this.dock = function() {\r\n        var e = this.layout._getMainInst();\r\n        if (e.dhxWins == null  || this.conf.docked) {\r\n            e = null ;\r\n            return\r\n        }\r\n        var c = e.dhxWins.window(this.conf.name);\r\n        c.close();\r\n        this._attachFromCell(c);\r\n        this.conf.docked = true;\r\n        if (!this.conf.dock_collapsed) {\r\n            this.expand()\r\n        }\r\n        e._callMainEvent(\"onDock\", [this.conf.name]);\r\n        e = c = null \r\n    }\r\n    ;\r\n    this.undock = function(c, n, l, m) {\r\n        var g = this.layout._getMainInst();\r\n        if (g.dhxWins == null  || this.conf.docked == false) {\r\n            g = null ;\r\n            return\r\n        }\r\n        this.conf.dock_collapsed = this.conf.collapsed;\r\n        if (!this.conf.collapsed) {\r\n            this.collapse()\r\n        }\r\n        if (g.dhxWins.window(this.conf.name) != null ) {\r\n            var e = g.dhxWins.window(this.conf.name);\r\n            e.show()\r\n        } else {\r\n            if (c == null ) {\r\n                c = 20\r\n            }\r\n            if (n == null ) {\r\n                n = 20\r\n            }\r\n            if (l == null ) {\r\n                l = 320\r\n            }\r\n            if (m == null ) {\r\n                m = 200\r\n            }\r\n            var e = g.dhxWins.createWindow(this.conf.name, c, n, l, m);\r\n            e.button(\"close\").hide();\r\n            e.addUserButton(\"dock\", 99, \"Dock\");\r\n            e.button(\"dock\").show();\r\n            e.button(\"dock\").attachEvent(\"onClick\", this._doOnDockClick);\r\n            e.setText(this.getText());\r\n            e.attachEvent(\"onClose\", this._doOnDockWinClose)\r\n        }\r\n        this.conf.docked = false;\r\n        e._attachFromCell(this);\r\n        g._callMainEvent(\"onUnDock\", [this.conf.name]);\r\n        g = e = null \r\n    }\r\n    ;\r\n    this._doOnDockClick = function() {\r\n        a.dock()\r\n    }\r\n    ;\r\n    this._doOnDockWinClose = function(c) {\r\n        c.hide();\r\n        return false\r\n    }\r\n    ;\r\n    this._unloadDocking = function() {\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrInit = function() {\r\n    var c = \"\";\r\n    if (window.dhx4.isIE) {\r\n        if (navigator.userAgent.indexOf(\"MSIE 9.0\") != -1) {\r\n            c = \" dhx_cell_hdr_text_ie9\"\r\n        } else {\r\n            if (window.dhx4.isIE8) {\r\n                c = \" dhx_cell_hdr_text_ie8\"\r\n            } else {\r\n                if (window.dhx4.isIE7) {\r\n                    c = \" dhx_cell_hdr_text_ie7\"\r\n                } else {\r\n                    if (window.dhx4.isIE6) {\r\n                        c = \" dhx_cell_hdr_text_ie6\"\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        if (window.dhx4.isChrome || window.dhx4.isKHTML) {\r\n            c = \" dhx_cell_hdr_text_chrome\"\r\n        }\r\n    }\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = \"dhx_cell_hdr\";\r\n    a.innerHTML = \"<div class='dhx_cell_hdr_text\" + c + \"'></div>\";\r\n    this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cont]);\r\n    a = null ;\r\n    this.conf.ofs_nodes.t._getHdrHeight = \"func\";\r\n    this.conf.hdr = {\r\n        visible: true\r\n    };\r\n    this.conf.idx_data.hdr = \"dhx_cell_hdr\";\r\n    this._updateIdx();\r\n    this.attachEvent(\"_onSetSize\", this._hdrOnSetSize);\r\n    this.attachEvent(\"_onBorderChange\", this._hdrOnBorderChange);\r\n    this.attachEvent(\"_onViewSave\", this._hdrOnViewSave);\r\n    this.attachEvent(\"_onViewRestore\", this._hdrOnViewRestore)\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.showHeader = function(a) {\r\n    if (this.conf.hdr.visible || this.conf.collapsed) {\r\n        return\r\n    }\r\n    if (this.conf.hdr.w_saved > this._getAvailWidth() || this.conf.hdr.h_saved > this._getAvailHeight()) {\r\n        return\r\n    }\r\n    this.conf.hdr.w_saved = this.conf.hdr.h_saved = null ;\r\n    this.conf.hdr.visible = true;\r\n    this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_hdr\";\r\n    if (a !== true) {\r\n        this._adjustCont(this._idd)\r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.hideHeader = function(a) {\r\n    if (!this.conf.hdr.visible || this.conf.collapsed) {\r\n        return\r\n    }\r\n    this.conf.hdr.w_saved = this._getMinWidth(this._idd);\r\n    this.conf.hdr.h_saved = this._getMinHeight(this._idd);\r\n    this.conf.hdr.visible = false;\r\n    this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_hdr dhx_cell_hdr_hidden\";\r\n    this._hdrUpdBorder();\r\n    this._mtbUpdBorder();\r\n    if (a !== true) {\r\n        this._adjustCont(this._idd)\r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.isHeaderVisible = function() {\r\n    return ( this.conf.hdr.visible == true) \r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.showArrow = function() {\r\n    this.cell.childNodes[this.conf.idx.hdr].childNodes[1].style.display = \"\"\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.hideArrow = function() {\r\n    this.cell.childNodes[this.conf.idx.hdr].childNodes[1].style.display = \"none\"\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.isArrowVisible = function() {\r\n    return ( this.cell.childNodes[this.conf.idx.hdr].childNodes[1].style.display == \"\") \r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.setText = function(a) {\r\n    this.conf.hdr.text = a;\r\n    this._hdrUpdText()\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.getText = function() {\r\n    return this.conf.hdr.text\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.setCollapsedText = function(a) {\r\n    this.conf.hdr.text_collapsed = a;\r\n    this._hdrUpdText()\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.getCollapsedText = function() {\r\n    return ( this.conf.hdr.text_collapsed != null  ? this.conf.hdr.text_collapsed : this.conf.hdr.text) \r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrUpdText = function() {\r\n    var a = (this.conf.collapsed == true && this.conf.hdr.text_collapsed != null  ? this.conf.hdr.text_collapsed : this.conf.hdr.text);\r\n    this.cell.childNodes[this.conf.idx.hdr].firstChild.innerHTML = \"<span>\" + a + \"</span>\"\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrUpdBorder = function() {\r\n    if (this.conf.borders == true) {\r\n        this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_hdr\" + (this.conf.hdr.visible ? \"\" : \" dhx_cell_hdr_hidden\")\r\n    } else {\r\n        if (!this.conf.hdr.visible) {\r\n            this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_hdr dhx_cell_hdr_hidden_no_borders\"\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrOnSetSize = function() {\r\n    if (this.conf.collapsed && this.conf.mode == \"v\") {\r\n        this._fitHdr()\r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrOnBorderChange = function() {\r\n    this.hideHeader(true);\r\n    this._hdrUpdBorder()\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrOnViewSave = function(a) {\r\n    this.views[a].hdr_vis = this.conf.hdr.visible\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._hdrOnViewRestore = function(a) {\r\n    if (this.conf.hdr.visible != this.views[a].hdr_vis) {\r\n        this[this.views[a].hdr_vis ? \"showHeader\" : \"hideHeader\"](true)\r\n    }\r\n    this.views[a].hdr_vis = null ;\r\n    delete this.views[a].hdr_vis\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._getHdrHeight = function(a) {\r\n    if (this.conf.collapsed && this.conf.mode == \"v\" && a !== true) {\r\n        return 27\r\n    }\r\n    return this.cell.childNodes[this.conf.idx.hdr].offsetHeight\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._fitHdr = function() {\r\n    if (this.conf.collapsed) {\r\n        if (typeof (dhtmlXLayoutObject.prototype._confGlob.hdrColH) == \"undefined\") {\r\n            this.cell.childNodes[this.conf.idx.hdr].style.height = this.cell.offsetHeight + \"px\";\r\n            dhtmlXLayoutObject.prototype._confGlob.hdrColH = parseInt(this.cell.childNodes[this.conf.idx.hdr].style.height) - this._getHdrHeight(true)\r\n        }\r\n        this.cell.childNodes[this.conf.idx.hdr].style.height = this.cell.offsetHeight + dhtmlXLayoutObject.prototype._confGlob.hdrColH + \"px\"\r\n    } else {\r\n        this.cell.childNodes[this.conf.idx.hdr].style.height = null \r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.expand = function(m) {\r\n    if (!this.conf.collapsed) {\r\n        return true\r\n    }\r\n    var e = this.layout;\r\n    if (this.conf.mode == \"v\") {\r\n        var l = (m ? e.conf.hh : e.cdata[e.conf.nextCell[this._idd]]._getMinWidth(this._idd));\r\n        var g = e.cont.offsetWidth - e.conf.sw;\r\n        if (l + this.conf.size.w_avl > g) {\r\n            e = null ;\r\n            return false\r\n        }\r\n    } else {\r\n        var h = (m ? e.conf.hh : e.cdata[e.conf.nextCell[this._idd]]._getMinHeight(this._idd) + e.cdata[e.conf.nextCell[this._idd]]._getHdrHeight());\r\n        var c = e.cont.offsetHeight - e.conf.sw;\r\n        if (h + this.conf.size.h_avl > c) {\r\n            e = null ;\r\n            return false\r\n        }\r\n    }\r\n    if (this.conf.docked == false) {\r\n        this.dock();\r\n        return\r\n    }\r\n    this.cell.className = String(this.cell.className).replace(/\\s{0,}dhxlayout_collapsed_[hv]/gi, \"\");\r\n    this.conf.collapsed = false;\r\n    if (this.conf.mode == \"v\") {\r\n        this.conf.size.w = Math.min(g - l, this.conf.size.w_saved);\r\n        this.conf.size.w_saved = this.conf.size.w_avl = null \r\n    } else {\r\n        this.conf.size.h = Math.min(c - h, this.conf.size.h_saved);\r\n        this.conf.size.h_saved = this.conf.size.h_avl = null \r\n    }\r\n    if (this.conf.mode == \"v\") {\r\n        this._fitHdr()\r\n    }\r\n    e.setSizes(e.conf.nextCell[this._idd], e.conf.nextCell[this._idd], m == true, \"expand\");\r\n    e.sep._blockSep();\r\n    e = null ;\r\n    this._hdrUpdText();\r\n    var a = this.layout._getMainInst();\r\n    a._callMainEvent(\"onExpand\", [this.conf.name]);\r\n    a = null ;\r\n    return true\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.collapse = function() {\r\n    if (this.conf.collapsed) {\r\n        return false\r\n    }\r\n    var c = this.layout;\r\n    if (c.cdata[c.conf.nextCell[this._idd]].expand(true) == false) {\r\n        return false\r\n    }\r\n    if (this.conf.mode == \"v\") {\r\n        this.conf.size.w_saved = this.conf.size.w;\r\n        this.conf.size.w_avl = this._getMinWidth(this._idd)\r\n    } else {\r\n        this.conf.size.h_saved = this.conf.size.h;\r\n        this.conf.size.h_avl = this._getMinHeight(this._idd) + this._getHdrHeight()\r\n    }\r\n    this.cell.className += \" dhxlayout_collapsed_\" + this.conf.mode;\r\n    this.conf.collapsed = true;\r\n    if (this.conf.mode == \"v\") {\r\n        this.conf.size.w = c.conf.hh\r\n    } else {\r\n        this.conf.size.h = this._getHdrHeight()\r\n    }\r\n    c.setSizes(c.conf.nextCell[this._idd], c.conf.nextCell[this._idd], false, \"collapse\");\r\n    c.sep._blockSep();\r\n    c = null ;\r\n    this._hdrUpdText();\r\n    var a = this.layout._getMainInst();\r\n    a._callMainEvent(\"onCollapse\", [this.conf.name]);\r\n    a = null ;\r\n    return true\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.isCollapsed = function() {\r\n    return ( this.conf.collapsed == true) \r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.setMinWidth = function(a) {\r\n    this.conf.min_width = parseInt(a) || 0\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.setMinHeight = function(a) {\r\n    this.conf.min_height = parseInt(a) || 0\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._getMinWidth = function(c) {\r\n    if (this.dataType == \"layout\" && this.dataObj != null ) {\r\n        if (this.layout._getMainInst() != this.dataObj._getMainInst()) {\r\n            return this.dataObj._getAvailWidth()\r\n        }\r\n        if (this.dataObj.conf.pattern == \"1C\") {\r\n            return Math.max(this.conf.min_width, this.dataObj.cdata.a._getMinWidth(c))\r\n        } else {\r\n            if (this.dataObj.conf.mode == \"v\") {\r\n                var a = c || this._idd;\r\n                if (this.dataObj.cdata[a].conf.collapsed) {\r\n                    a = this.dataObj.conf.nextCell[a]\r\n                }\r\n                return Math.max(this.conf.min_width, this.dataObj.cdata[a]._getMinWidth(c) + this.dataObj.cdata[this.dataObj.conf.nextCell[a]]._getWidth() + this.dataObj.conf.sw)\r\n            } else {\r\n                return Math.max(this.conf.min_width, this.dataObj.cdata.a._getMinWidth(c), this.dataObj.cdata.b._getMinWidth(c))\r\n            }\r\n        }\r\n    }\r\n    return Math.max(this.conf.min_width, 1)\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._getMinHeight = function(e) {\r\n    var c = 0;\r\n    if (this.conf.idx.menu != null ) {\r\n        c += this.cell.childNodes[this.conf.idx.menu].offsetHeight\r\n    }\r\n    if (this.dataType == \"layout\" && this.dataObj != null ) {\r\n        if (this.layout._getMainInst() != this.dataObj._getMainInst()) {\r\n            return this.dataObj._getAvailHeight()\r\n        }\r\n        if (this.dataObj.conf.pattern == \"1C\") {\r\n            return Math.max(this.conf.min_height, this.dataObj.cdata.a._getMinHeight(e))\r\n        } else {\r\n            if (this.dataObj.conf.mode == \"h\") {\r\n                var a = e;\r\n                if (this.dataObj.cdata[a].conf.collapsed) {\r\n                    a = this.dataObj.conf.nextCell[a]\r\n                }\r\n                return Math.max(this.conf.min_height, this.dataObj.cdata[a]._getMinHeight(e) + this.dataObj.cdata[a]._getHdrHeight() + this.dataObj.cdata[this.dataObj.conf.nextCell[a]]._getHeight() + this.dataObj.conf.sw)\r\n            } else {\r\n                return Math.max(this.conf.min_height, this.dataObj.cdata.a._getMinHeight(e) + this.dataObj.cdata.a._getHdrHeight(), this.dataObj.cdata.b._getMinHeight(e) + this.dataObj.cdata.b._getHdrHeight())\r\n            }\r\n        }\r\n    }\r\n    return Math.max(this.conf.min_height, c)\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._getAvailWidth = function(e) {\r\n    if (this.dataType == \"layout\" && this.dataObj != null ) {\r\n        if (this.dataObj.conf.pattern == \"1C\") {\r\n            return this.dataObj.cdata.a._getAvailWidth(e)\r\n        } else {\r\n            if (this.dataObj.conf.mode == \"v\") {\r\n                var a = (this.dataObj.cdata.a.conf.collapsed == true);\r\n                var c = (this.dataObj.cdata.b.conf.collapsed == true);\r\n                if (e == \"a\") {\r\n                    return this.dataObj.cdata[c ? \"a\" : \"b\"]._getAvailWidth(e)\r\n                } else {\r\n                    return this.dataObj.cdata[a ? \"b\" : \"a\"]._getAvailWidth(e)\r\n                }\r\n            } else {\r\n                return Math.min(this.dataObj.cdata.a._getAvailWidth(e), this.dataObj.cdata.b._getAvailWidth(e))\r\n            }\r\n        }\r\n    }\r\n    return this.cell.offsetWidth - this._getMinWidth()\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype._getAvailHeight = function(g) {\r\n    if (this.dataType == \"layout\" && this.dataObj != null ) {\r\n        if (this.dataObj.conf.pattern == \"1C\") {\r\n            return this.dataObj.cdata.a._getAvailHeight(g)\r\n        } else {\r\n            if (this.dataObj.conf.mode == \"h\") {\r\n                var c = (this.dataObj.cdata.a.conf.collapsed == true);\r\n                var e = (this.dataObj.cdata.b.conf.collapsed == true);\r\n                if (g == \"a\") {\r\n                    return this.dataObj.cdata[e ? \"a\" : \"b\"]._getAvailHeight(g)\r\n                } else {\r\n                    return this.dataObj.cdata[c ? \"b\" : \"a\"]._getAvailHeight(g)\r\n                }\r\n            } else {\r\n                return Math.min(this.dataObj.cdata.a._getAvailHeight(g), this.dataObj.cdata.b._getAvailHeight(g))\r\n            }\r\n        }\r\n    }\r\n    var a = this._getHdrHeight();\r\n    if (this.conf.mode == \"v\" && this.conf.collapsed) {\r\n        a = this.conf.hh\r\n    }\r\n    return this.cell.offsetHeight - a - this._getMinHeight()\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.setWidth = function(g) {\r\n    if (this.conf.mode == \"v\") {\r\n        if (this.conf.collapsed) {\r\n            return\r\n        }\r\n        var h = this.layout;\r\n        var l = h.cdata[h.conf.nextCell[this._idd]];\r\n        if (l.conf.collapsed) {\r\n            g = g + h.conf.sw + l._getWidth();\r\n            m = h = l = null ;\r\n            return\r\n        }\r\n        var e = this._getMinWidth(this._idd);\r\n        var n = h.cont.offsetWidth - l._getMinWidth(this._idd) - h.conf.sw;\r\n        g = Math.max(e, Math.min(g, n));\r\n        this.conf.size.w = g;\r\n        h.setSizes(l._idd, l._idd);\r\n        h = l = null \r\n    } else {\r\n        if (this.layout == null  || this.layout.parentLayout == null ) {\r\n            return\r\n        }\r\n        var m = this.layout.parentLayout;\r\n        var h = this.layout;\r\n        var l = h.cdata[h.conf.nextCell[this._idd]];\r\n        for (var c in m.cdata) {\r\n            if (m.cdata[c].dataObj == h) {\r\n                m.cdata[c].setWidth(g)\r\n            }\r\n        }\r\n        m = h = null \r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.setHeight = function(n) {\r\n    if (this.conf.mode == \"h\") {\r\n        if (this.conf.collapsed) {\r\n            return\r\n        }\r\n        var g = this.layout;\r\n        var m = g.cdata[g.conf.nextCell[this._idd]];\r\n        if (m.conf.collapsed) {\r\n            n = n + g.conf.sw + m._getHeight();\r\n            var o = (this.layout != null  && this.layout.parentLayout != null  ? this.layout.parentLayout : null );\r\n            if (o != null ) {\r\n                for (var c in o.cdata) {\r\n                    if (o.cdata[c].dataObj == g) {\r\n                        o.cdata[c].setHeight(n)\r\n                    }\r\n                }\r\n            }\r\n            o = g = m = null ;\r\n            return\r\n        }\r\n        var l = this._getMinHeight(this._idd) + this._getHdrHeight();\r\n        var e = g.cont.offsetHeight - m._getMinHeight(this._idd) - m._getHdrHeight() - g.conf.sw;\r\n        n = Math.max(l, Math.min(n, e));\r\n        this.conf.size.h = n;\r\n        g.setSizes(m._idd, m._idd);\r\n        g = m = null \r\n    } else {\r\n        if (this.layout == null  || this.layout.parentLayout == null ) {\r\n            return\r\n        }\r\n        var o = this.layout.parentLayout;\r\n        var g = this.layout;\r\n        var m = g.cdata[g.conf.nextCell[this._idd]];\r\n        for (var c in o.cdata) {\r\n            if (o.cdata[c].dataObj == g) {\r\n                o.cdata[c].setHeight(n)\r\n            }\r\n        }\r\n        o = g = null \r\n    }\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.getWidth = function() {\r\n    return this.conf.size.w\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.getHeight = function() {\r\n    return this.conf.size.h\r\n}\r\n;\r\ndhtmlXLayoutCell.prototype.fixSize = function(c, g) {\r\n    this.conf.fixed.w = window.dhx4.s2b(c);\r\n    this.conf.fixed.h = window.dhx4.s2b(g);\r\n    var a = this.layout._getMainInst();\r\n    var e = {};\r\n    a.forEachItem(function(h) {\r\n        if (h.conf.fsize != null ) {\r\n            var o = h.getId();\r\n            var n = {\r\n                h: (h.conf.fixed.w == true),\r\n                v: (h.conf.fixed.h == true)\r\n            };\r\n            for (var l in n) {\r\n                if (n[l] == true && h.conf.fsize[l] != null ) {\r\n                    if (!(h.conf.fsize[l] instanceof Array)) {\r\n                        h.conf.fsize[l] = [h.conf.fsize[l]]\r\n                    }\r\n                    for (var m = 0; m < h.conf.fsize[l].length; m++) {\r\n                        e[h.conf.fsize[l][m]] = true\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        h = null \r\n    });\r\n    a._forEachSep(function(h) {\r\n        h._lockSep(e[h.conf.idx] == true);\r\n        h = null \r\n    });\r\n    a = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachLayout = function(a) {\r\n    this.callEvent(\"_onBeforeContentAttach\", [\"layout\"]);\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.width = \"100%\";\r\n    c.style.height = \"100%\";\r\n    c.style.position = \"relative\";\r\n    c.style.overflow = \"hidden\";\r\n    this._attachObject(c);\r\n    if (typeof (this._layoutMainInst) != \"undefined\") {\r\n        c._layoutMainInst = this._layoutMainInst\r\n    }\r\n    if (typeof (window.dhtmlXLayoutCell) == \"function\" && this instanceof window.dhtmlXLayoutCell) {\r\n        c._isParentCell = true\r\n    }\r\n    if (typeof (window.dhtmlXAccordionCell) == \"function\" && this instanceof window.dhtmlXAccordionCell) {\r\n        c._ofs = {\r\n            t: -1,\r\n            r: -1,\r\n            l: -1,\r\n            b: -1\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXTabBarCell) == \"function\" && this instanceof window.dhtmlXTabBarCell) {\r\n        if (this.conf.skin == \"dhx_skyblue\") {\r\n            c._ofs = {\r\n                t: -1,\r\n                r: -1,\r\n                b: -1,\r\n                l: -1\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXSideBarCell) == \"function\" && this instanceof window.dhtmlXSideBarCell) {\r\n        if (this.conf.skin == \"dhx_web\") {\r\n            c._ofs = {\r\n                l: 8\r\n            };\r\n            if (this.sidebar.conf.autohide == true) {\r\n                c._ofs.l = 0\r\n            }\r\n            if (this.sidebar.conf.header == true) {\r\n                c._ofs.t = 9\r\n            }\r\n        } else {\r\n            if (this.conf.skin == \"dhx_terrace\") {\r\n                c._ofs = {\r\n                    l: 11\r\n                };\r\n                if (this.sidebar.conf.autohide == true) {\r\n                    c._ofs.l = 0\r\n                }\r\n                if (this.sidebar.conf.header == true) {\r\n                    c._ofs.t = 10\r\n                }\r\n            } else {\r\n                c._ofs = {\r\n                    l: -1\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXCarouselCell) == \"function\" && this instanceof window.dhtmlXCarouselCell) {\r\n        this._hideBorders()\r\n    }\r\n    if (typeof (a) == \"string\") {\r\n        a = {\r\n            pattern: a\r\n        }\r\n    }\r\n    if (typeof (a.skin) == \"undefined\") {\r\n        a.skin = this.conf.skin\r\n    }\r\n    a.parent = c;\r\n    this.dataType = \"layout\";\r\n    this.dataObj = new dhtmlXLayoutObject(a);\r\n    if (this instanceof window.dhtmlXLayoutCell) {\r\n        this.dataObj.parentLayout = this.layout\r\n    }\r\n    c._layoutMainInst = null ;\r\n    a.parent = null ;\r\n    c = a = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\nfunction dhtmlXTabBar(g, m) {\r\n    var h = this;\r\n    this.conf = {\r\n        skin: (window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxtabbar\") || \"dhx_skyblue\"),\r\n        css: \"dhxtabbar\",\r\n        lastActive: null ,\r\n        closeButton: false,\r\n        align: \"left\",\r\n        tabsMode: (m == \"bottom\" ? \"bottom\" : \"top\"),\r\n        tabsContCss: \"\",\r\n        contZone: true,\r\n        transSpeed: \"0.15s\",\r\n        arwMode: \"always\",\r\n        tabsOfs: 1,\r\n        tabsTop: 0,\r\n        url_demand: false,\r\n        urls: {},\r\n        autoload: {},\r\n        tabsWidth: {\r\n            dhx_terrace: [44, 14],\r\n            dhx_web: [35, 9],\r\n            dhx_skyblue: [35, 9]\r\n        }\r\n    };\r\n    var c = navigator.userAgent;\r\n    if (c.indexOf(\"Safari\") >= 0 && (c.indexOf(\"5.1.7\") >= 0 || (c.match(/7[\\.\\d]* mobile/gi) != null  && c.match(/AppleWebKit/gi) != null ))) {\r\n        this.conf.tabsContCss = \" safari_517_fix\"\r\n    }\r\n    var l;\r\n    if (g != null  && typeof (g) == \"object\" && typeof (g.tagName) == \"undefined\") {\r\n        l = g.parent;\r\n        if (typeof (g.skin) != \"undefined\") {\r\n            this.conf.skin = g.skin\r\n        }\r\n        if (typeof (g.mode) != \"undefined\") {\r\n            this.conf.tabsMode = (g.mode == \"bottom\" ? \"bottom\" : \"top\")\r\n        }\r\n        if (typeof (g.align) != \"undefined\") {\r\n            this.conf.align = (g.align == \"right\" ? \"right\" : \"left\")\r\n        }\r\n        if (typeof (g.close_button) != \"undefined\") {\r\n            this.conf.closeButton = window.dhx4.s2b(g.close_button)\r\n        }\r\n        if (typeof (g.content_zone) != \"undefined\") {\r\n            this.conf.contZone = window.dhx4.s2b(g.content_zone)\r\n        }\r\n        if (typeof (g.xml) != \"undefined\") {\r\n            this.conf.autoload.xml = g.xml\r\n        }\r\n        if (typeof (g.json) != \"undefined\") {\r\n            this.conf.autoload.xml = g.json\r\n        }\r\n        if (typeof (g.tabs) != \"undefined\") {\r\n            this.conf.autoload.tabs = g.tabs\r\n        }\r\n        if (typeof (g.onload) != \"undefined\") {\r\n            this.conf.autoload.tabs = g.tabs\r\n        }\r\n        if (typeof (g.arrows_mode) != \"undefined\") {\r\n            this.conf.autoload.arrows_mode = g.arrows_mode\r\n        }\r\n    } else {\r\n        l = g\r\n    }\r\n    window.dhtmlXCellTop.apply(this, [l, g.offsets]);\r\n    if (this.base._ofs != null  && this.base._ofs.t != null ) {\r\n        this.conf.tabsTop = this.base._ofs.t\r\n    }\r\n    this.tabsMode = document.createElement(\"DIV\");\r\n    this.tabsMode.className = \"dhxtabbar_tabs_\" + this.conf.tabsMode;\r\n    this.cont.appendChild(this.tabsMode);\r\n    this.tabsArea = document.createElement(\"DIV\");\r\n    this.tabsArea.className = \"dhxtabbar_tabs dhxtabbar_tabs_\" + this.conf.tabsMode;\r\n    this.tabsArea.innerHTML = \"<div class='dhxtabbar_tabs_ar_left'><div class='dhxtabbar_arrow_img'></div></div><div class='dhxtabbar_tabs_base'><div class='dhxtabbar_tabs_cont_\" + this.conf.align + this.conf.tabsContCss + \"'><div class='dhxtabbar_tabs_line'></div></div></div><div class='dhxtabbar_tabs_ar_right'><div class='dhxtabbar_arrow_img'></div></div>\";\r\n    this.tabsArea.style.top = (this.conf.tabsMode == \"top\" ? this.conf.tabsTop + \"px\" : \"auto\");\r\n    this.tabsMode.appendChild(this.tabsArea);\r\n    this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = \"0px\";\r\n    this.tabsArea.childNodes[0].onclick = function() {\r\n        if (h.conf.align == \"left\") {\r\n            h._moveTabs(1)\r\n        } else {\r\n            h._moveTabs(-1)\r\n        }\r\n    }\r\n    ;\r\n    this.tabsArea.childNodes[2].onclick = function() {\r\n        if (h.conf.align == \"left\") {\r\n            h._moveTabs(-1)\r\n        } else {\r\n            h._moveTabs(1)\r\n        }\r\n    }\r\n    ;\r\n    this._onTabsAreaClick = function(a) {\r\n        return this._callMainEvent(\"onTabClose\", [a])\r\n    }\r\n    ;\r\n    this.tabsArea.onclick = function(n) {\r\n        n = n || event;\r\n        var a = (n.target || n.srcElement);\r\n        while (a != null ) {\r\n            if (typeof (a._tabCloseId) != \"undefined\") {\r\n                if (h._onTabsAreaClick(a._tabCloseId) !== true) {\r\n                    return\r\n                }\r\n                h.t[a._tabCloseId].conf.remove = true;\r\n                h._hideTab(a._tabCloseId);\r\n                a = null \r\n            } else {\r\n                if (typeof (a._tabId) != \"undefined\") {\r\n                    h._doOnClick(a._tabId);\r\n                    a = null \r\n                }\r\n            }\r\n            if (a != null ) {\r\n                a = a.parentNode;\r\n                if (a == this) {\r\n                    a = null \r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this.tabsArea.onselectstart = function(a) {\r\n        a = a || event;\r\n        if (a.preventDefault) {\r\n            a.preventDefault()\r\n        } else {\r\n            a.returnValue = false\r\n        }\r\n    }\r\n    ;\r\n    this._doOnClick = function(a) {\r\n        this.callEvent(\"onTabClick\", [a, this.conf.lastActive]);\r\n        if (this.t[a].conf.enabled) {\r\n            this._setTabActive(a)\r\n        }\r\n    }\r\n    ;\r\n    this.t = {};\r\n    this.addTab = function(a, w, o, u, s, x) {\r\n        x = (window.dhx4.s2b(x) || (this.conf.closeButton == true));\r\n        s = window.dhx4.s2b(s);\r\n        var r = document.createElement(\"DIV\");\r\n        r.className = \"dhxtabbar_tab\";\r\n        r.innerHTML = \"<div class='dhxtabbar_tab_text\" + (x ? \" dhxtabbar_tab_text_close\" : \"\") + \"'>\" + w + \"</div>\" + (x ? \"<div class='dhxtabbar_tab_close'></div>\" : \"\");\r\n        r._tabId = a;\r\n        if (x) {\r\n            r.childNodes[1]._tabCloseId = a\r\n        }\r\n        var n = this.tabsArea.childNodes[1].firstChild;\r\n        if (u != null  && u + 1 > 0 && u + 1 < n.childNodes.length) {\r\n            n.insertBefore(r, n.childNodes[u + 1])\r\n        } else {\r\n            n.appendChild(r)\r\n        }\r\n        var y = false;\r\n        if (typeof (o) == \"undefined\" || o == null  || o == \"*\") {\r\n            o = this._getLabelWidth(w, x);\r\n            y = true\r\n        } else {\r\n            o = parseInt(o)\r\n        }\r\n        r.style.width = o + \"px\";\r\n        var v = new dhtmlXTabBarCell(a,this);\r\n        this.tabsMode.appendChild(v.cell);\r\n        this.t[a] = {\r\n            tab: r,\r\n            cell: v,\r\n            conf: {\r\n                text: w,\r\n                visible: true,\r\n                active: false,\r\n                enabled: true,\r\n                close: x,\r\n                width: o,\r\n                autowidth: y\r\n            }\r\n        };\r\n        n = v = null ;\r\n        if (s) {\r\n            this._setTabActive(a)\r\n        } else {\r\n            this._adjustCell(a)\r\n        }\r\n        if (this.conf.initSeq != true && this.conf.arwMode == \"auto\") {\r\n            this.setSizes()\r\n        }\r\n    }\r\n    ;\r\n    this.setSizes = function() {\r\n        this._adjustCont();\r\n        if (this.conf.tabsAreaOfs == null ) {\r\n            this.tabsArea.style.width = this.cont.offsetWidth + \"px\";\r\n            this.conf.tabsAreaOfs = parseInt(this.tabsArea.style.width) - this.tabsArea.offsetWidth\r\n        }\r\n        this.tabsArea.style.width = this.cont.offsetWidth + this.conf.tabsAreaOfs + \"px\";\r\n        this._adjustCell(this.conf.lastActive);\r\n        this._adjustTabs(true);\r\n        this.callEvent(\"_onSetSizes\", [])\r\n    }\r\n    ;\r\n    this._adjustCell = function(r) {\r\n        if (!this.conf.contZone || r == null ) {\r\n            return\r\n        }\r\n        var o = (this.conf.tabsMode == \"top\" ? this.tabsArea.offsetHeight : 0) + this.conf.tabsTop;\r\n        var n = this.cont.offsetHeight - this.tabsArea.offsetHeight - this.conf.tabsTop;\r\n        var a = this.t[r].cell.dataType;\r\n        if (this.conf.skin == \"dhx_skyblue\" && (a == \"layout\" || a == \"tabbar\" || a == \"acc\")) {\r\n            if (this.conf.tabsMode == \"top\") {\r\n                o = o - 1\r\n            }\r\n            n = n + 1\r\n        }\r\n        if (r != this.conf.lastActive) {\r\n            o = -5000;\r\n            this.t[r].cell.cell.style.visibility = \"hidden\";\r\n            this.t[r].cell.cell.style.zIndex = 0\r\n        }\r\n        this.t[r].cell._setSize(0, o, this.cont.offsetWidth, n)\r\n    }\r\n    ;\r\n    this.setTabsMode = function(a) {\r\n        this.conf.tabsMode = (a == \"bottom\" ? \"bottom\" : \"top\");\r\n        this.tabsMode.className = \"dhxtabbar_tabs_\" + this.conf.tabsMode;\r\n        this.tabsArea.className = \"dhxtabbar_tabs dhxtabbar_tabs_\" + this.conf.tabsMode;\r\n        this.tabsArea.style.top = (this.conf.tabsMode == \"top\" ? this.conf.tabsTop + \"px\" : \"auto\");\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this._tabCss = function(u, r) {\r\n        var n = this.t[u].conf.active;\r\n        var s = !this.t[u].conf.enabled;\r\n        var o = !this.t[u].conf.visible;\r\n        return \"dhxtabbar_tab\" + (o ? \" dhxtabbar_tab_hidden\" : (n || s ? \" dhxtabbar_tab\" + (n ? \"_actv\" : \"\") + (s ? \"_dis\" : \"\") : \"\"))\r\n    }\r\n    ;\r\n    this._getLabelWidth = function(o, n) {\r\n        if (this.tabsTextTest == null ) {\r\n            this.tabsTextTest = document.createElement(\"SPAN\");\r\n            this.tabsTextTest.className = \"dhxtabbar_tabs_text_test_\" + this.conf.skin\r\n        }\r\n        document.body.appendChild(this.tabsTextTest);\r\n        this.tabsTextTest.innerHTML = o;\r\n        var a = this.tabsTextTest.offsetWidth;\r\n        if (window.dhx4.isIE && a == 0) {\r\n            a = this.tabsTextTest.offsetWidth\r\n        }\r\n        a += this.conf.tabsWidth[this.conf.skin][0];\r\n        if (n == true) {\r\n            a += this.conf.tabsWidth[this.conf.skin][1]\r\n        }\r\n        document.body.removeChild(this.tabsTextTest);\r\n        return a\r\n    }\r\n    ;\r\n    this._adjustTabs = function(r) {\r\n        if (this._checkArrows() == true || r == true) {\r\n            this.tabsArea.childNodes[1].style.left = this.tabsArea.childNodes[0].offsetWidth - 1 + \"px\";\r\n            this.tabsArea.childNodes[1].style.width = Math.max(0, this.tabsArea.clientWidth - this.tabsArea.childNodes[0].offsetWidth - this.tabsArea.childNodes[2].offsetWidth) + this.conf.tabsOfs * 2 + \"px\"\r\n        }\r\n        var u = this.tabsArea.childNodes[1];\r\n        if (u.offsetWidth < 5) {\r\n            u = null ;\r\n            return\r\n        }\r\n        var a = parseInt(u.childNodes[0].style[this.conf.align]);\r\n        var o = null ;\r\n        for (var s = 0; s < u.childNodes[0].childNodes.length; s++) {\r\n            var v = u.childNodes[0].childNodes[s]._tabId;\r\n            if (v != null  && this.t[v].conf.visible) {\r\n                var n = this.t[v].tab.offsetWidth - this.conf.tabsOfs;\r\n                if (this.t[v].conf.active) {\r\n                    if (a < 0 || u.offsetWidth < n) {\r\n                        o = {\r\n                            d: 1,\r\n                            id: v\r\n                        }\r\n                    } else {\r\n                        if (a + n > u.offsetWidth) {\r\n                            o = {\r\n                                d: -1,\r\n                                id: v\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                a += n\r\n            }\r\n        }\r\n        if (o != null ) {\r\n            this._moveTabs(o.d, o.id)\r\n        } else {\r\n            if (u.offsetWidth > a + 1) {\r\n                u.childNodes[0].style[this.conf.align] = Math.min(0, parseInt(u.childNodes[0].style[this.conf.align]) + (u.offsetWidth - a)) + \"px\"\r\n            }\r\n        }\r\n        u = o = null \r\n    }\r\n    ;\r\n    this._moveTabs = function(y, r) {\r\n        var o = this.tabsArea.childNodes[1].childNodes[0];\r\n        var v = 0;\r\n        var A = [];\r\n        var D = null ;\r\n        for (var a = 0; a < o.childNodes.length; a++) {\r\n            var n = o.childNodes[a]._tabId;\r\n            if (n != null  && this.t[n].conf.visible) {\r\n                A.push({\r\n                    id: n,\r\n                    w: this.t[n].tab.offsetWidth - this.conf.tabsOfs,\r\n                    ind: v\r\n                });\r\n                if (n == r) {\r\n                    D = v\r\n                }\r\n                v++\r\n            }\r\n        }\r\n        var C = parseInt(this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]);\r\n        var u = this.tabsArea.clientWidth - this.tabsArea.childNodes[0].offsetWidth - this.tabsArea.childNodes[2].offsetWidth + this.conf.tabsOfs;\r\n        var w = null ;\r\n        var s = null ;\r\n        for (var a = 0; a < A.length; a++) {\r\n            A[a].x = C;\r\n            if (w == null  && C >= 0 && C + A[a].w > 0) {\r\n                w = A[a]\r\n            }\r\n            if (C < u && C + A[a].w <= u) {\r\n                s = A[a]\r\n            }\r\n            C += A[a].w\r\n        }\r\n        if (D != null ) {\r\n            var E = A[D]\r\n        } else {\r\n            var E = null ;\r\n            if (y > 0) {\r\n                if (w == null ) {\r\n                    if (A.length > 0) {\r\n                        E = A[A.length - 1]\r\n                    }\r\n                } else {\r\n                    if (w.ind > 0 && A.length >= w.ind) {\r\n                        E = A[w.ind - 1]\r\n                    }\r\n                }\r\n            } else {\r\n                if (s == null ) {\r\n                    if (A.length > 0) {\r\n                        E = A[0]\r\n                    }\r\n                } else {\r\n                    if (A.length > s.ind) {\r\n                        E = A[s.ind + 1]\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (E != null ) {\r\n            if (y > 0) {\r\n                if (C < u) {\r\n                    o.style[this.conf.align] = Math.min(0, parseInt(o.style[this.conf.align]) + (u - C)) + \"px\"\r\n                } else {\r\n                    o.style[this.conf.align] = parseInt(o.style[this.conf.align]) - E.x + \"px\"\r\n                }\r\n            } else {\r\n                o.style[this.conf.align] = parseInt(o.style[this.conf.align]) - E.x + u - E.w + \"px\"\r\n            }\r\n        }\r\n        o = E = A = null \r\n    }\r\n    ;\r\n    this._getNextVisible = function(n, a) {\r\n        return this._getNearVisible(n, a, \"next\")\r\n    }\r\n    ;\r\n    this._getPrevVisible = function(n, a) {\r\n        return this._getNearVisible(n, a, \"previous\")\r\n    }\r\n    ;\r\n    this._getFirstVisible = function() {\r\n        return this._getNearVisible(null , false, \"first\")\r\n    }\r\n    ;\r\n    this._getNearVisible = function(u, o, s) {\r\n        if (s == \"first\") {\r\n            var r = this.tabsArea.childNodes[1].childNodes[0].childNodes[1];\r\n            s = \"next\"\r\n        } else {\r\n            if (u == null  || this.t[u] == null ) {\r\n                return ( o ? this._getFirstVisible() : null ) \r\n            }\r\n            var r = this.t[u].tab[s + \"Sibling\"]\r\n        }\r\n        var n = null ;\r\n        while (r != null  && n == null ) {\r\n            var a = r._tabId;\r\n            if (a != null  && n == null  && this.t[a].conf.visible) {\r\n                n = a\r\n            } else {\r\n                r = r[s + \"Sibling\"]\r\n            }\r\n        }\r\n        r = null ;\r\n        return n\r\n    }\r\n    ;\r\n    this._showTab = function(n, a) {\r\n        if (this.t[n] == null ) {\r\n            return\r\n        }\r\n        if (this.t[n].conf.transActv == true) {\r\n            if (this.t[n].conf.transMode == \"show\") {\r\n                return\r\n            }\r\n        } else {\r\n            if (this.t[n].conf.visible == true) {\r\n                return\r\n            }\r\n        }\r\n        if (this.conf.transProp !== false) {\r\n            this.t[n].conf.transActv = true;\r\n            this.t[n].conf.transMode = \"show\";\r\n            this.t[n].conf.transProp = this.conf.transProp;\r\n            this.t[n].conf.transActvId = (a ? n : null );\r\n            if (!this.t[n].conf.transEv) {\r\n                this.t[n].tab.addEventListener(this.conf.transEv, this._doOnTrEnd, false);\r\n                this.t[n].conf.transEv = true\r\n            }\r\n            this.t[n].conf.visible = true;\r\n            this.t[n].tab.className = this._tabCss(n);\r\n            this.t[n].tab.style[this.conf.transProp] = this.conf.transValueWidth;\r\n            this.t[n].tab.style.width = this.t[n].conf.width + \"px\";\r\n            if (this.t[n].tab.clientWidth >= this.t[n].conf.width) {\r\n                this.t[n].tab.style.visibility = \"visible\"\r\n            }\r\n        } else {\r\n            this.t[n].conf.visible = true;\r\n            this.t[n].tab.style.display = \"\";\r\n            if (a || this.t[n].conf.active) {\r\n                this.t[n].conf.active = false;\r\n                this._setTabActive(n)\r\n            } else {\r\n                this._adjustTabs()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._hideTab = function(u, a) {\r\n        if (this.t[u] == null ) {\r\n            return\r\n        }\r\n        if (this.t[u].conf.transActv == true) {\r\n            if (this.t[u].conf.transMode == \"hide\") {\r\n                return\r\n            }\r\n        } else {\r\n            if (this.t[u].conf.visible != true) {\r\n                return\r\n            }\r\n        }\r\n        var n = false;\r\n        if (this.conf.lastActive == u) {\r\n            this.conf.lastActive = null ;\r\n            this.t[u].conf.active = false;\r\n            this.t[u].tab.className = this._tabCss(u);\r\n            n = true\r\n        }\r\n        var r = this._getPrevVisible(u);\r\n        var o = this._getNextVisible(u);\r\n        var s = (n == true && a !== false ? (a == true ? null  : a) || o || r : null );\r\n        if (this.conf.transProp !== false) {\r\n            this.t[u].conf.transActv = true;\r\n            this.t[u].conf.transMode = \"hide\";\r\n            this.t[u].conf.transProp = this.conf.transProp;\r\n            this.t[u].conf.transActvId = s;\r\n            this.t[u].conf.visible = false;\r\n            if (!this.t[u].conf.transEv) {\r\n                this.t[u].tab.addEventListener(this.conf.transEv, this._doOnTrEnd, false);\r\n                this.t[u].conf.transEv = true\r\n            }\r\n            this.t[u].tab.style.visibility = \"hidden\";\r\n            this.t[u].tab.className = h._tabCss(u);\r\n            this.t[u].tab.style[this.conf.transProp] = this.conf.transValueWidth;\r\n            this.t[u].tab.style.width = \"0px\"\r\n        } else {\r\n            this.t[u].tab.style.display = \"none\";\r\n            this.t[u].conf.visible = false;\r\n            if (this.conf.contZone) {\r\n                this.t[u].cell.cell.style.visibility = \"hidden\";\r\n                this.t[u].cell.cell.style.top = \"-5000px\"\r\n            }\r\n            if (s != null ) {\r\n                this._setTabActive(s)\r\n            }\r\n            this._adjustTabs();\r\n            if (this.t[u].conf.remove) {\r\n                this._removeTab(u)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._isTabVisible = function(a) {\r\n        return ( this.t[a].conf.visible == true) \r\n    }\r\n    ;\r\n    this._doOnTrEnd = function() {\r\n        var o = this._tabId;\r\n        if (h.t[o] == null ) {\r\n            return\r\n        }\r\n        var a = h.t[o];\r\n        var n = a.conf.transActvId;\r\n        if (a.conf.transMode == \"hide\") {\r\n            if (a.conf.remove) {\r\n                h._removeTab(o)\r\n            } else {\r\n                a.tab.style[a.conf.transProp] = \"\";\r\n                if (h.conf.contZone) {\r\n                    a.cell.cell.style.visibility = \"hidden\";\r\n                    a.cell.cell.style.top = \"-5000px\"\r\n                }\r\n                a.conf.transActv = false\r\n            }\r\n        } else {\r\n            if (a.conf.transMode == \"show\") {\r\n                a.tab.style[a.conf.transProp] = \"\";\r\n                a.tab.style.visibility = \"visible\";\r\n                a.conf.transMode = null ;\r\n                a.conf.transActv = false\r\n            }\r\n        }\r\n        if (n != null ) {\r\n            h._setTabActive(n)\r\n        } else {\r\n            h._adjustTabs()\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this.enableTabCloseButton = function(a) {\r\n        this.conf.closeButton = window.dhx4.s2b(a)\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this.conf.unloading = true;\r\n        this.clearAll();\r\n        this.t = null ;\r\n        if (this.tabsTextTest != null ) {\r\n            if (this.tabsTextTest.parentNode) {\r\n                this.tabsTextTest.parentNode.removeChild(this.tabsTextTest)\r\n            }\r\n            this.tabsTextTest = null \r\n        }\r\n        window.dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n        this.tabsArea.childNodes[0].onclick = null ;\r\n        this.tabsArea.childNodes[2].onclick = null ;\r\n        this.tabsArea.onclick = null ;\r\n        this.tabsArea.onselectstart = null ;\r\n        this.tabsArea.parentNode.removeChild(this.tabsArea);\r\n        this.tabsArea = null ;\r\n        this.tabsMode.parentNode.removeChild(this.tabsMode);\r\n        this.tabsMode = null ;\r\n        this._unloadTop();\r\n        window.dhx4._eventable(this, \"clear\");\r\n        for (var n in this) {\r\n            this[n] = null \r\n        }\r\n        h = null \r\n    }\r\n    ;\r\n    this.enableContentZone = function(a) {\r\n        this.conf.contZone = (a == true)\r\n    }\r\n    ;\r\n    this.setSkin = function(o) {\r\n        this._setBaseSkin(o);\r\n        this.conf.skin = o;\r\n        if (this.tabsTextTest != null ) {\r\n            this.tabsTextTest.className = \"dhxtabbar_tabs_text_test_\" + this.conf.skin\r\n        }\r\n        for (var n in this.t) {\r\n            this.t[n].cell._resetSizeState();\r\n            if (this.t[n].conf.autowidth == true) {\r\n                this.t[n].conf.width = this._getLabelWidth(this.t[n].conf.text, this.t[n].conf.close);\r\n                if (this.t[n].conf.visible) {\r\n                    this.t[n].tab.style.width = this.t[n].conf.width + \"px\"\r\n                }\r\n            }\r\n        }\r\n        this.conf.tabsAreaOfs = null ;\r\n        this._fixTabsOfs();\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.setAlign = function(a) {\r\n        a = (a == \"left\" ? \"left\" : \"right\");\r\n        if (a == this.conf.align) {\r\n            this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = \"0px\";\r\n            return\r\n        }\r\n        if (this.conf.transProp !== false) {\r\n            this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp] = \"\"\r\n        }\r\n        this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = \"\";\r\n        this.conf.align = a;\r\n        this.tabsArea.childNodes[1].childNodes[0].className = \"dhxtabbar_tabs_cont_\" + this.conf.align + this.conf.tabsContCss;\r\n        this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = \"0px\";\r\n        if (this.conf.transProp !== false) {\r\n            this.conf.transValuePos = this.conf.align + \" \" + this.conf.transSpeed;\r\n            this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp] = this.conf.transValuePos\r\n        }\r\n    }\r\n    ;\r\n    this._initObj = function(r) {\r\n        this.conf.initSeq = true;\r\n        this.clearAll();\r\n        var a = false;\r\n        if (r.settings != null ) {\r\n            if (r.settings.skin != null ) {\r\n                this.setSkin(r.settings.skin)\r\n            }\r\n            if (r.settings.close_button != null ) {\r\n                this.enableTabCloseButton(window.dhx4.s2b(r.settings.close_button))\r\n            } else {\r\n                if (r.settings.closeButton != null ) {\r\n                    this.enableTabCloseButton(window.dhx4.s2b(r.settings.closeButton))\r\n                }\r\n            }\r\n            if (r.settings.align != null ) {\r\n                this.setAlign(r.settings.align)\r\n            }\r\n            if (r.settings.hrefmode == \"ajax\") {\r\n                a = true\r\n            }\r\n            if (r.settings.hrefmode == \"ajax-html\") {\r\n                a = true;\r\n                this.conf.url_demand = true\r\n            }\r\n        }\r\n        if (r.tabs != null ) {\r\n            for (var o = 0; o < r.tabs.length; o++) {\r\n                var n = r.tabs[o];\r\n                if (typeof (n.id) == \"undefined\") {\r\n                    n.id = window.dhx4.newId()\r\n                }\r\n                if (!isNaN(parseInt(n.width))) {\r\n                    n.width = parseInt(n.width)\r\n                } else {\r\n                    n.width = null \r\n                }\r\n                this.addTab(n.id, n.text || n.label || \"\", n.width, n.index, window.dhx4.s2b(n.selected) || window.dhx4.s2b(n.active), n.close);\r\n                if (n.content != null ) {\r\n                    this.cells(n.id).attachHTMLString(n.content)\r\n                } else {\r\n                    if (n.href != null ) {\r\n                        if (this.conf.url_demand == true) {\r\n                            this.conf.urls[n.id] = {\r\n                                href: n.href,\r\n                                ajax: a\r\n                            }\r\n                        } else {\r\n                            this.cells(n.id).attachURL(n.href, a)\r\n                        }\r\n                    }\r\n                }\r\n                if (typeof (n.enabled) != \"undefined\" && window.dhx4.s2b(n.enabled) == false) {\r\n                    this.tabs(n.id).disable()\r\n                } else {\r\n                    if (typeof (n.disabled) != \"undefined\" && window.dhx4.s2b(n.disabled) == true) {\r\n                        this.tabs(n.id).disable()\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.conf.initSeq = false;\r\n        if (this.conf.arwMode == \"auto\") {\r\n            this.setSizes()\r\n        }\r\n        if (this.conf.url_demand == true) {\r\n            this._loadURLOnDemand(this.conf.lastActive)\r\n        }\r\n    }\r\n    ;\r\n    this._xmlToObj = function(v) {\r\n        var u = {\r\n            settings: {},\r\n            tabs: []\r\n        };\r\n        var n = v.getElementsByTagName(\"tabbar\")[0];\r\n        if (n != null ) {\r\n            for (var x in {\r\n                skin: 1,\r\n                align: 1,\r\n                closeButton: 1,\r\n                hrefmode: 1\r\n            }) {\r\n                if (n.getAttribute(x) != null ) {\r\n                    u.settings[x] = n.getAttribute(x)\r\n                }\r\n            }\r\n            var A = n.getElementsByTagName(\"tab\");\r\n            for (var o = 0; o < A.length; o++) {\r\n                var s = {\r\n                    text: (A[o].firstChild.nodeValue || \"\")\r\n                };\r\n                for (var x in {\r\n                    id: 1,\r\n                    width: 1,\r\n                    close: 1,\r\n                    selected: 1,\r\n                    active: 1,\r\n                    enabled: 1,\r\n                    disabled: 1,\r\n                    href: 1\r\n                }) {\r\n                    if (A[o].getAttribute(x) != null ) {\r\n                        s[x] = A[o].getAttribute(x)\r\n                    }\r\n                }\r\n                var C = A[o].getElementsByTagName(\"content\")[0];\r\n                if (C != null ) {\r\n                    s.content = \"\";\r\n                    for (var y = 0; y < C.childNodes.length; y++) {\r\n                        s.content += (C.childNodes[y].nodeValue || \"\")\r\n                    }\r\n                }\r\n                u.tabs.push(s)\r\n            }\r\n        }\r\n        return u\r\n    }\r\n    ;\r\n    dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToObj\", \"tabbar\", {\r\n        struct: true\r\n    });\r\n    var e = window.dhx4.transDetect();\r\n    this.conf.transProp = e.transProp;\r\n    this.conf.transEv = e.transEv;\r\n    this.conf.transValueWidth = \"width \" + this.conf.transSpeed;\r\n    e = null ;\r\n    if (this.conf.transProp !== false) {\r\n        this.conf.transValuePos = this.conf.align + \" \" + this.conf.transSpeed;\r\n        this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp] = this.conf.transValuePos\r\n    }\r\n    this._callMainEvent = function(n, a) {\r\n        return this.callEvent(n, a)\r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    if (this.conf.autoload.json != null ) {\r\n        this.loadStruct(this.conf.autoload.json, this.conf.autoload.onload)\r\n    } else {\r\n        if (this.conf.autoload.xml != null ) {\r\n            this.loadStruct(this.conf.autoload.xml, this.conf.autoload.onload)\r\n        } else {\r\n            if (this.conf.autoload.tabs != null ) {\r\n                this.loadStruct({\r\n                    tabs: this.conf.autoload.tabs\r\n                })\r\n            }\r\n        }\r\n    }\r\n    if (this.conf.autoload.arrows_mode != null ) {\r\n        this.setArrowsMode(this.conf.autoload.arrows_mode)\r\n    }\r\n    this._fixTabsOfs();\r\n    this.setSizes();\r\n    return this\r\n}\r\ndhtmlXTabBar.prototype = new dhtmlXCellTop();\r\ndhtmlXTabBar.prototype._fixTabsOfs = function() {\r\n    this.conf.tabsOfs = (this.conf.skin == \"dhx_web\" ? 0 : 1)\r\n}\r\n;\r\ndhtmlXTabBar.prototype.cells = dhtmlXTabBar.prototype.tabs = function(a) {\r\n    if (this.t[a]) {\r\n        return this.t[a].cell\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXTabBar.prototype.getAllTabs = function() {\r\n    var e = [];\r\n    for (var c in this.t) {\r\n        e.push(c)\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXTabBar.prototype._setTabActive = function(c, a) {\r\n    if (!this.t[c] || this.t[c].conf.active) {\r\n        return\r\n    }\r\n    if (typeof (a) == \"undefined\") {\r\n        a = true\r\n    }\r\n    if (a == true && this.callEvent(\"onSelect\", [c, this.conf.lastActive]) !== true) {\r\n        return\r\n    }\r\n    this.setTabInActive();\r\n    this.t[c].conf.active = true;\r\n    if (this.conf.contZone) {\r\n        this.t[c].cell.cell.style.visibility = \"visible\";\r\n        this.t[c].cell.cell.style.top = \"0px\";\r\n        this.t[c].cell.cell.style.zIndex = 1\r\n    }\r\n    this.t[c].tab.className = this._tabCss(c);\r\n    this.conf.lastActive = c;\r\n    this.setSizes();\r\n    if (this.conf.url_demand == true) {\r\n        this._loadURLOnDemand(c)\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype.setTabInActive = function() {\r\n    if (this.conf.lastActive != null  && this.t[this.conf.lastActive]) {\r\n        this.t[this.conf.lastActive].conf.active = false;\r\n        if (this.conf.contZone) {\r\n            this.t[this.conf.lastActive].cell.cell.style.visibility = \"hidden\";\r\n            this.t[this.conf.lastActive].cell.cell.style.top = \"-5000px\";\r\n            this.t[this.conf.lastActive].cell.cell.style.zIndex = 0\r\n        }\r\n        this.t[this.conf.lastActive].tab.className = this._tabCss(this.conf.lastActive);\r\n        this.conf.lastActive = null \r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype._isTabActive = function(a) {\r\n    return ( a == this.conf.lastActive && this.conf.lastActive != null ) \r\n}\r\n;\r\ndhtmlXTabBar.prototype.getActiveTab = function() {\r\n    return this.conf.lastActive\r\n}\r\n;\r\ndhtmlXTabBar.prototype.goToNextTab = function() {\r\n    var a = this._getNextVisible(this.conf.lastActive, true);\r\n    if (a != null ) {\r\n        this._setTabActive(a)\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype.goToPrevTab = function() {\r\n    var a = this._getPrevVisible(this.conf.lastActive, true);\r\n    if (a != null ) {\r\n        this._setTabActive(a)\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype._enableTab = function(c, a) {\r\n    if (!this.t[c] || this.t[c].conf.enabled) {\r\n        return\r\n    }\r\n    this.t[c].conf.enabled = true;\r\n    this.t[c].tab.className = this._tabCss(c);\r\n    if (a == true) {\r\n        this._setTabActive(c)\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype._disableTab = function(c, a) {\r\n    if (!this.t[c] || !this.t[c].conf.enabled) {\r\n        return\r\n    }\r\n    this.t[c].conf.enabled = false;\r\n    this.t[c].tab.className = this._tabCss(c);\r\n    if (a !== false && this.conf.lastActive == c) {\r\n        if (a == true) {\r\n            a = this._getNextVisible(c) || this._getPrevVisible(c)\r\n        }\r\n        this._setTabActive(a)\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype._isTabEnabled = function(a) {\r\n    return ( this.t[a] != null  && this.t[a].conf.enabled == true) \r\n}\r\n;\r\ndhtmlXTabBar.prototype._setTabText = function(g, e, c) {\r\n    if (!this.t[g]) {\r\n        return\r\n    }\r\n    var a = false;\r\n    if (typeof (c) == \"undefined\" || c == null ) {\r\n        c = this._getLabelWidth(e, this.t[g].conf.close);\r\n        a = true\r\n    }\r\n    this.t[g].tab.style.width = c + \"px\";\r\n    this.t[g].tab.childNodes[0].innerHTML = e;\r\n    this.t[g].conf.text = e;\r\n    this.t[g].conf.width = c;\r\n    this.t[g].conf.autowidth = a\r\n}\r\n;\r\ndhtmlXTabBar.prototype._getTabText = function(a) {\r\n    if (!this.t[a]) {\r\n        return null \r\n    }\r\n    return this.t[a].conf.text\r\n}\r\n;\r\ndhtmlXTabBar.prototype._removeTab = function(n, e, l) {\r\n    if (!this.t[n]) {\r\n        return\r\n    }\r\n    if (l != true && this.t[n].conf.remove != true) {\r\n        this.t[n].conf.remove = true;\r\n        this._hideTab(n, e);\r\n        return\r\n    }\r\n    if (typeof (e) == \"undefined\") {\r\n        e = true\r\n    }\r\n    var g = this._getNextVisible(n);\r\n    var h = this._getPrevVisible(n);\r\n    if (this.t[n].conf.transEv == true) {\r\n        this.t[n].tab.removeEventListener(this.conf.transEv, this._doOnTrEnd, false);\r\n        this.t[n].conf.transEv = false\r\n    }\r\n    for (var c in this.t[n].conf) {\r\n        this.t[n].conf[c] = null \r\n    }\r\n    this.t[n].conf = null ;\r\n    delete this.t[n].conf;\r\n    this.t[n].cell._unload();\r\n    this.t[n].cell = null ;\r\n    this.t[n].tab.parentNode.removeChild(this.t[n].tab);\r\n    this.t[n].tab = null ;\r\n    this.t[n] = null ;\r\n    delete this.t[n];\r\n    this.conf.urls[n] = null ;\r\n    delete this.conf.urls[n];\r\n    if (this.conf.lastActive == n) {\r\n        this.conf.lastActive = null ;\r\n        if (e != false) {\r\n            var m = (e == true ? (g || h || this._getFirstVisible()) : e);\r\n            if (m != null ) {\r\n                this._setTabActive(m)\r\n            }\r\n        }\r\n    } else {\r\n        if (l != true) {\r\n            this._adjustTabs()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype.clearAll = function() {\r\n    for (var c in this.t) {\r\n        this._removeTab(c, false, true)\r\n    }\r\n    this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = \"0px\"\r\n}\r\n;\r\ndhtmlXTabBar.prototype.moveTab = function(e, a) {\r\n    if (!this.t[e] || a < 0) {\r\n        return\r\n    }\r\n    a += 1;\r\n    var c = this.tabsArea.childNodes[1].firstChild;\r\n    if (c.childNodes[a] != this.t[e].tab) {\r\n        c.removeChild(this.t[e].tab);\r\n        if (a >= c.childNodes.length) {\r\n            c.appendChild(this.t[e].tab)\r\n        } else {\r\n            c.insertBefore(this.t[e].tab, c.childNodes[a])\r\n        }\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXTabBar.prototype._getIndex = function(g) {\r\n    var a = -1;\r\n    var e = this.tabsArea.childNodes[1].firstChild;\r\n    for (var c = 1; c < e.childNodes.length; c++) {\r\n        if (e.childNodes[c]._tabId == g) {\r\n            a = c - 1\r\n        }\r\n    }\r\n    e = null ;\r\n    return a\r\n}\r\n;\r\ndhtmlXTabBar.prototype.getNumberOfTabs = function(g) {\r\n    var e = 0;\r\n    for (var c in this.t) {\r\n        e += (g != true ? 1 : (this.t[c].conf.visible == true ? 1 : 0))\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXTabBar.prototype.forEachCell = dhtmlXTabBar.prototype.forEachTab = function(e) {\r\n    for (var c in this.t) {\r\n        e.apply(window, [this.t[c].cell])\r\n    }\r\n}\r\n;\r\ndhtmlXTabBar.prototype.enableAutoReSize = function() {\r\n    this._initFSResize()\r\n}\r\n;\r\ndhtmlXTabBar.prototype.setArrowsMode = function(a) {\r\n    a = {\r\n        auto: \"auto\",\r\n        always: \"always\"\r\n    }[String(a)];\r\n    if (a == null  || a == this.conf.mode) {\r\n        return\r\n    }\r\n    this.conf.arwMode = a;\r\n    if (a == \"always\") {\r\n        this.tabsArea.childNodes[0].className = \"dhxtabbar_tabs_ar_left\";\r\n        this.tabsArea.childNodes[2].className = \"dhxtabbar_tabs_ar_right\"\r\n    }\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXTabBar.prototype._checkArrows = function() {\r\n    var h = false;\r\n    if (this.conf.arwMode == \"auto\") {\r\n        var g = 0;\r\n        for (var e in this.t) {\r\n            g += this.t[e].tab.offsetWidth\r\n        }\r\n        var c = this.tabsArea.childNodes[0];\r\n        var l = this.tabsArea.childNodes[2];\r\n        if (g > this.cont.offsetWidth) {\r\n            if (c.className.search(/dhxtabbar_tabs_ar_hidden/) >= 0) {\r\n                c.className = c.className.replace(/\\s{0,}dhxtabbar_tabs_ar_hidden/, \"\");\r\n                l.className = l.className.replace(/\\s{0,}dhxtabbar_tabs_ar_hidden/, \"\");\r\n                h = true\r\n            }\r\n        } else {\r\n            if (c.className.search(/dhxtabbar_tabs_ar_hidden/) < 1) {\r\n                c.className += \" dhxtabbar_tabs_ar_hidden\";\r\n                l.className += \" dhxtabbar_tabs_ar_hidden\";\r\n                h = true\r\n            }\r\n        }\r\n        c = l = null \r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXTabBar.prototype._loadURLOnDemand = function(a) {\r\n    if (a != null  && this.conf.urls[a] != null ) {\r\n        this.cells(a).attachURL(this.conf.urls[a].href, this.conf.urls[a].ajax);\r\n        this.conf.urls[a] = null \r\n    }\r\n}\r\n;\r\nwindow.dhtmlXTabBarCell = function(g, e) {\r\n    dhtmlXCellObject.apply(this, [g, \"_tabbar\"]);\r\n    this.tabbar = e;\r\n    this.conf.skin = this.tabbar.conf.skin;\r\n    this.conf.tabbar_funcs = {\r\n        show: \"_showTab\",\r\n        hide: \"_hideTab\",\r\n        isVisible: \"_isTabVisible\",\r\n        enable: \"_enableTab\",\r\n        disable: \"_disableTab\",\r\n        isEnabled: \"_isTabEnabled\",\r\n        getIndex: \"_getIndex\",\r\n        getText: \"_getTabText\",\r\n        setText: \"_setTabText\",\r\n        setActive: \"_setTabActive\",\r\n        isActive: \"_isTabActive\",\r\n        close: \"_removeTab\"\r\n    };\r\n    this._tabbarCall = function(a) {\r\n        return function() {\r\n            var h = [this._idd];\r\n            for (var l = 0; l < arguments.length; l++) {\r\n                h.push(arguments[l])\r\n            }\r\n            return this.tabbar[a].apply(this.tabbar, h)\r\n        }\r\n    }\r\n    ;\r\n    for (var c in this.conf.tabbar_funcs) {\r\n        if (typeof (this[c]) != \"function\") {\r\n            this[c] = this._tabbarCall(this.conf.tabbar_funcs[c])\r\n        }\r\n    }\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        this.tabbar = null ;\r\n        for (var h in this.conf.tabbar_funcs) {\r\n            this[h] = null ;\r\n            this.conf.tabbar_funcs[h] = null \r\n        }\r\n        this.conf.tabbar_funcs = null \r\n    });\r\n    this.attachEvent(\"_onContentLoaded\", function() {\r\n        this.tabbar._callMainEvent(\"onContentLoaded\", arguments);\r\n        this.tabbar._callMainEvent(\"onTabContentLoaded\", arguments)\r\n    });\r\n    this.attachEvent(\"_onContentAttach\", function() {\r\n        this.tabbar._adjustCell(this.tabbar.conf.lastActive)\r\n    });\r\n    this.attachEvent(\"_onBeforeContentAttach\", function(a) {\r\n        if (a == \"sidebar\" && this.conf.skin != \"dhx_skyblue\") {\r\n            this._hideBorders()\r\n        }\r\n    })\r\n}\r\n;\r\nwindow.dhtmlXTabBarCell.prototype = new dhtmlXCellObject();\r\ndhtmlXCellObject.prototype.attachTabbar = function(a) {\r\n    this.callEvent(\"_onBeforeContentAttach\", [\"tabbar\"]);\r\n    if (typeof (a) == \"string\") {\r\n        a = {\r\n            mode: a\r\n        }\r\n    } else {\r\n        if (typeof (a) != \"object\" || a == null ) {\r\n            a = {}\r\n        }\r\n    }\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.width = \"100%\";\r\n    c.style.height = \"100%\";\r\n    c.style.position = \"relative\";\r\n    c.style.overflow = \"hidden\";\r\n    if (typeof (window.dhtmlXAccordionCell) == \"function\" && this instanceof window.dhtmlXAccordionCell) {\r\n        c._ofs = {\r\n            t: -1\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXTabBarCell) == \"function\" && this instanceof window.dhtmlXTabBarCell) {\r\n        if (this.conf.skin == \"dhx_skyblue\") {\r\n            c._ofs = {\r\n                t: -1,\r\n                r: -1,\r\n                b: -1,\r\n                l: -1\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXSideBarCell) == \"function\" && this instanceof window.dhtmlXSideBarCell) {\r\n        c._ofs = {\r\n            l: -1\r\n        };\r\n        if (this.conf.skin == \"dhx_web\" && this.sidebar.conf.autohide == true) {\r\n            c._ofs.l = 0\r\n        }\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            if (this.sidebar.conf.autohide == true) {\r\n                c._ofs.l = 0\r\n            }\r\n            if (this.sidebar.conf.header == true) {\r\n                c._ofs.t = -1\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.dhtmlXCarouselCell) == \"function\" && this instanceof window.dhtmlXCarouselCell) {\r\n        this._hideBorders()\r\n    }\r\n    this._attachObject(c);\r\n    a.skin = this.conf.skin;\r\n    a.parent = c;\r\n    this.dataType = \"tabbar\";\r\n    this.dataObj = new dhtmlXTabBar(a);\r\n    a.parent = c = null ;\r\n    a = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\nfunction dhtmlXTabBarInitFromHTML() {\r\n    var z = document.getElementsByTagName(\"div\");\r\n    for (var i = 0; i < z.length; i++) {\r\n        if (z[i].className.indexOf(\"dhtmlxTabBar\") != -1) {\r\n            var conf = {\r\n                settings: {},\r\n                tabs: []\r\n            };\r\n            var n = z[i];\r\n            var id = n.id;\r\n            n.className = \"\";\r\n            var k = new Array();\r\n            for (var j = 0; j < n.childNodes.length; j++) {\r\n                if (n.childNodes[j].tagName && n.childNodes[j].tagName != \"!\") {\r\n                    k[k.length] = n.childNodes[j]\r\n                }\r\n            }\r\n            var skin = n.getAttribute(\"skin\");\r\n            if (skin != null ) {\r\n                conf.settings.skin = skin\r\n            }\r\n            var w = new dhtmlXTabBar({\r\n                parent: id,\r\n                mode: n.getAttribute(\"mode\")\r\n            });\r\n            window[id] = w;\r\n            acs = n.getAttribute(\"onbeforeinit\");\r\n            if (acs) {\r\n                eval(acs)\r\n            }\r\n            align = n.getAttribute(\"align\");\r\n            if (align) {\r\n                conf.settings.align = align\r\n            }\r\n            var cont = {};\r\n            for (var j = 0; j < k.length; j++) {\r\n                var m = k[j];\r\n                var tab = {\r\n                    id: m.id,\r\n                    text: m.getAttribute(\"name\"),\r\n                    width: m.getAttribute(\"width\"),\r\n                    selected: m.getAttribute(\"selected\"),\r\n                    active: m.getAttribute(\"active\"),\r\n                    close: m.getAttribute(\"close\")\r\n                };\r\n                var href = m.getAttribute(\"href\");\r\n                if (href) {\r\n                    cont[m.id] = {\r\n                        href: href\r\n                    }\r\n                } else {\r\n                    cont[m.id] = {\r\n                        cont: m\r\n                    }\r\n                }\r\n                conf.tabs.push(tab)\r\n            }\r\n            w.loadStruct(conf);\r\n            for (var a in cont) {\r\n                if (cont[a].href) {\r\n                    w.cells(a).attachURL(cont[a].href);\r\n                    cont[a].href = null \r\n                } else {\r\n                    w.cells(a).attachObject(cont[a].cont);\r\n                    if (cont[a].cont.style.display == \"none\") {\r\n                        cont[a].cont.style.display = \"\"\r\n                    }\r\n                    cont[a].cont = null \r\n                }\r\n                cont[a] = null \r\n            }\r\n            var selId = n.getAttribute(\"select\");\r\n            if (selId != null ) {\r\n                w.tabs(selId).setActive()\r\n            } else {\r\n                if (w.getActiveTab() == null ) {\r\n                    var v = w._getFirstVisible();\r\n                    if (v != null ) {\r\n                        w.cells(v).setActive()\r\n                    }\r\n                }\r\n            }\r\n            acs = n.getAttribute(\"oninit\");\r\n            if (acs) {\r\n                eval(acs)\r\n            }\r\n        }\r\n    }\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        window.removeEventListener(\"load\", dhtmlXTabBarInitFromHTML, false)\r\n    } else {\r\n        window.detachEvent(\"onload\", dhtmlXTabBarInitFromHTML)\r\n    }\r\n}\r\nif (typeof (window.addEventListener) == \"function\") {\r\n    window.addEventListener(\"load\", dhtmlXTabBarInitFromHTML, false)\r\n} else {\r\n    window.attachEvent(\"onload\", dhtmlXTabBarInitFromHTML)\r\n}\r\nfunction dhtmlXSideBar(c) {\r\n    var e = this;\r\n    this.conf = {\r\n        skin: (c.skin || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxsidebar\") || \"dhx_skyblue\"),\r\n        css: \"dhxsidebar\",\r\n        width: c.width || 200,\r\n        scroll_size: 12,\r\n        scroll_mult: 20,\r\n        close_button: false,\r\n        icons_path: c.icons_path || \"\",\r\n        selected: null ,\r\n        single_cell: (typeof (c.single_cell) == \"undefined\" ? false : window.dhx4.s2b(c.single_cell)),\r\n        cell: null ,\r\n        header: window.dhx4.s2b(c.header),\r\n        autohide: window.dhx4.s2b(c.autohide),\r\n        animate_items: true\r\n    };\r\n    this.setTemplate(c.template);\r\n    window.dhtmlXCellTop.apply(this, [c.parent, (c == null  ? null  : c.offsets)]);\r\n    window.dhx4._eventable(this);\r\n    if (window.navigator.msPointerEnabled == true) {\r\n        this.conf.touch_ms = true;\r\n        this.conf.touch_start = \"MSPointerDown\",\r\n        this.conf.touch_end = \"MSPointerUp\"\r\n    } else {\r\n        this.conf.touch_ms = false;\r\n        this.conf.touch_start = \"touchstart\",\r\n        this.conf.touch_end = \"touchend\"\r\n    }\r\n    this.side = document.createElement(\"DIV\");\r\n    this.side.className = \"dhxsidebar_side dhxsidebar_tpl_\" + this.conf.tpl_name;\r\n    this.side.innerHTML = \"<div class='dhxsidebar_side_items'></div>\";\r\n    this.cont.appendChild(this.side);\r\n    this.arw = document.createElement(\"DIV\");\r\n    this.arw.className = \"dhxsidebar_arrows dhxsidebar_arrows_hidden\";\r\n    this.arw.innerHTML = \"<div class='dhxsidebar_arrow dhxsidebar_arrow_left'><div class='dhxsidebar_arrow_image'></div></div><div class='dhxsidebar_arrow dhxsidebar_arrow_right'><div class='dhxsidebar_arrow_image'></div></div>\";\r\n    this.cont.appendChild(this.arw);\r\n    if (this.conf.autohide == true) {\r\n        this.hideSide();\r\n        this.cont.className += \" dhxsidebar_autohide\";\r\n        this._doOnBodyClick = function() {\r\n            if (e.conf.clear_click == true) {\r\n                e.conf.clear_click = false;\r\n                return\r\n            }\r\n            e.hideSide()\r\n        }\r\n        ;\r\n        this._doOnEscDown = function(g) {\r\n            g = g || event;\r\n            if (g.keyCode == 27) {\r\n                e.conf.clear_click = false;\r\n                e.hideSide()\r\n            }\r\n        }\r\n        ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.addEventListener(this.conf.touch_start, this._doOnBodyClick, false);\r\n            window.addEventListener(\"click\", this._doOnBodyClick, false);\r\n            window.addEventListener(\"keydown\", this._doOnEscDown, false)\r\n        } else {\r\n            document.body.attachEvent(\"onclick\", this._doOnBodyClick);\r\n            document.body.attachEvent(\"onkeydown\", this._doOnEscDown)\r\n        }\r\n    }\r\n    window.setTimeout(function() {\r\n        if (e != null  && e.side != null ) {\r\n            e.side.firstChild.style.top = \"0px\"\r\n        }\r\n    }, 1);\r\n    this._doOnArwClick = function(h) {\r\n        h = h || event;\r\n        if (h.type != \"click\" && h.preventDefault) {\r\n            h.preventDefault()\r\n        }\r\n        h.cancelBubble = true;\r\n        var g = h.target || h.srcElement;\r\n        if (g.className.match(/dhxsidebar_arrow_image/) != null ) {\r\n            g = g.parentNode\r\n        }\r\n        if (g.className.match(/dhxsidebar_arrow_left/) != null ) {\r\n            e._scrollSide(-e.conf.scroll_size)\r\n        } else {\r\n            if (g.className.match(/dhxsidebar_arrow_right/) != null ) {\r\n                e._scrollSide(e.conf.scroll_size)\r\n            }\r\n        }\r\n        g = null \r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.arw.addEventListener(this.conf.touch_start, this._doOnArwClick, false);\r\n        this.arw.addEventListener(\"click\", this._doOnArwClick, false)\r\n    } else {\r\n        this.arw.attachEvent(\"onclick\", this._doOnArwClick)\r\n    }\r\n    this._doOnSideClick = function(l) {\r\n        l = l || event;\r\n        var h = l.target || l.srcElement;\r\n        var m = null ;\r\n        var g = false;\r\n        e.conf.clear_click = true;\r\n        if (l.type == \"touchstart\" || l.type == \"pointerdown\" || l.type == \"MSPointerDown\") {\r\n            if (l.preventDefault) {\r\n                l.preventDefault()\r\n            }\r\n            if (this.className.match(/dhxsidebar_touch/gi) == null ) {\r\n                if (l.type == \"touchstart\" || (l.type == \"pointerdown\" && l.pointerType == \"touch\")) {\r\n                    this.className += \" dhxsidebar_touch\"\r\n                }\r\n            }\r\n        }\r\n        while (h != null  && m == null  && l.type != \"pointerdown\" && l.type != \"MSPointerDown\") {\r\n            if (typeof (h.className) != \"undefined\") {\r\n                if (h.className.match(/^dhxsidebar_item/) != null  && typeof (h._idd) != \"undefined\") {\r\n                    m = h._idd\r\n                } else {\r\n                    if (h.className.match(/^dhxsidebar_bubble/) != null ) {\r\n                        g = true;\r\n                        m = h.parentNode._idd\r\n                    }\r\n                }\r\n            }\r\n            h = h.parentNode\r\n        }\r\n        if (m != null ) {\r\n            if (g == false || (g == true && e.callEvent(\"onBubbleClick\", [m, e.t[m].conf.bubble]) == true)) {\r\n                e._setItemActive(m, true)\r\n            }\r\n        }\r\n        h = null \r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.side.addEventListener(this.conf.touch_start, this._doOnSideClick, false);\r\n        this.side.addEventListener(this.conf.touch_end, this._doOnSideClick, false);\r\n        this.side.addEventListener(\"mouseup\", this._doOnSideClick, false)\r\n    } else {\r\n        this.side.attachEvent(\"onclick\", this._doOnSideClick)\r\n    }\r\n    this.side.onmouseover = function() {\r\n        this.className = this.className.replace(/\\s*dhxsidebar_touch/gi, \"\")\r\n    }\r\n    ;\r\n    this._doOnSideScroll = function(g) {\r\n        g = g || event;\r\n        var h = (g.type == \"mousewheel\" ? -g.wheelDelta : g.deltaY);\r\n        e._scrollSide(h / Math.abs(h) * 3)\r\n    }\r\n    ;\r\n    this._scrollSide = function(g) {\r\n        var h = parseInt(this.side.firstChild.style.top || 0) - g * this.conf.scroll_mult;\r\n        if (h + this.side.firstChild.offsetHeight < this.side.clientHeight) {\r\n            h = this.side.clientHeight - this.side.firstChild.offsetHeight\r\n        }\r\n        if (h > 0) {\r\n            h = 0\r\n        }\r\n        this.side.firstChild.style.top = h + \"px\"\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.side.addEventListener(\"wheel\", this._doOnSideScroll, false)\r\n    } else {\r\n        this.side.attachEvent(\"onmousewheel\", this._doOnSideScroll)\r\n    }\r\n    this.t = {};\r\n    this.s = {};\r\n    this._adjustCell = function(r, n) {\r\n        if (this.conf.single_cell != true && r == null ) {\r\n            return\r\n        }\r\n        var g = (this.conf.autohide == true ? 0 : this.conf.width);\r\n        var l = this.cont.offsetWidth - g;\r\n        var o = 0;\r\n        var m = this.cont.offsetHeight;\r\n        if (this.conf.single_cell == true) {\r\n            if (n == true) {\r\n                this.conf.cell._setSize(g, o, l, m)\r\n            }\r\n        } else {\r\n            if (r != this.conf.selected) {\r\n                o = -5000;\r\n                this.t[r].cell.cell.style.visibility = \"hidden\";\r\n                this.t[r].cell.cell.style.zIndex = 0\r\n            }\r\n            this.t[r].cell._setSize(g, o, l, m)\r\n        }\r\n    }\r\n    ;\r\n    var a = window.dhx4.transDetect();\r\n    this.conf.transProp = a.transProp;\r\n    this.conf.transEv = a.transEv;\r\n    this.conf.transValue = \"all 0.1s\";\r\n    this._doOnTrEnd = function(h) {\r\n        var m = this._idd;\r\n        if (e.t[m] == null ) {\r\n            return\r\n        }\r\n        var g = e.t[m];\r\n        var l = g.conf.transActvId;\r\n        if (g.conf.transMode == \"hide\") {\r\n            if (g.conf.remove == true) {\r\n                e._removeItem(m)\r\n            } else {\r\n                g.item.style[g.conf.transProp] = \"\";\r\n                if (e.conf.single_cell != true) {\r\n                    g.cell.cell.style.visibility = \"hidden\";\r\n                    g.cell.cell.style.top = \"-5000px\"\r\n                }\r\n                g.conf.transActv = false\r\n            }\r\n        } else {\r\n            if (g.conf.transMode == \"show\") {\r\n                g.item.style[g.conf.transProp] = \"\";\r\n                g.item.style.visibility = \"visible\";\r\n                g.conf.transMode = null ;\r\n                g.conf.transActv = false\r\n            }\r\n        }\r\n        if (l != null ) {\r\n            e._setItemActive(l)\r\n        } else {\r\n            e._checkHeight()\r\n        }\r\n        g = null \r\n    }\r\n    ;\r\n    this._initObj = function(g) {\r\n        this.clearAll();\r\n        if (g.items != null ) {\r\n            this.addItem(g.items)\r\n        }\r\n    }\r\n    ;\r\n    this._xmlToObj = function(s) {\r\n        var h = [];\r\n        var n = s.getElementsByTagName(\"sidebar\");\r\n        if (n != null  && n[0] != null ) {\r\n            var l = n[0].getElementsByTagName(\"item\");\r\n            for (var o = 0; o < l.length; o++) {\r\n                var m = {};\r\n                for (var g = 0; g < l[o].attributes.length; g++) {\r\n                    m[l[o].attributes[g].nodeName] = l[o].attributes[g].nodeValue\r\n                }\r\n                h.push(m)\r\n            }\r\n        }\r\n        return {\r\n            items: h\r\n        }\r\n    }\r\n    ;\r\n    dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToObj\", \"sidebar\", {\r\n        struct: true\r\n    });\r\n    this.unload = function() {\r\n        this.conf.unloading = true;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.side.removeEventListener(\"wheel\", this._doOnSideScroll, false)\r\n        } else {\r\n            this.side.detachEvent(\"onmousewheel\", this._doOnSideScroll)\r\n        }\r\n        if (this.conf.autohide == true) {\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                window.removeEventListener(\"click\", this._doOnBodyClick, false);\r\n                window.removeEventListener(\"keydown\", this._doOnEscDown, false)\r\n            } else {\r\n                document.body.detachEvent(\"onclick\", this._doOnBodyClick);\r\n                document.body.detachEvent(\"onkeydown\", this._doOnEscDown)\r\n            }\r\n        }\r\n        if (typeof (this._sideCoverDetach) == \"function\") {\r\n            this._sideCoverDetach()\r\n        }\r\n        this.clearAll();\r\n        this.s = this.t = null ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.arw.removeEventListener(this.conf.touch_start, this._doOnArwClick, false);\r\n            this.arw.removeEventListener(\"click\", this._doOnArwClick, false)\r\n        } else {\r\n            this.arw.detachEvent(\"onclick\", this._doOnArwClick)\r\n        }\r\n        this.arw.parentNode.removeChild(this.arw);\r\n        this.arw = null ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.side.removeEventListener(this.conf.touch_start, this._doOnSideClick, false);\r\n            this.side.removeEventListener(this.conf.touch_end, this._doOnSideClick, false);\r\n            this.side.removeEventListener(\"click\", this._doOnSideClick, false)\r\n        } else {\r\n            this.side.detachEvent(\"onclick\", this._doOnSideClick)\r\n        }\r\n        this.side.onmouseover = null ;\r\n        this.side.parentNode.removeChild(this.side);\r\n        this.side = null ;\r\n        this._unloadTop();\r\n        if (this.conf.single_cell == true) {\r\n            this.conf.cell._unload();\r\n            this.conf.cell = null \r\n        }\r\n        window.dhx4._eventable(this, \"clear\");\r\n        window.dhx4._enableDataLoading(this, null , null , null , \"clear\");\r\n        for (var g in this) {\r\n            this[g] = null \r\n        }\r\n        e = null \r\n    }\r\n    ;\r\n    if (this.conf.single_cell == true) {\r\n        this.conf.cell = new dhtmlXSideBarCell(\"master\",this);\r\n        this.cont.appendChild(this.conf.cell.cell);\r\n        this._cells_native = this.cells;\r\n        this.cells = function(g) {\r\n            this.conf.cell._idd = g;\r\n            return this.conf.cell\r\n        }\r\n    }\r\n    this.setSizes();\r\n    if (c.items != null ) {\r\n        this._initObj(c)\r\n    } else {\r\n        if (c.json != null ) {\r\n            this.loadStruct(c.json, c.onload)\r\n        } else {\r\n            if (c.xml != null ) {\r\n                this.loadStruct(c.xml, c.onload)\r\n            }\r\n        }\r\n    }\r\n    return this\r\n}\r\ndhtmlXSideBar.prototype = new dhtmlXCellTop();\r\ndhtmlXSideBar.prototype._addItem = function(c) {\r\n    var g = (typeof (c.id) != \"undefined\" ? c.id : window.dhx4.newId());\r\n    if (c.type == \"separator\") {\r\n        var e = document.createElement(\"DIV\");\r\n        e.className = \"dhxsidebar_sep\";\r\n        this.side.firstChild.appendChild(e);\r\n        this.s[g] = {\r\n            sep: e\r\n        };\r\n        e = null ;\r\n        return\r\n    }\r\n    c.icons_path = this.conf.icons_path;\r\n    var e = document.createElement(\"DIV\");\r\n    e.className = \"dhxsidebar_item\";\r\n    e.innerHTML = window.dhx4.template(this.conf.tpl_str, c);\r\n    e._idd = g;\r\n    this.side.firstChild.appendChild(e);\r\n    e.ondragstart = function() {\r\n        return false\r\n    }\r\n    ;\r\n    if (this.conf.single_cell == true) {\r\n        var a = this.conf.cell\r\n    } else {\r\n        var a = new dhtmlXSideBarCell(g,this);\r\n        this.cont.appendChild(a.cell)\r\n    }\r\n    this.t[g] = {\r\n        item: e,\r\n        cell: a,\r\n        init: c,\r\n        conf: {\r\n            selected: false,\r\n            visible: true,\r\n            close: close\r\n        }\r\n    };\r\n    if (typeof (c.bubble) != \"undefined\") {\r\n        this._setItemBubble(g, c.bubble)\r\n    }\r\n    if (this.conf.header == true) {\r\n        a.setHeaderText(window.dhx4.template(this.tpl_header, c))\r\n    }\r\n    a = e = null ;\r\n    if (window.dhx4.s2b(c.selected) == true) {\r\n        this._setItemActive(g)\r\n    } else {\r\n        this._adjustCell(g)\r\n    }\r\n    this._checkHeight()\r\n}\r\n;\r\ndhtmlXSideBar.prototype.addItem = function(a) {\r\n    if (!(a instanceof Array)) {\r\n        a = [a]\r\n    }\r\n    for (var c = 0; c < a.length; c++) {\r\n        this._addItem(a[c])\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.items = dhtmlXSideBar.prototype.cells = function(a) {\r\n    if (this.conf.single_cell == true) {\r\n        return this.conf.cell\r\n    }\r\n    if (this.t[a] != null ) {\r\n        return this.t[a].cell\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXSideBar.prototype.forEachCell = dhtmlXSideBar.prototype.forEachItem = function(e) {\r\n    if (this.conf.single_cell == true) {\r\n        if (typeof (e) == \"function\") {\r\n            e.apply(window, [this.conf.cell])\r\n        } else {\r\n            if (typeof (e) == \"string\" && typeof (window[e]) == \"function\") {\r\n                window[e].apply(window, [this.conf.cell])\r\n            }\r\n        }\r\n        return\r\n    }\r\n    for (var c in this.t) {\r\n        if (typeof (e) == \"function\") {\r\n            e.apply(window, [this.t[c].cell])\r\n        } else {\r\n            if (typeof (e) == \"string\" && typeof (window[e]) == \"function\") {\r\n                window[e].apply(window, [this.t[c].cell])\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.getAllItems = function() {\r\n    var e = [];\r\n    for (var c in this.t) {\r\n        e.push(c)\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXSideBar.prototype.getNumberOfItems = function() {\r\n    return this.getAllItems().length\r\n}\r\n;\r\ndhtmlXSideBar.prototype.clearAll = function() {\r\n    for (var c in this.t) {\r\n        this._removeItem(c, false, true)\r\n    }\r\n    for (var c in this.s) {\r\n        this.removeSep(c)\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.setSizes = function() {\r\n    this._adjustCont();\r\n    this._adjustSide();\r\n    this._checkHeight();\r\n    this._adjustCell(this.conf.selected, true);\r\n    this.callEvent(\"_onSetSizes\", [])\r\n}\r\n;\r\ndhtmlXSideBar.prototype.setSideWidth = function(a) {\r\n    this.conf.width = a;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXSideBar.prototype._adjustSide = function() {\r\n    if (this.conf.side_ofs == null ) {\r\n        this.conf.side_ofs = {};\r\n        this.side.style.width = this.conf.width + \"px\";\r\n        this.side.style.height = this.side.parentNode.offsetHeight + \"px\";\r\n        this.conf.side_ofs.w = this.side.offsetWidth - parseInt(this.side.style.width);\r\n        this.conf.side_ofs.h = this.side.offsetHeight - parseInt(this.side.style.height)\r\n    }\r\n    this.side.style.width = this.conf.width - this.conf.side_ofs.w + \"px\";\r\n    this.side.style.height = this.side.parentNode.offsetHeight - this.arw.offsetHeight - this.conf.side_ofs.h + \"px\";\r\n    this.arw.style.width = this.side.style.width;\r\n    this._scrollSide(0)\r\n}\r\n;\r\ndhtmlXSideBar.prototype._checkHeight = function() {\r\n    var a = (this.arw.className.match(/dhxsidebar_arrows_hidden/) != null );\r\n    if (this.conf.side_hfix == null ) {\r\n        this.conf.side_hfix = this.side.offsetHeight - this.side.clientHeight\r\n    }\r\n    if (this.side.firstChild.offsetHeight > this.side.parentNode.clientHeight - this.conf.side_hfix) {\r\n        if (a == true) {\r\n            this.arw.className = \"dhxsidebar_arrows\";\r\n            this._adjustSide()\r\n        }\r\n    } else {\r\n        if (a == false) {\r\n            this.arw.className = \"dhxsidebar_arrows dhxsidebar_arrows_hidden\";\r\n            this.side.firstChild.style.top = \"0px\";\r\n            this._adjustSide()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.removeSep = function(c) {\r\n    if (this.s[c] == null ) {\r\n        return\r\n    }\r\n    this.side.firstChild.removeChild(this.s[c].sep);\r\n    this.s[c].sep = null ;\r\n    this.s[c] = null ;\r\n    try {\r\n        delete this.s[c]\r\n    } catch (a) {}\r\n}\r\n;\r\ndhtmlXSideBar.prototype.showSide = function() {\r\n    if (this.conf.autohide != true) {\r\n        return\r\n    }\r\n    if (this.sideCover == null ) {\r\n        this._sideCoverAttach()\r\n    }\r\n    if (this.conf.animate_items == true) {\r\n        var e = function(l, a, m) {\r\n            window.setTimeout(function() {\r\n                l.style[m] = \"transform 0.3s\";\r\n                l.style.transform = \"translate(0px,0px)\";\r\n                l = null \r\n            }, a)\r\n        }\r\n        ;\r\n        if (this.conf.transProp !== false) {\r\n            var h = 100;\r\n            for (var c in this.t) {\r\n                this.t[c].item.style[this.conf.transProp] = \"\";\r\n                this.t[c].item.style.transform = \"translate(-\" + (this.conf.width + 20) + \"px,0px)\";\r\n                e(this.t[c].item, h += 50, this.conf.transProp)\r\n            }\r\n        }\r\n    }\r\n    var g = this;\r\n    window.setTimeout(function() {\r\n        g.arw.style.left = g.side.style.left = \"0px\";\r\n        g.sideCover.className = \"dhxsidebar_side_cover dhxsidebar_side_cover_actv\";\r\n        g = null \r\n    }, 50)\r\n}\r\n;\r\ndhtmlXSideBar.prototype.hideSide = function(a) {\r\n    if (this.conf.autohide != true) {\r\n        return\r\n    }\r\n    this.arw.style.left = this.side.style.left = -this.conf.width - 10 + \"px\";\r\n    if (this.sideCover != null ) {\r\n        if (this.conf.transProp !== false) {\r\n            this.sideCover.className = \"dhxsidebar_side_cover\"\r\n        } else {\r\n            this._sideCoverDetach()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._sideCoverAttach = function() {\r\n    var a = this;\r\n    this.sideCover = document.createElement(\"DIV\");\r\n    this.sideCover.className = \"dhxsidebar_side_cover\";\r\n    if (this.arw.nextSibling != null ) {\r\n        this.cont.insertBefore(this.sideCover, this.arw.nextSibling)\r\n    } else {\r\n        this.cont.appendChild(this.sideCover)\r\n    }\r\n    this._sideCoverOnTrEnd = function() {\r\n        if (this.className.match(/dhxsidebar_side_cover_actv/) == null ) {\r\n            a._sideCoverDetach()\r\n        }\r\n    }\r\n    ;\r\n    this._sideCoverDetach = function() {\r\n        if (this.sideCover == null ) {\r\n            return\r\n        }\r\n        if (this.conf.transProp !== false) {\r\n            this.sideCover.removeEventListener(this.conf.transEv, this._sideCoverOnTrEnd, false)\r\n        }\r\n        this.sideCover.parentNode.removeChild(this.sideCover);\r\n        this.sideCover = null ;\r\n        a = null \r\n    }\r\n    ;\r\n    if (this.conf.transProp !== false) {\r\n        this.sideCover.addEventListener(this.conf.transEv, this._sideCoverOnTrEnd, false)\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._setItemActive = function(e, c) {\r\n    if (this.conf.selected == e) {\r\n        if (this.conf.autohide == true) {\r\n            this.hideSide()\r\n        }\r\n        return\r\n    }\r\n    if (typeof (c) == \"undefined\") {\r\n        c = false\r\n    }\r\n    if (c == true && this.callEvent(\"onBeforeSelect\", [e, this.conf.selected]) !== true) {\r\n        return\r\n    }\r\n    var a = null ;\r\n    if (this.conf.selected != null ) {\r\n        a = this.conf.selected;\r\n        this._setItemInactive(this.conf.selected)\r\n    }\r\n    if (this.t[e] != null ) {\r\n        this.conf.selected = e;\r\n        this.t[e].selected = true;\r\n        this.t[e].item.className += \" dhxsidebar_item_selected\";\r\n        if (this.conf.single_cell != true) {\r\n            this.t[e].cell.cell.style.visibility = \"visible\";\r\n            this.t[e].cell.cell.style.top = \"0px\";\r\n            this.t[e].cell.cell.style.zIndex = 1\r\n        }\r\n    } else {\r\n        this.conf.selected = null \r\n    }\r\n    this._adjustCell(e);\r\n    if (c == true) {\r\n        this.callEvent(\"onSelect\", [e, a])\r\n    }\r\n    if (this.conf.autohide == true) {\r\n        this.hideSide()\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._setItemInactive = function(a) {\r\n    if (this.t[a] == null ) {\r\n        return\r\n    }\r\n    this.t[a].selected = false;\r\n    this.t[a].item.className = this.t[a].item.className.replace(/\\s{0,}dhxsidebar_item_selected/gi, \"\");\r\n    if (this.conf.single_cell != true) {\r\n        this.t[a].cell.cell.style.visibility = \"hidden\";\r\n        this.t[a].cell.cell.style.top = \"-5000px\";\r\n        this.t[a].cell.cell.style.zIndex = 0\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._isItemActive = function(a) {\r\n    return ( this.conf.selected == a) \r\n}\r\n;\r\ndhtmlXSideBar.prototype._getNextVisible = function(c, a) {\r\n    return this._getNearVisible(c, a, \"next\")\r\n}\r\n;\r\ndhtmlXSideBar.prototype._getPrevVisible = function(c, a) {\r\n    return this._getNearVisible(c, a, \"previous\")\r\n}\r\n;\r\ndhtmlXSideBar.prototype._getFirstVisible = function() {\r\n    return this._getNearVisible(null , false, \"first\")\r\n}\r\n;\r\ndhtmlXSideBar.prototype._getNearVisible = function(l, c, h) {\r\n    if (h == \"first\") {\r\n        var e = this.side.firstChild.firstChild;\r\n        h = \"next\"\r\n    } else {\r\n        if (l == null  || this.t[l] == null ) {\r\n            return ( c ? this._getFirstVisible() : null ) \r\n        }\r\n        var e = this.t[l].item[h + \"Sibling\"]\r\n    }\r\n    var g = null ;\r\n    while (e != null  && g == null ) {\r\n        var a = e._idd;\r\n        if (a != null  && g == null  && this.t[a].conf.visible) {\r\n            g = a\r\n        } else {\r\n            e = e[h + \"Sibling\"]\r\n        }\r\n    }\r\n    e = null ;\r\n    return g\r\n}\r\n;\r\ndhtmlXSideBar.prototype.goToNextItem = function(a) {\r\n    var c = this._getNextVisible(this.conf.selected, true);\r\n    if (c != null ) {\r\n        this._setItemActive(c, a)\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.goToPrevItem = function(a) {\r\n    var c = this._getPrevVisible(this.conf.selected, true);\r\n    if (c != null ) {\r\n        this._setItemActive(c, a)\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.getActiveItem = function() {\r\n    return this.conf.selected\r\n}\r\n;\r\ndhtmlXSideBar.prototype.setTemplate = function(g, c) {\r\n    this.conf.tpl_name = (g != null  && this.templates[g] != null  ? g : \"details\");\r\n    this.conf.tpl_str = this.templates[this.conf.tpl_name];\r\n    if (c != null ) {\r\n        this.conf.icons_path = c\r\n    }\r\n    for (var e in this.t) {\r\n        this.t[e].init.icons_path = this.conf.icons_path;\r\n        this.t[e].item.innerHTML = window.dhx4.template(this.conf.tpl_str, this.t[e].init)\r\n    }\r\n    if (this.side != null ) {\r\n        this.side.className = \"dhxsidebar_side dhxsidebar_tpl_\" + this.conf.tpl_name\r\n    }\r\n    if (this._scrollSide != null ) {\r\n        this._scrollSide(0);\r\n        this._checkHeight()\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype.templates = {\r\n    details: \"<img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'><div class='dhxsidebar_item_text'>#text#</div>\",\r\n    tiles: \"<img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'><div class='dhxsidebar_item_text'>#text#</div>\",\r\n    icons: \"<img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'>\",\r\n    icons_text: \"<div class='dhxsidebar_item_icon'><img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'></div><div class='dhxsidebar_item_text'>#text#</div>\",\r\n    text: \"<div class='dhxsidebar_item_text'>#text#</div>\"\r\n};\r\ndhtmlXSideBar.prototype.tpl_bubble = \"<div class='dhxsidebar_bubble'>#value#</div>\";\r\ndhtmlXSideBar.prototype.tpl_header = \"#text#\";\r\nwindow.dhtmlXSideBarCell = function(h, g) {\r\n    dhtmlXCellObject.apply(this, [h, \"_sidebar\"]);\r\n    var e = this;\r\n    this.sidebar = g;\r\n    this.conf.skin = this.sidebar.conf.skin;\r\n    this.conf.sidebar_funcs = {\r\n        show: \"_showItem\",\r\n        hide: \"_hideItem\",\r\n        isVisible: \"_isItemVisible\",\r\n        setActive: \"_setItemActive\",\r\n        isActive: \"_isItemActive\",\r\n        setText: \"_setItemText\",\r\n        getText: \"_getItemText\",\r\n        remove: \"_removeItem\",\r\n        setBubble: \"_setItemBubble\",\r\n        getBubble: \"_getItemBubble\",\r\n        clearBubble: \"_clearItemBubble\"\r\n    };\r\n    this._sidebarCall = function(a) {\r\n        return function() {\r\n            var l = [this._idd];\r\n            for (var m = 0; m < arguments.length; m++) {\r\n                l.push(arguments[m])\r\n            }\r\n            return this.sidebar[a].apply(this.sidebar, l)\r\n        }\r\n    }\r\n    ;\r\n    for (var c in this.conf.sidebar_funcs) {\r\n        if (typeof (this[c]) != \"function\") {\r\n            this[c] = this._sidebarCall(this.conf.sidebar_funcs[c])\r\n        }\r\n    }\r\n    if (this.sidebar.conf.header == true) {\r\n        this._initHeader();\r\n        this.cell.childNodes[this.conf.idx.hdr].onclick = function(l) {\r\n            l = l || event;\r\n            var a = (l.target || l.srcElement);\r\n            if (a.className.match(/dhx_cell_sidebar_hdr_icon/gi) != null ) {\r\n                e.sidebar.conf.clear_click = true;\r\n                e.sidebar.showSide()\r\n            }\r\n            a = null \r\n        }\r\n    }\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        if (this.conf.idx.hdr != null ) {\r\n            this.cell.childNodes[this.conf.idx.hdr].onclick = null \r\n        }\r\n        this.sidebar = null ;\r\n        for (var l in this.conf.sidebar_funcs) {\r\n            this[l] = this.conf.sidebar_funcs[l] = null \r\n        }\r\n        this.conf.sidebar_funcs = null ;\r\n        e = null \r\n    });\r\n    this.attachEvent(\"_onContentLoaded\", function() {\r\n        this.sidebar.callEvent(\"onContentLoaded\", arguments)\r\n    });\r\n    this.attachEvent(\"_onBeforeContentAttach\", function(a) {\r\n        if (a == \"tabbar\" || a == \"layout\" || a == \"acc\") {\r\n            this._hideBorders()\r\n        }\r\n        if (a == \"sidebar\" && this.conf.skin != \"dhx_skyblue\") {\r\n            this._hideBorders()\r\n        }\r\n        if ((this.conf.skin == \"dhx_web\" || this.conf.skin == \"dhx_terrace\") && (a == \"menu\" || a == \"toolbar\" || a == \"ribbon\")) {\r\n            if (this.cell.className.match(/dhx_cell_cont_no_top/gi) == null ) {\r\n                this.cell.className += \" dhx_cell_cont_no_top\"\r\n            }\r\n        }\r\n    })\r\n}\r\n;\r\ndhtmlXSideBarCell.prototype = new dhtmlXCellObject();\r\ndhtmlXSideBar.prototype._setItemText = function(g, e) {\r\n    if (this.t[g] != null ) {\r\n        for (var c in e) {\r\n            this.t[g].init[c] = e[c]\r\n        }\r\n        this.t[g].init.icons_path = this.conf.icons_path;\r\n        this.t[g].item.innerHTML = window.dhx4.template(this.conf.tpl_str, this.t[g].init);\r\n        if (this.t[g].conf.bubble != null ) {\r\n            this.t[g].item.innerHTML += window.dhx4.template(this.tpl_bubble, {\r\n                value: this.t[g].conf.bubble\r\n            })\r\n        }\r\n        if (this.conf.header == true) {\r\n            this.t[g].cell.setHeaderText(window.dhx4.template(this.tpl_header, this.t[g].init))\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._getItemText = function(g) {\r\n    var e = {};\r\n    if (this.t[g] != null ) {\r\n        for (var c in this.t[g].init) {\r\n            e[c] = this.t[g].init[c]\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXSideBar.prototype._removeItem = function(o, n, l) {\r\n    if (this.t[o] == null ) {\r\n        return\r\n    }\r\n    if (l != true && this.t[o].conf.remove != true) {\r\n        this.t[o].conf.remove = true;\r\n        this._hideItem(o, n);\r\n        return\r\n    }\r\n    if (typeof (n) == \"undefined\") {\r\n        n = true\r\n    }\r\n    var g = this._getNextVisible(o);\r\n    var h = this._getPrevVisible(o);\r\n    if (this.t[o].conf.transEv == true) {\r\n        this.t[o].item.removeEventListener(this.conf.transEv, this._doOnTrEnd);\r\n        this.t[o].conf.transEv = false\r\n    }\r\n    if (this.conf.single_cell != true) {\r\n        this.t[o].cell._unload();\r\n        this.t[o].cell = null \r\n    }\r\n    this.t[o].item.ondragstart = null ;\r\n    this.t[o].item.parentNode.removeChild(this.t[o].item);\r\n    this.t[o].item = null ;\r\n    for (var c in this.t[o]) {\r\n        this.t[o][c] = null \r\n    }\r\n    this.t[o] = null ;\r\n    try {\r\n        delete this.t[o]\r\n    } catch (m) {}\r\n    if (this.conf.selected == o && n != false) {\r\n        this.conf.selected = null ;\r\n        var n = (n == true ? (g || h || this._getFirstVisible()) : n);\r\n        if (n != null ) {\r\n            this._setItemActive(n)\r\n        }\r\n    } else {\r\n        if (l != true) {\r\n            this._checkHeight()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._showItem = function(c, a) {\r\n    if (this.t[c] == null  || this.t[c].conf.visible == true || this.t[c].conf.transActv == true) {\r\n        return\r\n    }\r\n    if (this.conf.transProp !== false) {\r\n        this.t[c].conf.transActv = true;\r\n        this.t[c].conf.transMode = \"show\";\r\n        this.t[c].conf.transProp = this.conf.transProp;\r\n        this.t[c].conf.transActvId = (a ? c : null );\r\n        if (this.t[c].conf.transEv != true) {\r\n            this.t[c].item.addEventListener(this.conf.transEv, this._doOnTrEnd);\r\n            this.t[c].conf.transEv = true\r\n        }\r\n        this.t[c].conf.visible = true;\r\n        this.t[c].item.style[this.conf.transProp] = this.conf.transValue;\r\n        this.t[c].item.className = \"dhxsidebar_item\"\r\n    } else {\r\n        this.t[c].conf.visible = true;\r\n        this.t[c].item.style.display = \"\";\r\n        if (a == true) {\r\n            this._setItemActive(c)\r\n        } else {\r\n            this._checkHeight()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._hideItem = function(h, g) {\r\n    if (this.t[h] == null  || this.t[h].conf.visible != true || this.t[h].conf.transActv == true) {\r\n        return\r\n    }\r\n    var e = false;\r\n    if (this.conf.selected == h) {\r\n        this.conf.selected = null ;\r\n        this.t[h].conf.active = false;\r\n        this.t[h].item.className = \"dhxsidebar_item\";\r\n        e = true\r\n    }\r\n    var c = this._getPrevVisible(h);\r\n    var a = this._getNextVisible(h);\r\n    var g = (e && g !== false ? (g == true ? null  : g) || a || c : null );\r\n    if (this.conf.transProp !== false) {\r\n        this.t[h].conf.transActv = true;\r\n        this.t[h].conf.transMode = \"hide\";\r\n        this.t[h].conf.transProp = this.conf.transProp;\r\n        this.t[h].conf.transActvId = g;\r\n        this.t[h].conf.visible = false;\r\n        if (this.t[h].conf.transEv != true) {\r\n            this.t[h].item.addEventListener(this.conf.transEv, this._doOnTrEnd);\r\n            this.t[h].conf.transEv = true\r\n        }\r\n        this.t[h].item.style[this.conf.transProp] = this.conf.transValue;\r\n        this.t[h].item.className = \"dhxsidebar_item dhxsidebar_item_hidden\"\r\n    } else {\r\n        this.t[h].item.style.display = \"none\";\r\n        this.t[h].conf.visible = false;\r\n        if (this.conf.single_cell != true) {\r\n            this.t[h].cell.cell.style.visibility = \"hidden\";\r\n            this.t[h].cell.cell.style.top = \"-5000px\"\r\n        }\r\n        if (g != null ) {\r\n            this._setItemActive(g)\r\n        }\r\n        this._checkHeight();\r\n        if (this.t[h].conf.remove == true) {\r\n            this._removeItem(h)\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXSideBar.prototype._isItemVisible = function(a) {\r\n    return ( this.t[a].conf.visible == true) \r\n}\r\n;\r\ndhtmlXSideBar.prototype._setItemBubble = function(c, a) {\r\n    if (this.t[c] == null ) {\r\n        return\r\n    }\r\n    this.t[c].item.innerHTML = window.dhx4.template(this.conf.tpl_str, this.t[c].init) + window.dhx4.template(this.tpl_bubble, {\r\n        value: String(a)\r\n    });\r\n    this.t[c].conf.bubble = a\r\n}\r\n;\r\ndhtmlXSideBar.prototype._getItemBubble = function(a) {\r\n    if (this.t[a] == null ) {\r\n        return null \r\n    }\r\n    return ( typeof (this.t[a].conf.bubble) == \"undefuned\" ? null  : this.t[a].conf.bubble) \r\n}\r\n;\r\ndhtmlXSideBar.prototype._clearItemBubble = function(a) {\r\n    if (this.t[a] == null ) {\r\n        return\r\n    }\r\n    this.t[a].item.innerHTML = window.dhx4.template(this.conf.tpl_str, this.t[a].init);\r\n    this.t[a].conf.bubble = null \r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachSidebar = function(a) {\r\n    this.callEvent(\"_onBeforeContentAttach\", [\"sidebar\"]);\r\n    if (a == null ) {\r\n        a = {}\r\n    }\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.width = \"100%\";\r\n    c.style.height = \"100%\";\r\n    c.style.position = \"relative\";\r\n    c.style.overflow = \"hidden\";\r\n    if (typeof (window.dhtmlXWindowsCell) == \"function\" && this instanceof window.dhtmlXWindowsCell) {} else {\r\n        if (this.conf.skin == \"dhx_skyblue\") {\r\n            c._ofs = {\r\n                t: -1,\r\n                r: -1,\r\n                b: -1,\r\n                l: -1\r\n            }\r\n        }\r\n        if (this.conf.skin == \"dhx_web\") {\r\n            if (typeof (window.dhtmlXSideBarCell) == \"function\" && this instanceof window.dhtmlXSideBarCell) {\r\n                c._ofs = {\r\n                    l: 8\r\n                }\r\n            }\r\n            if (typeof (window.dhtmlXLayoutCell) == \"function\" && this instanceof window.dhtmlXLayoutCell) {\r\n                c._ofs = {\r\n                    t: 2\r\n                }\r\n            }\r\n            if (typeof (window.dhtmlXTabBarCell) == \"function\" && this instanceof window.dhtmlXTabBarCell) {\r\n                c._ofs = {\r\n                    t: 8\r\n                }\r\n            }\r\n            if (typeof (window.dhtmlXAccordionCell) == \"function\" && this instanceof window.dhtmlXAccordionCell) {\r\n                c._ofs = {\r\n                    t: 2\r\n                }\r\n            }\r\n        }\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            if (typeof (window.dhtmlXSideBarCell) == \"function\" && this instanceof window.dhtmlXSideBarCell) {\r\n                c._ofs = {\r\n                    l: -1\r\n                }\r\n            }\r\n            if (typeof (window.dhtmlXLayoutCell) == \"function\" && this instanceof window.dhtmlXLayoutCell) {\r\n                c._ofs = {\r\n                    t: -1\r\n                }\r\n            }\r\n            if (typeof (window.dhtmlXTabBarCell) == \"function\" && this instanceof window.dhtmlXTabBarCell) {\r\n                c._ofs = {\r\n                    t: -1\r\n                }\r\n            }\r\n            if (typeof (window.dhtmlXAccordionCell) == \"function\" && this instanceof window.dhtmlXAccordionCell) {\r\n                c._ofs = {\r\n                    t: -1,\r\n                    r: -1,\r\n                    b: -1,\r\n                    l: -1\r\n                }\r\n            }\r\n        }\r\n    }\r\n    this._attachObject(c);\r\n    a.skin = this.conf.skin;\r\n    a.parent = c;\r\n    this.dataType = \"sidebar\";\r\n    this.dataObj = new dhtmlXSideBar(a);\r\n    a.parent = c = null ;\r\n    a = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\ndhtmlXSideBarCell.prototype._initHeader = function() {\r\n    var a = document.createElement(\"DIV\");\r\n    a.className = \"dhx_cell_sidebar_hdr\";\r\n    a.innerHTML = (this.sidebar.conf.autohide == true ? \"<div class='dhx_cell_sidebar_hdr_icon'></div>\" : \"\") + \"<div class='dhx_cell_sidebar_hdr_text\" + (this.sidebar.conf.autohide == true ? \" dhx_cell_sidebar_hdr_text_icon\" : \"\") + \"'></div>\";\r\n    this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cont]);\r\n    a = null ;\r\n    this.conf.ofs_nodes.t._getHdrHeight = \"func\";\r\n    this.conf.hdr = {\r\n        visible: true\r\n    };\r\n    this.conf.idx_data.hdr = \"dhx_cell_sidebar_hdr\";\r\n    this._updateIdx()\r\n}\r\n;\r\ndhtmlXSideBarCell.prototype._getHdrHeight = function() {\r\n    return this.cell.childNodes[this.conf.idx.hdr].offsetHeight\r\n}\r\n;\r\ndhtmlXSideBarCell.prototype.showHeader = function() {\r\n    if (this.conf.hdr.visible == true) {\r\n        return\r\n    }\r\n    this.conf.hdr.visible = true;\r\n    this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_sidebar_hdr\";\r\n    this._adjustCont(this._idd)\r\n}\r\n;\r\ndhtmlXSideBarCell.prototype.hideHeader = function() {\r\n    if (this.conf.hdr.visible != true) {\r\n        return\r\n    }\r\n    this.conf.hdr.visible = false;\r\n    this.cell.childNodes[this.conf.idx.hdr].className = \"dhx_cell_sidebar_hdr dhx_cell_sidebar_hdr_hidden\";\r\n    this._adjustCont(this._idd)\r\n}\r\n;\r\ndhtmlXSideBarCell.prototype.isHeaderVisible = function() {\r\n    return ( this.conf.hdr.visible == true) \r\n}\r\n;\r\ndhtmlXSideBarCell.prototype.setHeaderText = function(c) {\r\n    this.conf.text = c;\r\n    var a = this.cell.childNodes[this.conf.idx.hdr];\r\n    a.childNodes[(a.firstChild.className == \"dhx_cell_sidebar_hdr_icon\" ? 1 : 0)].innerHTML = \"<span>\" + c + \"</span>\";\r\n    a = null \r\n}\r\n;\r\ndhtmlXSideBarCell.prototype.getHeaderText = function() {\r\n    return this.conf.text\r\n}\r\n;\r\nfunction dhtmlXCarousel(g, l, n) {\r\n    if (typeof (g) == \"string\" || (typeof (g) == \"object\" && typeof (g.tagName) != \"undefined\")) {\r\n        g = {\r\n            parent: (typeof (g) == \"string\" ? document.getElementById(g) : g),\r\n            effect: l,\r\n            skin: n,\r\n            delete_conf: true\r\n        }\r\n    } else {\r\n        if (typeof (g) == \"undefined\" || g == null ) {\r\n            g = {}\r\n        }\r\n    }\r\n    this.conf = {\r\n        skin: (g.skin || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxcarousel\") || \"dhx_skyblue\"),\r\n        css: \"dhxcarousel\",\r\n        items_count: 0,\r\n        selected: -1,\r\n        item_width: Number(g.item_width) || \"auto\",\r\n        item_height: Number(g.item_height) || \"auto\",\r\n        ofs_item: Number(g.offset_item) || 1,\r\n        ofs_left: Number(g.offset_left) || 0,\r\n        ofs_top: Number(g.offset_top) || 0,\r\n        buttons: (typeof (g.buttons) == \"undefined\" ? true : window.dhx4.s2b(g.buttons)),\r\n        drops: false,\r\n        keys: (typeof (g.keys) == \"undefined\" ? true : window.dhx4.s2b(g.keys)),\r\n        key_data: {\r\n            left: 37,\r\n            right: 39\r\n        },\r\n        touch_scroll: (typeof (g.touch_scroll) != \"undefined\" ? window.dhx4.s2b(g.touch_scroll) : true),\r\n        arw: [\"&#9668;\", \"&#9658;\"]\r\n    };\r\n    this.conf.autowidth = (this.conf.item_width == \"auto\");\r\n    this.conf.autoheight = (this.conf.item_height == \"auto\");\r\n    var e = window.dhx4.transDetect();\r\n    this.conf.transProp = e.transProp;\r\n    this.conf.transEv = e.transEv;\r\n    this.conf.anim_type = (g.effect || \"slide\");\r\n    if (this.ef[this.conf.anim_type] == true) {\r\n        var h = this[\"_\" + this.conf.anim_type + \"_init\"]();\r\n        if (h === false) {\r\n            this.conf.anim_type = \"slide\";\r\n            h = this[\"_\" + this.conf.anim_type + \"_init\"]()\r\n        }\r\n        if (typeof (h) == \"object\") {\r\n            for (var c in h) {\r\n                if (typeof (this.conf[c]) == \"undefined\") {\r\n                    this.conf[c] = h[c]\r\n                }\r\n            }\r\n        }\r\n    }\r\n    this.conf.anim_f = this[\"_\" + this.conf.anim_type + \"_f\"]();\r\n    var m = this;\r\n    window.dhtmlXCellTop.apply(this, [g.parent, g.offsets]);\r\n    this.area = document.createElement(\"DIV\");\r\n    this.area.className = \"dhxcarousel_area\";\r\n    this.cont.appendChild(this.area);\r\n    if (typeof (window.addEventListener) == \"function\" && m.conf.touch_scroll == true) {\r\n        this._doOnTouchStart = function(a) {\r\n            if (window.dhx4.dnd._mTouch(a) == true) {\r\n                return\r\n            }\r\n            if (m.conf.animating == true) {\r\n                return\r\n            }\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            }\r\n            m.area.className += \" dhxcarousel_area_dnd\";\r\n            m.conf.touch_conf = {\r\n                t: new Date().getTime(),\r\n                dx: null ,\r\n                dy: null \r\n            };\r\n            if (a.type.match(/^touch/) != null ) {\r\n                m.conf.touch_conf.id = a.touches[0].identifier;\r\n                m.conf.touch_conf.x = a.touches[0].clientX;\r\n                m.conf.touch_conf.y = a.touches[0].clientY\r\n            } else {\r\n                m.area.style.touchAction = m.area.style.msTouchAction = \"none\";\r\n                m.conf.touch_conf.x = a.clientX;\r\n                m.conf.touch_conf.y = a.clientY\r\n            }\r\n            window.addEventListener(window.dhx4.dnd.evs.move, m._doOnTouchMove, false);\r\n            window.addEventListener(window.dhx4.dnd.evs.end, m._doOnTouchEnd, false)\r\n        }\r\n        ;\r\n        this._doOnTouchMove = function(a) {}\r\n        ;\r\n        this._doOnTouchEnd = function(s) {\r\n            if (s.type.match(/^touch/) != null ) {\r\n                var o = 0;\r\n                for (var r = 0; r < s.changedTouches.length; r++) {\r\n                    if (s.changedTouches[r].identifier == m.conf.touch_conf.id) {\r\n                        o = m.conf.touch_conf.x - s.changedTouches[r].clientX\r\n                    }\r\n                }\r\n            } else {\r\n                var o = m.conf.touch_conf.x - s.clientX\r\n            }\r\n            window.removeEventListener(window.dhx4.dnd.evs.move, m._doOnTouchMove, false);\r\n            window.removeEventListener(window.dhx4.dnd.evs.end, m._doOnTouchEnd, false);\r\n            m.area.className = m.area.className.replace(/\\s*dhxcarousel_area_dnd$/, \"\");\r\n            if (o == 0 || new Date().getTime() - m.conf.touch_conf.t > 400) {\r\n                return\r\n            }\r\n            var a = o / Math.abs(o);\r\n            m._animateStart(a)\r\n        }\r\n        ;\r\n        this.area.addEventListener(window.dhx4.dnd.evs.start, this._doOnTouchStart, false)\r\n    }\r\n    this.cdata = {};\r\n    this.ind = {};\r\n    this.addCell = function(u, s) {\r\n        this.conf.items_count++;\r\n        if (this.conf.selected == -1) {\r\n            this.conf.selected = 0\r\n        }\r\n        this.setSizes();\r\n        this._checkControls();\r\n        if (typeof (s) == \"undefined\" || s == null ) {\r\n            s = this.conf.items_count - 1\r\n        } else {\r\n            if (s < 0) {\r\n                s = 0\r\n            } else {\r\n                if (s > this.conf.items_count - 1) {\r\n                    s = this.conf.items_count - 1\r\n                }\r\n            }\r\n        }\r\n        for (var r in this.cdata) {\r\n            if (this.cdata[r].index >= s) {\r\n                this.cdata[r].index++;\r\n                this.ind[this.cdata[r].index] = r;\r\n                this._adjustCell(r)\r\n            }\r\n        }\r\n        if (u == null ) {\r\n            u = String(window.dhx4.newId())\r\n        }\r\n        while (this.cdata[u] != null ) {\r\n            u = String(window.dhx4.newId())\r\n        }\r\n        var o = new dhtmlXCarouselCell(u,this);\r\n        if (this.area.childNodes[s] != null ) {\r\n            this.area.insertBefore(o.cell, this.area.childNodes[s])\r\n        } else {\r\n            this.area.appendChild(o.cell)\r\n        }\r\n        this.cdata[u] = {\r\n            index: s,\r\n            cell: o\r\n        };\r\n        this.ind[s] = u;\r\n        this._adjustCell(u);\r\n        this._addBar();\r\n        this._setBarIndex(this.conf.selected);\r\n        o = null ;\r\n        this[this.conf.anim_f.cell_added](u);\r\n        return u\r\n    }\r\n    ;\r\n    this._removeCell = function(v) {\r\n        var s = this.cdata[v].index;\r\n        this.cdata[v].cell._unload();\r\n        this.cdata[v].index = this.cdata[v].cell = null ;\r\n        this.cdata[v] = null ;\r\n        delete this.cdata[v];\r\n        delete this.ind[s];\r\n        this.conf.items_count--;\r\n        if (this.conf.unloading == true) {\r\n            return\r\n        }\r\n        this.ind = {};\r\n        var o = 0;\r\n        for (var r in this.cdata) {\r\n            if (this.cdata[r].index > s) {\r\n                this.cdata[r].index--\r\n            }\r\n            this.ind[this.cdata[r].index] = r\r\n        }\r\n        var u = false;\r\n        if (this.conf.selected > s) {\r\n            this.conf.selected--\r\n        } else {\r\n            if (this.conf.selected == s) {\r\n                this.conf.selected = Math.min(this.conf.selected, this.conf.items_count - 1);\r\n                u = true\r\n            } else {}\r\n        }\r\n        this._removeBar(false);\r\n        this._setBarIndex(this.conf.selected);\r\n        if (u == true) {\r\n            if (this.conf.selected >= 0) {\r\n                this[this.conf.anim_f.update_selected](this.ind[this.conf.selected])\r\n            }\r\n        }\r\n        this.setSizes();\r\n        this._checkControls()\r\n    }\r\n    ;\r\n    this.setSizes = function() {\r\n        this._adjustCont();\r\n        var v = {};\r\n        this.area.style.height = this.cont.offsetHeight - this.controls.offsetHeight + \"px\";\r\n        this.conf.width = (this.conf.autowidth ? this.cont.offsetWidth - this.conf.ofs_left * 2 : this.conf.item_width);\r\n        this.conf.height = (this.conf.autoheight ? this.area.offsetHeight - this.conf.ofs_top * 2 : this.conf.item_height);\r\n        this.conf.top = Math.max(0, (this.conf.autoheight ? this.conf.ofs_top : Math.floor((this.area.offsetHeight - this.conf.height) / 2)));\r\n        this.area.style.width = this[this.conf.anim_f.detect_aw]() * (this.conf.width + this.conf.ofs_item) + this.conf.ofs_item + \"px\";\r\n        this.area.style.left = Math.round(this.cont.offsetWidth / 2 - this.conf.width / 2 - this.conf.ofs_item) + \"px\";\r\n        for (var r in this.cdata) {\r\n            var u = {};\r\n            for (var o in this.cdata[r].cell.conf.size) {\r\n                u[o] = this.cdata[r].cell.conf.size[o]\r\n            }\r\n            if (this.conf.autowidth == true) {\r\n                u.w = this.conf.width;\r\n                u.x = this[this.conf.anim_f.detect_x](r)\r\n            }\r\n            if (this.conf.autoheight == true) {\r\n                u.h = this.conf.height\r\n            }\r\n            v[r] = u\r\n        }\r\n        this.area.style.left = Math.round(this.cont.offsetWidth / 2 - this.conf.width / 2 - this.conf.ofs_item) - (this.conf.width + this.conf.ofs_item) * this.conf.selected + \"px\";\r\n        this._adjustControls();\r\n        if (this.conf.autoheight != true) {\r\n            this.conf.top = Math.max(0, Math.floor(this.area.offsetHeight - this.conf.height) / 2);\r\n            for (var r in v) {\r\n                v[r].y = this.conf.top\r\n            }\r\n        }\r\n        for (var r in v) {\r\n            this.cdata[r].cell._setSize(v[r].x, v[r].y, v[r].w, v[r].h)\r\n        }\r\n        this.callEvent(\"_onSetSizes\", [])\r\n    }\r\n    ;\r\n    this._adjustCell = function(a) {\r\n        this.cdata[a].cell._setSize(this[this.conf.anim_f.detect_x](a), this.conf.top, this.conf.width, this.conf.height)\r\n    }\r\n    ;\r\n    this._animateStart = function(o, a) {\r\n        if ((this.conf.selected <= 0 && o < 0) || (this.conf.selected >= this.conf.items_count - 1 && o > 0)) {\r\n            return\r\n        }\r\n        if (this.conf.animating == true) {\r\n            return\r\n        }\r\n        this.conf.animating = true;\r\n        this[this.conf.anim_f.prepare](o, a)\r\n    }\r\n    ;\r\n    this._animateTransEnd = function(a) {\r\n        m[m.conf.anim_f.end](a || event, this)\r\n    }\r\n    ;\r\n    this._animateEnd = function(a) {\r\n        this.conf.selected = this.conf.selected + a;\r\n        this._checkControls();\r\n        this._setBarIndex(this.conf.selected);\r\n        this.callEvent(\"onSelect\", [this.ind[this.conf.selected]]);\r\n        this.conf.animating = false\r\n    }\r\n    ;\r\n    this._initControls();\r\n    this.setCellSize = function(a, o) {\r\n        this.conf.item_width = (a == null  ? \"auto\" : a);\r\n        this.conf.item_height = (o == null  ? \"auto\" : o);\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.setOffset = function(r, o, a) {\r\n        if (r != null ) {\r\n            this.conf.ofs_left = r\r\n        }\r\n        if (o != null ) {\r\n            this.conf.ofs_top = o\r\n        }\r\n        if (a != null ) {\r\n            this.conf.ofs_item = a\r\n        }\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.enableHotKeys = function(a) {\r\n        this.conf.keys = window.dhx4.s2b(a)\r\n    }\r\n    ;\r\n    this.goFirst = function() {\r\n        if (this.conf.selected == 0) {\r\n            return\r\n        }\r\n        this._animateStart(-this.conf.selected)\r\n    }\r\n    ;\r\n    this.goLast = function() {\r\n        if (this.conf.selected == this.conf.items_count - 1) {\r\n            return\r\n        }\r\n        this._animateStart(this.conf.items_count - 1 - this.conf.selected)\r\n    }\r\n    ;\r\n    this.goNext = function() {\r\n        this._animateStart(1)\r\n    }\r\n    ;\r\n    this.goPrev = function() {\r\n        this._animateStart(-1)\r\n    }\r\n    ;\r\n    this.getActiveIndex = function() {\r\n        return this.conf.selected\r\n    }\r\n    ;\r\n    this.getActiveId = function() {\r\n        return this.ind[this.conf.selected]\r\n    }\r\n    ;\r\n    this.getActiveCell = function() {\r\n        var a = this.getActiveId();\r\n        if (a != null ) {\r\n            return this.cdata[a].cell\r\n        }\r\n        return null \r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this.conf.unloading = true;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"keydown\", this._doOnWinKeyDown, false);\r\n            if (this._doOnTouchStart != null ) {\r\n                this.area.removeEventListener(window.dhx4.dnd.evs.start, this._doOnTouchStart, false)\r\n            }\r\n        } else {\r\n            document.body.detachEvent(\"onkeydown\", this._doOnWinKeyDown)\r\n        }\r\n        for (var o in this.cdata) {\r\n            this._removeCell(o)\r\n        }\r\n        this.cdata[o] = null ;\r\n        this.area.parentNode.removeChild(this.area);\r\n        this.area = null ;\r\n        this._unloadControls();\r\n        this._unloadTop();\r\n        window.dhx4._eventable(this, \"clear\");\r\n        for (var o in this) {\r\n            this[o] = null \r\n        }\r\n        m = null \r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    this._callMainEvent = function(o, a) {\r\n        this.callEvent(o, a)\r\n    }\r\n    ;\r\n    this.conf.ev_coverclick = this.attachEvent(\"_cellCoverClick\", function(a) {\r\n        var o = a - this.conf.selected;\r\n        if (Math.abs(o) == 1) {\r\n            this._animateStart(o)\r\n        }\r\n    });\r\n    this._doOnWinKeyDown = function(r) {\r\n        r = r || event;\r\n        if (m.conf.keys == true) {\r\n            if (r.ctrlKey == true && r.shiftKey != true && r.altKey != true) {\r\n                var o = r.keyCode;\r\n                var a = m.conf.key_data;\r\n                if (o == a.left || o == a.right) {\r\n                    if (r.preventDefault) {\r\n                        r.preventDefault()\r\n                    } else {\r\n                        r.returnValue = false\r\n                    }\r\n                    m._animateStart(o == a.left ? -1 : 1)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        window.addEventListener(\"keydown\", this._doOnWinKeyDown, false)\r\n    } else {\r\n        document.body.attachEvent(\"onkeydown\", this._doOnWinKeyDown)\r\n    }\r\n    if (g.delete_conf == true) {\r\n        for (var c in g) {\r\n            g[c] = null \r\n        }\r\n        g = null \r\n    }\r\n    return this\r\n}\r\ndhtmlXCarousel.prototype = new dhtmlXCellTop();\r\ndhtmlXCarousel.prototype.ef = {};\r\ndhtmlXCarousel.prototype.cells = function(a) {\r\n    return this.cdata[a].cell\r\n}\r\n;\r\ndhtmlXCarousel.prototype.forEachCell = function(e) {\r\n    for (var c in this.cdata) {\r\n        if (typeof (e) == \"function\") {\r\n            e.apply(window, [this.cdata[c].cell])\r\n        } else {\r\n            if (typeof (e) == \"string\" && typeof (window[e]) == \"function\") {\r\n                window[e].apply(window, [this.cdata[c].cell])\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._initControls = function() {\r\n    var a = this;\r\n    this.controls = document.createElement(\"DIV\");\r\n    this.controls.className = \"dhx_carousel_controls\";\r\n    this.controls.innerHTML = \"<div class='dhx_carousel_bars'></div><div class='dhx_carousel_btn dhx_carousel_btn_prev'>\" + this.conf.arw[0] + \"</div><div class='dhx_carousel_btn dhx_carousel_btn_next'>\" + this.conf.arw[1] + \"</div>\";\r\n    this.cont.appendChild(this.controls);\r\n    this._doOnControlClick = function(l) {\r\n        if (a.conf.clear_click == true) {\r\n            a.conf.clear_click = false;\r\n            return\r\n        }\r\n        l = l || event;\r\n        if (window.dhx4.dnd.evs.start != null  && l.type != \"click\" && a.conf.clear_click != true) {\r\n            if (window.dhx4.dnd._mTouch(l) == true) {\r\n                return\r\n            }\r\n            a.conf.clear_click = true\r\n        }\r\n        var c = l.target || l.srcElement;\r\n        var h = null ;\r\n        if (c.className != null ) {\r\n            if (c.className.match(/btn_prev/) != null ) {\r\n                h = -1\r\n            } else {\r\n                if (c.className.match(/btn_next/) != null ) {\r\n                    h = 1\r\n                } else {\r\n                    if (c.className.match(/dhx_carousel_onebar/) != null  && c.className.match(/dhx_carousel_baractv/) == null ) {\r\n                        for (var g = 0; g < c.parentNode.childNodes.length; g++) {\r\n                            if (c.parentNode.childNodes[g] == c) {\r\n                                h = g - a.conf.selected\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (h != null ) {\r\n            a._animateStart(h)\r\n        }\r\n        c = null \r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.controls.addEventListener(\"click\", this._doOnControlClick, false);\r\n        if (window.dhx4.dnd.evs.start != null ) {\r\n            this.controls.addEventListener(window.dhx4.dnd.evs.start, this._doOnControlClick, false)\r\n        }\r\n    } else {\r\n        this.controls.attachEvent(\"onclick\", this._doOnControlClick);\r\n        if (window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8) {\r\n            this.controls.onselectstart = function(c) {\r\n                c = c || event;\r\n                if (c.preventDefault) {\r\n                    c.preventDefault()\r\n                }\r\n                c.returnValue = false;\r\n                return false\r\n            }\r\n        }\r\n    }\r\n    this.showControls = function() {\r\n        this.controls.style.display = \"\";\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this.hideControls = function() {\r\n        this.controls.style.display = \"none\";\r\n        this.setSizes()\r\n    }\r\n    ;\r\n    this._checkControls = function() {\r\n        this.controls.childNodes[1].className = \"dhx_carousel_btn dhx_carousel_btn_prev\" + (this.conf.selected <= 0 ? \"_dis\" : \"\");\r\n        this.controls.childNodes[2].className = \"dhx_carousel_btn dhx_carousel_btn_next\" + (this.conf.selected >= this.conf.items_count - 1 || this.conf.items_count == 0 ? \"_dis\" : \"\")\r\n    }\r\n    ;\r\n    this._adjustControls = function() {\r\n        this.controls.firstChild.style.left = Math.round(this.cont.offsetWidth / 2 - this.controls.firstChild.offsetWidth / 2) + \"px\"\r\n    }\r\n    ;\r\n    this._addBar = function() {\r\n        var c = document.createElement(\"DIV\");\r\n        c.className = \"dhx_carousel_onebar\";\r\n        c.innerHTML = \"<div class='dhx_carousel_barcore'>&nbsp;</div>\";\r\n        this.controls.firstChild.appendChild(c);\r\n        c = null ;\r\n        this._adjustControls()\r\n    }\r\n    ;\r\n    this._removeBar = function(e) {\r\n        var c = this.controls.firstChild.lastChild;\r\n        if (c != null ) {\r\n            c.parentNode.removeChild(c);\r\n            c = null ;\r\n            if (e !== false) {\r\n                this._adjustControls()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._setBarIndex = function(c) {\r\n        for (var e = 0; e < this.controls.firstChild.childNodes.length; e++) {\r\n            this.controls.firstChild.childNodes[e].className = \"dhx_carousel_onebar\" + (e == c ? \" dhx_carousel_baractv\" : \"\")\r\n        }\r\n    }\r\n    ;\r\n    this._unloadControls = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.controls.removeEventListener(\"click\", this._doOnControlClick, false);\r\n            if (window.dhx4.dnd.evs.start != null ) {\r\n                this.controls.removeEventListener(window.dhx4.dnd.evs.start, this._doOnControlClick, false)\r\n            }\r\n        } else {\r\n            this.controls.detachEvent(\"onclick\", this._doOnControlClick);\r\n            if (window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8) {\r\n                this.controls.onselectstart = null \r\n            }\r\n        }\r\n        while (this.controls.firstChild.childNodes.length > 0) {\r\n            this._removeBar(false)\r\n        }\r\n        this.cont.removeChild(this.controls);\r\n        this.controls = null ;\r\n        a = null \r\n    }\r\n    ;\r\n    if (this.conf.buttons != true) {\r\n        this.hideControls()\r\n    }\r\n    this._checkControls()\r\n}\r\n;\r\nwindow.dhtmlXCarouselCell = function(e, c) {\r\n    dhtmlXCellObject.apply(this, [e, \"_carousel\"]);\r\n    var a = this;\r\n    this.carousel = c;\r\n    this.conf.skin = this.carousel.conf.skin;\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        this.carousel = null ;\r\n        a = null \r\n    });\r\n    this.attachEvent(\"_onContentLoaded\", function() {\r\n        this.carousel._callMainEvent(\"onContentLoaded\", [this._idd])\r\n    });\r\n    this._showCover = function() {\r\n        if (this.conf.cover == true) {\r\n            return\r\n        }\r\n        this._showCellCover();\r\n        var g = this.cell.childNodes[this.conf.idx.cover];\r\n        g.onclick = function() {\r\n            a.carousel._callMainEvent(\"_cellCoverClick\", [a._idd])\r\n        }\r\n        ;\r\n        g = null \r\n    }\r\n    ;\r\n    this._hideCover = function() {\r\n        if (this.conf.cover != true) {\r\n            return\r\n        }\r\n        this.cell.childNodes[this.conf.idx.cover].onclick = null ;\r\n        this._hideCellCover()\r\n    }\r\n    ;\r\n    return this\r\n}\r\n;\r\ndhtmlXCarouselCell.prototype = new dhtmlXCellObject();\r\ndhtmlXCarouselCell.prototype.getId = function() {\r\n    return this._idd\r\n}\r\n;\r\ndhtmlXCarouselCell.prototype.getIndex = function() {\r\n    return this.carousel.cdata[this._idd].index\r\n}\r\n;\r\ndhtmlXCarouselCell.prototype.setActive = function() {\r\n    var a = this.getIndex() - this.carousel.conf.selected;\r\n    if (a != 0) {\r\n        this.carousel._animateStart(a)\r\n    }\r\n}\r\n;\r\ndhtmlXCarouselCell.prototype.remove = function() {\r\n    this.carousel._removeCell(this._idd)\r\n}\r\n;\r\ndhtmlXCellObject.prototype.attachCarousel = function(a) {\r\n    this.callEvent(\"_onBeforeContentAttach\", [\"carousel\"]);\r\n    var c = document.createElement(\"DIV\");\r\n    c.style.width = \"100%\";\r\n    c.style.height = \"100%\";\r\n    c.style.position = \"relative\";\r\n    c.style.overflow = \"hidden\";\r\n    this._attachObject(c);\r\n    if (typeof (window.dhtmlXSideBarCell) == \"function\" && this instanceof window.dhtmlXSideBarCell) {\r\n        if (this.conf.skin == \"dhx_terrace\") {\r\n            c._ofs = {\r\n                t: -1,\r\n                r: -1,\r\n                b: -1,\r\n                l: -1\r\n            }\r\n        }\r\n    }\r\n    if (typeof (a) == \"undefined\" || a == null ) {\r\n        a = {}\r\n    }\r\n    if (typeof (a.skin) == \"undefined\") {\r\n        a.skin = this.conf.skin\r\n    }\r\n    a.parent = c;\r\n    this.dataType = \"carousel\";\r\n    this.dataObj = new dhtmlXCarousel(a);\r\n    a.parent = null ;\r\n    c = a = null ;\r\n    this.callEvent(\"_onContentAttach\", []);\r\n    return this.dataObj\r\n}\r\n;\r\ndhtmlXCarousel.prototype.ef.slide = true;\r\ndhtmlXCarousel.prototype.ef.slide_conf = {\r\n    anim_step: 25,\r\n    anim_timeout: 10,\r\n    anim_slide: \"left 0.3s\"\r\n};\r\ndhtmlXCarousel.prototype.ef.slide_f = {\r\n    prepare: \"_slide_prepare\",\r\n    start: \"_slide_start\",\r\n    end: \"_slide_end\",\r\n    update_selected: \"_slide_update_selected\",\r\n    detect_x: \"_slide_detect_x\",\r\n    detect_aw: \"_slide_detect_area_width\",\r\n    cell_added: \"_slide_cell_added\"\r\n};\r\ndhtmlXCarousel.prototype._slide_init = function() {\r\n    return this.ef.slide_conf\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_f = function() {\r\n    return this.ef.slide_f\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_prepare = function(c, a) {\r\n    var g = this.conf.anim_step;\r\n    var h = this.conf.width + this.conf.ofs_item;\r\n    if (a == false) {\r\n        g = h + 1\r\n    }\r\n    this.area._init = parseInt(this.area.style.left);\r\n    var e = this.ind[this.conf.selected + c];\r\n    this._slide_update_selected(e);\r\n    if (this.conf.transProp !== false && a != false) {\r\n        if (this.conf.transEvInit != true) {\r\n            this.area.addEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n            this.conf.transEvInit = true\r\n        }\r\n        this.conf.current_dir = c;\r\n        this.area.style[this.conf.transProp] = this.conf.anim_slide;\r\n        this.area.style.left = this.area._init + h * (-c) + \"px\"\r\n    } else {\r\n        this._slide_start(g, 0, h, c)\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_start = function(h, a, l, c) {\r\n    var g = false;\r\n    a += h;\r\n    if (a >= l) {\r\n        a = l;\r\n        g = true\r\n    }\r\n    this.area.style.left = this.area._init + a * (-c) + \"px\";\r\n    if (g != true) {\r\n        var e = this;\r\n        window.setTimeout(function() {\r\n            e._slide_start(h, a, l, c);\r\n            e = null \r\n        }, this.conf.anim_timeout)\r\n    } else {\r\n        this.cdata[this.ind[this.conf.selected]].cell._showCover();\r\n        this._animateEnd(c)\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_end = function(c, a) {\r\n    if (c.type == this.conf.transEv && a == this.area) {\r\n        this.area.style[this.conf.transProp] = \"\";\r\n        if (this.conf.transEvInit == true) {\r\n            this.area.removeEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n            this.conf.transEvInit = false\r\n        }\r\n        this.cdata[this.ind[this.conf.selected]].cell._showCover();\r\n        this._animateEnd(this.conf.current_dir)\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_update_selected = function(a) {\r\n    this.cdata[a].cell._hideCover()\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_detect_x = function(e) {\r\n    var c = this.cdata[e].index;\r\n    var a = c * (this.conf.width + this.conf.ofs_item) + this.conf.ofs_item;\r\n    return a\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_cell_added = function(a) {\r\n    if (this.conf.selected != this.cdata[a].index) {\r\n        this.cdata[a].cell._showCover()\r\n    }\r\n    if (this.cdata[a].index <= this.conf.selected && this.conf.items_count > 1) {\r\n        this._animateStart(1, false)\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._slide_detect_area_width = function() {\r\n    return this.conf.items_count\r\n}\r\n;\r\ndhtmlXCarousel.prototype.ef.flip = true;\r\ndhtmlXCarousel.prototype.ef.flip_conf = {\r\n    anim_flip: \"transform 0.3s ease-out\",\r\n    anim_flip_ang: -87,\r\n    anim_flip_trstyle: \"transform\"\r\n};\r\ndhtmlXCarousel.prototype.ef.flip_f = {\r\n    prepare: \"_flip_prepare\",\r\n    start: \"_flip_start\",\r\n    end: \"_flip_end\",\r\n    update_selected: \"_flip_update_selected\",\r\n    detect_x: \"_flip_detect_x\",\r\n    detect_aw: \"_flip_detect_area_width\",\r\n    cell_added: \"_flip_cell_added\"\r\n};\r\ndhtmlXCarousel.prototype._flip_init = function() {\r\n    var a = (this.conf.transProp == false ? false : this.ef.flip_conf);\r\n    if (a !== false && window.dhx4.isKHTML == true && a.anim_flip.match(\"webkit\") == null ) {\r\n        a.anim_flip = a.anim_flip.replace(/transform/, \"-webkit-transform\");\r\n        a.anim_flip_trstyle = \"webkitTransform\"\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_f = function() {\r\n    return this.ef.flip_f\r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_prepare = function(a) {\r\n    this.conf.flip_data = {\r\n        fromIndex: this.conf.selected,\r\n        toIndex: this.conf.selected + a,\r\n        mode: 0,\r\n        dir: a\r\n    };\r\n    this._flip_start()\r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_start = function() {\r\n    var a = this.cdata[this.ind[this.conf.flip_data.mode == 0 ? this.conf.flip_data.fromIndex : this.conf.flip_data.toIndex]].cell;\r\n    if (this.area.className.match(/dhxcarousel_area_flip/) == null ) {\r\n        this.area.className += \" dhxcarousel_area_flip\"\r\n    }\r\n    if (a.conf.tr_ev != true) {\r\n        a.cell.addEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n        a.conf.tr_ev = true\r\n    }\r\n    if (this.conf.flip_data.mode == 0) {\r\n        a.cell.style[this.conf.anim_flip_trstyle] = \"rotateY(\" + String(this.conf.flip_data.dir > 0 ? this.conf.anim_flip_ang : -this.conf.anim_flip_ang) + \"deg)\"\r\n    } else {\r\n        a.cell.style.visibility = \"visible\";\r\n        a.cell.style[this.conf.anim_flip_trstyle] = \"rotateY(0deg)\"\r\n    }\r\n    a.cell.style[this.conf.transProp] = this.conf.anim_flip;\r\n    a = null \r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_end = function(n, m) {\r\n    if (n.type == this.conf.transEv) {\r\n        var a = this.cdata[this.ind[this.conf.flip_data.mode == 0 ? this.conf.flip_data.fromIndex : this.conf.flip_data.toIndex]].cell;\r\n        if (m == a.cell) {\r\n            a.cell.removeEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n            a.conf.tr_ev = false;\r\n            if (this.conf.flip_data.mode == 0) {\r\n                a.cell.style[this.conf.transProp] = \"\";\r\n                a.cell.style.visibility = \"hidden\";\r\n                this.conf.flip_data.mode = 1;\r\n                this._flip_start()\r\n            } else {\r\n                var g = this.conf.flip_data.dir;\r\n                var h = Math.min(this.conf.flip_data.fromIndex, this.conf.flip_data.toIndex) + 1;\r\n                var c = Math.max(this.conf.flip_data.fromIndex, this.conf.flip_data.toIndex) - 1;\r\n                for (var l = h; l <= c; l++) {\r\n                    this.cdata[this.ind[l]].cell.cell.style[this.conf.anim_flip_trstyle] = \"rotateY(\" + String(this.conf.anim_flip_ang * g / Math.abs(g)) + \"deg)\"\r\n                }\r\n                if (this.area.className.match(/dhxcarousel_area_flip/) != null ) {\r\n                    this.area.className = String(this.area.className).replace(/\\s{0,}dhxcarousel_area_flip/gi, \"\")\r\n                }\r\n                this.conf.flip_data = null ;\r\n                a.cell.style[this.conf.transProp] = \"\";\r\n                this._animateEnd(g)\r\n            }\r\n        }\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_update_selected = function(a) {}\r\n;\r\ndhtmlXCarousel.prototype._flip_detect_x = function(e) {\r\n    var c = 0;\r\n    var a = c * (this.conf.width + this.conf.ofs_item) + this.conf.ofs_item;\r\n    return a\r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_cell_added = function(a) {\r\n    if (this.conf.selected != this.cdata[a].index) {\r\n        this.cdata[a].cell.cell.style[this.conf.anim_flip_trstyle] = \"rotateY(\" + String(this.cdata[a].index < this.conf.selected ? this.conf.anim_flip_ang : -this.conf.anim_flip_ang) + \"deg)\";\r\n        this.cdata[a].cell.cell.style.visibility = \"hidden\"\r\n    } else {\r\n        this.cdata[a].cell.cell.style[this.conf.anim_flip_trstyle] = \"rotateY(0deg)\"\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._flip_detect_area_width = function() {\r\n    return 1\r\n}\r\n;\r\ndhtmlXCarousel.prototype.ef.cards = true;\r\ndhtmlXCarousel.prototype.ef.cards_conf = {\r\n    anim_cards: \"left 0.3s\"\r\n};\r\ndhtmlXCarousel.prototype.ef.cards_f = {\r\n    prepare: \"_cards_prepare\",\r\n    start: \"_cards_start\",\r\n    end: \"_cards_end\",\r\n    update_selected: \"_cards_update_selected\",\r\n    detect_x: \"_cards_detect_x\",\r\n    detect_aw: \"_cards_detect_area_width\",\r\n    cell_added: \"_cards_cell_added\"\r\n};\r\ndhtmlXCarousel.prototype._cards_init = function() {\r\n    return ( this.conf.transProp == false ? false : this.ef.cards_conf) \r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_f = function() {\r\n    return this.ef.cards_f\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_prepare = function(e, c) {\r\n    if (e > 0) {\r\n        var g = this.ind[this.conf.selected + e];\r\n        var a = this.cdata[g].cell;\r\n        this._cards_update_selected(g);\r\n        if (a.conf.transEvInit != true) {\r\n            a.cell.addEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n            a.conf.transEvInit = true\r\n        }\r\n        this.conf.current_id = g;\r\n        this.conf.current_dir = e;\r\n        a.cell.style[this.conf.transProp] = this.conf.anim_cards;\r\n        a.cell.style.left = this._cards_detect_x(g, 0) + \"px\";\r\n        a = null \r\n    } else {\r\n        this._cards_adjust_middle(this.conf.selected + e + 1, this.conf.selected - 1, 1);\r\n        var g = this.ind[this.conf.selected];\r\n        var a = this.cdata[g].cell;\r\n        a._hideCover();\r\n        if (a.conf.transEvInit != true) {\r\n            a.cell.addEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n            a.conf.transEvInit = true\r\n        }\r\n        this.conf.current_id = g;\r\n        this.conf.current_dir = e;\r\n        this.cdata[this.ind[this.conf.selected + e]].cell._hideCover();\r\n        a.cell.style[this.conf.transProp] = this.conf.anim_cards;\r\n        a.cell.style.left = this._cards_detect_x(g, 1) + \"px\";\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_start = function(e, a, g, c) {}\r\n;\r\ndhtmlXCarousel.prototype._cards_end = function(g, c) {\r\n    if (g.type == this.conf.transEv && this.conf.current_id != null  && c == this.cdata[this.conf.current_id].cell.cell) {\r\n        var a = this.cdata[this.conf.current_id].cell;\r\n        a.cell.style[this.conf.transProp] = \"\";\r\n        if (a.conf.transEvInit != true) {\r\n            a.cell.removeEventListener(this.conf.transEv, this._animateTransEnd, false);\r\n            a.conf.transEvInit = false\r\n        }\r\n        this.conf.current_id = null ;\r\n        if (this.conf.current_dir > 0) {\r\n            this._cards_adjust_middle(this.conf.selected + 1, this.conf.selected + this.conf.current_dir - 1, 0)\r\n        }\r\n        this.cdata[this.ind[this.conf.selected]].cell._showCover();\r\n        this._animateEnd(this.conf.current_dir)\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_update_selected = function(a) {\r\n    this.cdata[a].cell._hideCover()\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_adjust_middle = function(e, h, c) {\r\n    for (var g = e; g <= h; g++) {\r\n        var l = this.ind[g];\r\n        var a = this.cdata[l].cell;\r\n        a.conf.size.x = this._cards_detect_x(l, c);\r\n        a.cell.style.left = a.conf.size.x + \"px\";\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_detect_x = function(e, c) {\r\n    if (typeof (c) == \"undefined\" || c == null ) {\r\n        c = (this.cdata[e].index <= this.conf.selected ? 0 : 1)\r\n    }\r\n    var a = c * (this.conf.width + this.conf.ofs_left + this.conf.ofs_item) + this.conf.ofs_item;\r\n    return a\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_cell_added = function(a) {\r\n    this.cdata[a].cell.conf.size.x = this._cards_detect_x(a);\r\n    this.cdata[a].cell.cell.style.left = this.cdata[a].cell.conf.size.x + \"px\";\r\n    if (this.conf.selected != this.cdata[a].index) {\r\n        this.cdata[a].cell._showCover()\r\n    }\r\n}\r\n;\r\ndhtmlXCarousel.prototype._cards_detect_area_width = function() {\r\n    return 2\r\n}\r\n;\r\nfunction dhtmlXWindows(n) {\r\n    var l = this;\r\n    var g = {};\r\n    if (typeof (n) != \"undefined\") {\r\n        for (var e in n) {\r\n            g[e] = n[e]\r\n        }\r\n    }\r\n    n = null ;\r\n    this.conf = {\r\n        skin: window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxwins\") || \"dhx_skyblue\",\r\n        vp_pos_ofs: 20,\r\n        vp_custom: false,\r\n        vp_of_auto: (g.vp_overflow == \"auto\"),\r\n        vp_of_id: window.dhx4.newId(),\r\n        ofs_w: null ,\r\n        ofs_h: null ,\r\n        button_last: null ,\r\n        dblclick_tm: 300,\r\n        dblclick_last: null ,\r\n        dblclick_id: null ,\r\n        dblclick_mode: \"minmax\",\r\n        dblclick_active: false,\r\n        dblclick_ev: (window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8),\r\n        fr_cover: (navigator.userAgent.indexOf(\"MSIE 6.0\") >= 0)\r\n    };\r\n    var c = window.dhx4.transDetect();\r\n    this.conf.tr = {\r\n        prop: c.transProp,\r\n        ev: c.transEv,\r\n        height_open: \"height 0.2s cubic-bezier(0.25,0.1,0.25,1)\",\r\n        height_close: \"height 0.18s cubic-bezier(0.25,0.1,0.25,1)\",\r\n        op_open: \"opacity 0.16s ease-in\",\r\n        op_close: \"opacity 0.2s ease-out\",\r\n        op_v_open: \"1\",\r\n        op_v_close: \"0.4\"\r\n    };\r\n    if (!g.viewport) {\r\n        this.attachViewportTo(document.body)\r\n    } else {\r\n        if (g.viewport.object != null ) {\r\n            this.attachViewportTo(g.viewport.object)\r\n        } else {\r\n            if (g.viewport.left != null  && g.viewport.top != null  && g.viewport.width != null  && g.viewport.height != null ) {\r\n                this.setViewport(g.viewport.left, g.viewport.top, g.viewport.width, g.viewport.height, g.viewport.parent)\r\n            } else {\r\n                this.attachViewportTo(document.body)\r\n            }\r\n        }\r\n    }\r\n    this.w = {};\r\n    this.createWindow = function(s, H, E, u, J) {\r\n        var o = {};\r\n        if (arguments.length == 1 && typeof (s) == \"object\") {\r\n            o = s\r\n        } else {\r\n            o.id = s;\r\n            o.left = H;\r\n            o.top = E;\r\n            o.width = u;\r\n            o.height = J;\r\n            if (typeof (o.id) == \"undefined\" || o.id == null ) {\r\n                o.id = window.dhx4.newId()\r\n            }\r\n            while (this.w[o.id] != null ) {\r\n                o.id = window.dhx4.newId()\r\n            }\r\n        }\r\n        if (o.left == null ) {\r\n            o.left = 0\r\n        }\r\n        if (o.top == null ) {\r\n            o.top = 0\r\n        }\r\n        o.move = (o.move != null  && window.dhx4.s2b(o.move) == false ? false : (o.deny_move != null  && window.dhx4.s2b(o.deny_move) == true ? false : true));\r\n        o.park = (o.park != null  && window.dhx4.s2b(o.park) == false ? false : (o.deny_park != null  && window.dhx4.s2b(o.deny_park) == true ? false : true));\r\n        o.resize = (o.resize != null  && window.dhx4.s2b(o.resize) == false ? false : (o.deny_resize != null  && window.dhx4.s2b(o.deny_resize) == true ? false : true));\r\n        o.keep_in_viewport = (o.keep_in_viewport != null  && window.dhx4.s2b(o.keep_in_viewport));\r\n        o.modal = (o.modal != null  && window.dhx4.s2b(o.modal));\r\n        o.center = (o.center != null  && window.dhx4.s2b(o.center));\r\n        o.text = (o.text != null  ? o.text : (o.caption != null  ? o.caption : \"dhtmlxWindow\"));\r\n        o.header = (!(o.header != null  && window.dhx4.s2b(o.header) == false));\r\n        var K = document.createElement(\"DIV\");\r\n        K.className = \"dhxwin_active\";\r\n        this.vp.appendChild(K);\r\n        K._isWindow = true;\r\n        K._idd = o.id;\r\n        var A = document.createElement(\"DIV\");\r\n        A.className = \"dhxwin_hdr\";\r\n        A.style.zIndex = 0;\r\n        A.innerHTML = \"<div class='dhxwin_icon'></div><div class='dhxwin_text'><div class='dhxwin_text_inside'>\" + o.text + \"</div></div><div class='dhxwin_btns'></div>\";\r\n        K.appendChild(A);\r\n        A.onselectstart = function(a) {\r\n            a = a || event;\r\n            if (a.preventDefault) {\r\n                a.preventDefault()\r\n            } else {\r\n                a.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n        ;\r\n        A.oncontextmenu = function(a) {\r\n            a = a || event;\r\n            a.cancelBubble = true;\r\n            return false\r\n        }\r\n        ;\r\n        A._isWinHdr = true;\r\n        A.firstChild._isWinIcon = true;\r\n        var v = document.createElement(\"DIV\");\r\n        v.className = \"dhxwin_brd\";\r\n        K.appendChild(v);\r\n        var D = document.createElement(\"DIV\");\r\n        D.className = \"dhxwin_fr_cover\";\r\n        D.innerHTML = \"<iframe class='dhxwin_fr_cover_inner' frameborder='0' border='0'></iframe><div class='dhxwin_fr_cover_inner'></div>\";\r\n        K.appendChild(D);\r\n        this.w[o.id] = {\r\n            win: K,\r\n            hdr: A,\r\n            brd: v,\r\n            fr_cover: D,\r\n            b: {},\r\n            conf: {\r\n                z_id: window.dhx4.newId(),\r\n                actv: false,\r\n                modal: false,\r\n                maxed: false,\r\n                parked: false,\r\n                sticked: false,\r\n                visible: true,\r\n                header: true,\r\n                text: o.text,\r\n                keep_in_vp: o.keep_in_viewport,\r\n                allow_move: o.move,\r\n                allow_park: o.park,\r\n                allow_resize: o.resize,\r\n                max_w: null ,\r\n                max_h: null ,\r\n                min_w: 80,\r\n                min_h: 80\r\n            }\r\n        };\r\n        var w = {\r\n            help: {\r\n                title: \"Help\",\r\n                visible: false\r\n            },\r\n            stick: {\r\n                title: \"Stick\",\r\n                visible: false\r\n            },\r\n            park: {\r\n                title: \"Park\",\r\n                visible: true\r\n            },\r\n            minmax: {\r\n                title: \"Min/Max\",\r\n                visible: true\r\n            },\r\n            close: {\r\n                title: \"Close\",\r\n                visible: true\r\n            }\r\n        };\r\n        for (var F in w) {\r\n            var C = new dhtmlXWindowsButton(this,o.id,F,w[F].title,false);\r\n            if (w[F].visible == false) {\r\n                C.hide()\r\n            }\r\n            A.lastChild.appendChild(C.button);\r\n            this.w[o.id].b[F] = C;\r\n            C = null \r\n        }\r\n        this._winAdjustTitle(o.id);\r\n        this.w[o.id].win.style.zIndex = window.dhx4.zim.reserve(this.w[o.id].conf.z_id);\r\n        var I = new dhtmlXWindowsCell(o.id,this);\r\n        this.w[o.id].win.insertBefore(I.cell, D);\r\n        this.w[o.id].cell = I;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.w[o.id].win.addEventListener(\"mousedown\", this._winOnMouseDown, false);\r\n            this.w[o.id].win.addEventListener(\"mouseup\", this._winOnMouseDown, false);\r\n            if (this.conf.dblclick_ev) {\r\n                this.w[o.id].win.addEventListener(\"dblclick\", this._winOnMouseDown, false)\r\n            }\r\n            if (this.conf.dnd_enabled == true && window.dhx4.dnd.evs.start != null ) {\r\n                this.w[o.id].win.addEventListener(window.dhx4.dnd.evs.start, this._winOnMouseDown, false);\r\n                if (window.dhx4.dnd.p_en != true) {\r\n                    this.w[o.id].win.addEventListener(window.dhx4.dnd.evs.start, this._winOnMouseDown, false);\r\n                    this.w[o.id].win.addEventListener(window.dhx4.dnd.evs.end, this._winOnMouseDown, false)\r\n                }\r\n            }\r\n        } else {\r\n            this.w[o.id].win.attachEvent(\"onmousedown\", this._winOnMouseDown);\r\n            this.w[o.id].win.attachEvent(\"onmouseup\", this._winOnMouseDown);\r\n            if (this.conf.dblclick_ev) {\r\n                this.w[o.id].win.attachEvent(\"ondblclick\", this._winOnMouseDown)\r\n            }\r\n        }\r\n        this._winInitFRM(o.id);\r\n        this._winSetPosition(o.id, o.left, o.top);\r\n        this._winSetSize(o.id, o.width, o.height);\r\n        this._winMakeActive(o.id);\r\n        if (o.center == true) {\r\n            this.w[o.id].cell.center()\r\n        }\r\n        if (o.modal == true) {\r\n            this.w[o.id].cell.setModal(true)\r\n        }\r\n        if (o.header == false) {\r\n            this.w[o.id].cell.hideHeader()\r\n        }\r\n        f = K = A = v = D = I = null ;\r\n        return this.w[o.id].cell\r\n    }\r\n    ;\r\n    this._winOnMouseDown = function(r) {\r\n        r = r || event;\r\n        var a = r.target || r.srcElement;\r\n        var o = {\r\n            press_type: r.type\r\n        };\r\n        if (r.type == \"MSPointerDown\" || r.type == \"pointerdown\") {\r\n            l.conf.ev_skip = true\r\n        } else {\r\n            if (l.conf.ev_skip == true) {\r\n                l.conf.ev_skip = false;\r\n                a = null ;\r\n                return\r\n            }\r\n        }\r\n        while (a != null  && a._isWindow != true) {\r\n            if (typeof (a.className) != \"undefined\" && o.mode == null ) {\r\n                if (typeof (a._buttonName) != \"undefined\") {\r\n                    o.mode = \"button\";\r\n                    o.button_name = a._buttonName\r\n                } else {\r\n                    if (a._isWinHdr == true) {\r\n                        o.mode = \"hdr\"\r\n                    } else {\r\n                        if (a._isWinIcon == true) {\r\n                            o.mode = \"icon\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        if (o.mode == null ) {\r\n            o.mode = \"win\"\r\n        }\r\n        o.id = (a != null  && a._isWindow == true ? a._idd : null );\r\n        a = null ;\r\n        if (o.id != null  && l.w[o.id] != null ) {\r\n            l.callEvent(\"_winMouseDown\", [r, o])\r\n        }\r\n    }\r\n    ;\r\n    this._winOnParkTrans = function(o) {\r\n        if (o.stopPropagation) {\r\n            o.stopPropagation()\r\n        }\r\n        var a = l.w[this._idd];\r\n        if (o.propertyName == \"opacity\") {\r\n            l._winCellClearOpacity(this._idd)\r\n        }\r\n        if (o.propertyName == \"height\" && a.conf.tr_mode == \"park\") {\r\n            if (a.conf.tr_mode == \"park\") {\r\n                a.win.style[l.conf.tr.prop] = \"\";\r\n                if (!a.conf.parked) {\r\n                    l._winAdjustCell(this._idd);\r\n                    l._callMainEvent(\"onParkDown\", this._idd);\r\n                    if (a.conf.keep_in_vp) {\r\n                        l._winAdjustPosition(this._idd, a.conf.x, a.conf.y)\r\n                    }\r\n                } else {\r\n                    a.hdr.style.zIndex = 3;\r\n                    l._callMainEvent(\"onParkUp\", this._idd)\r\n                }\r\n            }\r\n        }\r\n        a = null \r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this.conf.unloading = true;\r\n        if (this._dndInitModule) {\r\n            this._dndUnloadModule()\r\n        }\r\n        for (var o in this.w) {\r\n            this._winClose(o)\r\n        }\r\n        this.w = null ;\r\n        if (this.cm != null  && typeof (this._unloadContextMenu) == \"function\") {\r\n            this._unloadContextMenu()\r\n        }\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.attachViewportTo(null );\r\n        for (var o in this.conf) {\r\n            this.conf[o] = null ;\r\n            delete this.conf[o]\r\n        }\r\n        for (var o in this) {\r\n            this[o] = null \r\n        }\r\n        l = o = null \r\n    }\r\n    ;\r\n    window.dhx4._eventable(this);\r\n    this.attachEvent(\"_winMouseDown\", this._winMouseDownHandler);\r\n    if (this._dndInitModule) {\r\n        this._dndInitModule()\r\n    }\r\n    if (g.wins != null ) {\r\n        for (var m = 0; m < g.wins.length; m++) {\r\n            var h = g.wins[m];\r\n            this.createWindow(h)\r\n        }\r\n    }\r\n    g = null ;\r\n    return this\r\n}\r\ndhtmlXWindows.prototype.forEachWindow = function(e) {\r\n    for (var c in this.w) {\r\n        e.apply(window, [this.w[c].cell])\r\n    }\r\n}\r\n;\r\ndhtmlXWindows.prototype.window = function(a) {\r\n    if (this.w[a] != null ) {\r\n        return this.w[a].cell\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXWindows.prototype.isWindow = function(a) {\r\n    return ( this.w[a] != null ) \r\n}\r\n;\r\ndhtmlXWindows.prototype.findByText = function(g) {\r\n    var e = [];\r\n    for (var c in this.w) {\r\n        if ((this.w[c].cell.getText()).indexOf(String(g)) >= 0) {\r\n            e.push(this.w[c])\r\n        }\r\n    }\r\n    return e\r\n}\r\n;\r\ndhtmlXWindows.prototype.setSkin = function(e) {\r\n    if (e == this.conf.skin) {\r\n        return\r\n    }\r\n    if (this.vp != null ) {\r\n        this.vp.className = String(this.vp.className).replace(\"dhxwins_vp_\" + this.conf.skin, \" dhxwins_vp_\" + e)\r\n    }\r\n    for (var c in this.w) {\r\n        this.w[c].cell._resetSizeState();\r\n        this._winAdjustCell(c);\r\n        this._winAdjustTitle(c)\r\n    }\r\n    this.conf.skin = e\r\n}\r\n;\r\ndhtmlXWindows.prototype.getBottommostWindow = function() {\r\n    return this._getTopBottomWin(false)\r\n}\r\n;\r\ndhtmlXWindows.prototype.getTopmostWindow = function() {\r\n    return this._getTopBottomWin(true)\r\n}\r\n;\r\ndhtmlXWindows.prototype._getTopBottomWin = function(h) {\r\n    var g = null ;\r\n    for (var c in this.w) {\r\n        if (this.w[c].conf.visible) {\r\n            var e = false;\r\n            if (g != null ) {\r\n                e = g.z > this.w[c].win.style.zIndex;\r\n                if (h) {\r\n                    e = !e\r\n                }\r\n            }\r\n            if (g == null  || e) {\r\n                g = {\r\n                    win: this.w[c].cell,\r\n                    z: this.w[c].win.style.zIndex\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return ( g ? g.win : null ) \r\n}\r\n;\r\ndhtmlXWindows.prototype._winMakeActive = function(e, h) {\r\n    if (e != null  && h !== true && this.w[e].conf.actv == true) {\r\n        return\r\n    }\r\n    var u = [];\r\n    var n = {};\r\n    for (var c = 0; c < this._zOrder.length; c++) {\r\n        var m = this._zOrder[c].name;\r\n        var g = this._zOrder[c].value;\r\n        var v = [];\r\n        for (var r in this.w) {\r\n            var s = this.w[r];\r\n            if (n[r] == null  && s.conf[m] === g && s.conf.visible == true) {\r\n                if (e != r) {\r\n                    window.dhx4.zim.clear(s.conf.z_id);\r\n                    v.push([r, Number(s.win.style.zIndex)]);\r\n                    n[r] = true\r\n                }\r\n            }\r\n            s = null \r\n        }\r\n        v.sort(function(x, w) {\r\n            return ( x[1] < w[1] ? 1 : -1) \r\n        });\r\n        if (e != null  && this.w[e].conf[m] === g && n[e] == null ) {\r\n            window.dhx4.zim.clear(this.w[e].conf.z_id);\r\n            var l = [[e, Number(this.w[e].win.style.zIndex)]];\r\n            v = l.concat(v);\r\n            n[e] = true\r\n        }\r\n        u = u.concat(v)\r\n    }\r\n    for (var c = u.length - 1; c >= 0; c--) {\r\n        var r = u[c][0];\r\n        var s = this.w[r];\r\n        s.win.style.zIndex = window.dhx4.zim.reserve(s.conf.z_id);\r\n        if (s.conf.modal && this.mcover != null ) {\r\n            for (var o in this.mcover) {\r\n                this.mcover[o].style.zIndex = s.win.style.zIndex\r\n            }\r\n        }\r\n        this._winAdjustFRMZIndex(r);\r\n        if (e == null  && c == 0) {\r\n            e = r\r\n        }\r\n        s.conf.actv = (e == r);\r\n        s.win.className = (s.conf.actv ? \"dhxwin_active\" : \"dhxwin_inactive\");\r\n        s = null \r\n    }\r\n    if (e != null  && this.conf.last_active != e) {\r\n        this._callMainEvent(\"onFocus\", e)\r\n    }\r\n    this.conf.last_active = e\r\n}\r\n;\r\ndhtmlXWindows.prototype._zOrder = [{\r\n    name: \"modal\",\r\n    value: true\r\n}, {\r\n    name: \"sticked\",\r\n    value: true\r\n}, {\r\n    name: \"sticked\",\r\n    value: false\r\n}];\r\ndhtmlXWindows.prototype._vpPull = {};\r\ndhtmlXWindows.prototype._vpOf = {};\r\ndhtmlXWindows.prototype._vpPullAdd = function() {\r\n    if (this.vp == null ) {\r\n        return\r\n    }\r\n    var e = null ;\r\n    for (var c in this._vpPull) {\r\n        if (this._vpPull[c].vp == this.vp) {\r\n            this._vpPull[c].count++;\r\n            e = c\r\n        }\r\n    }\r\n    if (e == null ) {\r\n        this._vpPull[window.dhx4.newId()] = {\r\n            vp: this.vp,\r\n            count: 1\r\n        }\r\n    }\r\n    if (this.vp == document.body && this.conf.vp_of_auto == true) {\r\n        this._vpOfInit()\r\n    }\r\n    this._vpOfUpd()\r\n}\r\n;\r\ndhtmlXWindows.prototype._vpPullRemove = function() {\r\n    if (this.vp == null ) {\r\n        return 0\r\n    }\r\n    var e = 0;\r\n    for (var c in this._vpPull) {\r\n        if (this._vpPull[c].vp == this.vp) {\r\n            e = --this._vpPull[c].count;\r\n            if (e == 0) {\r\n                this._vpPull[c].vp = null ;\r\n                this._vpPull[c].count = null ;\r\n                delete this._vpPull[c]\r\n            }\r\n        }\r\n    }\r\n    this._vpOfClear();\r\n    return e\r\n}\r\n;\r\ndhtmlXWindows.prototype._vpOfInit = function() {\r\n    this._vpOf[this.conf.vp_of_id] = true\r\n}\r\n;\r\ndhtmlXWindows.prototype._vpOfClear = function() {\r\n    this._vpOf[this.conf.vp_of_id] = false;\r\n    delete this._vpOf[this.conf.vp_of_id];\r\n    this._vpOfUpd()\r\n}\r\n;\r\ndhtmlXWindows.prototype._vpOfUpd = function() {\r\n    var e = false;\r\n    for (var c in this._vpOf) {\r\n        e = e || this._vpOf[c]\r\n    }\r\n    if (e == true) {\r\n        if (document.body.className.match(/dhxwins_vp_auto/) == null ) {\r\n            document.body.className += \" dhxwins_vp_auto\"\r\n        }\r\n    } else {\r\n        if (document.body.className.match(/dhxwins_vp_auto/) != null ) {\r\n            document.body.className = String(document.body.className).replace(/\\s{0,}dhxwins_vp_auto/gi, \"\")\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXWindows.prototype.attachViewportTo = function(h) {\r\n    var e = this._vpPullRemove();\r\n    if (this.conf.vp_custom) {\r\n        while (this.vp.childNodes.length > 0) {\r\n            this.vp.removeChild(this.vp.lastChild)\r\n        }\r\n        this.vp.parentNode.removeChild(this.vp);\r\n        this.vp = null \r\n    } else {\r\n        if (this.vp != null  && e == 0) {\r\n            this.vp.className = String(this.vp.className).replace(new RegExp(\"\\\\s{1,}dhxwins_vp_\" + this.conf.skin), \"\")\r\n        }\r\n    }\r\n    if (h == null ) {\r\n        this.vp = null \r\n    } else {\r\n        this.vp = (typeof (h) == \"string\" ? document.getElementById(h) : h);\r\n        var g = \"dhxwins_vp_\" + this.conf.skin;\r\n        if (this.vp.className.indexOf(g) < 0) {\r\n            this.vp.className += \" \" + g\r\n        }\r\n        h = null ;\r\n        for (var c in this.w) {\r\n            this.vp.appendChild(this.w[c].win)\r\n        }\r\n        this.conf.vp_custom = false\r\n    }\r\n    if (this.vp == document.body) {\r\n        document.body.style.position = \"static\"\r\n    }\r\n    this._vpPullAdd()\r\n}\r\n;\r\ndhtmlXWindows.prototype.setViewport = function(c, l, g, a, h) {\r\n    var e = document.createElement(\"DIV\");\r\n    e.style.position = \"absolute\";\r\n    e.style.left = c + \"px\";\r\n    e.style.top = l + \"px\";\r\n    e.style.width = g + \"px\";\r\n    e.style.height = a + \"px\";\r\n    if (typeof (h) == \"undefined\" || h == null ) {\r\n        h = document.body\r\n    } else {\r\n        if (typeof (h) == \"string\") {\r\n            h = document.getElementById(h)\r\n        }\r\n    }\r\n    h.appendChild(e);\r\n    this.attachViewportTo(e);\r\n    this.conf.vp_custom = true;\r\n    h = e = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winSetPosition = function(g, a, e) {\r\n    var c = this.w[g];\r\n    if (c.conf.maxed) {\r\n        c.conf.lastMX += (a - c.conf.x);\r\n        c.conf.lastMY += (e - c.conf.y)\r\n    }\r\n    c.conf.x = a;\r\n    c.conf.y = e;\r\n    c.win.style.left = c.conf.x + \"px\";\r\n    c.win.style.top = c.conf.y + \"px\";\r\n    this._winAdjustFRMPosition(g);\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winAdjustPosition = function(m, c, l) {\r\n    var e = this.w[m];\r\n    if (typeof (c) == \"undefined\") {\r\n        c = e.conf.x\r\n    }\r\n    if (typeof (l) == \"undefined\") {\r\n        l = e.conf.y\r\n    }\r\n    var a = (e.conf.keep_in_vp ? 0 : -e.conf.w + this.conf.vp_pos_ofs);\r\n    var h = (e.conf.keep_in_vp ? this.vp.clientWidth - e.conf.w : this.vp.clientWidth - this.conf.vp_pos_ofs);\r\n    if (c < a) {\r\n        c = a\r\n    } else {\r\n        if (c > h) {\r\n            c = h\r\n        }\r\n    }\r\n    var g = (e.conf.keep_in_vp ? this.vp.clientHeight - e.conf.h : this.vp.clientHeight - this.conf.vp_pos_ofs);\r\n    if (l < 0) {\r\n        l = 0\r\n    } else {\r\n        if (l > g) {\r\n            l = g\r\n        }\r\n    }\r\n    if (c != e.conf.x || l != e.conf.y) {\r\n        this._winSetPosition(m, c, l)\r\n    }\r\n    e = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winSetSize = function(n, l, e, m, c) {\r\n    var g = this.w[n];\r\n    var a = (l != null  ? l : g.conf.w);\r\n    var h = (e != null  ? e : g.conf.h);\r\n    if (this.conf.ofs_w == null ) {\r\n        g.win.style.width = a + \"px\";\r\n        g.win.style.height = h + \"px\";\r\n        this.conf.ofs_w = g.win.offsetWidth - a;\r\n        this.conf.ofs_h = g.win.offsetHeight - h\r\n    }\r\n    if (g.conf.min_w != null  && a < g.conf.min_w) {\r\n        a = g.conf.min_w\r\n    }\r\n    if (g.conf.max_w != null  && a > g.conf.max_w) {\r\n        a = g.conf.max_w\r\n    }\r\n    if (!g.conf.parked && g.conf.min_h != null  && h < g.conf.min_h) {\r\n        h = g.conf.min_h\r\n    }\r\n    if (g.conf.max_h != null  && h > g.conf.max_h) {\r\n        h = g.conf.max_h\r\n    }\r\n    if (g.conf.keep_in_vp) {\r\n        if (a > this.vp.clientWidth) {\r\n            a = this.vp.clientWidth\r\n        }\r\n        if (h > this.vp.clientHeight) {\r\n            h = this.vp.clientHeight\r\n        }\r\n    }\r\n    g.win.style.width = a - this.conf.ofs_w + \"px\";\r\n    g.win.style.height = h - this.conf.ofs_h + \"px\";\r\n    g.conf.w = a;\r\n    g.conf.h = h;\r\n    this._winAdjustFRMSize(n);\r\n    if (c) {\r\n        this._winAdjustPosition(n, g.conf.x, g.conf.y)\r\n    }\r\n    if (!g.conf.parked && m != true) {\r\n        this._winAdjustCell(n)\r\n    }\r\n    g = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winMinmax = function(h, e) {\r\n    if (typeof (e) != \"undefined\" && this.w[h].conf.maxed == e) {\r\n        return\r\n    }\r\n    if (this.w[h].conf.allow_resize == false) {\r\n        return\r\n    }\r\n    var c = this.w[h];\r\n    if (c.conf.parked) {\r\n        this._winPark(h, false)\r\n    }\r\n    if (c.conf.maxed) {\r\n        this._winSetSize(h, c.conf.lastMW, c.conf.lastMH);\r\n        this._winAdjustPosition(h, c.conf.lastMX, c.conf.lastMY);\r\n        c.conf.maxed = false\r\n    } else {\r\n        var a = 0;\r\n        var g = 0;\r\n        if (c.conf.max_w != null ) {\r\n            a = c.conf.x + Math.round(c.conf.w - c.conf.max_w) / 2\r\n        }\r\n        if (c.conf.max_h != null ) {\r\n            g = Math.max(c.conf.y + Math.round(c.conf.h - c.conf.max_h) / 2, 0)\r\n        }\r\n        c.conf.lastMX = c.conf.x;\r\n        c.conf.lastMY = c.conf.y;\r\n        c.conf.lastMW = c.conf.w;\r\n        c.conf.lastMH = c.conf.h;\r\n        this._winSetSize(h, this.vp.clientWidth, this.vp.clientHeight);\r\n        this._winAdjustPosition(h, a, g);\r\n        c.conf.maxed = true\r\n    }\r\n    c.b.minmax.setCss(c.conf.maxed ? \"minmaxed\" : \"minmax\");\r\n    if (c.conf.maxed) {\r\n        this._callMainEvent(\"onMaximize\", h)\r\n    } else {\r\n        this._callMainEvent(\"onMinimize\", h)\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winShow = function(c, a) {\r\n    if (this.w[c].conf.visible == true) {\r\n        return\r\n    }\r\n    this.w[c].win.style.display = \"\";\r\n    this.w[c].conf.visible = true;\r\n    if (a == true || this.conf.last_active == null ) {\r\n        this._winMakeActive(c, true)\r\n    }\r\n    this._callMainEvent(\"onShow\", c)\r\n}\r\n;\r\ndhtmlXWindows.prototype._winHide = function(c, a) {\r\n    if (this.w[c].conf.visible == false) {\r\n        return\r\n    }\r\n    this.w[c].win.style.display = \"none\";\r\n    this.w[c].conf.visible = false;\r\n    if (this.w[c].conf.actv) {\r\n        this.w[c].conf.actv = false;\r\n        this.w[c].win.className = \"dhxwin_inactive\";\r\n        this._winMakeActive(null , true)\r\n    }\r\n    this._callMainEvent(\"onHide\", c)\r\n}\r\n;\r\ndhtmlXWindows.prototype._winPark = function(e, a) {\r\n    if (this.w[e].conf.allow_park == false) {\r\n        return\r\n    }\r\n    if (this.w[e].conf.header == false) {\r\n        return\r\n    }\r\n    var c = this.w[e];\r\n    if (a == true && this.conf.tr.prop !== false) {\r\n        c.win.style[this.conf.tr.prop] = this.conf.tr[c.conf.parked ? \"height_open\" : \"height_close\"];\r\n        if (!c.conf.tr_ev) {\r\n            c.win.addEventListener(this.conf.tr.ev, this._winOnParkTrans, false);\r\n            c.conf.tr_ev = true\r\n        }\r\n    }\r\n    if (c.conf.parked) {\r\n        c.hdr.className = String(c.hdr.className).replace(/\\s{1,}dhxwin_hdr_parked/gi, \"\");\r\n        c.hdr.style.zIndex = 0;\r\n        c.conf.parked = false;\r\n        c.conf.tr_mode = \"park\";\r\n        this._winCellSetOpacity(e, \"open\", a);\r\n        this._winSetSize(e, c.conf.w, c.conf.lastPH, (a == true && this.conf.tr.prop !== false));\r\n        if (!(a == true && this.conf.tr.prop !== false)) {\r\n            this._callMainEvent(\"onParkDown\", e);\r\n            if (c.conf.keep_in_vp) {\r\n                this._winAdjustPosition(e, c.conf.x, c.conf.y)\r\n            }\r\n        }\r\n        if (window.dhx4.isIE8 == true && this.conf.tr.prop == false && c.cell.cell.className.match(/dhxwin_parked/) != null ) {\r\n            c.cell.cell.className = c.cell.cell.className.replace(/\\s{0,}dhxwin_parked/gi, \"\")\r\n        }\r\n    } else {\r\n        c.conf.lastPH = c.conf.h;\r\n        c.hdr.className += \" dhxwin_hdr_parked\";\r\n        if (a == false || this.conf.tr.prop == false) {\r\n            c.hdr.style.zIndex = 3\r\n        }\r\n        c.conf.parked = true;\r\n        c.conf.tr_mode = \"park\";\r\n        this._winCellSetOpacity(e, \"close\", a);\r\n        this._winSetSize(e, c.conf.w, c.hdr.offsetHeight + this.conf.ofs_h, (a == true && this.conf.tr.prop !== false));\r\n        if (!(a == true && this.conf.tr.prop !== false)) {\r\n            this._callMainEvent(\"onParkUp\", e)\r\n        }\r\n        if (window.dhx4.isIE8 == true && this.conf.tr.prop == false && c.cell.cell.className.match(/dhxwin_parked/) == null ) {\r\n            c.cell.cell.className += \" dhxwin_parked\"\r\n        }\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winCellSetOpacity = function(m, l, e, h) {\r\n    var c = this.w[m].cell;\r\n    for (var g in c.conf.idx) {\r\n        if ({\r\n            pr1: true,\r\n            pr2: true\r\n        }[g] != true) {\r\n            if (e == true && this.conf.tr.prop != false) {\r\n                c.cell.childNodes[c.conf.idx[g]].style[this.conf.tr.prop] = this.conf.tr[\"op_\" + l]\r\n            }\r\n            c.cell.childNodes[c.conf.idx[g]].style.opacity = this.conf.tr[\"op_v_\" + l]\r\n        }\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winCellClearOpacity = function(g) {\r\n    var c = this.w[g].cell;\r\n    for (var e in c.conf.idx) {\r\n        if ({\r\n            pr1: true,\r\n            pr2: true\r\n        }[e] != true) {\r\n            if (this.conf.tr.prop != false) {\r\n                c.cell.childNodes[c.conf.idx[e]].style[this.conf.tr.prop] = \"\"\r\n            }\r\n        }\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winStick = function(c, a) {\r\n    if (typeof (a) != \"undefined\" && this.w[c].conf.sticked == a) {\r\n        return\r\n    }\r\n    this.w[c].conf.sticked = !this.w[c].conf.sticked;\r\n    this.w[c].b.stick.setCss(this.w[c].conf.sticked ? \"sticked\" : \"stick\");\r\n    this._winMakeActive(this.conf.last_active, true);\r\n    if (this.w[c].conf.sticked) {\r\n        this._callMainEvent(\"onStick\", c)\r\n    } else {\r\n        this._callMainEvent(\"onUnStick\", c)\r\n    }\r\n}\r\n;\r\ndhtmlXWindows.prototype._winClose = function(g) {\r\n    if (this._callMainEvent(\"onClose\", g) !== true && this.conf.unloading != true) {\r\n        return\r\n    }\r\n    var e = this.w[g];\r\n    if (e.conf.fs_mode) {\r\n        e.cell.setToFullScreen(false)\r\n    }\r\n    if (e.conf.modal) {\r\n        this._winSetModal(g, false)\r\n    }\r\n    window.dhx4.zim.clear(e.conf.z_id);\r\n    if (this.cm != null  && this.cm.icon[g] != null ) {\r\n        this._detachContextMenu(\"icon\", g, null )\r\n    }\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        e.win.removeEventListener(\"mousedown\", this._winOnMouseDown, false);\r\n        e.win.removeEventListener(\"mouseup\", this._winOnMouseDown, false);\r\n        if (this.conf.dblclick_ev) {\r\n            e.win.removeEventListener(\"dblclick\", this._winOnMouseDown, false)\r\n        }\r\n        if (this.conf.dnd_enabled == true && window.dhx4.dnd.evs.start != null ) {\r\n            e.win.removeEventListener(window.dhx4.dnd.evs.start, this._winOnMouseDown, false);\r\n            if (window.dhx4.dnd.p_en != true) {\r\n                e.win.removeEventListener(window.dhx4.dnd.evs.start, this._winOnMouseDown, false);\r\n                e.win.removeEventListener(window.dhx4.dnd.evs.end, this._winOnMouseDown, false)\r\n            }\r\n        }\r\n    } else {\r\n        e.win.detachEvent(\"onmousedown\", this._winOnMouseDown);\r\n        e.win.detachEvent(\"onmouseup\", this._winOnMouseDown);\r\n        if (this.conf.dblclick_ev) {\r\n            e.win.attachEvent(\"ondblclick\", this._winOnMouseDown)\r\n        }\r\n    }\r\n    for (var c in e.b) {\r\n        this._winRemoveButton(g, c, true)\r\n    }\r\n    e.b = null ;\r\n    e.cell._unload();\r\n    e.cell = null ;\r\n    e.brd.parentNode.removeChild(e.brd);\r\n    e.brd = null ;\r\n    if (e.fr_cover != null ) {\r\n        e.fr_cover.parentNode.removeChild(e.fr_cover);\r\n        e.fr_cover = null \r\n    }\r\n    if (e.fr_m_cover != null ) {\r\n        e.fr_m_cover.parentNode.removeChild(e.fr_m_cover);\r\n        e.fr_m_cover = null \r\n    }\r\n    e.hdr._isWinHdr = true;\r\n    e.hdr.firstChild._isWinIcon = true;\r\n    e.hdr.onselectstart = null ;\r\n    e.hdr.parentNode.removeChild(e.hdr);\r\n    e.hdr = null ;\r\n    for (var c in e.conf) {\r\n        e.conf[c] = null ;\r\n        delete e.conf[c]\r\n    }\r\n    e.conf = null ;\r\n    e.win._idd = null ;\r\n    e.win._isWindow = null ;\r\n    e.win.parentNode.removeChild(e.win);\r\n    e.win = null ;\r\n    e = null ;\r\n    this.w[g] = null ;\r\n    delete this.w[g];\r\n    if (!this.conf.unloading) {\r\n        this._winMakeActive(null , true)\r\n    }\r\n}\r\n;\r\ndhtmlXWindows.prototype._winSetModal = function(m, g, l) {\r\n    if (this.w[m].conf.modal == g) {\r\n        return\r\n    }\r\n    if (typeof (l) == \"undefined\") {\r\n        l = true\r\n    }\r\n    var e = this.w[m];\r\n    if (g == true && e.conf.modal == false) {\r\n        if (this.conf.last_modal != null ) {\r\n            this._winSetModal(this.conf.last_modal, false, false)\r\n        }\r\n        if (this.mcover == null ) {\r\n            var h = document.createElement(\"DIV\");\r\n            h.className = \"dhxwins_mcover\";\r\n            this.vp.insertBefore(h, e.fr_m_cover || e.win);\r\n            this.mcover = {\r\n                d: h\r\n            };\r\n            if (this.conf.fr_cover) {\r\n                this.mcover.f = document.createElement(\"IFRAME\");\r\n                this.mcover.f.className = \"dhxwins_mcover\";\r\n                this.mcover.f.border = 0;\r\n                this.mcover.f.frameBorder = 0;\r\n                this.vp.insertBefore(this.mcover.f, h)\r\n            }\r\n            h = null \r\n        } else {\r\n            if (this.mcover.d.nextSibling != (e.fr_m_cover || e.win)) {\r\n                this.vp.insertBefore(this.mcover.d, e.fr_m_cover || e.win);\r\n                if (this.mcover.f != null ) {\r\n                    this.vp.insertBefore(this.mcover.f, this.mcover.d)\r\n                }\r\n            }\r\n        }\r\n        e.conf.modal = true;\r\n        this.conf.last_modal = m;\r\n        this._winMakeActive(m, true)\r\n    } else {\r\n        if (g == false && e.conf.modal == true) {\r\n            e.conf.modal = false;\r\n            this.conf.last_modal = null ;\r\n            if (l && this.mcover != null ) {\r\n                for (var c in this.mcover) {\r\n                    this.vp.removeChild(this.mcover[c]);\r\n                    this.mcover[c] = null \r\n                }\r\n                this.mcover = null \r\n            }\r\n        }\r\n    }\r\n    e = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winMouseDownHandler = function(g, c) {\r\n    var a = g.target || g.srcElement;\r\n    if (g.button >= 2) {\r\n        return\r\n    }\r\n    if (c.mode == \"button\") {\r\n        if (c.press_type == \"mousedown\") {\r\n            this.conf.button_last = c.button_name\r\n        } else {\r\n            if ((c.press_type == \"mouseup\" && c.button_name == this.conf.button_last) || c.press_type == \"MSPointerDown\" || c.press_type == \"pointerdown\") {\r\n                this.conf.button_last = null ;\r\n                if (this._winButtonClick(c.id, c.button_name, g) !== true) {\r\n                    return\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if ((c.press_type == \"pointerdown\" || c.press_type == \"mousedown\" || c.press_type == \"dblclick\") && c.mode == \"hdr\") {\r\n        this.conf.dblclick_active = false;\r\n        if (this.conf.dblclick_ev == true) {\r\n            if (c.press_type == \"dblclick\") {\r\n                this.conf.dblclick_active = true\r\n            }\r\n        } else {\r\n            if (this.conf.dblclick_last == null ) {\r\n                this.conf.dblclick_last = new Date().getTime();\r\n                this.dblclick_id = c.id\r\n            } else {\r\n                var a = new Date().getTime();\r\n                if (this.conf.dblclick_last + this.conf.dblclick_tm > a && this.dblclick_id == c.id) {\r\n                    this.conf.dblclick_active = true;\r\n                    this.conf.dblclick_last = null ;\r\n                    this.dblclick_id = null \r\n                } else {\r\n                    this.conf.dblclick_last = a;\r\n                    this.dblclick_id = c.id\r\n                }\r\n            }\r\n        }\r\n        if (this.conf.dblclick_active) {\r\n            this._winDoHeaderDblClick(c.id);\r\n            return\r\n        }\r\n    }\r\n    if (c.press_type == \"mousedown\" || (c.press_type == window.dhx4.dnd.evs.start)) {\r\n        this._winMakeActive(c.id)\r\n    }\r\n    if (c.press_type == \"touchend\") {}\r\n}\r\n;\r\ndhtmlXWindows.prototype._winDoHeaderDblClick = function(a) {\r\n    if (this.conf.dblclick_mode == \"minmax\") {\r\n        this._winMinmax(a);\r\n        return\r\n    }\r\n    if (this.conf.dblclick_mode == \"park\") {\r\n        this._winPark(a, true);\r\n        return\r\n    }\r\n    if (typeof (this.conf.dblclick_mode) == \"function\") {\r\n        this.conf.dblclick_mode.apply(window, [a]);\r\n        return\r\n    }\r\n    if (typeof (window[this.conf.dblclick_mode]) == \"function\") {\r\n        window[this.conf.dblclick_mode].apply(window, [a]);\r\n        return\r\n    }\r\n}\r\n;\r\ndhtmlXWindows.prototype._winAdjustCell = function(c) {\r\n    var r = this.w[c];\r\n    var o = 1;\r\n    var n = (r.conf.header ? r.hdr.offsetHeight : 1);\r\n    var g = r.win.clientWidth - 2;\r\n    var s = r.win.clientHeight - n - 1;\r\n    r.brd.style.left = o + \"px\";\r\n    r.brd.style.top = n + \"px\";\r\n    if (r.conf.brd == null ) {\r\n        r.brd.style.width = g + \"px\";\r\n        r.brd.style.height = s + \"px\";\r\n        r.conf.brd = {\r\n            w: g - r.brd.offsetWidth,\r\n            h: s - r.brd.offsetHeight\r\n        }\r\n    }\r\n    r.brd.style.width = g + r.conf.brd.w + \"px\";\r\n    r.brd.style.height = s + r.conf.brd.h + \"px\";\r\n    var e = 5;\r\n    var a = 1 + e;\r\n    var m = (r.conf.header ? n : n + e);\r\n    var h = r.brd.clientWidth;\r\n    var l = r.brd.clientHeight;\r\n    r.cell._setSize(a, m, h, l);\r\n    r.fr_cover.style.left = a + \"px\";\r\n    r.fr_cover.style.top = m + \"px\";\r\n    r.fr_cover.style.width = h + \"px\";\r\n    r.fr_cover.style.height = l + \"px\";\r\n    r = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winAdjustTitle = function(g) {\r\n    var a = this.w[g].hdr.childNodes[0];\r\n    var e = this.w[g].hdr.childNodes[1];\r\n    var c = this.w[g].hdr.childNodes[2];\r\n    e.style.paddingLeft = a.offsetWidth + 12 + \"px\";\r\n    e.style.paddingRight = c.offsetWidth + 10 + \"px\";\r\n    e = c = a = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._callMainEvent = function(c, g) {\r\n    var a = this.w[g];\r\n    if (a.cell.checkEvent(c)) {\r\n        var e = a.cell._callMainEvent(c, [a.cell])\r\n    } else {\r\n        var e = this.callEvent(c, [a.cell])\r\n    }\r\n    a = null ;\r\n    return e\r\n}\r\n;\r\ndhtmlXWindows.prototype._winInitFRM = function(e) {\r\n    if (this.conf.fr_cover != true) {\r\n        return\r\n    }\r\n    var a = this.w[e];\r\n    var c = document.createElement(\"IFRAME\");\r\n    c.className = \"dhxwin_main_fr_cover\";\r\n    c.border = 0;\r\n    c.frameBorder = 0;\r\n    c.style.zIndex = a.win.style.zIndex;\r\n    a.win.parentNode.insertBefore(c, a.win);\r\n    a.fr_m_cover = c;\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winAdjustFRMSize = function(c) {\r\n    var a = this.w[c];\r\n    if (a.fr_m_cover != null ) {\r\n        a.fr_m_cover.style.width = a.conf.w + \"px\";\r\n        a.fr_m_cover.style.height = a.conf.h + \"px\"\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winAdjustFRMPosition = function(c) {\r\n    var a = this.w[c];\r\n    if (a.fr_m_cover != null ) {\r\n        a.fr_m_cover.style.left = a.win.style.left;\r\n        a.fr_m_cover.style.top = a.win.style.top\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXWindows.prototype._winAdjustFRMZIndex = function(c) {\r\n    var a = this.w[c];\r\n    if (a.fr_m_cover != null ) {\r\n        a.fr_m_cover.style.zIndex = a.win.style.zIndex\r\n    }\r\n    a = null \r\n}\r\n;\r\nfunction dhtmlXWindowsCell(h, g) {\r\n    dhtmlXCellObject.apply(this, [h, \"_wins\"]);\r\n    this.wins = g;\r\n    this.cell._winId = h;\r\n    this.conf.skin = this.wins.conf.skin;\r\n    this.attachEvent(\"_onCellUnload\", function() {\r\n        if (this._unloadResize) {\r\n            this._unloadResize()\r\n        }\r\n        window.dhx4._eventable(this.cell, \"clear\");\r\n        this.cell._winId = null ;\r\n        this.wins = null ;\r\n        this.setText = null ;\r\n        this.getText = null ;\r\n        this.allowMove = null ;\r\n        this.denyMove = null ;\r\n        this.isMovable = null ;\r\n        this.allowResize = null ;\r\n        this.denyResize = null ;\r\n        this.isResizable = null ;\r\n        this.maximize = null ;\r\n        this.minimize = null ;\r\n        this.isMaximized = null ;\r\n        this.setPosition = null ;\r\n        this.getPosition = null ;\r\n        this.adjustPosition = null ;\r\n        this.park = null ;\r\n        this.isParked = null ;\r\n        this.allowPark = null ;\r\n        this.denyPark = null ;\r\n        this.isParkable = null ;\r\n        this.show = null ;\r\n        this.hide = null ;\r\n        this.isHidden = null ;\r\n        this.stick = null ;\r\n        this.unstick = null ;\r\n        this.isSticked = null ;\r\n        this.setDimension = null ;\r\n        this.getDimension = null ;\r\n        this.setMinDimension = null ;\r\n        this.getMinDimension = null ;\r\n        this.setMaxDimension = null ;\r\n        this.getMaxDimension = null ;\r\n        this.keepInViewport = null ;\r\n        this.center = null ;\r\n        this.centerOnScreen = null ;\r\n        this.bringToTop = null ;\r\n        this.bringToBottom = null ;\r\n        this.isOnTop = null ;\r\n        this.isOnBottom = null ;\r\n        this.showHeader = null ;\r\n        this.hideHeader = null ;\r\n        this.setModal = null ;\r\n        this.isModal = null ;\r\n        this.close = null ;\r\n        this._adjustByCont = null ;\r\n        this.button = null ;\r\n        this.addUserButton = null ;\r\n        this.removeUserButton = null ;\r\n        e = null \r\n    });\r\n    this.attachEvent(\"_onContentLoaded\", function() {\r\n        this.wins._callMainEvent(\"onContentLoaded\", this._idd)\r\n    });\r\n    this.attachEvent(\"_onContentMouseDown\", function(l, a) {\r\n        this.wins.callEvent(\"_winMouseDown\", [a, {\r\n            id: l,\r\n            mode: \"win\"\r\n        }])\r\n    });\r\n    this._callMainEvent = function(l, a) {\r\n        return this.callEvent(l, a)\r\n    }\r\n    ;\r\n    this.conf.tr = {};\r\n    for (var c in this.wins.conf.tr) {\r\n        this.conf.tr[c] = this.wins.conf.tr[c]\r\n    }\r\n    if (this.conf.tr.prop != false) {}\r\n    if (this._initResize) {\r\n        this._initResize()\r\n    }\r\n    window.dhx4._eventable(this.cell);\r\n    var e = this;\r\n    this.cell.attachEvent(\"_setCellSize\", function(a, n) {\r\n        var l = e.wins.w[this._winId].conf.w - e.conf.size.w;\r\n        var m = e.wins.w[this._winId].conf.h - e.conf.size.h;\r\n        e.setDimension(a + l, n + m)\r\n    });\r\n    return this\r\n}\r\ndhtmlXWindowsCell.prototype = new dhtmlXCellObject();\r\ndhtmlXWindowsCell.prototype.setText = function(a) {\r\n    this.wins.w[this._idd].conf.text = a;\r\n    this.wins.w[this._idd].hdr.childNodes[1].firstChild.innerHTML = a\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.getText = function() {\r\n    return this.wins.w[this._idd].conf.text\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.allowMove = function() {\r\n    this.wins.w[this._idd].conf.allow_move = true\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.denyMove = function() {\r\n    this.wins.w[this._idd].conf.allow_move = false\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isMovable = function() {\r\n    return ( this.wins.w[this._idd].conf.allow_move == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.allowResize = function() {\r\n    this.wins.w[this._idd].conf.allow_resize = true;\r\n    this.wins.w[this._idd].b.minmax.enable()\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.denyResize = function() {\r\n    this.wins.w[this._idd].conf.allow_resize = false;\r\n    this.wins.w[this._idd].b.minmax.disable()\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isResizable = function() {\r\n    return ( this.wins.w[this._idd].conf.allow_resize == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.maximize = function() {\r\n    this.wins._winMinmax(this._idd, true)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.minimize = function() {\r\n    this.wins._winMinmax(this._idd, false)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isMaximized = function() {\r\n    return ( this.wins.w[this._idd].conf.maxed == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setPosition = function(a, c) {\r\n    this.wins._winSetPosition(this._idd, a, c)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.getPosition = function() {\r\n    var a = this.wins.w[this._idd];\r\n    var c = [a.conf.x, a.conf.y];\r\n    a = null ;\r\n    return c\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.adjustPosition = function() {\r\n    this.wins._winAdjustPosition(this._idd)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.park = function() {\r\n    this.wins._winPark(this._idd, true)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isParked = function() {\r\n    return ( this.wins.w[this._idd].conf.parked == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.allowPark = function() {\r\n    this.wins.w[this._idd].conf.allow_park = true;\r\n    this.wins.w[this._idd].b.park.enable()\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.denyPark = function() {\r\n    this.wins.w[this._idd].conf.allow_park = false;\r\n    this.wins.w[this._idd].b.park.disable()\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isParkable = function() {\r\n    return ( this.wins.w[this._idd].conf.allow_park == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.show = function(a) {\r\n    this.wins._winShow(this._idd, window.dhx4.s2b(a))\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.hide = function() {\r\n    this.wins._winHide(this._idd)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isHidden = function() {\r\n    return ( this.wins.w[this._idd].conf.visible != true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.stick = function() {\r\n    this.wins._winStick(this._idd, true)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.unstick = function() {\r\n    this.wins._winStick(this._idd, false)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isSticked = function() {\r\n    return ( this.wins.w[this._idd].conf.sticked == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setDimension = function(e, a) {\r\n    var c = this.wins.w[this._idd];\r\n    if (c.conf.parked) {\r\n        this.wins._winPark(this._idd, false)\r\n    }\r\n    if (c.conf.maxed) {\r\n        if (e != null ) {\r\n            c.conf.lastMW = e\r\n        }\r\n        if (a != null ) {\r\n            c.conf.lastMH = a\r\n        }\r\n        this.wins._winMinmax(this._idd)\r\n    } else {\r\n        this.wins._winSetSize(this._idd, e, a, false, true)\r\n    }\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.getDimension = function() {\r\n    var a = this.wins.w[this._idd];\r\n    var c = [a.conf.w, a.conf.h];\r\n    a = null ;\r\n    return c\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setMinDimension = function(e, a) {\r\n    var c = this.wins.w[this._idd];\r\n    c.conf.min_w = e;\r\n    c.conf.min_h = a;\r\n    this.wins._winSetSize(this._idd, c.conf.w, c.conf.h);\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.getMinDimension = function() {\r\n    var a = this.wins.w[this._idd];\r\n    var c = [a.conf.min_w, a.conf.min_h];\r\n    a = null ;\r\n    return c\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setMaxDimension = function(e, a) {\r\n    var c = this.wins.w[this._idd];\r\n    c.conf.max_w = e;\r\n    c.conf.max_h = a;\r\n    this.wins._winSetSize(this._idd, c.conf.w, c.conf.h);\r\n    c = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.getMaxDimension = function() {\r\n    var a = this.wins.w[this._idd];\r\n    var c = [a.conf.max_w, a.conf.max_h];\r\n    a = null ;\r\n    return c\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.keepInViewport = function(a) {\r\n    this.wins.w[this._idd].conf.keep_in_vp = window.dhx4.s2b(a)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.center = function() {\r\n    var e = this.wins.vp;\r\n    var c = this.wins.w[this._idd];\r\n    var a = Math.round((e.clientWidth - c.conf.w) / 2);\r\n    var g = Math.round((e.clientHeight - c.conf.h) / 2);\r\n    this.wins._winSetPosition(this._idd, a, g);\r\n    e = c = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.centerOnScreen = function() {\r\n    var c = this.wins.w[this._idd];\r\n    var l = window.dhx4.screenDim();\r\n    var h = window.dhx4.absLeft(this.wins.vp);\r\n    var g = window.dhx4.absTop(this.wins.vp);\r\n    var e = this.wins.vp.parentNode;\r\n    while (e != null ) {\r\n        if (e.scrollLeft) {\r\n            h = h - e.scrollLeft\r\n        }\r\n        if (e.scrollTop) {\r\n            g = g - e.scrollTop\r\n        }\r\n        e = e.parentNode\r\n    }\r\n    var a = Math.round((l.right - l.left - c.conf.w) / 2);\r\n    var m = Math.round((l.bottom - l.top - c.conf.h) / 2);\r\n    this.wins._winAdjustPosition(this._idd, a - h, m - g);\r\n    d = c = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.bringToTop = function() {\r\n    this.wins._winMakeActive(this._idd, true)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.bringToBottom = function() {\r\n    var a = (this.wins.w[this._idd].conf.actv ? null  : this.wins.conf.last_active);\r\n    window.dhx4.zim.clear(this.wins.w[this._idd].conf.z_id);\r\n    this.wins.w[this._idd].win.style.zIndex = 0;\r\n    this.wins._winMakeActive(a, true)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isOnTop = function() {\r\n    return ( this.wins.w[this._idd].conf.actv == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isOnBottom = function() {\r\n    var e = {\r\n        id: null ,\r\n        z: +Infinity\r\n    };\r\n    for (var c in this.wins.w) {\r\n        if (this.wins.w[c].conf.visible && this.wins.w[c].win.style.zIndex < e.z) {\r\n            e.id = c;\r\n            e.z = this.wins.w[c].win.style.zIndex\r\n        }\r\n    }\r\n    return ( e.id == this._idd) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.showHeader = function() {\r\n    var a = this.wins.w[this._idd];\r\n    if (a.conf.header == false) {\r\n        a.hdr.className = String(a.hdr.className).replace(/\\s{0,}dhxwin_hdr_hidden/gi, \"\");\r\n        a.brd.className = String(a.brd.className).replace(/\\s{0,}dhxwin_hdr_hidden/gi, \"\");\r\n        this.conf.cells_cont = null ;\r\n        a.conf.brd = null ;\r\n        a.conf.header = true;\r\n        this.wins._winAdjustCell(this._idd)\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.hideHeader = function() {\r\n    var a = this.wins.w[this._idd];\r\n    if (a.conf.header == true) {\r\n        if (a.conf.parked) {\r\n            this.wins._winPark(this._idd, false)\r\n        }\r\n        a.hdr.className += \" dhxwin_hdr_hidden\";\r\n        a.brd.className += \" dhxwin_hdr_hidden\";\r\n        this.conf.cells_cont = null ;\r\n        a.conf.brd = null ;\r\n        a.conf.header = false;\r\n        this.wins._winAdjustCell(this._idd)\r\n    }\r\n    a = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setModal = function(a) {\r\n    this.wins._winSetModal(this._idd, window.dhx4.s2b(a))\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.isModal = function() {\r\n    return ( this.wins.w[this._idd].conf.modal == true) \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype._adjustByCont = function(a, c) {\r\n    a += this.wins.w[this._idd].conf.w - this.conf.size.w;\r\n    c += this.wins.w[this._idd].conf.h - this.conf.size.h;\r\n    this.wins._winSetSize(this._idd, a, c)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.close = function() {\r\n    this.wins._winClose(this._idd)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setIconCss = function(a) {\r\n    this.wins.w[this._idd].hdr.firstChild.className = \"dhxwin_icon \" + a;\r\n    this.wins._winAdjustTitle(this._idd)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.setToFullScreen = function(c) {\r\n    c = window.dhx4.s2b(c);\r\n    var a = this.wins.w[this._idd];\r\n    if (a.conf.fs_mode == c) {\r\n        a = null ;\r\n        return\r\n    }\r\n    if (this.wins.fsn == null ) {\r\n        this.wins.fsn = document.createElement(\"DIV\");\r\n        this.wins.fsn.className = this.wins.vp.className + \" dhxwins_vp_fs\";\r\n        document.body.appendChild(this.wins.fsn)\r\n    }\r\n    if (c) {\r\n        this.wins.fsn.appendChild(a.win);\r\n        this.maximize();\r\n        this.hideHeader()\r\n    } else {\r\n        this.wins.vp.appendChild(a.win);\r\n        this.minimize();\r\n        this.showHeader();\r\n        if (this.wins.fsn.childNodes.length == 0) {\r\n            this.wins.fsn.parentNode.removeChild(this.wins.fsn);\r\n            this.wins.fsn = null \r\n        }\r\n    }\r\n    a.conf.fs_mode = c;\r\n    a = null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.button = function(a) {\r\n    if (a == \"minmax1\" || a == \"minmax2\") {\r\n        a = \"minmax\"\r\n    }\r\n    return this.wins.w[this._idd].b[a]\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.addUserButton = function(m, l, e) {\r\n    var a = new dhtmlXWindowsButton(this.wins,this._idd,m,e,true);\r\n    var g = null ;\r\n    var c = this.wins.w[this._idd].hdr.lastChild;\r\n    if (isNaN(l)) {\r\n        l = 0\r\n    } else {\r\n        if (l < 0) {\r\n            l = 0\r\n        }\r\n    }\r\n    if (c.childNodes[l] != null ) {\r\n        g = c.childNodes[l]\r\n    }\r\n    if (g != null ) {\r\n        c.insertBefore(a.button, g)\r\n    } else {\r\n        c.appendChild(a.button)\r\n    }\r\n    this.wins.w[this._idd].b[m] = a;\r\n    a = g = c = null ;\r\n    this.wins._winAdjustTitle(this._idd)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.removeUserButton = function(a) {\r\n    if (this.wins.w[this._idd].b[a] == null  || this.wins.w[this._idd].b[a].conf.custom != true) {\r\n        return\r\n    }\r\n    this.wins._winRemoveButton(this._idd, a)\r\n}\r\n;\r\nwindow.dhtmlXWindowsButton = function(h, c, a, g, e) {\r\n    this.conf = {\r\n        wins: h,\r\n        winId: c,\r\n        name: a,\r\n        enabled: true,\r\n        visible: true,\r\n        custom: true\r\n    };\r\n    this.button = document.createElement(\"DIV\");\r\n    this.button._buttonName = a;\r\n    this.button.title = g;\r\n    this.enable = function() {\r\n        this.conf.enabled = true;\r\n        this.setCss(this.conf.css)\r\n    }\r\n    ;\r\n    this.disable = function() {\r\n        this.conf.enabled = false;\r\n        this.setCss(this.conf.css)\r\n    }\r\n    ;\r\n    this.isEnabled = function() {\r\n        return ( this.conf.enabled == true) \r\n    }\r\n    ;\r\n    this.show = function() {\r\n        this.button.style.display = \"\";\r\n        this.conf.visible = true;\r\n        this.conf.wins._winAdjustTitle(this.conf.winId)\r\n    }\r\n    ;\r\n    this.hide = function() {\r\n        this.button.style.display = \"none\";\r\n        this.conf.visible = false;\r\n        this.conf.wins._winAdjustTitle(this.conf.winId)\r\n    }\r\n    ;\r\n    this.isHidden = function() {\r\n        return ( this.conf.visible == false) \r\n    }\r\n    ;\r\n    this.setCss = function(m) {\r\n        this.conf.css = m;\r\n        var l = (this.conf.enabled ? \"\" : \"_dis\");\r\n        this.button.className = \"dhxwin_button\" + l + \" dhxwin_button_\" + this.conf.css + l\r\n    }\r\n    ;\r\n    this._doOnClick = function(l) {\r\n        return this.callEvent(\"onClick\", [this.conf.wins.w[this.conf.winId].cell, this])\r\n    }\r\n    ;\r\n    this.unload = function(l) {\r\n        dhx4._eventable(this, \"clear\");\r\n        this.button._buttonName = null ;\r\n        this.button.parentNode.removeChild(this.button);\r\n        if (this.conf.wins.cm != null  && this.conf.wins.cm.button[this.conf.winId] != null  && this.conf.wins.cm.button[this.conf.winId][this.conf.name] != null ) {\r\n            this.conf.wins._detachContextMenu(\"button\", this.conf.winId, this.conf.name)\r\n        }\r\n        this.button = null ;\r\n        this.enable = null ;\r\n        this.disable = null ;\r\n        this.isEnabled = null ;\r\n        this.show = null ;\r\n        this.hide = null ;\r\n        this.isHidden = null ;\r\n        this.setCss = null ;\r\n        this.unload = null ;\r\n        if (l != true) {\r\n            this.conf.wins._winAdjustTitle(this.conf.winId)\r\n        }\r\n        this.conf.wins = null ;\r\n        this.conf.winId = null ;\r\n        this.conf = null \r\n    }\r\n    ;\r\n    this.setCss(a);\r\n    dhx4._eventable(this);\r\n    return this\r\n}\r\n;\r\ndhtmlXWindows.prototype._winButtonClick = function(e, a, c) {\r\n    if (!this.w[e].b[a].isEnabled()) {\r\n        return true\r\n    }\r\n    if (this.w[e].b[a]._doOnClick() !== true) {\r\n        return\r\n    }\r\n    if (a == \"help\") {\r\n        this._callMainEvent(\"onHelp\", e)\r\n    }\r\n    if (a == \"park\") {\r\n        this._winPark(e, true)\r\n    }\r\n    if (a == \"minmax\") {\r\n        this._winMinmax(e)\r\n    }\r\n    if (a == \"stick\") {\r\n        this._winStick(e);\r\n        return false\r\n    }\r\n    if (a == \"close\") {\r\n        this._winClose(e);\r\n        return false\r\n    }\r\n    return true\r\n}\r\n;\r\ndhtmlXWindows.prototype._winRemoveButton = function(e, a, c) {\r\n    this.w[e].b[a].unload(c);\r\n    this.w[e].b[a] = null ;\r\n    delete this.w[e].b[a]\r\n}\r\n;\r\ndhtmlXWindows.prototype._dndInitModule = function() {\r\n    var a = this;\r\n    this.conf.dnd_enabled = true;\r\n    this.conf.dnd_tm = null ;\r\n    this.conf.dnd_time = 0;\r\n    this._dndOnMouseDown = function(h, l) {\r\n        if (a.conf.dblclick_active) {\r\n            return\r\n        }\r\n        if (h.preventDefault) {\r\n            h.preventDefault()\r\n        } else {\r\n            h.returnValue = false\r\n        }\r\n        if (a._callMainEvent(\"onBeforeMoveStart\", l) !== true) {\r\n            return\r\n        }\r\n        a.conf.dnd = {\r\n            id: l,\r\n            x: a._dndPos(h, \"X\"),\r\n            y: a._dndPos(h, \"Y\"),\r\n            ready: true,\r\n            css: false,\r\n            css_touch: false,\r\n            css_vp: false,\r\n            tr: null ,\r\n            mode: \"def\",\r\n            moved: false,\r\n            prevent: false\r\n        };\r\n        if (a.w[l].conf.keep_in_vp) {\r\n            a.conf.dnd.minX = 0;\r\n            a.conf.dnd.maxX = a.vp.clientWidth - a.w[l].conf.w;\r\n            a.conf.dnd.minY = 0;\r\n            a.conf.dnd.maxY = a.vp.clientHeight - a.w[l].conf.h\r\n        } else {\r\n            a.conf.dnd.minX = -a.w[l].conf.w + a.conf.vp_pos_ofs;\r\n            a.conf.dnd.maxX = a.vp.clientWidth - a.conf.vp_pos_ofs;\r\n            a.conf.dnd.minY = 0;\r\n            a.conf.dnd.maxY = a.vp.clientHeight - a.conf.vp_pos_ofs\r\n        }\r\n        var c = [\"MozTransform\", \"WebkitTransform\", \"OTransform\", \"msTransform\", \"transform\"];\r\n        for (var g = 0; g < c.length; g++) {\r\n            if (document.documentElement.style[c[g]] != null  && a.conf.dnd.tr == null ) {\r\n                a.conf.dnd.tr = c[g];\r\n                a.conf.dnd.mode = \"tr\"\r\n            }\r\n        }\r\n        if (a.conf.dnd.mode == \"tr\") {\r\n            a.w[l].win.style[a.conf.dnd.tr] = \"translate(0px,0px)\";\r\n            if (a.w[l].fr_m_cover != null ) {\r\n                a.w[l].fr_m_cover.style[a.conf.dnd.tr] = a.w[l].win.style[a.conf.dnd.tr]\r\n            }\r\n        }\r\n        if (window.dhx4.dnd._mTouch(h) == false && h.type == window.dhx4.dnd.evs.start) {\r\n            if (a.conf.dnd.css_touch == false) {\r\n                a.w[l].win.className += \" dhxwin_dnd_touch\";\r\n                a.conf.dnd.css_touch = true\r\n            }\r\n            if (a.conf.dnd.css_vp == false) {\r\n                a.vp.className += \" dhxwins_vp_dnd\";\r\n                a.conf.dnd.css_vp = true\r\n            }\r\n        } else {\r\n            a._dndInitEvents()\r\n        }\r\n    }\r\n    ;\r\n    this._dndOnMouseMove = function(l) {\r\n        l = l || event;\r\n        var h = a.conf.dnd;\r\n        var c = a._dndPos(l, \"X\") - h.x;\r\n        var m = a._dndPos(l, \"Y\") - h.y;\r\n        if (l.type == window.dhx4.dnd.evs.move) {\r\n            if (h.moved != true && (Math.abs(c) > 20 || Math.abs(m) > 20)) {\r\n                if (a.conf.dnd_tm != null ) {\r\n                    window.clearTimeout(a.conf.dnd_tm);\r\n                    a.conf.dnd_tm = null \r\n                }\r\n                window.removeEventListener(window.dhx4.dnd.evs.start, a._dndOnMouseMove, false);\r\n                return\r\n            }\r\n        }\r\n        if (h.ready != true) {\r\n            return\r\n        }\r\n        var g = a.w[h.id];\r\n        if (l.preventDefault) {\r\n            l.preventDefault()\r\n        } else {\r\n            l.returnValue = false\r\n        }\r\n        if (h.css != true) {\r\n            if (h.css_touch == false) {\r\n                g.win.className += \" dhxwin_dnd\"\r\n            }\r\n            g.fr_cover.className += \" dhxwin_fr_cover_dnd\";\r\n            h.css = true\r\n        }\r\n        if (h.css_vp != true) {\r\n            a.vp.className += \" dhxwins_vp_dnd\";\r\n            h.css_vp = true\r\n        }\r\n        h.newX = g.conf.x + c;\r\n        h.newY = g.conf.y + m;\r\n        if (h.mode == \"tr\") {\r\n            h.newX = Math.min(Math.max(h.newX, h.minX), h.maxX);\r\n            c = h.newX - g.conf.x;\r\n            h.newY = Math.min(Math.max(h.newY, h.minY), h.maxY);\r\n            m = h.newY - g.conf.y;\r\n            g.win.style[h.tr] = \"translate(\" + c + \"px,\" + m + \"px)\";\r\n            if (g.fr_m_cover != null ) {\r\n                g.fr_m_cover.style[h.tr] = g.win.style[h.tr]\r\n            }\r\n        } else {\r\n            if (h.newX < h.minX || h.newX > h.maxX) {\r\n                h.newX = Math.min(Math.max(h.newX, h.minX), h.maxX)\r\n            } else {\r\n                h.x = a._dndPos(l, \"X\")\r\n            }\r\n            if (h.newY < h.minY || h.newY > h.maxY) {\r\n                h.newY = Math.min(Math.max(h.newY, h.minY), h.maxY)\r\n            } else {\r\n                h.y = a._dndPos(l, \"Y\")\r\n            }\r\n            a._winSetPosition(h.id, h.newX, h.newY)\r\n        }\r\n        h.moved = true;\r\n        g = h = null \r\n    }\r\n    ;\r\n    this._dndOnMouseUp = function(h) {\r\n        h = h || event;\r\n        a._dndUnloadEvents();\r\n        if (a.conf.dnd != null  && a.conf.dnd.id != null ) {\r\n            var g = a.conf.dnd;\r\n            var c = a.w[g.id];\r\n            if (g.newX != null ) {\r\n                if (g.mode == \"tr\") {\r\n                    a._winSetPosition(g.id, g.newX, g.newY);\r\n                    c.win.style[g.tr] = \"translate(0px,0px)\";\r\n                    if (c.fr_m_cover != null ) {\r\n                        c.fr_m_cover.style[g.tr] = c.win.style[g.tr]\r\n                    }\r\n                }\r\n            }\r\n            if (g.css == true) {\r\n                if (g.css_touch == false) {\r\n                    c.win.className = String(c.win.className).replace(/\\s{0,}dhxwin_dnd/gi, \"\")\r\n                }\r\n                c.fr_cover.className = String(c.fr_cover.className).replace(/\\s{0,}dhxwin_fr_cover_dnd/gi, \"\")\r\n            }\r\n            if (g.css_touch == true) {\r\n                c.win.className = String(c.win.className).replace(/\\s{0,}dhxwin_dnd_touch/gi, \"\")\r\n            }\r\n            if (g.css_vp == true) {\r\n                a.vp.className = String(a.vp.className).replace(/\\s{0,}dhxwins_vp_dnd/gi, \"\")\r\n            }\r\n            if (g.moved == true) {\r\n                a._callMainEvent(\"onMoveFinish\", g.id)\r\n            } else {\r\n                a._callMainEvent(\"onMoveCancel\", g.id)\r\n            }\r\n            c = g = a.conf.dnd = null \r\n        }\r\n        if (window.dhx4.dnd.p_en == true && h.type == window.dhx4.dnd.evs.end) {\r\n            window.dhx4.dnd._touchOn();\r\n            window.removeEventListener(window.dhx4.dnd.evs.end, a._dndOnMouseUp, false);\r\n            window.removeEventListener(window.dhx4.dnd.evs.move, a._dndOnMouseMove, false);\r\n            if (a.conf.dnd_tm != null ) {\r\n                window.clearTimeout(a.conf.dnd_tm)\r\n            }\r\n            a.conf.dnd_tm = null \r\n        }\r\n    }\r\n    ;\r\n    this._dndOnSelectStart = function(c) {\r\n        c = c || event;\r\n        if (c.preventDefault) {\r\n            c.preventDefault()\r\n        } else {\r\n            c.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._dndInitEvents = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.addEventListener(\"mousemove\", this._dndOnMouseMove, false);\r\n            window.addEventListener(\"mouseup\", this._dndOnMouseUp, false);\r\n            window.addEventListener(\"selectstart\", this._dndOnSelectStart, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousemove\", this._dndOnMouseMove);\r\n            document.body.attachEvent(\"onmouseup\", this._dndOnMouseUp);\r\n            document.body.attachEvent(\"onselectstart\", this._dndOnSelectStart)\r\n        }\r\n    }\r\n    ;\r\n    this._dndUnloadEvents = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"mousemove\", this._dndOnMouseMove, false);\r\n            window.removeEventListener(\"mouseup\", this._dndOnMouseUp, false);\r\n            window.removeEventListener(\"selectstart\", this._dndOnSelectStart, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousemove\", this._dndOnMouseMove);\r\n            document.body.detachEvent(\"onmouseup\", this._dndOnMouseUp);\r\n            document.body.detachEvent(\"onselectstart\", this._dndOnSelectStart)\r\n        }\r\n    }\r\n    ;\r\n    this._dndUnloadModule = function() {\r\n        this.detachEvent(this.conf.dnd_evid);\r\n        this.conf.dnd_evid = null ;\r\n        this._dndOnMouseDown = null ;\r\n        this._dndOnMouseMove = null ;\r\n        this._dndOnMouseUp = null ;\r\n        this._dndOnSelectStart = null ;\r\n        this._dndInitEvents = null ;\r\n        this._dndUnloadEvents = null ;\r\n        this._dndInitModule = null ;\r\n        this._dndUnloadModule = null ;\r\n        a = null \r\n    }\r\n    ;\r\n    this._dndPos = function(e, c) {\r\n        var g = e[this.conf.dnd_ev_prefix + c];\r\n        if ((g == null  || g == 0) && e.touches != null ) {\r\n            g = e.touches[0][this.conf.dnd_ev_prefix + c]\r\n        }\r\n        return g\r\n    }\r\n    ;\r\n    this.conf.dnd_evid = this.attachEvent(\"_winMouseDown\", function(g, c) {\r\n        if (this.w[c.id] == null  || this.w[c.id].conf.allow_move != true) {\r\n            return\r\n        }\r\n        if (typeof (g.button) != \"undefined\" && g.button >= 2) {\r\n            return\r\n        }\r\n        if (g.type == window.dhx4.dnd.evs.start) {\r\n            if (c.mode == \"hdr\") {\r\n                if (this.w[c.id].conf.maxed && this.w[c.id].conf.max_w == null  && this.w[c.id].conf.max_h == null ) {\r\n                    return\r\n                }\r\n                this.conf.dnd_ev_prefix = \"page\";\r\n                this.conf.dnd = {\r\n                    x: this._dndPos(g, \"X\"),\r\n                    y: this._dndPos(g, \"Y\")\r\n                };\r\n                if (this.conf.dnd_time < 1) {\r\n                    this._dndOnMouseDown(g, c.id)\r\n                } else {\r\n                    if (this.conf.dnd_tm != null ) {\r\n                        window.clearTimeout(this.conf.dnd_tm)\r\n                    }\r\n                    this.conf.dnd_tm = window.setTimeout(function() {\r\n                        a._dndOnMouseDown(g, c.id)\r\n                    }, this.conf.dnd_time)\r\n                }\r\n                if (window.dhx4.dnd.p_en == true) {\r\n                    window.dhx4.dnd._touchOff();\r\n                    window.addEventListener(window.dhx4.dnd.evs.end, this._dndOnMouseUp, false)\r\n                }\r\n                window.addEventListener(window.dhx4.dnd.evs.move, this._dndOnMouseMove, false)\r\n            }\r\n            return false\r\n        }\r\n        if (g.type == window.dhx4.dnd.evs.end) {\r\n            if (this.conf.dnd_tm != null ) {\r\n                window.clearTimeout(this.conf.dnd_tm);\r\n                this.conf.dnd_tm = null \r\n            }\r\n            this._dndOnMouseUp(g);\r\n            window.removeEventListener(window.dhx4.dnd.evs.move, this._dndOnMouseMove, false);\r\n            return false\r\n        }\r\n        this.conf.dnd_ev_prefix = \"client\";\r\n        if (!(c.mode == \"hdr\" && g.type == \"mousedown\")) {\r\n            return\r\n        }\r\n        if (this.w[c.id].conf.maxed && this.w[c.id].conf.max_w == null  && this.w[c.id].conf.max_h == null ) {\r\n            return\r\n        }\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        this._dndOnMouseDown(g, c.id);\r\n        return false\r\n    })\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype._initResize = function() {\r\n    var a = this;\r\n    var c = navigator.userAgent;\r\n    this.conf.resize = {\r\n        b_width: 6,\r\n        c_type: (c.indexOf(\"MSIE 10.0\") > 0 || c.indexOf(\"MSIE 9.0\") > 0 || c.indexOf(\"MSIE 8.0\") > 0 || c.indexOf(\"MSIE 7.0\") > 0 || c.indexOf(\"MSIE 6.0\") > 0),\r\n        btn_left: ((window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8) && typeof (window.addEventListener) == \"undefined\" ? 1 : 0)\r\n    };\r\n    this._rOnCellMouseMove = function(n) {\r\n        if (a.wins.conf.resize_actv == true || a.wins.w[a._idd].conf.allow_resize == false || a.conf.progress == true || a.wins.w[a._idd].conf.maxed == true || a.wins.w[a._idd].conf.fs_mode == true) {\r\n            var l = a.wins.w[a._idd].brd;\r\n            if (l.style.cursor != \"default\") {\r\n                l.style.cursor = \"default\"\r\n            }\r\n            l = null ;\r\n            return\r\n        }\r\n        n = n || event;\r\n        var w = a.wins.w[a._idd].brd;\r\n        var g = a.conf.resize;\r\n        var s = (a.wins.w[a._idd].conf.header == false);\r\n        var u = n.clientX;\r\n        var o = n.clientY;\r\n        u += (document.documentElement.scrollLeft || document.body.scrollLeft || 0);\r\n        o += (document.documentElement.scrollTop || document.body.scrollTop || 0);\r\n        var h = window.dhx4.absLeft(w);\r\n        var v = window.dhx4.absTop(w);\r\n        var m = \"\";\r\n        if (u <= h + g.b_width) {\r\n            m = \"w\"\r\n        } else {\r\n            if (u >= h + w.offsetWidth - g.b_width) {\r\n                m = \"e\"\r\n            }\r\n        }\r\n        if (o >= v + w.offsetHeight - g.b_width) {\r\n            m = \"s\" + m\r\n        } else {\r\n            if (s && o <= v + g.b_width) {\r\n                m = \"n\" + m\r\n            }\r\n        }\r\n        if (m == \"\") {\r\n            m = false\r\n        }\r\n        if (g.mode != m) {\r\n            g.mode = m;\r\n            if (m == false) {\r\n                w.style.cursor = \"default\"\r\n            } else {\r\n                w.style.cursor = m + \"-resize\"\r\n            }\r\n        }\r\n        w = g = null \r\n    }\r\n    ;\r\n    this._rOnCellMouseDown = function(m) {\r\n        m = m || event;\r\n        if (typeof (m.button) != \"undefined\" && m.button != a.conf.resize.btn_left) {\r\n            return\r\n        }\r\n        if (a.conf.resize.mode == false) {\r\n            return\r\n        }\r\n        if (a.conf.progress == true) {\r\n            return\r\n        }\r\n        if (a.wins.w[a._idd].conf.allow_resize == false) {\r\n            return\r\n        }\r\n        if (a.wins.w[a._idd].conf.fs_mode == true) {\r\n            return\r\n        }\r\n        if (m.preventDefault) {\r\n            m.preventDefault()\r\n        } else {\r\n            m.returnValue = false\r\n        }\r\n        if (a.wins._callMainEvent(\"onBeforeResizeStart\", a._idd) !== true) {\r\n            return\r\n        }\r\n        var g = a.wins.w[a._idd];\r\n        var l = a.conf.resize;\r\n        a.wins.conf.resize_actv = true;\r\n        l.min_w = g.conf.min_w;\r\n        l.min_h = g.conf.min_h;\r\n        l.max_w = g.conf.max_w || +Infinity;\r\n        l.max_h = g.conf.max_h || +Infinity;\r\n        if (g.cell.dataType == \"layout\" && g.cell.dataObj != null  && typeof (g.cell.dataObj._getWindowMinDimension) == \"function\") {\r\n            var h = g.cell.dataObj._getWindowMinDimension(g.cell);\r\n            l.min_w = Math.max(h.w, l.min_w);\r\n            l.min_h = Math.max(h.h, l.min_h)\r\n        }\r\n        l.vp_l = a.wins.conf.vp_pos_ofs;\r\n        l.vp_r = a.wins.vp.clientWidth - a.wins.conf.vp_pos_ofs;\r\n        l.vp_b = a.wins.vp.clientHeight - a.wins.conf.vp_pos_ofs;\r\n        l.x = m.clientX;\r\n        l.y = m.clientY;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.addEventListener(\"mousemove\", a._rOnWinMouseMove, false);\r\n            window.addEventListener(\"mouseup\", a._rOnWinMouseUp, false);\r\n            window.addEventListener(\"selectstart\", a._rOnSelectStart, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousemove\", a._rOnWinMouseMove);\r\n            document.body.attachEvent(\"onmouseup\", a._rOnWinMouseUp);\r\n            document.body.attachEvent(\"onselectstart\", a._rOnSelectStart)\r\n        }\r\n        l.resized = false;\r\n        l.vp_cursor = a.wins.vp.style.cursor;\r\n        a.wins.vp.style.cursor = l.mode + \"-resize\";\r\n        g = l = null \r\n    }\r\n    ;\r\n    this._rOnCellContextMenu = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._rOnWinMouseMove = function(m) {\r\n        m = m || event;\r\n        var h = a.wins.w[a._idd];\r\n        var l = a.conf.resize;\r\n        if (!l.resized) {\r\n            h.fr_cover.className += \" dhxwin_fr_cover_resize\";\r\n            l.resized = true\r\n        }\r\n        var g = m.clientX - l.x;\r\n        var n = m.clientY - l.y;\r\n        if (l.mode.indexOf(\"e\") >= 0) {\r\n            l.rw = Math.min(Math.max(h.conf.w + g, l.min_w), l.max_w);\r\n            l.rx = null ;\r\n            if (h.conf.x + l.rw < l.vp_l) {\r\n                l.rw = l.vp_l - h.conf.x\r\n            } else {\r\n                if (h.conf.x + l.rw > a.wins.vp.clientWidth) {\r\n                    l.rw = a.wins.vp.clientWidth - h.conf.x\r\n                }\r\n            }\r\n        } else {\r\n            if (l.mode.indexOf(\"w\") >= 0) {\r\n                l.rw = Math.min(Math.max(h.conf.w - g, l.min_w), l.max_w);\r\n                l.rx = h.conf.x + h.conf.w - l.rw;\r\n                if (l.rx < 0) {\r\n                    l.rw = l.rw + l.rx;\r\n                    l.rx = 0\r\n                } else {\r\n                    if (l.rx > l.vp_r) {\r\n                        l.rw = l.rw - l.vp_r;\r\n                        l.rx = l.vp_r\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (l.mode.indexOf(\"s\") >= 0) {\r\n            l.rh = Math.min(Math.max(h.conf.h + n, l.min_h), l.max_h);\r\n            l.ry = null ;\r\n            if (h.conf.y + l.rh > a.wins.vp.clientHeight) {\r\n                l.rh = a.wins.vp.clientHeight - h.conf.y\r\n            }\r\n        } else {\r\n            if (l.mode.indexOf(\"n\") >= 0) {\r\n                l.rh = Math.min(Math.max(h.conf.h - n, l.min_h), l.max_h);\r\n                l.ry = h.conf.y + h.conf.h - l.rh;\r\n                if (l.ry < 0) {\r\n                    l.rh = l.rh + l.ry;\r\n                    l.ry = 0\r\n                } else {\r\n                    if (l.ry > l.vp_b) {\r\n                        l.rh = l.rh - l.vp_b;\r\n                        l.ry = l.vp_b\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        a._rAdjustSizer();\r\n        h = l = null \r\n    }\r\n    ;\r\n    this._rOnWinMouseUp = function() {\r\n        var g = a.conf.resize;\r\n        var e = a.wins.w[a._idd];\r\n        a.wins.conf.resize_actv = false;\r\n        a.wins.vp.style.cursor = g.vp_cursor;\r\n        e.fr_cover.className = String(e.fr_cover.className).replace(/\\s{0,}dhxwin_fr_cover_resize/gi, \"\");\r\n        if (g.resized) {\r\n            a.wins._winSetSize(a._idd, g.rw, g.rh);\r\n            if (g.rx == null ) {\r\n                g.rx = e.conf.x\r\n            }\r\n            if (g.ry == null ) {\r\n                g.ry = e.conf.y\r\n            }\r\n            if (g.rx != e.conf.x || g.ry != e.conf.y) {\r\n                a.wins._winSetPosition(a._idd, g.rx, g.ry)\r\n            }\r\n        }\r\n        if (g.obj != null ) {\r\n            g.obj.parentNode.removeChild(g.obj);\r\n            g.obj = null \r\n        }\r\n        if (g.objFR != null ) {\r\n            g.objFR.parentNode.removeChild(g.objFR);\r\n            g.objFR = null \r\n        }\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.removeEventListener(\"mousemove\", a._rOnWinMouseMove, false);\r\n            window.removeEventListener(\"mouseup\", a._rOnWinMouseUp, false);\r\n            window.removeEventListener(\"selectstart\", a._rOnSelectStart, false)\r\n        } else {\r\n            document.body.detachEvent(\"onmousemove\", a._rOnWinMouseMove);\r\n            document.body.detachEvent(\"onmouseup\", a._rOnWinMouseUp);\r\n            document.body.detachEvent(\"onselectstart\", a._rOnSelectStart)\r\n        }\r\n        if (g.resized == true) {\r\n            if (a.dataType == \"layout\" && a.dataObj != null ) {\r\n                a.dataObj.callEvent(\"onResize\", [])\r\n            }\r\n            a.wins._callMainEvent(\"onResizeFinish\", a._idd)\r\n        } else {\r\n            a.wins._callMainEvent(\"onResizeCancel\", a._idd)\r\n        }\r\n        g.mode = \"\";\r\n        e = g = null \r\n    }\r\n    ;\r\n    this._rOnSelectStart = function(g) {\r\n        g = g || event;\r\n        if (g.preventDefault) {\r\n            g.preventDefault()\r\n        } else {\r\n            g.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this._rInitSizer = function() {\r\n        var g = a.conf.resize;\r\n        var e = a.wins.w[a._idd];\r\n        g.obj = document.createElement(\"DIV\");\r\n        g.obj.className = \"dhxwin_resize\";\r\n        g.obj.style.zIndex = e.win.style.zIndex;\r\n        g.obj.style.cursor = g.mode + \"-resize\";\r\n        a.wins.vp.appendChild(g.obj);\r\n        if (a.wins.conf.fr_cover == true) {\r\n            g.objFR = document.createElement(\"IFRAME\");\r\n            g.objFR.className = \"dhxwin_resize_fr_cover\";\r\n            g.objFR.style.zIndex = g.obj.style.zIndex;\r\n            a.wins.vp.insertBefore(g.objFR, g.obj)\r\n        }\r\n        g.rx = e.conf.x;\r\n        g.ry = e.conf.y;\r\n        g.rw = e.conf.w;\r\n        g.rh = e.conf.h;\r\n        g = null \r\n    }\r\n    ;\r\n    this._rAdjustSizer = function() {\r\n        var e = a.conf.resize;\r\n        if (!e.obj) {\r\n            this._rInitSizer()\r\n        }\r\n        e.obj.style.width = e.rw + \"px\";\r\n        e.obj.style.height = e.rh + \"px\";\r\n        if (e.rx != null ) {\r\n            e.obj.style.left = e.rx + \"px\"\r\n        }\r\n        if (e.ry != null ) {\r\n            e.obj.style.top = e.ry + \"px\"\r\n        }\r\n        if (e.objFR != null ) {\r\n            e.objFR.style.width = e.obj.style.width;\r\n            e.objFR.style.height = e.obj.style.height;\r\n            if (e.rx != null ) {\r\n                e.objFR.style.left = e.obj.style.left\r\n            }\r\n            if (e.ry != null ) {\r\n                e.objFR.style.top = e.obj.style.top\r\n            }\r\n        }\r\n        e = null \r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.wins.w[this._idd].brd.addEventListener(\"mousemove\", this._rOnCellMouseMove, false);\r\n        this.wins.w[this._idd].brd.addEventListener(\"mousedown\", this._rOnCellMouseDown, false);\r\n        this.wins.w[this._idd].brd.addEventListener(\"contextmenu\", this._rOnCellContextMenu, false)\r\n    } else {\r\n        this.wins.w[this._idd].brd.attachEvent(\"onmousemove\", this._rOnCellMouseMove);\r\n        this.wins.w[this._idd].brd.attachEvent(\"onmousedown\", this._rOnCellMouseDown);\r\n        this.wins.w[this._idd].brd.attachEvent(\"oncontextmenu\", this._rOnCellContextMenu)\r\n    }\r\n    this._unloadResize = function() {\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.wins.w[this._idd].brd.removeEventListener(\"mousemove\", this._rOnCellMouseMove, false);\r\n            this.wins.w[this._idd].brd.removeEventListener(\"mousedown\", this._rOnCellMouseDown, false);\r\n            this.wins.w[this._idd].brd.removeEventListener(\"contextmenu\", this._rOnCellContextMenu, false)\r\n        } else {\r\n            this.wins.w[this._idd].brd.detachEvent(\"onmousemove\", this._rOnCellMouseMove);\r\n            this.wins.w[this._idd].brd.detachEvent(\"onmousedown\", this._rOnCellMouseDown);\r\n            this.wins.w[this._idd].brd.detachEvent(\"oncontextmenu\", this._rOnCellContextMenu)\r\n        }\r\n        this._initResize = null ;\r\n        this._rOnCellMouseMove = null ;\r\n        this._rOnCellMouseDown = null ;\r\n        this._rOnWinMouseMove = null ;\r\n        this._rOnWinMouseUp = null ;\r\n        this._rOnSelectStart = null ;\r\n        this._rInitSizer = null ;\r\n        this._rAdjustSizer = null ;\r\n        this._unloadResize = null ;\r\n        this.conf.resize = null ;\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXWindows.prototype.attachContextMenu = function(a) {\r\n    return this._renderContextMenu(\"icon\", null , null , a)\r\n}\r\n;\r\ndhtmlXWindows.prototype.getContextMenu = function() {\r\n    if (this.cm != null  && this.cm.global != null ) {\r\n        return this.cm.global\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXWindows.prototype.detachContextMenu = function() {\r\n    this._detachContextMenu(\"icon\", null , null )\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.attachContextMenu = function(a) {\r\n    return this.wins._renderContextMenu(\"icon\", this._idd, null , a)\r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.getContextMenu = function() {\r\n    if (this.wins.cm != null  && this.wins.cm.icon[this._idd] != null ) {\r\n        return this.wins.cm.icon[this._idd]\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXWindowsCell.prototype.detachContextMenu = function() {\r\n    this.wins._detachContextMenu(\"icon\", this._idd, null )\r\n}\r\n;\r\ndhtmlXWindowsButton.prototype.attachContextMenu = function(a) {\r\n    return this.conf.wins._renderContextMenu(\"button\", this.conf.winId, this.conf.name, a)\r\n}\r\n;\r\ndhtmlXWindowsButton.prototype.getContextMenu = function() {\r\n    if (this.conf.wins.cm == null  || this.conf.wins.cm.button[this.conf.winId] == null ) {\r\n        return null \r\n    }\r\n    if (this.conf.wins.cm.button[this.conf.winId][this.conf.name] != null ) {\r\n        return this.conf.wins.cm.button[this.conf.winId][this.conf.name]\r\n    }\r\n    return null \r\n}\r\n;\r\ndhtmlXWindowsButton.prototype.detachContextMenu = function() {\r\n    this.conf.wins._detachContextMenu(\"button\", this.conf.winId, this.conf.name)\r\n}\r\n;\r\ndhtmlXWindows.prototype._renderContextMenu = function(m, l, e, c) {\r\n    var g = this;\r\n    var a = false;\r\n    if (this.cm == null ) {\r\n        this.cm = {\r\n            global: null ,\r\n            icon: {},\r\n            button: {}\r\n        };\r\n        a = true\r\n    }\r\n    if (l == null ) {\r\n        if (this.cm.global != null ) {\r\n            return\r\n        }\r\n    } else {\r\n        if (m == \"icon\") {\r\n            if (this.cm.icon[l] != null ) {\r\n                return\r\n            }\r\n        } else {\r\n            if (m == \"button\") {\r\n                if (this.cm.button[l] != null  && this.cm.button[l][e] != null ) {\r\n                    return\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (c == null ) {\r\n        c = {}\r\n    }\r\n    c.parent = null ;\r\n    c.context = true;\r\n    var h = new dhtmlXMenuObject(c);\r\n    h.setAutoHideMode(false);\r\n    h.attachEvent(\"onShow\", function() {\r\n        this.conf.wins_menu_open = true\r\n    });\r\n    h.attachEvent(\"onHide\", function() {\r\n        this.conf.wins_menu_open = false;\r\n        g.conf.opened_menu = null \r\n    });\r\n    if (l == null ) {\r\n        this.cm.global = h\r\n    } else {\r\n        if (m == \"icon\") {\r\n            this.cm.icon[l] = h\r\n        } else {\r\n            if (m == \"button\") {\r\n                if (this.cm.button[l] == null ) {\r\n                    this.cm.button[l] = {}\r\n                }\r\n                this.cm.button[l][e] = h\r\n            }\r\n        }\r\n    }\r\n    if (a) {\r\n        this._showContextMenu = function(s, r) {\r\n            if (s.button >= 2) {\r\n                return\r\n            }\r\n            if (r.mode == \"icon\" && r.id != null  && r.press_type == \"mousedown\") {\r\n                var u = this.cm.icon[r.id] || this.cm.global;\r\n                if (u == null ) {\r\n                    return\r\n                }\r\n                s.cancelBubble = true;\r\n                var o = this.w[r.id].hdr.firstChild;\r\n                if (u.conf.wins_menu_open && this.conf.opened_menu == r.id) {\r\n                    u.hideContextMenu()\r\n                } else {\r\n                    this._hideContextMenu();\r\n                    u.showContextMenu(window.dhx4.absLeft(o), window.dhx4.absTop(o) + o.offsetHeight);\r\n                    this.conf.opened_menu = r.id\r\n                }\r\n                u = o = null \r\n            }\r\n            if (r.mode == \"button\" && r.id != null  && r.press_type == \"mousedown\") {\r\n                if (this.cm.button[r.id] == null  || this.cm.button[r.id][r.button_name] == null ) {\r\n                    return\r\n                }\r\n                s.cancelBubble = true;\r\n                this.conf.button_last = null ;\r\n                var u = this.cm.button[r.id][r.button_name];\r\n                var n = this.w[r.id].b[r.button_name].button;\r\n                if (u.conf.wins_menu_open && this.conf.opened_menu == r.id) {\r\n                    u.hideContextMenu()\r\n                } else {\r\n                    this._hideContextMenu();\r\n                    u.showContextMenu(window.dhx4.absLeft(n), window.dhx4.absTop(n) + n.offsetHeight);\r\n                    this.conf.opened_menu = r.id\r\n                }\r\n                u = n = null \r\n            }\r\n        }\r\n        ;\r\n        this._hideContextMenu = function(u) {\r\n            if (u != null ) {\r\n                u = u || event;\r\n                if (u.type == \"keydown\" && u.keyCode != 27) {\r\n                    return\r\n                }\r\n                var s = u.target || u.srcElement;\r\n                var o = true;\r\n                while (s != null  && o == true) {\r\n                    if (s.className != null  && s.className.search(/SubLevelArea_Polygon/) >= 0) {\r\n                        o = false\r\n                    } else {\r\n                        s = s.parentNode\r\n                    }\r\n                }\r\n            }\r\n            if (o || u == null ) {\r\n                if (g.cm.global != null ) {\r\n                    g.cm.global.hideContextMenu()\r\n                }\r\n                for (var r in g.cm.icon) {\r\n                    if (g.cm.icon[r] != null ) {\r\n                        g.cm.icon[r].hideContextMenu()\r\n                    }\r\n                }\r\n                for (var r in g.cm.button) {\r\n                    for (var n in g.cm.button[r]) {\r\n                        if (g.cm.button[r][n] != null ) {\r\n                            g.cm.button[r][n].hideContextMenu()\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        this._detachContextMenu = function(r, o, n) {\r\n            if (this.cm == null ) {\r\n                return\r\n            }\r\n            if (o == null ) {\r\n                if (this.cm.global != null ) {\r\n                    this.cm.global.unload();\r\n                    this.cm.global = null \r\n                }\r\n            } else {\r\n                if (r == \"icon\") {\r\n                    if (this.cm.icon[o] != null ) {\r\n                        this.cm.icon[o].unload();\r\n                        this.cm.icon[o] = null \r\n                    }\r\n                } else {\r\n                    if (r == \"button\") {\r\n                        if (this.cm.button[o] != null  && this.cm.button[o][n] != null ) {\r\n                            this.cm.button[o][n].unload();\r\n                            this.cm.button[o][n] = null \r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        this.attachEvent(\"_winMouseDown\", this._showContextMenu);\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            window.addEventListener(\"mousedown\", this._hideContextMenu, false);\r\n            window.addEventListener(\"keydown\", this._hideContextMenu, false)\r\n        } else {\r\n            document.body.attachEvent(\"onmousedown\", this._hideContextMenu);\r\n            document.body.attachEvent(\"onkeydown\", this._hideContextMenu)\r\n        }\r\n        this._unloadContextMenu = function() {\r\n            this._detachContextMenu(\"icon\", null , null );\r\n            this.cm = null ;\r\n            if (typeof (window.addEventListener) == \"function\") {\r\n                window.removeEventListener(\"mousedown\", this._hideContextMenu, false);\r\n                window.removeEventListener(\"keydown\", this._hideContextMenu, false)\r\n            } else {\r\n                document.body.detachEvent(\"onmousedown\", this._hideContextMenu);\r\n                document.body.detachEvent(\"onkeydown\", this._hideContextMenu)\r\n            }\r\n            g = null \r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\nif (!window.dhtmlx) {\r\n    window.dhtmlx = {}\r\n}\r\n(function() {\r\n    var r = null ;\r\n    function u(A, x) {\r\n        var y = A.callback;\r\n        s(false);\r\n        A.box.parentNode.removeChild(A.box);\r\n        r = A.box = null ;\r\n        if (y) {\r\n            y(x)\r\n        }\r\n    }\r\n    function a(y) {\r\n        if (r) {\r\n            y = y || event;\r\n            var x = y.which || event.keyCode;\r\n            if (dhtmlx.message.keyboard) {\r\n                if (x == 13 || x == 32) {\r\n                    u(r, true)\r\n                }\r\n                if (x == 27) {\r\n                    u(r, false)\r\n                }\r\n            }\r\n            if (y.preventDefault) {\r\n                y.preventDefault()\r\n            }\r\n            return !(y.cancelBubble = true)\r\n        }\r\n    }\r\n    if (document.attachEvent) {\r\n        document.attachEvent(\"onkeydown\", a)\r\n    } else {\r\n        document.addEventListener(\"keydown\", a, true)\r\n    }\r\n    function s(y) {\r\n        if (!s.cover) {\r\n            s.cover = document.createElement(\"DIV\");\r\n            s.cover.onkeydown = a;\r\n            s.cover.className = \"dhx_modal_cover\";\r\n            document.body.appendChild(s.cover)\r\n        }\r\n        var x = document.body.scrollHeight;\r\n        s.cover.style.display = y ? \"inline-block\" : \"none\"\r\n    }\r\n    function l(y, x) {\r\n        return \"<div class='dhtmlx_popup_button' result='\" + x + \"' ><div>\" + y + \"</div></div>\"\r\n    }\r\n    function e(y) {\r\n        if (!v.area) {\r\n            v.area = document.createElement(\"DIV\");\r\n            v.area.className = \"dhtmlx_message_area\";\r\n            v.area.style[v.position] = \"5px\";\r\n            document.body.appendChild(v.area)\r\n        }\r\n        v.hide(y.id);\r\n        var x = document.createElement(\"DIV\");\r\n        x.innerHTML = \"<div>\" + y.text + \"</div>\";\r\n        x.className = \"dhtmlx-info dhtmlx-\" + y.type;\r\n        x.onclick = function() {\r\n            if (y) {\r\n                v.hide(y.id)\r\n            }\r\n            y = null \r\n        }\r\n        ;\r\n        if (v.position == \"bottom\" && v.area.firstChild) {\r\n            v.area.insertBefore(x, v.area.firstChild)\r\n        } else {\r\n            v.area.appendChild(x)\r\n        }\r\n        if (y.expire > 0) {\r\n            v.timers[y.id] = window.setTimeout(function() {\r\n                v.hide(y.id)\r\n            }, y.expire)\r\n        }\r\n        v.pull[y.id] = x;\r\n        x = null ;\r\n        return y.id\r\n    }\r\n    function m(y, C, F) {\r\n        var E = document.createElement(\"DIV\");\r\n        E.className = \" dhtmlx_modal_box dhtmlx-\" + y.type;\r\n        E.setAttribute(\"dhxbox\", 1);\r\n        var x = \"\";\r\n        if (y.width) {\r\n            E.style.width = y.width\r\n        }\r\n        if (y.height) {\r\n            E.style.height = y.height\r\n        }\r\n        if (y.title) {\r\n            x += '<div class=\"dhtmlx_popup_title\">' + y.title + \"</div>\"\r\n        }\r\n        x += '<div class=\"dhtmlx_popup_text\"><span>' + (y.content ? \"\" : y.text) + '</span></div><div  class=\"dhtmlx_popup_controls\">';\r\n        if (C) {\r\n            x += l(y.ok || \"OK\", true)\r\n        }\r\n        if (F) {\r\n            x += l(y.cancel || \"Cancel\", false)\r\n        }\r\n        if (y.buttons) {\r\n            for (var A = 0; A < y.buttons.length; A++) {\r\n                x += l(y.buttons[A], A)\r\n            }\r\n        }\r\n        x += \"</div>\";\r\n        E.innerHTML = x;\r\n        if (y.content) {\r\n            var D = y.content;\r\n            if (typeof D == \"string\") {\r\n                D = document.getElementById(D)\r\n            }\r\n            if (D.style.display == \"none\") {\r\n                D.style.display = \"\"\r\n            }\r\n            E.childNodes[y.title ? 1 : 0].appendChild(D)\r\n        }\r\n        E.onclick = function(J) {\r\n            J = J || event;\r\n            var I = J.target || J.srcElement;\r\n            if (!I.className) {\r\n                I = I.parentNode\r\n            }\r\n            if (I.className == \"dhtmlx_popup_button\") {\r\n                var H = I.getAttribute(\"result\");\r\n                H = (H == \"true\") || (H == \"false\" ? false : H);\r\n                u(y, H)\r\n            }\r\n        }\r\n        ;\r\n        y.box = E;\r\n        if (C || F) {\r\n            r = y\r\n        }\r\n        return E\r\n    }\r\n    function w(C, D, F) {\r\n        var E = C.tagName ? C : m(C, D, F);\r\n        if (!C.hidden) {\r\n            s(true)\r\n        }\r\n        document.body.appendChild(E);\r\n        var A = C.left || Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - E.offsetWidth) / 2));\r\n        var H = C.top || Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - E.offsetHeight) / 2));\r\n        if (C.position == \"top\") {\r\n            E.style.top = \"-3px\"\r\n        } else {\r\n            E.style.top = H + \"px\"\r\n        }\r\n        E.style.left = A + \"px\";\r\n        E.onkeydown = a;\r\n        E.focus();\r\n        if (C.hidden) {\r\n            dhtmlx.modalbox.hide(E)\r\n        }\r\n        return E\r\n    }\r\n    function o(x) {\r\n        return w(x, true, false)\r\n    }\r\n    function c(x) {\r\n        return w(x, true, true)\r\n    }\r\n    function h(x) {\r\n        return w(x)\r\n    }\r\n    function n(y, x, A) {\r\n        if (typeof y != \"object\") {\r\n            if (typeof x == \"function\") {\r\n                A = x;\r\n                x = \"\"\r\n            }\r\n            y = {\r\n                text: y,\r\n                type: x,\r\n                callback: A\r\n            }\r\n        }\r\n        return y\r\n    }\r\n    function g(A, y, x, C) {\r\n        if (typeof A != \"object\" || !A) {\r\n            A = {\r\n                text: A,\r\n                type: y,\r\n                expire: x,\r\n                id: C\r\n            }\r\n        }\r\n        A.id = A.id || v.uid();\r\n        A.expire = A.expire || v.expire;\r\n        return A\r\n    }\r\n    dhtmlx.alert = function() {\r\n        var x = n.apply(this, arguments);\r\n        x.type = x.type || \"confirm\";\r\n        return o(x)\r\n    }\r\n    ;\r\n    dhtmlx.confirm = function() {\r\n        var x = n.apply(this, arguments);\r\n        x.type = x.type || \"alert\";\r\n        return c(x)\r\n    }\r\n    ;\r\n    dhtmlx.modalbox = function() {\r\n        var x = n.apply(this, arguments);\r\n        x.type = x.type || \"alert\";\r\n        return h(x)\r\n    }\r\n    ;\r\n    dhtmlx.modalbox.hide = function(x) {\r\n        while (x && x.getAttribute && !x.getAttribute(\"dhxbox\")) {\r\n            x = x.parentNode\r\n        }\r\n        if (x) {\r\n            x.parentNode.removeChild(x);\r\n            s(false);\r\n            r = null \r\n        }\r\n    }\r\n    ;\r\n    var v = dhtmlx.message = function(C, A, y, D) {\r\n        C = g.apply(this, arguments);\r\n        C.type = C.type || \"info\";\r\n        var x = C.type.split(\"-\")[0];\r\n        switch (x) {\r\n        case \"alert\":\r\n            return o(C);\r\n        case \"confirm\":\r\n            return c(C);\r\n        case \"modalbox\":\r\n            return h(C);\r\n        default:\r\n            return e(C);\r\n            break\r\n        }\r\n    }\r\n    ;\r\n    v.seed = (new Date()).valueOf();\r\n    v.uid = function() {\r\n        return v.seed++\r\n    }\r\n    ;\r\n    v.expire = 4000;\r\n    v.keyboard = true;\r\n    v.position = \"top\";\r\n    v.pull = {};\r\n    v.timers = {};\r\n    v.hideAll = function() {\r\n        for (var x in v.pull) {\r\n            v.hide(x)\r\n        }\r\n    }\r\n    ;\r\n    v.hide = function(y) {\r\n        var x = v.pull[y];\r\n        if (x && x.parentNode) {\r\n            window.setTimeout(function() {\r\n                x.parentNode.removeChild(x);\r\n                x = null \r\n            }, 2000);\r\n            x.className += \" hidden\";\r\n            if (v.timers[y]) {\r\n                window.clearTimeout(v.timers[y])\r\n            }\r\n            delete v.pull[y]\r\n        }\r\n    }\r\n})();\r\nif (!window.dhx) {\r\n    dhx = {}\r\n}\r\ndhx.assert = function(c, a) {\r\n    if (!c) {\r\n        dhx.assert_error(a)\r\n    }\r\n}\r\n;\r\ndhx.assert_error = function(message) {\r\n    dhx.log(\"error\", message);\r\n    if (dhx.message && typeof message == \"string\") {\r\n        dhx.message({\r\n            type: \"debug\",\r\n            text: message,\r\n            expire: -1\r\n        })\r\n    }\r\n    if (dhx.debug !== false) {\r\n        eval(\"debugger;\")\r\n    }\r\n}\r\n;\r\ndhx.assert_core_ready = function() {\r\n    if (window.dhx_on_core_ready) {\r\n        dhx_on_core_ready()\r\n    }\r\n}\r\n;\r\ndhx.codebase = \"./\";\r\ndhx.name = \"Core\";\r\ndhx.clone = function(c) {\r\n    var a = dhx.clone._function;\r\n    a.prototype = c;\r\n    return new a()\r\n}\r\n;\r\ndhx.clone._function = function() {}\r\n;\r\ndhx.extend = function(e, c, a) {\r\n    dhx.assert(e, \"Invalid mixing target\");\r\n    dhx.assert(c, \"Invalid mixing source\");\r\n    if (e._dhx_proto_wait) {\r\n        dhx.PowerArray.insertAt.call(e._dhx_proto_wait, c, 1);\r\n        return e\r\n    }\r\n    for (var g in c) {\r\n        if (!e[g] || a) {\r\n            e[g] = c[g]\r\n        }\r\n    }\r\n    if (c.defaults) {\r\n        dhx.extend(e.defaults, c.defaults)\r\n    }\r\n    if (c.$init) {\r\n        c.$init.call(e)\r\n    }\r\n    return e\r\n}\r\n;\r\ndhx.copy = function(a) {\r\n    dhx.assert(a, \"Invalid mixing target\");\r\n    if (arguments.length > 1) {\r\n        var c = arguments[0];\r\n        a = arguments[1]\r\n    } else {\r\n        var c = (dhx.isArray(a) ? [] : {})\r\n    }\r\n    for (var e in a) {\r\n        if (a[e] && typeof a[e] == \"object\" && !dhx.isDate(a[e])) {\r\n            c[e] = (dhx.isArray(a[e]) ? [] : {});\r\n            dhx.copy(c[e], a[e])\r\n        } else {\r\n            c[e] = a[e]\r\n        }\r\n    }\r\n    return c\r\n}\r\n;\r\ndhx.single = function(e) {\r\n    var a = null ;\r\n    var c = function(g) {\r\n        if (!a) {\r\n            a = new e({})\r\n        }\r\n        if (a._reinit) {\r\n            a._reinit.apply(a, arguments)\r\n        }\r\n        return a\r\n    }\r\n    ;\r\n    return c\r\n}\r\n;\r\ndhx.protoUI = function() {\r\n    if (dhx.debug_proto) {\r\n        dhx.log(\"UI registered: \" + arguments[0].name)\r\n    }\r\n    var e = arguments;\r\n    var a = e[0].name;\r\n    var c = function(h) {\r\n        if (!c) {\r\n            return dhx.ui[a].prototype\r\n        }\r\n        var m = c._dhx_proto_wait;\r\n        if (m) {\r\n            var l = [m[0]];\r\n            for (var g = 1; g < m.length; g++) {\r\n                l[g] = m[g];\r\n                if (l[g]._dhx_proto_wait) {\r\n                    l[g] = l[g].call(dhx, l[g].name)\r\n                }\r\n                if (l[g].prototype && l[g].prototype.name) {\r\n                    dhx.ui[l[g].prototype.name] = l[g]\r\n                }\r\n            }\r\n            dhx.ui[a] = dhx.proto.apply(dhx, l);\r\n            if (c._dhx_type_wait) {\r\n                for (var g = 0; g < c._dhx_type_wait.length; g++) {\r\n                    dhx.Type(dhx.ui[a], c._dhx_type_wait[g])\r\n                }\r\n            }\r\n            c = m = null \r\n        }\r\n        if (this != dhx) {\r\n            return new dhx.ui[a](h)\r\n        } else {\r\n            return dhx.ui[a]\r\n        }\r\n    }\r\n    ;\r\n    c._dhx_proto_wait = Array.prototype.slice.call(arguments, 0);\r\n    return dhx.ui[a] = c\r\n}\r\n;\r\ndhx.proto = function() {\r\n    if (dhx.debug_proto) {\r\n        dhx.log(\"Proto chain:\" + arguments[0].name + \"[\" + arguments.length + \"]\")\r\n    }\r\n    var l = arguments;\r\n    var h = l[0];\r\n    var c = !!h.$init;\r\n    var n = [];\r\n    dhx.assert(h, \"Invalid mixing target\");\r\n    for (var g = l.length - 1; g > 0; g--) {\r\n        dhx.assert(l[g], \"Invalid mixing source\");\r\n        if (typeof l[g] == \"function\") {\r\n            l[g] = l[g].prototype\r\n        }\r\n        if (l[g].$init) {\r\n            n.push(l[g].$init)\r\n        }\r\n        if (l[g].defaults) {\r\n            var e = l[g].defaults;\r\n            if (!h.defaults) {\r\n                h.defaults = {}\r\n            }\r\n            for (var a in e) {\r\n                if (dhx.isUndefined(h.defaults[a])) {\r\n                    h.defaults[a] = e[a]\r\n                }\r\n            }\r\n        }\r\n        if (l[g].type && h.type) {\r\n            for (var a in l[g].type) {\r\n                if (!h.type[a]) {\r\n                    h.type[a] = l[g].type[a]\r\n                }\r\n            }\r\n        }\r\n        for (var m in l[g]) {\r\n            if (!h[m]) {\r\n                h[m] = l[g][m]\r\n            }\r\n        }\r\n    }\r\n    if (c) {\r\n        n.push(h.$init)\r\n    }\r\n    h.$init = function() {\r\n        for (var r = 0; r < n.length; r++) {\r\n            n[r].apply(this, arguments)\r\n        }\r\n    }\r\n    ;\r\n    var o = function(r) {\r\n        this.$ready = [];\r\n        dhx.assert(this.$init, \"object without init method\");\r\n        this.$init(r);\r\n        if (this._parseSettings) {\r\n            this._parseSettings(r, this.defaults)\r\n        }\r\n        for (var s = 0; s < this.$ready.length; s++) {\r\n            this.$ready[s].call(this)\r\n        }\r\n    }\r\n    ;\r\n    o.prototype = h;\r\n    h = l = null ;\r\n    return o\r\n}\r\n;\r\ndhx.bind = function(c, a) {\r\n    return function() {\r\n        return c.apply(a, arguments)\r\n    }\r\n}\r\n;\r\ndhx.require = function(c, n, m) {\r\n    if (typeof c != \"string\") {\r\n        var l = c.length || 0;\r\n        var h = n;\r\n        if (!l) {\r\n            for (var a in c) {\r\n                l++\r\n            }\r\n            n = function() {\r\n                l--;\r\n                if (l === 0) {\r\n                    h.apply(this, arguments)\r\n                }\r\n            }\r\n            ;\r\n            for (var a in c) {\r\n                dhx.require(a, n, m)\r\n            }\r\n        } else {\r\n            n = function() {\r\n                if (l) {\r\n                    l--;\r\n                    dhx.require(c[c.length - l - 1], n, m)\r\n                } else {\r\n                    return h.apply(this, arguments)\r\n                }\r\n            }\r\n            ;\r\n            n()\r\n        }\r\n        return\r\n    }\r\n    if (dhx._modules[c] !== true) {\r\n        if (c.substr(-4) == \".css\") {\r\n            var g = dhx.html.create(\"LINK\", {\r\n                type: \"text/css\",\r\n                rel: \"stylesheet\",\r\n                href: dhx.codebase + c\r\n            });\r\n            document.head.appendChild(g);\r\n            if (n) {\r\n                n.call(m || window)\r\n            }\r\n            return\r\n        }\r\n        var e = arguments[4];\r\n        if (!n) {\r\n            dhx.exec(dhx.ajax().sync().get(dhx.codebase + c).responseText);\r\n            dhx._modules[c] = true\r\n        } else {\r\n            if (!dhx._modules[c]) {\r\n                dhx._modules[c] = [[n, m]];\r\n                dhx.ajax(dhx.codebase + c, function(s) {\r\n                    dhx.exec(s);\r\n                    var r = dhx._modules[c];\r\n                    dhx._modules[c] = true;\r\n                    for (var o = 0; o < r.length; o++) {\r\n                        r[o][0].call(r[o][1] || window, !o)\r\n                    }\r\n                })\r\n            } else {\r\n                dhx._modules[c].push([n, m])\r\n            }\r\n        }\r\n    }\r\n}\r\n;\r\ndhx._modules = {};\r\ndhx.exec = function(code) {\r\n    if (window.execScript) {\r\n        window.execScript(code)\r\n    } else {\r\n        window.eval(code)\r\n    }\r\n}\r\n;\r\ndhx.wrap = function(c, a) {\r\n    if (!c) {\r\n        return a\r\n    }\r\n    return function() {\r\n        var e = c.apply(this, arguments);\r\n        a.apply(this, arguments);\r\n        return e\r\n    }\r\n}\r\n;\r\ndhx.isUndefined = function(c) {\r\n    return typeof c == \"undefined\"\r\n}\r\n;\r\ndhx.delay = function(g, c, e, a) {\r\n    return window.setTimeout(function() {\r\n        var h = g.apply(c, (e || []));\r\n        g = c = e = null ;\r\n        return h\r\n    }, a || 1)\r\n}\r\n;\r\ndhx.uid = function() {\r\n    if (!this._seed) {\r\n        this._seed = (new Date).valueOf()\r\n    }\r\n    this._seed++;\r\n    return this._seed\r\n}\r\n;\r\ndhx.toNode = function(a) {\r\n    if (typeof a == \"string\") {\r\n        return document.getElementById(a)\r\n    }\r\n    return a\r\n}\r\n;\r\ndhx.toArray = function(a) {\r\n    return dhx.extend((a || []), dhx.PowerArray, true)\r\n}\r\n;\r\ndhx.toFunctor = function(str) {\r\n    return (typeof (str) == \"string\") ? eval(str) : str\r\n}\r\n;\r\ndhx.isArray = function(a) {\r\n    return Array.isArray ? Array.isArray(a) : (Object.prototype.toString.call(a) === \"[object Array]\")\r\n}\r\n;\r\ndhx.isDate = function(a) {\r\n    return a instanceof Date\r\n}\r\n;\r\ndhx._events = {};\r\ndhx.event = function(g, e, a, c) {\r\n    g = dhx.toNode(g);\r\n    var h = dhx.uid();\r\n    if (c) {\r\n        a = dhx.bind(a, c)\r\n    }\r\n    dhx._events[h] = [g, e, a];\r\n    if (g.addEventListener) {\r\n        g.addEventListener(e, a, false)\r\n    } else {\r\n        if (g.attachEvent) {\r\n            g.attachEvent(\"on\" + e, a)\r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhx.eventRemove = function(c) {\r\n    if (!c) {\r\n        return\r\n    }\r\n    dhx.assert(this._events[c], \"Removing non-existing event\");\r\n    var a = dhx._events[c];\r\n    if (a[0].removeEventListener) {\r\n        a[0].removeEventListener(a[1], a[2], false)\r\n    } else {\r\n        if (a[0].detachEvent) {\r\n            a[0].detachEvent(\"on\" + a[1], a[2])\r\n        }\r\n    }\r\n    delete this._events[c]\r\n}\r\n;\r\ndhx.log = function(c, e, a) {\r\n    if (arguments.length == 1) {\r\n        e = c;\r\n        c = \"log\"\r\n    }\r\n    if (window.console && console.log) {\r\n        c = c.toLowerCase();\r\n        if (window.console[c]) {\r\n            window.console[c](e || \"unknown error\")\r\n        } else {\r\n            window.console.log(c + \": \" + e)\r\n        }\r\n        if (a) {\r\n            window.console.log(a)\r\n        }\r\n    }\r\n}\r\n;\r\ndhx.log_full_time = function(a) {\r\n    dhx._start_time_log = new Date();\r\n    dhx.log(\"Timing start [\" + a + \"]\");\r\n    window.setTimeout(function() {\r\n        var c = new Date();\r\n        dhx.log(\"Timing end [\" + a + \"]:\" + (c.valueOf() - dhx._start_time_log.valueOf()) / 1000 + \"s\")\r\n    }, 1)\r\n}\r\n;\r\ndhx.log_time = function(a) {\r\n    var e = \"_start_time_log\" + a;\r\n    if (!dhx[e]) {\r\n        dhx[e] = new Date();\r\n        dhx.log(\"Info\", \"Timing start [\" + a + \"]\")\r\n    } else {\r\n        var c = new Date();\r\n        dhx.log(\"Info\", \"Timing end [\" + a + \"]:\" + (c.valueOf() - dhx[e].valueOf()) / 1000 + \"s\");\r\n        dhx[e] = null \r\n    }\r\n}\r\n;\r\ndhx.debug_code = function(a) {\r\n    a.call(dhx)\r\n}\r\n;\r\ndhx.EventSystem = {\r\n    $init: function() {\r\n        if (!this._evs_events) {\r\n            this._evs_events = {};\r\n            this._evs_handlers = {};\r\n            this._evs_map = {}\r\n        }\r\n    },\r\n    blockEvent: function() {\r\n        this._evs_events._block = true\r\n    },\r\n    unblockEvent: function() {\r\n        this._evs_events._block = false\r\n    },\r\n    mapEvent: function(a) {\r\n        dhx.extend(this._evs_map, a, true)\r\n    },\r\n    on_setter: function(a) {\r\n        if (a) {\r\n            for (var c in a) {\r\n                if (typeof a[c] == \"function\") {\r\n                    this.attachEvent(c, a[c])\r\n                }\r\n            }\r\n        }\r\n    },\r\n    callEvent: function(e, h) {\r\n        if (this._evs_events._block) {\r\n            return true\r\n        }\r\n        e = e.toLowerCase();\r\n        var g = this._evs_events[e.toLowerCase()];\r\n        var a = true;\r\n        if (dhx.debug) {\r\n            dhx.log(\"info\", \"[\" + this.name + \"] event:\" + e, h)\r\n        }\r\n        if (g) {\r\n            for (var c = 0; c < g.length; c++) {\r\n                if (g[c].apply(this, (h || [])) === false) {\r\n                    a = false\r\n                }\r\n            }\r\n        }\r\n        if (this._evs_map[e] && !this._evs_map[e].callEvent(e, h)) {\r\n            a = false\r\n        }\r\n        return a\r\n    },\r\n    attachEvent: function(c, a, g) {\r\n        dhx.assert(a, \"Invalid event handler for \" + c);\r\n        c = c.toLowerCase();\r\n        g = g || dhx.uid();\r\n        a = dhx.toFunctor(a);\r\n        var e = this._evs_events[c] || dhx.toArray();\r\n        e.push(a);\r\n        this._evs_events[c] = e;\r\n        this._evs_handlers[g] = {\r\n            f: a,\r\n            t: c\r\n        };\r\n        return g\r\n    },\r\n    detachEvent: function(g) {\r\n        if (!this._evs_handlers[g]) {\r\n            return\r\n        }\r\n        var c = this._evs_handlers[g].t;\r\n        var a = this._evs_handlers[g].f;\r\n        var e = this._evs_events[c];\r\n        e.remove(a);\r\n        delete this._evs_handlers[g]\r\n    },\r\n    hasEvent: function(a) {\r\n        a = a.toLowerCase();\r\n        return this._evs_events[a] ? true : false\r\n    }\r\n};\r\ndhx.extend(dhx, dhx.EventSystem);\r\ndhx.PowerArray = {\r\n    removeAt: function(c, a) {\r\n        if (c >= 0) {\r\n            this.splice(c, (a || 1))\r\n        }\r\n    },\r\n    remove: function(a) {\r\n        this.removeAt(this.find(a))\r\n    },\r\n    insertAt: function(c, e) {\r\n        if (!e && e !== 0) {\r\n            this.push(c)\r\n        } else {\r\n            var a = this.splice(e, (this.length - e));\r\n            this[e] = c;\r\n            this.push.apply(this, a)\r\n        }\r\n    },\r\n    find: function(c) {\r\n        for (var a = 0; a < this.length; a++) {\r\n            if (c == this[a]) {\r\n                return a\r\n            }\r\n        }\r\n        return -1\r\n    },\r\n    each: function(a, e) {\r\n        for (var c = 0; c < this.length; c++) {\r\n            a.call((e || this), this[c])\r\n        }\r\n    },\r\n    map: function(a, e) {\r\n        for (var c = 0; c < this.length; c++) {\r\n            this[c] = a.call((e || this), this[c])\r\n        }\r\n        return this\r\n    },\r\n    filter: function(a, e) {\r\n        for (var c = 0; c < this.length; c++) {\r\n            if (!a.call((e || this), this[c])) {\r\n                this.splice(c, 1);\r\n                c--\r\n            }\r\n        }\r\n        return this\r\n    }\r\n};\r\ndhx.env = {};\r\n(function() {\r\n    if (navigator.userAgent.indexOf(\"Mobile\") != -1) {\r\n        dhx.env.mobile = true\r\n    }\r\n    if (dhx.env.mobile || navigator.userAgent.indexOf(\"iPad\") != -1 || navigator.userAgent.indexOf(\"Android\") != -1) {\r\n        dhx.env.touch = true\r\n    }\r\n    if (navigator.userAgent.indexOf(\"Opera\") != -1) {\r\n        dhx.env.isOpera = true\r\n    } else {\r\n        dhx.env.isIE = !!document.all;\r\n        dhx.env.isFF = !document.all;\r\n        dhx.env.isWebKit = (navigator.userAgent.indexOf(\"KHTML\") != -1);\r\n        dhx.env.isSafari = dhx.env.isWebKit && (navigator.userAgent.indexOf(\"Mac\") != -1)\r\n    }\r\n    if (navigator.userAgent.toLowerCase().indexOf(\"android\") != -1) {\r\n        dhx.env.isAndroid = true\r\n    }\r\n    dhx.env.transform = false;\r\n    dhx.env.transition = false;\r\n    var e = {};\r\n    e.names = [\"transform\", \"transition\"];\r\n    e.transform = [\"transform\", \"WebkitTransform\", \"MozTransform\", \"OTransform\", \"msTransform\"];\r\n    e.transition = [\"transition\", \"WebkitTransition\", \"MozTransition\", \"OTransition\", \"msTransition\"];\r\n    var m = document.createElement(\"DIV\");\r\n    for (var h = 0; h < e.names.length; h++) {\r\n        var g = e[e.names[h]];\r\n        for (var c = 0; c < g.length; c++) {\r\n            if (typeof m.style[g[c]] != \"undefined\") {\r\n                dhx.env[e.names[h]] = g[c];\r\n                break\r\n            }\r\n        }\r\n    }\r\n    m.style[dhx.env.transform] = \"translate3d(0,0,0)\";\r\n    dhx.env.translate = (m.style[dhx.env.transform]) ? \"translate3d\" : \"translate\";\r\n    var l = \"\";\r\n    var a = false;\r\n    if (dhx.env.isOpera) {\r\n        l = \"-o-\";\r\n        a = \"O\"\r\n    }\r\n    if (dhx.env.isFF) {\r\n        l = \"-Moz-\"\r\n    }\r\n    if (dhx.env.isWebKit) {\r\n        l = \"-webkit-\"\r\n    }\r\n    if (dhx.env.isIE) {\r\n        l = \"-ms-\"\r\n    }\r\n    dhx.env.transformCSSPrefix = l;\r\n    dhx.env.transformPrefix = a || (dhx.env.transformCSSPrefix.replace(/-/gi, \"\"));\r\n    dhx.env.transitionEnd = ((dhx.env.transformCSSPrefix == \"-Moz-\") ? \"transitionend\" : (dhx.env.transformPrefix + \"TransitionEnd\"))\r\n})();\r\ndhx.env.svg = (function() {\r\n    return document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\")\r\n})();\r\ndhx.html = {\r\n    _native_on_selectstart: 0,\r\n    denySelect: function() {\r\n        if (!dhx._native_on_selectstart) {\r\n            dhx._native_on_selectstart = document.onselectstart\r\n        }\r\n        document.onselectstart = dhx.html.stopEvent\r\n    },\r\n    allowSelect: function() {\r\n        if (dhx._native_on_selectstart !== 0) {\r\n            document.onselectstart = dhx._native_on_selectstart || null \r\n        }\r\n        dhx._native_on_selectstart = 0\r\n    },\r\n    index: function(c) {\r\n        var a = 0;\r\n        while (c = c.previousSibling) {\r\n            a++\r\n        }\r\n        return a\r\n    },\r\n    _style_cache: {},\r\n    createCss: function(e) {\r\n        var g = \"\";\r\n        for (var c in e) {\r\n            g += c + \":\" + e[c] + \";\"\r\n        }\r\n        var a = this._style_cache[g];\r\n        if (!a) {\r\n            a = \"s\" + dhx.uid();\r\n            this.addStyle(\".\" + a + \"{\" + g + \"}\");\r\n            this._style_cache[g] = a\r\n        }\r\n        return a\r\n    },\r\n    addStyle: function(c) {\r\n        var a = document.createElement(\"style\");\r\n        a.setAttribute(\"type\", \"text/css\");\r\n        a.setAttribute(\"media\", \"screen\");\r\n        if (a.styleSheet) {\r\n            a.styleSheet.cssText = c\r\n        } else {\r\n            a.appendChild(document.createTextNode(c))\r\n        }\r\n        document.getElementsByTagName(\"head\")[0].appendChild(a)\r\n    },\r\n    create: function(c, a, e) {\r\n        a = a || {};\r\n        var g = document.createElement(c);\r\n        for (var h in a) {\r\n            g.setAttribute(h, a[h])\r\n        }\r\n        if (a.style) {\r\n            g.style.cssText = a.style\r\n        }\r\n        if (a[\"class\"]) {\r\n            g.className = a[\"class\"]\r\n        }\r\n        if (e) {\r\n            g.innerHTML = e\r\n        }\r\n        return g\r\n    },\r\n    getValue: function(a) {\r\n        a = dhx.toNode(a);\r\n        if (!a) {\r\n            return \"\"\r\n        }\r\n        return dhx.isUndefined(a.value) ? a.innerHTML : a.value\r\n    },\r\n    remove: function(c) {\r\n        if (c instanceof Array) {\r\n            for (var a = 0; a < c.length; a++) {\r\n                this.remove(c[a])\r\n            }\r\n        } else {\r\n            if (c && c.parentNode) {\r\n                c.parentNode.removeChild(c)\r\n            }\r\n        }\r\n    },\r\n    insertBefore: function(c, e, a) {\r\n        if (!c) {\r\n            return\r\n        }\r\n        if (e && e.parentNode) {\r\n            e.parentNode.insertBefore(c, e)\r\n        } else {\r\n            a.appendChild(c)\r\n        }\r\n    },\r\n    locate: function(c, h) {\r\n        if (c.tagName) {\r\n            var a = c\r\n        } else {\r\n            c = c || event;\r\n            var a = c.target || c.srcElement\r\n        }\r\n        while (a) {\r\n            if (a.getAttribute) {\r\n                var g = a.getAttribute(h);\r\n                if (g) {\r\n                    return g\r\n                }\r\n            }\r\n            a = a.parentNode\r\n        }\r\n        return null \r\n    },\r\n    offset: function(g) {\r\n        if (g.getBoundingClientRect) {\r\n            var m = g.getBoundingClientRect();\r\n            var n = document.body;\r\n            var c = document.documentElement;\r\n            var a = window.pageYOffset || c.scrollTop || n.scrollTop;\r\n            var h = window.pageXOffset || c.scrollLeft || n.scrollLeft;\r\n            var l = c.clientTop || n.clientTop || 0;\r\n            var o = c.clientLeft || n.clientLeft || 0;\r\n            var r = m.top + a - l;\r\n            var e = m.left + h - o;\r\n            return {\r\n                y: Math.round(r),\r\n                x: Math.round(e)\r\n            }\r\n        } else {\r\n            var r = 0\r\n              , e = 0;\r\n            while (g) {\r\n                r = r + parseInt(g.offsetTop, 10);\r\n                e = e + parseInt(g.offsetLeft, 10);\r\n                g = g.offsetParent\r\n            }\r\n            return {\r\n                y: r,\r\n                x: e\r\n            }\r\n        }\r\n    },\r\n    posRelative: function(a) {\r\n        a = a || event;\r\n        if (!dhx.isUndefined(a.offsetX)) {\r\n            return {\r\n                x: a.offsetX,\r\n                y: a.offsetY\r\n            }\r\n        } else {\r\n            return {\r\n                x: a.layerX,\r\n                y: a.layerY\r\n            }\r\n        }\r\n    },\r\n    pos: function(a) {\r\n        a = a || event;\r\n        if (a.pageX || a.pageY) {\r\n            return {\r\n                x: a.pageX,\r\n                y: a.pageY\r\n            }\r\n        }\r\n        var c = ((dhx.env.isIE) && (document.compatMode != \"BackCompat\")) ? document.documentElement : document.body;\r\n        return {\r\n            x: a.clientX + c.scrollLeft - c.clientLeft,\r\n            y: a.clientY + c.scrollTop - c.clientTop\r\n        }\r\n    },\r\n    preventEvent: function(a) {\r\n        if (a && a.preventDefault) {\r\n            a.preventDefault()\r\n        }\r\n        return dhx.html.stopEvent(a)\r\n    },\r\n    stopEvent: function(a) {\r\n        (a || event).cancelBubble = true;\r\n        return false\r\n    },\r\n    addCss: function(c, a) {\r\n        c.className += \" \" + a\r\n    },\r\n    removeCss: function(c, a) {\r\n        c.className = c.className.replace(RegExp(\" \" + a, \"g\"), \"\")\r\n    }\r\n};\r\ndhx.ready = function(a) {\r\n    if (this._ready) {\r\n        a.call()\r\n    } else {\r\n        this._ready_code.push(a)\r\n    }\r\n}\r\n;\r\ndhx._ready_code = [];\r\n(function() {\r\n    var a = document.getElementsByTagName(\"SCRIPT\");\r\n    dhx.assert(a.length, \"Can't locate codebase\");\r\n    if (a.length) {\r\n        a = (a[a.length - 1].getAttribute(\"src\") || \"\").split(\"/\");\r\n        a.splice(a.length - 1, 1);\r\n        dhx.codebase = a.slice(0, a.length).join(\"/\") + \"/\"\r\n    }\r\n    dhx.event(window, \"load\", function() {\r\n        dhx4.callEvent(\"onReady\", []);\r\n        dhx.delay(function() {\r\n            dhx._ready = true;\r\n            for (var c = 0; c < dhx._ready_code.length; c++) {\r\n                dhx._ready_code[c].call()\r\n            }\r\n            dhx._ready_code = []\r\n        })\r\n    })\r\n})();\r\ndhx.locale = dhx.locale || {};\r\ndhx.assert_core_ready();\r\ndhx.ready(function() {\r\n    dhx.event(document.body, \"click\", function(a) {\r\n        dhx4.callEvent(\"onClick\", [a || event])\r\n    })\r\n});\r\n(function() {\r\n    var e = {};\r\n    var c = new RegExp(\"(\\\\r\\\\n|\\\\n)\",\"g\");\r\n    var a = new RegExp('(\\\\\")',\"g\");\r\n    dhx.Template = function(h) {\r\n        if (typeof h == \"function\") {\r\n            return h\r\n        }\r\n        if (e[h]) {\r\n            return e[h]\r\n        }\r\n        h = (h || \"\").toString();\r\n        if (h.indexOf(\"->\") != -1) {\r\n            h = h.split(\"->\");\r\n            switch (h[0]) {\r\n            case \"html\":\r\n                h = dhx.html.getValue(h[1]);\r\n                break;\r\n            default:\r\n                break\r\n            }\r\n        }\r\n        h = (h || \"\").toString();\r\n        h = h.replace(c, \"\\\\n\");\r\n        h = h.replace(a, '\\\\\"');\r\n        h = h.replace(/\\{obj\\.([^}?]+)\\?([^:]*):([^}]*)\\}/g, '\"+(obj.$1?\"$2\":\"$3\")+\"');\r\n        h = h.replace(/\\{common\\.([^}\\(]*)\\}/g, \"\\\"+(common.$1||'')+\\\"\");\r\n        h = h.replace(/\\{common\\.([^\\}\\(]*)\\(\\)\\}/g, '\"+(common.$1?common.$1.apply(this, arguments):\"\")+\"');\r\n        h = h.replace(/\\{obj\\.([^}]*)\\}/g, '\"+(obj.$1)+\"');\r\n        h = h.replace(\"{obj}\", '\"+obj+\"');\r\n        h = h.replace(/#([^#'\";, ]+)#/gi, '\"+(obj.$1)+\"');\r\n        try {\r\n            e[h] = Function(\"obj\", \"common\", 'return \"' + h + '\";')\r\n        } catch (g) {\r\n            dhx.assert_error(\"Invalid template:\" + h)\r\n        }\r\n        return e[h]\r\n    }\r\n    ;\r\n    dhx.Template.empty = function() {\r\n        return \"\"\r\n    }\r\n    ;\r\n    dhx.Template.bind = function(g) {\r\n        return dhx.bind(dhx.Template(g), this)\r\n    }\r\n    ;\r\n    dhx.Type = function(n, m) {\r\n        if (n._dhx_proto_wait) {\r\n            if (!n._dhx_type_wait) {\r\n                n._dhx_type_wait = []\r\n            }\r\n            n._dhx_type_wait.push(m);\r\n            return\r\n        }\r\n        if (typeof n == \"function\") {\r\n            n = n.prototype\r\n        }\r\n        if (!n.types) {\r\n            n.types = {\r\n                \"default\": n.type\r\n            };\r\n            n.type.name = \"default\"\r\n        }\r\n        var g = m.name;\r\n        var l = n.type;\r\n        if (g) {\r\n            l = n.types[g] = dhx.clone(m.baseType ? n.types[m.baseType] : n.type)\r\n        }\r\n        for (var h in m) {\r\n            if (h.indexOf(\"template\") === 0) {\r\n                l[h] = dhx.Template(m[h])\r\n            } else {\r\n                l[h] = m[h]\r\n            }\r\n        }\r\n        return g\r\n    }\r\n})();\r\ndhx.Settings = {\r\n    $init: function() {\r\n        this._settings = this.config = {}\r\n    },\r\n    define: function(c, a) {\r\n        if (typeof c == \"object\") {\r\n            return this._parseSeetingColl(c)\r\n        }\r\n        return this._define(c, a)\r\n    },\r\n    _define: function(c, a) {\r\n        var e = this[c + \"_setter\"];\r\n        return this._settings[c] = e ? e.call(this, a, c) : a\r\n    },\r\n    _parseSeetingColl: function(e) {\r\n        if (e) {\r\n            for (var c in e) {\r\n                this._define(c, e[c])\r\n            }\r\n        }\r\n    },\r\n    _parseSettings: function(e, a) {\r\n        var c = {};\r\n        if (a) {\r\n            c = dhx.extend(c, a)\r\n        }\r\n        if (typeof e == \"object\" && !e.tagName) {\r\n            dhx.extend(c, e, true)\r\n        }\r\n        this._parseSeetingColl(c)\r\n    },\r\n    _mergeSettings: function(a, e) {\r\n        for (var c in e) {\r\n            switch (typeof a[c]) {\r\n            case \"object\":\r\n                a[c] = this._mergeSettings((a[c] || {}), e[c]);\r\n                break;\r\n            case \"undefined\":\r\n                a[c] = e[c];\r\n                break;\r\n            default:\r\n                break\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    debug_freid_c_id: true,\r\n    debug_freid_a_name: true\r\n};\r\ndhx.ajax = function(a, c, e) {\r\n    if (arguments.length !== 0) {\r\n        var g = new dhx.ajax();\r\n        if (e) {\r\n            g.master = e\r\n        }\r\n        return g.get(a, null , c)\r\n    }\r\n    if (!this.getXHR) {\r\n        return new dhx.ajax()\r\n    }\r\n    return this\r\n}\r\n;\r\ndhx.ajax.count = 0;\r\ndhx.ajax.prototype = {\r\n    master: null ,\r\n    getXHR: function() {\r\n        if (dhx.env.isIE) {\r\n            return new ActiveXObject(\"Microsoft.xmlHTTP\")\r\n        } else {\r\n            return new XMLHttpRequest()\r\n        }\r\n    },\r\n    send: function(h, o, m) {\r\n        var c = this.getXHR();\r\n        if (!dhx.isArray(m)) {\r\n            m = [m]\r\n        }\r\n        if (typeof o == \"object\") {\r\n            var l = [];\r\n            for (var e in o) {\r\n                var n = o[e];\r\n                if (n === null  || n === dhx.undefined) {\r\n                    n = \"\"\r\n                }\r\n                l.push(e + \"=\" + encodeURIComponent(n))\r\n            }\r\n            o = l.join(\"&\")\r\n        }\r\n        if (o && this.request === \"GET\") {\r\n            h = h + (h.indexOf(\"?\") != -1 ? \"&\" : \"?\") + o;\r\n            o = null \r\n        }\r\n        c.open(this.request, h, !this._sync);\r\n        if (this.request === \"POST\") {\r\n            c.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\")\r\n        }\r\n        var g = this;\r\n        c.onreadystatechange = function() {\r\n            if (!c.readyState || c.readyState == 4) {\r\n                if (dhx.debug_time) {\r\n                    dhx.log_full_time(\"data_loading\")\r\n                }\r\n                dhx.ajax.count++;\r\n                if (m && g) {\r\n                    for (var a = 0; a < m.length; a++) {\r\n                        if (m[a]) {\r\n                            var r = (m[a].success || m[a]);\r\n                            if (c.status >= 400 || (!c.status && !c.responseText)) {\r\n                                r = m[a].error\r\n                            }\r\n                            if (r) {\r\n                                r.call((g.master || g), c.responseText, c.responseXML, c)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (g) {\r\n                    g.master = null \r\n                }\r\n                m = g = null \r\n            }\r\n        }\r\n        ;\r\n        c.send(o || null );\r\n        return c\r\n    },\r\n    get: function(a, e, c) {\r\n        if (arguments.length == 2) {\r\n            c = e;\r\n            e = null \r\n        }\r\n        this.request = \"GET\";\r\n        return this.send(a, e, c)\r\n    },\r\n    post: function(a, e, c) {\r\n        this.request = \"POST\";\r\n        return this.send(a, e, c)\r\n    },\r\n    put: function(a, e, c) {\r\n        this.request = \"PUT\";\r\n        return this.send(a, e, c)\r\n    },\r\n    del: function(a, e, c) {\r\n        this.request = \"DELETE\";\r\n        return this.send(a, e, c)\r\n    },\r\n    sync: function() {\r\n        this._sync = true;\r\n        return this\r\n    },\r\n    bind: function(a) {\r\n        this.master = a;\r\n        return this\r\n    }\r\n};\r\ndhx.send = function(e, c, m, l) {\r\n    var g = dhx.html.create(\"FORM\", {\r\n        target: (l || \"_self\"),\r\n        action: e,\r\n        method: (m || \"POST\")\r\n    }, \"\");\r\n    for (var a in c) {\r\n        var h = dhx.html.create(\"INPUT\", {\r\n            type: \"hidden\",\r\n            name: a,\r\n            value: c[a]\r\n        }, \"\");\r\n        g.appendChild(h)\r\n    }\r\n    g.style.display = \"none\";\r\n    document.body.appendChild(g);\r\n    g.submit();\r\n    document.body.removeChild(g)\r\n}\r\n;\r\ndhx.AtomDataLoader = {\r\n    $init: function(a) {\r\n        this.data = {};\r\n        if (a) {\r\n            this._settings.datatype = a.datatype || \"json\";\r\n            this.$ready.push(this._load_when_ready)\r\n        }\r\n    },\r\n    _load_when_ready: function() {\r\n        this._ready_for_data = true;\r\n        if (this._settings.url) {\r\n            this.url_setter(this._settings.url)\r\n        }\r\n        if (this._settings.data) {\r\n            this.data_setter(this._settings.data)\r\n        }\r\n    },\r\n    url_setter: function(a) {\r\n        if (!this._ready_for_data) {\r\n            return a\r\n        }\r\n        this.load(a, this._settings.datatype);\r\n        return a\r\n    },\r\n    data_setter: function(a) {\r\n        if (!this._ready_for_data) {\r\n            return a\r\n        }\r\n        this.parse(a, this._settings.datatype);\r\n        return true\r\n    },\r\n    debug_freid_c_datatype: true,\r\n    debug_freid_c_dataFeed: true,\r\n    load: function(a, c) {\r\n        if (a.$proxy) {\r\n            a.load(this, typeof c == \"string\" ? c : \"json\");\r\n            return\r\n        }\r\n        this.callEvent(\"onXLS\", []);\r\n        if (typeof c == \"string\") {\r\n            this.data.driver = dhx.DataDriver[c];\r\n            c = arguments[2]\r\n        } else {\r\n            if (!this.data.driver) {\r\n                this.data.driver = dhx.DataDriver.json\r\n            }\r\n        }\r\n        var e = [{\r\n            success: this._onLoad,\r\n            error: this._onLoadError\r\n        }];\r\n        if (c) {\r\n            if (dhx.isArray(c)) {\r\n                e.push.apply(e, c)\r\n            } else {\r\n                e.push(c)\r\n            }\r\n        }\r\n        return dhx.ajax(a, e, this)\r\n    },\r\n    parse: function(c, a) {\r\n        this.callEvent(\"onXLS\", []);\r\n        this.data.driver = dhx.DataDriver[a || \"json\"];\r\n        this._onLoad(c, null )\r\n    },\r\n    _onLoad: function(m, c, a, e) {\r\n        var h = this.data.driver;\r\n        var g = h.toObject(m, c);\r\n        if (g) {\r\n            var l = h.getRecords(g)[0];\r\n            this.data = (h ? h.getDetails(l) : m)\r\n        } else {\r\n            this._onLoadError(m, c, a)\r\n        }\r\n        this.callEvent(\"onXLE\", [])\r\n    },\r\n    _onLoadError: function(e, a, c) {\r\n        this.callEvent(\"onXLE\", []);\r\n        this.callEvent(\"onLoadError\", arguments);\r\n        dhx4.callEvent(\"onLoadError\", [e, a, c, this])\r\n    },\r\n    _check_data_feed: function(c) {\r\n        if (!this._settings.dataFeed || this._ignore_feed || !c) {\r\n            return true\r\n        }\r\n        var a = this._settings.dataFeed;\r\n        if (typeof a == \"function\") {\r\n            return a.call(this, (c.id || c), c)\r\n        }\r\n        a = a + (a.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"action=get&id=\" + encodeURIComponent(c.id || c);\r\n        this.callEvent(\"onXLS\", []);\r\n        dhx.ajax(a, function(l, g, e) {\r\n            this._ignore_feed = true;\r\n            var h = dhx.DataDriver.toObject(l, g);\r\n            if (h) {\r\n                this.setValues(h.getDetails(h.getRecords()[0]))\r\n            } else {\r\n                this._onLoadError(l, g, e)\r\n            }\r\n            this._ignore_feed = false;\r\n            this.callEvent(\"onXLE\", [])\r\n        }, this);\r\n        return false\r\n    }\r\n};\r\ndhx.DataDriver = {};\r\ndhx.DataDriver.json = {\r\n    toObject: function(data) {\r\n        if (!data) {\r\n            data = \"[]\"\r\n        }\r\n        if (typeof data == \"string\") {\r\n            try {\r\n                eval(\"dhx.temp=\" + data)\r\n            } catch (e) {\r\n                dhx.assert_error(e);\r\n                return null \r\n            }\r\n            data = dhx.temp\r\n        }\r\n        if (data.data) {\r\n            var t = data.data.config = {};\r\n            for (var key in data) {\r\n                if (key != \"data\") {\r\n                    t[key] = data[key]\r\n                }\r\n            }\r\n            data = data.data\r\n        }\r\n        return data\r\n    },\r\n    getRecords: function(a) {\r\n        if (a && !dhx.isArray(a)) {\r\n            return [a]\r\n        }\r\n        return a\r\n    },\r\n    getDetails: function(a) {\r\n        if (typeof a == \"string\") {\r\n            return {\r\n                id: dhx.uid(),\r\n                value: a\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    getInfo: function(c) {\r\n        var a = c.config;\r\n        if (!a) {\r\n            return {}\r\n        }\r\n        return {\r\n            _size: (a.total_count || 0),\r\n            _from: (a.pos || 0),\r\n            _parent: (a.parent || 0),\r\n            _config: (a.config),\r\n            _key: (a.dhx_security)\r\n        }\r\n    },\r\n    child: \"data\"\r\n};\r\ndhx.DataDriver.html = {\r\n    toObject: function(c) {\r\n        if (typeof c == \"string\") {\r\n            var a = null ;\r\n            if (c.indexOf(\"<\") == -1) {\r\n                a = dhx.toNode(c)\r\n            }\r\n            if (!a) {\r\n                a = document.createElement(\"DIV\");\r\n                a.innerHTML = c\r\n            }\r\n            return a.getElementsByTagName(this.tag)\r\n        }\r\n        return c\r\n    },\r\n    getRecords: function(c) {\r\n        var e = [];\r\n        for (var a = 0; a < c.childNodes.length; a++) {\r\n            var g = c.childNodes[a];\r\n            if (g.nodeType == 1) {\r\n                e.push(g)\r\n            }\r\n        }\r\n        return e\r\n    },\r\n    getDetails: function(a) {\r\n        return dhx.DataDriver.xml.tagToObject(a)\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    },\r\n    tag: \"LI\"\r\n};\r\ndhx.DataDriver.jsarray = {\r\n    toObject: function(data) {\r\n        if (typeof data == \"string\") {\r\n            eval(\"dhx.temp=\" + data);\r\n            return dhx.temp\r\n        }\r\n        return data\r\n    },\r\n    getRecords: function(a) {\r\n        return a\r\n    },\r\n    getDetails: function(e) {\r\n        var a = {};\r\n        for (var c = 0; c < e.length; c++) {\r\n            a[\"data\" + c] = e[c]\r\n        }\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    }\r\n};\r\ndhx.DataDriver.csv = {\r\n    toObject: function(a) {\r\n        return a\r\n    },\r\n    getRecords: function(a) {\r\n        return a.split(this.row)\r\n    },\r\n    getDetails: function(e) {\r\n        e = this.stringToArray(e);\r\n        var a = {};\r\n        for (var c = 0; c < e.length; c++) {\r\n            a[\"data\" + c] = e[c]\r\n        }\r\n        return a\r\n    },\r\n    getInfo: function(a) {\r\n        return {\r\n            _size: 0,\r\n            _from: 0\r\n        }\r\n    },\r\n    stringToArray: function(c) {\r\n        c = c.split(this.cell);\r\n        for (var a = 0; a < c.length; a++) {\r\n            c[a] = c[a].replace(/^[ \\t\\n\\r]*(\\\"|)/g, \"\").replace(/(\\\"|)[ \\t\\n\\r]*$/g, \"\")\r\n        }\r\n        return c\r\n    },\r\n    row: \"\\n\",\r\n    cell: \",\"\r\n};\r\ndhx.DataDriver.xml = {\r\n    _isValidXML: function(a) {\r\n        if (!a || !a.documentElement) {\r\n            return null \r\n        }\r\n        if (a.getElementsByTagName(\"parsererror\").length) {\r\n            return null \r\n        }\r\n        return a\r\n    },\r\n    toObject: function(e, a) {\r\n        if (this._isValidXML(c)) {\r\n            return c\r\n        }\r\n        if (typeof e == \"string\") {\r\n            var c = this.fromString(e.replace(/^[\\s]+/, \"\"))\r\n        } else {\r\n            c = e\r\n        }\r\n        if (this._isValidXML(c)) {\r\n            return c\r\n        }\r\n        return null \r\n    },\r\n    getRecords: function(a) {\r\n        return this.xpath(a, this.records)\r\n    },\r\n    records: \"/*/item\",\r\n    child: \"item\",\r\n    config: \"/*/config\",\r\n    getDetails: function(a) {\r\n        return this.tagToObject(a, {})\r\n    },\r\n    getInfo: function(c) {\r\n        var a = this.xpath(c, this.config);\r\n        if (a.length) {\r\n            a = this.assignTypes(this.tagToObject(a[0], {}))\r\n        } else {\r\n            a = null \r\n        }\r\n        return {\r\n            _size: (c.documentElement.getAttribute(\"total_count\") || 0),\r\n            _from: (c.documentElement.getAttribute(\"pos\") || 0),\r\n            _parent: (c.documentElement.getAttribute(\"parent\") || 0),\r\n            _config: a,\r\n            _key: (c.documentElement.getAttribute(\"dhx_security\") || null )\r\n        }\r\n    },\r\n    xpath: function(h, r) {\r\n        if (window.XPathResult) {\r\n            var g = h;\r\n            if (h.nodeName.indexOf(\"document\") == -1) {\r\n                h = h.ownerDocument\r\n            }\r\n            var n = [];\r\n            var c = h.evaluate(r, g, null , XPathResult.ANY_TYPE, null );\r\n            var o = c.iterateNext();\r\n            while (o) {\r\n                n.push(o);\r\n                o = c.iterateNext()\r\n            }\r\n            return n\r\n        } else {\r\n            var m = true;\r\n            try {\r\n                if (typeof (h.selectNodes) == \"undefined\") {\r\n                    m = false\r\n                }\r\n            } catch (l) {}\r\n            if (m) {\r\n                return h.selectNodes(r)\r\n            } else {\r\n                var a = r.split(\"/\").pop();\r\n                return h.getElementsByTagName(a)\r\n            }\r\n        }\r\n    },\r\n    assignTypes: function(c) {\r\n        for (var a in c) {\r\n            var e = c[a];\r\n            if (typeof e == \"object\") {\r\n                this.assignTypes(e)\r\n            } else {\r\n                if (typeof e == \"string\") {\r\n                    if (e === \"\") {\r\n                        continue\r\n                    }\r\n                    if (e == \"true\") {\r\n                        c[a] = true\r\n                    } else {\r\n                        if (e == \"false\") {\r\n                            c[a] = false\r\n                        } else {\r\n                            if (e == e * 1) {\r\n                                c[a] = c[a] * 1\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return c\r\n    },\r\n    tagToObject: function(e, o) {\r\n        o = o || {};\r\n        var h = false;\r\n        var g = e.attributes;\r\n        if (g && g.length) {\r\n            for (var m = 0; m < g.length; m++) {\r\n                o[g[m].name] = g[m].value\r\n            }\r\n            h = true\r\n        }\r\n        var c = e.childNodes;\r\n        var n = {};\r\n        for (var m = 0; m < c.length; m++) {\r\n            if (c[m].nodeType == 1) {\r\n                var l = c[m].tagName;\r\n                if (typeof o[l] != \"undefined\") {\r\n                    if (!dhx.isArray(o[l])) {\r\n                        o[l] = [o[l]]\r\n                    }\r\n                    o[l].push(this.tagToObject(c[m], {}))\r\n                } else {\r\n                    o[c[m].tagName] = this.tagToObject(c[m], {})\r\n                }\r\n                h = true\r\n            }\r\n        }\r\n        if (!h) {\r\n            return this.nodeValue(e)\r\n        }\r\n        o.value = o.value || this.nodeValue(e);\r\n        return o\r\n    },\r\n    nodeValue: function(a) {\r\n        if (a.firstChild) {\r\n            return a.firstChild.data\r\n        }\r\n        return \"\"\r\n    },\r\n    fromString: function(g) {\r\n        try {\r\n            if (window.DOMParser) {\r\n                return (new DOMParser()).parseFromString(g, \"text/xml\")\r\n            }\r\n            if (window.ActiveXObject) {\r\n                var a = new ActiveXObject(\"Microsoft.xmlDOM\");\r\n                a.loadXML(g);\r\n                return a\r\n            }\r\n        } catch (c) {\r\n            dhx.assert_error(c);\r\n            return null \r\n        }\r\n        dhx.assert_error(\"Load from xml string is not supported\")\r\n    }\r\n};\r\ndhx.DataLoader = dhx.proto({\r\n    $init: function(a) {\r\n        a = a || \"\";\r\n        this._ajax_queue = dhx.toArray();\r\n        this.data = new dhx.DataStore();\r\n        this.data.attachEvent(\"onClearAll\", dhx.bind(this._call_onclearall, this));\r\n        this.data.attachEvent(\"onServerConfig\", dhx.bind(this._call_on_config, this));\r\n        this.data.feed = this._feed\r\n    },\r\n    _feed: function(e, a, c) {\r\n        if (this._load_count) {\r\n            return this._load_count = [e, a, c]\r\n        } else {\r\n            this._load_count = true\r\n        }\r\n        this._feed_last = [e, a];\r\n        this._feed_common.call(this, e, a, c)\r\n    },\r\n    _feed_common: function(g, c, e) {\r\n        var a = this.data.url;\r\n        if (g < 0) {\r\n            g = 0\r\n        }\r\n        this.load(a + ((a.indexOf(\"?\") == -1) ? \"?\" : \"&\") + (this.dataCount() ? (\"continue=true&\") : \"\") + \"start=\" + g + \"&count=\" + c, [this._feed_callback, e])\r\n    },\r\n    _feed_callback: function() {\r\n        var a = this._load_count;\r\n        var c = this._feed_last;\r\n        this._load_count = false;\r\n        if (typeof a == \"object\" && (a[0] != c[0] || a[1] != c[1])) {\r\n            this.data.feed.apply(this, a)\r\n        }\r\n    },\r\n    load: function(a, c) {\r\n        var e = dhx.AtomDataLoader.load.apply(this, arguments);\r\n        this._ajax_queue.push(e);\r\n        if (!this.data.url) {\r\n            this.data.url = a\r\n        }\r\n    },\r\n    loadNext: function(e, h, g, c, a) {\r\n        if (this._settings.datathrottle && !a) {\r\n            if (this._throttle_request) {\r\n                window.clearTimeout(this._throttle_request)\r\n            }\r\n            this._throttle_request = dhx.delay(function() {\r\n                this.loadNext(e, h, g, c, true)\r\n            }, this, 0, this._settings.datathrottle);\r\n            return\r\n        }\r\n        if (!h && h !== 0) {\r\n            h = this.dataCount()\r\n        }\r\n        this.data.url = this.data.url || c;\r\n        if (this.callEvent(\"onDataRequest\", [h, e, g, c]) && this.data.url) {\r\n            this.data.feed.call(this, h, e, g)\r\n        }\r\n    },\r\n    _maybe_loading_already: function(c, e) {\r\n        var a = this._feed_last;\r\n        if (this._load_count && a) {\r\n            if (a[0] <= e && (a[1] + a[0] >= c + e)) {\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    },\r\n    _onLoad: function(g, c, a) {\r\n        this._ajax_queue.remove(a);\r\n        var e = this.data.driver.toObject(g, c);\r\n        if (e) {\r\n            this.data._parse(e)\r\n        } else {\r\n            return this._onLoadError(g, c, a)\r\n        }\r\n        this._call_onready();\r\n        this.callEvent(\"onXLE\", [])\r\n    },\r\n    removeMissed_setter: function(a) {\r\n        return this.data._removeMissed = a\r\n    },\r\n    scheme_setter: function(a) {\r\n        this.data.scheme(a)\r\n    },\r\n    dataFeed_setter: function(a) {\r\n        this.data.attachEvent(\"onBeforeFilter\", dhx.bind(function(m, l) {\r\n            if (this._settings.dataFeed) {\r\n                var h = {};\r\n                if (!m && !l) {\r\n                    return\r\n                }\r\n                if (typeof m == \"function\") {\r\n                    if (!l) {\r\n                        return\r\n                    }\r\n                    m(l, h)\r\n                } else {\r\n                    h = {\r\n                        text: l\r\n                    }\r\n                }\r\n                this.clearAll();\r\n                var c = this._settings.dataFeed;\r\n                var g = [];\r\n                if (typeof c == \"function\") {\r\n                    return c.call(this, l, h)\r\n                }\r\n                for (var e in h) {\r\n                    g.push(\"dhx_filter[\" + e + \"]=\" + encodeURIComponent(h[e]))\r\n                }\r\n                this.load(c + (c.indexOf(\"?\") < 0 ? \"?\" : \"&\") + g.join(\"&\"), this._settings.datatype);\r\n                return false\r\n            }\r\n        }, this));\r\n        return a\r\n    },\r\n    debug_freid_c_ready: true,\r\n    debug_freid_c_datathrottle: true,\r\n    _call_onready: function() {\r\n        if (this._settings.ready && !this._ready_was_used) {\r\n            var a = dhx.toFunctor(this._settings.ready);\r\n            if (a) {\r\n                dhx.delay(a, this, arguments)\r\n            }\r\n            this._ready_was_used = true\r\n        }\r\n    },\r\n    _call_onclearall: function() {\r\n        for (var a = 0; a < this._ajax_queue.length; a++) {\r\n            this._ajax_queue[a].abort()\r\n        }\r\n        this._ajax_queue = dhx.toArray()\r\n    },\r\n    _call_on_config: function(a) {\r\n        this._parseSeetingColl(a)\r\n    }\r\n}, dhx.AtomDataLoader);\r\ndhx.DataStore = function() {\r\n    this.name = \"DataStore\";\r\n    dhx.extend(this, dhx.EventSystem);\r\n    this.setDriver(\"json\");\r\n    this.pull = {};\r\n    this.order = dhx.toArray();\r\n    this._marks = {}\r\n}\r\n;\r\ndhx.DataStore.prototype = {\r\n    setDriver: function(a) {\r\n        dhx.assert(dhx.DataDriver[a], \"incorrect DataDriver\");\r\n        this.driver = dhx.DataDriver[a]\r\n    },\r\n    _parse: function(e, a) {\r\n        this.callEvent(\"onParse\", [this.driver, e]);\r\n        if (this._filter_order) {\r\n            this.filter()\r\n        }\r\n        var g = this.driver.getInfo(e);\r\n        if (g._key) {\r\n            dhx.securityKey = g._key\r\n        }\r\n        if (g._config) {\r\n            this.callEvent(\"onServerConfig\", [g._config])\r\n        }\r\n        var c = this.driver.getRecords(e);\r\n        this._inner_parse(g, c);\r\n        if (this._scheme_group && this._group_processing) {\r\n            this._group_processing(this._scheme_group)\r\n        }\r\n        if (this._scheme_sort) {\r\n            this.blockEvent();\r\n            this.sort(this._scheme_sort);\r\n            this.unblockEvent()\r\n        }\r\n        this.callEvent(\"onStoreLoad\", [this.driver, e]);\r\n        this.refresh()\r\n    },\r\n    _inner_parse: function(c, m) {\r\n        var o = (c._from || 0) * 1;\r\n        var l = true;\r\n        var n = false;\r\n        if (o === 0 && this.order[0]) {\r\n            if (this._removeMissed) {\r\n                n = {};\r\n                for (var g = 0; g < this.order.length; g++) {\r\n                    n[this.order[g]] = true\r\n                }\r\n            }\r\n            l = false;\r\n            o = this.order.length\r\n        }\r\n        var e = 0;\r\n        for (var g = 0; g < m.length; g++) {\r\n            var r = this.driver.getDetails(m[g]);\r\n            var a = this.id(r);\r\n            if (!this.pull[a]) {\r\n                this.order[e + o] = a;\r\n                e++\r\n            } else {\r\n                if (l && this.order[e + o]) {\r\n                    e++\r\n                }\r\n            }\r\n            if (this.pull[a]) {\r\n                dhx.extend(this.pull[a], r, true);\r\n                if (this._scheme_update) {\r\n                    this._scheme_update(this.pull[a])\r\n                }\r\n                if (n) {\r\n                    delete n[a]\r\n                }\r\n            } else {\r\n                this.pull[a] = r;\r\n                if (this._scheme_init) {\r\n                    this._scheme_init(r)\r\n                }\r\n            }\r\n        }\r\n        if (n) {\r\n            this.blockEvent();\r\n            for (var h in n) {\r\n                this.remove(h)\r\n            }\r\n            this.unblockEvent()\r\n        }\r\n        if (!this.order[c._size - 1]) {\r\n            this.order[c._size - 1] = dhx.undefined\r\n        }\r\n    },\r\n    id: function(a) {\r\n        return a.id || (a.id = dhx.uid())\r\n    },\r\n    changeId: function(c, a) {\r\n        if (this.pull[c]) {\r\n            this.pull[a] = this.pull[c]\r\n        }\r\n        this.pull[a].id = a;\r\n        this.order[this.order.find(c)] = a;\r\n        if (this._filter_order) {\r\n            this._filter_order[this._filter_order.find(c)] = a\r\n        }\r\n        if (this._marks[c]) {\r\n            this._marks[a] = this._marks[c];\r\n            delete this._marks[c]\r\n        }\r\n        this.callEvent(\"onIdChange\", [c, a]);\r\n        if (this._render_change_id) {\r\n            this._render_change_id(c, a)\r\n        }\r\n        delete this.pull[c]\r\n    },\r\n    item: function(a) {\r\n        return this.pull[a]\r\n    },\r\n    update: function(c, a) {\r\n        if (dhx.isUndefined(a)) {\r\n            a = this.item(c)\r\n        }\r\n        if (this._scheme_update) {\r\n            this._scheme_update(a)\r\n        }\r\n        if (this.callEvent(\"onBeforeUpdate\", [c, a]) === false) {\r\n            return false\r\n        }\r\n        this.pull[c] = a;\r\n        this.callEvent(\"onStoreUpdated\", [c, a, \"update\"])\r\n    },\r\n    refresh: function(a) {\r\n        if (this._skip_refresh) {\r\n            return\r\n        }\r\n        if (a) {\r\n            this.callEvent(\"onStoreUpdated\", [a, this.pull[a], \"paint\"])\r\n        } else {\r\n            this.callEvent(\"onStoreUpdated\", [null , null , null ])\r\n        }\r\n    },\r\n    silent: function(c, a) {\r\n        this._skip_refresh = true;\r\n        c.call(a || this);\r\n        this._skip_refresh = false\r\n    },\r\n    getRange: function(g, e) {\r\n        if (g) {\r\n            g = this.indexById(g)\r\n        } else {\r\n            g = (this.$min || this.startOffset) || 0\r\n        }\r\n        if (e) {\r\n            e = this.indexById(e)\r\n        } else {\r\n            e = Math.min(((this.$max || this.endOffset) || Infinity), (this.dataCount() - 1));\r\n            if (e < 0) {\r\n                e = 0\r\n            }\r\n        }\r\n        if (g > e) {\r\n            var c = e;\r\n            e = g;\r\n            g = c\r\n        }\r\n        return this.getIndexRange(g, e)\r\n    },\r\n    getIndexRange: function(g, e) {\r\n        e = Math.min((e || Infinity), this.dataCount() - 1);\r\n        var a = dhx.toArray();\r\n        for (var c = (g || 0); c <= e; c++) {\r\n            a.push(this.item(this.order[c]))\r\n        }\r\n        return a\r\n    },\r\n    dataCount: function() {\r\n        return this.order.length\r\n    },\r\n    exists: function(a) {\r\n        return !!(this.pull[a])\r\n    },\r\n    move: function(a, g) {\r\n        dhx.assert(a >= 0 && g >= 0, \"DataStore::move\", \"Incorrect indexes\");\r\n        var e = this.idByIndex(a);\r\n        var c = this.item(e);\r\n        this.order.removeAt(a);\r\n        this.order.insertAt(e, Math.min(this.order.length, g));\r\n        this.callEvent(\"onStoreUpdated\", [e, c, \"move\"])\r\n    },\r\n    scheme: function(a) {\r\n        this._scheme = {};\r\n        this._scheme_init = a.$init;\r\n        this._scheme_update = a.$update;\r\n        this._scheme_serialize = a.$serialize;\r\n        this._scheme_group = a.$group;\r\n        this._scheme_sort = a.$sort;\r\n        for (var c in a) {\r\n            if (c.substr(0, 1) != \"$\") {\r\n                this._scheme[c] = a[c]\r\n            }\r\n        }\r\n    },\r\n    sync: function(g, e, a) {\r\n        if (typeof g == \"string\") {\r\n            g = $$(\"source\")\r\n        }\r\n        if (typeof e != \"function\") {\r\n            a = e;\r\n            e = null \r\n        }\r\n        if (dhx.debug_bind) {\r\n            this.debug_sync_master = g;\r\n            dhx.log(\"[sync] \" + this.debug_bind_master.name + \"@\" + this.debug_bind_master._settings.id + \" <= \" + this.debug_sync_master.name + \"@\" + this.debug_sync_master._settings.id)\r\n        }\r\n        this._backbone_source = false;\r\n        if (g.name != \"DataStore\") {\r\n            if (g.data && g.data.name == \"DataStore\") {\r\n                g = g.data\r\n            } else {\r\n                this._backbone_source = true\r\n            }\r\n        }\r\n        var c = dhx.bind(function(n, h, m) {\r\n            if (this._backbone_source) {\r\n                if (!n) {\r\n                    return\r\n                }\r\n                if (n.indexOf(\"change\") === 0) {\r\n                    if (n == \"change\") {\r\n                        this.pull[h.id] = h.attributes;\r\n                        this.refresh(h.id);\r\n                        return\r\n                    } else {\r\n                        return\r\n                    }\r\n                }\r\n                if (n == \"reset\") {\r\n                    m = h\r\n                }\r\n                this.order = [];\r\n                this.pull = {};\r\n                this._filter_order = null ;\r\n                for (var l = 0; l < m.models.length; l++) {\r\n                    var o = m.models[l].id;\r\n                    this.order.push(o);\r\n                    this.pull[o] = m.models[l].attributes\r\n                }\r\n            } else {\r\n                this._filter_order = null ;\r\n                this.order = dhx.toArray([].concat(g.order));\r\n                this.pull = g.pull\r\n            }\r\n            if (e) {\r\n                this.silent(e)\r\n            }\r\n            if (this._on_sync) {\r\n                this._on_sync()\r\n            }\r\n            if (dhx.debug_bind) {\r\n                dhx.log(\"[sync:request] \" + this.debug_sync_master.name + \"@\" + this.debug_sync_master._settings.id + \" <= \" + this.debug_bind_master.name + \"@\" + this.debug_bind_master._settings.id)\r\n            }\r\n            this.callEvent(\"onSyncApply\", []);\r\n            if (!a) {\r\n                this.refresh()\r\n            } else {\r\n                a = false\r\n            }\r\n        }, this);\r\n        if (this._backbone_source) {\r\n            g.bind(\"all\", c)\r\n        } else {\r\n            this._sync_events = [g.attachEvent(\"onStoreUpdated\", c), g.attachEvent(\"onIdChange\", dhx.bind(function(h, l) {\r\n                this.changeId(h, l)\r\n            }, this))]\r\n        }\r\n        c()\r\n    },\r\n    add: function(l, c) {\r\n        if (this._scheme) {\r\n            for (var e in this._scheme) {\r\n                if (dhx.isUndefined(l[e])) {\r\n                    l[e] = this._scheme[e]\r\n                }\r\n            }\r\n        }\r\n        if (this._scheme_init) {\r\n            this._scheme_init(l)\r\n        }\r\n        var m = this.id(l);\r\n        var a = arguments[2] || this.order;\r\n        var h = a.length;\r\n        if (dhx.isUndefined(c) || c < 0) {\r\n            c = h\r\n        }\r\n        if (c > h) {\r\n            dhx.log(\"Warning\", \"DataStore:add\", \"Index of out of bounds\");\r\n            c = Math.min(a.length, c)\r\n        }\r\n        if (this.callEvent(\"onBeforeAdd\", [m, l, c]) === false) {\r\n            return false\r\n        }\r\n        dhx.assert(!this.exists(m), \"Not unique ID\");\r\n        this.pull[m] = l;\r\n        a.insertAt(m, c);\r\n        if (this._filter_order) {\r\n            var g = this._filter_order.length;\r\n            if (!c && this.order.length) {\r\n                g = 0\r\n            }\r\n            this._filter_order.insertAt(m, g)\r\n        }\r\n        this.callEvent(\"onAfterAdd\", [m, c]);\r\n        this.callEvent(\"onStoreUpdated\", [m, l, \"add\"]);\r\n        return m\r\n    },\r\n    remove: function(e) {\r\n        if (dhx.isArray(e)) {\r\n            for (var a = 0; a < e.length; a++) {\r\n                this.remove(e[a])\r\n            }\r\n            return\r\n        }\r\n        if (this.callEvent(\"onBeforeDelete\", [e]) === false) {\r\n            return false\r\n        }\r\n        dhx.assert(this.exists(e), \"Not existing ID in remove command\" + e);\r\n        var c = this.item(e);\r\n        this.order.remove(e);\r\n        if (this._filter_order) {\r\n            this._filter_order.remove(e)\r\n        }\r\n        delete this.pull[e];\r\n        if (this._marks[e]) {\r\n            delete this._marks[e]\r\n        }\r\n        this.callEvent(\"onAfterDelete\", [e]);\r\n        this.callEvent(\"onStoreUpdated\", [e, c, \"delete\"])\r\n    },\r\n    clearAll: function() {\r\n        this.pull = {};\r\n        this.order = dhx.toArray();\r\n        this._filter_order = this.url = null ;\r\n        this.callEvent(\"onClearAll\", []);\r\n        this.refresh()\r\n    },\r\n    idByIndex: function(a) {\r\n        if (a >= this.order.length || a < 0) {\r\n            dhx.log(\"Warning\", \"DataStore::idByIndex Incorrect index\")\r\n        }\r\n        return this.order[a]\r\n    },\r\n    indexById: function(c) {\r\n        var a = this.order.find(c);\r\n        if (!this.pull[c]) {\r\n            dhx.log(\"Warning\", \"DataStore::indexById Non-existing ID: \" + c)\r\n        }\r\n        return a\r\n    },\r\n    next: function(c, a) {\r\n        return this.order[this.indexById(c) + (a || 1)]\r\n    },\r\n    first: function() {\r\n        return this.order[0]\r\n    },\r\n    last: function() {\r\n        return this.order[this.order.length - 1]\r\n    },\r\n    previous: function(c, a) {\r\n        return this.order[this.indexById(c) - (a || 1)]\r\n    },\r\n    sort: function(h, c, a) {\r\n        var e = h;\r\n        if (typeof h == \"function\") {\r\n            e = {\r\n                as: h,\r\n                dir: c\r\n            }\r\n        } else {\r\n            if (typeof h == \"string\") {\r\n                e = {\r\n                    by: h.replace(/#/g, \"\"),\r\n                    dir: c,\r\n                    as: a\r\n                }\r\n            }\r\n        }\r\n        var g = [e.by, e.dir, e.as];\r\n        if (!this.callEvent(\"onBeforeSort\", g)) {\r\n            return\r\n        }\r\n        this._sort_core(e);\r\n        this.refresh();\r\n        this.callEvent(\"onAfterSort\", g)\r\n    },\r\n    _sort_core: function(a) {\r\n        if (this.order.length) {\r\n            var e = this._sort._create(a);\r\n            var c = this.getRange(this.first(), this.last());\r\n            c.sort(e);\r\n            this.order = c.map(function(g) {\r\n                dhx.assert(g, \"Client sorting can't be used with dynamic loading\");\r\n                return this.id(g)\r\n            }, this)\r\n        }\r\n    },\r\n    _filter_reset: function(a) {\r\n        if (this._filter_order && !a) {\r\n            this.order = this._filter_order;\r\n            delete this._filter_order\r\n        }\r\n    },\r\n    _filter_core: function(e, h, c) {\r\n        var g = dhx.toArray();\r\n        for (var a = 0; a < this.order.length; a++) {\r\n            var l = this.order[a];\r\n            if (e(this.item(l), h)) {\r\n                g.push(l)\r\n            }\r\n        }\r\n        if (!c || !this._filter_order) {\r\n            this._filter_order = this.order\r\n        }\r\n        this.order = g\r\n    },\r\n    filter: function(g, e, a) {\r\n        if (!this.callEvent(\"onBeforeFilter\", [g, e])) {\r\n            return\r\n        }\r\n        this._filter_reset(a);\r\n        if (!this.order.length) {\r\n            return\r\n        }\r\n        if (g) {\r\n            var c = g;\r\n            e = e || \"\";\r\n            if (typeof g == \"string\") {\r\n                g = g.replace(/#/g, \"\");\r\n                if (typeof e == \"function\") {\r\n                    c = function(h) {\r\n                        return e(h[g])\r\n                    }\r\n                } else {\r\n                    e = e.toString().toLowerCase();\r\n                    c = function(l, h) {\r\n                        dhx.assert(l, \"Client side filtering can't be used with dynamic loading\");\r\n                        return (l[g] || \"\").toString().toLowerCase().indexOf(h) != -1\r\n                    }\r\n                }\r\n            }\r\n            this._filter_core(c, e, a, this._filterMode)\r\n        }\r\n        this.refresh();\r\n        this.callEvent(\"onAfterFilter\", [])\r\n    },\r\n    each: function(e, c) {\r\n        for (var a = 0; a < this.order.length; a++) {\r\n            e.call((c || this), this.item(this.order[a]))\r\n        }\r\n    },\r\n    _methodPush: function(a, c) {\r\n        return function() {\r\n            return a[c].apply(a, arguments)\r\n        }\r\n    },\r\n    addMark: function(h, g, a, c) {\r\n        var e = this._marks[h] || {};\r\n        this._marks[h] = e;\r\n        if (!e[g]) {\r\n            e[g] = c || true;\r\n            if (a) {\r\n                this.item(h).$css = (this.item(h).$css || \"\") + \" \" + g;\r\n                this.refresh(h)\r\n            }\r\n        }\r\n        return e[g]\r\n    },\r\n    removeMark: function(h, g, a) {\r\n        var e = this._marks[h];\r\n        if (e && e[g]) {\r\n            delete e[g]\r\n        }\r\n        if (a) {\r\n            var c = this.item(h).$css;\r\n            if (c) {\r\n                this.item(h).$css = c.replace(g, \"\");\r\n                this.refresh(h)\r\n            }\r\n        }\r\n    },\r\n    hasMark: function(e, c) {\r\n        var a = this._marks[e];\r\n        return ( a && a[c]) \r\n    },\r\n    provideApi: function(g, c) {\r\n        this.debug_bind_master = g;\r\n        if (c) {\r\n            this.mapEvent({\r\n                onbeforesort: g,\r\n                onaftersort: g,\r\n                onbeforeadd: g,\r\n                onafteradd: g,\r\n                onbeforedelete: g,\r\n                onafterdelete: g,\r\n                onbeforeupdate: g\r\n            })\r\n        }\r\n        var e = [\"sort\", \"add\", \"remove\", \"exists\", \"idByIndex\", \"indexById\", \"item\", \"update\", \"refresh\", \"dataCount\", \"filter\", \"next\", \"previous\", \"clearAll\", \"first\", \"last\", \"serialize\", \"sync\", \"addMark\", \"removeMark\", \"hasMark\"];\r\n        for (var a = 0; a < e.length; a++) {\r\n            g[e[a]] = this._methodPush(this, e[a])\r\n        }\r\n    },\r\n    serialize: function() {\r\n        var g = this.order;\r\n        var a = [];\r\n        for (var c = 0; c < g.length; c++) {\r\n            var e = this.pull[g[c]];\r\n            if (this._scheme_serialize) {\r\n                e = this._scheme_serialize(e);\r\n                if (e === false) {\r\n                    continue\r\n                }\r\n            }\r\n            a.push(e)\r\n        }\r\n        return a\r\n    },\r\n    _sort: {\r\n        _create: function(a) {\r\n            return this._dir(a.dir, this._by(a.by, a.as))\r\n        },\r\n        _as: {\r\n            date: function(e, c) {\r\n                e = e - 0;\r\n                c = c - 0;\r\n                return e > c ? 1 : (e < c ? -1 : 0)\r\n            },\r\n            \"int\": function(e, c) {\r\n                e = e * 1;\r\n                c = c * 1;\r\n                return e > c ? 1 : (e < c ? -1 : 0)\r\n            },\r\n            string_strict: function(e, c) {\r\n                e = e.toString();\r\n                c = c.toString();\r\n                return e > c ? 1 : (e < c ? -1 : 0)\r\n            },\r\n            string: function(e, c) {\r\n                if (!c) {\r\n                    return 1\r\n                }\r\n                if (!e) {\r\n                    return -1\r\n                }\r\n                e = e.toString().toLowerCase();\r\n                c = c.toString().toLowerCase();\r\n                return e > c ? 1 : (e < c ? -1 : 0)\r\n            }\r\n        },\r\n        _by: function(c, a) {\r\n            if (!c) {\r\n                return a\r\n            }\r\n            if (typeof a != \"function\") {\r\n                a = this._as[a || \"string\"]\r\n            }\r\n            dhx.assert(a, \"Invalid sorting method\");\r\n            return function(g, e) {\r\n                return a(g[c], e[c])\r\n            }\r\n        },\r\n        _dir: function(c, a) {\r\n            if (c == \"asc\" || !c) {\r\n                return a\r\n            }\r\n            return function(g, e) {\r\n                return a(g, e) * -1\r\n            }\r\n        }\r\n    }\r\n};\r\ndhx.BaseBind = {\r\n    debug_freid_ignore: {\r\n        id: true\r\n    },\r\n    bind: function(h, g, e) {\r\n        if (typeof h == \"string\") {\r\n            h = dhx.ui.get(h)\r\n        }\r\n        if (h._initBindSource) {\r\n            h._initBindSource()\r\n        }\r\n        if (this._initBindSource) {\r\n            this._initBindSource()\r\n        }\r\n        if (!h.getBindData) {\r\n            dhx.extend(h, dhx.BindSource)\r\n        }\r\n        if (!this._bind_ready) {\r\n            var l = this.render;\r\n            if (this.filter) {\r\n                var c = this._settings.id;\r\n                this.data._on_sync = function() {\r\n                    h._bind_updated[c] = false\r\n                }\r\n            }\r\n            this.render = function() {\r\n                if (this._in_bind_processing) {\r\n                    return\r\n                }\r\n                this._in_bind_processing = true;\r\n                var m = this.callEvent(\"onBindRequest\");\r\n                this._in_bind_processing = false;\r\n                return l.apply(this, ((m === false) ? arguments : []))\r\n            }\r\n            ;\r\n            if (this.getValue || this.getValues) {\r\n                this.save = function() {\r\n                    if (this.validate && !this.validate()) {\r\n                        return\r\n                    }\r\n                    h.setBindData((this.getValue ? this.getValue : this.getValues()), this._settings.id)\r\n                }\r\n            }\r\n            this._bind_ready = true\r\n        }\r\n        h.addBind(this._settings.id, g, e);\r\n        if (dhx.debug_bind) {\r\n            dhx.log(\"[bind] \" + this.name + \"@\" + this._settings.id + \" <= \" + h.name + \"@\" + h._settings.id)\r\n        }\r\n        var a = this._settings.id;\r\n        this.attachEvent(this.touchable ? \"onAfterRender\" : \"onBindRequest\", function() {\r\n            return h.getBindData(a)\r\n        });\r\n        if (!this._settings.dataFeed && this.loadNext) {\r\n            this.data.attachEvent(\"onStoreLoad\", function() {\r\n                h._bind_updated[a] = false\r\n            })\r\n        }\r\n        if (this.isVisible(this._settings.id)) {\r\n            this.refresh()\r\n        }\r\n    },\r\n    unbind: function(a) {\r\n        return this._unbind(a)\r\n    },\r\n    _unbind: function(e) {\r\n        e.removeBind(this._settings.id);\r\n        var c = (this._sync_events || (this.data ? this.data._sync_events : 0));\r\n        if (c && e.data) {\r\n            for (var a = 0; a < c.length; a++) {\r\n                e.data.detachEvent(c[a])\r\n            }\r\n        }\r\n    }\r\n};\r\ndhx.BindSource = {\r\n    $init: function() {\r\n        this._bind_hash = {};\r\n        this._bind_updated = {};\r\n        this._ignore_binds = {};\r\n        this._bind_specific_rules(this)\r\n    },\r\n    saveBatch: function(a) {\r\n        this._do_not_update_binds = true;\r\n        a.call(this);\r\n        this._do_not_update_binds = false;\r\n        this._update_binds()\r\n    },\r\n    setBindData: function(c, a) {\r\n        if (a) {\r\n            this._ignore_binds[a] = true\r\n        }\r\n        if (dhx.debug_bind) {\r\n            dhx.log(\"[bind:save] \" + this.name + \"@\" + this._settings.id + \" <= @\" + a)\r\n        }\r\n        if (this.setValue) {\r\n            this.setValue(c)\r\n        } else {\r\n            if (this.setValues) {\r\n                this.setValues(c)\r\n            } else {\r\n                var e = this.getCursor();\r\n                if (e) {\r\n                    c = dhx.extend(this.item(e), c, true);\r\n                    this.update(e, c)\r\n                }\r\n            }\r\n        }\r\n        this.callEvent(\"onBindUpdate\", [c, a]);\r\n        if (this.save) {\r\n            this.save()\r\n        }\r\n        if (a) {\r\n            this._ignore_binds[a] = false\r\n        }\r\n    },\r\n    getBindData: function(a, e) {\r\n        if (this._bind_updated[a]) {\r\n            return false\r\n        }\r\n        var c = dhx.ui.get(a);\r\n        if (c.isVisible(c._settings.id)) {\r\n            this._bind_updated[a] = true;\r\n            if (dhx.debug_bind) {\r\n                dhx.log(\"[bind:request] \" + this.name + \"@\" + this._settings.id + \" => \" + c.name + \"@\" + c._settings.id)\r\n            }\r\n            this._bind_update(c, this._bind_hash[a][0], this._bind_hash[a][1]);\r\n            if (e && c.filter) {\r\n                c.refresh()\r\n            }\r\n        }\r\n    },\r\n    addBind: function(a, e, c) {\r\n        this._bind_hash[a] = [e, c]\r\n    },\r\n    removeBind: function(a) {\r\n        delete this._bind_hash[a];\r\n        delete this._bind_updated[a];\r\n        delete this._ignore_binds[a]\r\n    },\r\n    _bind_specific_rules: function(a) {\r\n        if (a.filter) {\r\n            dhx.extend(this, dhx.CollectionBind)\r\n        } else {\r\n            if (a.setValue) {\r\n                dhx.extend(this, dhx.ValueBind)\r\n            } else {\r\n                dhx.extend(this, dhx.RecordBind)\r\n            }\r\n        }\r\n    },\r\n    _update_binds: function() {\r\n        if (!this._do_not_update_binds) {\r\n            for (var a in this._bind_hash) {\r\n                if (this._ignore_binds[a]) {\r\n                    continue\r\n                }\r\n                this._bind_updated[a] = false;\r\n                this.getBindData(a, true)\r\n            }\r\n        }\r\n    },\r\n    _bind_update_common: function(e, c, a) {\r\n        if (e.setValue) {\r\n            e.setValue(a ? a[c] : a)\r\n        } else {\r\n            if (!e.filter) {\r\n                if (!a && e.clear) {\r\n                    e.clear()\r\n                } else {\r\n                    if (e._check_data_feed(a)) {\r\n                        e.setValues(dhx.clone(a))\r\n                    }\r\n                }\r\n            } else {\r\n                e.data.silent(function() {\r\n                    this.filter(c, a)\r\n                })\r\n            }\r\n        }\r\n        e.callEvent(\"onBindApply\", [a, c, this])\r\n    }\r\n};\r\ndhx.DataValue = dhx.proto({\r\n    name: \"DataValue\",\r\n    isVisible: function() {\r\n        return true\r\n    },\r\n    $init: function(a) {\r\n        this.data = \"\" || a;\r\n        var c = (a && a.id) ? a.id : dhx.uid();\r\n        this._settings = {\r\n            id: c\r\n        };\r\n        dhx.ui.views[c] = this\r\n    },\r\n    setValue: function(a) {\r\n        this.data = a;\r\n        this.callEvent(\"onChange\", [a])\r\n    },\r\n    getValue: function() {\r\n        return this.data\r\n    },\r\n    refresh: function() {\r\n        this.callEvent(\"onBindRequest\")\r\n    }\r\n}, dhx.EventSystem, dhx.BaseBind);\r\ndhx.DataRecord = dhx.proto({\r\n    name: \"DataRecord\",\r\n    isVisible: function() {\r\n        return true\r\n    },\r\n    $init: function(a) {\r\n        this.data = a || {};\r\n        var c = (a && a.id) ? a.id : dhx.uid();\r\n        this._settings = {\r\n            id: c\r\n        };\r\n        dhx.ui.views[c] = this\r\n    },\r\n    getValues: function() {\r\n        return this.data\r\n    },\r\n    setValues: function(a) {\r\n        this.data = a;\r\n        this.callEvent(\"onChange\", [a])\r\n    },\r\n    refresh: function() {\r\n        this.callEvent(\"onBindRequest\")\r\n    }\r\n}, dhx.EventSystem, dhx.BaseBind, dhx.AtomDataLoader, dhx.Settings);\r\ndhx.DataCollection = dhx.proto({\r\n    name: \"DataCollection\",\r\n    isVisible: function() {\r\n        if (!this.data.order.length && !this.data._filter_order && !this._settings.dataFeed) {\r\n            return false\r\n        }\r\n        return true\r\n    },\r\n    $init: function(a) {\r\n        this.data.provideApi(this, true);\r\n        var c = (a && a.id) ? a.id : dhx.uid();\r\n        this._settings.id = c;\r\n        dhx.ui.views[c] = this;\r\n        this.data.attachEvent(\"onStoreLoad\", dhx.bind(function() {\r\n            this.callEvent(\"onBindRequest\", [])\r\n        }, this))\r\n    },\r\n    refresh: function() {\r\n        this.callEvent(\"onBindRequest\", [])\r\n    }\r\n}, dhx.DataLoader, dhx.EventSystem, dhx.BaseBind, dhx.Settings);\r\ndhx.ValueBind = {\r\n    $init: function() {\r\n        this.attachEvent(\"onChange\", this._update_binds)\r\n    },\r\n    _bind_update: function(h, g, e) {\r\n        var c = this.getValue() || \"\";\r\n        if (e) {\r\n            c = e(c)\r\n        }\r\n        if (h.setValue) {\r\n            h.setValue(c)\r\n        } else {\r\n            if (!h.filter) {\r\n                var a = {};\r\n                a[g] = c;\r\n                if (h._check_data_feed(c)) {\r\n                    h.setValues(a)\r\n                }\r\n            } else {\r\n                h.data.silent(function() {\r\n                    this.filter(g, c)\r\n                })\r\n            }\r\n        }\r\n        h.callEvent(\"onBindApply\", [c, g, this])\r\n    }\r\n};\r\ndhx.RecordBind = {\r\n    $init: function() {\r\n        this.attachEvent(\"onChange\", this._update_binds)\r\n    },\r\n    _bind_update: function(e, c) {\r\n        var a = this.getValues() || null ;\r\n        this._bind_update_common(e, c, a)\r\n    }\r\n};\r\ndhx.CollectionBind = {\r\n    $init: function() {\r\n        this._cursor = null ;\r\n        this.attachEvent(\"onSelectChange\", function(c) {\r\n            var a = this.getSelected();\r\n            this.setCursor(a ? (a.id || a) : null )\r\n        });\r\n        this.attachEvent(\"onAfterCursorChange\", this._update_binds);\r\n        this.data.attachEvent(\"onStoreUpdated\", dhx.bind(function(e, a, c) {\r\n            if (e && e == this.getCursor() && c != \"paint\") {\r\n                this._update_binds()\r\n            }\r\n        }, this));\r\n        this.data.attachEvent(\"onClearAll\", dhx.bind(function() {\r\n            this._cursor = null \r\n        }, this));\r\n        this.data.attachEvent(\"onIdChange\", dhx.bind(function(c, a) {\r\n            if (this._cursor == c) {\r\n                this._cursor = a\r\n            }\r\n        }, this))\r\n    },\r\n    setCursor: function(a) {\r\n        if (a == this._cursor || (a !== null  && !this.item(a))) {\r\n            return\r\n        }\r\n        this.callEvent(\"onBeforeCursorChange\", [this._cursor]);\r\n        this._cursor = a;\r\n        this.callEvent(\"onAfterCursorChange\", [a])\r\n    },\r\n    getCursor: function() {\r\n        return this._cursor\r\n    },\r\n    _bind_update: function(e, c) {\r\n        var a = this.item(this.getCursor()) || this._settings.defaultData || null ;\r\n        this._bind_update_common(e, c, a)\r\n    }\r\n};\r\nif (!dhx.ui) {\r\n    dhx.ui = {}\r\n}\r\nif (!dhx.ui.views) {\r\n    dhx.ui.views = {};\r\n    dhx.ui.get = function(a) {\r\n        if (a._settings) {\r\n            return a\r\n        }\r\n        return dhx.ui.views[a]\r\n    }\r\n}\r\ndhtmlXDataStore = function(c) {\r\n    var e = new dhx.DataCollection(c);\r\n    var a = \"_dp_init\";\r\n    e[a] = function(h) {\r\n        var g = \"_methods\";\r\n        h[g] = [\"dummy\", \"dummy\", \"changeId\", \"dummy\"];\r\n        this.data._old_names = {\r\n            add: \"inserted\",\r\n            update: \"updated\",\r\n            \"delete\": \"deleted\"\r\n        };\r\n        this.data.attachEvent(\"onStoreUpdated\", function(n, l, m) {\r\n            if (n && !h._silent) {\r\n                h.setUpdated(n, true, this._old_names[m])\r\n            }\r\n        });\r\n        g = \"_getRowData\";\r\n        h[g] = function(r, l) {\r\n            var n = this.obj.data.item(r);\r\n            var o = {\r\n                id: r\r\n            };\r\n            o[this.action_param] = this.obj.getUserData(r);\r\n            if (n) {\r\n                for (var m in n) {\r\n                    o[m] = n[m]\r\n                }\r\n            }\r\n            return o\r\n        }\r\n        ;\r\n        this.changeId = function(m, l) {\r\n            this.data.changeId(m, l);\r\n            h._silent = true;\r\n            this.data.callEvent(\"onStoreUpdated\", [l, this.item(l), \"update\"]);\r\n            h._silent = false\r\n        }\r\n        ;\r\n        g = \"_clearUpdateFlag\";\r\n        h[g] = function() {}\r\n        ;\r\n        this._userdata = {}\r\n    }\r\n    ;\r\n    e.dummy = function() {}\r\n    ;\r\n    e.setUserData = function(l, g, h) {\r\n        this._userdata[l] = h\r\n    }\r\n    ;\r\n    e.getUserData = function(h, g) {\r\n        return this._userdata[h]\r\n    }\r\n    ;\r\n    e.dataFeed = function(g) {\r\n        this.define(\"dataFeed\", g)\r\n    }\r\n    ;\r\n    dhx.extend(e, dhx.BindSource);\r\n    return e\r\n}\r\n;\r\nif (window.dhtmlXDataView) {\r\n    dhtmlXDataView.prototype._initBindSource = function() {\r\n        this.isVisible = function() {\r\n            if (!this.data.order.length && !this.data._filter_order && !this._settings.dataFeed) {\r\n                return false\r\n            }\r\n            return true\r\n        }\r\n        ;\r\n        var a = \"_settings\";\r\n        this._settings = this._settings || this[a];\r\n        if (!this._settings.id) {\r\n            this._settings.id = dhx.uid()\r\n        }\r\n        this.unbind = dhx.BaseBind.unbind;\r\n        this.unsync = dhx.BaseBind.unsync;\r\n        dhx.ui.views[this._settings.id] = this\r\n    }\r\n}\r\nif (window.dhtmlXChart) {\r\n    dhtmlXChart.prototype._initBindSource = function() {\r\n        this.isVisible = function() {\r\n            if (!this.data.order.length && !this.data._filtered_state && !this._settings.dataFeed) {\r\n                return false\r\n            }\r\n            return true\r\n        }\r\n        ;\r\n        var a = \"_settings\";\r\n        this._settings = this._settings || this[a];\r\n        if (!this._settings.id) {\r\n            this._settings.id = dhx.uid()\r\n        }\r\n        this.unbind = dhx.BaseBind.unbind;\r\n        this.unsync = dhx.BaseBind.unsync;\r\n        dhx.ui.views[this._settings.id] = this\r\n    }\r\n}\r\ndhx.BaseBind.unsync = function(a) {\r\n    return dhx.BaseBind._unbind.call(this, a)\r\n}\r\n;\r\ndhx.BaseBind.unbind = function(a) {\r\n    return dhx.BaseBind._unbind.call(this, a)\r\n}\r\n;\r\ndhx.BaseBind.legacyBind = function() {\r\n    return dhx.BaseBind.bind.apply(this, arguments)\r\n}\r\n;\r\ndhx.BaseBind.legacySync = function(a, c) {\r\n    if (this._initBindSource) {\r\n        this._initBindSource()\r\n    }\r\n    if (a._initBindSource) {\r\n        a._initBindSource()\r\n    }\r\n    this.attachEvent(\"onAfterEditStop\", function(e) {\r\n        this.save(e);\r\n        return true\r\n    });\r\n    this.attachEvent(\"onDataRequest\", function(h, g) {\r\n        for (var e = h; e < h + g; e++) {\r\n            if (!a.data.order[e]) {\r\n                a.loadNext(g, h);\r\n                return false\r\n            }\r\n        }\r\n    });\r\n    this.save = function(l) {\r\n        if (!l) {\r\n            l = this.getCursor()\r\n        }\r\n        var h = this.item(l);\r\n        var e = a.item(l);\r\n        for (var g in h) {\r\n            if (g.indexOf(\"$\") !== 0) {\r\n                e[g] = h[g]\r\n            }\r\n        }\r\n        a.refresh(l)\r\n    }\r\n    ;\r\n    if (a && a.name == \"DataCollection\") {\r\n        return a.data.sync.apply(this.data, arguments)\r\n    } else {\r\n        return this.data.sync.apply(this.data, arguments)\r\n    }\r\n}\r\n;\r\nif (window.dhtmlXForm) {\r\n    dhtmlXForm.prototype.bind = function(a) {\r\n        dhx.BaseBind.bind.apply(this, arguments);\r\n        a.getBindData(this._settings.id)\r\n    }\r\n    ;\r\n    dhtmlXForm.prototype.unbind = function(a) {\r\n        dhx.BaseBind._unbind.call(this, a)\r\n    }\r\n    ;\r\n    dhtmlXForm.prototype._initBindSource = function() {\r\n        if (dhx.isUndefined(this._settings)) {\r\n            this._settings = {\r\n                id: dhx.uid(),\r\n                dataFeed: this._server_feed\r\n            };\r\n            dhx.ui.views[this._settings.id] = this\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXForm.prototype._check_data_feed = function(c) {\r\n        if (!this._settings.dataFeed || this._ignore_feed || !c) {\r\n            return true\r\n        }\r\n        var a = this._settings.dataFeed;\r\n        if (typeof a == \"function\") {\r\n            return a.call(this, (c.id || c), c)\r\n        }\r\n        a = a + (a.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"action=get&id=\" + encodeURIComponent(c.id || c);\r\n        this.load(a);\r\n        return false\r\n    }\r\n    ;\r\n    dhtmlXForm.prototype.setValues = dhtmlXForm.prototype.setFormData;\r\n    dhtmlXForm.prototype.getValues = function() {\r\n        return this.getFormData(false, true)\r\n    }\r\n    ;\r\n    dhtmlXForm.prototype.dataFeed = function(a) {\r\n        if (this._settings) {\r\n            this._settings.dataFeed = a\r\n        } else {\r\n            this._server_feed = a\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXForm.prototype.refresh = dhtmlXForm.prototype.isVisible = function(a) {\r\n        return true\r\n    }\r\n}\r\nif (window.scheduler) {\r\n    if (!window.Scheduler) {\r\n        window.Scheduler = {}\r\n    }\r\n    Scheduler.$syncFactory = function(a) {\r\n        a.sync = function(e, h) {\r\n            if (this._initBindSource) {\r\n                this._initBindSource()\r\n            }\r\n            if (e._initBindSource) {\r\n                e._initBindSource()\r\n            }\r\n            var g = \"_process_loading\";\r\n            var c = function(r) {\r\n                a.clearAll();\r\n                var l = e.data.order;\r\n                var o = e.data.pull;\r\n                var m = [];\r\n                for (var n = 0; n < l.length; n++) {\r\n                    if (h && h.copy) {\r\n                        m[n] = dhx.clone(o[l[n]])\r\n                    } else {\r\n                        m[n] = o[l[n]]\r\n                    }\r\n                }\r\n                a[g](m);\r\n                a.callEvent(\"onSyncApply\", [])\r\n            }\r\n            ;\r\n            this.save = function(n) {\r\n                if (!n) {\r\n                    n = this.getCursor()\r\n                }\r\n                var m = this.item(n);\r\n                var l = e.item(n);\r\n                if (this.callEvent(\"onStoreSave\", [n, m, l])) {\r\n                    dhx.extend(e.item(n), m, true);\r\n                    e.update(n)\r\n                }\r\n            }\r\n            ;\r\n            this.item = function(l) {\r\n                return this.getEvent(l)\r\n            }\r\n            ;\r\n            this._sync_events = [e.data.attachEvent(\"onStoreUpdated\", function(n, l, m) {\r\n                c.call(this)\r\n            }), e.data.attachEvent(\"onIdChange\", function(m, l) {\r\n                combo.changeOptionId(m, l)\r\n            })];\r\n            this.attachEvent(\"onEventChanged\", function(l) {\r\n                this.save(l)\r\n            });\r\n            this.attachEvent(\"onEventAdded\", function(m, l) {\r\n                if (!e.data.pull[m]) {\r\n                    e.add(l)\r\n                }\r\n            });\r\n            this.attachEvent(\"onEventDeleted\", function(l) {\r\n                if (e.data.pull[l]) {\r\n                    e.remove(l)\r\n                }\r\n            });\r\n            c()\r\n        }\r\n        ;\r\n        a.unsync = function(c) {\r\n            dhx.BaseBind._unbind.call(this, c)\r\n        }\r\n        ;\r\n        a._initBindSource = function() {\r\n            if (!this._settings) {\r\n                this._settings = {\r\n                    id: dhx.uid()\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    Scheduler.$syncFactory(window.scheduler)\r\n}\r\nif (window.dhtmlXCombo) {\r\n    dhtmlXCombo.prototype.bind = function() {\r\n        dhx.BaseBind.bind.apply(this, arguments)\r\n    }\r\n    ;\r\n    dhtmlXCombo.unbind = function(a) {\r\n        dhx.BaseBind._unbind.call(this, a)\r\n    }\r\n    ;\r\n    dhtmlXCombo.unsync = function(a) {\r\n        dhx.BaseBind._unbind.call(this, a)\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype.dataFeed = function(a) {\r\n        if (this._settings) {\r\n            this._settings.dataFeed = a\r\n        } else {\r\n            this._server_feed = a\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype.sync = function(c, g) {\r\n        if (this._initBindSource) {\r\n            this._initBindSource()\r\n        }\r\n        if (c._initBindSource) {\r\n            c._initBindSource()\r\n        }\r\n        var e = this;\r\n        var a = function(h) {\r\n            e.clearAll();\r\n            e.addOption(this.serialize());\r\n            e.callEvent(\"onSyncApply\", [])\r\n        }\r\n        ;\r\n        this._sync_events = [c.data.attachEvent(\"onStoreUpdated\", function(m, h, l) {\r\n            a.call(this)\r\n        }), c.data.attachEvent(\"onIdChange\", function(l, h) {\r\n            e.changeOptionId(l, h)\r\n        })];\r\n        a.call(c)\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype._initBindSource = function() {\r\n        if (dhx.isUndefined(this._settings)) {\r\n            this._settings = {\r\n                id: dhx.uid(),\r\n                dataFeed: this._server_feed\r\n            };\r\n            dhx.ui.views[this._settings.id] = this;\r\n            this.data = {\r\n                silent: dhx.bind(function(a) {\r\n                    a.call(this)\r\n                }, this)\r\n            };\r\n            dhx4._eventable(this.data);\r\n            this.attachEvent(\"onChange\", function() {\r\n                this.callEvent(\"onSelectChange\", [this.getSelectedValue()])\r\n            });\r\n            this.attachEvent(\"onXLE\", function() {\r\n                this.callEvent(\"onBindRequest\", [])\r\n            })\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype.item = function(a) {\r\n        return this.getOption(a)\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype.getSelected = function() {\r\n        return this.getSelectedValue()\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype.isVisible = function() {\r\n        if (!this.optionsArr.length && !this._settings.dataFeed) {\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    dhtmlXCombo.prototype.refresh = function() {\r\n        this.render(true)\r\n    }\r\n}\r\nif (window.dhtmlXGridObject) {\r\n    dhtmlXGridObject.prototype.bind = function(a, e, c) {\r\n        dhx.BaseBind.bind.apply(this, arguments)\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.unbind = function(a) {\r\n        dhx.BaseBind._unbind.call(this, a)\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.unsync = function(a) {\r\n        dhx.BaseBind._unbind.call(this, a)\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.dataFeed = function(a) {\r\n        if (this._settings) {\r\n            this._settings.dataFeed = a\r\n        } else {\r\n            this._server_feed = a\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.sync = function(a, o) {\r\n        if (this._initBindSource) {\r\n            this._initBindSource()\r\n        }\r\n        if (a._initBindSource) {\r\n            a._initBindSource()\r\n        }\r\n        var c = this;\r\n        var n = \"_parsing\";\r\n        var e = \"_parser\";\r\n        var l = \"_locator\";\r\n        var g = \"_process_store_row\";\r\n        var m = \"_get_store_data\";\r\n        this.save = function(r) {\r\n            if (!r) {\r\n                r = this.getCursor()\r\n            }\r\n            dhx.extend(a.item(r), this.item(r), true);\r\n            a.update(r)\r\n        }\r\n        ;\r\n        var h = function(x) {\r\n            var u = c.getCursor ? c.getCursor() : null ;\r\n            var w = 0;\r\n            if (c._legacy_ignore_next) {\r\n                w = c._legacy_ignore_next;\r\n                c._legacy_ignore_next = false\r\n            } else {\r\n                c.clearAll()\r\n            }\r\n            var s = this.dataCount();\r\n            if (s) {\r\n                c[n] = true;\r\n                for (var r = w; r < s; r++) {\r\n                    var v = this.order[r];\r\n                    if (!v) {\r\n                        continue\r\n                    }\r\n                    if (w && c.rowsBuffer[r]) {\r\n                        continue\r\n                    }\r\n                    c.rowsBuffer[r] = {\r\n                        idd: v,\r\n                        data: this.pull[v]\r\n                    };\r\n                    c.rowsBuffer[r][e] = c[g];\r\n                    c.rowsBuffer[r][l] = c[m];\r\n                    c.rowsAr[v] = this.pull[v]\r\n                }\r\n                if (!c.rowsBuffer[s - 1]) {\r\n                    c.rowsBuffer[s - 1] = dhtmlx.undefined;\r\n                    c.xmlFileUrl = c.xmlFileUrl || this.url\r\n                }\r\n                if (c.pagingOn) {\r\n                    c.changePage()\r\n                } else {\r\n                    if (c._srnd && c._fillers) {\r\n                        c._update_srnd_view()\r\n                    } else {\r\n                        c.render_dataset();\r\n                        c.callEvent(\"onXLE\", [])\r\n                    }\r\n                }\r\n                c[n] = false\r\n            }\r\n            if (u && c.setCursor) {\r\n                c.setCursor(c.rowsAr[u] ? u : null )\r\n            }\r\n            c.callEvent(\"onSyncApply\", [])\r\n        }\r\n        ;\r\n        this._sync_events = [a.data.attachEvent(\"onStoreUpdated\", function(u, r, s) {\r\n            if (s == \"delete\") {\r\n                c.deleteRow(u);\r\n                c.data.callEvent(\"onStoreUpdated\", [u, r, s])\r\n            } else {\r\n                if (s == \"update\") {\r\n                    c.callEvent(\"onSyncUpdate\", [r, s]);\r\n                    c.update(u, r);\r\n                    c.data.callEvent(\"onStoreUpdated\", [u, r, s])\r\n                } else {\r\n                    if (s == \"add\") {\r\n                        c.callEvent(\"onSyncUpdate\", [r, s]);\r\n                        c.add(u, r, this.indexById(u));\r\n                        c.data.callEvent(\"onStoreUpdated\", [u, r, s])\r\n                    } else {\r\n                        h.call(this)\r\n                    }\r\n                }\r\n            }\r\n        }), a.data.attachEvent(\"onStoreLoad\", function(s, r) {\r\n            c.xmlFileUrl = a.data.url;\r\n            c._legacy_ignore_next = s.getInfo(r)._from\r\n        }), a.data.attachEvent(\"onIdChange\", function(s, r) {\r\n            c.changeRowId(s, r)\r\n        })];\r\n        c.attachEvent(\"onDynXLS\", function(u, s) {\r\n            for (var r = u; r < u + s; r++) {\r\n                if (!a.data.order[r]) {\r\n                    a.loadNext(s, u);\r\n                    return false\r\n                }\r\n            }\r\n            c._legacy_ignore_next = u;\r\n            h.call(a.data)\r\n        });\r\n        h.call(a.data);\r\n        c.attachEvent(\"onEditCell\", function(r, w, u, s, v) {\r\n            if (r == 2 && s != v) {\r\n                this.save(w)\r\n            }\r\n            return true\r\n        });\r\n        c.attachEvent(\"onClearAll\", function() {\r\n            var r = \"_f_rowsBuffer\";\r\n            this[r] = null \r\n        });\r\n        if (o && o.sort) {\r\n            c.attachEvent(\"onBeforeSorting\", function(u, s, r) {\r\n                if (s == \"connector\") {\r\n                    return false\r\n                }\r\n                var v = this.getColumnId(u);\r\n                a.sort(\"#\" + v + \"#\", (r == \"asc\" ? \"asc\" : \"desc\"), (s == \"int\" ? s : \"string\"));\r\n                c.setSortImgState(true, u, r);\r\n                return false\r\n            })\r\n        }\r\n        if (o && o.filter) {\r\n            c.attachEvent(\"onFilterStart\", function(u, r) {\r\n                var s = \"_con_f_used\";\r\n                if (c[s] && c[s].length) {\r\n                    return false\r\n                }\r\n                a.data.silent(function() {\r\n                    a.filter();\r\n                    for (var v = 0; v < u.length; v++) {\r\n                        if (r[v] == \"\") {\r\n                            continue\r\n                        }\r\n                        var w = c.getColumnId(u[v]);\r\n                        a.filter(\"#\" + w + \"#\", r[v], v != 0)\r\n                    }\r\n                });\r\n                a.refresh();\r\n                return false\r\n            });\r\n            c.collectValues = function(r) {\r\n                var s = this.getColumnId(r);\r\n                return (function(w) {\r\n                    var u = [];\r\n                    var v = {};\r\n                    this.data.each(function(y) {\r\n                        var x = y[w];\r\n                        if (!v[x]) {\r\n                            v[x] = true;\r\n                            u.push(x)\r\n                        }\r\n                    });\r\n                    u.sort();\r\n                    return u\r\n                }\r\n                ).call(a, s)\r\n            }\r\n        }\r\n        if (o && o.select) {\r\n            c.attachEvent(\"onRowSelect\", function(r) {\r\n                a.setCursor(r)\r\n            })\r\n        }\r\n        c.clearAndLoad = function(r) {\r\n            a.clearAll();\r\n            a.load(r)\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype._initBindSource = function() {\r\n        if (dhx.isUndefined(this._settings)) {\r\n            this._settings = {\r\n                id: dhx.uid(),\r\n                dataFeed: this._server_feed\r\n            };\r\n            dhx.ui.views[this._settings.id] = this;\r\n            this.data = {\r\n                silent: dhx.bind(function(e) {\r\n                    e.call(this)\r\n                }, this)\r\n            };\r\n            dhx4._eventable(this.data);\r\n            var a = \"_cCount\";\r\n            for (var c = 0; c < this[a]; c++) {\r\n                if (!this.columnIds[c]) {\r\n                    this.columnIds[c] = \"cell\" + c\r\n                }\r\n            }\r\n            this.attachEvent(\"onSelectStateChanged\", function(e) {\r\n                this.callEvent(\"onSelectChange\", [e])\r\n            });\r\n            this.attachEvent(\"onSelectionCleared\", function() {\r\n                this.callEvent(\"onSelectChange\", [null ])\r\n            });\r\n            this.attachEvent(\"onEditCell\", function(e, g) {\r\n                if (e === 2 && this.getCursor) {\r\n                    if (g && g == this.getCursor()) {\r\n                        this._update_binds()\r\n                    }\r\n                }\r\n                return true\r\n            });\r\n            this.attachEvent(\"onXLE\", function() {\r\n                this.callEvent(\"onBindRequest\", [])\r\n            })\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.item = function(l) {\r\n        if (l === null ) {\r\n            return null \r\n        }\r\n        var h = this.getRowById(l);\r\n        if (!h) {\r\n            return null \r\n        }\r\n        var a = \"_attrs\";\r\n        var g = dhx.copy(h[a]);\r\n        g.id = l;\r\n        var e = this.getColumnsNum();\r\n        for (var c = 0; c < e; c++) {\r\n            g[this.columnIds[c]] = this.cells(l, c).getValue()\r\n        }\r\n        return g\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.update = function(l, h) {\r\n        for (var g = 0; g < this.columnIds.length; g++) {\r\n            var e = this.columnIds[g];\r\n            if (!dhx.isUndefined(h[e])) {\r\n                this.cells(l, g).setValue(h[e])\r\n            }\r\n        }\r\n        var c = \"_attrs\";\r\n        var a = this.getRowById(l)[c];\r\n        for (var e in h) {\r\n            a[e] = h[e]\r\n        }\r\n        this.callEvent(\"onBindUpdate\", [l])\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.add = function(m, l, e) {\r\n        var a = [];\r\n        for (var h = 0; h < this.columnIds.length; h++) {\r\n            var g = this.columnIds[h];\r\n            a[h] = dhx.isUndefined(l[g]) ? \"\" : l[g]\r\n        }\r\n        this.addRow(m, a, e);\r\n        var c = \"_attrs\";\r\n        this.getRowById(m)[c] = dhx.copy(l)\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.getSelected = function() {\r\n        return this.getSelectedRowId()\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.isVisible = function() {\r\n        var a = \"_f_rowsBuffer\";\r\n        if (!this.rowsBuffer.length && !this[a] && !this._settings.dataFeed) {\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.refresh = function() {\r\n        this.render_dataset()\r\n    }\r\n    ;\r\n    dhtmlXGridObject.prototype.filter = function(l, h) {\r\n        if (this._settings.dataFeed) {\r\n            var g = {};\r\n            if (!l && !h) {\r\n                return\r\n            }\r\n            if (typeof l == \"function\") {\r\n                if (!h) {\r\n                    return\r\n                }\r\n                l(h, g)\r\n            } else {\r\n                if (dhx.isUndefined(l)) {\r\n                    g = h\r\n                } else {\r\n                    g[l] = h\r\n                }\r\n            }\r\n            this.clearAll();\r\n            var a = this._settings.dataFeed;\r\n            if (typeof a == \"function\") {\r\n                return a.call(this, h, g)\r\n            }\r\n            var e = [];\r\n            for (var c in g) {\r\n                e.push(\"dhx_filter[\" + c + \"]=\" + encodeURIComponent(g[c]))\r\n            }\r\n            this.load(a + (a.indexOf(\"?\") < 0 ? \"?\" : \"&\") + e.join(\"&\"));\r\n            return false\r\n        }\r\n        if (h === null ) {\r\n            return this.filterBy(0, function() {\r\n                return false\r\n            })\r\n        }\r\n        this.filterBy(0, function(m, n) {\r\n            return l.call(this, n, h)\r\n        })\r\n    }\r\n}\r\nif (window.dhtmlXTreeObject) {\r\n    dhtmlXTreeObject.prototype.bind = function() {\r\n        dhx.BaseBind.bind.apply(this, arguments)\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.unbind = function(a) {\r\n        dhx.BaseBind._unbind.call(this, a)\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.dataFeed = function(a) {\r\n        if (this._settings) {\r\n            this._settings.dataFeed = a\r\n        } else {\r\n            this._server_feed = a\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype._initBindSource = function() {\r\n        if (dhx.isUndefined(this._settings)) {\r\n            this._settings = {\r\n                id: dhx.uid(),\r\n                dataFeed: this._server_feed\r\n            };\r\n            dhx.ui.views[this._settings.id] = this;\r\n            this.data = {\r\n                silent: dhx.bind(function(a) {\r\n                    a.call(this)\r\n                }, this)\r\n            };\r\n            dhx4._eventable(this.data);\r\n            this.attachEvent(\"onSelect\", function(a) {\r\n                this.callEvent(\"onSelectChange\", [a])\r\n            });\r\n            this.attachEvent(\"onEdit\", function(a, c) {\r\n                if (a === 2) {\r\n                    if (c && c == this.getCursor()) {\r\n                        this._update_binds()\r\n                    }\r\n                }\r\n                return true\r\n            })\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.item = function(a) {\r\n        if (a === null ) {\r\n            return null \r\n        }\r\n        return {\r\n            id: a,\r\n            text: this.getItemText(a)\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.getSelected = function() {\r\n        return this.getSelectedItemId()\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.isVisible = function() {\r\n        return true\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.refresh = function() {}\r\n    ;\r\n    dhtmlXTreeObject.prototype.filter = function(l, h) {\r\n        if (this._settings.dataFeed) {\r\n            var g = {};\r\n            if (!l && !h) {\r\n                return\r\n            }\r\n            if (typeof l == \"function\") {\r\n                if (!h) {\r\n                    return\r\n                }\r\n                l(h, g)\r\n            } else {\r\n                if (dhx.isUndefined(l)) {\r\n                    g = h\r\n                } else {\r\n                    g[l] = h\r\n                }\r\n            }\r\n            this.deleteChildItems(0);\r\n            var a = this._settings.dataFeed;\r\n            if (typeof a == \"function\") {\r\n                return a.call(this, [(data.id || data), data])\r\n            }\r\n            var e = [];\r\n            for (var c in g) {\r\n                e.push(\"dhx_filter[\" + c + \"]=\" + encodeURIComponent(g[c]))\r\n            }\r\n            this.loadXML(a + (a.indexOf(\"?\") < 0 ? \"?\" : \"&\") + e.join(\"&\"));\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    dhtmlXTreeObject.prototype.update = function(c, a) {\r\n        if (!dhx.isUndefined(a.text)) {\r\n            this.setItemText(c, a.text)\r\n        }\r\n    }\r\n}\r\nfunction dataProcessor(a) {\r\n    this.serverProcessor = a;\r\n    this.action_param = \"!nativeeditor_status\";\r\n    this.object = null ;\r\n    this.updatedRows = [];\r\n    this.autoUpdate = true;\r\n    this.updateMode = \"cell\";\r\n    this._tMode = \"GET\";\r\n    this._headers = null ;\r\n    this._payload = null ;\r\n    this.post_delim = \"_\";\r\n    this._waitMode = 0;\r\n    this._in_progress = {};\r\n    this._invalid = {};\r\n    this.mandatoryFields = [];\r\n    this.messages = [];\r\n    this.styles = {\r\n        updated: \"font-weight:bold;\",\r\n        inserted: \"font-weight:bold;\",\r\n        deleted: \"text-decoration : line-through;\",\r\n        invalid: \"background-color:FFE0E0;\",\r\n        invalid_cell: \"border-bottom:2px solid red;\",\r\n        error: \"color:red;\",\r\n        clear: \"font-weight:normal;text-decoration:none;\"\r\n    };\r\n    this.enableUTFencoding(true);\r\n    dhx4._eventable(this);\r\n    if (this.connector_init) {\r\n        this.setTransactionMode(\"POST\", true);\r\n        this.serverProcessor += (this.serverProcessor.indexOf(\"?\") != -1 ? \"&\" : \"?\") + \"editing=true\"\r\n    }\r\n    return this\r\n}\r\ndataProcessor.prototype = {\r\n    setTransactionMode: function(c, a) {\r\n        if (typeof c == \"object\") {\r\n            this._tMode = c.mode || this._tMode;\r\n            this._headers = this._headers || c.headers;\r\n            this._payload = this._payload || c.payload\r\n        } else {\r\n            this._tMode = c;\r\n            this._tSend = a\r\n        }\r\n        if (this._tMode == \"REST\") {\r\n            this._tSend = false;\r\n            this._endnm = true\r\n        }\r\n    },\r\n    escape: function(a) {\r\n        if (this._utf) {\r\n            return encodeURIComponent(a)\r\n        } else {\r\n            return escape(a)\r\n        }\r\n    },\r\n    enableUTFencoding: function(a) {\r\n        this._utf = dhx4.s2b(a)\r\n    },\r\n    setDataColumns: function(a) {\r\n        this._columns = (typeof a == \"string\") ? a.split(\",\") : a\r\n    },\r\n    getSyncState: function() {\r\n        return !this.updatedRows.length\r\n    },\r\n    enableDataNames: function(a) {\r\n        this._endnm = dhx4.s2b(a)\r\n    },\r\n    enablePartialDataSend: function(a) {\r\n        this._changed = dhx4.s2b(a)\r\n    },\r\n    setUpdateMode: function(c, a) {\r\n        this.autoUpdate = (c == \"cell\");\r\n        this.updateMode = c;\r\n        this.dnd = a\r\n    },\r\n    ignore: function(c, a) {\r\n        this._silent_mode = true;\r\n        c.call(a || window);\r\n        this._silent_mode = false\r\n    },\r\n    setUpdated: function(g, e, h) {\r\n        if (this._silent_mode) {\r\n            return\r\n        }\r\n        var c = this.findRow(g);\r\n        h = h || \"updated\";\r\n        var a = this.obj.getUserData(g, this.action_param);\r\n        if (a && h == \"updated\") {\r\n            h = a\r\n        }\r\n        if (e) {\r\n            this.set_invalid(g, false);\r\n            this.updatedRows[c] = g;\r\n            this.obj.setUserData(g, this.action_param, h);\r\n            if (this._in_progress[g]) {\r\n                this._in_progress[g] = \"wait\"\r\n            }\r\n        } else {\r\n            if (!this.is_invalid(g)) {\r\n                this.updatedRows.splice(c, 1);\r\n                this.obj.setUserData(g, this.action_param, \"\")\r\n            }\r\n        }\r\n        if (!e) {\r\n            this._clearUpdateFlag(g)\r\n        }\r\n        this.markRow(g, e, h);\r\n        if (e && this.autoUpdate) {\r\n            this.sendData(g)\r\n        }\r\n    },\r\n    _clearUpdateFlag: function(a) {},\r\n    markRow: function(l, e, h) {\r\n        var g = \"\";\r\n        var c = this.is_invalid(l);\r\n        if (c) {\r\n            g = this.styles[c];\r\n            e = true\r\n        }\r\n        if (this.callEvent(\"onRowMark\", [l, e, h, c])) {\r\n            g = this.styles[e ? h : \"clear\"] + g;\r\n            this.obj[this._methods[0]](l, g);\r\n            if (c && c.details) {\r\n                g += this.styles[c + \"_cell\"];\r\n                for (var a = 0; a < c.details.length; a++) {\r\n                    if (c.details[a]) {\r\n                        this.obj[this._methods[1]](l, a, g)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    getState: function(a) {\r\n        return this.obj.getUserData(a, this.action_param)\r\n    },\r\n    is_invalid: function(a) {\r\n        return this._invalid[a]\r\n    },\r\n    set_invalid: function(e, c, a) {\r\n        if (a) {\r\n            c = {\r\n                value: c,\r\n                details: a,\r\n                toString: function() {\r\n                    return this.value.toString()\r\n                }\r\n            }\r\n        }\r\n        this._invalid[e] = c\r\n    },\r\n    checkBeforeUpdate: function(a) {\r\n        return true\r\n    },\r\n    sendData: function(a) {\r\n        if (this._waitMode && (this.obj.mytype == \"tree\" || this.obj._h2)) {\r\n            return\r\n        }\r\n        if (this.obj.editStop) {\r\n            this.obj.editStop()\r\n        }\r\n        if (typeof a == \"undefined\" || this._tSend) {\r\n            return this.sendAllData()\r\n        }\r\n        if (this._in_progress[a]) {\r\n            return false\r\n        }\r\n        this.messages = [];\r\n        if (this.getState(a) !== \"deleted\") {\r\n            if (!this.checkBeforeUpdate(a) && this.callEvent(\"onValidationError\", [a, this.messages])) {\r\n                return false\r\n            }\r\n        }\r\n        this._beforeSendData(this._getRowData(a), a)\r\n    },\r\n    _beforeSendData: function(a, c) {\r\n        if (!this.callEvent(\"onBeforeUpdate\", [c, this.getState(c), a])) {\r\n            return false\r\n        }\r\n        this._sendData(a, c)\r\n    },\r\n    serialize: function(g, h) {\r\n        if (typeof g == \"string\") {\r\n            return g\r\n        }\r\n        if (typeof h != \"undefined\") {\r\n            return this.serialize_one(g, \"\")\r\n        } else {\r\n            var a = [];\r\n            var e = [];\r\n            for (var c in g) {\r\n                if (g.hasOwnProperty(c)) {\r\n                    a.push(this.serialize_one(g[c], c + this.post_delim));\r\n                    e.push(c)\r\n                }\r\n            }\r\n            a.push(\"ids=\" + this.escape(e.join(\",\")));\r\n            if (dhtmlx.security_key) {\r\n                a.push(\"dhx_security=\" + dhtmlx.security_key)\r\n            }\r\n            return a.join(\"&\")\r\n        }\r\n    },\r\n    serialize_one: function(g, c) {\r\n        if (typeof g == \"string\") {\r\n            return g\r\n        }\r\n        var a = [];\r\n        for (var e in g) {\r\n            if (g.hasOwnProperty(e)) {\r\n                if ((e == \"id\" || e == this.action_param) && this._tMode == \"REST\") {\r\n                    continue\r\n                }\r\n                a.push(this.escape((c || \"\") + e) + \"=\" + this.escape(g[e]))\r\n            }\r\n        }\r\n        return a.join(\"&\")\r\n    },\r\n    _sendData: function(h, l) {\r\n        if (!h) {\r\n            return\r\n        }\r\n        if (!this.callEvent(\"onBeforeDataSending\", l ? [l, this.getState(l), h] : [null , null , h])) {\r\n            return false\r\n        }\r\n        if (l) {\r\n            this._in_progress[l] = (new Date()).valueOf()\r\n        }\r\n        var r = this;\r\n        var o = function(u) {\r\n            var w = [];\r\n            if (l) {\r\n                w.push(l)\r\n            } else {\r\n                if (h) {\r\n                    for (var v in h) {\r\n                        w.push(v)\r\n                    }\r\n                }\r\n            }\r\n            return r.afterUpdate(r, u, w)\r\n        }\r\n        ;\r\n        var c = this.serverProcessor + (this._user ? (dhtmlx.url(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + this.obj.getUserData(0, \"version\")].join(\"&\")) : \"\");\r\n        if (this._tMode == \"GET\") {\r\n            dhx4.ajax.get(c + ((c.indexOf(\"?\") != -1) ? \"&\" : \"?\") + this.serialize(h, l), o)\r\n        } else {\r\n            if (this._tMode == \"POST\") {\r\n                dhx4.ajax.post(c, this.serialize(h, l), o)\r\n            } else {\r\n                if (this._tMode == \"REST\") {\r\n                    var e = this.getState(l);\r\n                    var g = c.replace(/(\\&|\\?)editing\\=true/, \"\");\r\n                    var m = g.split(\"?\");\r\n                    if (m[1]) {\r\n                        m[1] = \"?\" + m[1]\r\n                    }\r\n                    var n = \"\";\r\n                    var a = \"post\";\r\n                    if (e == \"inserted\") {\r\n                        n = this.serialize(h, l)\r\n                    } else {\r\n                        if (e == \"deleted\") {\r\n                            a = \"DELETE\";\r\n                            g = m[0] + l + (m[1] || \"\")\r\n                        } else {\r\n                            a = \"PUT\";\r\n                            n = this.serialize(h, l);\r\n                            g = m[0] + l + (m[1] || \"\")\r\n                        }\r\n                    }\r\n                    if (this._payload) {\r\n                        for (var s in this._payload) {\r\n                            g = g + (g.indexOf(\"?\") === -1 ? \"?\" : \"&\") + this.escape(s) + \"=\" + this.escape(this._payload[s])\r\n                        }\r\n                    }\r\n                    dhx4.ajax.query({\r\n                        url: g,\r\n                        method: a,\r\n                        headers: this._headers,\r\n                        data: n,\r\n                        callback: o\r\n                    })\r\n                }\r\n            }\r\n        }\r\n        this._waitMode++\r\n    },\r\n    sendAllData: function() {\r\n        if (!this.updatedRows.length) {\r\n            return\r\n        }\r\n        this.messages = [];\r\n        var c = true;\r\n        for (var a = 0; a < this.updatedRows.length; a++) {\r\n            if (this.getState(this.updatedRows[a]) !== \"deleted\") {\r\n                c &= this.checkBeforeUpdate(this.updatedRows[a])\r\n            }\r\n        }\r\n        if (!c && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\r\n            return false\r\n        }\r\n        if (this._tSend) {\r\n            this._sendData(this._getAllData())\r\n        } else {\r\n            for (var a = 0; a < this.updatedRows.length; a++) {\r\n                if (!this._in_progress[this.updatedRows[a]]) {\r\n                    if (this.is_invalid(this.updatedRows[a])) {\r\n                        continue\r\n                    }\r\n                    this._beforeSendData(this._getRowData(this.updatedRows[a]), this.updatedRows[a]);\r\n                    if (this._waitMode && (this.obj.mytype == \"tree\" || this.obj._h2)) {\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _getAllData: function(g) {\r\n        var c = {};\r\n        var a = false;\r\n        for (var e = 0; e < this.updatedRows.length; e++) {\r\n            var h = this.updatedRows[e];\r\n            if (this._in_progress[h] || this.is_invalid(h)) {\r\n                continue\r\n            }\r\n            if (!this.callEvent(\"onBeforeUpdate\", [h, this.getState(h), this._getRowData(h)])) {\r\n                continue\r\n            }\r\n            c[h] = this._getRowData(h, h + this.post_delim);\r\n            a = true;\r\n            this._in_progress[h] = (new Date()).valueOf()\r\n        }\r\n        return a ? c : null \r\n    },\r\n    setVerificator: function(c, a) {\r\n        this.mandatoryFields[c] = a || (function(e) {\r\n            return ( e !== \"\") \r\n        }\r\n        )\r\n    },\r\n    clearVerificator: function(a) {\r\n        this.mandatoryFields[a] = false\r\n    },\r\n    findRow: function(c) {\r\n        var a = 0;\r\n        for (a = 0; a < this.updatedRows.length; a++) {\r\n            if (c == this.updatedRows[a]) {\r\n                break\r\n            }\r\n        }\r\n        return a\r\n    },\r\n    defineAction: function(a, c) {\r\n        if (!this._uActions) {\r\n            this._uActions = []\r\n        }\r\n        this._uActions[a] = c\r\n    },\r\n    afterUpdateCallback: function(c, m, l, h) {\r\n        var a = c;\r\n        var g = (l != \"error\" && l != \"invalid\");\r\n        if (!g) {\r\n            this.set_invalid(c, l)\r\n        }\r\n        if ((this._uActions) && (this._uActions[l]) && (!this._uActions[l](h))) {\r\n            return ( delete this._in_progress[a]) \r\n        }\r\n        if (this._in_progress[a] != \"wait\") {\r\n            this.setUpdated(c, false)\r\n        }\r\n        var e = c;\r\n        switch (l) {\r\n        case \"inserted\":\r\n        case \"insert\":\r\n            if (m != c) {\r\n                this.obj[this._methods[2]](c, m);\r\n                c = m\r\n            }\r\n            break;\r\n        case \"delete\":\r\n        case \"deleted\":\r\n            this.obj.setUserData(c, this.action_param, \"true_deleted\");\r\n            this.obj[this._methods[3]](c);\r\n            delete this._in_progress[a];\r\n            return this.callEvent(\"onAfterUpdate\", [c, l, m, h]);\r\n            break\r\n        }\r\n        if (this._in_progress[a] != \"wait\") {\r\n            if (g) {\r\n                this.obj.setUserData(c, this.action_param, \"\")\r\n            }\r\n            delete this._in_progress[a]\r\n        } else {\r\n            delete this._in_progress[a];\r\n            this.setUpdated(m, true, this.obj.getUserData(c, this.action_param))\r\n        }\r\n        this.callEvent(\"onAfterUpdate\", [e, l, m, h])\r\n    },\r\n    afterUpdate: function(o, n, a) {\r\n        if (window.JSON) {\r\n            try {\r\n                var v = JSON.parse(n.xmlDoc.responseText);\r\n                var h = v.action || this.getState(a) || \"updated\";\r\n                var c = v.sid || a[0];\r\n                var g = v.tid || a[0];\r\n                o.afterUpdateCallback(c, g, h, v);\r\n                o.finalizeUpdate();\r\n                return\r\n            } catch (r) {}\r\n        }\r\n        var u = dhx4.ajax.xmltop(\"data\", n.xmlDoc);\r\n        if (!u || u.tagName == \"DIV\") {\r\n            return this.cleanUpdate(a)\r\n        }\r\n        var s = dhx4.ajax.xpath(\"//data/action\", u);\r\n        if (!s.length) {\r\n            return this.cleanUpdate(a)\r\n        }\r\n        for (var m = 0; m < s.length; m++) {\r\n            var l = s[m];\r\n            var h = l.getAttribute(\"type\");\r\n            var c = l.getAttribute(\"sid\");\r\n            var g = l.getAttribute(\"tid\");\r\n            o.afterUpdateCallback(c, g, h, l)\r\n        }\r\n        o.finalizeUpdate()\r\n    },\r\n    cleanUpdate: function(c) {\r\n        if (c) {\r\n            for (var a = 0; a < c.length; a++) {\r\n                delete this._in_progress[c[a]]\r\n            }\r\n        }\r\n    },\r\n    finalizeUpdate: function() {\r\n        if (this._waitMode) {\r\n            this._waitMode--\r\n        }\r\n        if ((this.obj.mytype == \"tree\" || this.obj._h2) && this.updatedRows.length) {\r\n            this.sendData()\r\n        }\r\n        this.callEvent(\"onAfterUpdateFinish\", []);\r\n        if (!this.updatedRows.length) {\r\n            this.callEvent(\"onFullSync\", [])\r\n        }\r\n    },\r\n    init: function(a) {\r\n        this.obj = a;\r\n        if (a._dp_init) {\r\n            a._dp_init(this)\r\n        }\r\n        if (this.connector_init) {\r\n            a._dataprocessor = this\r\n        }\r\n    },\r\n    setOnAfterUpdate: function(a) {\r\n        this.attachEvent(\"onAfterUpdate\", a)\r\n    },\r\n    enableDebug: function(a) {},\r\n    setOnBeforeUpdateHandler: function(a) {\r\n        this.attachEvent(\"onBeforeDataSending\", a)\r\n    },\r\n    setAutoUpdate: function(e, c) {\r\n        e = e || 2000;\r\n        this._user = c || (new Date()).valueOf();\r\n        this._need_update = false;\r\n        this._update_busy = false;\r\n        this.attachEvent(\"onAfterUpdate\", function(g, l, m, h) {\r\n            this.afterAutoUpdate(g, l, m, h)\r\n        });\r\n        this.attachEvent(\"onFullSync\", function() {\r\n            this.fullSync()\r\n        });\r\n        var a = this;\r\n        window.setInterval(function() {\r\n            a.loadUpdate()\r\n        }, e)\r\n    },\r\n    afterAutoUpdate: function(a, e, g, c) {\r\n        if (e == \"collision\") {\r\n            this._need_update = true;\r\n            return false\r\n        } else {\r\n            return true\r\n        }\r\n    },\r\n    fullSync: function() {\r\n        if (this._need_update == true) {\r\n            this._need_update = false;\r\n            this.loadUpdate()\r\n        }\r\n        return true\r\n    },\r\n    getUpdates: function(a, c) {\r\n        if (this._update_busy) {\r\n            return false\r\n        } else {\r\n            this._update_busy = true\r\n        }\r\n        dhx4.ajax.get(a, c)\r\n    },\r\n    _v: function(a) {\r\n        if (a.firstChild) {\r\n            return a.firstChild.nodeValue\r\n        }\r\n        return \"\"\r\n    },\r\n    _a: function(a) {\r\n        var e = [];\r\n        for (var c = 0; c < a.length; c++) {\r\n            e[c] = this._v(a[c])\r\n        }\r\n        return e\r\n    },\r\n    loadUpdate: function() {\r\n        var c = this;\r\n        var a = this.obj.getUserData(0, \"version\");\r\n        var e = this.serverProcessor + dhtmlx.url(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + a].join(\"&\");\r\n        e = e.replace(\"editing=true&\", \"\");\r\n        this.getUpdates(e, function(o) {\r\n            var s = dhx4.ajax.xmltop(\"updates\", o.xmlDoc);\r\n            var l = dhx4.ajax.xpath(\"//userdata\", s);\r\n            c.obj.setUserData(0, \"version\", c._v(l[0]));\r\n            var g = dhx4.ajax.xpath(\"//update\", s);\r\n            if (g.length) {\r\n                c._silent_mode = true;\r\n                for (var m = 0; m < g.length; m++) {\r\n                    var h = g[m].getAttribute(\"status\");\r\n                    var u = g[m].getAttribute(\"id\");\r\n                    var n = g[m].getAttribute(\"parent\");\r\n                    switch (h) {\r\n                    case \"inserted\":\r\n                        c.callEvent(\"insertCallback\", [g[m], u, n]);\r\n                        break;\r\n                    case \"updated\":\r\n                        c.callEvent(\"updateCallback\", [g[m], u, n]);\r\n                        break;\r\n                    case \"deleted\":\r\n                        c.callEvent(\"deleteCallback\", [g[m], u, n]);\r\n                        break\r\n                    }\r\n                }\r\n                c._silent_mode = false\r\n            }\r\n            c._update_busy = false;\r\n            c = null \r\n        })\r\n    }\r\n};\r\nif (window.dataProcessor && !dataProcessor.prototype.init_original) {\r\n    dataProcessor.prototype.connector_init = true\r\n}\r\n;"

/***/ },
/* 5 */
/*!***********************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxvault.js ***!
  \***********************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\nProduct Name: dhtmlxVault \r\nVersion: 2.4 \r\nEdition: Professional \r\nLicense: content of this file is covered by DHTMLX Commercial or Enterprise license. Usage without proper license is prohibited. To obtain it contact sales@dhtmlx.com\r\nCopyright UAB Dinamenta http://www.dhtmlx.com\r\n*/\r\n\r\nif (typeof (window.dhx4) == \"undefined\") {\r\n    window.dhx4 = {\r\n        version: \"4.1.2\",\r\n        skin: null ,\r\n        skinDetect: function(a) {\r\n            return {\r\n                10: \"dhx_skyblue\",\r\n                20: \"dhx_web\",\r\n                30: \"dhx_terrace\"\r\n            }[this.readFromCss(a + \"_skin_detect\")] || null \r\n        },\r\n        readFromCss: function(c, d) {\r\n            var b = document.createElement(\"DIV\");\r\n            b.className = c;\r\n            if (document.body.firstChild != null ) {\r\n                document.body.insertBefore(b, document.body.firstChild)\r\n            } else {\r\n                document.body.appendChild(b)\r\n            }\r\n            var a = b[d || \"offsetWidth\"];\r\n            b.parentNode.removeChild(b);\r\n            b = null ;\r\n            return a\r\n        },\r\n        lastId: 1,\r\n        newId: function() {\r\n            return this.lastId++\r\n        },\r\n        zim: {\r\n            data: {},\r\n            step: 5,\r\n            first: function() {\r\n                return 100\r\n            },\r\n            last: function() {\r\n                var c = this.first();\r\n                for (var b in this.data) {\r\n                    c = Math.max(c, this.data[b])\r\n                }\r\n                return c\r\n            },\r\n            reserve: function(a) {\r\n                this.data[a] = this.last() + this.step;\r\n                return this.data[a]\r\n            },\r\n            clear: function(a) {\r\n                if (this.data[a] != null ) {\r\n                    this.data[a] = null ;\r\n                    delete this.data[a]\r\n                }\r\n            }\r\n        },\r\n        s2b: function(a) {\r\n            if (typeof (a) == \"string\") {\r\n                a = a.toLowerCase()\r\n            }\r\n            return ( a == true || a == 1 || a == \"true\" || a == \"1\" || a == \"yes\" || a == \"y\") \r\n        },\r\n        s2j: function(s) {\r\n            var obj = null ;\r\n            dhx4.temp = null ;\r\n            try {\r\n                eval(\"dhx4.temp=\" + s)\r\n            } catch (e) {\r\n                dhx4.temp = null \r\n            }\r\n            obj = dhx4.temp;\r\n            dhx4.temp = null ;\r\n            return obj\r\n        },\r\n        absLeft: function(a) {\r\n            if (typeof (a) == \"string\") {\r\n                a = document.getElementById(a)\r\n            }\r\n            return this.getOffset(a).left\r\n        },\r\n        absTop: function(a) {\r\n            if (typeof (a) == \"string\") {\r\n                a = document.getElementById(a)\r\n            }\r\n            return this.getOffset(a).top\r\n        },\r\n        _aOfs: function(a) {\r\n            var c = 0\r\n              , b = 0;\r\n            while (a) {\r\n                c = c + parseInt(a.offsetTop);\r\n                b = b + parseInt(a.offsetLeft);\r\n                a = a.offsetParent\r\n            }\r\n            return {\r\n                top: c,\r\n                left: b\r\n            }\r\n        },\r\n        _aOfsRect: function(d) {\r\n            var g = d.getBoundingClientRect();\r\n            var h = document.body;\r\n            var b = document.documentElement;\r\n            var a = window.pageYOffset || b.scrollTop || h.scrollTop;\r\n            var e = window.pageXOffset || b.scrollLeft || h.scrollLeft;\r\n            var f = b.clientTop || h.clientTop || 0;\r\n            var i = b.clientLeft || h.clientLeft || 0;\r\n            var j = g.top + a - f;\r\n            var c = g.left + e - i;\r\n            return {\r\n                top: Math.round(j),\r\n                left: Math.round(c)\r\n            }\r\n        },\r\n        getOffset: function(a) {\r\n            if (a.getBoundingClientRect) {\r\n                return this._aOfsRect(a)\r\n            } else {\r\n                return this._aOfs(a)\r\n            }\r\n        },\r\n        _isObj: function(a) {\r\n            return ( a != null  && typeof (a) == \"object\" && typeof (a.length) == \"undefined\") \r\n        },\r\n        _copyObj: function(d) {\r\n            if (this._isObj(d)) {\r\n                var c = {};\r\n                for (var b in d) {\r\n                    if (typeof (d[b]) == \"object\" && d[b] != null ) {\r\n                        c[b] = this._copyObj(d[b])\r\n                    } else {\r\n                        c[b] = d[b]\r\n                    }\r\n                }\r\n            } else {\r\n                var c = [];\r\n                for (var b = 0; b < d.length; b++) {\r\n                    if (typeof (d[b]) == \"object\" && d[b] != null ) {\r\n                        c[b] = this._copyObj(d[b])\r\n                    } else {\r\n                        c[b] = d[b]\r\n                    }\r\n                }\r\n            }\r\n            return c\r\n        },\r\n        screenDim: function() {\r\n            var a = (navigator.userAgent.indexOf(\"MSIE\") >= 0);\r\n            var b = {};\r\n            b.left = document.body.scrollLeft;\r\n            b.right = b.left + (window.innerWidth || document.body.clientWidth);\r\n            b.top = Math.max((a ? document.documentElement : document.getElementsByTagName(\"html\")[0]).scrollTop, document.body.scrollTop);\r\n            b.bottom = b.top + (a ? Math.max(document.documentElement.clientHeight || 0, document.documentElement.offsetHeight || 0) : window.innerHeight);\r\n            return b\r\n        },\r\n        selectTextRange: function(d, g, b) {\r\n            d = (typeof (d) == \"string\" ? document.getElementById(d) : d);\r\n            var a = d.value.length;\r\n            g = Math.max(Math.min(g, a), 0);\r\n            b = Math.min(b, a);\r\n            if (d.setSelectionRange) {\r\n                try {\r\n                    d.setSelectionRange(g, b)\r\n                } catch (f) {}\r\n            } else {\r\n                if (d.createTextRange) {\r\n                    var c = d.createTextRange();\r\n                    c.moveStart(\"character\", g);\r\n                    c.moveEnd(\"character\", b - a);\r\n                    try {\r\n                        c.select()\r\n                    } catch (f) {}\r\n                }\r\n            }\r\n        },\r\n        transData: null ,\r\n        transDetect: function() {\r\n            if (this.transData == null ) {\r\n                this.transData = {\r\n                    transProp: false,\r\n                    transEv: null \r\n                };\r\n                var c = {\r\n                    MozTransition: \"transitionend\",\r\n                    WebkitTransition: \"webkitTransitionEnd\",\r\n                    OTransition: \"oTransitionEnd\",\r\n                    msTransition: \"transitionend\",\r\n                    transition: \"transitionend\"\r\n                };\r\n                for (var b in c) {\r\n                    if (this.transData.transProp == false && document.documentElement.style[b] != null ) {\r\n                        this.transData.transProp = b;\r\n                        this.transData.transEv = c[b]\r\n                    }\r\n                }\r\n                c = null \r\n            }\r\n            return this.transData\r\n        },\r\n        _xmlNodeValue: function(a) {\r\n            var c = \"\";\r\n            for (var b = 0; b < a.childNodes.length; b++) {\r\n                c += (a.childNodes[b].nodeValue != null  ? a.childNodes[b].nodeValue.toString().replace(/^[\\n\\r\\s]{0,}/, \"\").replace(/[\\n\\r\\s]{0,}$/, \"\") : \"\")\r\n            }\r\n            return c\r\n        }\r\n    };\r\n    window.dhx4.isIE = (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0);\r\n    window.dhx4.isIE6 = (window.XMLHttpRequest == null  && navigator.userAgent.indexOf(\"MSIE\") >= 0);\r\n    window.dhx4.isIE7 = (navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") < 0);\r\n    window.dhx4.isIE8 = (navigator.userAgent.indexOf(\"MSIE 8.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0);\r\n    window.dhx4.isOpera = (navigator.userAgent.indexOf(\"Opera\") >= 0);\r\n    window.dhx4.isChrome = (navigator.userAgent.indexOf(\"Chrome\") >= 0);\r\n    window.dhx4.isKHTML = (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0);\r\n    window.dhx4.isFF = (navigator.userAgent.indexOf(\"Firefox\") >= 0);\r\n    window.dhx4.isIPad = (navigator.userAgent.search(/iPad/gi) >= 0)\r\n}\r\nif (typeof (window.dhx4.ajax) == \"undefined\") {\r\n    window.dhx4.ajax = {\r\n        cache: false,\r\n        method: \"get\",\r\n        parse: function(a) {\r\n            a = a.replace(/^[\\s]+/, \"\");\r\n            if (window.DOMParser && !dhx4.isIE) {\r\n                var b = (new window.DOMParser()).parseFromString(a, \"text/xml\")\r\n            } else {\r\n                if (window.ActiveXObject !== window.undefined) {\r\n                    var b = new window.ActiveXObject(\"Microsoft.XMLDOM\");\r\n                    b.async = \"false\";\r\n                    b.loadXML(a)\r\n                }\r\n            }\r\n            return b\r\n        },\r\n        xmltop: function(a, c, b) {\r\n            if (typeof c.status == \"undefined\" || c.status < 400) {\r\n                xml = (!c.responseXML) ? dhx4.ajax.parse(c.responseText || c) : (c.responseXML || c);\r\n                if (xml && xml.documentElement !== null  && !xml.getElementsByTagName(\"parsererror\").length) {\r\n                    return xml.getElementsByTagName(a)[0]\r\n                }\r\n            }\r\n            dhx4.callEvent(\"onLoadXMLError\", [\"Incorrect XML\", arguments[1], b]);\r\n            return document.createElement(\"DIV\")\r\n        },\r\n        xpath: function(c, a) {\r\n            if (!a.nodeName) {\r\n                a = a.responseXML || a\r\n            }\r\n            if (dhx4.isIE) {\r\n                return a.selectNodes(c) || []\r\n            } else {\r\n                var d = [], e;\r\n                var b = (a.ownerDocument || a).evaluate(c, a, null , XPathResult.ANY_TYPE, null );\r\n                while (e = b.iterateNext()) {\r\n                    d.push(e)\r\n                }\r\n                return d\r\n            }\r\n        },\r\n        query: function(a) {\r\n            dhx4.ajax._call((a.method || \"GET\"), a.url, a.data || \"\", (a.async || true), a.callback, null , a.headers)\r\n        },\r\n        get: function(a, b) {\r\n            this._call(\"GET\", a, null , true, b)\r\n        },\r\n        getSync: function(a) {\r\n            return this._call(\"GET\", a, null , false)\r\n        },\r\n        put: function(b, a, c) {\r\n            this._call(\"PUT\", b, a, true, c)\r\n        },\r\n        del: function(b, a, c) {\r\n            this._call(\"DELETE\", b, a, true, c)\r\n        },\r\n        post: function(b, a, c) {\r\n            if (arguments.length == 1) {\r\n                a = \"\"\r\n            } else {\r\n                if (arguments.length == 2 && (typeof (a) == \"function\" || typeof (window[a]) == \"function\")) {\r\n                    c = a;\r\n                    a = \"\"\r\n                } else {\r\n                    a = String(a)\r\n                }\r\n            }\r\n            this._call(\"POST\", b, a, true, c)\r\n        },\r\n        postSync: function(b, a) {\r\n            a = (a == null  ? \"\" : String(a));\r\n            return this._call(\"POST\", b, a, false)\r\n        },\r\n        getLong: function(a, b) {\r\n            this._call(\"GET\", a, null , true, b, {\r\n                url: a\r\n            })\r\n        },\r\n        postLong: function(b, a, c) {\r\n            if (arguments.length == 2 && (typeof (a) == \"function\" || typeof (window[a]))) {\r\n                c = a;\r\n                a = \"\"\r\n            }\r\n            this._call(\"POST\", b, a, true, c, {\r\n                url: b,\r\n                postData: a\r\n            })\r\n        },\r\n        _call: function(a, b, c, e, g, j, d) {\r\n            var i = (window.XMLHttpRequest && !dhx4.isIE ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\"));\r\n            var f = (navigator.userAgent.match(/AppleWebKit/) != null  && navigator.userAgent.match(/Qt/) != null  && navigator.userAgent.match(/Safari/) != null );\r\n            if (e == true) {\r\n                i.onreadystatechange = function() {\r\n                    if ((i.readyState == 4) || (f == true && i.readyState == 3)) {\r\n                        if (i.status != 200 || i.responseText == \"\") {\r\n                            if (!dhx4.callEvent(\"onAjaxError\", [i])) {\r\n                                return\r\n                            }\r\n                        }\r\n                        window.setTimeout(function() {\r\n                            if (typeof (g) == \"function\") {\r\n                                g.apply(window, [{\r\n                                    xmlDoc: i\r\n                                }])\r\n                            }\r\n                            if (j != null ) {\r\n                                if (typeof (j.postData) != \"undefined\") {\r\n                                    dhx4.ajax.postLong(j.url, j.postData, g)\r\n                                } else {\r\n                                    dhx4.ajax.getLong(j.url, g)\r\n                                }\r\n                            }\r\n                            g = null ;\r\n                            i = null \r\n                        }, 1)\r\n                    }\r\n                }\r\n            }\r\n            if (a == \"GET\" && this.cache != true) {\r\n                b += (b.indexOf(\"?\") >= 0 ? \"&\" : \"?\") + \"dhxr\" + new Date().getTime() + \"=1\"\r\n            }\r\n            i.open(a, b, e);\r\n            if (d) {\r\n                for (var h in d) {\r\n                    i.setRequestHeader(h, d[h])\r\n                }\r\n            } else {\r\n                if (a == \"POST\") {\r\n                    i.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\")\r\n                } else {\r\n                    if (a == \"GET\") {\r\n                        c = null \r\n                    }\r\n                }\r\n            }\r\n            i.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n            i.send(c);\r\n            if (!e) {\r\n                return {\r\n                    xmlDoc: i\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nif (typeof (window.dhx4._enableDataLoading) == \"undefined\") {\r\n    window.dhx4._enableDataLoading = function(g, c, f, e, h) {\r\n        if (h == \"clear\") {\r\n            for (var b in g._dhxdataload) {\r\n                g._dhxdataload[b] = null ;\r\n                delete g._dhxdataload[b]\r\n            }\r\n            g._loadData = null ;\r\n            g._dhxdataload = null ;\r\n            g.load = null ;\r\n            g.loadStruct = null ;\r\n            g = null ;\r\n            return\r\n        }\r\n        g._dhxdataload = {\r\n            initObj: c,\r\n            xmlToJson: f,\r\n            xmlRootTag: e,\r\n            onBeforeXLS: null \r\n        };\r\n        g._loadData = function(n, o, q) {\r\n            if (arguments.length == 2) {\r\n                q = o;\r\n                o = null \r\n            }\r\n            var m = null ;\r\n            if (arguments.length == 3) {\r\n                q = arguments[2]\r\n            }\r\n            if (typeof (n) == \"string\") {\r\n                var l = n.replace(/^\\s{1,}/, \"\").replace(/\\s{1,}$/, \"\");\r\n                var u = new RegExp(\"^<\" + this._dhxdataload.xmlRootTag);\r\n                if (u.test(l.replace(/^<\\?xml[^\\?]*\\?>\\s*/, \"\"))) {\r\n                    m = dhx4.ajax.parse(n);\r\n                    if (m != null ) {\r\n                        m = this[this._dhxdataload.xmlToJson].apply(this, [m])\r\n                    }\r\n                }\r\n                if (m == null  && (l.match(/^\\{.*\\}$/) != null  || l.match(/^\\[.*\\]$/) != null )) {\r\n                    m = dhx4.s2j(l)\r\n                }\r\n                if (m == null ) {\r\n                    this.callEvent(\"onXLS\", []);\r\n                    var j = [];\r\n                    if (typeof (this._dhxdataload.onBeforeXLS) == \"function\") {\r\n                        var l = this._dhxdataload.onBeforeXLS.apply(this, [n]);\r\n                        if (l != null  && typeof (l) == \"object\") {\r\n                            if (l.url != null ) {\r\n                                n = l.url\r\n                            }\r\n                            if (l.params != null ) {\r\n                                for (var r in l.params) {\r\n                                    j.push(r + \"=\" + encodeURIComponent(l.params[r]))\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    var s = this;\r\n                    var i = function(a) {\r\n                        var k = null ;\r\n                        if ((a.xmlDoc.getResponseHeader(\"Content-Type\") || \"\").search(/xml/gi) >= 0 || (a.xmlDoc.responseText.replace(/^\\s{1,}/, \"\")).match(/^</) != null ) {\r\n                            k = s[s._dhxdataload.xmlToJson].apply(s, [a.xmlDoc.responseXML])\r\n                        } else {\r\n                            k = dhx4.s2j(a.xmlDoc.responseText)\r\n                        }\r\n                        if (k != null ) {\r\n                            s[s._dhxdataload.initObj].apply(s, [k, n])\r\n                        }\r\n                        s.callEvent(\"onXLE\", []);\r\n                        if (q != null ) {\r\n                            if (typeof (q) == \"function\") {\r\n                                q.apply(s, [])\r\n                            } else {\r\n                                if (typeof (window[q]) == \"function\") {\r\n                                    window[q].apply(s, [])\r\n                                }\r\n                            }\r\n                        }\r\n                        i = q = null ;\r\n                        k = a = s = null \r\n                    }\r\n                    ;\r\n                    j = j.join(\"&\") + (typeof (o) == \"string\" ? \"&\" + o : \"\");\r\n                    if (dhx4.ajax.method == \"post\") {\r\n                        dhx4.ajax.post(n, j, i)\r\n                    } else {\r\n                        if (dhx4.ajax.method == \"get\") {\r\n                            dhx4.ajax.get(n + (j.length > 0 ? (n.indexOf(\"?\") > 0 ? \"&\" : \"?\") + j : \"\"), i)\r\n                        }\r\n                    }\r\n                    return\r\n                }\r\n            } else {\r\n                if (typeof (n.documentElement) == \"object\" || (typeof (n.tagName) != \"undefined\" && typeof (n.getElementsByTagName) != \"undefined\" && n.getElementsByTagName(this._dhxdataload.xmlRootTag).length > 0)) {\r\n                    m = this[this._dhxdataload.xmlToJson].apply(this, [n])\r\n                } else {\r\n                    m = window.dhx4._copyObj(n)\r\n                }\r\n            }\r\n            if (m != null ) {\r\n                this[this._dhxdataload.initObj].apply(this, [m])\r\n            }\r\n            if (q != null ) {\r\n                if (typeof (q) == \"function\") {\r\n                    q.apply(this, [])\r\n                } else {\r\n                    if (typeof (window[q]) == \"function\") {\r\n                        window[q].apply(this, [])\r\n                    }\r\n                }\r\n                q = null \r\n            }\r\n        }\r\n        ;\r\n        if (h != null ) {\r\n            var d = {\r\n                struct: \"loadStruct\",\r\n                data: \"load\"\r\n            };\r\n            for (var b in h) {\r\n                if (h[b] == true) {\r\n                    g[d[b]] = function() {\r\n                        return this._loadData.apply(this, arguments)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        g = null \r\n    }\r\n}\r\nif (typeof (window.dhx4._eventable) == \"undefined\") {\r\n    window.dhx4._eventable = function(a, b) {\r\n        if (b == \"clear\") {\r\n            a.detachAllEvents();\r\n            a.dhxevs = null ;\r\n            a.attachEvent = null ;\r\n            a.detachEvent = null ;\r\n            a.checkEvent = null ;\r\n            a.callEvent = null ;\r\n            a.detachAllEvents = null ;\r\n            a = null ;\r\n            return\r\n        }\r\n        a.dhxevs = {\r\n            data: {}\r\n        };\r\n        a.attachEvent = function(c, e) {\r\n            c = String(c).toLowerCase();\r\n            if (!this.dhxevs.data[c]) {\r\n                this.dhxevs.data[c] = {}\r\n            }\r\n            var d = window.dhx4.newId();\r\n            this.dhxevs.data[c][d] = e;\r\n            return d\r\n        }\r\n        ;\r\n        a.detachEvent = function(f) {\r\n            for (var d in this.dhxevs.data) {\r\n                var e = 0;\r\n                for (var c in this.dhxevs.data[d]) {\r\n                    if (c == f) {\r\n                        this.dhxevs.data[d][c] = null ;\r\n                        delete this.dhxevs.data[d][c]\r\n                    } else {\r\n                        e++\r\n                    }\r\n                }\r\n                if (e == 0) {\r\n                    this.dhxevs.data[d] = null ;\r\n                    delete this.dhxevs.data[d]\r\n                }\r\n            }\r\n        }\r\n        ;\r\n        a.checkEvent = function(c) {\r\n            c = String(c).toLowerCase();\r\n            return ( this.dhxevs.data[c] != null ) \r\n        }\r\n        ;\r\n        a.callEvent = function(d, f) {\r\n            d = String(d).toLowerCase();\r\n            if (this.dhxevs.data[d] == null ) {\r\n                return true\r\n            }\r\n            var e = true;\r\n            for (var c in this.dhxevs.data[d]) {\r\n                e = this.dhxevs.data[d][c].apply(this, f) && e\r\n            }\r\n            return e\r\n        }\r\n        ;\r\n        a.detachAllEvents = function() {\r\n            for (var d in this.dhxevs.data) {\r\n                for (var c in this.dhxevs.data[d]) {\r\n                    this.dhxevs.data[d][c] = null ;\r\n                    delete this.dhxevs.data[d][c]\r\n                }\r\n                this.dhxevs.data[d] = null ;\r\n                delete this.dhxevs.data[d]\r\n            }\r\n        }\r\n        ;\r\n        a = null \r\n    }\r\n    ;\r\n    dhx4._eventable(dhx4)\r\n}\r\nfunction dhtmlXVaultObject(j) {\r\n    var h = this;\r\n    this.conf = {\r\n        version: \"2.4\",\r\n        skin: (j.skin || window.dhx4.skin || (typeof (dhtmlx) != \"undefined\" ? dhtmlx.skin : null ) || window.dhx4.skinDetect(\"dhxvault\") || \"dhx_skyblue\"),\r\n        param_name: (typeof (j.paramName) != \"undefined\" ? j.paramName : \"file\"),\r\n        engine: null ,\r\n        list: \"list_default\",\r\n        url: j.uploadUrl || \"\",\r\n        download_url: (j.downloadUrl || \"\"),\r\n        multiple_files: (typeof (j.multiple) != \"undefined\" ? j.multiple == true : true),\r\n        swf_file: j.swfPath || \"\",\r\n        swf_url: j.swfUrl || \"\",\r\n        swf_logs: j.swfLogs || \"no\",\r\n        sl_xap: j.slXap,\r\n        sl_url: j.slUrl,\r\n        sl_logs: j.slLogs,\r\n        enabled: true,\r\n        auto_start: (typeof (j.autoStart) != \"undefined\" ? j.autoStart == true : true),\r\n        auto_remove: (typeof (j.autoRemove) != \"undefined\" ? j.autoRemove == true : false),\r\n        files_added: 0,\r\n        uploaded_count: 0,\r\n        files_limit: (typeof (j.filesLimit) != \"undefined\" ? j.filesLimit : 0),\r\n        max_file_size: parseInt(j.maxFileSize) || 0,\r\n        buttons: {\r\n            upload: (typeof (j.buttonUpload) != \"undefined\" ? (j.buttonUpload == true) : false),\r\n            clear: (typeof (j.buttonClear) != \"undefined\" ? (j.buttonClear == true) : true)\r\n        },\r\n        ofs: {\r\n            dhx_skyblue: 5,\r\n            dhx_web: 7,\r\n            dhx_terrace: 10,\r\n            bootstrap: 10\r\n        },\r\n        uploaded_state: {},\r\n        uploaded_files: {},\r\n        progress_mode: \"percent\",\r\n        icon_def: \"\",\r\n        icons: {}\r\n    };\r\n    this.list = new this[this.conf.list]();\r\n    this.conf.icon_def = this.icon_def;\r\n    for (var l in this.icons) {\r\n        for (var b = 0; b < this.icons[l].length; b++) {\r\n            this.conf.icons[this.icons[l][b]] = l\r\n        }\r\n    }\r\n    if (typeof (j.mode) == \"string\" && typeof (this[j.mode]) == \"function\") {\r\n        this.conf.engine = j.mode\r\n    } else {\r\n        this.conf.engine = \"html4\";\r\n        var g = null ;\r\n        if (typeof (window.FormData) != \"undefined\" && typeof (window.XMLHttpRequest) != \"undefined\") {\r\n            g = new XMLHttpRequest();\r\n            if (typeof (g.upload) == \"undefined\") {\r\n                g = null \r\n            }\r\n        }\r\n        if (g != null ) {\r\n            this.conf.engine = \"html5\"\r\n        } else {\r\n            if (typeof (window.swfobject) != \"undefined\" || g === false) {\r\n                var g = swfobject.getFlashPlayerVersion();\r\n                if (g.major >= 10) {\r\n                    this.conf.engine = \"flash\"\r\n                }\r\n            } else {\r\n                this.conf.sl_v = this.getSLVersion();\r\n                if (this.conf.sl_v) {\r\n                    this.conf.engine = \"sl\"\r\n                }\r\n            }\r\n        }\r\n        g = null \r\n    }\r\n    var c = (typeof (j.parent) != \"undefined\" ? j.parent : j.container);\r\n    c = (typeof (c) == \"string\" ? document.getElementById(c) : c);\r\n    j.parent = j.container = null ;\r\n    if (c._attach_mode == true) {\r\n        this.base = c\r\n    } else {\r\n        this.base = document.createElement(\"DIV\");\r\n        c.appendChild(this.base)\r\n    }\r\n    this.base.className += \" dhx_vault_\" + this.conf.skin;\r\n    if (c._no_border == true) {\r\n        this.base.style.border = \"0px solid white\"\r\n    }\r\n    c = j = null ;\r\n    this.p_controls = document.createElement(\"DIV\");\r\n    this.p_controls.className = \"dhx_vault_controls\";\r\n    this.base.appendChild(this.p_controls);\r\n    this.p_controls.onselectstart = function(a) {\r\n        a = a || event;\r\n        if (a.preventDefault) {\r\n            a.preventDefault()\r\n        } else {\r\n            a.returnValue = false\r\n        }\r\n        return false\r\n    }\r\n    ;\r\n    this.p_files = document.createElement(\"DIV\");\r\n    this.p_files.className = \"dhx_vault_files\";\r\n    this.base.appendChild(this.p_files);\r\n    this.p_files.ondragstart = function(k) {\r\n        k = k || event;\r\n        var a = k.target || k.srcElement;\r\n        if (a.tagName != null  && a.tagName.toLowerCase() == \"a\") {\r\n            if (k.preventDefault) {\r\n                k.preventDefault()\r\n            } else {\r\n                k.returnValue = false\r\n            }\r\n            return false\r\n        }\r\n    }\r\n    ;\r\n    this._doOnFilesClick = function(m) {\r\n        m = m || event;\r\n        var a = m.target || m.srcElement;\r\n        var k = null ;\r\n        while (a != h.p_files && k == null ) {\r\n            if (k == null  && a != null  && a._action != null ) {\r\n                k = a._action\r\n            } else {\r\n                a = a.parentNode\r\n            }\r\n        }\r\n        if (k == null ) {\r\n            return\r\n        }\r\n        if (k.data == \"delete_file\" && h.conf.enabled == true) {\r\n            h._removeFileFromQueue(k.id)\r\n        }\r\n        if (k.data == \"download_file\" && h.conf.enabled == true) {\r\n            h._doDownloadFile(k.id)\r\n        }\r\n        k = null \r\n    }\r\n    ;\r\n    if (typeof (window.addEventListener) == \"function\") {\r\n        this.p_files.addEventListener(\"click\", this._doOnFilesClick, false)\r\n    } else {\r\n        this.p_files.attachEvent(\"onclick\", this._doOnFilesClick)\r\n    }\r\n    this.file_data = {};\r\n    this._initToolbar = function() {\r\n        this.b_opts = {\r\n            browse: {\r\n                str: \"btnAdd\",\r\n                onclick: null \r\n            },\r\n            upload: {\r\n                str: \"btnUpload\",\r\n                onclick: function() {\r\n                    if (!h.conf.enabled) {\r\n                        return\r\n                    }\r\n                    if (!h.conf.uploading) {\r\n                        h._uploadStart()\r\n                    }\r\n                }\r\n            },\r\n            cancel: {\r\n                str: \"btnCancel\",\r\n                onclick: function() {\r\n                    if (!h.conf.enabled) {\r\n                        return\r\n                    }\r\n                    h._uploadStop();\r\n                    h._switchButton(false)\r\n                }\r\n            },\r\n            clear: {\r\n                str: \"btnClean\",\r\n                onclick: function() {\r\n                    if (!h.conf.enabled) {\r\n                        return\r\n                    }\r\n                    h.clear()\r\n                },\r\n                css: \"float:right!important;\"\r\n            }\r\n        };\r\n        this.buttons = {};\r\n        for (var e in this.b_opts) {\r\n            var m = document.createElement(\"DIV\");\r\n            m.innerHTML = \"<div class='dhxvault_button_icon dhx_vault_icon_\" + e + \"'></div><div class='dhxvault_button_text'>\" + this.strings[this.b_opts[e].str] + \"</div>\";\r\n            if (this.b_opts[e].css != null ) {\r\n                m.style.cssText += this.b_opts[e].css\r\n            }\r\n            m.className = \"dhx_vault_button\";\r\n            m._css = m.className;\r\n            m._onclick = this.b_opts[e].onclick;\r\n            m.onmouseover = function() {\r\n                if (h.conf.enabled != true) {\r\n                    return\r\n                }\r\n                if (this._hover == true) {\r\n                    return\r\n                }\r\n                this._hover = true;\r\n                this.className = this._css + \" dhx_vault_button\" + this._css_p + \"_hover\"\r\n            }\r\n            ;\r\n            m.onmouseout = function() {\r\n                if (h.conf.enabled != true) {\r\n                    return\r\n                }\r\n                if (this._hover != true) {\r\n                    return\r\n                }\r\n                this._hover = false;\r\n                this.className = this._css\r\n            }\r\n            ;\r\n            m.onmousedown = function() {\r\n                if (h.conf.enabled != true) {\r\n                    return\r\n                }\r\n                if (this._hover != true) {\r\n                    return\r\n                }\r\n                this._pressed = true;\r\n                this.className = this._css + \" dhx_vault_button\" + this._css_p + \"_pressed\"\r\n            }\r\n            ;\r\n            m.onmouseup = function(a) {\r\n                if (h.conf.enabled != true) {\r\n                    return\r\n                }\r\n                if (this._pressed != true) {\r\n                    return\r\n                }\r\n                this._pressed = false;\r\n                this.className = this._css + (this._hover ? \" dhx_vault_button\" + this._css_p + \"_hover\" : \"\");\r\n                if (this._onclick != null ) {\r\n                    this._onclick()\r\n                }\r\n            }\r\n            ;\r\n            if (this.b_opts[e].tooltip) {\r\n                m.title = this.b_opts[e].tooltip\r\n            }\r\n            this.p_controls.appendChild(m);\r\n            this.buttons[e] = m;\r\n            m = null ;\r\n            if (e == \"upload\" || e == \"clear\") {\r\n                this.buttons[e].style.display = (this.conf.buttons[e] == true ? \"\" : \"none\")\r\n            }\r\n            this.b_opts[e].onclick = null ;\r\n            this.b_opts[e] = null ;\r\n            delete this.b_opts[e]\r\n        }\r\n        this.b_opts = null ;\r\n        delete this.b_opts;\r\n        this.buttons.cancel.style.display = \"none\"\r\n    }\r\n    ;\r\n    this._beforeAddFileToList = function(e, k, a) {\r\n        return ( this.callEvent(\"onBeforeFileAdd\", [{\r\n            id: null ,\r\n            name: e,\r\n            size: k,\r\n            lastModifiedDate: a,\r\n            serverName: null ,\r\n            uploaded: false,\r\n            error: false\r\n        }]) === true) \r\n    }\r\n    ;\r\n    this._addFileToList = function(r, k, m, q, e) {\r\n        var o = this.getFileExtension(k);\r\n        var n = (o.length > 0 ? (this.conf.icons[o.toLowerCase()] || this.conf.icon_def) : this.conf.icon_def);\r\n        var a = false;\r\n        if (q == \"added\" && typeof (m) == \"number\" && m > 0 && this.conf.max_file_size > 0 && m > this.conf.max_file_size) {\r\n            q = this.file_data[r].state = \"size_exceeded\";\r\n            a = true\r\n        }\r\n        this.list.addFileItem(r, this.p_files);\r\n        this.list.renderFileRecord(r, {\r\n            name: k,\r\n            icon: n,\r\n            size: m,\r\n            readableSize: this.readableSize(m || 0),\r\n            state: q,\r\n            progress: e\r\n        });\r\n        if (q == \"size_exceeded\") {\r\n            this.list.updateFileState(r, {\r\n                state: q,\r\n                str_size_exceeded: window.dhx4.template(this.strings.size_exceeded, {\r\n                    size: this.readableSize(this.conf.max_file_size)\r\n                })\r\n            })\r\n        }\r\n        this.callEvent(\"onFileAdd\", [{\r\n            id: r,\r\n            name: k,\r\n            size: m,\r\n            lastModifiedDate: this.file_data[r].file.lastModifiedDate || null ,\r\n            serverName: null ,\r\n            uploaded: false,\r\n            error: a\r\n        }])\r\n    }\r\n    ;\r\n    this._removeFileFromList = function(a) {\r\n        this.list.removeFileRecord(a);\r\n        if (this.conf.uploaded_files[a] != null ) {\r\n            this.conf.uploaded_files[a] = null ;\r\n            delete this.conf.uploaded_files[a]\r\n        }\r\n        if (this.conf.uploaded_state[a] != null ) {\r\n            this.conf.uploaded_state[a] = null ;\r\n            delete this.conf.uploaded_state[a]\r\n        }\r\n    }\r\n    ;\r\n    this._updateFileInList = function(k, e, a) {\r\n        if (this.list.isFileItemExist(k) == false) {\r\n            return\r\n        }\r\n        if (e == \"uploading\" && this.conf.progress_mode == \"eta\" && this._etaStart != null ) {\r\n            this._etaStart(k)\r\n        }\r\n        this._updateProgress(k, e, a)\r\n    }\r\n    ;\r\n    this._updateProgress = function(o, n, e) {\r\n        if (n == \"added\") {\r\n            this.list.updateFileState(o, {\r\n                state: n\r\n            });\r\n            if (this.conf.progress_mode == \"eta\" && this._etaEnd != null ) {\r\n                this._etaEnd(o)\r\n            }\r\n            return\r\n        }\r\n        if (n == \"fail\") {\r\n            this.list.updateFileState(o, {\r\n                state: n,\r\n                str_error: this.strings.error\r\n            });\r\n            if (this.conf.progress_mode == \"eta\" && this._etaEnd != null ) {\r\n                this._etaEnd(o)\r\n            }\r\n            return\r\n        }\r\n        if (n == \"uploaded\") {\r\n            if (this.conf.progress_mode == \"eta\" && this._etaEnd != null ) {\r\n                this._etaEnd(o)\r\n            }\r\n            var m = this.strings.done;\r\n            var a = (this.conf.engine != \"html4\" ? {} : {\r\n                name: this.file_data[o].name,\r\n                size: this.file_data[o].size,\r\n                readableSize: this.readableSize(this.file_data[o].size || 0)\r\n            });\r\n            window.setTimeout(function() {\r\n                h.list.updateFileState(o, {\r\n                    state: \"uploaded\",\r\n                    str_done: m\r\n                });\r\n                a.download = (h.conf.download_url.length > 0);\r\n                h.list.updateFileNameSize(o, a)\r\n            }, 100);\r\n            return\r\n        }\r\n        if (n == \"uploading\") {\r\n            if ((e < 100 && this.conf.progress_type == \"loader\") || this.file_data[o].custom == true) {\r\n                this.list.updateFileState(o, {\r\n                    state: \"uploading_html4\"\r\n                })\r\n            } else {\r\n                if (this.conf.progress_mode == \"eta\") {\r\n                    var k = (this._etaCheck != null  ? this._etaCheck(o, e) : null );\r\n                    this.list.updateFileState(o, {\r\n                        state: \"uploading\",\r\n                        progress: e,\r\n                        eta: (k == null  ? null  : \"eta: \" + k)\r\n                    })\r\n                } else {\r\n                    if (this.conf.progress_mode == \"percent\") {\r\n                        this.list.updateFileState(o, {\r\n                            state: \"uploading\",\r\n                            progress: e,\r\n                            eta: e + \"%\"\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._removeFilesByState = function(k) {\r\n        for (var e in this.file_data) {\r\n            if (k === true || this.file_data[e].state == k) {\r\n                this._removeFileFromQueue(e)\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._switchButton = function(n) {\r\n        if (n == true) {\r\n            if (this.conf.buttons.upload == true) {\r\n                this.buttons.upload.style.display = \"none\";\r\n                this.buttons.cancel.style.display = \"\"\r\n            }\r\n        } else {\r\n            var k = this.conf.uploaded_count;\r\n            var m = [];\r\n            for (var e in this.conf.uploaded_state) {\r\n                m.push({\r\n                    id: e,\r\n                    name: this._fileName,\r\n                    size: (this.file_data[e] != null  ? this.file_data[e].size : null ),\r\n                    lastModifiedDate: (this.file_data[e] != null  ? (this.file_data[e].file.lastModifiedDate || null ) : null ),\r\n                    serverName: (this.conf.uploaded_files[e] ? this.conf.uploaded_files[e].serverName : null ),\r\n                    uploaded: this.conf.uploaded_state[e],\r\n                    error: !this.conf.uploaded_state[e]\r\n                })\r\n            }\r\n            if (this.conf.buttons.upload == true) {\r\n                this.buttons.upload.style.display = \"\";\r\n                this.buttons.cancel.style.display = \"none\"\r\n            }\r\n            this.conf.uploaded_count = 0;\r\n            this.conf.uploaded_state = {};\r\n            if (k > 0) {\r\n                this.callEvent(\"onUploadComplete\", [m])\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._uploadStart = function() {\r\n        this._switchButton(true);\r\n        if (!this.conf.uploading) {\r\n            for (var e in this.file_data) {\r\n                if (this.file_data[e].state == \"fail\") {\r\n                    this.file_data[e].state = \"added\";\r\n                    this._updateFileInList(e, \"added\", 0)\r\n                }\r\n            }\r\n        }\r\n        this.conf.uploading = true;\r\n        var k = false;\r\n        for (var e in this.file_data) {\r\n            if (!k && [this.file_data[e].state] == \"added\") {\r\n                k = true;\r\n                this.file_data[e].state = \"uploading\";\r\n                this._updateFileInList(e, \"uploading\", 0);\r\n                this._doUploadFile(e)\r\n            }\r\n        }\r\n        if (!k) {\r\n            this.conf.uploading = false;\r\n            this._switchButton(false)\r\n        }\r\n    }\r\n    ;\r\n    this._onUploadSuccess = function(n, m, k, a) {\r\n        if (typeof (k) != \"undefined\" && this.conf.engine == \"flash\") {\r\n            var e = window.dhx4.s2j(k.data);\r\n            if (e != null  && e.state == true && e.name != null ) {\r\n                m = e.name;\r\n                if (e.extra != null ) {\r\n                    a = e.extra\r\n                }\r\n            } else {\r\n                this._onUploadFail(n, (e != null  && e.extra != null  ? e.extra : null ));\r\n                return\r\n            }\r\n        }\r\n        this.conf.uploaded_count++;\r\n        this.conf.uploaded_files[n] = {\r\n            realName: this.file_data[n].name,\r\n            serverName: m\r\n        };\r\n        this.file_data[n].state = \"uploaded\";\r\n        this.conf.uploaded_state[n] = true;\r\n        this._updateFileInList(n, \"uploaded\", 100);\r\n        this.callEvent(\"onUploadFile\", [{\r\n            id: n,\r\n            name: this.file_data[n].name,\r\n            size: this.file_data[n].size,\r\n            lastModifiedDate: this.file_data[n].file.lastModifiedDate || null ,\r\n            serverName: m,\r\n            uploaded: true,\r\n            error: false\r\n        }, a]);\r\n        if (this.conf.auto_remove) {\r\n            this._removeFileFromQueue(n)\r\n        }\r\n        if (this.conf.uploading) {\r\n            this._uploadStart()\r\n        }\r\n    }\r\n    ;\r\n    this._onUploadFail = function(e, a) {\r\n        this.file_data[e].state = \"fail\";\r\n        this._updateFileInList(e, \"fail\", 0);\r\n        this.conf.uploaded_state[e] = false;\r\n        this.callEvent(\"onUploadFail\", [{\r\n            id: e,\r\n            name: this.file_data[e].name,\r\n            size: this.file_data[e].size,\r\n            lastModifiedDate: this.file_data[e].file.lastModifiedDate || null ,\r\n            serverName: null ,\r\n            uploaded: false,\r\n            error: true\r\n        }, a]);\r\n        if (this.conf.uploading) {\r\n            this._uploadStart()\r\n        }\r\n    }\r\n    ;\r\n    this._onUploadAbort = function(a) {\r\n        this.conf.uploading = false;\r\n        this.file_data[a].state = \"added\";\r\n        this._updateFileInList(a, \"added\", 0);\r\n        this.callEvent(\"onUploadCancel\", [{\r\n            id: a,\r\n            name: this.file_data[a].name,\r\n            size: this.file_data[a].size,\r\n            lastModifiedDate: this.file_data[a].file.lastModifiedDate,\r\n            serverName: null ,\r\n            uploaded: false,\r\n            error: false\r\n        }])\r\n    }\r\n    ;\r\n    this.unload = function() {\r\n        this.callEvent = function() {\r\n            return true\r\n        }\r\n        ;\r\n        if (typeof (window.addEventListener) == \"function\") {\r\n            this.p_files.removeEventListener(\"click\", this._doOnFilesClick, false)\r\n        } else {\r\n            this.p_files.detachEvent(\"onclick\", this._doOnFilesClick)\r\n        }\r\n        this._removeFilesByState(true);\r\n        this.conf.uploaded_files = null ;\r\n        this.file_data = null ;\r\n        this._unloadEngine();\r\n        this.list.unload();\r\n        this.list = null ;\r\n        this.icons = null ;\r\n        for (var e in this.buttons) {\r\n            this.buttons[e].onclick = null ;\r\n            this.buttons[e].onmouseover = null ;\r\n            this.buttons[e].onmouseout = null ;\r\n            this.buttons[e].onmousedown = null ;\r\n            this.buttons[e].onmouseup = null ;\r\n            this.buttons[e]._onclick = null ;\r\n            this.buttons[e].parentNode.removeChild(this.buttons[e]);\r\n            this.buttons[e] = null ;\r\n            delete this.buttons[e]\r\n        }\r\n        this.buttons = null ;\r\n        this.p_controls.onselectstart = null ;\r\n        this.p_controls.parentNode.removeChild(this.p_controls);\r\n        this.p_controls = null ;\r\n        this.p_files.ondragstart = null ;\r\n        this.p_files.parentNode.removeChild(this.p_files);\r\n        this.p_files = null ;\r\n        window.dhx4._eventable(this, \"clear\");\r\n        this.callEvent = null ;\r\n        for (var e in this.conf) {\r\n            this.conf[e] = null ;\r\n            delete this.conf[e]\r\n        }\r\n        this.conf = null ;\r\n        this.strings = null ;\r\n        for (var e in this) {\r\n            if (typeof (this[e]) == \"function\") {\r\n                this[e] = null \r\n            }\r\n        }\r\n        if (this.base._attach_mode != true) {\r\n            this.base.parentNode.removeChild(this.base)\r\n        }\r\n        this.base = null ;\r\n        h = e = null \r\n    }\r\n    ;\r\n    var i = new this[this.conf.engine]();\r\n    for (var l in i) {\r\n        this[l] = i[l];\r\n        i[l] = null \r\n    }\r\n    l = i = p = null ;\r\n    this._initToolbar();\r\n    this._initEngine();\r\n    this.setSkin(this.conf.skin);\r\n    window.dhx4._eventable(this);\r\n    this.attachEvent(\"onFileAdd\", function() {\r\n        this.conf.files_added++\r\n    });\r\n    this.attachEvent(\"onBeforeFileAdd\", function() {\r\n        if (this.conf.files_limit == 0) {\r\n            return true\r\n        }\r\n        return ( this.conf.files_added < this.conf.files_limit) \r\n    });\r\n    if (window.dhx4.isIE7 || navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0) {\r\n        var f = this;\r\n        window.setTimeout(function() {\r\n            f.setSizes();\r\n            f = null \r\n        }, 1)\r\n    }\r\n    var d = function(e) {\r\n        var a = window.dhx4.s2j(e.xmlDoc.responseText);\r\n        if (a != null  && a.maxFileSize != null  && h.conf.max_file_size == 0) {\r\n            h.conf.max_file_size = (parseInt(a.maxFileSize) || 0)\r\n        }\r\n        a = e = d = null \r\n    }\r\n    ;\r\n    if (window.dhx4.ajax.method == \"post\") {\r\n        window.dhx4.ajax.post(this.conf.url, \"mode=conf\", d)\r\n    } else {\r\n        window.dhx4.ajax.get(this.conf.url + (this.conf.url.indexOf(\"?\") > 0 ? \"&\" : \"?\") + \"mode=conf\", d)\r\n    }\r\n    return this\r\n}\r\ndhtmlXVaultObject.prototype.readableSize = function(d) {\r\n    var c = false;\r\n    var a = [\"b\", \"Kb\", \"Mb\", \"Gb\", \"Tb\", \"Pb\", \"Eb\"];\r\n    for (var e = 0; e < a.length; e++) {\r\n        if (d > 1024) {\r\n            d = d / 1024\r\n        } else {\r\n            if (c === false) {\r\n                c = e\r\n            }\r\n        }\r\n    }\r\n    if (c === false) {\r\n        c = a.length - 1\r\n    }\r\n    return Math.round(d * 100) / 100 + \" \" + a[c]\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.icon_def = \"icon_def\";\r\ndhtmlXVaultObject.prototype.icons = {\r\n    icon_image: [\"jpg\", \"jpeg\", \"gif\", \"png\", \"bmp\", \"tiff\", \"pcx\", \"svg\", \"ico\"],\r\n    icon_psd: [\"psd\"],\r\n    icon_video: [\"avi\", \"mpg\", \"mpeg\", \"rm\", \"move\", \"mov\", \"mkv\", \"flv\", \"f4v\", \"mp4\", \"3gp\"],\r\n    icon_audio: [\"wav\", \"aiff\", \"au\", \"mp3\", \"aac\", \"wma\", \"ogg\", \"flac\", \"ape\", \"wv\", \"m4a\", \"mid\", \"midi\"],\r\n    icon_arch: [\"rar\", \"zip\", \"tar\", \"tgz\", \"arj\", \"gzip\", \"bzip2\", \"7z\", \"ace\", \"apk\", \"deb\"],\r\n    icon_text: [\"txt\", \"nfo\", \"djvu\", \"xml\"],\r\n    icon_html: [\"htm\", \"html\"],\r\n    icon_doc: [\"doc\", \"docx\", \"rtf\", \"odt\"],\r\n    icon_xls: [\"xls\", \"xlsx\"],\r\n    icon_pdf: [\"pdf\", \"ps\"],\r\n    icon_exe: [\"exe\"],\r\n    icon_dmg: [\"dmg\"]\r\n};\r\ndhtmlXVaultObject.prototype.upload = function() {\r\n    if (!this.conf.uploading) {\r\n        this._uploadStart()\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setAutoStart = function(a) {\r\n    this.conf.auto_start = (a == true)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setAutoRemove = function(a) {\r\n    this.conf.auto_remove = (a == true)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setURL = function(a) {\r\n    this.conf.url = a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setDownloadURL = function(c) {\r\n    this.conf.download_url = c || \"\";\r\n    for (var b in this.conf.uploaded_files) {\r\n        this.list.updateFileNameSize(b, {\r\n            download: (this.conf.download_url.length > 0)\r\n        })\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._buildDownloadUrl = function(b) {\r\n    var a = null ;\r\n    if (this.conf.download_url.length > 0 && this.conf.uploaded_files[b] != null ) {\r\n        var a = String(this.conf.download_url).replace(/\\{serverName\\}/g, encodeURIComponent(this.conf.uploaded_files[b].serverName));\r\n        if (window.dhx4.ajax.cache != true) {\r\n            a += (a.indexOf(\"?\") >= 0 ? \"&\" : \"?\") + \"dhxr\" + new Date().getTime() + \"=1\"\r\n        }\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._doDownloadFile = function(b) {\r\n    if (!this._dframe) {\r\n        this._dframe = document.createElement(\"IFRAME\");\r\n        this._dframe.className = \"dhxvault_dframe\";\r\n        this._dframe.border = this._dframe.frameBorder = 0;\r\n        this.conf.df_name = this._dframe.name = \"dhxvault_dframe_\" + window.dhx4.newId();\r\n        document.body.appendChild(this._dframe)\r\n    }\r\n    var a = document.createElement(\"FORM\");\r\n    a.method = \"POST\";\r\n    a.target = this.conf.df_name;\r\n    a.action = this._buildDownloadUrl(b);\r\n    document.body.appendChild(a);\r\n    a.submit();\r\n    window.setTimeout(function() {\r\n        document.body.removeChild(a);\r\n        a = null \r\n    }, 1)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.enable = function() {\r\n    if (this.conf.enabled == true) {\r\n        return\r\n    }\r\n    this.conf.enabled = true;\r\n    this.base.className = String(this.base.className).replace(/\\s{0,}dhx_vault_dis/gi, \"\");\r\n    if (this.conf.engine == \"flash\") {\r\n        document.getElementById(this.conf.swf_obj_id).style.display = \"\"\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.disable = function() {\r\n    if (this.conf.enabled != true) {\r\n        return\r\n    }\r\n    this.conf.enabled = false;\r\n    this.base.className += \" dhx_vault_dis\";\r\n    if (this.conf.engine == \"flash\") {\r\n        document.getElementById(this.conf.swf_obj_id).style.display = \"none\"\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setWidth = function(a) {\r\n    if (this.base._attach_mode == true) {\r\n        return\r\n    }\r\n    this.base.parentNode.style.width = a + \"px\";\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setHeight = function(a) {\r\n    if (this.base._attach_mode == true) {\r\n        return\r\n    }\r\n    this.base.parentNode.style.height = a + \"px\";\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setFilesLimit = function(a) {\r\n    this.conf.files_added = 0;\r\n    this.conf.files_limit = a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.getStatus = function() {\r\n    var c = 0;\r\n    for (var b in this.file_data) {\r\n        if (this.file_data[b].state != \"uploaded\") {\r\n            return -1\r\n        }\r\n        c = 1\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.getData = function() {\r\n    var c = [];\r\n    for (var b in this.conf.uploaded_files) {\r\n        c.push({\r\n            id: b,\r\n            name: this.file_data[b].name,\r\n            size: this.file_data[b].size,\r\n            serverName: this.conf.uploaded_files[b].serverName,\r\n            uploaded: true,\r\n            error: false\r\n        })\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.clear = function() {\r\n    if (this.callEvent(\"onBeforeClear\", []) !== true) {\r\n        return\r\n    }\r\n    if (this.conf.uploading) {\r\n        this._uploadStop()\r\n    }\r\n    this._switchButton(false);\r\n    this._removeFilesByState(true);\r\n    this.callEvent(\"onClear\", [])\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setSkin = function(c) {\r\n    if (c != this.conf.skin) {\r\n        this.base.className = String(this.base.className).replace(new RegExp(\"s{0,}dhx_vault_\" + this.conf.skin), \" dhx_vault_\" + c);\r\n        this.conf.skin = c\r\n    }\r\n    this._updateBttonsSkin();\r\n    var b = this.conf.ofs[this.conf.skin];\r\n    this.buttons.browse.style.marginLeft = b + \"px\";\r\n    this.buttons.upload.style.marginLeft = (c == \"dhx_terrace\" ? \"-1px\" : b + \"px\");\r\n    this.buttons.cancel.style.marginLeft = this.buttons.upload.style.marginLeft;\r\n    this.buttons.clear.style.marginRight = b + \"px\";\r\n    var a = \"\";\r\n    if (c == \"dhx_terrace\") {\r\n        a = (this.conf.buttons.upload == true) ? \"0px\" : \"3px\"\r\n    }\r\n    this.buttons.browse.style.borderTopRightRadius = a;\r\n    this.buttons.browse.style.borderBottomRightRadius = a;\r\n    this.buttons.upload.style.borderTopLeftRadius = a;\r\n    this.buttons.upload.style.borderBottomLeftRadius = a;\r\n    this.buttons.cancel.style.borderTopLeftRadius = this.buttons.upload.style.borderTopLeftRadius;\r\n    this.buttons.cancel.style.borderBottomLeftRadius = this.buttons.upload.style.borderBottomLeftRadius;\r\n    this.setSizes()\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._updateBttonsSkin = function() {\r\n    for (var b in this.buttons) {\r\n        var c = \"dhx_vault_button\";\r\n        var d = \"\";\r\n        if (this.buttonCss != null  && this.buttonCss[this.conf.skin] != null  && this.buttonCss[this.conf.skin][b] != null ) {\r\n            d = this.buttonCss[this.conf.skin][b];\r\n            c += d\r\n        }\r\n        this.buttons[b]._css = this.buttons[b].className = c;\r\n        this.buttons[b]._css_p = d\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setSizes = function() {\r\n    var a = this.base.offsetWidth - (this.base.clientWidth || this.base.scrollWidth);\r\n    var b = this.base.offsetHeight - this.base.clientHeight;\r\n    this.base.style.width = Math.max(0, this.base.parentNode.clientWidth - a) + \"px\";\r\n    this.base.style.height = Math.max(0, this.base.parentNode.clientHeight - b) + \"px\";\r\n    var c = this.conf.ofs[this.conf.skin];\r\n    this.p_files.style.top = this.p_controls.offsetHeight + \"px\";\r\n    this.p_files.style.left = c + \"px\";\r\n    if (!this.conf.ofs_f) {\r\n        this.p_files.style.width = \"100px\";\r\n        this.p_files.style.height = \"100px\";\r\n        this.conf.ofs_f = {\r\n            w: this.p_files.offsetWidth - this.p_files.clientWidth,\r\n            h: this.p_files.offsetHeight - this.p_files.clientHeight\r\n        }\r\n    }\r\n    this.p_files.style.width = Math.max(this.base.clientWidth - c * 2 - this.conf.ofs_f.w, 0) + \"px\";\r\n    this.p_files.style.height = Math.max(this.base.clientHeight - this.p_controls.offsetHeight - c - this.conf.ofs_f.h, 0) + \"px\";\r\n    if (typeof (this.callEvent) == \"function\") {\r\n        this.callEvent(\"_onSetSizes\", [])\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.getFileExtension = function(b) {\r\n    var c = \"\";\r\n    var a = String(b).match(/\\.([^\\.\\s]*)$/i);\r\n    if (a != null ) {\r\n        c = a[1]\r\n    }\r\n    return c\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.strings = {\r\n    done: \"Done\",\r\n    error: \"Error\",\r\n    size_exceeded: \"Filesize exceeded (max #size#)\",\r\n    btnAdd: \"Add files\",\r\n    btnUpload: \"Upload\",\r\n    btnClean: \"Clear all\",\r\n    btnCancel: \"Cancel\"\r\n};\r\ndhtmlXVaultObject.prototype.setStrings = function(e) {\r\n    for (var b in e) {\r\n        this.strings[b] = e[b]\r\n    }\r\n    for (var b in this.file_data) {\r\n        var d = this.file_data[b].state;\r\n        if (d == \"uploaded\" || d == \"fail\" || d == \"size_exceeded\") {\r\n            this.list.updateFileState(b, {\r\n                state: d,\r\n                str_error: this.strings.error,\r\n                str_done: this.strings.done,\r\n                str_size_exceeded: window.dhx4.template(this.strings.size_exceeded, {\r\n                    size: this.readableSize(this.conf.max_file_size)\r\n                })\r\n            })\r\n        }\r\n        if (d == \"uploaded\") {\r\n            this.list.updateFileNameSize(b, {\r\n                download: (this.conf.download_url.length > 0)\r\n            })\r\n        }\r\n    }\r\n    var c = {\r\n        browse: \"btnAdd\",\r\n        upload: \"btnUpload\",\r\n        clear: \"btnClean\",\r\n        cancel: \"btnCancel\"\r\n    };\r\n    for (var b in c) {\r\n        this.buttons[b].childNodes[1].innerHTML = this.strings[c[b]]\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setMaxFileSize = function(a) {\r\n    this.conf.max_file_size = (parseInt(a) || 0)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.getMaxFileSize = function() {\r\n    return this.conf.max_file_size\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.html5 = function() {}\r\n;\r\ndhtmlXVaultObject.prototype.html5.prototype = {\r\n    _initEngine: function() {\r\n        var c = this;\r\n        this.buttons.browse.onclick = function() {\r\n            if (c.conf.enabled) {\r\n                c.f.click()\r\n            }\r\n        }\r\n        ;\r\n        this.conf.progress_type = \"percentage\";\r\n        this.conf.dnd_enabled = true;\r\n        var a = window.navigator.userAgent;\r\n        var b = true;\r\n        if (a.match(/Windows/gi) != null  && a.match(/AppleWebKit/gi) != null  && a.match(/Safari/gi) != null ) {\r\n            if (a.match(/Version\\/5\\.1\\.5/gi)) {\r\n                this.conf.multiple_files = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1[^\\.\\d{1,}]/gi)) {\r\n                this.conf.dnd_enabled = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1\\.1/gi)) {\r\n                this.conf.multiple_files = false;\r\n                this.conf.dnd_enabled = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1\\.2/gi)) {\r\n                this.conf.dnd_enabled = false\r\n            }\r\n            if (a.match(/Version\\/5\\.1\\.7/gi)) {\r\n                this.conf.multiple_files = false\r\n            }\r\n        }\r\n        this._addFileInput();\r\n        if (this.conf.dnd_enabled && this._initDND != null ) {\r\n            this._initDND()\r\n        }\r\n    },\r\n    _addFileInput: function() {\r\n        if (this.f != null ) {\r\n            this.f.onchange = null ;\r\n            this.f.parentNode.removeChild(this.f);\r\n            this.f = null \r\n        }\r\n        var a = this;\r\n        this.f = document.createElement(\"INPUT\");\r\n        this.f.type = \"file\";\r\n        if (this.conf.multiple_files) {\r\n            this.f.multiple = \"1\"\r\n        }\r\n        this.f.className = \"dhx_vault_input\";\r\n        this.p_controls.appendChild(this.f);\r\n        this.f.onchange = function() {\r\n            a._parseFilesInInput(this.files);\r\n            if (window.dhx4.isOpera) {\r\n                a._addFileInput()\r\n            } else {\r\n                this.value = \"\"\r\n            }\r\n        }\r\n    },\r\n    _doUploadFile: function(c) {\r\n        if (this.file_data[c].custom == true) {\r\n            this._cfUploadStart(c);\r\n            return\r\n        }\r\n        var b = this;\r\n        if (!this.loader) {\r\n            this.loader = new XMLHttpRequest();\r\n            this.loader.upload.onprogress = function(d) {\r\n                if (b.file_data[this._idd].state == \"uploading\") {\r\n                    b._updateFileInList(this._idd, \"uploading\", Math.round(d.loaded * 100 / d.total))\r\n                }\r\n            }\r\n            ;\r\n            this.loader.onload = function(f) {\r\n                var d = window.dhx4.s2j(this.responseText);\r\n                if (d != null  && typeof (d) == \"object\" && typeof (d.state) != \"undefined\" && d.state == true) {\r\n                    b._onUploadSuccess(this.upload._idd, d.name, null , d.extra)\r\n                } else {\r\n                    b._onUploadFail(this.upload._idd, (d != null  && d.extra != null  ? d.extra : null ))\r\n                }\r\n                d = null \r\n            }\r\n            ;\r\n            this.loader.onerror = function(d) {\r\n                b._onUploadFail(this.upload._idd)\r\n            }\r\n            ;\r\n            this.loader.onabort = function(d) {\r\n                b._onUploadAbort(this.upload._idd)\r\n            }\r\n        }\r\n        this.loader.upload._idd = c;\r\n        var a = new FormData();\r\n        a.append(\"mode\", \"html5\");\r\n        if (this.file_data[c].size == 0 && (navigator.userAgent.indexOf(\"MSIE\") > 0 || navigator.userAgent.indexOf(\"Trident\") > 0)) {\r\n            a.append(\"file_name\", String(this.file_data[c].name));\r\n            a.append(\"zero_size\", \"1\")\r\n        } else {\r\n            a.append(this.conf.param_name, this.file_data[c].file)\r\n        }\r\n        if (window.dhx4.ajax.cache != true) {\r\n            a.append(\"dhxr\" + new Date().getTime(), \"\")\r\n        }\r\n        this.loader.open(\"POST\", this.conf.url, true);\r\n        this.loader.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n        this.loader.send(a)\r\n    },\r\n    _uploadStop: function() {\r\n        if (!this.conf.uploading) {\r\n            return\r\n        }\r\n        if (this.cf_loader_id != null ) {\r\n            this._cfUploadStop()\r\n        } else {\r\n            if (this.loader != null ) {\r\n                this.loader.abort()\r\n            }\r\n        }\r\n    },\r\n    _parseFilesInInput: function(b) {\r\n        for (var a = 0; a < b.length; a++) {\r\n            this._addFileToQueue(b[a])\r\n        }\r\n    },\r\n    _addFileToQueue: function(a) {\r\n        if (!this._beforeAddFileToList(a.name, a.size, a.lastModifiedDate)) {\r\n            return\r\n        }\r\n        var b = (a._idd || window.dhx4.newId());\r\n        this.file_data[b] = {\r\n            file: a,\r\n            name: a.name,\r\n            size: a.size,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(b, a.name, a.size, \"added\", 0);\r\n        if (this.conf.auto_start && !this.conf.uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(e) {\r\n        if (!this.file_data[e]) {\r\n            return\r\n        }\r\n        var c = this.file_data[e].name;\r\n        var d = (this.conf.uploaded_files != null  && this.conf.uploaded_files[e] != null  ? this.conf.uploaded_files[e].serverName : null );\r\n        var b = {\r\n            id: Number(e),\r\n            name: c,\r\n            size: this.file_data[e].size,\r\n            serverName: d,\r\n            uploaded: (this.file_data[e].state == \"uploaded\"),\r\n            error: (this.file_data[e].state == \"fail\")\r\n        };\r\n        if (this.callEvent(\"onBeforeFileRemove\", [b]) !== true) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this.cf_loader_id != null  || (this.conf.uploading && this.loader != null  && e == this.loader.upload._idd && this.file_data[e].state == \"uploading\")) {\r\n            this._uploadStop();\r\n            a = true\r\n        }\r\n        this.file_data[e].file = null ;\r\n        this.file_data[e].name = null ;\r\n        this.file_data[e].size = null ;\r\n        this.file_data[e].state = null ;\r\n        this.file_data[e] = null ;\r\n        delete this.file_data[e];\r\n        this._removeFileFromList(e);\r\n        this.callEvent(\"onFileRemove\", [b]);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _unloadEngine: function() {\r\n        this.buttons.browse.onclick = null ;\r\n        if (this.conf.dnd_enabled && this._unloadDND != null ) {\r\n            this._unloadDND()\r\n        }\r\n        this.f.onchange = null ;\r\n        this.f.parentNode.removeChild(this.f);\r\n        this.f = null ;\r\n        if (this.loader) {\r\n            this.loader.upload.onprogress = null ;\r\n            this.loader.onload = null ;\r\n            this.loader.onerror = null ;\r\n            this.loader.onabort = null ;\r\n            this.loader.upload._idd = null ;\r\n            this.loader = null \r\n        }\r\n        this._initEngine = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._parseFilesInInput = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXVaultObject.prototype.html4 = function() {}\r\n;\r\ndhtmlXVaultObject.prototype.html4.prototype = {\r\n    _initEngine: function() {\r\n        this._addForm();\r\n        this.conf.progress_type = \"loader\";\r\n        if (window.dhx4.isIE6 || window.dhx4.isIE7) {\r\n            this.buttons.browse.style.filter = \"\"\r\n        }\r\n    },\r\n    _addForm: function() {\r\n        var a = this;\r\n        if (!this.k) {\r\n            this.k = document.createElement(\"DIV\");\r\n            this.k.className = \"dhx_vault_file_form_cont\";\r\n            this.buttons.browse.appendChild(this.k);\r\n            this.conf.fr_name = \"dhx_vault_file_\" + window.dhx4.newId();\r\n            this.k.innerHTML = '<iframe name=\"' + this.conf.fr_name + '\" style=\"height:0px;width:0px;\" frameBorder=\"0\"></iframe>';\r\n            this.fr = this.k.firstChild;\r\n            if (window.navigator.userAgent.indexOf(\"MSIE\") >= 0) {\r\n                this.fr.onreadystatechange = function() {\r\n                    if (this.readyState == \"complete\") {\r\n                        a._onLoad()\r\n                    }\r\n                }\r\n            } else {\r\n                this.fr.onload = function() {\r\n                    a._onLoad()\r\n                }\r\n            }\r\n        }\r\n        var b = document.createElement(\"DIV\");\r\n        b.innerHTML = \"<form method='POST' enctype='multipart/form-data' target='\" + this.conf.fr_name + \"' class='dhx_vault_file_form' name='dhx_vault_file_form_\" + window.dhx4.newId() + \"'><input type='hidden' name='mode' value='html4'><input type='hidden' name='uid' value=''><input type='file' name='\" + this.conf.param_name + \"' class='dhx_vault_file_input'></form>\";\r\n        this.k.appendChild(b);\r\n        b.firstChild.lastChild.onchange = function() {\r\n            var d = this.value.match(/[^\\/\\\\]*$/)[0];\r\n            this.previousSibling.value = this._idd = window.dhx4.newId();\r\n            var c = null ;\r\n            var e = null ;\r\n            if (this.files != null  && this.files[0] != null ) {\r\n                c = this.files[0].lastModifiedDate || null ;\r\n                e = this.files[0].size || null \r\n            }\r\n            if (!a._beforeAddFileToList(d, e, c)) {\r\n                return\r\n            }\r\n            a._addFileToQueue(this);\r\n            this.onchange = null ;\r\n            this.parentNode.parentNode.style.display = \"none\";\r\n            a._addForm()\r\n        }\r\n        ;\r\n        b = null \r\n    },\r\n    _onLoad: function() {\r\n        if (this.conf.uploading && this.fr._idd != null ) {\r\n            var a = window.dhx4.s2j(this.fr.contentWindow.document.body.innerHTML);\r\n            if (a != null ) {\r\n                if (typeof (a.state) != \"undefined\") {\r\n                    if (a.state == \"cancelled\") {\r\n                        this._onUploadAbort(this.fr._idd);\r\n                        this.fr.contentWindow.document.body.innerHTML = \"\";\r\n                        a = null ;\r\n                        return\r\n                    } else {\r\n                        if (a.state == true) {\r\n                            if (typeof (a.size) != \"undefined\" && !isNaN(a.size)) {\r\n                                this.file_data[this.fr._idd].size = a.size\r\n                            }\r\n                            this._onUploadSuccess(this.fr._idd, a.name, null , a.extra);\r\n                            a = null ;\r\n                            return\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._onUploadFail(this.fr._idd, (a != null  && a.extra != null  ? a.extra : null ))\r\n        }\r\n    },\r\n    _addFileToQueue: function(d) {\r\n        var b = d.value.match(/[^\\\\\\/]*$/);\r\n        if (b[0] != null ) {\r\n            b = b[0]\r\n        } else {\r\n            b = d.value\r\n        }\r\n        var a = null ;\r\n        var c = null ;\r\n        if (d.files != null  && d.files[0] != null ) {\r\n            a = d.files[0].lastModifiedDate || null ;\r\n            c = d.files[0].size || null \r\n        }\r\n        this.file_data[d._idd] = {\r\n            file: {\r\n                lastModifiedDate: a\r\n            },\r\n            name: b,\r\n            size: c,\r\n            form: d.parentNode,\r\n            node: d.parentNode.parentNode,\r\n            input: d,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(d._idd, b, (c || false), \"added\", 0);\r\n        if (this.conf.auto_start && !this.conf.uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(e) {\r\n        var c = this.file_data[e].name;\r\n        var d = (this.conf.uploaded_files != null  && this.conf.uploaded_files[e] != null  ? this.conf.uploaded_files[e].serverName : null );\r\n        var b = {\r\n            id: Number(e),\r\n            name: c,\r\n            size: this.file_data[e].size || null ,\r\n            serverName: d,\r\n            uploaded: (this.file_data[e].state == \"uploaded\"),\r\n            error: (this.file_data[e].state == \"fail\")\r\n        };\r\n        if (this.callEvent(\"onBeforeFileRemove\", [b]) !== true) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this.file_data[e].custom == true) {\r\n            if (this.cf_loader_id != null ) {\r\n                this._uploadStop();\r\n                a = true\r\n            }\r\n        } else {\r\n            this.file_data[e].input.onchange = null ;\r\n            this.file_data[e].form.removeChild(this.file_data[e].input);\r\n            this.file_data[e].node.removeChild(this.file_data[e].form);\r\n            this.file_data[e].node.parentNode.removeChild(this.file_data[e].node);\r\n            this.file_data[e].input = null ;\r\n            this.file_data[e].form = null ;\r\n            this.file_data[e].node = null \r\n        }\r\n        this.file_data[e].name = null ;\r\n        this.file_data[e].size = null ;\r\n        this.file_data[e].state = null ;\r\n        this.file_data[e] = null ;\r\n        delete this.file_data[e];\r\n        this._removeFileFromList(e);\r\n        this.callEvent(\"onFileRemove\", [b]);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _doUploadFile: function(a) {\r\n        if (this.file_data[a].custom == true) {\r\n            this._cfUploadStart(a)\r\n        } else {\r\n            this.fr._idd = a;\r\n            this.file_data[a].form.action = this.conf.url;\r\n            this.file_data[a].form.submit()\r\n        }\r\n    },\r\n    _uploadStop: function() {\r\n        if (!this.conf.uploading) {\r\n            return\r\n        }\r\n        if (this.cf_loader_id == null ) {\r\n            this._onUploadAbort(this.fr._idd);\r\n            this.fr.contentWindow.location.href = (this.conf.url) + (this.conf.url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"mode=html4&action=cancel&dhxr\" + new Date().getTime()\r\n        } else {\r\n            this._cfUploadStop()\r\n        }\r\n    },\r\n    _unloadEngine: function() {\r\n        if (this.k) {\r\n            this.conf.fr_name = null ;\r\n            this.fr.onreadystatechange = null ;\r\n            this.fr.onload = null ;\r\n            this.fr.parentNode.removeChild(this.fr);\r\n            this.fr = null ;\r\n            this.k.firstChild.firstChild.lastChild.onchange = null ;\r\n            this.k.parentNode.removeChild(this.k);\r\n            this.k = null \r\n        }\r\n        this._initEngine = null ;\r\n        this._addForm = null ;\r\n        this._onLoad = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXVaultObject.prototype.flash = function() {}\r\n;\r\ndhtmlXVaultObject.prototype.flash.prototype = {\r\n    _initEngine: function() {\r\n        if (!window.dhtmlXVaultSWFObjects) {\r\n            window.dhtmlXVaultSWFObjects = {\r\n                items: {},\r\n                callEvent: function(e, c, d) {\r\n                    return window.dhtmlXVaultSWFObjects.items[e].uploader[c].apply(window.dhtmlXVaultSWFObjects.items[e].uploader, d)\r\n                }\r\n            }\r\n        }\r\n        var b = (window.dhx4.isIE6 || window.dhx4.isIE7 || navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0 ? \"opaque\" : \"transparent\");\r\n        wnome = \"transparent\";\r\n        this.conf.swf_obj_id = \"dhxVaultSWFObject_\" + window.dhx4.newId();\r\n        this.conf.swf_file = this.conf.swf_file + (this.conf.swf_file.indexOf(\"?\") >= 0 ? \"&\" : \"?\") + \"dhxr\" + new Date().getTime();\r\n        if (window.dhx4.isIE) {\r\n            this.buttons.browse.innerHTML += \"<div style='position:absolute;width:100%;height:100%;background-color:white;opacity:0;filter:alpha(opacity=0);left:0px;top:0px;'></div>\";\r\n            if (window.dhx4.isIE6 || window.dhx4.isIE7) {\r\n                this.buttons.browse.style.filter = \"\"\r\n            }\r\n        }\r\n        this.buttons.browse.innerHTML += \"<div class='dhx_vault_flash_obj'><div id='\" + this.conf.swf_obj_id + \"'></div></div>\";\r\n        swfobject.embedSWF(this.conf.swf_file, this.conf.swf_obj_id, \"100%\", \"100%\", \"9\", null , {\r\n            ID: this.conf.swf_obj_id,\r\n            enableLogs: this.conf.swf_logs,\r\n            GVar: \"dhtmlXVaultSWFObjects\",\r\n            paramName: this.conf.param_name,\r\n            multiple: (this.conf.multiple_files ? \"Y\" : \"\")\r\n        }, {\r\n            wmode: b\r\n        });\r\n        if ((window.dhx4.isIE6 || window.dhx4.isIE7) && this.conf.skin == \"dhx_skyblue\") {\r\n            if (this.base.parentNode != null  && this.base.parentNode.parentNode != null  && this.base.parentNode.parentNode.className != null  && this.base.parentNode.parentNode.className == \"dhx_cell_wins\") {\r\n                this.base.parentNode.parentNode.style.filter = \"none\"\r\n            }\r\n        }\r\n        var a = swfobject.getFlashPlayerVersion();\r\n        this.conf.progress_type = \"percentage\";\r\n        window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id] = {\r\n            id: this.conf.swf_obj_id,\r\n            uploader: this\r\n        }\r\n    },\r\n    _beforeAddFileToQueue: function(b, c, a) {\r\n        return ( this.callEvent(\"onBeforeFileAdd\", [{\r\n            id: null ,\r\n            name: b,\r\n            size: c,\r\n            lastModifiedDate: a,\r\n            serverName: null ,\r\n            uploaded: false,\r\n            error: false\r\n        }]) === true ? 1 : 0) \r\n    },\r\n    _addFileToQueue: function(e, c, d, b) {\r\n        if (window.dhx4.isIE) {\r\n            var a = document.createElement(\"INPUT\");\r\n            a.type = \"TEXT\";\r\n            a.style.position = \"absolute\";\r\n            a.style.left = \"0px\";\r\n            a.style.top = window.dhx4.absTop(this.buttons.browse) + \"px\";\r\n            a.style.width = \"10px\";\r\n            document.body.appendChild(a);\r\n            a.focus();\r\n            document.body.removeChild(a);\r\n            a = null \r\n        }\r\n        this.file_data[e] = {\r\n            file: {\r\n                lastModifiedDate: b\r\n            },\r\n            name: c,\r\n            size: d,\r\n            state: \"added\"\r\n        };\r\n        this._addFileToList(e, c, d, \"added\", 0);\r\n        if (this.conf.auto_start && !this.conf.uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(e) {\r\n        if (!this.file_data[e]) {\r\n            return\r\n        }\r\n        var c = this.file_data[e].name;\r\n        var d = (this.conf.uploaded_files != null  && this.conf.uploaded_files[e] != null  ? this.conf.uploaded_files[e].serverName : null );\r\n        var b = {\r\n            id: Number(e),\r\n            name: c,\r\n            size: this.file_data[e].size,\r\n            serverName: d,\r\n            uploaded: (this.file_data[e].state == \"uploaded\"),\r\n            error: (this.file_data[e].state == \"fail\")\r\n        };\r\n        if (this.callEvent(\"onBeforeFileRemove\", [b]) !== true) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this.conf.uploading && this.file_data[e].state == \"uploading\") {\r\n            this._uploadStop();\r\n            a = true\r\n        }\r\n        swfobject.getObjectById(this.conf.swf_obj_id).removeFileById(e);\r\n        this.file_data[e].name = null ;\r\n        this.file_data[e].size = null ;\r\n        this.file_data[e].state = null ;\r\n        this.file_data[e] = null ;\r\n        delete this.file_data[e];\r\n        this._removeFileFromList(e);\r\n        this.callEvent(\"onFileRemove\", [b]);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _doUploadFile: function(a) {\r\n        if (this.file_data[a].custom == true) {\r\n            this._cfUploadStart(a)\r\n        } else {\r\n            swfobject.getObjectById(this.conf.swf_obj_id).upload(a, this.conf.swf_url)\r\n        }\r\n    },\r\n    _uploadStop: function(c) {\r\n        if (this.cf_loader_id != null ) {\r\n            this._cfUploadStop()\r\n        } else {\r\n            for (var b in this.file_data) {\r\n                if (this.file_data[b].state == \"uploading\") {\r\n                    swfobject.getObjectById(this.conf.swf_obj_id).uploadStop(b)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _getId: function() {\r\n        return window.dhx4.newId()\r\n    },\r\n    _unloadEngine: function() {\r\n        if (window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id]) {\r\n            window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id].id = null ;\r\n            window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id].uploader = null ;\r\n            window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id] = null ;\r\n            delete window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id]\r\n        }\r\n        this.conf.swf_obj_id = null ;\r\n        this._initEngine = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXVaultObject.prototype.setSWFURL = function(a) {\r\n    this.conf.swf_url = a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.sl = function() {}\r\n;\r\ndhtmlXVaultObject.prototype.sl.prototype = {\r\n    _initEngine: function() {\r\n        if (typeof (this.conf.sl_v) == \"undefined\") {\r\n            this.conf.sl_v = this.getSLVersion()\r\n        }\r\n        if (!window.dhtmlXVaultSLObjects) {\r\n            window.dhtmlXVaultSLObjects = {\r\n                items: {},\r\n                callEvent: function(c, a, b) {\r\n                    window.dhtmlXVaultSLObjects.items[c].uploader[a].apply(window.dhtmlXVaultSLObjects.items[c].uploader, b)\r\n                }\r\n            }\r\n        }\r\n        this.conf.sl_obj_id = \"dhtmlXFileUploaderSLObject_\" + window.dhx4.newId();\r\n        if (this.conf.sl_v != false) {\r\n            this.buttons.browse.innerHTML += '<div style=\"width:100%;height:100%;left:0px;top:0px;position:absolute;\"><object data=\"data:application/x-silverlight-2,\" type=\"application/x-silverlight-2\" width=\"100%\" height=\"100%\" id=\"' + this.conf.sl_obj_id + '\"><param name=\"source\" value=\"' + this.conf.sl_xap + '\"/><param name=\"background\" value=\"Transparent\"/><param name=\"windowless\" value=\"true\"/><param name=\"initParams\" value=\"SLID=' + this.conf.sl_obj_id + \",LOGS=\" + this.conf.sl_logs + ',GVAR=dhtmlXVaultSLObjects\"/><param name=\"minRuntimeVersion\" value=\"5.0\"/></object></div>'\r\n        } else {\r\n            this.buttons.browse.style.cursor = \"wait\";\r\n            this.buttons.browse.title = \"\"\r\n        }\r\n        this.conf.progress_type = \"percentage\";\r\n        window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id] = {\r\n            id: this.conf.sl_obj_id,\r\n            uploader: this\r\n        }\r\n    },\r\n    _addFileToQueue: function(c, a, b) {\r\n        this.file_data[c] = {\r\n            name: a,\r\n            size: b,\r\n            state: \"added\",\r\n            file: {\r\n                lastModifiedDate: null \r\n            }\r\n        };\r\n        this._addFileToList(c, a, b, \"added\", 0);\r\n        if (this.conf.auto_start && !this.conf.uploading) {\r\n            this._uploadStart(true)\r\n        }\r\n    },\r\n    _removeFileFromQueue: function(b) {\r\n        if (!this.file_data[b]) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this.conf.uploading && this.file_data[b].state == \"uploading\") {\r\n            this._uploadStop();\r\n            a = true\r\n        }\r\n        document.getElementById([this.conf.sl_obj_id]).Content.a.removeFileById(b);\r\n        this.file_data[b].name = null ;\r\n        this.file_data[b].size = null ;\r\n        this.file_data[b].state = null ;\r\n        this.file_data[b].file = null ;\r\n        this.file_data[b] = null ;\r\n        delete this.file_data[b];\r\n        this._removeFileFromList(b);\r\n        if (a) {\r\n            this._uploadStart()\r\n        }\r\n    },\r\n    _doUploadFile: function(b) {\r\n        var a = this.conf.sl_url.split(\"?\");\r\n        a = (a[1] != null  ? \"&\" + a[1] : \"\");\r\n        document.getElementById(this.conf.sl_obj_id).Content.a.upload(b, this.conf.sl_url, a + \"&mode=sl&dhxr\" + new Date().getTime())\r\n    },\r\n    _uploadStop: function(c) {\r\n        this.conf.uploading = false;\r\n        for (var b in this.file_data) {\r\n            if (this.file_data[b].state == \"uploading\") {\r\n                document.getElementById(this.conf.sl_obj_id).Content.a.uploadStop(b)\r\n            }\r\n        }\r\n    },\r\n    _unloadEngine: function() {\r\n        if (window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id]) {\r\n            window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id].id = null ;\r\n            window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id].uploader = null ;\r\n            window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id] = null ;\r\n            delete window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id]\r\n        }\r\n        this.conf.sl_obj_id = null ;\r\n        this._initEngine = null ;\r\n        this._addFileToQueue = null ;\r\n        this._removeFileFromQueue = null ;\r\n        this._doUploadFile = null ;\r\n        this._uploadStop = null ;\r\n        this._unloadEngine = null \r\n    }\r\n};\r\ndhtmlXVaultObject.prototype.setSLURL = function(a) {\r\n    this.conf.sl_url = a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.getSLVersion = function() {\r\n    var a = false;\r\n    if (window.dhx4.isIE) {\r\n        try {\r\n            var b = new ActiveXObject(\"AgControl.AgControl\");\r\n            if (b != null ) {\r\n                var f = 4\r\n                  , d = 0;\r\n                while (b.isVersionSupported([f, d].join(\".\"))) {\r\n                    a = [f, d];\r\n                    if (++d > 9) {\r\n                        f++;\r\n                        d = 0\r\n                    }\r\n                }\r\n            }\r\n            b = null \r\n        } catch (c) {}\r\n    } else {\r\n        if (navigator.plugins[\"Silverlight Plug-In\"] != null ) {\r\n            a = navigator.plugins[\"Silverlight Plug-In\"].description.split(\".\")\r\n        }\r\n    }\r\n    return a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.list_default = function() {\r\n    this.t = {};\r\n    this.n = {};\r\n    this.addFileItem = function(c, a) {\r\n        var b = document.createElement(\"DIV\");\r\n        b._idd = c;\r\n        a.appendChild(b);\r\n        this.t[c] = b;\r\n        b = a = null \r\n    }\r\n    ;\r\n    this.isFileItemExist = function(a) {\r\n        return ( this.t[a] != null ) \r\n    }\r\n    ;\r\n    this.renderFileRecord = function(c, b) {\r\n        var a = this.t[c];\r\n        if (!a == null ) {\r\n            return\r\n        }\r\n        a.className = \"dhx_vault_file dhx_vault_file_\" + b.state;\r\n        a.innerHTML = \"<div class='dhx_vault_file_param dhx_vault_file_name'>&nbsp;</div><div class='dhx_vault_file_param dhx_vault_file_progress'>&nbsp;</div><div class='dhx_vault_file_param dhx_vault_file_delete'>&nbsp;</div><div class='dhx_vault_file_icon dhx_vault_\" + b.icon + \"'><div class='dhx_vault_all_icons'></div></div>\";\r\n        a.childNodes[2]._action = {\r\n            id: c,\r\n            data: \"delete_file\"\r\n        };\r\n        this.updateFileNameSize(c, b);\r\n        a = null \r\n    }\r\n    ;\r\n    this.removeFileRecord = function(b) {\r\n        var a = this.t[b];\r\n        if (a == null ) {\r\n            return\r\n        }\r\n        a._idd = null ;\r\n        a.childNodes[2]._action = null ;\r\n        a.parentNode.removeChild(a);\r\n        a = null ;\r\n        this.n[b] = this.t[b] = null ;\r\n        delete this.t[b];\r\n        delete this.n[b]\r\n    }\r\n    ;\r\n    this.updateFileNameSize = function(f, d) {\r\n        var c = this.t[f];\r\n        if (c == null ) {\r\n            return\r\n        }\r\n        if (this.n[f] == null ) {\r\n            this.n[f] = {}\r\n        }\r\n        for (var b in {\r\n            name: true,\r\n            size: true,\r\n            readableSize: true\r\n        }) {\r\n            if (d[b] != null ) {\r\n                this.n[f][b] = d[b]\r\n            } else {\r\n                d[b] = this.n[f][b]\r\n            }\r\n        }\r\n        var e = d.name + (!isNaN(d.size) && d.size !== false ? \" (\" + d.readableSize + \")\" : \"&nbsp;\");\r\n        if (d.download == true) {\r\n            e = \"<a href='javascript:void(0);'>\" + e + \"</a>\"\r\n        }\r\n        c.childNodes[0].innerHTML = \"<div class='dhx_vault_file_name_text'>\" + e + \"</div>\";\r\n        c.childNodes[0].title = d.name + (!isNaN(d.size) && d.size !== false ? \" (\" + d.readableSize + \")\" : \"\");\r\n        if (d.download == true) {\r\n            c.childNodes[0].childNodes[0].childNodes[0]._action = {\r\n                id: f,\r\n                data: \"download_file\"\r\n            }\r\n        }\r\n        c = null \r\n    }\r\n    ;\r\n    this.updateFileState = function(d, c) {\r\n        var b = this.t[d];\r\n        if (b == null ) {\r\n            return\r\n        }\r\n        var a = false;\r\n        if (this.updateFileStateExtra != null ) {\r\n            a = this.updateFileStateExtra(d, c)\r\n        }\r\n        if (!a) {\r\n            if (c.state == \"added\") {\r\n                b.className = \"dhx_vault_file dhx_vault_file_added\";\r\n                b.childNodes[1].className = \"dhx_vault_file_param dhx_vault_file_progress\";\r\n                b.childNodes[1].innerHTML = \"&nbsp;\"\r\n            }\r\n            if (c.state == \"fail\") {\r\n                b.className = \"dhx_vault_file dhx_vault_file_fail\";\r\n                b.childNodes[1].className = \"dhx_vault_file_param dhx_vault_file_progress\";\r\n                b.childNodes[1].innerHTML = c.str_error\r\n            }\r\n            if (c.state == \"size_exceeded\") {\r\n                b.className = \"dhx_vault_file dhx_vault_file_size_exceeded\";\r\n                b.childNodes[1].className = \"dhx_vault_file_param dhx_vault_file_progress\";\r\n                b.childNodes[1].innerHTML = c.str_size_exceeded\r\n            }\r\n            if (c.state == \"uploaded\") {\r\n                b.className = \"dhx_vault_file dhx_vault_file_uploaded\";\r\n                b.childNodes[1].className = \"dhx_vault_file_param dhx_vault_file_progress\";\r\n                b.childNodes[1].innerHTML = c.str_done\r\n            }\r\n            if (c.state == \"uploading_html4\" || c.state == \"uploading\") {\r\n                b.className = \"dhx_vault_file dhx_vault_file_uploading\";\r\n                b.childNodes[1].className = \"dhx_vault_file_param dhx_vault_file_uploading\";\r\n                b.childNodes[1].innerHTML = \"<div class='dhx_vault_progress'><div class='dhx_vault_progress_loader'>&nbsp;</div></div>\"\r\n            }\r\n        }\r\n        b = null \r\n    }\r\n    ;\r\n    this.updateStrings = function() {}\r\n    ;\r\n    this.unload = function() {\r\n        this.t = null \r\n    }\r\n}\r\n;\r\nif (typeof (window.dhtmlXCellObject) != \"undefined\" && typeof (dhtmlXCellObject.prototype.attachVault) == \"undefined\") {\r\n    dhtmlXCellObject.prototype.attachVault = function(a) {\r\n        var b = document.createElement(\"DIV\");\r\n        b.style.position = \"relative\";\r\n        b.style.width = \"100%\";\r\n        b.style.height = \"100%\";\r\n        b.style.overflow = \"hidden\";\r\n        this._attachObject(b);\r\n        b._attach_mode = true;\r\n        b._no_border = true;\r\n        if (typeof (window.dhtmlXWindowsCell) != \"undefined\" && this instanceof dhtmlXWindowsCell) {\r\n            b._no_border = false\r\n        }\r\n        if (typeof (a) != \"object\" || a == null ) {\r\n            a = {}\r\n        }\r\n        a.parent = b;\r\n        if (typeof (a.skin) == \"undefined\") {\r\n            a.skin = this.conf.skin\r\n        }\r\n        this.dataType = \"vault\";\r\n        this.dataObj = new dhtmlXVaultObject(a);\r\n        if (typeof (window.dhtmlXLayoutCell) != \"undefined\" && this instanceof dhtmlXLayoutCell) {\r\n            this.layout._getMainInst().attachEvent(\"onExpand\", function(d) {\r\n                for (var e = 0; e < d.length; e++) {\r\n                    var c = this.cells(d[e]);\r\n                    if (c.dataType == \"vault\" && c.dataObj != null ) {\r\n                        c.dataObj.setSizes()\r\n                    }\r\n                    c = null \r\n                }\r\n            })\r\n        }\r\n        a.parent = null ;\r\n        a = b = null ;\r\n        return this.dataObj\r\n    }\r\n}\r\ndhtmlXVaultObject.prototype.buttonCss = {\r\n    bootstrap: {\r\n        browse: \"_browse\",\r\n        upload: \"_upload\",\r\n        cancel: \"_cancel\",\r\n        clear: \"_clear\"\r\n    }\r\n};\r\nif (typeof (window.dhtmlXPopup) != \"undefined\" && typeof (dhtmlXPopup.prototype.attachVault) == \"undefined\") {\r\n    dhtmlXPopup.prototype.attachVault = function(c, a, b) {\r\n        return this._attachNode(\"vault\", {\r\n            width: c || 350,\r\n            height: a || 200,\r\n            conf: b || {}\r\n        })\r\n    }\r\n    ;\r\n    dhtmlXPopup.prototype._attach_init_vault = function(a) {\r\n        a.conf.parent = this._nodeId;\r\n        document.getElementById(this._nodeId)._no_border = true;\r\n        if (typeof (a.conf.skin) == \"undefined\") {\r\n            a.conf.skin = this.conf.skin\r\n        }\r\n        this._nodeObj = new dhtmlXVaultObject(a.conf)\r\n    }\r\n}\r\ndhtmlXVaultObject.prototype.load = function(a, b) {\r\n    if (this.conf.dataload_inited != true) {\r\n        this.conf.dataload_inited = true;\r\n        if (typeof (this.conf.dataload_progress) == \"undefined\") {\r\n            this.conf.dataload_progress = true\r\n        }\r\n        this.attachEvent(\"onXLS\", this._progressOn);\r\n        this.attachEvent(\"onXLE\", this._progressOff);\r\n        window.dhx4._enableDataLoading(this, \"_initObj\", \"_xmlToObj\", \"files\", {\r\n            data: true\r\n        });\r\n        this.load.apply(this, arguments)\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.addFileRecord = function(b, a) {\r\n    if (a == null  || {\r\n        added: true,\r\n        uploaded: true\r\n    }[a] != true) {\r\n        return\r\n    }\r\n    var c = window.dhx4.newId();\r\n    if (typeof (b.name) == \"undefined\" || b.name == null ) {\r\n        b.name = \"New File Record\"\r\n    }\r\n    if (typeof (b.size) == \"undefined\" || b.size == null ) {\r\n        b.size = false\r\n    }\r\n    this.file_data[c] = {\r\n        file: {}\r\n    };\r\n    this._addFileToList(c, b.name, b.size, a, 0);\r\n    if (a == \"uploaded\") {\r\n        if (typeof (b.serverName) == \"undefined\" && b.serverName == null ) {\r\n            b.serverName = b.name\r\n        }\r\n        this.conf.uploaded_files[c] = {\r\n            realName: b.name,\r\n            serverName: b.serverName\r\n        };\r\n        if (this.conf.download_url.length > 0) {\r\n            this.list.updateFileNameSize(c, {\r\n                download: true\r\n            })\r\n        }\r\n    }\r\n    this.file_data[c] = {\r\n        name: b.name,\r\n        size: b.size,\r\n        state: a,\r\n        file: {},\r\n        custom: true,\r\n        fileData: b\r\n    };\r\n    this.list.updateFileState(c, {\r\n        state: a,\r\n        str_done: this.strings.done\r\n    });\r\n    if (this.conf.auto_start && !this.conf.uploading) {\r\n        this._uploadStart(true)\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._cfOnUpload = function() {\r\n    if (this.cf_loader_id == null ) {\r\n        return\r\n    }\r\n    var id = this.cf_loader_id;\r\n    this.cf_loader_id = null ;\r\n    dhx4.temp = null ;\r\n    try {\r\n        eval(\"dhx4.temp=\" + this.cf_loader.responseText)\r\n    } catch (e) {}\r\n    var r = dhx4.temp;\r\n    dhx4.temp = null ;\r\n    try {\r\n        this.cf_loader.onreadystatechange = null ;\r\n        this.cf_loader = null \r\n    } catch (e) {}\r\n    try {\r\n        delete this.cf_loader.onreadystatechange;\r\n        delete this.cf_loader\r\n    } catch (e) {}\r\n    if (r != null  && typeof (r) == \"object\" && typeof (r.state) != \"undefined\" && r.state == true) {\r\n        if (this.file_data[id].custom == true && typeof (r.size) != \"undefined\") {\r\n            this._cfUpdateSize(id, r.size)\r\n        }\r\n        this._onUploadSuccess(id, r.name, undefined, r.extra)\r\n    } else {\r\n        this._onUploadFail(id, (r != null  && r.extra != null  ? r.extra : null ))\r\n    }\r\n    r = null \r\n}\r\n;\r\ndhtmlXVaultObject.prototype._cfUpdateSize = function(d, c) {\r\n    this.file_data[d].size = c;\r\n    var a = {\r\n        name: this.file_data[d].name,\r\n        size: this.file_data[d].size,\r\n        readableSize: this.readableSize(this.file_data[d].size || 0)\r\n    };\r\n    var b = this;\r\n    window.setTimeout(function() {\r\n        b.list.updateFileNameSize(d, a);\r\n        b = a = null \r\n    }, 100)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._cfUploadStart = function(e) {\r\n    var c = [\"mode=custom\"];\r\n    for (var b in this.file_data[e].fileData) {\r\n        c.push(encodeURIComponent(b) + \"=\" + encodeURIComponent(this.file_data[e].fileData[b]))\r\n    }\r\n    c = c.join(\"&\");\r\n    var d = this;\r\n    this.cf_loader = (window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\"));\r\n    this.cf_loader.onreadystatechange = function() {\r\n        if (d.cf_loader.readyState == 4) {\r\n            if (d.cf_loader.status == 200) {\r\n                d._cfOnUpload()\r\n            } else {\r\n                if (d.cf_loader.status == 404) {\r\n                    d._onUploadFail(d.cf_loader_id)\r\n                }\r\n            }\r\n            d = null \r\n        }\r\n    }\r\n    ;\r\n    if (window.dhx4.ajax.cache != true) {\r\n        c += (c.length > 0 ? \"&\" : \"\") + \"dhxr\" + new Date().getTime()\r\n    }\r\n    this.cf_loader_id = e;\r\n    this.cf_loader.open(\"POST\", this.conf.url, true);\r\n    this.cf_loader.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n    this.cf_loader.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n    this.cf_loader.send(c)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._cfUploadStop = function() {\r\n    var a = this.cf_loader_id;\r\n    this.cf_loader_id = null ;\r\n    this.cf_loader.abort();\r\n    this._onUploadAbort(a)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._initObj = function(b) {\r\n    for (var a = 0; a < b.length; a++) {\r\n        this.addFileRecord(b[a], \"uploaded\")\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._xmlToObj = function(j) {\r\n    var h = [];\r\n    if (!this.conf.xml_attrs) {\r\n        this.conf.xml_attrs = {\r\n            name: \"name\",\r\n            size: \"size\",\r\n            serverName: \"serverName\"\r\n        }\r\n    }\r\n    var d = j.getElementsByTagName(\"files\")[0];\r\n    for (var g = 0; g < d.childNodes.length; g++) {\r\n        if (d.childNodes[g].tagName != null  && String(d.childNodes[g].tagName).toLowerCase() == \"file\") {\r\n            var c = d.childNodes[g];\r\n            var e = {};\r\n            for (var b in this.conf.xml_attrs) {\r\n                if (c.getAttribute(b) != null ) {\r\n                    e[this.conf.xml_attrs[b]] = c.getAttribute(b)\r\n                }\r\n            }\r\n            h.push(e);\r\n            c = e = null \r\n        }\r\n    }\r\n    return h\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._progressOn = function() {\r\n    if (this.conf.dataload_progress == true) {\r\n        if (this.conf.progress_tm != null ) {\r\n            window.clearTimeout(this.conf.progress_tm)\r\n        }\r\n        if (this.p_progress == null ) {\r\n            this.p_progress = document.createElement(\"DIV\");\r\n            this.p_progress.className = \"dhx_vault_f_pr\";\r\n            this.base.appendChild(this.p_progress);\r\n            if (typeof (this.conf.progress_event) == \"undefined\") {\r\n                this.conf.progress_event = this.attachEvent(\"_onSetSizes\", this._progressAdjust)\r\n            }\r\n            this._progressAdjust()\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._progressOff = function() {\r\n    var a = this;\r\n    if (this.conf.progress_tm != null ) {\r\n        window.clearTimeout(this.conf.progress_tm)\r\n    }\r\n    this.conf.progress_tm = window.setTimeout(function() {\r\n        if (a.p_progress != null ) {\r\n            a.p_progress.parentNode.removeChild(a.p_progress);\r\n            a.p_progress = null \r\n        }\r\n        a = null \r\n    }, 200)\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._progressAdjust = function() {\r\n    if (this.p_progress != null ) {\r\n        this.p_progress.style.left = this.p_files.style.left;\r\n        this.p_progress.style.top = this.p_files.style.top;\r\n        this.p_progress.style.width = this.p_files.style.width;\r\n        this.p_progress.style.height = this.p_files.style.height\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._initDND = function() {\r\n    var a = this;\r\n    this.dnd = {};\r\n    this._showDNDBox = function() {\r\n        if (!this.conf.enabled) {\r\n            return\r\n        }\r\n        if (!this.dnd.box) {\r\n            this.dnd.box = document.createElement(\"DIV\");\r\n            this.dnd.box.className = \"dhx_vault_dnd_box\";\r\n            this.base.appendChild(this.dnd.box);\r\n            this.p_files.className = \"dhx_vault_files dhx_vault_dnd_box_over\";\r\n            this.dnd.box.style.top = this.p_files.style.top;\r\n            this.dnd.box.style.left = this.p_files.style.left;\r\n            this.dnd.box.style.width = this.p_files.offsetWidth - (this.dnd.box.offsetWidth - this.dnd.box.clientWidth) + \"px\";\r\n            this.dnd.box.style.height = this.p_files.offsetHeight - (this.dnd.box.offsetHeight - this.dnd.box.clientHeight) + \"px\";\r\n            this.dnd.box.innerHTML = \"<div class='dhx_vault_dnd_box_text' style='margin-top:\" + Math.round(this.dnd.box.offsetHeight / 2 - 24) + \"px;'>\" + this.strings.dnd + \"</div>\";\r\n            this.dnd.box.ondragenter = function(b) {\r\n                a.dnd.last_node = b.target;\r\n                if (!b.dataTransfer) {\r\n                    return\r\n                }\r\n                try {\r\n                    b.dataTransfer.effectAllowed = \"copy\";\r\n                    b.dataTransfer.dropEffect = \"copy\"\r\n                } catch (c) {}\r\n                b.stopPropagation();\r\n                b.preventDefault()\r\n            }\r\n            ;\r\n            this.dnd.box.ondragover = function(b) {\r\n                a.dnd.last_node = b.target;\r\n                if (!b.dataTransfer) {\r\n                    return\r\n                }\r\n                b.stopPropagation();\r\n                b.preventDefault()\r\n            }\r\n            ;\r\n            this.dnd.box.ondrop = function(b) {\r\n                if (!b.dataTransfer) {\r\n                    return\r\n                }\r\n                try {\r\n                    b.dataTransfer.effectAllowed = \"copy\";\r\n                    b.dataTransfer.dropEffect = \"copy\"\r\n                } catch (c) {}\r\n                b.stopPropagation();\r\n                b.preventDefault();\r\n                if (b.dataTransfer.files.length > 0) {\r\n                    a._parseFilesInInput(b.dataTransfer.files)\r\n                } else {\r\n                    a.callEvent(\"_onNodeDrop\", [b.dataTransfer])\r\n                }\r\n                a._hideDNDBox()\r\n            }\r\n        }\r\n    }\r\n    ;\r\n    this._hideDNDBox = function() {\r\n        if (this.dnd.box != null ) {\r\n            this.dnd.box.ondragenter = null ;\r\n            this.dnd.box.ondragover = null ;\r\n            this.dnd.box.ondrop = null ;\r\n            this.dnd.box.parentNode.removeChild(this.dnd.box);\r\n            this.dnd.box = null ;\r\n            this.p_files.className = \"dhx_vault_files\";\r\n            this.dnd.last_node = null \r\n        }\r\n    }\r\n    ;\r\n    this.dnd.last_node = null ;\r\n    this._doOnWinDragEnter = function(b) {\r\n        a.dnd.last_node = b.target;\r\n        a._showDNDBox()\r\n    }\r\n    ;\r\n    this._doOnWinDragLeave = function(b) {\r\n        if (a.dnd.last_node == b.target) {\r\n            window.setTimeout(function() {\r\n                a._hideDNDBox()\r\n            }, 1)\r\n        }\r\n    }\r\n    ;\r\n    window.addEventListener(\"dragenter\", this._doOnWinDragEnter, false);\r\n    window.addEventListener(\"dragleave\", this._doOnWinDragLeave, false);\r\n    this._doOnWinDragOver = function(b) {\r\n        if (!b.dataTransfer) {\r\n            return\r\n        }\r\n        try {\r\n            b.dataTransfer.effectAllowed = \"none\";\r\n            b.dataTransfer.dropEffect = \"none\"\r\n        } catch (c) {}\r\n        b.stopPropagation();\r\n        b.preventDefault()\r\n    }\r\n    ;\r\n    this._doOnWinDrop = function(b) {\r\n        if (!b.dataTransfer) {\r\n            return\r\n        }\r\n        b.stopPropagation();\r\n        b.preventDefault();\r\n        a._hideDNDBox()\r\n    }\r\n    ;\r\n    window.addEventListener(\"dragover\", this._doOnWinDragOver, false);\r\n    window.addEventListener(\"drop\", this._doOnWinDrop, false);\r\n    this._unloadDND = function() {\r\n        window.removeEventListener(\"dragenter\", this._doOnWinDragEnter, false);\r\n        window.removeEventListener(\"dragleave\", this._doOnWinDragLeave, false);\r\n        window.removeEventListener(\"dragover\", this._doOnWinDragOver, false);\r\n        window.removeEventListener(\"drop\", this._doOnWinDrop, false);\r\n        for (var b in this._dndNodesData) {\r\n            if (this._dndNodesData[b].inst_id == this.conf.inst_id) {\r\n                this.removeDraggableNode(this._dndNodesData[b].node)\r\n            }\r\n        }\r\n        this._hideDNDBox();\r\n        this._showDNDBox = null ;\r\n        this._hideDNDBox = null ;\r\n        this._doOnWinDragEnter = null ;\r\n        this._doOnWinDragLeave = null ;\r\n        this._doOnWinDragOver = null ;\r\n        this._doOnWinDrop = null ;\r\n        this._initDND = null ;\r\n        this._unloadDND = null ;\r\n        this.dnd = null ;\r\n        a = null \r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.strings.dnd = \"Drop files here\";\r\ndhtmlXVaultObject.prototype._dndNodesData = {};\r\ndhtmlXVaultObject.prototype.addDraggableNode = function(a, b) {\r\n    if (typeof (window.addEventListener) != \"function\") {\r\n        return\r\n    }\r\n    if (typeof (a) == \"string\") {\r\n        a = document.getElementById(a)\r\n    }\r\n    if (typeof (a._dhxvault_dnd_id) != \"undefined\") {\r\n        a = null ;\r\n        return\r\n    }\r\n    if (this.conf.inst_id == null ) {\r\n        this.conf.inst_id = window.dhx4.newId()\r\n    }\r\n    if (this._onNodeDragStart == null ) {\r\n        this._onNodeDragStart = function(d) {\r\n            d = d || event;\r\n            d.dataTransfer.setData(\"text\", this._dhxvault_dnd_id)\r\n        }\r\n        ;\r\n        this._onNodeDrop = function(d) {\r\n            var e = d.getData(\"text\");\r\n            if (e != null  && this._dndNodesData[e] != null ) {\r\n                this.callEvent(\"onDrop\", [this._dndNodesData[e].node, this._dndNodesData[e].data])\r\n            }\r\n        }\r\n        ;\r\n        this.attachEvent(\"_onNodeDrop\", this._onNodeDrop)\r\n    }\r\n    var c = String(window.dhx4.newId());\r\n    a._dhxvault_dnd_id = c;\r\n    this._dndNodesData[c] = {\r\n        inst_id: this.conf.inst_id,\r\n        node: a,\r\n        data: b\r\n    };\r\n    a.addEventListener(\"dragstart\", this._onNodeDragStart, false);\r\n    a = null \r\n}\r\n;\r\ndhtmlXVaultObject.prototype.removeDraggableNode = function(a) {\r\n    if (typeof (a) == \"string\") {\r\n        a = document.getElementById(a)\r\n    }\r\n    if (typeof (a._dhxvault_dnd_id) == \"undefined\") {\r\n        a = null ;\r\n        return\r\n    }\r\n    this._dndNodesData[a._dhxvault_dnd_id].node = null ;\r\n    this._dndNodesData[a._dhxvault_dnd_id].data = null ;\r\n    delete this._dndNodesData[a._dhxvault_dnd_id];\r\n    delete a._dhxvault_dnd_id;\r\n    a.removeEventListener(\"dragstart\", this._onNodeDragStart);\r\n    a = null \r\n}\r\n;\r\ndhtmlXVaultObject.prototype.setProgressMode = function(a) {\r\n    this.conf.progress_mode = a\r\n}\r\n;\r\ndhtmlXVaultObject.prototype.list_default.prototype.updateFileStateExtra = function(c, b) {\r\n    var a = this.t[c];\r\n    if (a == null ) {\r\n        return\r\n    }\r\n    if (b.state == \"uploading\") {\r\n        a.className = \"dhx_vault_file dhx_vault_file_uploading\";\r\n        a.childNodes[1].className = \"dhx_vault_file_param dhx_vault_file_progress\";\r\n        a.childNodes[1].innerHTML = \"<div class='dhx_vault_progress'><div class='dhx_vault_progress_bg' style='width:\" + b.progress + \"%;'>&nbsp;</div></div>\" + (b.eta != null  ? \"<span class='progress_eta'>\" + b.eta + \"</span>\" : \"\")\r\n    }\r\n    a = null ;\r\n    return ( b.state == \"uploading\") \r\n}\r\n;\r\ndhtmlXVaultObject.prototype._etaStart = function(a) {\r\n    if (typeof (this.conf.files_time) == \"undefined\") {\r\n        this.conf.files_time = {}\r\n    }\r\n    if (this.conf.files_time[a] == null ) {\r\n        this.conf.files_time[a] = {\r\n            start: new Date().getTime(),\r\n            end: 0,\r\n            size: this.file_data[a].size\r\n        }\r\n    }\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._etaCheck = function(g, a) {\r\n    var b = null ;\r\n    if (this.conf.files_time[g] != null  && a > 0) {\r\n        var c = (new Date().getTime() - this.conf.files_time[g].start) / 1000;\r\n        var f = (c * 100 / a - c).toFixed(0);\r\n        var e = new Date().getTime();\r\n        if ((this.conf.files_time[g].time_upd == null  || this.conf.files_time[g].time_upd + 1100 < e) && this.conf.files_time[g].start + 3000 < e) {\r\n            this.conf.files_time[g].time_left = Math.max(1, f);\r\n            this.conf.files_time[g].time_upd = e\r\n        }\r\n        if (this.conf.files_time[g].time_left != null ) {\r\n            b = this._timeHIS(this.conf.files_time[g].time_left)\r\n        }\r\n    }\r\n    return b\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._etaEnd = function(a) {\r\n    this.conf.files_time[a] = null ;\r\n    delete this.conf.files_time[a]\r\n}\r\n;\r\ndhtmlXVaultObject.prototype._timeHIS = function(d) {\r\n    var b = [\"h\", \"m\", \"s\"];\r\n    var e = [];\r\n    var a = 3600;\r\n    for (var f = 0; f < 3; f++) {\r\n        var c = Math.floor(d / a);\r\n        d = d - c * a;\r\n        if (c > 0 || e.length > 0) {\r\n            e.push(String(c) + b[f])\r\n        }\r\n        if (a > 1) {\r\n            a = a / 60\r\n        }\r\n    }\r\n    return e.join(\" \")\r\n}\r\n;\r\n"

/***/ },
/* 6 */
/*!********************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/WebContent/codebase/sources/dhtmlxscheduler.js ***!
  \********************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var dhtmlx = __webpack_require__(/*! dhtmlx */ 2);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/sources/dhtmlxscheduler.js */ 7)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/sources/dhtmlxscheduler.js")


/***/ },
/* 7 */
/*!***********************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/sources/dhtmlxscheduler.js ***!
  \***********************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\n@license\r\ndhtmlxScheduler v.4.3.1 \r\n\r\nThis software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n\r\n(c) Dinamenta, UAB.\r\n*/\r\nwindow.dhtmlXScheduler = window.scheduler = { version: \"4.3.1\" };\r\n\r\nif (!window.dhtmlx) {\r\n\tdhtmlx = function(obj){\r\n\t\tfor (var a in obj) dhtmlx[a]=obj[a];\r\n\t\treturn dhtmlx; //simple singleton\r\n\t};\r\n}\r\ndhtmlx.extend_api=function(name,map,ext){\r\n    var t = window[name];\r\n    if (!t) return; //component not defined\r\n    window[name]=function(obj){\r\n        var that;\r\n\r\n        if (obj && typeof obj == \"object\" && !obj.tagName){\r\n            that = t.apply(this,(map._init?map._init(obj):arguments));\r\n            //global settings\r\n            for (var a in dhtmlx)\r\n                if (map[a]) this[map[a]](dhtmlx[a]);\r\n            //local settings\r\n            for (var a in obj){\r\n                if (map[a]) this[map[a]](obj[a]);\r\n                else if (a.indexOf(\"on\")===0){\r\n                    this.attachEvent(a,obj[a]);\r\n                }\r\n            }\r\n        } else\r\n            that = t.apply(this,arguments);\r\n        if (map._patch) map._patch(this);\r\n        return that||this;\r\n    };\r\n    window[name].prototype=t.prototype;\r\n    if (ext)\r\n        dhtmlXHeir(window[name].prototype,ext);\r\n};\r\n\r\ndhtmlxAjax={\r\n    get:function(url,callback){\r\n        var t=new dtmlXMLLoaderObject(true);\r\n        t.async=(arguments.length<3);\r\n        t.waitCall=callback;\r\n        t.loadXML(url);\r\n        return t;\r\n    },\r\n    post:function(url,post,callback){\r\n        var t=new dtmlXMLLoaderObject(true);\r\n        t.async=(arguments.length<4);\r\n        t.waitCall=callback;\r\n        t.loadXML(url,true,post);\r\n        return t;\r\n    },\r\n    getSync:function(url){\r\n        return this.get(url,null,true);\r\n    },\r\n    postSync:function(url,post){\r\n        return this.post(url,post,null,true);\r\n    }\r\n};\r\n\r\n/**\r\n *     @desc: xmlLoader object\r\n *     @type: private\r\n *     @param: funcObject - xml parser function\r\n *     @param: object - jsControl object\r\n *     @param: async - sync/async mode (async by default)\r\n *     @param: rSeed - enable/disable random seed ( prevent IE caching)\r\n *     @topic: 0\r\n */\r\nfunction dtmlXMLLoaderObject(funcObject, dhtmlObject, async, rSeed){\r\n    this.xmlDoc=\"\";\r\n\r\n    if (typeof (async) != \"undefined\")\r\n        this.async=async;\r\n    else\r\n        this.async=true;\r\n\r\n    this.onloadAction=funcObject||null;\r\n    this.mainObject=dhtmlObject||null;\r\n    this.waitCall=null;\r\n    this.rSeed=rSeed||false;\r\n    return this;\r\n}\r\n\r\ndtmlXMLLoaderObject.count = 0;\r\n\r\n/**\r\n *     @desc: xml loading handler\r\n *     @type: private\r\n *     @param: dtmlObject - xmlLoader object\r\n *     @topic: 0\r\n */\r\ndtmlXMLLoaderObject.prototype.waitLoadFunction=function(dhtmlObject){\r\n    var once = true;\r\n    this.check=function (){\r\n        if ((dhtmlObject)&&(dhtmlObject.onloadAction)){\r\n            if ((!dhtmlObject.xmlDoc.readyState)||(dhtmlObject.xmlDoc.readyState == 4)){\r\n                if (!once)\r\n                    return;\r\n\r\n                once=false; //IE 5 fix\r\n                dtmlXMLLoaderObject.count++;\r\n                if (typeof dhtmlObject.onloadAction == \"function\")\r\n                    dhtmlObject.onloadAction(dhtmlObject.mainObject, null, null, null, dhtmlObject);\r\n\r\n                if (dhtmlObject.waitCall){\r\n                    dhtmlObject.waitCall.call(this,dhtmlObject);\r\n                    dhtmlObject.waitCall=null;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return this.check;\r\n};\r\n\r\n/**\r\n *     @desc: return XML top node\r\n *     @param: tagName - top XML node tag name (not used in IE, required for Safari and Mozilla)\r\n *     @type: private\r\n *     @returns: top XML node\r\n *     @topic: 0\r\n */\r\ndtmlXMLLoaderObject.prototype.getXMLTopNode=function(tagName, oldObj){\r\n    var z;\r\n\r\n    if (this.xmlDoc.responseXML){\r\n        var temp = this.xmlDoc.responseXML.getElementsByTagName(tagName);\r\n        if(temp.length === 0 && tagName.indexOf(\":\")!=-1)\r\n            var temp = this.xmlDoc.responseXML.getElementsByTagName((tagName.split(\":\"))[1]);\r\n        z = temp[0];\r\n    } else\r\n        z = this.xmlDoc.documentElement;\r\n\r\n    if (z){\r\n        this._retry=false;\r\n        return z;\r\n    }\r\n\r\n    if (!this._retry&&_isIE){\r\n        this._retry=true;\r\n        var oldObj = this.xmlDoc;\r\n        this.loadXMLString(this.xmlDoc.responseText.replace(/^[\\s]+/,\"\"), true);\r\n        return this.getXMLTopNode(tagName, oldObj);\r\n    }\r\n\r\n    dhtmlxError.throwError(\"LoadXML\", \"Incorrect XML\", [\r\n        (oldObj||this.xmlDoc),\r\n        this.mainObject\r\n    ]);\r\n\r\n    return document.createElement(\"DIV\");\r\n};\r\n\r\n/**\r\n *     @desc: load XML from string\r\n *     @type: private\r\n *     @param: xmlString - xml string\r\n *     @topic: 0\r\n */\r\ndtmlXMLLoaderObject.prototype.loadXMLString=function(xmlString, silent){\r\n\r\n    if (!_isIE){\r\n        var parser = new DOMParser();\r\n        this.xmlDoc=parser.parseFromString(xmlString, \"text/xml\");\r\n    } else {\r\n        this.xmlDoc=new ActiveXObject(\"Microsoft.XMLDOM\");\r\n        this.xmlDoc.async=this.async;\r\n        this.xmlDoc.onreadystatechange = function(){};\r\n        this.xmlDoc[\"loadXM\"+\"L\"](xmlString);\r\n    }\r\n\r\n    if (silent)\r\n        return;\r\n\r\n    if (this.onloadAction)\r\n        this.onloadAction(this.mainObject, null, null, null, this);\r\n\r\n    if (this.waitCall){\r\n        this.waitCall();\r\n        this.waitCall=null;\r\n    }\r\n};\r\n/**\r\n *     @desc: load XML\r\n *     @type: private\r\n *     @param: filePath - xml file path\r\n *     @param: postMode - send POST request\r\n *     @param: postVars - list of vars for post request\r\n *     @topic: 0\r\n */\r\ndtmlXMLLoaderObject.prototype.loadXML=function(filePath, postMode, postVars, rpc){\r\n    if (this.rSeed)\r\n        filePath+=((filePath.indexOf(\"?\") != -1) ? \"&\" : \"?\")+\"a_dhx_rSeed=\"+(new Date()).valueOf();\r\n    this.filePath=filePath;\r\n\r\n    if ((!_isIE)&&(window.XMLHttpRequest))\r\n        this.xmlDoc=new XMLHttpRequest();\r\n    else {\r\n        this.xmlDoc=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n\r\n    if (this.async)\r\n        this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this);\r\n    if (typeof postMode == \"string\")\r\n        this.xmlDoc.open(postMode, filePath, this.async);\r\n    else\r\n        this.xmlDoc.open(postMode ? \"POST\" : \"GET\", filePath, this.async);\r\n\r\n    // OH 機能追加 START ---------------------------------------------\r\n    if (_ghUser) {\r\n        this.xmlDoc.setRequestHeader(\"AUTHORIZED_TOKEN\", _ghUser.getAuthToken());\r\n    }\r\n    // OH 機能追加 END    ---------------------------------------------\r\n\r\n    if (rpc){\r\n        this.xmlDoc.setRequestHeader(\"User-Agent\", \"dhtmlxRPC v0.1 (\"+navigator.userAgent+\")\");\r\n        this.xmlDoc.setRequestHeader(\"Content-type\", \"text/xml\");\r\n    }\r\n\r\n    else if (postMode)\r\n        this.xmlDoc.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\r\n    this.xmlDoc.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\");\r\n    this.xmlDoc.send(null||postVars);\r\n\r\n    if (!this.async)\r\n        (new this.waitLoadFunction(this))();\r\n};\r\n/**\r\n *     @desc: destructor, cleans used memory\r\n *     @type: private\r\n *     @topic: 0\r\n */\r\ndtmlXMLLoaderObject.prototype.destructor=function(){\r\n    this._filterXPath = null;\r\n    this._getAllNamedChilds = null;\r\n    this._retry = null;\r\n    this.async = null;\r\n    this.rSeed = null;\r\n    this.filePath = null;\r\n    this.onloadAction = null;\r\n    this.mainObject = null;\r\n    this.xmlDoc = null;\r\n    this.doXPath = null;\r\n    this.doXPathOpera = null;\r\n    this.doXSLTransToObject = null;\r\n    this.doXSLTransToString = null;\r\n    this.loadXML = null;\r\n    this.loadXMLString = null;\r\n    // this.waitLoadFunction = null;\r\n    this.doSerialization = null;\r\n    this.xmlNodeToJSON = null;\r\n    this.getXMLTopNode = null;\r\n    this.setXSLParamValue = null;\r\n    return null;\r\n};\r\n\r\ndtmlXMLLoaderObject.prototype.xmlNodeToJSON = function(node){\r\n    var t={};\r\n    for (var i=0; i<node.attributes.length; i++)\r\n        t[node.attributes[i].name]=node.attributes[i].value;\r\n    t[\"_tagvalue\"]=node.firstChild?node.firstChild.nodeValue:\"\";\r\n    for (var i=0; i<node.childNodes.length; i++){\r\n        var name=node.childNodes[i].tagName;\r\n        if (name){\r\n            if (!t[name]) t[name]=[];\r\n            t[name].push(this.xmlNodeToJSON(node.childNodes[i]));\r\n        }\r\n    }\r\n    return t;\r\n};\r\n\r\n/**\r\n *     @desc: Call wrapper\r\n *     @type: private\r\n *     @param: funcObject - action handler\r\n *     @param: dhtmlObject - user data\r\n *     @returns: function handler\r\n *     @topic: 0\r\n */\r\nfunction callerFunction(funcObject, dhtmlObject){\r\n    this.handler=function(e){\r\n        if (!e)\r\n            e=window.event;\r\n        funcObject(e, dhtmlObject);\r\n        return true;\r\n    };\r\n    return this.handler;\r\n}\r\n\r\n/**\r\n *     @desc: Calculate absolute position of html object\r\n *     @type: private\r\n *     @param: htmlObject - html object\r\n *     @topic: 0\r\n */\r\nfunction getAbsoluteLeft(htmlObject){\r\n    return getOffset(htmlObject).left;\r\n}\r\n/**\r\n *     @desc: Calculate absolute position of html object\r\n *     @type: private\r\n *     @param: htmlObject - html object\r\n *     @topic: 0\r\n */\r\nfunction getAbsoluteTop(htmlObject){\r\n    return getOffset(htmlObject).top;\r\n}\r\n\r\nfunction getOffsetSum(elem) {\r\n    var top=0, left=0;\r\n    while(elem) {\r\n        top = top + parseInt(elem.offsetTop);\r\n        left = left + parseInt(elem.offsetLeft);\r\n        elem = elem.offsetParent;\r\n    }\r\n    return {top: top, left: left};\r\n}\r\nfunction getOffsetRect(elem) {\r\n    var box = elem.getBoundingClientRect();\r\n    var body = document.body;\r\n    var docElem = document.documentElement;\r\n    var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n    var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n    var clientTop = docElem.clientTop || body.clientTop || 0;\r\n    var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n    var top  = box.top +  scrollTop - clientTop;\r\n    var left = box.left + scrollLeft - clientLeft;\r\n    return { top: Math.round(top), left: Math.round(left) };\r\n}\r\nfunction getOffset(elem) {\r\n    if (elem.getBoundingClientRect) {\r\n        return getOffsetRect(elem);\r\n    } else {\r\n        return getOffsetSum(elem);\r\n    }\r\n}\r\n\r\n/**\r\n *     @desc: Convert string to it boolean representation\r\n *     @type: private\r\n *     @param: inputString - string for covertion\r\n *     @topic: 0\r\n */\r\nfunction convertStringToBoolean(inputString){\r\n    if (typeof (inputString) == \"string\")\r\n        inputString=inputString.toLowerCase();\r\n\r\n    switch (inputString){\r\n        case \"1\":\r\n        case \"true\":\r\n        case \"yes\":\r\n        case \"y\":\r\n        case 1:\r\n        case true:\r\n            return true;\r\n        default:\r\n            return false;\r\n    }\r\n}\r\n\r\n/**\r\n *     @desc: find out what symbol to use as url param delimiters in further params\r\n *     @type: private\r\n *     @param: str - current url string\r\n *     @topic: 0\r\n */\r\nfunction getUrlSymbol(str){\r\n    if (str.indexOf(\"?\") != -1)\r\n        return \"&\";\r\n    else\r\n        return \"?\";\r\n}\r\n\r\nfunction dhtmlDragAndDropObject(){\r\n    if (window.dhtmlDragAndDrop)\r\n        return window.dhtmlDragAndDrop;\r\n\r\n    this.lastLanding=0;\r\n    this.dragNode=0;\r\n    this.dragStartNode=0;\r\n    this.dragStartObject=0;\r\n    this.tempDOMU=null;\r\n    this.tempDOMM=null;\r\n    this.waitDrag=0;\r\n    window.dhtmlDragAndDrop=this;\r\n\r\n    return this;\r\n}\r\n\r\ndhtmlDragAndDropObject.prototype.removeDraggableItem=function(htmlNode){\r\n    htmlNode.onmousedown=null;\r\n    htmlNode.dragStarter=null;\r\n    htmlNode.dragLanding=null;\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.addDraggableItem=function(htmlNode, dhtmlObject){\r\n    htmlNode.onmousedown=this.preCreateDragCopy;\r\n    htmlNode.dragStarter=dhtmlObject;\r\n    this.addDragLanding(htmlNode, dhtmlObject);\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.addDragLanding=function(htmlNode, dhtmlObject){\r\n    htmlNode.dragLanding=dhtmlObject;\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.preCreateDragCopy=function(e){\r\n    if ((e||window.event) && (e||event).button == 2)\r\n        return;\r\n\r\n    if (window.dhtmlDragAndDrop.waitDrag){\r\n        window.dhtmlDragAndDrop.waitDrag=0;\r\n        document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;\r\n        document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;\r\n        return false;\r\n    }\r\n\r\n    if (window.dhtmlDragAndDrop.dragNode)\r\n        window.dhtmlDragAndDrop.stopDrag(e);\r\n\r\n    window.dhtmlDragAndDrop.waitDrag=1;\r\n    window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;\r\n    window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;\r\n    window.dhtmlDragAndDrop.dragStartNode=this;\r\n    window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;\r\n    document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;\r\n    document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;\r\n    window.dhtmlDragAndDrop.downtime = new Date().valueOf();\r\n\r\n\r\n    if ((e)&&(e.preventDefault)){\r\n        e.preventDefault();\r\n        return false;\r\n    }\r\n    return false;\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.callDrag=function(e){\r\n    if (!e)\r\n        e=window.event;\r\n    var dragger=window.dhtmlDragAndDrop;\r\n    if ((new Date()).valueOf()-dragger.downtime<100) return;\r\n\r\n    //if ((e.button == 0)&&(_isIE))\r\n    //\treturn dragger.stopDrag();\r\n\r\n    if (!dragger.dragNode){\r\n        if (dragger.waitDrag){\r\n            dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode, e);\r\n\r\n            if (!dragger.dragNode)\r\n                return dragger.stopDrag();\r\n\r\n            dragger.dragNode.onselectstart=function(){return false;};\r\n            dragger.gldragNode=dragger.dragNode;\r\n            document.body.appendChild(dragger.dragNode);\r\n            document.body.onmouseup=dragger.stopDrag;\r\n            dragger.waitDrag=0;\r\n            dragger.dragNode.pWindow=window;\r\n            dragger.initFrameRoute();\r\n        }\r\n        else return dragger.stopDrag(e, true);\r\n    }\r\n\r\n    if (dragger.dragNode.parentNode != window.document.body && dragger.gldragNode){\r\n        var grd = dragger.gldragNode;\r\n\r\n        if (dragger.gldragNode.old)\r\n            grd=dragger.gldragNode.old;\r\n\r\n        //if (!document.all) dragger.calculateFramePosition();\r\n        grd.parentNode.removeChild(grd);\r\n        var oldBody = dragger.dragNode.pWindow;\r\n\r\n        if (grd.pWindow &&\tgrd.pWindow.dhtmlDragAndDrop.lastLanding)\r\n            grd.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(grd.pWindow.dhtmlDragAndDrop.lastLanding);\r\n\r\n        //\t\tvar oldp=dragger.dragNode.parentObject;\r\n        if (_isIE){\r\n            var div = document.createElement(\"Div\");\r\n            div.innerHTML=dragger.dragNode.outerHTML;\r\n            dragger.dragNode=div.childNodes[0];\r\n        } else\r\n            dragger.dragNode=dragger.dragNode.cloneNode(true);\r\n\r\n        dragger.dragNode.pWindow=window;\r\n        //\t\tdragger.dragNode.parentObject=oldp;\r\n\r\n        dragger.gldragNode.old=dragger.dragNode;\r\n        document.body.appendChild(dragger.dragNode);\r\n        oldBody.dhtmlDragAndDrop.dragNode=dragger.dragNode;\r\n    }\r\n\r\n    dragger.dragNode.style.left=e.clientX+15 + \r\n        (dragger.fx ? dragger.fx*(-1) : 0) +\r\n        (document.body.scrollLeft||document.documentElement.scrollLeft)+\"px\";\r\n    dragger.dragNode.style.top=e.clientY+3+\r\n        (dragger.fy ? dragger.fy*(-1) : 0) +\r\n        (document.body.scrollTop||document.documentElement.scrollTop)+\"px\";\r\n\r\n    var z;\r\n    if (!e.srcElement)\r\n        z = e.target;\r\n    else\r\n        z=e.srcElement;\r\n    dragger.checkLanding(z, e);\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.calculateFramePosition=function(n){\r\n    //this.fx = 0, this.fy = 0;\r\n    if (window.name){\r\n        var el = parent.frames[window.name].frameElement.offsetParent;\r\n        var fx = 0;\r\n        var fy = 0;\r\n\r\n        while (el){\r\n            fx+=el.offsetLeft;\r\n            fy+=el.offsetTop;\r\n            el=el.offsetParent;\r\n        }\r\n\r\n        if ((parent.dhtmlDragAndDrop)){\r\n            var ls = parent.dhtmlDragAndDrop.calculateFramePosition(1);\r\n            fx+=ls.split('_')[0]*1;\r\n            fy+=ls.split('_')[1]*1;\r\n        }\r\n\r\n        if (n)\r\n            return fx+\"_\"+fy;\r\n        else\r\n            this.fx=fx;\r\n        this.fy=fy;\r\n    }\r\n    return \"0_0\";\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.checkLanding=function(htmlObject, e){\r\n    if ((htmlObject)&&(htmlObject.dragLanding)){\r\n        if (this.lastLanding)\r\n            this.lastLanding.dragLanding._dragOut(this.lastLanding);\r\n        this.lastLanding=htmlObject;\r\n        this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding, this.dragStartNode, e.clientX,\r\n            e.clientY, e);\r\n        this.lastLanding_scr=(_isIE ? e.srcElement : e.target);\r\n    } else {\r\n        if ((htmlObject)&&(htmlObject.tagName != \"BODY\"))\r\n            this.checkLanding(htmlObject.parentNode, e);\r\n        else {\r\n            if (this.lastLanding)\r\n                this.lastLanding.dragLanding._dragOut(this.lastLanding, e.clientX, e.clientY, e);\r\n            this.lastLanding=0;\r\n\r\n            if (this._onNotFound)\r\n                this._onNotFound();\r\n        }\r\n    }\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.stopDrag=function(e, mode){\r\n    var dragger=window.dhtmlDragAndDrop;\r\n\r\n    if (!mode){\r\n        dragger.stopFrameRoute();\r\n        var temp = dragger.lastLanding;\r\n        dragger.lastLanding=null;\r\n\r\n        if (temp)\r\n            temp.dragLanding._drag(dragger.dragStartNode, dragger.dragStartObject, temp,\r\n                (_isIE ? event.srcElement : e.target));\r\n    }\r\n    dragger.lastLanding=null;\r\n\r\n    if ((dragger.dragNode)&&(dragger.dragNode.parentNode == document.body))\r\n        dragger.dragNode.parentNode.removeChild(dragger.dragNode);\r\n    dragger.dragNode=0;\r\n    dragger.gldragNode=0;\r\n    dragger.fx=0;\r\n    dragger.fy=0;\r\n    dragger.dragStartNode=0;\r\n    dragger.dragStartObject=0;\r\n    document.body.onmouseup=dragger.tempDOMU;\r\n    document.body.onmousemove=dragger.tempDOMM;\r\n    dragger.tempDOMU=null;\r\n    dragger.tempDOMM=null;\r\n    dragger.waitDrag=0;\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.stopFrameRoute=function(win){\r\n    if (win)\r\n        window.dhtmlDragAndDrop.stopDrag(1, 1);\r\n\r\n    for (var i = 0; i < window.frames.length; i++){\r\n        try{\r\n            if ((window.frames[i] != win)&&(window.frames[i].dhtmlDragAndDrop))\r\n                window.frames[i].dhtmlDragAndDrop.stopFrameRoute(window);\r\n        } catch(e){}\r\n    }\r\n\r\n    try{\r\n        if ((parent.dhtmlDragAndDrop)&&(parent != window)&&(parent != win))\r\n            parent.dhtmlDragAndDrop.stopFrameRoute(window);\r\n    } catch(e){}\r\n};\r\n\r\ndhtmlDragAndDropObject.prototype.initFrameRoute=function(win, mode){\r\n    if (win){\r\n        window.dhtmlDragAndDrop.preCreateDragCopy();\r\n        window.dhtmlDragAndDrop.dragStartNode=win.dhtmlDragAndDrop.dragStartNode;\r\n        window.dhtmlDragAndDrop.dragStartObject=win.dhtmlDragAndDrop.dragStartObject;\r\n        window.dhtmlDragAndDrop.dragNode=win.dhtmlDragAndDrop.dragNode;\r\n        window.dhtmlDragAndDrop.gldragNode=win.dhtmlDragAndDrop.dragNode;\r\n        window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;\r\n        window.waitDrag=0;\r\n\r\n        if (((!_isIE)&&(mode))&&((!_isFF)||(_FFrv < 1.8)))\r\n            window.dhtmlDragAndDrop.calculateFramePosition();\r\n    }\r\n    try{\r\n        if ((parent.dhtmlDragAndDrop)&&(parent != window)&&(parent != win))\r\n            parent.dhtmlDragAndDrop.initFrameRoute(window);\r\n    }catch(e){}\r\n\r\n    for (var i = 0; i < window.frames.length; i++){\r\n        try{\r\n            if ((window.frames[i] != win)&&(window.frames[i].dhtmlDragAndDrop))\r\n                window.frames[i].dhtmlDragAndDrop.initFrameRoute(window, ((!win||mode) ? 1 : 0));\r\n        } catch(e){}\r\n    }\r\n};\r\n\r\n_isFF = false;\r\n_isIE = false;\r\n_isOpera = false;\r\n_isKHTML = false;\r\n_isMacOS = false;\r\n_isChrome = false;\r\n_FFrv = false;\r\n_KHTMLrv = false;\r\n_OperaRv = false;\r\n\r\nif (navigator.userAgent.indexOf('Macintosh') != -1)\r\n    _isMacOS=true;\r\n\r\n\r\nif (navigator.userAgent.toLowerCase().indexOf('chrome')>-1)\r\n    _isChrome=true;\r\n\r\nif ((navigator.userAgent.indexOf('Safari') != -1)||(navigator.userAgent.indexOf('Konqueror') != -1)){\r\n    _KHTMLrv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf('Safari')+7, 5));\r\n\r\n    if (_KHTMLrv > 525){ //mimic FF behavior for Safari 3.1+\r\n        _isFF=true;\r\n        _FFrv = 1.9;\r\n    } else\r\n        _isKHTML=true;\r\n} else if (navigator.userAgent.indexOf('Opera') != -1){\r\n    _isOpera=true;\r\n    _OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf('Opera')+6, 3));\r\n}\r\n\r\n\r\nelse if (navigator.appName.indexOf(\"Microsoft\") != -1){\r\n    _isIE=true;\r\n    if ((navigator.appVersion.indexOf(\"MSIE 8.0\")!= -1 || navigator.appVersion.indexOf(\"MSIE 9.0\")!= -1 || navigator.appVersion.indexOf(\"MSIE 10.0\")!= -1 ) && document.compatMode != \"BackCompat\"){\r\n        _isIE=8;\r\n    }\r\n} else if (navigator.appName  == 'Netscape' && navigator.userAgent.indexOf(\"Trident\") != -1){\r\n\t//ie11\r\n\t_isIE=8;\r\n} else {\r\n    _isFF=true;\r\n    _FFrv = parseFloat(navigator.userAgent.split(\"rv:\")[1]);\r\n}\r\n\r\n\r\n//multibrowser Xpath processor\r\ndtmlXMLLoaderObject.prototype.doXPath=function(xpathExp, docObj, namespace, result_type){\r\n    if (_isKHTML || (!_isIE && !window.XPathResult))\r\n        return this.doXPathOpera(xpathExp, docObj);\r\n\r\n    if (_isIE){ //IE\r\n        if (!docObj)\r\n            if (!this.xmlDoc.nodeName)\r\n                docObj=this.xmlDoc.responseXML;\r\n            else\r\n                docObj=this.xmlDoc;\r\n\r\n        if (!docObj)\r\n            dhtmlxError.throwError(\"LoadXML\", \"Incorrect XML\", [\r\n                (docObj||this.xmlDoc),\r\n                this.mainObject\r\n            ]);\r\n\r\n        if (namespace)\r\n            docObj.setProperty(\"SelectionNamespaces\", \"xmlns:xsl='\"+namespace+\"'\"); //\r\n\r\n        if (result_type == 'single'){\r\n            return docObj.selectSingleNode(xpathExp);\r\n        }\r\n        else {\r\n            return docObj.selectNodes(xpathExp)||new Array(0);\r\n        }\r\n    } else { //Mozilla\r\n        var nodeObj = docObj;\r\n\r\n        if (!docObj){\r\n            if (!this.xmlDoc.nodeName){\r\n                docObj=this.xmlDoc.responseXML;\r\n            }\r\n            else {\r\n                docObj=this.xmlDoc;\r\n            }\r\n        }\r\n\r\n        if (!docObj)\r\n            dhtmlxError.throwError(\"LoadXML\", \"Incorrect XML\", [\r\n                (docObj||this.xmlDoc),\r\n                this.mainObject\r\n            ]);\r\n\r\n        if (docObj.nodeName.indexOf(\"document\") != -1){\r\n            nodeObj=docObj;\r\n        }\r\n        else {\r\n            nodeObj=docObj;\r\n            docObj=docObj.ownerDocument;\r\n        }\r\n        var retType = XPathResult.ANY_TYPE;\r\n\r\n        if (result_type == 'single')\r\n            retType=XPathResult.FIRST_ORDERED_NODE_TYPE;\r\n        var rowsCol = [];\r\n        var col = docObj.evaluate(xpathExp, nodeObj, function(pref){\r\n            return namespace;\r\n        }, retType, null);\r\n\r\n        if (retType == XPathResult.FIRST_ORDERED_NODE_TYPE){\r\n            return col.singleNodeValue;\r\n        }\r\n        var thisColMemb = col.iterateNext();\r\n\r\n        while (thisColMemb){\r\n            rowsCol[rowsCol.length]=thisColMemb;\r\n            thisColMemb=col.iterateNext();\r\n        }\r\n        return rowsCol;\r\n    }\r\n};\r\n\r\nfunction _dhtmlxError(type, name, params){\r\n    if (!this.catches)\r\n        this.catches=[];\r\n\r\n    return this;\r\n}\r\n\r\n_dhtmlxError.prototype.catchError=function(type, func_name){\r\n    this.catches[type]=func_name;\r\n};\r\n\r\n_dhtmlxError.prototype.throwError=function(type, name, params){\r\n    if (this.catches[type])\r\n        return this.catches[type](type, name, params);\r\n\r\n    if (this.catches[\"ALL\"])\r\n        return this.catches[\"ALL\"](type, name, params);\r\n\r\n    window.alert(\"Error type: \"+arguments[0]+\"\\nDescription: \"+arguments[1]);\r\n    return null;\r\n};\r\n\r\nwindow.dhtmlxError=new _dhtmlxError();\r\n\r\n\r\n//opera fake, while 9.0 not released\r\n//multibrowser Xpath processor\r\ndtmlXMLLoaderObject.prototype.doXPathOpera=function(xpathExp, docObj){\r\n    //this is fake for Opera\r\n    var z = xpathExp.replace(/[\\/]+/gi, \"/\").split('/');\r\n    var obj = null;\r\n    var i = 1;\r\n\r\n    if (!z.length)\r\n        return [];\r\n\r\n    if (z[0] == \".\")\r\n        obj=[docObj]; else if (z[0] === \"\"){\r\n        obj=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(z[i].replace(/\\[[^\\]]*\\]/g, \"\"));\r\n        i++;\r\n    } else\r\n        return [];\r\n\r\n    for (i; i < z.length; i++)obj=this._getAllNamedChilds(obj, z[i]);\r\n\r\n    if (z[i-1].indexOf(\"[\") != -1)\r\n        obj=this._filterXPath(obj, z[i-1]);\r\n    return obj;\r\n};\r\n\r\ndtmlXMLLoaderObject.prototype._filterXPath=function(a, b){\r\n    var c = [];\r\n    var b = b.replace(/[^\\[]*\\[\\@/g, \"\").replace(/[\\[\\]\\@]*/g, \"\");\r\n\r\n    for (var i = 0; i < a.length; i++)\r\n        if (a[i].getAttribute(b))\r\n            c[c.length]=a[i];\r\n\r\n    return c;\r\n};\r\n\r\ndtmlXMLLoaderObject.prototype._getAllNamedChilds=function(a, b){\r\n    var c = [];\r\n\r\n    if (_isKHTML)\r\n        b=b.toUpperCase();\r\n\r\n    for (var i = 0; i < a.length; i++)for (var j = 0; j < a[i].childNodes.length; j++){\r\n        if (_isKHTML){\r\n            if (a[i].childNodes[j].tagName&&a[i].childNodes[j].tagName.toUpperCase() == b)\r\n                c[c.length]=a[i].childNodes[j];\r\n        }\r\n\r\n        else if (a[i].childNodes[j].tagName == b)\r\n            c[c.length]=a[i].childNodes[j];\r\n    }\r\n\r\n    return c;\r\n};\r\n\r\nfunction dhtmlXHeir(a, b){\r\n    for (var c in b)\r\n        if (typeof (b[c]) == \"function\")\r\n            a[c]=b[c];\r\n    return a;\r\n}\r\n\r\nif(typeof (window.dhtmlxEvent) == 'undefined'){\r\n    window.dhtmlxEvent = function dhtmlxEvent(el, event, handler){\r\n        if (el.addEventListener)\r\n            el.addEventListener(event, handler, false);\r\n\r\n        else if (el.attachEvent)\r\n            el.attachEvent(\"on\"+event, handler);\r\n    };\r\n}\r\n\r\n//============= XSL Extension ===================================\r\n\r\ndtmlXMLLoaderObject.prototype.xslDoc=null;\r\ndtmlXMLLoaderObject.prototype.setXSLParamValue=function(paramName, paramValue, xslDoc){\r\n    if (!xslDoc)\r\n        xslDoc=this.xslDoc;\r\n\r\n    if (xslDoc.responseXML)\r\n        xslDoc=xslDoc.responseXML;\r\n    var item =\r\n        this.doXPath(\"/xsl:stylesheet/xsl:variable[@name='\"+paramName+\"']\", xslDoc,\r\n            \"http:/\\/www.w3.org/1999/XSL/Transform\", \"single\");\r\n\r\n    if (item)\r\n        item.firstChild.nodeValue=paramValue;\r\n};\r\n\r\ndtmlXMLLoaderObject.prototype.doXSLTransToObject=function(xslDoc, xmlDoc){\r\n    if (!xslDoc)\r\n        xslDoc=this.xslDoc;\r\n\r\n    if (xslDoc.responseXML)\r\n        xslDoc=xslDoc.responseXML;\r\n\r\n    if (!xmlDoc)\r\n        xmlDoc=this.xmlDoc;\r\n\r\n    if (xmlDoc.responseXML)\r\n        xmlDoc=xmlDoc.responseXML;\r\n\r\n    \r\n    var result;\r\n    //Mozilla\r\n    if (!_isIE){\r\n        if (!this.XSLProcessor){\r\n            this.XSLProcessor=new XSLTProcessor();\r\n            this.XSLProcessor.importStylesheet(xslDoc);\r\n        }\r\n        result = this.XSLProcessor.transformToDocument(xmlDoc);\r\n    } else {\r\n        result = new ActiveXObject(\"Msxml2.DOMDocument.3.0\");\r\n        try{\r\n            xmlDoc.transformNodeToObject(xslDoc, result);\r\n        }catch(e){\r\n            result = xmlDoc.transformNode(xslDoc);\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\ndtmlXMLLoaderObject.prototype.doXSLTransToString=function(xslDoc, xmlDoc){\r\n    var res = this.doXSLTransToObject(xslDoc, xmlDoc);\r\n    if(typeof(res)==\"string\")\r\n        return res;\r\n    return this.doSerialization(res);\r\n};\r\n\r\ndtmlXMLLoaderObject.prototype.doSerialization=function(xmlDoc){\r\n    if (!xmlDoc)\r\n        xmlDoc=this.xmlDoc;\r\n    if (xmlDoc.responseXML)\r\n        xmlDoc=xmlDoc.responseXML;\r\n    if (!_isIE){\r\n        var xmlSerializer = new XMLSerializer();\r\n        return xmlSerializer.serializeToString(xmlDoc);\r\n    } else\r\n        return xmlDoc.xml;\r\n};\r\n\r\n/**\r\n *   @desc:\r\n *   @type: private\r\n */\r\ndhtmlxEventable=function(obj){\r\n    obj.attachEvent=function(name, catcher, callObj){\r\n        name='ev_'+name.toLowerCase();\r\n        if (!this[name])\r\n            this[name]=new this.eventCatcher(callObj||this);\r\n\r\n        return(name+':'+this[name].addEvent(catcher)); //return ID (event name & event ID)\r\n    };\r\n    obj.callEvent=function(name, arg0){\r\n        name='ev_'+name.toLowerCase();\r\n        if (this[name])\r\n            return this[name].apply(this, arg0);\r\n        return true;\r\n    };\r\n    obj.checkEvent=function(name){\r\n        return (!!this['ev_'+name.toLowerCase()]);\r\n    };\r\n    obj.eventCatcher=function(obj){\r\n        var dhx_catch = [];\r\n        var z = function(){\r\n            var res = true;\r\n            for (var i = 0; i < dhx_catch.length; i++){\r\n                if (dhx_catch[i]){\r\n                    var zr = dhx_catch[i].apply(obj, arguments);\r\n                    res=res&&zr;\r\n                }\r\n            }\r\n            return res;\r\n        };\r\n        z.addEvent=function(ev){\r\n            if (typeof (ev) != \"function\")\r\n                ev=eval(ev);\r\n            if (ev)\r\n                return dhx_catch.push(ev)-1;\r\n            return false;\r\n        };\r\n        z.removeEvent=function(id){\r\n            dhx_catch[id]=null;\r\n        };\r\n        return z;\r\n    };\r\n    obj.detachEvent=function(id){\r\n        if (id){\r\n            var list = id.split(':');           //get EventName and ID\r\n            this[list[0]].removeEvent(list[1]); //remove event\r\n        }\r\n    };\r\n    obj.detachAllEvents = function(){\r\n        for (var name in this){\r\n            if (name.indexOf(\"ev_\")===0){\r\n                this.detachEvent(name);\r\n                this[name] = null;\r\n            }\r\n        }\r\n    };\r\n    obj = null;\r\n};\r\nif(!window.dhtmlx)\r\n\twindow.dhtmlx = {};\r\n\r\n(function(){\r\n\tvar _dhx_msg_cfg = null;\r\n\tfunction callback(config, result){\r\n\t\t\tvar usercall = config.callback;\r\n\t\t\tmodality(false);\r\n\t\t\tconfig.box.parentNode.removeChild(config.box);\r\n\t\t\t_dhx_msg_cfg = config.box = null;\r\n\t\t\tif (usercall)\r\n\t\t\t\tusercall(result);\r\n\t}\r\n\tfunction modal_key(e){\r\n\t\tif (_dhx_msg_cfg){\r\n\t\t\te = e||event;\r\n\t\t\tvar code = e.which||event.keyCode;\r\n\t\t\tif (dhtmlx.message.keyboard){\r\n\t\t\t\tif (code == 13 || code == 32)\r\n\t\t\t\t\tcallback(_dhx_msg_cfg, true);\r\n\t\t\t\tif (code == 27)\r\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\r\n\t\t\t}\r\n\t\t\tif (e.preventDefault)\r\n\t\t\t\te.preventDefault();\r\n\t\t\treturn !(e.cancelBubble = true);\r\n\t\t}\r\n\t}\r\n\tif (document.attachEvent)\r\n\t\tdocument.attachEvent(\"onkeydown\", modal_key);\r\n\telse\r\n\t\tdocument.addEventListener(\"keydown\", modal_key, true);\r\n\t\t\r\n\tfunction modality(mode){\r\n\t\tif(!modality.cover){\r\n\t\t\tmodality.cover = document.createElement(\"DIV\");\r\n\t\t\t//necessary for IE only\r\n\t\t\tmodality.cover.onkeydown = modal_key;\r\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\r\n\t\t\tdocument.body.appendChild(modality.cover);\r\n\t\t}\r\n\t\tvar height =  document.body.scrollHeight;\r\n\t\tmodality.cover.style.display = mode?\"inline-block\":\"none\";\r\n\t}\r\n\r\n\tfunction button(text, result, css){\r\n\t\t// css - for locale-independent class name\r\n\t\tvar className = css ? css : (text || \"\");\r\n\t\tvar button_css = \"dhtmlx_\"+(className).toLowerCase().replace(/ /g, \"_\")+\"_button\"; // dhtmlx_ok_button, dhtmlx_click_me_button\r\n\t\treturn \"<div class='dhtmlx_popup_button \"+button_css+\"' result='\"+result+\"' ><div>\"+text+\"</div></div>\";\r\n\t}\r\n\r\n\tfunction info(text){\r\n\t\tif (!t.area){\r\n\t\t\tt.area = document.createElement(\"DIV\");\r\n\t\t\tt.area.className = \"dhtmlx_message_area\";\r\n\t\t\tt.area.style[t.position]=\"5px\";\r\n\t\t\tdocument.body.appendChild(t.area);\r\n\t\t}\r\n\r\n\t\tt.hide(text.id);\r\n\t\tvar message = document.createElement(\"DIV\");\r\n\t\tmessage.innerHTML = \"<div>\"+text.text+\"</div>\";\r\n\t\tmessage.className = \"dhtmlx-info dhtmlx-\" + text.type;\r\n\t\tmessage.onclick = function(){\r\n\t\t\tt.hide(text.id);\r\n\t\t\ttext = null;\r\n\t\t};\r\n\r\n\t\tif (t.position == \"bottom\" && t.area.firstChild)\r\n\t\t\tt.area.insertBefore(message,t.area.firstChild);\r\n\t\telse\r\n\t\t\tt.area.appendChild(message);\r\n\t\t\r\n\t\tif (text.expire > 0)\r\n\t\t\tt.timers[text.id]=window.setTimeout(function(){\r\n\t\t\t\tt.hide(text.id);\r\n\t\t\t}, text.expire);\r\n\r\n\t\tt.pull[text.id] = message;\r\n\t\tmessage = null;\r\n\r\n\t\treturn text.id;\r\n\t}\r\n\tfunction _boxStructure(config, ok, cancel){\r\n\t\tvar box = document.createElement(\"DIV\");\r\n\t\tbox.className = \" dhtmlx_modal_box dhtmlx-\"+config.type;\r\n\t\tbox.setAttribute(\"dhxbox\", 1);\r\n\t\t\t\r\n\t\tvar inner = '';\r\n\r\n\t\tif (config.width)\r\n\t\t\tbox.style.width = config.width;\r\n\t\tif (config.height)\r\n\t\t\tbox.style.height = config.height;\r\n\t\tif (config.title)\r\n\t\t\tinner+='<div class=\"dhtmlx_popup_title\">'+config.title+'</div>';\r\n\t\tinner+='<div class=\"dhtmlx_popup_text\"><span>'+(config.content?'':config.text)+'</span></div><div  class=\"dhtmlx_popup_controls\">';\r\n\t\tif (ok){\r\n\t\t\tvar ok_text = (config.ok || scheduler.locale.labels.message_ok);\r\n\t\t\t//default value for compatibility with custom locales some people have\r\n\t\t\tif(ok_text === undefined) ok_text = \"OK\";\r\n\t\t\tinner += button(ok_text, true, \"ok\");\r\n\t\t}\r\n\t\tif (cancel){\r\n\t\t\tvar cancel_text = (config.cancel || scheduler.locale.labels.message_cancel);\r\n\t\t\tif(cancel_text === undefined) cancel_text = \"Cancel\";\r\n\t\t\tinner += button(cancel_text, false, \"cancel\");\r\n\t\t}\r\n\t\tif (config.buttons){\r\n\t\t\tfor (var i=0; i<config.buttons.length; i++)\r\n\t\t\t\tinner += button(config.buttons[i],i);\r\n\t\t}\r\n\t\tinner += '</div>';\r\n\t\tbox.innerHTML = inner;\r\n\r\n\t\tif (config.content){\r\n\t\t\tvar node = config.content;\r\n\t\t\tif (typeof node == \"string\") \r\n\t\t\t\tnode = document.getElementById(node);\r\n\t\t\tif (node.style.display == 'none')\r\n\t\t\t\tnode.style.display = \"\";\r\n\t\t\tbox.childNodes[config.title?1:0].appendChild(node);\r\n\t\t}\r\n\r\n\t\tbox.onclick = function(e){\r\n\t\t\te = e ||event;\r\n\t\t\tvar source = e.target || e.srcElement;\r\n\t\t\tif (!source.className) source = source.parentNode;\r\n\t\t\tif (source.className.split(\" \")[0] == \"dhtmlx_popup_button\"){\r\n\t\t\t\tvar result = source.getAttribute(\"result\");\r\n\t\t\t\tresult = (result == \"true\")||(result == \"false\"?false:result);\r\n\t\t\t\tcallback(config, result);\r\n\t\t\t}\r\n\t\t};\r\n\t\tconfig.box = box;\r\n\t\tif (ok||cancel)\r\n\t\t\t_dhx_msg_cfg = config;\r\n\r\n\t\treturn box;\r\n\t}\r\n\tfunction _createBox(config, ok, cancel){\r\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\r\n\t\t\r\n\t\tif (!config.hidden)\r\n\t\t\tmodality(true);\r\n\t\tdocument.body.appendChild(box);\r\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth) - box.offsetWidth)/2));\r\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight) - box.offsetHeight)/2));\r\n\t\tif (config.position == \"top\")\r\n\t\t\tbox.style.top = \"-3px\";\r\n\t\telse\r\n\t\t\tbox.style.top = y+'px';\r\n\t\tbox.style.left = x+'px';\r\n\t\t//necessary for IE only\r\n\t\tbox.onkeydown = modal_key;\r\n\r\n\t\tbox.focus();\r\n\t\tif (config.hidden)\r\n\t\t\tdhtmlx.modalbox.hide(box);\r\n\r\n\t\treturn box;\r\n\t}\r\n\r\n\tfunction alertPopup(config){\r\n\t\treturn _createBox(config, true, false);\r\n\t}\r\n\tfunction confirmPopup(config){\r\n\t\treturn _createBox(config, true, true);\r\n\t}\r\n\tfunction boxPopup(config){\r\n\t\treturn _createBox(config);\r\n\t}\r\n\tfunction box_params(text, type, callback){\r\n\t\tif (typeof text != \"object\"){\r\n\t\t\tif (typeof type == \"function\"){\r\n\t\t\t\tcallback = type;\r\n\t\t\t\ttype = \"\";\r\n\t\t\t}\r\n\t\t\ttext = {text:text, type:type, callback:callback };\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n\tfunction params(text, type, expire, id){\r\n\t\tif (typeof text != \"object\")\r\n\t\t\ttext = {text:text, type:type, expire:expire, id:id};\r\n\t\ttext.id = text.id||t.uid();\r\n\t\ttext.expire = text.expire||t.expire;\r\n\t\treturn text;\r\n\t}\r\n\tdhtmlx.alert = function(){\r\n\t\tvar text = box_params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"confirm\";\r\n\t\treturn alertPopup(text);\r\n\t};\r\n\tdhtmlx.confirm = function(){\r\n\t\tvar text = box_params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"alert\";\r\n\t\treturn confirmPopup(text);\r\n\t};\r\n\tdhtmlx.modalbox = function(){\r\n\t\tvar text = box_params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"alert\";\r\n\t\treturn boxPopup(text);\r\n\t};\r\n\tdhtmlx.modalbox.hide = function(node){\r\n\t\twhile (node && node.getAttribute && !node.getAttribute(\"dhxbox\"))\r\n\t\t\tnode = node.parentNode;\r\n\t\tif (node){\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tmodality(false);\r\n\t\t}\r\n\t};\r\n\tvar t = dhtmlx.message = function(text, type, expire, id){\r\n\t\ttext = params.apply(this, arguments);\r\n\t\ttext.type = text.type||\"info\";\r\n\r\n\t\tvar subtype = text.type.split(\"-\")[0];\r\n\t\tswitch (subtype){\r\n\t\t\tcase \"alert\":\r\n\t\t\t\treturn alertPopup(text);\r\n\t\t\tcase \"confirm\":\r\n\t\t\t\treturn confirmPopup(text);\r\n\t\t\tcase \"modalbox\":\r\n\t\t\t\treturn boxPopup(text);\r\n\t\t\tdefault:\r\n\t\t\t\treturn info(text);\r\n\t\t}\r\n\t};\r\n\r\n\tt.seed = (new Date()).valueOf();\r\n\tt.uid = function(){return t.seed++;};\r\n\tt.expire = 4000;\r\n\tt.keyboard = true;\r\n\tt.position = \"top\";\r\n\tt.pull = {};\r\n\tt.timers = {};\r\n\r\n\tt.hideAll = function(){\r\n\t\tfor (var key in t.pull)\r\n\t\t\tt.hide(key);\r\n\t};\r\n\tt.hide = function(id){\r\n\t\tvar obj = t.pull[id];\r\n\t\tif (obj && obj.parentNode){\r\n\t\t\twindow.setTimeout(function(){\r\n\t\t\t\tobj.parentNode.removeChild(obj);\r\n\t\t\t\tobj = null;\r\n\t\t\t},2000);\r\n\t\t\tobj.className+=\" hidden\";\r\n\t\t\t\r\n\t\t\tif(t.timers[id])\r\n\t\t\t\twindow.clearTimeout(t.timers[id]);\r\n\t\t\tdelete t.pull[id];\r\n\t\t}\r\n\t};\r\n})();\r\n/**\r\n\t* \t@desc: constructor, data processor object \r\n\t*\t@param: serverProcessorURL - url used for update\r\n\t*\t@type: public\r\n\t*/\r\nfunction dataProcessor(serverProcessorURL){\r\n    this.serverProcessor = serverProcessorURL;\r\n    this.action_param=\"!nativeeditor_status\";\r\n    \r\n\tthis.object = null;\r\n\tthis.updatedRows = []; //ids of updated rows\r\n\t\r\n\tthis.autoUpdate = true;\r\n\tthis.updateMode = \"cell\";\r\n\tthis._tMode=\"GET\"; \r\n\tthis.post_delim = \"_\";\r\n\t\r\n    this._waitMode=0;\r\n    this._in_progress={};//?\r\n    this._invalid={};\r\n    this.mandatoryFields=[];\r\n    this.messages=[];\r\n    \r\n    this.styles={\r\n    \tupdated:\"font-weight:bold;\",\r\n    \tinserted:\"font-weight:bold;\",\r\n    \tdeleted:\"text-decoration : line-through;\",\r\n    \tinvalid:\"background-color:FFE0E0;\",\r\n    \tinvalid_cell:\"border-bottom:2px solid red;\",\r\n    \terror:\"color:red;\",\r\n    \tclear:\"font-weight:normal;text-decoration:none;\"\r\n    };\r\n    \r\n    this.enableUTFencoding(true);\r\n    dhtmlxEventable(this);\r\n\r\n    return this;\r\n    }\r\n\r\ndataProcessor.prototype={\r\n\t/**\r\n\t* \t@desc: select GET or POST transaction model\r\n\t*\t@param: mode - GET/POST\r\n\t*\t@param: total - true/false - send records row by row or all at once (for grid only)\r\n\t*\t@type: public\r\n\t*/\r\n\tsetTransactionMode:function(mode,total){\r\n        this._tMode=mode;\r\n\t\tthis._tSend=total;\r\n\t\tif (mode == \"REST\"){\r\n\t\t\tthis._tSend = false;\r\n\t\t\tthis._endnm = true;\r\n\t\t}\r\n    },\r\n    escape:function(data){\r\n    \tif (this._utf)\r\n    \t\treturn encodeURIComponent(data);\r\n    \telse\r\n        \treturn escape(data);\r\n\t},\r\n    /**\r\n\t* \t@desc: allows to set escaping mode\r\n\t*\t@param: true - utf based escaping, simple - use current page encoding\r\n\t*\t@type: public\r\n\t*/\t\r\n\tenableUTFencoding:function(mode){\r\n        this._utf=convertStringToBoolean(mode);\r\n    },\r\n    /**\r\n\t* \t@desc: allows to define, which column may trigger update\r\n\t*\t@param: val - array or list of true/false values\r\n\t*\t@type: public\r\n\t*/\r\n\tsetDataColumns:function(val){\r\n\t\tthis._columns=(typeof val == \"string\")?val.split(\",\"):val;\r\n    },\r\n    /**\r\n\t* \t@desc: get state of updating\r\n\t*\t@returns:   true - all in sync with server, false - some items not updated yet.\r\n\t*\t@type: public\r\n\t*/\r\n\tgetSyncState:function(){\r\n\t\treturn !this.updatedRows.length;\r\n\t},\r\n\t/**\r\n\t* \t@desc: enable/disable named field for data syncing, will use column ids for grid\r\n\t*\t@param:   mode - true/false\r\n\t*\t@type: public\r\n\t*/\r\n\tenableDataNames:function(mode){\r\n\t\tthis._endnm=convertStringToBoolean(mode);\r\n\t},\r\n\t/**\r\n\t* \t@desc: enable/disable mode , when only changed fields and row id send to the server side, instead of all fields in default mode\r\n\t*\t@param:   mode - true/false\r\n\t*\t@type: public\r\n\t*/\r\n\tenablePartialDataSend:function(mode){\r\n\t\tthis._changed=convertStringToBoolean(mode);\r\n\t},\r\n\t/**\r\n\t* \t@desc: set if rows should be send to server automaticaly\r\n\t*\t@param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\r\n\t*\t@type: public\r\n\t*/\r\n\tsetUpdateMode:function(mode,dnd){\r\n\t\tthis.autoUpdate = (mode==\"cell\");\r\n\t\tthis.updateMode = mode;\r\n\t\tthis.dnd=dnd;\r\n\t},\r\n\tignore:function(code,master){\r\n\t\tthis._silent_mode=true;\r\n\t\tcode.call(master||window);\r\n\t\tthis._silent_mode=false;\r\n\t},\r\n\t/**\r\n\t* \t@desc: mark row as updated/normal. check mandatory fields,initiate autoupdate (if turned on)\r\n\t*\t@param: rowId - id of row to set update-status for\r\n\t*\t@param: state - true for \"updated\", false for \"not updated\"\r\n\t*\t@param: mode - update mode name\r\n\t*\t@type: public\r\n\t*/\r\n\tsetUpdated:function(rowId,state,mode){\r\n\t\tif (this._silent_mode) return;\r\n\t\tvar ind=this.findRow(rowId);\r\n\t\t\r\n\t\tmode=mode||\"updated\";\r\n\t\tvar existing = this.obj.getUserData(rowId,this.action_param);\r\n\t\tif (existing && mode == \"updated\") mode=existing;\r\n\t\tif (state){\r\n\t\t\tthis.set_invalid(rowId,false); //clear previous error flag\r\n\t\t\tthis.updatedRows[ind]=rowId;\r\n\t\t\tthis.obj.setUserData(rowId,this.action_param,mode);\r\n\t\t\tif (this._in_progress[rowId]) \r\n\t\t\t\tthis._in_progress[rowId]=\"wait\";\r\n\t\t} else{\r\n\t\t\tif (!this.is_invalid(rowId)){\r\n\t\t\t\tthis.updatedRows.splice(ind,1);\r\n\t\t\t\tthis.obj.setUserData(rowId,this.action_param,\"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//clear changed flag\r\n\t\tif (!state)\r\n\t\t\tthis._clearUpdateFlag(rowId);\r\n     \t\t\t\r\n\t\tthis.markRow(rowId,state,mode);\r\n\t\tif (state && this.autoUpdate) this.sendData(rowId);\r\n\t},\r\n\t_clearUpdateFlag:function(id){},\r\n\tmarkRow:function(id,state,mode){ \r\n\t\tvar str=\"\";\r\n\t\tvar invalid=this.is_invalid(id);\r\n\t\tif (invalid){\r\n        \tstr=this.styles[invalid];\r\n        \tstate=true;\r\n    \t}\r\n\t\tif (this.callEvent(\"onRowMark\",[id,state,mode,invalid])){\r\n\t\t\t//default logic\r\n\t\t\tstr=this.styles[state?mode:\"clear\"]+str;\r\n\t\t\t\r\n        \tthis.obj[this._methods[0]](id,str);\r\n\r\n\t\t\tif (invalid && invalid.details){\r\n\t\t\t\tstr+=this.styles[invalid+\"_cell\"];\r\n\t\t\t\tfor (var i=0; i < invalid.details.length; i++)\r\n\t\t\t\t\tif (invalid.details[i])\r\n        \t\t\t\tthis.obj[this._methods[1]](id,i,str);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tgetState:function(id){\r\n\t\treturn this.obj.getUserData(id,this.action_param);\r\n\t},\r\n\tis_invalid:function(id){\r\n\t\treturn this._invalid[id];\r\n\t},\r\n\tset_invalid:function(id,mode,details){ \r\n\t\tif (details) mode={value:mode, details:details, toString:function(){ return this.value.toString(); }};\r\n\t\tthis._invalid[id]=mode;\r\n\t},\r\n\t/**\r\n\t* \t@desc: check mandatory fields and varify values of cells, initiate update (if specified)\r\n\t*\t@param: rowId - id of row to set update-status for\r\n\t*\t@type: public\r\n\t*/\r\n\tcheckBeforeUpdate:function(rowId){ \r\n\t\treturn true;\r\n\t},\r\n\t/**\r\n\t* \t@desc: send row(s) values to server\r\n\t*\t@param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\r\n\t*\t@type: public\r\n\t*/\r\n\tsendData:function(rowId){\r\n\t\tif (this._waitMode && (this.obj.mytype==\"tree\" || this.obj._h2)) return;\r\n\t\tif (this.obj.editStop) this.obj.editStop();\r\n\t\r\n\t\t\r\n\t\tif(typeof rowId == \"undefined\" || this._tSend) return this.sendAllData();\r\n\t\tif (this._in_progress[rowId]) return false;\r\n\t\t\r\n\t\tthis.messages=[];\r\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\",[rowId,this.messages])) return false;\r\n\t\tthis._beforeSendData(this._getRowData(rowId),rowId);\r\n    },\r\n    _beforeSendData:function(data,rowId){\r\n    \tif (!this.callEvent(\"onBeforeUpdate\",[rowId,this.getState(rowId),data])) return false;\t\r\n\t\tthis._sendData(data,rowId);\r\n    },\r\n    serialize:function(data, id){\r\n    \tif (typeof data == \"string\")\r\n    \t\treturn data;\r\n    \tif (typeof id != \"undefined\")\r\n    \t\treturn this.serialize_one(data,\"\");\r\n    \telse{\r\n    \t\tvar stack = [];\r\n    \t\tvar keys = [];\r\n    \t\tfor (var key in data)\r\n    \t\t\tif (data.hasOwnProperty(key)){\r\n    \t\t\t\tstack.push(this.serialize_one(data[key],key+this.post_delim));\r\n    \t\t\t\tkeys.push(key);\r\n\t\t\t\t}\r\n    \t\tstack.push(\"ids=\"+this.escape(keys.join(\",\")));\r\n    \t\tif (dhtmlx.security_key)\r\n\t\t\t\tstack.push(\"dhx_security=\"+dhtmlx.security_key);\r\n    \t\treturn stack.join(\"&\");\r\n    \t}\r\n    },\r\n    serialize_one:function(data, pref){\r\n    \tif (typeof data == \"string\")\r\n    \t\treturn data;\r\n    \tvar stack = [];\r\n    \tfor (var key in data)\r\n    \t\tif (data.hasOwnProperty(key)){\r\n    \t\t\tif ((key == \"id\" || key == this.action_param) && this._tMode == \"REST\") continue;\r\n    \t\t\tstack.push(this.escape((pref||\"\")+key)+\"=\"+this.escape(data[key]));\r\n    \t\t}\r\n\t\treturn stack.join(\"&\");\r\n    },\r\n    _sendData:function(a1,rowId){\r\n    \tif (!a1) return; //nothing to send\r\n\t\tif (!this.callEvent(\"onBeforeDataSending\",rowId?[rowId,this.getState(rowId),a1]:[null, null, a1])) return false;\t\t\t\t\r\n\t\t\r\n    \tif (rowId)\r\n\t\t\tthis._in_progress[rowId]=(new Date()).valueOf();\r\n\t\tvar a2=new dtmlXMLLoaderObject(function(that,b,c,d,xml){\r\n\t\t\tvar ids = [];\r\n\t\t\tif (rowId)\r\n\t\t\t\tids.push(rowId);\r\n\t\t\telse if (a1)\r\n\t\t\t\tfor (var key in a1)\r\n\t\t\t\t\tids.push(key);\r\n\r\n\t\t\treturn that.afterUpdate(that,xml,ids);\r\n\t\t},this,true);\r\n\t\t\r\n\t\tvar a3 = this.serverProcessor+(this._user?(getUrlSymbol(this.serverProcessor)+[\"dhx_user=\"+this._user,\"dhx_version=\"+this.obj.getUserData(0,\"version\")].join(\"&\")):\"\");\r\n\r\n\t\tif (this._tMode==\"GET\")\r\n        \ta2.loadXML(a3+((a3.indexOf(\"?\")!=-1)?\"&\":\"?\")+this.serialize(a1,rowId));\r\n\t\telse if (this._tMode == \"POST\")\r\n        \ta2.loadXML(a3,true,this.serialize(a1,rowId));\r\n        else if (this._tMode == \"REST\"){\r\n        \tvar state = this.getState(rowId);\r\n        \tvar url = a3.replace(/(\\&|\\?)editing\\=true/,\"\");\r\n        \tif (state == \"inserted\")\r\n        \t\ta2.loadXML(url+rowId,\"POST\",this.serialize(a1,rowId));\r\n        \telse if (state == \"deleted\")\r\n        \t\ta2.loadXML(url+rowId,\"DELETE\",\"\");\r\n        \telse\r\n        \t\ta2.loadXML(url+rowId,\"PUT\",this.serialize(a1,rowId));\r\n        }\r\n\r\n\t\tthis._waitMode++;\r\n    },\r\n\tsendAllData:function(){\r\n\t\tif (!this.updatedRows.length) return;\t\t\t\r\n\r\n\t\tthis.messages=[]; var valid=true;\r\n\t\tfor (var i=0; i<this.updatedRows.length; i++)\r\n\t\t\tvalid&=this.checkBeforeUpdate(this.updatedRows[i]);\r\n\t\tif (!valid && !this.callEvent(\"onValidationError\",[\"\",this.messages])) return false;\r\n\t\r\n\t\tif (this._tSend) \r\n\t\t\tthis._sendData(this._getAllData());\r\n\t\telse\r\n\t\t\tfor (var i=0; i<this.updatedRows.length; i++)\r\n\t\t\t\tif (!this._in_progress[this.updatedRows[i]]){\r\n\t\t\t\t\tif (this.is_invalid(this.updatedRows[i])) continue;\r\n\t\t\t\t\tthis._beforeSendData(this._getRowData(this.updatedRows[i]),this.updatedRows[i]);\r\n\t\t\t\t\tif (this._waitMode && (this.obj.mytype==\"tree\" || this.obj._h2)) return; //block send all for tree\r\n\t\t\t\t}\r\n\t},\r\n    \r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t_getAllData:function(rowId){\r\n\t\tvar out={};\r\n\t\tvar has_one = false;\r\n\t\tfor(var i=0;i<this.updatedRows.length;i++){\r\n\t\t\tvar id=this.updatedRows[i];\r\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)) continue;\r\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\",[id,this.getState(id), this._getRowData(id)])) continue;\r\n\t\t\tout[id]=this._getRowData(id,id+this.post_delim);\r\n\t\t\thas_one = true;\r\n\t\t\tthis._in_progress[id]=(new Date()).valueOf();\r\n\t\t}\r\n\t\treturn has_one?out:null;\r\n\t},\r\n\t\r\n\t\r\n\t/**\r\n\t* \t@desc: specify column which value should be varified before sending to server\r\n\t*\t@param: ind - column index (0 based)\r\n\t*\t@param: verifFunction - function (object) which should verify cell value (if not specified, then value will be compared to empty string). Two arguments will be passed into it: value and column name\r\n\t*\t@type: public\r\n\t*/\r\n\tsetVerificator:function(ind,verifFunction){\r\n\t\tthis.mandatoryFields[ind] = verifFunction||(function(value){return (value!==\"\");});\r\n\t},\r\n\t/**\r\n\t* \t@desc: remove column from list of those which should be verified\r\n\t*\t@param: ind - column Index (0 based)\r\n\t*\t@type: public\r\n\t*/\r\n\tclearVerificator:function(ind){\r\n\t\tthis.mandatoryFields[ind] = false;\r\n\t},\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tfindRow:function(pattern){\r\n\t\tvar i=0;\r\n    \tfor(i=0;i<this.updatedRows.length;i++)\r\n\t\t    if(pattern==this.updatedRows[i]) break;\r\n\t    return i;\r\n    },\r\n\r\n   \r\n\t\r\n\r\n\r\n    \r\n\r\n\r\n\r\n\r\n\r\n\t/**\r\n\t* \t@desc: define custom actions\r\n\t*\t@param: name - name of action, same as value of action attribute\r\n\t*\t@param: handler - custom function, which receives a XMl response content for action\r\n\t*\t@type: private\r\n\t*/\r\n\tdefineAction:function(name,handler){\r\n        if (!this._uActions) this._uActions=[];\r\n            this._uActions[name]=handler;\r\n\t},\r\n\r\n\r\n\r\n\r\n\t/**\r\n*     @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\r\n*     @param: sid - id of item before update\r\n*     @param: tid - id of item after up0ate\r\n*     @param: action - action name\r\n*     @type: public\r\n*     @topic: 0\r\n*/\r\n\tafterUpdateCallback:function(sid, tid, action, btag) {\r\n\t\tvar marker = sid;\r\n\t\tvar correct=(action!=\"error\" && action!=\"invalid\");\r\n\t\tif (!correct) this.set_invalid(sid,action);\r\n\t\tif ((this._uActions)&&(this._uActions[action])&&(!this._uActions[action](btag))) \r\n\t\t\treturn (delete this._in_progress[marker]);\r\n\t\t\t\r\n\t\tif (this._in_progress[marker]!=\"wait\")\r\n\t    \tthis.setUpdated(sid, false);\r\n\t    \t\r\n\t    var soid = sid;\r\n\t\r\n\t    switch (action) {\r\n\t    case \"inserted\":\r\n\t    case \"insert\":\r\n\t        if (tid != sid) {\r\n\t            this.obj[this._methods[2]](sid, tid);\r\n\t            sid = tid;\r\n\t        }\r\n\t        break;\r\n\t    case \"delete\":\r\n\t    case \"deleted\":\r\n\t    \tthis.obj.setUserData(sid, this.action_param, \"true_deleted\");\r\n\t        this.obj[this._methods[3]](sid);\r\n\t        delete this._in_progress[marker];\r\n\t        return this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\r\n\t    }\r\n\t    \r\n\t    if (this._in_progress[marker]!=\"wait\"){\r\n\t    \tif (correct) this.obj.setUserData(sid, this.action_param,'');\r\n\t    \tdelete this._in_progress[marker];\r\n    \t} else {\r\n    \t\tdelete this._in_progress[marker];\r\n    \t\tthis.setUpdated(tid,true,this.obj.getUserData(sid,this.action_param));\r\n\t\t}\r\n\t    \r\n\t    this.callEvent(\"onAfterUpdate\", [soid, action, tid, btag]);\r\n\t},\r\n\r\n\t/**\r\n\t* \t@desc: response from server\r\n\t*\t@param: xml - XMLLoader object with response XML\r\n\t*\t@type: private\r\n\t*/\r\n\tafterUpdate:function(that,xml,id){\r\n\t\t//try to use json first\r\n\t\tif (window.JSON){\r\n\t\t\ttry{\r\n\t\t\t\tvar tag = JSON.parse(xml.xmlDoc.responseText);\r\n\t\t\t\tvar action = tag.action || this.getState(id) || \"updated\";\r\n\t\t\t\tvar sid = tag.sid || id[0];\r\n\t\t\t\tvar tid = tag.tid || id[0];\r\n\t\t\t\tthat.afterUpdateCallback(sid, tid, action, tag);\r\n\t\t\t\tthat.finalizeUpdate();\r\n\t\t\t\treturn;\r\n\t\t\t} catch(e){\r\n\t\t\t}\r\n\t\t}\r\n\t\t//xml response\r\n\t\txml.getXMLTopNode(\"data\"); //fix incorrect content type in IE\r\n\r\n\t\tif (!xml.xmlDoc.responseXML){\r\n\t\t\tif(this.obj && this.obj.callEvent){\r\n\t\t\t\tthis.obj.callEvent(\"onSaveError\", [id, xml.xmlDoc]);\r\n\t\t\t}\r\n\t\t\treturn this.cleanUpdate(id);\r\n\t\t}\r\n\r\n\t\tvar atag=xml.doXPath(\"//data/action\");\r\n\t\tif (!atag.length) return this.cleanUpdate(id);\r\n\r\n\t\tfor (var i=0; i<atag.length; i++){\r\n        \tvar btag=atag[i];\r\n\t\t\tvar action = btag.getAttribute(\"type\");\r\n\t\t\tvar sid = btag.getAttribute(\"sid\");\r\n\t\t\tvar tid = btag.getAttribute(\"tid\");\r\n\t\t\t\r\n\t\t\tthat.afterUpdateCallback(sid,tid,action,btag);\r\n\t\t}\r\n\t\tthat.finalizeUpdate();\r\n\t},\r\n\tcleanUpdate:function(id){\r\n\t\tif (id)\r\n\t\t\tfor (var i = 0; i < id.length; i++)\r\n\t\t\t\tdelete this._in_progress[id[i]];\r\n\t},\r\n\tfinalizeUpdate:function(){\r\n\t\tif (this._waitMode) this._waitMode--;\r\n\t\t\r\n\t\tif ((this.obj.mytype==\"tree\" || this.obj._h2) && this.updatedRows.length) \r\n\t\t\tthis.sendData();\r\n\t\tthis.callEvent(\"onAfterUpdateFinish\",[]);\r\n\t\tif (!this.updatedRows.length)\r\n\t\t\tthis.callEvent(\"onFullSync\",[]);\r\n\t},\r\n\r\n\r\n\r\n\r\n\t\r\n\t/**\r\n\t* \t@desc: initializes data-processor\r\n\t*\t@param: anObj - dhtmlxGrid object to attach this data-processor to\r\n\t*\t@type: public\r\n\t*/\r\n\tinit:function(anObj){\r\n\t\tthis.obj = anObj;\r\n\t\tif (this.obj._dp_init) \r\n\t\t\tthis.obj._dp_init(this);\r\n\t},\r\n\t\r\n\t\r\n\tsetOnAfterUpdate:function(ev){\r\n\t\tthis.attachEvent(\"onAfterUpdate\",ev);\r\n\t},\r\n\tenableDebug:function(mode){\r\n\t},\r\n\tsetOnBeforeUpdateHandler:function(func){  \r\n\t\tthis.attachEvent(\"onBeforeDataSending\",func);\r\n\t},\r\n\r\n\r\n\r\n\t/* starts autoupdate mode\r\n\t\t@param interval\r\n\t\t\ttime interval for sending update requests\r\n\t*/\r\n\tsetAutoUpdate: function(interval, user) {\r\n\t\tinterval = interval || 2000;\r\n\t\t\r\n\t\tthis._user = user || (new Date()).valueOf();\r\n\t\tthis._need_update = false;\r\n\t\tthis._loader = null;\r\n\t\tthis._update_busy = false;\r\n\t\t\r\n\t\tthis.attachEvent(\"onAfterUpdate\",function(sid,action,tid,xml_node){\r\n\t\t\tthis.afterAutoUpdate(sid, action, tid, xml_node);\r\n\t\t});\r\n\t\tthis.attachEvent(\"onFullSync\",function(){\r\n\t\t\tthis.fullSync();\r\n\t\t});\r\n\t\t\r\n\t\tvar self = this;\r\n\t\twindow.setInterval(function(){\r\n\t\t\tself.loadUpdate();\r\n\t\t}, interval);\r\n\t},\r\n\r\n\r\n\t/* process updating request answer\r\n\t\tif status == collision version is depricated\r\n\t\tset flag for autoupdating immidiatly\r\n\t*/\r\n\tafterAutoUpdate: function(sid, action, tid, xml_node) {\r\n\t\tif (action == 'collision') {\r\n\t\t\tthis._need_update = true;\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t/* callback function for onFillSync event\r\n\t\tcall update function if it's need\r\n\t*/\r\n\tfullSync: function() {\r\n\t\tif (this._need_update) {\r\n\t\t\tthis._need_update = false;\r\n\t\t\tthis.loadUpdate();\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\t/* sends query to the server and call callback function\r\n\t*/\r\n\tgetUpdates: function(url,callback){\r\n\t\tif (this._update_busy) \r\n\t\t\treturn false;\r\n\t\telse\r\n\t\t\tthis._update_busy = true;\r\n\t\t\r\n\t\tthis._loader = this._loader || new dtmlXMLLoaderObject(true);\r\n\t\t\r\n\t\tthis._loader.async=true;\r\n\t\tthis._loader.waitCall=callback;\r\n\t\tthis._loader.loadXML(url);\r\n\t},\r\n\r\n\r\n\t/* returns xml node value\r\n\t\t@param node\r\n\t\t\txml node\r\n\t*/\r\n\t_v: function(node) {\r\n\t\tif (node.firstChild) return node.firstChild.nodeValue;\r\n\t\treturn \"\";\r\n\t},\r\n\r\n\r\n\t/* returns values array of xml nodes array\r\n\t\t@param arr\r\n\t\t\tarray of xml nodes\r\n\t*/\r\n\t_a: function(arr) {\r\n\t\tvar res = [];\r\n\t\tfor (var i=0; i < arr.length; i++) {\r\n\t\t\tres[i]=this._v(arr[i]);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\r\n\r\n\t/* loads updates and processes them\r\n\t*/\r\n\tloadUpdate: function(){\r\n\t\tvar self = this;\r\n\t\tvar version = this.obj.getUserData(0,\"version\");\r\n\t\tvar url = this.serverProcessor+getUrlSymbol(this.serverProcessor)+[\"dhx_user=\"+this._user,\"dhx_version=\"+version].join(\"&\");\r\n\t\turl = url.replace(\"editing=true&\",\"\");\r\n\t\tthis.getUpdates(url, function(){\r\n\t\t\tvar vers = self._loader.doXPath(\"//userdata\");\r\n\t\t\tself.obj.setUserData(0,\"version\",self._v(vers[0]));\r\n\t\t\t\r\n\t\t\tvar upds = self._loader.doXPath(\"//update\");\r\n\t\t\tif (upds.length){\r\n\t\t\t\tself._silent_mode = true;\r\n\t\t\t\t\r\n\t\t\t\tfor (var i=0; i<upds.length; i++) {\r\n\t\t\t\t\tvar status = upds[i].getAttribute('status');\r\n\t\t\t\t\tvar id = upds[i].getAttribute('id');\r\n\t\t\t\t\tvar parent = upds[i].getAttribute('parent');\r\n\t\t\t\t\tswitch (status) {\r\n\t\t\t\t\t\tcase 'inserted':\r\n\t\t\t\t\t\t\tself.callEvent(\"insertCallback\",[upds[i], id, parent]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'updated':\r\n\t\t\t\t\t\t\tself.callEvent(\"updateCallback\",[upds[i], id, parent]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'deleted':\r\n\t\t\t\t\t\t\tself.callEvent(\"deleteCallback\",[upds[i], id, parent]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tself._silent_mode = false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tself._update_busy = false;\r\n\t\t\tself = null;\r\n\t\t});\r\n\t}\r\n\r\n};\r\n\r\n//(c)dhtmlx ltd. www.dhtmlx.com\r\nif (window.dataProcessor && !dataProcessor.prototype.init_original){\r\n\tdataProcessor.prototype.init_original=dataProcessor.prototype.init;\r\n\tdataProcessor.prototype.init=function(obj){\r\n\t\tthis.init_original(obj);\r\n\t\tobj._dataprocessor=this;\r\n\r\n\t\tthis.setTransactionMode(\"POST\",true);\r\n\t\tthis.serverProcessor+=(this.serverProcessor.indexOf(\"?\")!=-1?\"&\":\"?\")+\"editing=true\";\r\n\t};\r\n}\r\n\r\ndhtmlxError.catchError(\"LoadXML\", function(a, b, c){\r\n\tvar message = c[0].responseText;\r\n\r\n\tswitch (scheduler.config.ajax_error){\r\n\t\tcase \"alert\":\r\n\t\t\twindow.alert(message);\r\n\t\t\tbreak;\r\n\t\tcase \"console\":\r\n\t\t\twindow.console.log(message);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tbreak;\r\n\t}\r\n});\r\n\r\n\r\n\r\nwindow.Scheduler = { _seed: 0 };\r\nScheduler.plugin = function(code){\r\n\tthis._schedulerPlugins.push(code);\r\n\tcode(window.scheduler);\r\n};\r\nScheduler._schedulerPlugins = [];\r\nScheduler.getSchedulerInstance = function() {\r\n\tvar scheduler = { version: \"4.3.1\" };\r\n\r\ndhtmlxEventable(scheduler);\r\n\r\nscheduler._detachDomEvent = function(el, event, handler){\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(event, handler, false);\r\n\r\n\t}else if (el.detachEvent){\r\n\t\tel.detachEvent(\"on\"+event, handler);\r\n\t}\r\n};\r\n\r\nscheduler._init_once = function(){\r\n\r\n\tvar oldSize = getWindowSize();\r\n\tdhtmlxEvent(window,\"resize\",function(){\r\n\t\tvar newSize = getWindowSize();\r\n\r\n\t\t// ie7-8 triggers \"resize\" when window's elements are resized, it messes container-autoresize extension\r\n\t\t// check if it's actually resized\r\n\t\tif(!equals(oldSize, newSize)){\r\n\t\t\twindow.clearTimeout(scheduler._resize_timer);\r\n\t\t\tscheduler._resize_timer=window.setTimeout(function(){\r\n\t\t\t\tif (scheduler.callEvent(\"onSchedulerResize\",[]))  {\r\n\t\t\t\t\tscheduler.update_view();\r\n\t\t\t\t\tscheduler.callEvent(\"onAfterSchedulerResize\", []);\r\n\t\t\t\t}\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t\toldSize = newSize;\r\n\r\n\t});\r\n\tfunction getWindowSize(){\r\n\t\treturn {\r\n\t\t\tw : window.innerWidth || document.documentElement.clientWidth,\r\n\t\t\th : window.innerHeight || document.documentElement.clientHeight\r\n\t\t};\r\n\t}\r\n\tfunction equals(a,b){\r\n\t\treturn a.w == b.w && a.h == b.h;\r\n\t}\r\n\r\n\tscheduler._init_once = function(){};\r\n};\r\nscheduler.init=function(id,date,mode){\r\n\tdate=date||(scheduler._currentDate());\r\n\tmode=mode||\"week\";\r\n\r\n\tif(this._obj){\r\n\t\tthis.unset_actions();\r\n\t}\r\n\r\n\tthis._obj=(typeof id == \"string\")?document.getElementById(id):id;\r\n\r\n\t//hook for terrace skin\r\n\tif (this._skin_init)\r\n\t\tscheduler._skin_init();\r\n\r\n\tscheduler.date.init();\r\n\r\n\r\n\tthis._els=[];\r\n\tthis._scroll=true;\r\n\tthis._quirks=(_isIE && document.compatMode == \"BackCompat\");\r\n\tthis._quirks7=(_isIE && navigator.appVersion.indexOf(\"MSIE 8\")==-1);\r\n\r\n\tthis.get_elements();\r\n\tthis.init_templates();\r\n\tthis.set_actions();\r\n\r\n\tthis._init_once();\r\n\tthis._init_touch_events();\r\n\r\n\tthis.set_sizes();\r\n\tscheduler.callEvent('onSchedulerReady', []);\r\n\tthis.setCurrentView(date,mode);\r\n\r\n};\r\n\r\nscheduler.xy={\r\n\tmin_event_height:40,\r\n\tscale_width:50,\r\n\tscroll_width:18,\r\n\tscale_height:20,\r\n\tmonth_scale_height:20,\r\n\tmenu_width:25,\r\n\tmargin_top:0,\r\n\tmargin_left:0,\r\n\teditor_width:140,\r\n\tmonth_head_height:22\r\n};\r\nscheduler.keys={\r\n\tedit_save:13,\r\n\tedit_cancel:27\r\n};\r\nscheduler.set_sizes=function(){\r\n\tvar w = this._x = this._obj.clientWidth-this.xy.margin_left;\r\n\tvar h = this._y = this._obj.clientHeight-this.xy.margin_top;\r\n\t\r\n\t//not-table mode always has scroll - need to be fixed in future\r\n\tvar scale_x=this._table_view?0:(this.xy.scale_width+this.xy.scroll_width);\r\n\tvar scale_s=this._table_view?-1:this.xy.scale_width;\r\n\t\r\n\tthis.set_xy(this._els[\"dhx_cal_navline\"][0],w,this.xy.nav_height,0,0);\r\n\tthis.set_xy(this._els[\"dhx_cal_header\"][0],w-scale_x,this.xy.scale_height,scale_s,this.xy.nav_height+(this._quirks?-1:1));\r\n\t//to support alter-skin, we need a way to alter height directly from css\r\n\tvar actual_height = this._els[\"dhx_cal_navline\"][0].offsetHeight;\r\n\tif (actual_height > 0) this.xy.nav_height = actual_height;\r\n\t\r\n\tvar data_y=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);\r\n\tthis.set_xy(this._els[\"dhx_cal_data\"][0],w,h-(data_y+2),0,data_y+2);\r\n};\r\nscheduler.set_xy=function(node,w,h,x,y){\r\n\tnode.style.width=Math.max(0,w)+\"px\";\r\n\tnode.style.height=Math.max(0,h)+\"px\";\r\n\tif (arguments.length>3){\r\n\t\tnode.style.left=x+\"px\";\r\n\t\tnode.style.top=y+\"px\";\t\r\n\t}\r\n};\r\nscheduler.get_elements=function(){\r\n\t//get all child elements as named hash\r\n\tvar els=this._obj.getElementsByTagName(\"DIV\");\r\n\tfor (var i=0; i < els.length; i++){\r\n\t\tvar class_name=els[i].className || \"\";\r\n\t\tvar attr_value = els[i].getAttribute(\"name\") || \"\";\r\n\t\tif (class_name) class_name = class_name.split(\" \")[0];\r\n\t\tif (!this._els[class_name]) this._els[class_name]=[];\r\n\t\tthis._els[class_name].push(els[i]);\r\n\t\t\r\n\t\t//check if name need to be changed\r\n\t\tvar label = scheduler.locale.labels[attr_value||class_name];\r\n\t\tif (typeof label !== \"string\" && attr_value && !els[i].innerHTML)\r\n\t\t\t label = attr_value.split(\"_\")[0];\r\n\t\tif (label)\r\n\t\t\tels[i].innerHTML= label;\r\n\t}\r\n};\r\n\r\nscheduler.unset_actions = function(){\r\n\tfor (var a in this._els)\r\n\t\tif (this._click[a])\r\n\t\t\tfor (var i=0; i < this._els[a].length; i++)\r\n\t\t\t\tthis._els[a][i].onclick = null;\r\n\tthis._obj.onselectstart = null;\r\n\tthis._obj.onmousemove = null;\r\n\tthis._obj.onmousedown = null;\r\n\tthis._obj.onmouseup = null;\r\n\tthis._obj.ondblclick = null;\r\n\tthis._obj.oncontextmenu = null;\r\n};\r\n\r\nscheduler.set_actions=function(){\r\n\tfor (var a in this._els)\r\n\t\tif (this._click[a])\r\n\t\t\tfor (var i=0; i < this._els[a].length; i++)\r\n\t\t\t\tthis._els[a][i].onclick=scheduler._click[a];\r\n\tthis._obj.onselectstart=function(e){ return false; };\r\n\tthis._obj.onmousemove=function(e){\r\n\t\tif (!scheduler._temp_touch_block)\r\n\t\t\tscheduler._on_mouse_move(e||event);\r\n\t};\r\n\tthis._obj.onmousedown=function(e){\r\n\t\tif (!scheduler._ignore_next_click)\r\n\t\t\tscheduler._on_mouse_down(e||event);\r\n\t};\r\n\tthis._obj.onmouseup=function(e){\r\n\t\tif (!scheduler._ignore_next_click)\r\n\t\t\tscheduler._on_mouse_up(e||event);\r\n\t};\r\n\tthis._obj.ondblclick=function(e){\r\n\t\tscheduler._on_dbl_click(e||event);\r\n\t};\r\n\tthis._obj.oncontextmenu = function(e) {\r\n\t\tvar ev = e||event;\r\n\t\tvar src = ev.target||ev.srcElement;\r\n\t\tvar returnValue = scheduler.callEvent(\"onContextMenu\", [scheduler._locate_event(src), ev]);\r\n\t\treturn returnValue;\r\n\t};\r\n};\r\nscheduler.select=function(id){\r\n\tif (this._select_id==id) return;\r\n\tscheduler._close_not_saved();\r\n\tthis.editStop(false);\r\n\tthis.unselect();\r\n\tthis._select_id = id;\r\n\tthis.updateEvent(id);\r\n};\r\nscheduler.unselect=function(id){\r\n\tif (id && id!=this._select_id) return;\r\n\tvar t=this._select_id;\r\n\tthis._select_id = null;\r\n\tif (t && this.getEvent(t)) this.updateEvent(t);\r\n};\r\nscheduler.getState=function(){\r\n\treturn {\r\n\t\tmode: this._mode,\r\n\t\tdate: new Date(this._date),\r\n\t\tmin_date: new Date(this._min_date),\r\n\t\tmax_date: new Date(this._max_date),\r\n\t\teditor_id: this._edit_id,\r\n\t\tlightbox_id: this._lightbox_id,\r\n\t\tnew_event: this._new_event,\r\n\t\tselect_id: this._select_id,\r\n\t\texpanded: this.expanded,\r\n\t\tdrag_id: this._drag_id,\r\n\t\tdrag_mode: this._drag_mode\r\n\t};\r\n};\r\nscheduler._click={\r\n\tdhx_cal_data:function(e){\r\n\t\t//in case of touch disable click processing\r\n\t\tif (scheduler._ignore_next_click){\r\n\t\t\tif (e.preventDefault)\r\n\t\t\t\te.preventDefault();\r\n\t\t\te.cancelBubble = true;\r\n\t\t\tscheduler._ignore_next_click = false;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar trg = e?e.target:event.srcElement;\r\n\t\tvar id = scheduler._locate_event(trg);\r\n\t\t\r\n\t\te = e || event;\r\n\r\n\t\tif (!id) {\r\n\t\t\tscheduler.callEvent(\"onEmptyClick\",[scheduler.getActionData(e).date, e]);\r\n\t\t} else {\r\n\t\t\tif ( !scheduler.callEvent(\"onClick\",[id,e]) || scheduler.config.readonly ) return;\r\n\t\t}\r\n\r\n\t\tif (id && scheduler.config.select) {\r\n\r\n\t\t\tscheduler.select(id);\r\n\t\t\tvar mask = trg.className;\r\n\t\t\tif (mask.indexOf(\"_icon\")!=-1)\r\n\t\t\t\tscheduler._click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\r\n\t\t} else{\r\n\t\t\tscheduler._close_not_saved();\r\n\t\t\tif (new Date().valueOf()-(scheduler._new_event||0) > 500){\r\n\t\t\t\tscheduler.unselect();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdhx_cal_prev_button:function(){\r\n\t\tscheduler._click.dhx_cal_next_button(0,-1);\r\n\t},\r\n\tdhx_cal_next_button:function(dummy,step){\r\n\t\tscheduler.setCurrentView(scheduler.date.add( //next line changes scheduler._date , but seems it has not side-effects\r\n\t\t\tscheduler.date[scheduler._mode+\"_start\"](scheduler._date),(step||1),scheduler._mode));\r\n\t},\r\n\tdhx_cal_today_button:function(){\r\n\t\tif (scheduler.callEvent(\"onBeforeTodayDisplayed\", [])) {\r\n\t\t\tscheduler.setCurrentView(scheduler._currentDate());\r\n\t\t}\r\n\t},\r\n\tdhx_cal_tab:function(){\r\n\t\tvar name = this.getAttribute(\"name\");\r\n\t\tvar mode = name.substring(0, name.search(\"_tab\"));\r\n\t\tscheduler.setCurrentView(scheduler._date,mode);\r\n\t},\r\n\tbuttons:{\r\n\t\t\"delete\":function(id){\r\n\t\t\tvar c = scheduler.locale.labels.confirm_deleting;\r\n\t\t\tscheduler._dhtmlx_confirm(c, scheduler.locale.labels.title_confirm_deleting, function(){ scheduler.deleteEvent(id); });\r\n\t\t},\r\n\t\tedit:function(id){ scheduler.edit(id); },\r\n\t\tsave:function(id){ scheduler.editStop(true); },\r\n\t\tdetails:function(id){ scheduler.showLightbox(id); },\r\n\t\tcancel:function(id){ scheduler.editStop(false); }\r\n\t}\r\n};\r\nscheduler._dhtmlx_confirm = function(message, title, callback) {\r\n\tif (!message)\r\n\t\treturn callback();\r\n\tvar opts = { text: message };\r\n\tif (title)\r\n\t\topts.title = title;\r\n\tif (callback) {\r\n\t\topts.callback = function(result) {\r\n\t\t\tif (result)\r\n\t\t\t\tcallback();\r\n\t\t};\r\n\t}\r\n\tdhtmlx.confirm(opts);\r\n};\r\nscheduler.addEventNow=function(start,end,e){\r\n\tvar base = {};\r\n\tif (start && start.constructor.toString().match(/object/i) !== null){\r\n\t\tbase = start;\r\n\t\tstart = null;\r\n\t}\r\n\t\r\n\tvar d = (this.config.event_duration||this.config.time_step)*60000;\r\n\tif (!start) start = base.start_date||Math.round((scheduler._currentDate()).valueOf()/d)*d;\r\n\tvar start_date = new Date(start);\r\n\tif (!end){\r\n\t\tvar start_hour = this.config.first_hour;\r\n\t\tif (start_hour > start_date.getHours()){\r\n\t\t\tstart_date.setHours(start_hour);\r\n\t\t\tstart = start_date.valueOf();\r\n\t\t}\r\n\t\tend = start.valueOf()+d;\r\n\t}\r\n\tvar end_date = new Date(end);\r\n\r\n\t// scheduler.addEventNow(new Date(), new Date()) + collision though get_visible events defect (such event was not retrieved)\r\n\tif(start_date.valueOf() == end_date.valueOf())\r\n\t\tend_date.setTime(end_date.valueOf()+d);\r\n\r\n\tbase.start_date = base.start_date||start_date;\r\n\tbase.end_date =  base.end_date||end_date;\r\n\tbase.text = base.text||this.locale.labels.new_event;\r\n\tbase.id = this._drag_id = this.uid();\r\n\tthis._drag_mode=\"new-size\";\r\n\r\n\tthis._loading=true;\r\n\tthis.addEvent(base);\r\n\tthis.callEvent(\"onEventCreated\",[this._drag_id,e]);\r\n\tthis._loading=false;\r\n\t\r\n\tthis._drag_event={}; //dummy , to trigger correct event updating logic\r\n\tthis._on_mouse_up(e);\t\r\n};\r\nscheduler._on_dbl_click=function(e,src){\r\n\tsrc = src||(e.target||e.srcElement);\r\n\tif (this.config.readonly) return;\r\n\tvar name = (src.className||\"\").split(\" \")[0];\r\n\tswitch(name){\r\n\t\tcase \"dhx_scale_holder\":\r\n\t\tcase \"dhx_scale_holder_now\":\r\n\t\tcase \"dhx_month_body\":\r\n\t\tcase \"dhx_wa_day_data\":\r\n\t\t\tif (!scheduler.config.dblclick_create) break;\r\n\t\t\tthis.addEventNow(this.getActionData(e).date,null,e);\r\n\t\t\tbreak;\r\n\t\tcase \"dhx_cal_event\":\r\n\t\tcase \"dhx_wa_ev_body\":\r\n\t\tcase \"dhx_agenda_line\":\r\n\t\tcase \"dhx_grid_event\":\r\n\t\tcase \"dhx_cal_event_line\":\r\n\t\tcase \"dhx_cal_event_clear\":\r\n\t\t\tvar id = this._locate_event(src);\r\n\t\t\tif (!this.callEvent(\"onDblClick\",[id,e])) return;\r\n\t\t\tif (this.config.details_on_dblclick || this._table_view || !this.getEvent(id)._timed || !this.config.select)\r\n\t\t\t\tthis.showLightbox(id);\r\n\t\t\telse\r\n\t\t\t\tthis.edit(id);\r\n\t\t\tbreak;\r\n\t\tcase \"dhx_time_block\":\r\n\t\tcase \"dhx_cal_container\":\r\n\t\t\treturn;\r\n\t\tdefault:\r\n\t\t\tvar t = this[\"dblclick_\"+name];\r\n\t\t\tif (t) {\r\n\t\t\t\tt.call(this,e);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (src.parentNode && src != this)\r\n\t\t\t\t\treturn scheduler._on_dbl_click(e,src.parentNode);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n};\r\n//column index by mouse x-coordinate\r\nscheduler._get_column_index = function(x_pos){\r\n\tvar column = 0;\r\n\tif (this._cols){\r\n\r\n\t\tvar width = 0;\r\n\t\tfor(var i=0; i < this._cols.length && !width; i++){\r\n\t\t\twidth = this._cols[i];\r\n\t\t}\r\n\r\n\t\tif(width){\r\n\t\t\tcolumn = x_pos / width;\r\n\t\t}else{\r\n\t\t\tcolumn = 0;\r\n\t\t}\r\n\r\n\t\tif (this._ignores)\r\n\t\t\tfor (var i=0; i<=column; i++)\r\n\t\t\t\tif (this._ignores[i])\r\n\t\t\t\t\tcolumn++;\r\n\t}\r\n\treturn column;\r\n};\r\n//transform mouse coordinates to day-time indexes of week based view\r\nscheduler._week_indexes_from_pos = function(pos){\r\n\t//\"get position\" can be invoked before columns are loaded into the units view(e.g. by onMouseMove handler in key_nav.js)\r\n\tif(!this._cols){\r\n\t\treturn pos;\r\n\t}else{\r\n\t\tvar column = this._get_column_index(pos.x);\r\n\t\tpos.x=Math.min(this._cols.length-1, Math.max(0,Math.ceil(column)-1));\r\n\r\n\t\tpos.y=Math.max(0,Math.ceil(pos.y*60/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step);\r\n\t\treturn pos;\r\n\t}\r\n};\r\n\r\nscheduler._mouse_coords=function(ev){\r\n\tvar pos;\r\n\tvar b=document.body;\r\n\tvar d = document.documentElement;\r\n\tif (!_isIE && (ev.pageX || ev.pageY))\r\n\t    pos={x:ev.pageX, y:ev.pageY};\r\n\telse pos={\r\n\t    x:ev.clientX + (b.scrollLeft||d.scrollLeft||0) - b.clientLeft,\r\n\t    y:ev.clientY + (b.scrollTop||d.scrollTop||0) - b.clientTop\r\n\t};\r\n\r\n\t//apply layout\r\n\tpos.x-=getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width);\r\n\tpos.y-=getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els[\"dhx_cal_data\"][0].scrollTop;\r\n\tpos.ev = ev;\r\n\r\n\tvar handler = this[\"mouse_\"+this._mode];\r\n\tif (handler)\r\n\t\treturn handler.call(this,pos);\r\n\r\n\r\n\t//transform to date\r\n\tif (!this._table_view) {\r\n\t\tpos = this._week_indexes_from_pos(pos);\r\n\t} else {\r\n\t\tvar column = this._get_column_index(pos.x);\r\n\t\tif (!this._cols || !this._colsS) // agenda/map views\r\n\t\t\treturn pos;\r\n\t\tvar dy=0;\r\n\t\tfor (dy=1; dy < this._colsS.heights.length; dy++)\r\n\t\t\tif (this._colsS.heights[dy]>pos.y) break;\r\n\r\n\t\tpos.y=Math.ceil( (Math.max(0, column)+Math.max(0,dy-1)*7)*24*60/this.config.time_step );\r\n\r\n\t\tif (scheduler._drag_mode || this._mode == \"month\")\r\n\t\t\tpos.y=(Math.max(0,Math.ceil(column)-1)+Math.max(0,dy-1)*7)*24*60/this.config.time_step;\r\n\r\n\t\t//we care about ignored days only during event moving in month view\r\n\t\tif (this._drag_mode == \"move\"){\r\n\t\t\tif (scheduler._ignores_detected && scheduler.config.preserve_length){\r\n\t\t\t\tpos._ignores = true;\r\n\t\t\t\t//get real lengtn of event\r\n\t\t\t\tif (!this._drag_event._event_length)\r\n\t\t\t\t\tthis._drag_event._event_length = this._get_real_event_length(this._drag_event.start_date, this._drag_event.end_date, { x_step:1, x_unit:\"day\"});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpos.x=0;\r\n\t}\r\n\treturn pos;\r\n};\r\nscheduler._close_not_saved=function(){\r\n\tif (new Date().valueOf()-(scheduler._new_event||0) > 500 && scheduler._edit_id){\r\n\t\tvar c=scheduler.locale.labels.confirm_closing;\r\n\r\n\t\tscheduler._dhtmlx_confirm(c, scheduler.locale.labels.title_confirm_closing, function() { scheduler.editStop(scheduler.config.positive_closing); });\r\n\t\tif(c){\r\n\t\t\tthis._drag_id = this._drag_pos = this._drag_mode = null;\r\n\t\t}\r\n\t}\r\n};\r\nscheduler._correct_shift=function(start, back){\r\n\treturn start-=((new Date(scheduler._min_date)).getTimezoneOffset()-(new Date(start)).getTimezoneOffset())*60000*(back?-1:1);\t\r\n};\r\n\r\nscheduler._is_pos_changed = function(old_pos, new_pos){\r\n\tfunction diff(old_val, new_val, acc){\r\n\t\treturn !!(Math.abs(old_val - new_val) > acc);\r\n\t}\r\n\r\n\tif(!(old_pos && this._drag_pos)){\r\n\t\treturn true;\r\n\t}\r\n\tvar delay = 100,\r\n\t\td_pos = 5;\r\n\r\n\t// start drag only if passed some time since mouse down, or if mouse position changed sufficiently\r\n\treturn !!(!this._drag_pos.start || (+new Date() - this._drag_pos.start > delay) || diff(old_pos.x, new_pos.x, d_pos) || diff(old_pos.y, new_pos.y, d_pos));\r\n};\r\n\r\nscheduler._on_mouse_move=function(e){\r\n\tif (this._drag_mode){\r\n\t\tvar pos=this._mouse_coords(e);\r\n\t\tif (pos.force_redraw || this._is_pos_changed(this._drag_pos, pos)){\r\n\t\t\tvar start, end;\r\n\t\t\tif (this._edit_id!=this._drag_id)\r\n\t\t\t\tthis._close_not_saved();\r\n\r\n\t\t\tif(!this._drag_mode)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tthis._drag_pos=pos;\r\n\t\t\tthis._drag_pos.has_moved = true;\r\n\r\n\t\t\tif (this._drag_mode==\"create\"){\r\n\t\t\t\tthis._close_not_saved();\r\n\t\t\t\tthis.unselect(this._select_id);\r\n\t\t\t\tthis._loading=true; //will be ignored by dataprocessor\r\n\t\t\t\t\r\n\t\t\t\tstart = this._get_date_from_pos(pos).valueOf();\r\n\r\n\t\t\t\tif (!this._drag_start) {\r\n\t\t\t\t\tvar res = this.callEvent(\"onBeforeEventCreated\", [e, this._drag_id]);\r\n\t\t\t\t\tif (!res)\r\n\t\t\t\t\t\treturn;\r\n\r\n\r\n\t\t\t\t\tthis._drag_start=start;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tend = start;\r\n\t\t\t\tif (end == this._drag_start) {\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar start_date = new Date(this._drag_start);\r\n\t\t\t\tvar end_date = new Date(end);\r\n\t\t\t\tif ( (this._mode == \"day\" || this._mode == \"week\") &&\r\n\t\t\t\t\t(start_date.getHours() == end_date.getHours() &&\r\n\t\t\t\t\tstart_date.getMinutes() == end_date.getMinutes()) ) {\r\n\t\t\t\t\t\tend_date = new Date(this._drag_start+1000);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t\r\n\t\t\t\tthis._drag_id=this.uid();\r\n\t\t\t\tthis.addEvent(start_date, end_date, this.locale.labels.new_event, this._drag_id, pos.fields);\r\n\t\t\t\t\r\n\t\t\t\tthis.callEvent(\"onEventCreated\",[this._drag_id,e]);\r\n\t\t\t\tthis._loading=false;\r\n\t\t\t\tthis._drag_mode=\"new-size\";\r\n\t\t\t\t\r\n\t\t\t} \r\n\r\n\t\t\tvar ev=this.getEvent(this._drag_id);\r\n\t\t\tvar obj;\r\n\r\n\t\t\tif (this._drag_mode==\"move\"){\r\n\t\t\t\tstart = this._min_date.valueOf()+(pos.y*this.config.time_step+pos.x*24*60 -(scheduler._move_pos_shift||0) )*60000;\r\n\t\t\t\tif (!pos.custom && this._table_view) start+=this.date.time_part(ev.start_date)*1000;\r\n\t\t\t\tstart = this._correct_shift(start);\r\n\r\n\t\t\t\tif (pos._ignores && this.config.preserve_length && this._table_view){\r\n\t\t\t\t\tif (this.matrix) \r\n\t\t\t\t\t\tobj = this.matrix[this._mode];\r\n\t\t\t\t\tobj = obj  || { x_step:1, x_unit:\"day\" };\r\n\t\t\t\t\tend = start*1 + this._get_fictional_event_length(start, this._drag_event._event_length, obj);\r\n\t\t\t\t} else\r\n\t\t\t\t\tend = ev.end_date.valueOf()-(ev.start_date.valueOf()-start);\r\n\t\t\t} else { // resize\r\n\t\t\t\tstart = ev.start_date.valueOf();\r\n\t\t\t\tend = ev.end_date.valueOf();\r\n\t\t\t\tif (this._table_view) {\r\n\t\t\t\t\tvar resize_date = this._min_date.valueOf()+pos.y*this.config.time_step*60000 + (pos.custom?0:24*60*60000);\r\n\t\t\t\t\tif (this._mode == \"month\") {\r\n\t\t\t\t\t\tresize_date = this._correct_shift(resize_date, false);\r\n\t\t\t\t\t\tif( this._drag_from_start ) {\r\n\t\t\t\t\t\t\tvar day = 24*60*60000;\r\n\t\t\t\t\t\t\tif( resize_date <= scheduler.date.date_part(new Date(end+day-1)).valueOf() ) // to get end time as 23:59:59 and then the day start\r\n\t\t\t\t\t\t\t\tstart = resize_date - day;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tend = resize_date;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (pos.resize_from_start)\r\n\t\t\t\t\t\t\tstart = resize_date;\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tend = resize_date;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tend = this.date.date_part(new Date(ev.end_date.valueOf() - 1)).valueOf()+pos.y*this.config.time_step*60000;\r\n\t\t\t\t\tthis._els[\"dhx_cal_data\"][0].style.cursor=\"s-resize\";\r\n\t\t\t\t\tif (this._mode == \"week\" || this._mode == \"day\")\r\n\t\t\t\t\t\tend = this._correct_shift(end);\r\n\t\t\t\t}\r\n\t\t\t\tif (this._drag_mode == \"new-size\") {\r\n\t\t\t\t\tif (end <= this._drag_start){\r\n\t\t\t\t\t\tvar shift = pos.shift||((this._table_view && !pos.custom)?24*60*60000:0);\r\n\t\t\t\t\t\tstart = end-(pos.shift?0:shift);\r\n\t\t\t\t\t\tend = this._drag_start+(shift||(this.config.time_step*60000));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstart = this._drag_start;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (end<=start)\r\n\t\t\t\t\t\tend=start+this.config.time_step*60000;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar new_end = new Date(end-1);\t\t\t\r\n\t\t\tvar new_start = new Date(start);\r\n\t\t\t//deny drag out of visible scheduler scale in timeline view\r\n\t\t\tif(scheduler.config.limit_drag_out &&\r\n\t\t\t\t(+new_start < +scheduler._min_date || +end > +scheduler._max_date)){\r\n\t\t\t\t\tvar duration = end - new_start;\r\n\t\t\t\t\tif(+new_start < +scheduler._min_date){\r\n\t\t\t\t\t\tnew_start = new Date(scheduler._min_date);\r\n\t\t\t\t\t\tend = new Date(+new_start + duration);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tend = new Date(scheduler._max_date);\r\n\t\t\t\t\t\tnew_start = new Date(+end - duration);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar new_end = new Date(end-1);\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\t// fix event dates when resized to bottom of the column (day/week views)\r\n\t\t\tif(!this._table_view &&\r\n\t\t\t\t!scheduler.config.all_timed &&\r\n\t\t\t\t((!scheduler._get_section_view() && pos.x != this._get_event_sday({start_date: new Date(end), end_date:new Date(end)})) || new Date(end).getHours() >= this.config.last_hour)){\r\n\t\t\t\tvar duration = end - new_start;\r\n\t\t\t\tvar day = this._min_date.valueOf()+(pos.x*24*60)*60000;\r\n\t\t\t\tend = scheduler.date.date_part(new Date(day));\r\n\t\t\t\tend.setHours(this.config.last_hour);\r\n\t\t\t\tnew_end = new Date(end-1);\r\n\t\t\t\tif(this._drag_mode == \"move\"){\r\n\t\t\t\t\tnew_start = new Date(+end - duration);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//prevent out-of-borders situation for day|week view\r\n\t\t\tif ( this._table_view || (new_end.getDate()==new_start.getDate() && new_end.getHours()<this.config.last_hour) || scheduler._allow_dnd ){\r\n\t\t\t\tev.start_date=new_start;\r\n\t\t\t\tev.end_date=new Date(end);\r\n\t\t\t\tif (this.config.update_render){\r\n\t\t\t\t\t//fix for repaint after dnd and scroll issue, #231\r\n\t\t\t\t\tvar sx = scheduler._els[\"dhx_cal_data\"][0].scrollTop;\r\n\t\t\t\t\tthis.update_view();\r\n\t\t\t\t\tscheduler._els[\"dhx_cal_data\"][0].scrollTop = sx;\r\n\t\t\t\t} else\r\n\t\t\t\t\tthis.updateEvent(this._drag_id);\r\n\t\t\t}\r\n\t\t\tif (this._table_view) {\r\n\t\t\t\tthis.for_rendered(this._drag_id,function(r){\r\n\t\t\t\t\tr.className+=\" dhx_in_move\";\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.callEvent(\"onEventDrag\", [this._drag_id, this._drag_mode, e]);\r\n\t\t}\r\n\t}  else {\r\n\t\tif (scheduler.checkEvent(\"onMouseMove\")){\r\n\t\t\tvar id = this._locate_event(e.target||e.srcElement);\r\n\t\t\tthis.callEvent(\"onMouseMove\",[id,e]);\r\n\t\t}\r\n\t}\r\n};\r\nscheduler._on_mouse_down=function(e,src) {\r\n\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\r\n\t// let's ignore right mouse button then\r\n\tif (e.button == 2)\r\n\t\treturn;\r\n\r\n\tif (this.config.readonly || this._drag_mode) return;\r\n\tsrc = src||(e.target||e.srcElement);\r\n\tvar classname = src.className && src.className.split(\" \")[0];\r\n\r\n\tswitch (classname) {\r\n\t\tcase \"dhx_cal_event_line\":\r\n\t\tcase \"dhx_cal_event_clear\":\r\n\t\t\tif (this._table_view)\r\n\t\t\t\tthis._drag_mode=\"move\"; //item in table mode\r\n\t\t\tbreak;\r\n\t\tcase \"dhx_event_move\":\r\n\t\tcase \"dhx_wa_ev_body\":\r\n\t\t\tthis._drag_mode=\"move\";\r\n\t\t\tbreak;\r\n\t\tcase \"dhx_event_resize\":\r\n\t\t\tthis._drag_mode=\"resize\";\r\n\t\t\tif((src.className||\"\").indexOf(\"dhx_event_resize_end\") < 0){\r\n\t\t\t\tscheduler._drag_from_start = true;\r\n\t\t\t}else{\r\n\t\t\t\tscheduler._drag_from_start = false;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase \"dhx_scale_holder\":\r\n\t\tcase \"dhx_scale_holder_now\":\r\n\t\tcase \"dhx_month_body\":\r\n\t\tcase \"dhx_matrix_cell\":\r\n\t\tcase \"dhx_marked_timespan\":\r\n\t\t\tthis._drag_mode=\"create\";\r\n\t\t\tbreak;\r\n\t\tcase \"\":\r\n\t\t\tif (src.parentNode)\r\n\t\t\t\treturn scheduler._on_mouse_down(e,src.parentNode);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tif (!scheduler.checkEvent(\"onMouseDown\") || scheduler.callEvent(\"onMouseDown\", [classname])) {\r\n\t\t\t\tif (src.parentNode && src != this && classname != \"dhx_body\") {\r\n\t\t\t\t\treturn scheduler._on_mouse_down(e,src.parentNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._drag_mode=null;\r\n\t\t\tthis._drag_id=null;\r\n\t\t\tbreak;\r\n\t}\r\n\tif (this._drag_mode){\r\n\t\tvar id = this._locate_event(src);\r\n\t\tif (!this.config[\"drag_\"+this._drag_mode] || !this.callEvent(\"onBeforeDrag\",[id, this._drag_mode, e]))\r\n\t\t\tthis._drag_mode=this._drag_id=0;\r\n\t\telse {\r\n\t\t\tthis._drag_id= id;\r\n\r\n\t\t\tif (this._edit_id!=this._drag_id || (this._edit_id && this._drag_mode == \"create\"))\r\n\t\t\t\tthis._close_not_saved();\r\n\t\t\tif(!this._drag_mode)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tthis._drag_event = scheduler._lame_clone(this.getEvent(this._drag_id) || {});\r\n\t\t\tthis._drag_pos = this._mouse_coords(e);\r\n\t\t\tthis._drag_pos.start = +new Date();\r\n\t\t}\r\n\t}\r\n\tthis._drag_start=null;\r\n};\r\n\r\n\r\nscheduler._get_private_properties = function(event){\r\n\tvar fields = {};\r\n\tfor(var i in event){\r\n\t\tif(i.indexOf(\"_\") === 0){\r\n\t\t\tfields[i] = true;\r\n\t\t}\r\n\t}\r\n\treturn fields;\r\n};\r\nscheduler._clear_temporary_properties = function(clean, flagged_event){\r\n\tvar initial = this._get_private_properties(clean);\r\n\tvar current_state = this._get_private_properties(flagged_event);\r\n\tfor(var i in current_state){\r\n\t\tif(!initial[i]){\r\n\t\t\tdelete flagged_event[i];\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\nscheduler._on_mouse_up=function(e){\r\n\tif (e && e.button == 2 && scheduler.config.touch) return;\r\n\tif (this._drag_mode && this._drag_id){\r\n\t\tthis._els[\"dhx_cal_data\"][0].style.cursor=\"default\";\r\n\t\t//drop\r\n\r\n\t\tvar drag_id = this._drag_id;\r\n\t\tvar mode = this._drag_mode;\r\n\r\n\t\tvar moved = !this._drag_pos || this._drag_pos.has_moved;\r\n\r\n\t\tvar ev=this.getEvent(this._drag_id);\r\n\t\tif (moved && (this._drag_event._dhx_changed || !this._drag_event.start_date || ev.start_date.valueOf()!=this._drag_event.start_date.valueOf() || ev.end_date.valueOf()!=this._drag_event.end_date.valueOf())){\r\n\t\t\tvar is_new=(this._drag_mode==\"new-size\");\r\n\t\t\tif (!this.callEvent(\"onBeforeEventChanged\",[ev, e, is_new, this._drag_event])){\r\n\t\t\t\tif (is_new) \r\n\t\t\t\t\tthis.deleteEvent(ev.id, true);\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._drag_event._dhx_changed = false;\r\n\t\t\t\t\tthis._clear_temporary_properties(ev, this._drag_event);\r\n\t\t\t\t\tscheduler._lame_copy(ev, this._drag_event);\r\n\t\t\t\t\tthis.updateEvent(ev.id);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._drag_id = this._drag_mode = null;\r\n\t\t\t\tif (is_new && this.config.edit_on_create){\r\n\t\t\t\t\tthis.unselect();\r\n\t\t\t\t\tthis._new_event=new Date();//timestamp of creation\r\n\t\t\t\t\t//if selection disabled - force lightbox usage\r\n\t\t\t\t\tif (this._table_view || this.config.details_on_create || !this.config.select) {\r\n\t\t\t\t\t\tscheduler.callEvent(\"onDragEnd\", [drag_id, mode, e]);\r\n\t\t\t\t\t\treturn this.showLightbox(drag_id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._drag_pos = true; //set flag to trigger full redraw\r\n\t\t\t\t\tthis._select_id = this._edit_id = drag_id;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!this._new_event)\r\n\t\t\t\t\t\tthis.callEvent(is_new?\"onEventAdded\":\"onEventChanged\",[drag_id,this.getEvent(drag_id)]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this._drag_pos && (this._drag_pos.has_moved || this._drag_pos === true)) this.render_view_data(); //redraw even if there is no real changes - necessary for correct positioning item after drag\r\n\t\tscheduler.callEvent(\"onDragEnd\", [drag_id, mode, e]);\r\n\t}\r\n\tthis._drag_id = null;\r\n\tthis._drag_mode=null;\r\n\tthis._drag_pos=null;\r\n};\r\n\r\nscheduler._trigger_dyn_loading = function(){\r\n\tif (this._load_mode && this._load()){\r\n\t\tthis._render_wait = true;\r\n\t\treturn true;\r\n\t}else{\r\n\t\treturn false;\r\n\t}\r\n};\r\nscheduler.update_view=function(){\r\n\tvar view = this[this._mode + \"_view\"];\r\n\tif(view){\r\n\t\tview(true);\r\n\t}else{\r\n\t\tthis._reset_scale();\r\n\t}\r\n\r\n\tif (this._trigger_dyn_loading()){\r\n\t\treturn true;\r\n\t}\r\n\tthis.render_view_data();\r\n};\r\n\r\nscheduler.isViewExists = function(mode){\r\n\treturn !!(scheduler[mode+ \"_view\"] ||\r\n\t\t(scheduler.date[mode+ \"_start\"] && scheduler.templates[mode+ \"_date\"] && scheduler.templates[mode+ \"_scale_date\"]));\r\n};\r\n\r\nscheduler.updateView = function(date, mode) {\r\n\tdate = date || this._date;\r\n\tmode = mode || this._mode;\r\n\tvar dhx_cal_data = 'dhx_cal_data';\r\n\r\n\tif (!this._mode)\r\n\t\tthis._obj.className += \" dhx_scheduler_\" + mode; else {\r\n\t\tthis._obj.className = this._obj.className.replace(\"dhx_scheduler_\" + this._mode, \"dhx_scheduler_\" + mode);\r\n\t}\r\n\r\n\tvar prev_scroll = (this._mode == mode && this.config.preserve_scroll) ? this._els[dhx_cal_data][0].scrollTop : false; // saving current scroll\r\n\r\n\t//hide old custom view\r\n\tif (this[this._mode + \"_view\"] && mode && this._mode != mode)\r\n\t\tthis[this._mode + \"_view\"](false);\r\n\r\n\tthis._close_not_saved();\r\n\r\n\tvar dhx_multi_day = 'dhx_multi_day';\r\n\tif (this._els[dhx_multi_day]) {\r\n\t\tthis._els[dhx_multi_day][0].parentNode.removeChild(this._els[dhx_multi_day][0]);\r\n\t\tthis._els[dhx_multi_day] = null;\r\n\t}\r\n\r\n\tthis._mode = mode;\r\n\tthis._date = date;\r\n\tthis._table_view = (this._mode == \"month\");\r\n\r\n\tthis._dy_shift = 0;//correction for multiday section in week/day views\r\n\r\n\tvar tabs = this._els[\"dhx_cal_tab\"];\r\n\tif(tabs){//calendar can work without view tabs\r\n\t\tfor (var i = 0; i < tabs.length; i++) {\r\n\t\t\tvar name = tabs[i].className;\r\n\t\t\tname = name.replace(/ active/g, \"\");\r\n\t\t\tif (tabs[i].getAttribute(\"name\") == this._mode + \"_tab\")\r\n\t\t\t\tname = name + \" active\";\r\n\t\t\ttabs[i].className = name;\r\n\t\t}\r\n\t}\r\n\t//show new view\r\n\tthis.update_view();\r\n\r\n\tif (typeof prev_scroll == \"number\") // if we are updating or working with the same view scrollTop should be saved\r\n\t\tthis._els[dhx_cal_data][0].scrollTop = prev_scroll; // restoring original scroll\r\n};\r\nscheduler.setCurrentView = function(date, mode) {\r\n\tif (!this.callEvent(\"onBeforeViewChange\", [this._mode, this._date, mode || this._mode, date || this._date])) return;\r\n\tthis.updateView(date, mode);\r\n\tthis.callEvent(\"onViewChange\", [this._mode, this._date]);\r\n};\r\nscheduler._render_x_header = function(i,left,d,h, offset_top){\r\n\toffset_top = offset_top || 0;\r\n\t//header scale\t\r\n\tvar head=document.createElement(\"DIV\");\r\n\thead.className = \"dhx_scale_bar\";\r\n\r\n\tif(this.templates[this._mode+\"_scalex_class\"]){\r\n\t\t//'_scalex_class' - timeline already have similar template, use the same name\r\n\t\thead.className += ' ' + this.templates[this._mode+\"_scalex_class\"](d);\r\n\t}\r\n\r\n\tvar width = this._cols[i]-1;\r\n\r\n\tif (this._mode == \"month\" && i === 0 && this.config.left_border) {\r\n\t\thead.className += \" dhx_scale_bar_border\";\r\n\t\tleft = left+1;\r\n\t}\r\n\tthis.set_xy(head, width, this.xy.scale_height-2, left, offset_top);//-1 for border\r\n\thead.innerHTML=this.templates[this._mode+\"_scale_date\"](d,this._mode); //TODO - move in separate method\r\n\th.appendChild(head);\r\n};\r\n\r\nscheduler._get_columns_num = function(from, to){\r\n\tvar count = 7;\r\n\tif (!scheduler._table_view){\r\n\t\tvar count_n = scheduler.date[\"get_\"+scheduler._mode+\"_end\"];\r\n\t\tif (count_n) to = count_n(from);\r\n\t\tcount = Math.round((to.valueOf()-from.valueOf())/(1000*60*60*24));\r\n\t}\r\n\treturn count;\r\n};\r\nscheduler._get_timeunit_start = function(){\r\n\t//start date of currently displayed time unit(day, week,...)\r\n\treturn this.date[this._mode+\"_start\"](new Date(this._date.valueOf()));\r\n};\r\n\r\nscheduler._get_view_end = function(){\r\n\tvar dd = this._get_timeunit_start();\r\n\tvar ed = scheduler.date.add(dd, 1, this._mode);\r\n\tif (!scheduler._table_view){\r\n\t\tvar count_n = scheduler.date[\"get_\"+scheduler._mode+\"_end\"];\r\n\t\tif (count_n) ed = count_n(dd);\r\n\t}\r\n\treturn ed;\r\n};\r\nscheduler._calc_scale_sizes = function(width, from, to){\r\n\t//calculates number of displayed columns(days/units/month view cols) and their widths\r\n\tvar summ = width; //border delta\r\n\tvar count = this._get_columns_num(from, to);\r\n\r\n\tthis._process_ignores(from, count, \"day\", 1);\r\n\tvar realcount = count - this._ignores_detected;\r\n\r\n\tfor (var i=0; i<count; i++){\r\n\t\tif (this._ignores[i]){\r\n\t\t\tthis._cols[i] = 0;\r\n\t\t\trealcount++;\r\n\t\t} else {\r\n\t\t\tthis._cols[i]=Math.floor(summ/(realcount-i));\r\n\t\t}\r\n\t\tsumm-=this._cols[i];\r\n\t\tthis._colsS[i]=(this._cols[i-1]||0)+(this._colsS[i-1]||(this._table_view?0:this.xy.scale_width+2));\r\n\t}\r\n\tthis._colsS['col_length'] = count;\r\n\r\n\tthis._colsS[count] = (this._cols[count-1]+this._colsS[count-1]) || 0;\r\n};\r\nscheduler._set_scale_col_size = function(div, width, left){\r\n\tvar c = this.config;\r\n\tthis.set_xy(div, width-1, c.hour_size_px*(c.last_hour-c.first_hour), left+this.xy.scale_width+1, 0);//-1 for border\r\n};\r\n\r\nscheduler._render_scales = function(header, data_area){\r\n\t//render columns in week/units view, or header in month view\r\n\tvar sd = new Date(scheduler._min_date),\r\n\t\ted = new Date(scheduler._max_date),\r\n\t\ttoday = this.date.date_part( scheduler._currentDate());\r\n\r\n\tvar summ = parseInt(header.style.width,10); //border delta\r\n\tvar d = new Date(this._min_date);\r\n\tvar count = this._get_columns_num(sd, ed);\r\n\tthis._calc_scale_sizes(summ, sd, ed);\r\n\tvar left=0;\r\n\r\n\theader.innerHTML = \"\";\r\n\tfor (var i=0; i<count; i++){\r\n\t\tif (!this._ignores[i]){\r\n\t\t\tthis._render_x_header(i,left,d,header);\r\n\t\t}\r\n\t\tif (!this._table_view){\r\n\t\t\tvar scales=document.createElement(\"DIV\");\r\n\t\t\tvar cls = \"dhx_scale_holder\";\r\n\t\t\tif (d.valueOf() == today.valueOf()) cls = \"dhx_scale_holder_now\";\r\n\r\n\t\t\tif (this._ignores_detected && this._ignores[i]){\r\n\t\t\t\tcls += \" dhx_scale_ignore\";\r\n\t\t\t}\r\n\r\n\t\t\tscales.className = cls+\" \"+this.templates.week_date_class(d,today);\r\n\r\n\t\t\tthis._set_scale_col_size(scales, this._cols[i], left);\r\n\r\n\t\t\tdata_area.appendChild(scales);\r\n\t\t\tthis.callEvent(\"onScaleAdd\",[scales, d]);\r\n\t\t}\r\n\r\n\t\tleft+=this._cols[i];\r\n\t\td=this.date.add(d,1,\"day\");\r\n\t\td = this.date.day_start(d);\r\n\t}\r\n};\r\n\r\nscheduler._reset_scale=function(){\r\n\t//current mode doesn't support scales\r\n\t//we mustn't call reset_scale for such modes, so it just to be sure\r\n\tif (!this.templates[this._mode + \"_date\"]) return;\r\n\r\n\tvar h = this._els[\"dhx_cal_header\"][0];\r\n\tvar data_area = this._els[\"dhx_cal_data\"][0];\r\n\tvar c = this.config;\r\n\r\n\th.innerHTML = \"\";\r\n\t//data_area.scrollTop = 0; //fix flickering in FF; makes IE8 flicker instead\r\n\tdata_area.innerHTML = \"\";\r\n\r\n\tvar str = ((c.readonly || (!c.drag_resize)) ? \" dhx_resize_denied\" : \"\") + ((c.readonly || (!c.drag_move)) ? \" dhx_move_denied\" : \"\");\r\n\tdata_area.className = \"dhx_cal_data\" + str;\r\n\r\n\tthis._scales = {};\r\n\tthis._cols = [];\t//store for data section\r\n\tthis._colsS = {height: 0};\r\n\tthis._dy_shift = 0;\r\n\r\n\tthis.set_sizes();\r\n\r\n\tvar d,sd,today;\r\n\tvar dd = this._get_timeunit_start(),\r\n\t\ted = scheduler._get_view_end();\r\n\r\n\td = sd = this._table_view ? scheduler.date.week_start(dd) : dd;\r\n\r\n\r\n\tthis._min_date=d;\r\n\tthis._els[\"dhx_cal_date\"][0].innerHTML=this.templates[this._mode+\"_date\"](dd,ed,this._mode);\r\n\r\n\tthis._max_date = ed;\r\n\tscheduler._render_scales(h, data_area);\r\n\r\n\tif (this._table_view) // month view\r\n\t\tthis._reset_month_scale(data_area,dd,sd);\r\n\telse{\r\n\t\tthis._reset_hours_scale(data_area,dd,sd);\r\n\t\tif (c.multi_day) {\r\n\t\t\tvar dhx_multi_day = 'dhx_multi_day';\r\n\r\n\t\t\tif(this._els[dhx_multi_day]) {\r\n\t\t\t\tthis._els[dhx_multi_day][0].parentNode.removeChild(this._els[dhx_multi_day][0]);\r\n\t\t\t\tthis._els[dhx_multi_day] = null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar navline = this._els[\"dhx_cal_navline\"][0];\r\n\t\t\tvar top = navline.offsetHeight + this._els[\"dhx_cal_header\"][0].offsetHeight+1;\r\n\t\t\t\r\n\t\t\tvar c1 = document.createElement(\"DIV\");\r\n\t\t\tc1.className = dhx_multi_day;\r\n\t\t\tc1.style.visibility=\"hidden\";\r\n\t\t\tthis.set_xy(c1, Math.max(this._colsS[this._colsS.col_length]+this.xy.scroll_width - 2, 0), 0, 0, top); // 2 extra borders, dhx_header has -1 bottom margin\r\n\t\t\tdata_area.parentNode.insertBefore(c1,data_area);\r\n\t\t\t\r\n\t\t\tvar c2 = c1.cloneNode(true);\r\n\t\t\tc2.className = dhx_multi_day+\"_icon\";\r\n\t\t\tc2.style.visibility=\"hidden\";\r\n\t\t\tthis.set_xy(c2, this.xy.scale_width, 0, 0, top); // dhx_header has -1 bottom margin\r\n\t\t\t\r\n\t\t\tc1.appendChild(c2);\r\n\t\t\tthis._els[dhx_multi_day]=[c1,c2];\r\n\t\t\tthis._els[dhx_multi_day][0].onclick = this._click.dhx_cal_data;\r\n\t\t}\r\n\t}\r\n};\r\nscheduler._reset_hours_scale=function(b,dd,sd){\r\n\tvar c=document.createElement(\"DIV\");\r\n\tc.className=\"dhx_scale_holder\";\r\n\t\r\n\tvar date = new Date(1980,1,1,this.config.first_hour,0,0);\r\n\tfor (var i=this.config.first_hour*1; i < this.config.last_hour; i++) {\r\n\t\tvar cc=document.createElement(\"DIV\");\r\n\t\tcc.className=\"dhx_scale_hour\";\r\n\t\tcc.style.height=this.config.hour_size_px-(this._quirks?0:1)+\"px\";\r\n\t\tvar width = this.xy.scale_width;\r\n\t\tif (this.config.left_border) {\r\n\t\t\twidth = width - 1;\r\n\t\t\tcc.className += \" dhx_scale_hour_border\";\r\n\t\t}\r\n\t\tcc.style.width = width + \"px\";\r\n\t\tcc.innerHTML=scheduler.templates.hour_scale(date);\r\n\t\t\r\n\t\tc.appendChild(cc);\r\n\t\tdate=this.date.add(date,1,\"hour\");\r\n\t}\r\n\tb.appendChild(c);\r\n\tif (this.config.scroll_hour)\r\n\t\tb.scrollTop = this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour);\r\n};\r\n\r\nscheduler._currentDate = function(){\r\n\tif(scheduler.config.now_date){\r\n\t\treturn new Date(scheduler.config.now_date);\r\n\t}\r\n\treturn new Date();\r\n};\r\n\r\nscheduler._process_ignores = function(sd, n, mode, step, preserve){\r\n\tthis._ignores={};\r\n\tthis._ignores_detected = 0;\r\n\tvar ignore = scheduler[\"ignore_\"+this._mode];\r\n\r\n\tif (ignore){\r\n\t\tvar ign_date = new Date(sd);\r\n\t\tfor (var i=0; i<n; i++){\r\n\t\t\tif (ignore(ign_date)){\r\n\t\t\t\tthis._ignores_detected += 1;\r\n\t\t\t\tthis._ignores[i] = true;\r\n\t\t\t\tif (preserve)\r\n\t\t\t\t\tn++;\r\n\t\t\t}\r\n\t\t\tign_date = scheduler.date.add(ign_date, step, mode);\r\n\t\t\tif(scheduler.date[mode + '_start'])\r\n\t\t\t\tign_date = scheduler.date[mode + '_start'](ign_date);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nscheduler._render_month_scale = function(div, dd/*month start*/, sd/*view start*/ ){\r\n\t//renders month view layout\r\n\r\n\tvar ed=scheduler.date.add(dd,1,\"month\"),\r\n\t\tview_start = new Date(sd);\r\n\tvar cd = scheduler._currentDate();\r\n\tthis.date.date_part(cd);\r\n\tthis.date.date_part(sd);\r\n\r\n\tvar rows=Math.ceil(Math.round((ed.valueOf()-sd.valueOf()) / (60*60*24*1000) ) / 7);\r\n\tvar tdcss=[];\r\n\r\n\tfor (var i=0; i<=7; i++) {\r\n\t\tvar cell_width = ((this._cols[i]||0)-1);\r\n\t\tif (i === 0 && this.config.left_border) {\r\n\t\t\tcell_width = cell_width - 1;\r\n\t\t}\r\n\t\ttdcss[i]=\" style='width:\"+cell_width+\"px;\";\r\n\t}\r\n\r\n\tfunction getCellHeight(row){\r\n\t\tvar h = scheduler._colsS.height;\r\n\t\tif(scheduler._colsS.heights[row + 1] !== undefined ){\r\n\t\t\th = scheduler._colsS.heights[row + 1] - (scheduler._colsS.heights[row]||0);\r\n\t\t}\r\n\t\treturn h;\r\n\t}\r\n\r\n\r\n\tvar cellheight = 0;\r\n\r\n\tvar html=\"<table cellpadding='0' cellspacing='0'>\";\r\n\tvar rendered_dates = [];\r\n\tfor (var i=0; i<rows; i++){\r\n\t\thtml+=\"<tr>\";\r\n\t\tvar row_height = Math.max(getCellHeight(i) - scheduler.xy.month_head_height, 0);\r\n\t\tfor (var j=0; j<7; j++) {\r\n\t\t\thtml+=\"<td\";\r\n\r\n\t\t\tvar cls = \"\";\r\n\t\t\tif (sd<dd)\r\n\t\t\t\tcls='dhx_before';\r\n\t\t\telse if (sd>=ed)\r\n\t\t\t\tcls='dhx_after';\r\n\t\t\telse if (sd.valueOf()==cd.valueOf())\r\n\t\t\t\tcls='dhx_now';\r\n\r\n\t\t\tif (this._ignores_detected && this._ignores[j]){\r\n\t\t\t\tcls += \" dhx_scale_ignore\";\r\n\t\t\t}\r\n\r\n\t\t\thtml+=\" class='\"+cls+\" \"+this.templates.month_date_class(sd,cd)+\"' >\";\r\n\t\t\tvar body_class = \"dhx_month_body\";\r\n\t\t\tvar head_class = \"dhx_month_head\";\r\n\t\t\tif (j === 0 && this.config.left_border) {\r\n\t\t\t\tbody_class += \" dhx_month_body_border\";\r\n\t\t\t\thead_class += \" dhx_month_head_border\";\r\n\t\t\t}\r\n\t\t\tif (!this._ignores_detected || !this._ignores[j]){\r\n\t\t\t\thtml+=\"<div class='\"+head_class+\"'>\"+this.templates.month_day(sd)+\"</div>\";\r\n\t\t\t\thtml+=\"<div class='\"+body_class+\"' \"+tdcss[j] + \";height:\"+row_height + \"px;'></div></td>\";\r\n\t\t\t} else {\r\n\t\t\t\thtml+=\"<div></div><div></div>\";\r\n\t\t\t}\r\n\t\t\trendered_dates.push(sd);\r\n\t\t\tvar bf1 = sd.getDate();\r\n\t\t\tsd=this.date.add(sd,1,\"day\");\r\n\t\t\tif (sd.getDate() - bf1 > 1)\r\n\t\t\t\tsd = new Date(sd.getFullYear(), sd.getMonth(), bf1 + 1, 12, 0);\r\n\t\t}\r\n\t\thtml+=\"</tr>\";\r\n\r\n\t\tscheduler._colsS.heights[i] = cellheight;\r\n\t\tcellheight += getCellHeight(i);\r\n\t}\r\n\thtml+=\"</table>\";\r\n\r\n\tthis._min_date = view_start;\r\n\tthis._max_date = sd;\r\n\r\n\tdiv.innerHTML=html;\r\n\r\n\tthis._scales = {};\r\n\tvar divs = div.getElementsByTagName('div');\r\n\tfor (var i=0; i<rendered_dates.length; i++) { // [header, body, header, body, ...]\r\n\t\tvar div = divs[(i*2)+1];\r\n\t\tvar date = rendered_dates[i];\r\n\t\tthis._scales[+date] = div;\r\n\t}\r\n\tfor (var i=0; i<rendered_dates.length; i++) {\r\n\t\tvar date = rendered_dates[i];\r\n\t\tthis.callEvent(\"onScaleAdd\", [this._scales[+date], date]);\r\n\t}\r\n\r\n\r\n\r\n\treturn this._max_date;\r\n};\r\n\r\nscheduler._reset_month_scale=function(b,dd,sd){\r\n\t//recalculates rows height and redraws month layout\r\n\tvar ed=scheduler.date.add(dd,1,\"month\");\r\n\t\r\n\t//trim time part for comparation reasons\r\n\tvar cd = scheduler._currentDate();\r\n\tthis.date.date_part(cd);\r\n\tthis.date.date_part(sd);\r\n\r\n\tvar rows=Math.ceil(Math.round((ed.valueOf()-sd.valueOf()) / (60*60*24*1000) ) / 7);\r\n\r\n\tvar height = (Math.floor(b.clientHeight/rows) - this.xy.month_head_height);\r\n\t\r\n\tthis._colsS.height = height + this.xy.month_head_height;\r\n\tthis._colsS.heights = [];\r\n\r\n\treturn scheduler._render_month_scale(b, dd, sd);\r\n\r\n};\r\nscheduler.getLabel = function(property, key) {\r\n\tvar sections = this.config.lightbox.sections;\r\n\tfor (var i=0; i<sections.length; i++) {\r\n\t\tif(sections[i].map_to == property) {\r\n\t\t\tvar options = sections[i].options;\r\n\t\t\tfor (var j=0; j<options.length; j++) {\r\n\t\t\t\tif(options[j].key == key) {\r\n\t\t\t\t\treturn options[j].label;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn \"\";\r\n};\r\nscheduler.updateCollection = function(list_name, collection) {\r\n\tvar list = scheduler.serverList(list_name);\r\n\tif (!list) return false;\r\n\tlist.splice(0, list.length);\r\n\tlist.push.apply(list, collection || []);\r\n\tscheduler.callEvent(\"onOptionsLoad\", []);\r\n\tscheduler.resetLightbox();\r\n\treturn true;\r\n};\r\nscheduler._lame_clone = function(object, cache) {\r\n\tvar i, t, result; // iterator, types array, result\r\n\r\n\tcache = cache || [];\r\n\r\n\tfor (i=0; i<cache.length; i+=2)\r\n\t\tif(object === cache[i])\r\n\t\t\treturn cache[i+1];\r\n\r\n\tif (object && typeof object == \"object\") {\r\n\t\tresult = {};\r\n\t\tt = [Array,Date,Number,String,Boolean];\r\n\t\tfor (i=0; i<t.length; i++) {\r\n\t\t\tif (object instanceof t[i])\r\n\t\t\t\tresult = i ? new t[i](object) : new t[i](); // first one is array\r\n\t\t}\r\n\t\tcache.push(object, result);\r\n\t\tfor (i in object) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\r\n\t\t\t\tresult[i] = scheduler._lame_clone(object[i], cache);\r\n\t\t}\r\n\t}\r\n\treturn result || object;\r\n};\r\nscheduler._lame_copy = function(target, source) {\r\n\tfor (var key in source) {\r\n\t\tif (source.hasOwnProperty(key)) {\r\n\t\t\ttarget[key] = source[key];\r\n\t\t}\r\n\t}\r\n\treturn target;\r\n};\r\nscheduler._get_date_from_pos = function(pos) {\r\n\tvar start=this._min_date.valueOf()+(pos.y*this.config.time_step+(this._table_view?0:pos.x)*24*60)*60000;\r\n\treturn new Date(this._correct_shift(start));\r\n};\r\n// n_ev - native event\r\nscheduler.getActionData = function(n_ev) {\r\n\tvar pos = this._mouse_coords(n_ev);\r\n\treturn {\r\n\t\tdate:this._get_date_from_pos(pos),\r\n\t\tsection:pos.section\r\n\t};\r\n};\r\nscheduler._focus = function(node, select){\r\n\tif (node && node.focus){\r\n\t\tif (this.config.touch){\r\n\t\t\twindow.setTimeout(function(){ \r\n\t\t\t\tnode.focus();\r\n\t\t\t},100);\r\n\t\t} else {\r\n\t\t\tif (select && node.select) node.select();\r\n\t\t\tnode.focus();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n//non-linear scales\r\nscheduler._get_real_event_length=function(sd, fd, obj){\r\n\tvar ev_length = fd -sd;\r\n\tvar hours = (obj._start_correction + obj._end_correction)||0;\r\n\tvar ignore = this[\"ignore_\"+this._mode];\r\n\r\n\tvar start_slot = 0,\r\n\t\tend_slot;\r\n\tif (obj.render){\r\n\t\tstart_slot = this._get_date_index(obj, sd);\r\n\t\tend_slot = this._get_date_index(obj, fd);\r\n\t} else{\r\n\t\tend_slot = Math.round(ev_length/60/60/1000/24);\r\n\t}\r\n\r\n\twhile (start_slot < end_slot){\r\n\t\tvar check = scheduler.date.add(fd, -obj.x_step, obj.x_unit);\r\n\t\tif (ignore && ignore(fd))\r\n\t\t\tev_length -= (fd-check);\r\n\t\telse\r\n\t\t\tev_length -= hours;\r\n\r\n\t\tfd = check;\r\n\t\tend_slot--;\r\n\t}\r\n\treturn ev_length;\r\n};\r\nscheduler._get_fictional_event_length=function(end_date, ev_length, obj, back){\r\n\tvar sd = new Date(end_date);\r\n\tvar dir = back ? -1 : 1;\r\n\r\n\t//get difference caused by first|last hour\r\n\tif (obj._start_correction || obj._end_correction){\r\n\t\tvar today;\r\n\t\tif (back)\r\n\t\t\ttoday = (sd.getHours()*60+sd.getMinutes()) - (obj.first_hour||0)*60;\r\n\t\telse\r\n\t\t\ttoday = (obj.last_hour||0)*60 - (sd.getHours()*60+sd.getMinutes());\r\n\t\tvar per_day = (obj.last_hour - obj.first_hour)*60;\r\n\t\tvar days = Math.ceil( (ev_length / (60*1000) - today ) / per_day);\r\n\t\tev_length += days * (24*60 - per_day) * 60 * 1000;\r\n\t}\r\n\r\n\tvar fd = new Date(end_date*1+ev_length*dir);\r\n\tvar ignore = this[\"ignore_\"+this._mode];\r\n\r\n\tvar start_slot = 0,\r\n\t\tend_slot;\r\n\tif (obj.render){\r\n\t\tstart_slot = this._get_date_index(obj, sd);\r\n\t\tend_slot = this._get_date_index(obj, fd);\r\n\t} else{\r\n\t\tend_slot = Math.round(ev_length/60/60/1000/24);\r\n\t}\r\n\r\n\twhile (start_slot*dir <= end_slot*dir){\r\n\t\tvar check = scheduler.date.add(sd, obj.x_step*dir, obj.x_unit);\r\n\t\tif (ignore && ignore(sd)){\r\n\t\t\tev_length += (check-sd)*dir;\r\n\t\t\tend_slot += dir;\r\n\t\t}\r\n\r\n\t\tsd = check;\r\n\t\tstart_slot+=dir;\r\n\t}\r\n\t\r\n\treturn ev_length;\r\n};\r\n\r\nscheduler._get_section_view = function(){\r\n\tif(this.matrix && this.matrix[this._mode]){\r\n\t\treturn this.matrix[this._mode];\r\n\t}else if(this._props && this._props[this._mode]){\r\n\t\treturn this._props[this._mode];\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nscheduler._get_section_property = function(){\r\n\tif(this.matrix && this.matrix[this._mode]){\r\n\t\treturn this.matrix[this._mode].y_property;\r\n\t}else if(this._props && this._props[this._mode]){\r\n\t\treturn this._props[this._mode].map_to;\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nscheduler._is_initialized = function(){\r\n\tvar state = this.getState();\r\n\treturn (this._obj && state.date && state.mode);\r\n};\r\nscheduler._is_lightbox_open = function(){\r\n\tvar state = this.getState();\r\n\treturn state.lightbox_id !== null && state.lightbox_id !== undefined;\r\n};\r\nscheduler.date={\r\n\tinit:function(){\r\n\t\tvar s = scheduler.locale.date.month_short;\r\n\t\tvar t = scheduler.locale.date.month_short_hash = {};\r\n\t\tfor (var i = 0; i < s.length; i++)\r\n\t\t\tt[s[i]]=i;\r\n\r\n\t\tvar s = scheduler.locale.date.month_full;\r\n\t\tvar t = scheduler.locale.date.month_full_hash = {};\r\n\t\tfor (var i = 0; i < s.length; i++)\r\n\t\t\tt[s[i]]=i;\r\n\t},\r\n\t_bind_host_object : function(method){\r\n\t\tif(method.bind){\r\n\t\t\treturn method.bind(scheduler);\r\n\t\t}else{\r\n\t\t\treturn function(){ return method.apply(scheduler, arguments); };\r\n\t\t}\r\n\t},\r\n\tdate_part:function(date){\r\n\t\tvar old = new Date(date);\r\n\t\tdate.setHours(0);\r\n\t\tdate.setMinutes(0);\r\n\t\tdate.setSeconds(0);\r\n\t\tdate.setMilliseconds(0);\r\n\t\tif (date.getHours() && //shift to yesterday on dst\r\n\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()) )\r\n\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\r\n\t\treturn date;\r\n\t},\r\n\ttime_part:function(date){\r\n\t\treturn (date.valueOf()/1000 - date.getTimezoneOffset()*60)%86400;\r\n\t},\r\n\tweek_start:function(date){\r\n\t\tvar shift=date.getDay();\r\n\t\tif (scheduler.config.start_on_monday){\r\n\t\t\tif (shift===0) shift=6;\r\n\t\t\telse shift--;\r\n\t\t}\r\n\t\treturn this.date_part(this.add(date,-1*shift,\"day\"));\r\n\t},\r\n\tmonth_start:function(date){\r\n\t\tdate.setDate(1);\r\n\t\treturn this.date_part(date);\r\n\t},\r\n\tyear_start:function(date){\r\n\t\tdate.setMonth(0);\r\n\t\treturn this.month_start(date);\r\n\t},\r\n\tday_start:function(date){\r\n\t\treturn this.date_part(date);\r\n\t},\r\n\t_add_days:function(date, inc){\r\n\t\tvar ndate = new Date(date.valueOf());\r\n\r\n\t\tndate.setDate(ndate.getDate() + inc);\r\n\t\tif (inc >= 0 && (!date.getHours() && ndate.getHours()) &&//shift to yesterday on dst\r\n\t\t\t(ndate.getDate() < date.getDate() || ndate.getMonth() < date.getMonth() || ndate.getFullYear() < date.getFullYear()) )\r\n\t\t\tndate.setTime(ndate.getTime() + 60 * 60 * 1000 * (24 - ndate.getHours()));\r\n\t\t   return ndate;\r\n\t},\r\n\tadd:function(date,inc,mode){\r\n\t\tvar ndate=new Date(date.valueOf());\r\n\t\tswitch(mode){\r\n\t\t\tcase \"day\":\r\n\t\t\t\tndate = scheduler.date._add_days(ndate, inc);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"week\":\r\n\t\t\t\tndate = scheduler.date._add_days(ndate, inc * 7);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"month\": ndate.setMonth(ndate.getMonth()+inc); break;\r\n\t\t\tcase \"year\": ndate.setYear(ndate.getFullYear()+inc); break;\r\n\t\t\tcase \"hour\":\r\n\t\t\t\t/*\r\n\t\t\t\t setHour(getHour() + inc) and setMinutes gives weird result when is applied on a Daylight Saving time switch\r\n\t\t\t\t setTime seems working as expected\r\n\t\t\t\t*/\r\n\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"minute\":\r\n\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn scheduler.date[\"add_\"+mode](date,inc,mode);\r\n\t\t}\r\n\t\treturn ndate;\r\n\t},\r\n\tto_fixed:function(num){\r\n\t\tif (num<10)\treturn \"0\"+num;\r\n\t\treturn num;\r\n\t},\r\n\tcopy:function(date){\r\n\t\treturn new Date(date.valueOf());\r\n\t},\r\n\tdate_to_str:function(format,utc){\r\n\t\tformat=format.replace(/%[a-zA-Z]/g,function(a){\r\n\t\t\tswitch(a){\r\n\t\t\t\tcase \"%d\": return \"\\\"+this.date.to_fixed(date.getDate())+\\\"\";\r\n\t\t\t\tcase \"%m\": return \"\\\"+this.date.to_fixed((date.getMonth()+1))+\\\"\";\r\n\t\t\t\tcase \"%j\": return \"\\\"+date.getDate()+\\\"\";\r\n\t\t\t\tcase \"%n\": return \"\\\"+(date.getMonth()+1)+\\\"\";\r\n\t\t\t\tcase \"%y\": return \"\\\"+this.date.to_fixed(date.getFullYear()%100)+\\\"\";\r\n\t\t\t\tcase \"%Y\": return \"\\\"+date.getFullYear()+\\\"\";\r\n\t\t\t\tcase \"%D\": return \"\\\"+this.locale.date.day_short[date.getDay()]+\\\"\";\r\n\t\t\t\tcase \"%l\": return \"\\\"+this.locale.date.day_full[date.getDay()]+\\\"\";\r\n\t\t\t\tcase \"%M\": return \"\\\"+this.locale.date.month_short[date.getMonth()]+\\\"\";\r\n\t\t\t\tcase \"%F\": return \"\\\"+this.locale.date.month_full[date.getMonth()]+\\\"\";\r\n\t\t\t\tcase \"%h\": return \"\\\"+this.date.to_fixed((date.getHours()+11)%12+1)+\\\"\";\r\n\t\t\t\tcase \"%g\": return \"\\\"+((date.getHours()+11)%12+1)+\\\"\";\r\n\t\t\t\tcase \"%G\": return \"\\\"+date.getHours()+\\\"\";\r\n\t\t\t\tcase \"%H\": return \"\\\"+this.date.to_fixed(date.getHours())+\\\"\";\r\n\t\t\t\tcase \"%i\": return \"\\\"+this.date.to_fixed(date.getMinutes())+\\\"\";\r\n\t\t\t\tcase \"%a\": return \"\\\"+(date.getHours()>11?\\\"pm\\\":\\\"am\\\")+\\\"\";\r\n\t\t\t\tcase \"%A\": return \"\\\"+(date.getHours()>11?\\\"PM\\\":\\\"AM\\\")+\\\"\";\r\n\t\t\t\tcase \"%s\": return \"\\\"+this.date.to_fixed(date.getSeconds())+\\\"\";\r\n\t\t\t\tcase \"%W\": return \"\\\"+this.date.to_fixed(this.date.getISOWeek(date))+\\\"\";\r\n\t\t\t\tdefault: return a;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (utc) format=format.replace(/date\\.get/g,\"date.getUTC\");\r\n\t\tvar func = new Function(\"date\",\"return \\\"\"+format+\"\\\";\");\r\n\r\n\t\treturn scheduler.date._bind_host_object(func);\r\n\t},\r\n\tstr_to_date:function(format,utc){\r\n\t\tvar splt=\"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\r\n\t\tvar mask=format.match(/%[a-zA-Z]/g);\r\n\t\tfor (var i=0; i<mask.length; i++){\r\n\t\t\tswitch(mask[i]){\r\n\t\t\t\tcase \"%j\":\r\n\t\t\t\tcase \"%d\": splt+=\"set[2]=temp[\"+i+\"]||1;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%n\":\r\n\t\t\t\tcase \"%m\": splt+=\"set[1]=(temp[\"+i+\"]||1)-1;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%y\": splt+=\"set[0]=temp[\"+i+\"]*1+(temp[\"+i+\"]>50?1900:2000);\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%g\":\r\n\t\t\t\tcase \"%G\":\r\n\t\t\t\tcase \"%h\": \r\n\t\t\t\tcase \"%H\":\r\n\t\t\t\t\t\t\tsplt+=\"set[3]=temp[\"+i+\"]||0;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%i\":\r\n\t\t\t\t\t\t\tsplt+=\"set[4]=temp[\"+i+\"]||0;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%Y\": splt+=\"set[0]=temp[\"+i+\"]||0;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%a\":\t\t\t\t\t\r\n\t\t\t\tcase \"%A\": splt+=\"set[3]=set[3]%12+((temp[\"+i+\"]||'').toLowerCase()=='am'?0:12);\";\r\n\t\t\t\t\tbreak;\t\t\t\t\t\r\n\t\t\t\tcase \"%s\": splt+=\"set[5]=temp[\"+i+\"]||0;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%M\": splt+=\"set[1]=this.locale.date.month_short_hash[temp[\"+i+\"]]||0;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%F\": splt+=\"set[1]=this.locale.date.month_full_hash[temp[\"+i+\"]]||0;\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar code =\"set[0],set[1],set[2],set[3],set[4],set[5]\";\r\n\t\tif (utc) code =\" Date.UTC(\"+code+\")\";\r\n\t\tvar func = new Function(\"date\",\"var set=[0,0,1,0,0,0]; \"+splt+\" return new Date(\"+code+\");\");\r\n\t\treturn scheduler.date._bind_host_object(func);\r\n\t},\r\n\tgetISOWeek: function(ndate) {\r\n\t\tif(!ndate) return false;\r\n\t\tvar nday = ndate.getDay();\r\n\t\tif (nday === 0) {\r\n\t\t\tnday = 7;\r\n\t\t}\r\n\t\tvar first_thursday = new Date(ndate.valueOf());\r\n\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\r\n\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\r\n\t\tvar ordinal_date = Math.round( (first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\r\n\t\tvar week_number = 1 + Math.floor( ordinal_date / 7);\r\n\t\treturn week_number;\r\n\t},\r\n\tgetUTCISOWeek: function(ndate){\r\n\t\treturn this.getISOWeek(this.convert_to_utc(ndate));\r\n\t},\r\n\tconvert_to_utc: function(date) {\r\n\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\r\n\t}\r\n};\r\nscheduler.locale = {\r\n\tdate:{\r\n\t\tmonth_full:[\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\tmonth_short:[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n\t\tday_full:[\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n\t\tday_short:[\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\r\n\t},\r\n\tlabels:{\r\n\t\tdhx_cal_today_button:\"Today\",\r\n\t\tday_tab:\"Day\",\r\n\t\tweek_tab:\"Week\",\r\n\t\tmonth_tab:\"Month\",\r\n\t\tnew_event:\"New event\",\r\n\t\ticon_save:\"Save\",\r\n\t\ticon_cancel:\"Cancel\",\r\n\t\ticon_details:\"Details\",\r\n\t\ticon_edit:\"Edit\",\r\n\t\ticon_delete:\"Delete\",\r\n\t\tconfirm_closing:\"\",//Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting:\"Event will be deleted permanently, are you sure?\",\r\n\t\tsection_description:\"Description\",\r\n\t\tsection_time:\"Time period\",\r\n\t\tfull_day:\"Full day\",\r\n\r\n\t\t/*recurring events*/\r\n\t\tconfirm_recurring:\"Do you want to edit the whole set of repeated events?\",\r\n\t\tsection_recurring:\"Repeat event\",\r\n\t\tbutton_recurring:\"Disabled\",\r\n\t\tbutton_recurring_open:\"Enabled\",\r\n\t\tbutton_edit_series: \"Edit series\",\r\n\t\tbutton_edit_occurrence: \"Edit occurrence\",\r\n\r\n\t\t/*agenda view extension*/\r\n\t\tagenda_tab:\"Agenda\",\r\n\t\tdate:\"Date\",\r\n\t\tdescription:\"Description\",\r\n\r\n\t\t/*year view extension*/\r\n\t\tyear_tab:\"Year\",\r\n\r\n\t\t/* week agenda extension */\r\n\t\tweek_agenda_tab: \"Agenda\",\r\n\r\n\t\t/*grid view extension*/\r\n\t\tgrid_tab: \"Grid\",\r\n\r\n\t\t/* touch tooltip*/\r\n\t\tdrag_to_create:\"Drag to create\",\r\n\t\tdrag_to_move:\"Drag to move\",\r\n\r\n\t\t/* dhtmlx message default buttons */\r\n\t\tmessage_ok:\"OK\",\r\n\t\tmessage_cancel:\"Cancel\"\r\n\t}\r\n};\r\n\r\n\r\n/*\r\n%e\tDay of the month without leading zeros (01..31)\r\n%d\tDay of the month, 2 digits with leading zeros (01..31)\r\n%j\tDay of the year, 3 digits with leading zeros (001..366)\r\n%a\tA textual representation of a day, two letters\r\n%W\tA full textual representation of the day of the week\r\n\r\n%c\tNumeric representation of a month, without leading zeros (0..12)\r\n%m\tNumeric representation of a month, with leading zeros (00..12)\r\n%b\tA short textual representation of a month, three letters (Jan..Dec)\r\n%M\tA full textual representation of a month, such as January or March (January..December)\r\n\r\n%y\tA two digit representation of a year (93..03)\r\n%Y\tA full numeric representation of a year, 4 digits (1993..03)\r\n*/\r\n\r\nscheduler.config={\r\n\tdefault_date: \"%j %M %Y\",\r\n\tmonth_date: \"%F %Y\",\r\n\tload_date: \"%Y-%m-%d\",\r\n\tweek_date: \"%l\",\r\n\tday_date: \"%D, %F %j\",\r\n\thour_date: \"%H:%i\",\r\n\tmonth_day: \"%d\",\r\n\txml_date: \"%m/%d/%Y %H:%i\",\r\n\tapi_date: \"%d-%m-%Y %H:%i\",\r\n\tpreserve_length:true,\r\n\ttime_step: 5,\r\n\r\n\tstart_on_monday: 1,\r\n\tfirst_hour: 0,\r\n\tlast_hour: 24,\r\n\treadonly: false,\r\n\tdrag_resize: 1,\r\n\tdrag_move: 1,\r\n\tdrag_create: 1,\r\n\tdblclick_create: 1,\r\n\tedit_on_create: 1,\r\n\tdetails_on_create: 0,\r\n\tresize_month_events:false,\r\n\tresize_month_timed:false,\r\n\r\n\tcascade_event_display: false,\r\n\tcascade_event_count: 4,\r\n\tcascade_event_margin: 30,\r\n\r\n\tmulti_day:true,\r\n\tmulti_day_height_limit: 0,\r\n\r\n\tdrag_lightbox: true,\r\n\tpreserve_scroll: true,\r\n\tselect: true,\r\n\r\n\tserver_utc: false,\r\n\ttouch:true,\r\n\ttouch_tip:true,\r\n\ttouch_drag:500,\r\n\tquick_info_detached:true,\r\n\r\n\tpositive_closing: false,\r\n\r\n\tdrag_highlight: true,\r\n\tlimit_drag_out: false,\r\n\ticons_edit: [\"icon_save\", \"icon_cancel\"],\r\n\ticons_select: [\"icon_details\", \"icon_edit\", \"icon_delete\"],\r\n\tbuttons_left: [\"dhx_save_btn\", \"dhx_cancel_btn\"],\r\n\tbuttons_right: [\"dhx_delete_btn\"],\r\n\tlightbox: {\r\n\t\tsections: [\r\n\t\t\t{name: \"description\", height: 200, map_to: \"text\", type: \"textarea\", focus: true},\r\n\t\t\t{name: \"time\", height: 72, type: \"time\", map_to: \"auto\"}\r\n\t\t]\r\n\t},\r\n\thighlight_displayed_event: true,\r\n\tleft_border: false,\r\n\r\n\tajax_error: \"alert\",//\"ignore\"|\"console\"\r\n\tdelay_render: 0\r\n};\r\nscheduler.templates={};\r\nscheduler.init_templates=function(){\r\n\tvar labels = scheduler.locale.labels;\r\n\tlabels.dhx_save_btn \t= labels.icon_save;\r\n\tlabels.dhx_cancel_btn \t= labels.icon_cancel;\r\n\tlabels.dhx_delete_btn \t= labels.icon_delete;\r\n\r\n\r\n\tvar d=scheduler.date.date_to_str;\r\n\tvar c=scheduler.config;\r\n\tvar f = function(a,b){\r\n\t\tfor (var c in b)\r\n\t\t\tif (!a[c]) a[c]=b[c];\r\n\t};\r\n\tf(scheduler.templates,{\r\n\t\tday_date:d(c.default_date),\r\n\t\tmonth_date:d(c.month_date),\r\n\t\tweek_date:function(d1,d2){\r\n\t\t\treturn scheduler.templates.day_date(d1)+\" &ndash; \"+scheduler.templates.day_date(scheduler.date.add(d2,-1,\"day\"));\r\n\t\t},\r\n\t\tday_scale_date:d(c.default_date),\r\n\t\tmonth_scale_date:d(c.week_date),\r\n\t\tweek_scale_date:d(c.day_date),\r\n\t\thour_scale:d(c.hour_date),\r\n\t\ttime_picker:d(c.hour_date),\r\n\t\tevent_date:d(c.hour_date),\r\n\t\tmonth_day:d(c.month_day),\r\n\t\txml_date:scheduler.date.str_to_date(c.xml_date,c.server_utc),\r\n\t\tload_format:d(c.load_date,c.server_utc),\r\n\t\txml_format:d(c.xml_date,c.server_utc),\r\n\t\tapi_date:scheduler.date.str_to_date(c.api_date),\r\n\t\tevent_header:function(start,end,ev){\r\n\t\t\treturn scheduler.templates.event_date(start)+\" - \"+scheduler.templates.event_date(end);\r\n\t\t},\r\n\t\tevent_text:function(start,end,ev){\r\n\t\t\treturn ev.text;\r\n\t\t},\r\n\t\tevent_class:function(start,end,ev){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tmonth_date_class:function(d){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tweek_date_class:function(d){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tevent_bar_date:function(start,end,ev){\r\n\t\t\treturn scheduler.templates.event_date(start)+\" \";\r\n\t\t},\r\n\t\tevent_bar_text:function(start,end,ev){\r\n\t\t\treturn ev.text;\r\n\t\t},\r\n\t\tmonth_events_link : function(date, count){\r\n\t\t\treturn \"<a>View more(\"+count+\" events)</a>\";\r\n\t\t},\r\n\t\tdrag_marker_class : function(start, end, event){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tdrag_marker_content : function(start, end, event){\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t});\r\n\tthis.callEvent(\"onTemplatesReady\",[]);\r\n};\r\n\r\n\r\n\r\nscheduler.uid = function() {\r\n\tif (!this._seed) this._seed = (new Date()).valueOf();\r\n\treturn this._seed++;\r\n};\r\nscheduler._events = {};\r\nscheduler.clearAll = function() {\r\n\tthis._events = {};\r\n\tthis._loaded = {};\r\n\r\n\tthis._edit_id = null;\r\n\tthis._select_id = null;\r\n\tthis._drag_id = null;\r\n\tthis._drag_mode = null;\r\n\tthis._drag_pos = null;\r\n\r\n\tthis.clear_view();\r\n\tthis.callEvent(\"onClearAll\", []);\r\n};\r\nscheduler.addEvent = function(start_date, end_date, text, id, extra_data) {\r\n\tif (!arguments.length)\r\n\t\treturn this.addEventNow();\r\n\tvar ev = start_date;\r\n\tif (arguments.length != 1) {\r\n\t\tev = extra_data || {};\r\n\t\tev.start_date = start_date;\r\n\t\tev.end_date = end_date;\r\n\t\tev.text = text;\r\n\t\tev.id = id;\r\n\t}\r\n\tev.id = ev.id || scheduler.uid();\r\n\tev.text = ev.text || \"\";\r\n\r\n\tif (typeof ev.start_date == \"string\")  ev.start_date = this.templates.api_date(ev.start_date);\r\n\tif (typeof ev.end_date == \"string\")  ev.end_date = this.templates.api_date(ev.end_date);\r\n\r\n\tvar d = (this.config.event_duration || this.config.time_step) * 60000;\r\n\tif (ev.start_date.valueOf() == ev.end_date.valueOf())\r\n\t\tev.end_date.setTime(ev.end_date.valueOf() + d);\r\n\r\n\tev._timed = this.isOneDayEvent(ev);\r\n\r\n\tvar is_new = !this._events[ev.id];\r\n\tthis._events[ev.id] = ev;\r\n\tthis.event_updated(ev);\r\n\tif (!this._loading)\r\n\t\tthis.callEvent(is_new ? \"onEventAdded\" : \"onEventChanged\", [ev.id, ev]);\r\n\treturn ev.id;\r\n};\r\nscheduler.deleteEvent = function(id, silent) {\r\n\tvar ev = this._events[id];\r\n\tif (!silent && (!this.callEvent(\"onBeforeEventDelete\", [id, ev]) || !this.callEvent(\"onConfirmedBeforeEventDelete\", [id, ev])))\r\n\t\treturn;\r\n\tif (ev) {\r\n\t\tthis._select_id = null;\r\n\t\tdelete this._events[id];\r\n\t\tthis.event_updated(ev);\r\n\t}\r\n\r\n\tthis.callEvent(\"onEventDeleted\", [id, ev]);\r\n};\r\nscheduler.getEvent = function(id) {\r\n\treturn this._events[id];\r\n};\r\nscheduler.setEvent = function(id, hash) {\r\n\tif(!hash.id)\r\n\t\thash.id = id;\r\n\r\n\tthis._events[id] = hash;\r\n};\r\nscheduler.for_rendered = function(id, method) {\r\n\tfor (var i = this._rendered.length - 1; i >= 0; i--)\r\n\t\tif (this._rendered[i].getAttribute(\"event_id\") == id)\r\n\t\t\tmethod(this._rendered[i], i);\r\n};\r\nscheduler.changeEventId = function(id, new_id) {\r\n\tif (id == new_id) return;\r\n\tvar ev = this._events[id];\r\n\tif (ev) {\r\n\t\tev.id = new_id;\r\n\t\tthis._events[new_id] = ev;\r\n\t\tdelete this._events[id];\r\n\t}\r\n\tthis.for_rendered(id, function(r) {\r\n\t\tr.setAttribute(\"event_id\", new_id);\r\n\t});\r\n\tif (this._select_id == id) this._select_id = new_id;\r\n\tif (this._edit_id == id) this._edit_id = new_id;\r\n\t//if (this._drag_id==id) this._drag_id=new_id;\r\n\tthis.callEvent(\"onEventIdChange\", [id, new_id]);\r\n};\r\n\r\n(function() {\r\n\tvar attrs = [\"text\", \"Text\", \"start_date\", \"StartDate\", \"end_date\", \"EndDate\"];\r\n\tvar create_getter = function(name) {\r\n\t\treturn function(id) { return (scheduler.getEvent(id))[name]; };\r\n\t};\r\n\tvar create_setter = function(name) {\r\n\t\treturn function(id, value) {\r\n\t\t\tvar ev = scheduler.getEvent(id);\r\n\t\t\tev[name] = value;\r\n\t\t\tev._changed = true;\r\n\t\t\tev._timed = this.isOneDayEvent(ev);\r\n\t\t\tscheduler.event_updated(ev, true);\r\n\t\t};\r\n\t};\r\n\tfor (var i = 0; i < attrs.length; i += 2) {\r\n\t\tscheduler[\"getEvent\" + attrs[i + 1]] = create_getter(attrs[i]);\r\n\t\tscheduler[\"setEvent\" + attrs[i + 1]] = create_setter(attrs[i]);\r\n\t}\r\n})();\r\n\r\nscheduler.event_updated = function(ev, force) {\r\n\tif (this.is_visible_events(ev))\r\n\t\tthis.render_view_data();\r\n\telse\r\n\t\tthis.clear_event(ev.id);\r\n};\r\nscheduler.is_visible_events = function(ev) {\r\n\t//if in displayed dates\r\n\tvar in_visible_range = (ev.start_date < this._max_date && this._min_date < ev.end_date);\r\n\r\n\tif(in_visible_range){\r\n\r\n\t\t//end dates are not between last/first hours\r\n\t\tvar end_dates_visible = (this._table_view || ((ev.end_date.getHours() >= this.config.first_hour && ev.end_date.getHours() < this.config.last_hour) ||\r\n\t\t\t\t\t\t\t(ev.start_date.getHours() >= this.config.first_hour && ev.start_date.getHours() < this.config.last_hour))) ;\r\n\r\n\t\tif(end_dates_visible){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\r\n\t\t\t//event is bigger than area hidden between last/first hours\r\n\t\t\tvar event_duration = (ev.end_date.valueOf() - ev.start_date.valueOf()) / (1000*60*60),//hours\r\n\t\t\t\thidden_duration = 24 - (this.config.last_hour - this.config.first_hour);\r\n\r\n\t\t\treturn (event_duration > hidden_duration);\r\n\r\n\t\t}\r\n\t}else{\r\n\t\treturn false;\r\n\t}\r\n};\r\nscheduler.isOneDayEvent = function(ev) {\r\n\tvar delta = ev.end_date.getDate() - ev.start_date.getDate();\r\n\r\n\tif (!delta)\r\n\t\treturn ev.start_date.getMonth() == ev.end_date.getMonth() && ev.start_date.getFullYear() == ev.end_date.getFullYear();\r\n\telse {\r\n\t\tif (delta < 0)  delta = Math.ceil((ev.end_date.valueOf() - ev.start_date.valueOf()) / (24 * 60 * 60 * 1000));\r\n\t\treturn (delta == 1 && !ev.end_date.getHours() && !ev.end_date.getMinutes() && (ev.start_date.getHours() || ev.start_date.getMinutes() ));\r\n\t}\r\n\r\n};\r\nscheduler.get_visible_events = function(only_timed) {\r\n\t//not the best strategy for sure\r\n\tvar stack = [];\r\n\r\n\tfor (var id in this._events)\r\n\t\tif (this.is_visible_events(this._events[id]))\r\n\t\t\tif (!only_timed || this._events[id]._timed)\r\n\t\t\t\tif (this.filter_event(id, this._events[id]))\r\n\t\t\t\t\tstack.push(this._events[id]);\r\n\r\n\treturn stack;\r\n};\r\nscheduler.filter_event = function(id, ev) {\r\n\tvar filter = this[\"filter_\" + this._mode];\r\n\treturn (filter) ? filter(id, ev) : true;\r\n};\r\nscheduler._is_main_area_event = function(ev){\r\n\treturn !!ev._timed;\r\n};\r\nscheduler.render_view_data = function(evs, hold) {\r\n\tif (!evs) {\r\n\t\tif (this._not_render) {\r\n\t\t\tthis._render_wait = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._render_wait = false;\r\n\r\n\t\tthis.clear_view();\r\n\t\tevs = this.get_visible_events(!(this._table_view || this.config.multi_day));\r\n\t}\r\n\tfor(var i= 0, len = evs.length; i < len; i++){\r\n\t\tthis._recalculate_timed(evs[i]);\r\n\t}\r\n\r\n\tif (this.config.multi_day && !this._table_view) {\r\n\r\n\t\tvar tvs = [];\r\n\t\tvar tvd = [];\r\n\t\tfor (var i = 0; i < evs.length; i++) {\r\n\t\t\tif (this._is_main_area_event(evs[i]))\r\n\t\t\t\ttvs.push(evs[i]); \r\n\t\t\telse\r\n\t\t\t\ttvd.push(evs[i]);\r\n\t\t}\r\n\r\n\t\t// multiday events\r\n\t\tthis._rendered_location = this._els['dhx_multi_day'][0];\r\n\t\tthis._table_view = true;\r\n\t\tthis.render_data(tvd, hold);\r\n\t\tthis._table_view = false;\r\n\r\n\t\t// normal events\r\n\t\tthis._rendered_location = this._els['dhx_cal_data'][0];\r\n\t\tthis._table_view = false;\r\n\t\tthis.render_data(tvs, hold);\r\n\r\n\t} else {\r\n\t\tthis._rendered_location = this._els['dhx_cal_data'][0];\r\n\t\tthis.render_data(evs, hold);\r\n\t}\r\n};\r\n\r\n\r\nscheduler._view_month_day = function(e){\r\n\tvar date = scheduler.getActionData(e).date;\r\n\tif(!scheduler.callEvent(\"onViewMoreClick\", [date]))\r\n\t\treturn;\r\n\tscheduler.setCurrentView(date, \"day\");\r\n};\r\n\r\nscheduler._render_month_link = function(ev){\r\n\tvar parent = this._rendered_location;\r\n\tvar toRender = this._lame_clone(ev);\r\n\r\n\t//render links in each cell of multiday events\r\n\tfor(var d = ev._sday; d < ev._eday; d++){\r\n\r\n\t\ttoRender._sday = d;\r\n\t\ttoRender._eday = d+1;\r\n\r\n\t\tvar date = scheduler.date;\r\n\t\tvar curr = scheduler._min_date;\r\n\t\tcurr = date.add(curr, toRender._sweek, \"week\");\r\n\t\tcurr = date.add(curr, toRender._sday, \"day\");\r\n\t\tvar count = scheduler.getEvents(curr, date.add(curr, 1, \"day\")).length;\r\n\r\n\t\tvar pos = this._get_event_bar_pos(toRender);\r\n\t\tvar widt = (pos.x2 - pos.x);\r\n\r\n\t\tvar el = document.createElement(\"div\");\r\n\t\tel.onclick = function(e){scheduler._view_month_day(e||event);};\r\n\t\tel.className = \"dhx_month_link\";\r\n\t\tel.style.top = pos.y + \"px\";\r\n\t\tel.style.left = pos.x + \"px\";\r\n\t\tel.style.width = widt + \"px\";\r\n\t\tel.innerHTML = scheduler.templates.month_events_link(curr, count);\r\n\t\tthis._rendered.push(el);\r\n\r\n\t\tparent.appendChild(el);\r\n\t}\r\n};\r\n\r\nscheduler._recalculate_timed = function(id){\r\n\tif(!id) return;\r\n\tvar ev;\r\n\tif(typeof(id) != \"object\")\r\n\t\tev = this._events[id];\r\n\telse\r\n\t\tev = id;\r\n\tif(!ev) return;\r\n\tev._timed = scheduler.isOneDayEvent(ev);\r\n};\r\nscheduler.attachEvent(\"onEventChanged\", scheduler._recalculate_timed);\r\nscheduler.attachEvent(\"onEventAdded\", scheduler._recalculate_timed);\r\n\r\nscheduler.render_data = function(evs, hold) {\r\n\tevs = this._pre_render_events(evs, hold);\r\n\r\n\tfor (var i = 0; i < evs.length; i++)\r\n\t\tif (this._table_view){\r\n\t\t\tif(scheduler._mode != 'month'){\r\n\t\t\t\tthis.render_event_bar(evs[i]);//may be multiday section on other views\r\n\t\t\t}else{\r\n\r\n\t\t\t\tvar max_evs = scheduler.config.max_month_events;\r\n\t\t\t\tif(max_evs !== max_evs*1 || evs[i]._sorder < max_evs){\r\n\t\t\t\t\t//of max number events per month cell is set and event can be rendered\r\n\t\t\t\t\tthis.render_event_bar(evs[i]);\r\n\t\t\t\t}else if(max_evs !== undefined && evs[i]._sorder == max_evs){\r\n\t\t\t\t\t//render 'view more' links\r\n\t\t\t\t\tscheduler._render_month_link(evs[i]);\r\n\t\t\t\t}else{\r\n\t\t\t\t\t//do not render events with ordinal number > maximum events per cell\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t}else\r\n\t\t\tthis.render_event(evs[i]);\r\n};\r\n\r\nscheduler._get_first_visible_cell = function(cells) {\r\n\tfor (var i = 0; i < cells.length; i++) {\r\n\t\tif ((cells[i].className || \"\").indexOf(\"dhx_scale_ignore\") == -1) {\r\n\t\t\treturn cells[i];\r\n\t\t}\r\n\t}\r\n\t// if no visible cell found, return cells[0] to be more tolerant, since it's the original logic\r\n\treturn cells[0];\r\n};\r\n\r\nscheduler._pre_render_events = function(evs, hold) {\r\n\tvar hb = this.xy.bar_height;\r\n\tvar h_old = this._colsS.heights;\r\n\tvar h = this._colsS.heights = [0, 0, 0, 0, 0, 0, 0];\r\n\tvar data = this._els[\"dhx_cal_data\"][0];\r\n\r\n\tif (!this._table_view)\r\n\t\tevs = this._pre_render_events_line(evs, hold); //ignore long events for now\r\n\telse\r\n\t\tevs = this._pre_render_events_table(evs, hold);\r\n\r\n\tif (this._table_view) {\r\n\t\tif (hold)\r\n\t\t\tthis._colsS.heights = h_old;\r\n\t\telse {\r\n\t\t\tvar evl = data.firstChild;\r\n\t\t\tif (evl.rows) {\r\n\t\t\t\tfor (var i = 0; i < evl.rows.length; i++) {\r\n\t\t\t\t\th[i]++;\r\n\t\t\t\t\tvar cells = evl.rows[i].cells;\r\n\t\t\t\t\tvar cellHeight = this._colsS.height - this.xy.month_head_height;\r\n\t\t\t\t\tif ((h[i]) * hb > cellHeight) { // 22 - height of cell's header\r\n\t\t\t\t\t\t//we have overflow, update heights\r\n\r\n\t\t\t\t\t\tvar cHeight = cellHeight;\r\n\t\t\t\t\t\tif(this.config.max_month_events*1 !== this.config.max_month_events || h[i] <= this.config.max_month_events){\r\n\t\t\t\t\t\t\tcHeight = h[i] * hb;\r\n\t\t\t\t\t\t}else if( (this.config.max_month_events + 1) * hb > cellHeight){\r\n\t\t\t\t\t\t\tcHeight = (this.config.max_month_events + 1) * hb;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (var j = 0; j < cells.length; j++) {\r\n\t\t\t\t\t\t\tcells[j].childNodes[1].style.height = cHeight + \"px\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t//\th[i] = (h[i - 1] || 0) + cells[0].offsetHeight;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\th[i] = (h[i - 1] || 0) + scheduler._get_first_visible_cell(cells).offsetHeight;\r\n\t\t\t\t}\r\n\t\t\t\th.unshift(0);\r\n\t\t\t\tif (evl.parentNode.offsetHeight < evl.parentNode.scrollHeight && !scheduler._colsS.scroll_fix && scheduler.xy.scroll_width) {\r\n\r\n\t\t\t\t\tvar scale_settings = scheduler._colsS,\r\n\t\t\t\t\t\tsum_width = scale_settings[scale_settings.col_length],\r\n\t\t\t\t\t\trow_heights = scale_settings.heights.slice();\r\n\r\n\t\t\t\t\tsum_width -= (scheduler.xy.scroll_width || 0);\r\n\t\t\t\t\tthis._calc_scale_sizes(sum_width, this._min_date, this._max_date);\r\n\t\t\t\t\tscheduler._colsS.heights = row_heights;\r\n\r\n\t\t\t\t\tthis.set_xy(this._els[\"dhx_cal_header\"][0], sum_width, this.xy.scale_height);\r\n\t\t\t\t\tscheduler._render_scales(this._els[\"dhx_cal_header\"][0]);\r\n\t\t\t\t\tscheduler._render_month_scale(this._els[\"dhx_cal_data\"][0], this._get_timeunit_start(), this._min_date);\r\n\r\n\t\t\t\t\tscale_settings.scroll_fix = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (!evs.length && this._els[\"dhx_multi_day\"][0].style.visibility == \"visible\")\r\n\t\t\t\t\th[0] = -1;\r\n\t\t\t\tif (evs.length || h[0] == -1) {\r\n\t\t\t\t\t//shift days to have space for multiday events\r\n\t\t\t\t\tvar childs = evl.parentNode.childNodes;\r\n\r\n\t\t\t\t\t// +1 so multiday events would have 2px from top and 2px from bottom by default\r\n\t\t\t\t\tvar full_multi_day_height = (h[0] + 1) * hb + 1;\r\n\r\n\t\t\t\t\tvar used_multi_day_height = full_multi_day_height;\r\n\t\t\t\t\tvar used_multi_day_height_css = full_multi_day_height + \"px\";\r\n\t\t\t\t\tif (this.config.multi_day_height_limit) {\r\n\t\t\t\t\t\tused_multi_day_height = Math.min(full_multi_day_height, this.config.multi_day_height_limit) ;\r\n\t\t\t\t\t\tused_multi_day_height_css = used_multi_day_height + \"px\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdata.style.top = (this._els[\"dhx_cal_navline\"][0].offsetHeight + this._els[\"dhx_cal_header\"][0].offsetHeight + used_multi_day_height ) + 'px';\r\n\t\t\t\t\tdata.style.height = (this._obj.offsetHeight - parseInt(data.style.top, 10) - (this.xy.margin_top || 0)) + 'px';\r\n\r\n\t\t\t\t\tvar multi_day_section = this._els[\"dhx_multi_day\"][0];\r\n\t\t\t\t\tmulti_day_section.style.height = used_multi_day_height_css;\r\n\t\t\t\t\tmulti_day_section.style.visibility = (h[0] == -1 ? \"hidden\" : \"visible\");\r\n\r\n\t\t\t\t\t// icon\r\n\t\t\t\t\tvar multi_day_icon = this._els[\"dhx_multi_day\"][1];\r\n\t\t\t\t\tmulti_day_icon.style.height = used_multi_day_height_css;\r\n\t\t\t\t\tmulti_day_icon.style.visibility = (h[0] == -1 ? \"hidden\" : \"visible\");\r\n\t\t\t\t\tmulti_day_icon.className = h[0] ? \"dhx_multi_day_icon\" : \"dhx_multi_day_icon_small\";\r\n\t\t\t\t\tthis._dy_shift = (h[0] + 1) * hb;\r\n\t\t\t\t\tif(this.config.multi_day_height_limit){\r\n\t\t\t\t\t\tthis._dy_shift = Math.min(this.config.multi_day_height_limit, this._dy_shift);\r\n\t\t\t\t\t}\r\n\t\t\t\t\th[0] = 0;\r\n\r\n\t\t\t\t\tif (used_multi_day_height != full_multi_day_height) {\r\n\t\t\t\t\t\tdata.style.top = (parseInt(data.style.top) + 2) + \"px\";\r\n\r\n\t\t\t\t\t\tmulti_day_section.style.overflowY = \"auto\";\r\n\t\t\t\t\t//\tmulti_day_section.style.width = (parseInt(this._els[\"dhx_cal_navline\"][0].style.width)) + \"px\";\r\n\r\n\t\t\t\t\t\tmulti_day_icon.style.position = \"fixed\";\r\n\t\t\t\t\t\tmulti_day_icon.style.top = \"\";\r\n\t\t\t\t\t\tmulti_day_icon.style.left = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn evs;\r\n};\r\nscheduler._get_event_sday = function(ev) {\r\n\treturn Math.floor((ev.start_date.valueOf() - this._min_date.valueOf()) / (24 * 60 * 60 * 1000));\r\n};\r\nscheduler._get_event_mapped_end_date = function(ev) {\r\n\tvar end_date = ev.end_date;\r\n\tif (this.config.separate_short_events) {\r\n\t\tvar ev_duration = (ev.end_date - ev.start_date) / 60000; // minutes\r\n\t\tif (ev_duration < this._min_mapped_duration) {\r\n\t\t\tend_date = this.date.add(end_date, this._min_mapped_duration - ev_duration, \"minute\");\r\n\t\t}\r\n\t}\r\n\treturn end_date;\r\n};\r\nscheduler._pre_render_events_line = function(evs, hold){\r\n\tevs.sort(function(a, b) {\r\n\t\tif (a.start_date.valueOf() == b.start_date.valueOf())\r\n\t\t\treturn a.id > b.id ? 1 : -1;\r\n\t\treturn a.start_date > b.start_date ? 1 : -1;\r\n\t});\r\n\tvar days = []; //events by weeks\r\n\tvar evs_originals = [];\r\n\r\n\tthis._min_mapped_duration = Math.ceil(this.xy.min_event_height * 60 / this.config.hour_size_px);  // values could change along the way\r\n\r\n\tfor (var i = 0; i < evs.length; i++) {\r\n\t\tvar ev = evs[i];\r\n\r\n\t\t//check date overflow\r\n\t\tvar sd = ev.start_date;\r\n\t\tvar ed = ev.end_date;\r\n\t\t//check scale overflow\r\n\t\tvar sh = sd.getHours();\r\n\t\tvar eh = ed.getHours();\r\n\r\n\t\tev._sday = this._get_event_sday(ev); // sday based on event start_date\r\n\t\tif (this._ignores[ev._sday]){\r\n\t\t\t//ignore event\r\n\t\t\tevs.splice(i,1);\r\n\t\t\ti--;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (!days[ev._sday]) days[ev._sday] = [];\r\n\r\n\t\tif (!hold) {\r\n\t\t\tev._inner = false;\r\n\r\n\t\t\tvar stack = days[ev._sday];\r\n\r\n\t\t\twhile (stack.length) {\r\n\t\t\t\tvar t_ev = stack[stack.length - 1];\r\n\t\t\t\tvar t_end_date = this._get_event_mapped_end_date(t_ev);\r\n\t\t\t\tif (t_end_date.valueOf() <= ev.start_date.valueOf()) {\r\n\t\t\t\t\tstack.splice(stack.length - 1, 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar slot_index = stack.length;\r\n\t\t\tvar sorderSet = false;\r\n\t\t\tfor (var j = 0; j < stack.length; j++) {\r\n\t\t\t\tvar t_ev = stack[j];\r\n\t\t\t\tvar t_end_date = this._get_event_mapped_end_date(t_ev);\r\n\t\t\t\tif (t_end_date.valueOf() <= ev.start_date.valueOf()) {\r\n\t\t\t\t\tsorderSet = true;\r\n\t\t\t\t\tev._sorder = t_ev._sorder;\r\n\t\t\t\t\tslot_index = j;\r\n\t\t\t\t\tev._inner = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (stack.length)\r\n\t\t\t\tstack[stack.length - 1]._inner = true;\r\n\r\n\t\t\tif (!sorderSet) {\r\n\t\t\t\tif (stack.length) {\r\n\t\t\t\t\tif (stack.length <= stack[stack.length - 1]._sorder) {\r\n\t\t\t\t\t\tif (!stack[stack.length - 1]._sorder)\r\n\t\t\t\t\t\t\tev._sorder = 0;\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tfor (j = 0; j < stack.length; j++) {\r\n\t\t\t\t\t\t\t\tvar _is_sorder = false;\r\n\t\t\t\t\t\t\t\tfor (var k = 0; k < stack.length; k++) {\r\n\t\t\t\t\t\t\t\t\tif (stack[k]._sorder == j) {\r\n\t\t\t\t\t\t\t\t\t\t_is_sorder = true;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (!_is_sorder) {\r\n\t\t\t\t\t\t\t\t\tev._sorder = j;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tev._inner = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar _max_sorder = stack[0]._sorder;\r\n\t\t\t\t\t\tfor (j = 1; j < stack.length; j++) {\r\n\t\t\t\t\t\t\tif (stack[j]._sorder > _max_sorder)\r\n\t\t\t\t\t\t\t\t_max_sorder = stack[j]._sorder;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tev._sorder = _max_sorder + 1;\r\n\t\t\t\t\t\tev._inner = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else\r\n\t\t\t\t\tev._sorder = 0;\r\n\t\t\t}\r\n\r\n\t\t\tstack.splice(slot_index, slot_index == stack.length ? 0 : 1, ev);\r\n\r\n\t\t\tif (stack.length > (stack.max_count || 0)) {\r\n\t\t\t\tstack.max_count = stack.length;\r\n\t\t\t\tev._count = stack.length;\r\n\t\t\t} else {\r\n\t\t\t\tev._count = (ev._count) ? ev._count : 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (sh < this.config.first_hour || eh >= this.config.last_hour) {\r\n\t\t\t// Need to create copy of event as we will be changing it's start/end date\r\n\t\t\t// e.g. first_hour = 11 and event.start_date hours = 9. Need to preserve that info\r\n\t\t\tevs_originals.push(ev);\r\n\t\t\tevs[i] = ev = this._copy_event(ev);\r\n\r\n\t\t\tif (sh < this.config.first_hour) {\r\n\t\t\t\tev.start_date.setHours(this.config.first_hour);\r\n\t\t\t\tev.start_date.setMinutes(0);\r\n\t\t\t}\r\n\t\t\tif (eh >= this.config.last_hour) {\r\n\t\t\t\tev.end_date.setMinutes(0);\r\n\t\t\t\tev.end_date.setHours(this.config.last_hour);\r\n\t\t\t}\r\n\r\n\t\t\tif (ev.start_date > ev.end_date || sh == this.config.last_hour) {\r\n\t\t\t\tevs.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (!hold) {\r\n\t\tfor (var i = 0; i < evs.length; i++) {\r\n\t\t\tevs[i]._count = days[evs[i]._sday].max_count;\r\n\t\t}\r\n\t\tfor (var i = 0; i < evs_originals.length; i++)\r\n\t\t\tevs_originals[i]._count = days[evs_originals[i]._sday].max_count;\r\n\t}\r\n\r\n\treturn evs;\r\n};\r\nscheduler._time_order = function(evs) {\r\n\tevs.sort(function(a, b) {\r\n\t\tif (a.start_date.valueOf() == b.start_date.valueOf()) {\r\n\t\t\tif (a._timed && !b._timed) return 1;\r\n\t\t\tif (!a._timed && b._timed) return -1;\r\n\t\t\treturn a.id > b.id ? 1 : -1;\r\n\t\t}\r\n\t\treturn a.start_date > b.start_date ? 1 : -1;\r\n\t});\r\n};\r\nscheduler._pre_render_events_table = function(evs, hold) { // max - max height of week slot\r\n\tthis._time_order(evs);\r\n\tvar out = [];\r\n\tvar weeks = [\r\n\t\t[],\r\n\t\t[],\r\n\t\t[],\r\n\t\t[],\r\n\t\t[],\r\n\t\t[],\r\n\t\t[]\r\n\t]; //events by weeks\r\n\tvar max = this._colsS.heights;\r\n\tvar start_date;\r\n\tvar cols = this._cols.length;\r\n\tvar chunks_info = {};\r\n\r\n\tfor (var i = 0; i < evs.length; i++) {\r\n\t\tvar ev = evs[i];\r\n\t\tvar id = ev.id;\r\n\t\tif (!chunks_info[id]) {\r\n\t\t\tchunks_info[id] = {\r\n\t\t\t\tfirst_chunk: true,\r\n\t\t\t\tlast_chunk: true\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar chunk_info = chunks_info[id];\r\n\t\tvar sd = (start_date || ev.start_date);\r\n\t\tvar ed = ev.end_date;\r\n\t\t//trim events which are crossing through current view\r\n\t\tif (sd < this._min_date) {\r\n\t\t\tchunk_info.first_chunk = false;\r\n\t\t\tsd = this._min_date;\r\n\t\t}\r\n\t\tif (ed > this._max_date) {\r\n\t\t\tchunk_info.last_chunk = false;\r\n\t\t\ted = this._max_date;\r\n\t\t}\r\n\r\n\t\tvar locate_s = this.locate_holder_day(sd, false, ev);\r\n\t\tev._sday = locate_s % cols;\r\n\r\n\t\t//skip single day events for ignored dates\r\n\t\tif (this._ignores[ev._sday] && ev._timed) continue;\r\n\r\n\t\tvar locate_e = this.locate_holder_day(ed, true, ev) || cols;\r\n\t\tev._eday = (locate_e % cols) || cols; //cols used to fill full week, when event end on monday\r\n\t\tev._length = locate_e - locate_s;\r\n\r\n\t\t//3600000 - compensate 1 hour during winter|summer time shift\r\n\t\tev._sweek = Math.floor((this._correct_shift(sd.valueOf(), 1) - this._min_date.valueOf()) / (60 * 60 * 1000 * 24 * cols));\r\n\r\n\t\t//current slot\r\n\t\tvar stack = weeks[ev._sweek];\r\n\t\t//check order position\r\n\t\tvar stack_line;\r\n\r\n\t\tfor (stack_line = 0; stack_line < stack.length; stack_line++)\r\n\t\t\tif (stack[stack_line]._eday <= ev._sday)\r\n\t\t\t\tbreak;\r\n\r\n\t\tif (!ev._sorder || !hold) {\r\n\t\t\tev._sorder = stack_line;\r\n\t\t}\r\n\r\n\t\tif (ev._sday + ev._length <= cols) {\r\n\t\t\tstart_date = null;\r\n\t\t\tout.push(ev);\r\n\t\t\tstack[stack_line] = ev;\r\n\t\t\t//get max height of slot\r\n\t\t\tmax[ev._sweek] = stack.length - 1;\r\n\t\t\tev._first_chunk = chunk_info.first_chunk;\r\n\t\t\tev._last_chunk = chunk_info.last_chunk;\r\n\t\t} else { // split long event in chunks\r\n\t\t\tvar copy = this._copy_event(ev);\r\n\t\t\tcopy.id = ev.id;\r\n\t\t\tcopy._length = cols - ev._sday;\r\n\t\t\tcopy._eday = cols;\r\n\t\t\tcopy._sday = ev._sday;\r\n\t\t\tcopy._sweek = ev._sweek;\r\n\t\t\tcopy._sorder = ev._sorder;\r\n\t\t\tcopy.end_date = this.date.add(sd, copy._length, \"day\");\r\n\t\t\tcopy._first_chunk = chunk_info.first_chunk;\r\n\t\t\tif (chunk_info.first_chunk) {\r\n\t\t\t\tchunk_info.first_chunk = false;\r\n\t\t\t}\r\n\r\n\t\t\tout.push(copy);\r\n\t\t\tstack[stack_line] = copy;\r\n\t\t\tstart_date = copy.end_date;\r\n\t\t\t//get max height of slot\r\n\t\t\tmax[ev._sweek] = stack.length - 1;\r\n\t\t\ti--;\r\n\t\t\tcontinue;  //repeat same step\r\n\t\t}\r\n\t}\r\n\treturn out;\r\n};\r\nscheduler._copy_dummy = function() {\r\n\tvar a = new Date(this.start_date);\r\n\tvar b = new Date(this.end_date);\r\n\tthis.start_date = a;\r\n\tthis.end_date = b;\r\n};\r\nscheduler._copy_event = function(ev) {\r\n\tthis._copy_dummy.prototype = ev;\r\n\treturn new this._copy_dummy();\r\n\t//return {start_date:ev.start_date, end_date:ev.end_date, text:ev.text, id:ev.id}\r\n};\r\nscheduler._rendered = [];\r\nscheduler.clear_view = function() {\r\n\tfor (var i = 0; i < this._rendered.length; i++) {\r\n\t\tvar obj = this._rendered[i];\r\n\t\tif (obj.parentNode) obj.parentNode.removeChild(obj);\r\n\t}\r\n\tthis._rendered = [];\r\n};\r\nscheduler.updateEvent = function(id) {\r\n\tvar ev = this.getEvent(id);\r\n\tthis.clear_event(id);\r\n\r\n\tif (ev && this.is_visible_events(ev) && this.filter_event(id, ev) && (this._table_view || this.config.multi_day || ev._timed)) {\r\n\t\tif (this.config.update_render){\r\n\t\t\tthis.render_view_data(); \r\n\t\t}else{\r\n\t\t\tif(this.getState().mode == \"month\" && !this.getState().drag_id && !this.isOneDayEvent(ev)){\r\n\t\t\t\tthis.render_view_data();\r\n\t\t\t}else{\r\n\t\t\t\tthis.render_view_data([ev], true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\nscheduler.clear_event = function(id) {\r\n\tthis.for_rendered(id, function(node, i) {\r\n\t\tif (node.parentNode)\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\tscheduler._rendered.splice(i, 1);\r\n\t});\r\n};\r\nscheduler._y_from_date = function(date){\r\n\tvar sm = date.getHours() * 60 + date.getMinutes();\r\n\treturn ((Math.round((sm * 60 * 1000 - this.config.first_hour * 60 * 60 * 1000) * this.config.hour_size_px / (60 * 60 * 1000))) % (this.config.hour_size_px * 24)); //42px/hour\r\n};\r\nscheduler._calc_event_y = function(ev, min_height){\r\n\tmin_height = min_height || 0;\r\n\tvar sm = ev.start_date.getHours() * 60 + ev.start_date.getMinutes();\r\n\tvar em = (ev.end_date.getHours() * 60 + ev.end_date.getMinutes()) || (scheduler.config.last_hour * 60);\r\n\tvar top = this._y_from_date(ev.start_date);\r\n\r\n\tvar height = Math.max(min_height, (em - sm) * this.config.hour_size_px / 60); //42px/hour\r\n\treturn {\r\n\t\ttop: top,\r\n\t\theight: height\r\n\t};\r\n};\r\nscheduler.render_event = function(ev) {\r\n\tvar menu = scheduler.xy.menu_width;\r\n\tvar menu_offset = (this.config.use_select_menu_space) ? 0 : menu;\r\n\tif (ev._sday < 0) return; //can occur in case of recurring event during time shift\r\n\r\n\tvar parent = scheduler.locate_holder(ev._sday);\t\r\n\tif (!parent) return; //attempt to render non-visible event\r\n\r\n\tvar pos_y = this._calc_event_y(ev, scheduler.xy.min_event_height);\r\n\tvar top = pos_y.top,\r\n\t\theight = pos_y.height;\r\n\r\n\tvar ev_count = ev._count || 1;\r\n\tvar ev_sorder = ev._sorder || 0;\r\n\r\n\tvar width = Math.floor((parent.clientWidth - menu_offset) / ev_count);\r\n\tvar left = ev_sorder * width + 1;\r\n\tif (!ev._inner) width = width * (ev_count - ev_sorder);\r\n\tif (this.config.cascade_event_display) {\r\n\t\tvar limit = this.config.cascade_event_count;\r\n\t\tvar margin = this.config.cascade_event_margin;\r\n\t\tleft = ev_sorder % limit * margin;\r\n\t\tvar right = (ev._inner) ? (ev_count - ev_sorder - 1) % limit * margin / 2 : 0;\r\n\t\twidth = Math.floor(parent.clientWidth - menu_offset - left - right);\r\n\t}\r\n\r\n\tvar d = this._render_v_bar(ev, menu_offset + left, top, width, height, ev._text_style, scheduler.templates.event_header(ev.start_date, ev.end_date, ev), scheduler.templates.event_text(ev.start_date, ev.end_date, ev));\r\n\r\n\tthis._rendered.push(d);\r\n\tparent.appendChild(d);\r\n\r\n\tleft = left + parseInt(parent.style.left, 10) + menu_offset;\r\n\r\n\tif (this._edit_id == ev.id) {\r\n\r\n\t\td.style.zIndex = 1; //fix overlapping issue\r\n\t\twidth = Math.max(width - 4, scheduler.xy.editor_width);\r\n\t\td = document.createElement(\"DIV\");\r\n\t\td.setAttribute(\"event_id\", ev.id);\r\n\t\tthis.set_xy(d, width, height - 20, left, top + 14);\r\n\t\td.className = \"dhx_cal_event dhx_cal_editor\";\r\n\r\n\t\tvar tplClass = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\r\n\r\n\t\tif(tplClass){\r\n\t\t\td.className += \" \" + tplClass;\r\n\t\t}\r\n\t\tvar d2 = document.createElement(\"DIV\");\r\n\t\tthis.set_xy(d2, width - 6, height - 26);\r\n\t\td2.style.cssText += \";margin:2px 2px 2px 2px;overflow:hidden;\";\r\n\r\n\t\td.appendChild(d2);\r\n\t\tthis._els[\"dhx_cal_data\"][0].appendChild(d);\r\n\t\tthis._rendered.push(d);\r\n\r\n\t\td2.innerHTML = \"<textarea class='dhx_cal_editor'>\" + ev.text + \"</textarea>\";\r\n\t\tif (this._quirks7) d2.firstChild.style.height = height - 12 + \"px\"; //IEFIX\r\n\t\tthis._editor = d2.firstChild;\r\n\t\tthis._editor.onkeydown = function(e) {\r\n\t\t\tif ((e || event).shiftKey) return true;\r\n\t\t\tvar code = (e || event).keyCode;\r\n\t\t\tif (code == scheduler.keys.edit_save) scheduler.editStop(true);\r\n\t\t\tif (code == scheduler.keys.edit_cancel) scheduler.editStop(false);\r\n\t\t};\r\n\t\tthis._editor.onselectstart = function (e) {\r\n\t\t\t(e || event).cancelBubble = true;\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\tscheduler._focus(d2.firstChild, true);\r\n\t\t//IE and opera can add x-scroll during focusing\r\n\t\tthis._els[\"dhx_cal_data\"][0].scrollLeft = 0;\r\n\t}\r\n\tif (this.xy.menu_width !== 0 && this._select_id == ev.id) {\r\n\t\tif (this.config.cascade_event_display && this._drag_mode)\r\n\t\t\td.style.zIndex = 1; //fix overlapping issue for cascade view in case of dnd of selected event\r\n\t\tvar icons = this.config[\"icons_\" + ((this._edit_id == ev.id) ? \"edit\" : \"select\")];\r\n\t\tvar icons_str = \"\";\r\n\t\tvar bg_color = (ev.color ? (\"background-color: \" + ev.color + \";\") : \"\");\r\n\t\tvar color = (ev.textColor ? (\"color: \" + ev.textColor + \";\") : \"\");\r\n\t\tfor (var i = 0; i < icons.length; i++)\r\n\t\t\ticons_str += \"<div class='dhx_menu_icon \" + icons[i] + \"' style='\" + bg_color + \"\" + color + \"' title='\" + this.locale.labels[icons[i]] + \"'></div>\";\r\n\t\tvar obj = this._render_v_bar(ev, left - menu + 1, top, menu, icons.length * 20 + 26 - 2, \"\", \"<div style='\" + bg_color + \"\" + color + \"' class='dhx_menu_head'></div>\", icons_str, true);\r\n\t\tobj.style.left = left - menu + 1;\r\n\t\tthis._els[\"dhx_cal_data\"][0].appendChild(obj);\r\n\t\tthis._rendered.push(obj);\r\n\t}\r\n\tif(this.config.drag_highlight && this._drag_id == ev.id){\r\n\t\tthis.highlightEventPosition(ev);\r\n\t}\r\n};\r\nscheduler._render_v_bar = function (ev, x, y, w, h, style, contentA, contentB, bottom) {\r\n\tvar d = document.createElement(\"DIV\");\r\n\tvar id = ev.id;\r\n\tvar cs = (bottom) ? \"dhx_cal_event dhx_cal_select_menu\" : \"dhx_cal_event\";\r\n\r\n\tvar cse = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\r\n\tif (cse) cs = cs + \" \" + cse;\r\n\r\n\tvar bg_color = (ev.color ? (\"background:\" + ev.color + \";\") : \"\");\r\n\tvar color = (ev.textColor ? (\"color:\" + ev.textColor + \";\") : \"\");\r\n\r\n\tvar html = '<div event_id=\"' + id + '\" class=\"' + cs + '\" style=\"position:absolute; top:' + y + 'px; left:' + x + 'px; width:' + (w - 4) + 'px; height:' + h + 'px;' + (style || \"\") + '\"></div>';\r\n\td.innerHTML = html;\r\n\r\n\tvar container = d.cloneNode(true).firstChild;\r\n\r\n\tif (!bottom && scheduler.renderEvent(container, ev, w, h, contentA, contentB)) {\r\n\t\treturn container;\r\n\t} else {\r\n\t\tcontainer = d.firstChild;\r\n\r\n\t\tvar inner_html = '<div class=\"dhx_event_move dhx_header\" style=\" width:' + (w - 6) + 'px;' + bg_color + '\" >&nbsp;</div>';\r\n\t\tinner_html += '<div class=\"dhx_event_move dhx_title\" style=\"' + bg_color + '' + color + '\">' + contentA + '</div>';\r\n\t\tinner_html += '<div class=\"dhx_body\" style=\" width:' + (w - (this._quirks ? 4 : 14)) + 'px; height:' + (h - (this._quirks ? 20 : 30) + 1) + 'px;' + bg_color + '' + color + '\">' + contentB + '</div>'; // +2 css specific, moved from render_event\r\n\r\n\t\tvar footer_class = \"dhx_event_resize dhx_footer\";\r\n\t\tif (bottom)\r\n\t\t\tfooter_class = \"dhx_resize_denied \" + footer_class;\r\n\r\n\t\tinner_html += '<div class=\"' + footer_class + '\" style=\" width:' + (w - 8) + 'px;' + (bottom ? ' margin-top:-1px;' : '') + '' + bg_color + '' + color + '\" ></div>';\r\n\r\n\t\tcontainer.innerHTML = inner_html;\r\n\t}\r\n\r\n\treturn container;\r\n};\r\nscheduler.renderEvent = function(){\r\n\treturn false;\r\n};\r\nscheduler.locate_holder = function(day) {\r\n\tif (this._mode == \"day\") return this._els[\"dhx_cal_data\"][0].firstChild; //dirty\r\n\treturn this._els[\"dhx_cal_data\"][0].childNodes[day];\r\n};\r\nscheduler.locate_holder_day = function(date, past) {\r\n\tvar day = Math.floor((this._correct_shift(date, 1) - this._min_date) / (60 * 60 * 24 * 1000));\r\n\t//when locating end data of event , we need to use next day if time part was defined\r\n\tif (past && this.date.time_part(date)) day++;\r\n\treturn day;\r\n};\r\n\r\n\r\n\r\nscheduler._get_dnd_order = function(order, ev_height, max_height){\r\n\tif(!this._drag_event)\r\n\t\treturn order;\r\n\tif(!this._drag_event._orig_sorder)\r\n\t\tthis._drag_event._orig_sorder = order;\r\n\telse\r\n\t\torder = this._drag_event._orig_sorder;\r\n\r\n\tvar evTop = ev_height * order;\r\n\twhile((evTop + ev_height) > max_height){\r\n\t\torder--;\r\n\t\tevTop -= ev_height;\r\n\t}\r\n\torder = Math.max(order, 0);\r\n\treturn order;\r\n};\r\n//scheduler._get_event_bar_pos = function(sday, eday, week, drag){\r\nscheduler._get_event_bar_pos = function(ev){\r\n\tvar x = this._colsS[ev._sday];\r\n\tvar x2 = this._colsS[ev._eday];\r\n\tif (x2 == x) x2 = this._colsS[ev._eday + 1];\r\n\tvar hb = this.xy.bar_height;\r\n\r\n\tvar order = ev._sorder;\r\n\tif(ev.id == this._drag_id){\r\n\t\tvar cellHeight = this._colsS.heights[ev._sweek + 1] - this._colsS.heights[ev._sweek]- this.xy.month_head_height;//22 for month head height\r\n\t\torder = scheduler._get_dnd_order(order, hb, cellHeight);\r\n\t}\r\n\tvar y_event_offset =  order * hb;\r\n\tvar y = this._colsS.heights[ev._sweek] + (this._colsS.height ? (this.xy.month_scale_height + 2) : 2 ) + y_event_offset;\r\n\treturn {x:x, x2:x2, y:y};\r\n};\r\n\r\nscheduler.render_event_bar = function (ev) {\r\n\tvar parent = this._rendered_location;\r\n\tvar pos = this._get_event_bar_pos(ev);\r\n\r\n\tvar y = pos.y;\r\n\tvar x = pos.x;\r\n\tvar x2 = pos.x2;\r\n\t\r\n\t// resize for month mutliday events\r\n\tvar resize_handle = \"\";\r\n\r\n\t//events in ignored dates\r\n\r\n\tif (!x2) return;\r\n\r\n\tvar resizable = scheduler.config.resize_month_events && this._mode == \"month\" &&\r\n\t\t(!ev._timed || scheduler.config.resize_month_timed);\r\n\r\n\tvar d = document.createElement(\"DIV\");\r\n\tvar left_chunk = (ev.hasOwnProperty(\"_first_chunk\") && ev._first_chunk),\r\n\t\tright_chunk = (ev.hasOwnProperty(\"_last_chunk\") && ev._last_chunk);\r\n\r\n\tvar resize_left = resizable && (ev._timed || left_chunk);\r\n\tvar resize_right = resizable && (ev._timed || right_chunk);\r\n\r\n\tvar cs = \"dhx_cal_event_clear\";\r\n\tif (!ev._timed || resizable) {\r\n\t\tcs = \"dhx_cal_event_line\";\r\n\t}\r\n\tif(left_chunk){\r\n\t\tcs += \" dhx_cal_event_line_start\";\r\n\t}\r\n\tif(right_chunk){\r\n\t\tcs += \" dhx_cal_event_line_end\";\r\n\t}\r\n\tif(resize_left){\r\n\t\tresize_handle += \"<div class='dhx_event_resize dhx_event_resize_start'></div>\";\r\n\t}\r\n\tif(resize_right){\r\n\t\tresize_handle += \"<div class='dhx_event_resize dhx_event_resize_end'></div>\";\r\n\t}\r\n\r\n\tvar cse = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\r\n\tif (cse){\r\n\t\tcs += \" \" + cse;\r\n\t}\r\n\r\n\tvar bg_color = (ev.color ? (\"background:\" + ev.color + \";\") : \"\");\r\n\tvar color = (ev.textColor ? (\"color:\" + ev.textColor + \";\") : \"\");\r\n\r\n\tvar style_text = [\r\n\t\t\"position:absolute\",\r\n\t\t\"top:\" + y + \"px\",\r\n\t\t\"left:\" + x + \"px\",\r\n\t\t\"width:\" + (x2 - x - 15) + \"px\",\r\n\t\tcolor,\r\n\t\tbg_color,\r\n\t\t(ev._text_style || \"\")\r\n\t].join(\";\");\r\n\r\n\tvar html = '<div event_id=\"' + ev.id + '\" class=\"' + cs + '\" style=\"'+style_text+'\">';\r\n\tif (resizable) {\r\n\t\thtml += resize_handle;\r\n\t}\r\n\tif(scheduler.getState().mode == \"month\"){\r\n\t\tev = scheduler.getEvent(ev.id); // ev at this point could be a part (row in a month view) of a larger event\r\n\t}\r\n\r\n\tif (ev._timed)\r\n\t\thtml += scheduler.templates.event_bar_date(ev.start_date, ev.end_date, ev);\r\n\thtml += scheduler.templates.event_bar_text(ev.start_date, ev.end_date, ev) + '</div>';\r\n\thtml += '</div>';\r\n\r\n\td.innerHTML = html;\r\n\r\n\tthis._rendered.push(d.firstChild);\r\n\tparent.appendChild(d.firstChild);\r\n};\r\n\r\nscheduler._locate_event = function(node) {\r\n\tvar id = null;\r\n\twhile (node && !id && node.getAttribute) {\r\n\t\tid = node.getAttribute(\"event_id\");\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\treturn id;\r\n};\r\n\r\nscheduler.edit = function(id) {\r\n\tif (this._edit_id == id) return;\r\n\tthis.editStop(false, id);\r\n\tthis._edit_id = id;\r\n\tthis.updateEvent(id);\r\n};\r\nscheduler.editStop = function(mode, id) {\r\n\tif (id && this._edit_id == id) return;\r\n\tvar ev = this.getEvent(this._edit_id);\r\n\tif (ev) {\r\n\t\tif (mode) ev.text = this._editor.value;\r\n\t\tthis._edit_id = null;\r\n\t\tthis._editor = null;\r\n\t\tthis.updateEvent(ev.id);\r\n\t\tthis._edit_stop_event(ev, mode);\r\n\t}\r\n};\r\nscheduler._edit_stop_event = function(ev, mode) {\r\n\tif (this._new_event) {\r\n\t\tif (!mode) {\r\n\t\t\tif (ev) // in case of custom lightbox user can already delete event\r\n\t\t\t\tthis.deleteEvent(ev.id, true);\r\n\t\t} else {\r\n\t\t\tthis.callEvent(\"onEventAdded\", [ev.id, ev]);\r\n\t\t}\r\n\t\tthis._new_event = null;\r\n\t} else {\r\n\t\tif (mode){\r\n\t\t\tthis.callEvent(\"onEventChanged\", [ev.id, ev]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nscheduler.getEvents = function(from, to) {\r\n\tvar result = [];\r\n\tfor (var a in this._events) {\r\n\t\tvar ev = this._events[a];\r\n\t\tif (ev && ( (!from && !to) || (ev.start_date < to && ev.end_date > from) ))\r\n\t\t\tresult.push(ev);\r\n\t}\r\n\treturn result;\r\n};\r\nscheduler.getRenderedEvent = function(id) {\r\n\tif (!id)\r\n\t\treturn;\r\n\tvar rendered_events = scheduler._rendered;\r\n\tfor (var i=0; i<rendered_events.length; i++) {\r\n\t\tvar rendered_event = rendered_events[i];\r\n\t\tif (rendered_event.getAttribute(\"event_id\") == id) {\r\n\t\t\treturn rendered_event;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\nscheduler.showEvent = function(id, mode) {\r\n\tvar ev = (typeof id == \"number\" || typeof id == \"string\") ? scheduler.getEvent(id) : id;\r\n\tmode = mode||scheduler._mode;\r\n\r\n\tif (!ev || (this.checkEvent(\"onBeforeEventDisplay\") && !this.callEvent(\"onBeforeEventDisplay\", [ev, mode])))\r\n\t\treturn;\r\n\r\n\tvar scroll_hour = scheduler.config.scroll_hour;\r\n\tscheduler.config.scroll_hour = ev.start_date.getHours();\r\n\tvar preserve_scroll = scheduler.config.preserve_scroll;\r\n\tscheduler.config.preserve_scroll = false;\r\n\r\n\tvar original_color = ev.color;\r\n\tvar original_text_color = ev.textColor;\r\n\tif (scheduler.config.highlight_displayed_event) {\r\n\t\tev.color = scheduler.config.displayed_event_color;\r\n\t\tev.textColor = scheduler.config.displayed_event_text_color;\r\n\t}\r\n\r\n\tscheduler.setCurrentView(new Date(ev.start_date), mode);\r\n\r\n\tev.color = original_color;\r\n\tev.textColor = original_text_color;\r\n\tscheduler.config.scroll_hour = scroll_hour;\r\n\tscheduler.config.preserve_scroll = preserve_scroll;\r\n\r\n\tif (scheduler.matrix && scheduler.matrix[mode]) {\r\n\t\tscheduler._els.dhx_cal_data[0].scrollTop = getAbsoluteTop(scheduler.getRenderedEvent(ev.id)) - getAbsoluteTop(scheduler._els.dhx_cal_data[0]) - 20;\r\n\t}\r\n\r\n\tscheduler.callEvent(\"onAfterEventDisplay\", [ev, mode]);\r\n};\r\n\r\nscheduler._append_drag_marker = function(m){\r\n\tif(m.parentNode) return;\r\n\tvar zone = scheduler._els[\"dhx_cal_data\"][0];\r\n\r\n\tvar scale = zone.lastChild;\r\n\tif(scale.className && scale.className.indexOf(\"dhx_scale_holder\") < 0 && scale.previousSibling){\r\n\t\tscale = scale.previousSibling;\r\n\t}\r\n\tif (scale && scale.className.indexOf(\"dhx_scale_holder\") === 0) {\r\n\t\tscale.appendChild(m);\r\n\t}\r\n};\r\n\r\nscheduler._update_marker_position = function(m, event){\r\n\tvar size = scheduler._calc_event_y(event, 0);\r\n\tm.style.top = size.top + \"px\";\r\n\tm.style.height = size.height + \"px\";\r\n};\r\n\r\nscheduler.highlightEventPosition = function(event){\r\n\tvar m = document.createElement(\"div\");\r\n\r\n\tm.setAttribute(\"event_id\", event.id);\r\n\tthis._rendered.push(m);\r\n\tthis._update_marker_position(m, event);\r\n\r\n\tvar css = this.templates.drag_marker_class(event.start_date, event.end_date, event);\r\n\tvar html = this.templates.drag_marker_content(event.start_date, event.end_date, event);\r\n\tm.className = \"dhx_drag_marker\";\r\n\tif(css)\r\n\t\tm.className += \" \" + css;\r\n\tif(html)\r\n\t\tm.innerHTML = html;\r\n\tthis._append_drag_marker(m);\r\n};\r\nscheduler._loaded = {};\r\nscheduler._load = function(url, from) {\r\n\turl = url || this._load_url;\r\n\r\n\tif(!url){\r\n\t\t//if scheduler.setLoadMode is called before scheduler.init, initial rendering will invoke data loading while url is undefined\r\n\t\treturn;\r\n\t}\r\n\r\n\turl += (url.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"timeshift=\" + (new Date()).getTimezoneOffset();\r\n\tif (this.config.prevent_cache)    url += \"&uid=\" + this.uid();\r\n\tvar to;\r\n\tfrom = from || this._date;\r\n\r\n\tif (this._load_mode) {\r\n\t\tvar lf = this.templates.load_format;\r\n\r\n\t\tfrom = this.date[this._load_mode + \"_start\"](new Date(from.valueOf()));\r\n\t\twhile (from > this._min_date) from = this.date.add(from, -1, this._load_mode);\r\n\t\tto = from;\r\n\r\n\t\tvar cache_line = true;\r\n\t\twhile (to < this._max_date) {\r\n\t\t\tto = this.date.add(to, 1, this._load_mode);\r\n\t\t\tif (this._loaded[lf(from)] && cache_line)\r\n\t\t\t\tfrom = this.date.add(from, 1, this._load_mode); else cache_line = false;\r\n\t\t}\r\n\r\n\t\tvar temp_to = to;\r\n\t\tdo {\r\n\t\t\tto = temp_to;\r\n\t\t\ttemp_to = this.date.add(to, -1, this._load_mode);\r\n\t\t} while (temp_to > from && this._loaded[lf(temp_to)]);\r\n\r\n\t\tif (to <= from)\r\n\t\t\treturn false; //already loaded\r\n\t\tdhtmlxAjax.get(url + \"&from=\" + lf(from) + \"&to=\" + lf(to), function(l) {scheduler.on_load(l);});\r\n\t\twhile (from < to) {\r\n\t\t\tthis._loaded[lf(from)] = true;\r\n\t\t\tfrom = this.date.add(from, 1, this._load_mode);\r\n\t\t}\r\n\t} else\r\n\t\tdhtmlxAjax.get(url, function(l) {scheduler.on_load(l);});\r\n\tthis.callEvent(\"onXLS\", []);\r\n\treturn true;\r\n};\r\nscheduler.on_load = function(loader) {\r\n\tvar evs;\r\n\tvar error = false;\r\n\tif (this._process && this._process != \"xml\") {\r\n\t\ttry{\r\n\t\t\tevs = this[this._process].parse(loader.xmlDoc.responseText);\r\n\t\t}catch (e){\r\n\t\t\terror = true;\r\n\t\t}\r\n\t} else {\r\n\t\tevs = this._magic_parser(loader);\r\n\t\tif(!evs){\r\n\t\t\terror = true;\r\n\t\t}\r\n\t}\r\n\r\n\tif(error){\r\n\t\tthis.callEvent(\"onLoadError\", [loader.xmlDoc]);\r\n\t\tevs = [];\r\n\t}\r\n\t\r\n\tscheduler._process_loading(evs);\r\n\r\n\tthis.callEvent(\"onXLE\", []);\r\n};\r\nscheduler._process_loading = function(evs) {\r\n\tthis._loading = true;\r\n\tthis._not_render = true;\r\n\tfor (var i = 0; i < evs.length; i++) {\r\n\t\tif (!this.callEvent(\"onEventLoading\", [evs[i]])) continue;\r\n\t\tthis.addEvent(evs[i]);\r\n\t}\r\n\tthis._not_render = false;\r\n\tif (this._render_wait) this.render_view_data();\r\n\r\n\tthis._loading = false;\r\n\tif (this._after_call) this._after_call();\r\n\tthis._after_call = null;\r\n};\r\nscheduler._init_event = function(event) {\r\n\tevent.text = (event.text || event._tagvalue) || \"\";\r\n\tevent.start_date = scheduler._init_date(event.start_date);\r\n\tevent.end_date = scheduler._init_date(event.end_date);\r\n};\r\n\r\nscheduler._init_date = function(date){\r\n\tif(!date)\r\n\t\treturn null;\r\n\tif(typeof date == \"string\")\r\n\t\treturn scheduler.templates.xml_date(date);\r\n\telse return new Date(date);\r\n};\r\n\r\nscheduler.json = {};\r\nscheduler.json.parse = function(data) {\r\n\tif (typeof data == \"string\") {\r\n\t\tscheduler._temp = eval(\"(\" + data + \")\");\r\n\t\tdata = (scheduler._temp) ? scheduler._temp.data || scheduler._temp.d || scheduler._temp : [];\r\n\t}\r\n\r\n\tif (data.dhx_security)\r\n\t\tdhtmlx.security_key = data.dhx_security;\r\n\r\n\tvar collections = (scheduler._temp && scheduler._temp.collections) ? scheduler._temp.collections : {};\r\n\tvar collections_loaded = false;\r\n\tfor (var key in collections) {\r\n\t\tif (collections.hasOwnProperty(key)) {\r\n\t\t\tcollections_loaded = true;\r\n\t\t\tvar collection = collections[key];\r\n\t\t\tvar arr = scheduler.serverList[key];\r\n\t\t\tif (!arr) continue;\r\n\t\t\tarr.splice(0, arr.length); //clear old options\r\n\t\t\tfor (var j = 0; j < collection.length; j++) {\r\n\t\t\t\tvar option = collection[j];\r\n\t\t\t\tvar obj = { key: option.value, label: option.label }; // resulting option object\r\n\t\t\t\tfor (var option_key in option) {\r\n\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\r\n\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tarr.push(obj);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (collections_loaded)\r\n\t\tscheduler.callEvent(\"onOptionsLoad\", []);\r\n\r\n\tvar evs = [];\r\n\tfor (var i = 0; i < data.length; i++) {\r\n\t\tvar event = data[i];\r\n\t\tscheduler._init_event(event);\r\n\t\tevs.push(event);\r\n\t}\r\n\treturn evs;\r\n};\r\nscheduler.parse = function(data, type) {\r\n\tthis._process = type;\r\n\tthis.on_load({xmlDoc: {responseText: data}});\r\n};\r\nscheduler.load = function(url, call) {\r\n\tif (typeof call == \"string\") {\r\n\t\tthis._process = call;\r\n\t\tcall = arguments[2];\r\n\t}\r\n\r\n\tthis._load_url = url;\r\n\tthis._after_call = call;\r\n\tthis._load(url, this._date);\r\n};\r\n//possible values - day,week,month,year,all\r\nscheduler.setLoadMode = function(mode) {\r\n\tif (mode == \"all\") mode = \"\";\r\n\tthis._load_mode = mode;\r\n};\r\n\r\nscheduler.serverList = function(name, array) {\r\n\tif (array) {\r\n\t\tthis.serverList[name] = array.slice(0);\r\n\t\treturn this.serverList[name];\r\n\t}\r\n\tthis.serverList[name] = (this.serverList[name] || []);\r\n\treturn this.serverList[name];\r\n};\r\nscheduler._userdata = {};\r\nscheduler._magic_parser = function(loader) {\r\n\tvar xml;\r\n\tif (!loader.getXMLTopNode) { //from a string\r\n\t\tvar xml_string = loader.xmlDoc.responseText;\r\n\t\tloader = new dtmlXMLLoaderObject(function() {});\r\n\t\tloader.loadXMLString(xml_string);\r\n\t}\r\n\r\n\txml = loader.getXMLTopNode(\"data\");\r\n\tif (xml.tagName != \"data\") return null;//not an xml\r\n\tvar skey = xml.getAttribute(\"dhx_security\");\r\n\tif (skey)\r\n\t\tdhtmlx.security_key = skey;\r\n\r\n\tvar opts = loader.doXPath(\"//coll_options\");\r\n\tfor (var i = 0; i < opts.length; i++) {\r\n\t\tvar bind = opts[i].getAttribute(\"for\");\r\n\t\tvar arr = this.serverList[bind];\r\n\t\tif (!arr) continue;\r\n\t\tarr.splice(0, arr.length);\t//clear old options\r\n\t\tvar itms = loader.doXPath(\".//item\", opts[i]);\r\n\t\tfor (var j = 0; j < itms.length; j++) {\r\n\t\t\tvar itm = itms[j];\r\n\t\t\tvar attrs = itm.attributes;\r\n\t\t\tvar obj = { key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\r\n\t\t\tfor (var k = 0; k < attrs.length; k++) {\r\n\t\t\t\tvar attr = attrs[k];\r\n\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\r\n\t\t\t}\r\n\t\t\tarr.push(obj);\r\n\t\t}\r\n\t}\r\n\tif (opts.length)\r\n\t\tscheduler.callEvent(\"onOptionsLoad\", []);\r\n\r\n\tvar ud = loader.doXPath(\"//userdata\");\r\n\tfor (var i = 0; i < ud.length; i++) {\r\n\t\tvar udx = this._xmlNodeToJSON(ud[i]);\r\n\t\tthis._userdata[udx.name] = udx.text;\r\n\t}\r\n\r\n\tvar evs = [];\r\n\txml = loader.doXPath(\"//event\");\r\n\r\n\tfor (var i = 0; i < xml.length; i++) {\r\n\t\tvar ev = evs[i] = this._xmlNodeToJSON(xml[i]);\r\n\t\tscheduler._init_event(ev);\r\n\t}\r\n\treturn evs;\r\n};\r\nscheduler._xmlNodeToJSON = function(node) {\r\n\tvar t = {};\r\n\tfor (var i = 0; i < node.attributes.length; i++)\r\n\t\tt[node.attributes[i].name] = node.attributes[i].value;\r\n\r\n\tfor (var i = 0; i < node.childNodes.length; i++) {\r\n\t\tvar child = node.childNodes[i];\r\n\t\tif (child.nodeType == 1)\r\n\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\r\n\t}\r\n\r\n\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\r\n\r\n\treturn t;\r\n};\r\nscheduler.attachEvent(\"onXLS\", function() {\r\n\tif (this.config.show_loading === true) {\r\n\t\tvar t;\r\n\t\tt = this.config.show_loading = document.createElement(\"DIV\");\r\n\t\tt.className = 'dhx_loading';\r\n\t\tt.style.left = Math.round((this._x - 128) / 2) + \"px\";\r\n\t\tt.style.top = Math.round((this._y - 15) / 2) + \"px\";\r\n\t\tthis._obj.appendChild(t);\r\n\t}\r\n});\r\nscheduler.attachEvent(\"onXLE\", function() {\r\n\tvar t = this.config.show_loading;\r\n\tif (t && typeof t == \"object\") {\r\n\t\t\tthis._obj.removeChild(t);\r\n\t\t\tthis.config.show_loading = true;\r\n\t\t}\r\n});\r\n\r\nscheduler.ical={\r\n\tparse:function(str){\r\n\t\tvar data = str.match(RegExp(this.c_start+\"[^\\f]*\"+this.c_end,\"\"));\r\n\t\tif (!data.length) return;\r\n\t\t\r\n\t\t//unfolding \r\n\t\tdata[0]=data[0].replace(/[\\r\\n]+(?=[a-z \\t])/g,\" \");\r\n\t\t//drop property\r\n\t\tdata[0]=data[0].replace(/\\;[^:\\r\\n]*:/g,\":\");\r\n\t\t\r\n\t\t\r\n\t\tvar incoming=[];\r\n\t\tvar match;\r\n\t\tvar event_r = RegExp(\"(?:\"+this.e_start+\")([^\\f]*?)(?:\"+this.e_end+\")\",\"g\");\r\n\t\twhile ((match=event_r.exec(data)) !== null){\r\n\t\t\tvar e={};\r\n\t\t\tvar param;\r\n\t\t\tvar param_r = /[^\\r\\n]+[\\r\\n]+/g;\r\n\t\t\twhile ((param=param_r.exec(match[1])) !== null)\r\n\t\t\t\tthis.parse_param(param.toString(),e);\r\n\t\t\tif (e.uid && !e.id) e.id = e.uid; //fallback to UID, when ID is not defined\r\n\t\t\tincoming.push(e);\t\r\n\t\t}\r\n\t\treturn incoming;\r\n\t},\r\n\tparse_param:function(str,obj){\r\n\t\tvar d = str.indexOf(\":\"); \r\n\t\t\tif (d==-1) return;\r\n\t\t\r\n\t\tvar name = str.substr(0,d).toLowerCase();\r\n\t\tvar value = str.substr(d+1).replace(/\\\\\\,/g,\",\").replace(/[\\r\\n]+$/,\"\");\r\n\t\tif (name==\"summary\")\r\n\t\t\tname=\"text\";\r\n\t\telse if (name==\"dtstart\"){\r\n\t\t\tname = \"start_date\";\r\n\t\t\tvalue = this.parse_date(value,0,0);\r\n\t\t}\r\n\t\telse if (name==\"dtend\"){\r\n\t\t\tname = \"end_date\";\r\n\t\t\tvalue = this.parse_date(value,0,0);\r\n\t\t}\r\n\t\tobj[name]=value;\r\n\t},\r\n\tparse_date:function(value,dh,dm){\r\n\t\tvar t = value.split(\"T\");\t\r\n\t\tif (t[1]){\r\n\t\t\tdh=t[1].substr(0,2);\r\n\t\t\tdm=t[1].substr(2,2);\r\n\t\t}\r\n\t\tvar dy = t[0].substr(0,4);\r\n\t\tvar dn = parseInt(t[0].substr(4,2),10)-1;\r\n\t\tvar dd = t[0].substr(6,2);\r\n\t\tif (scheduler.config.server_utc && !t[1]) { // if no hours/minutes were specified == full day event\r\n\t\t\treturn new Date(Date.UTC(dy,dn,dd,dh,dm)) ;\r\n\t\t}\r\n\t\treturn new Date(dy,dn,dd,dh,dm);\r\n\t},\r\n\tc_start:\"BEGIN:VCALENDAR\",\r\n\te_start:\"BEGIN:VEVENT\",\r\n\te_end:\"END:VEVENT\",\r\n\tc_end:\"END:VCALENDAR\"\t\r\n};\r\nscheduler._lightbox_controls = {};\r\nscheduler.formSection = function(name){\r\n\tvar config = this.config.lightbox.sections;\r\n\tvar i =0;\r\n\tfor (i; i < config.length; i++)\r\n\t\tif (config[i].name == name)\r\n\t\t\tbreak;\r\n\tvar section = config[i];\r\n\tif (!scheduler._lightbox)\r\n\t\tscheduler.getLightbox();\r\n\tvar header = document.getElementById(section.id);\r\n\tvar node = header.nextSibling;\r\n\r\n\tvar result = {\r\n\t\tsection: section,\r\n\t\theader: header,\r\n\t\tnode: node,\r\n\t\tgetValue:function(ev){\r\n\t\t\treturn scheduler.form_blocks[section.type].get_value(node, (ev||{}), section);\r\n\t\t},\r\n\t\tsetValue:function(value, ev){\r\n\t\t\treturn scheduler.form_blocks[section.type].set_value(node, value, (ev||{}), section);\r\n\t\t}\r\n\t};\r\n\r\n\tvar handler = scheduler._lightbox_controls[\"get_\"+section.type+\"_control\"];\r\n\treturn handler?handler(result):result;\r\n};\r\nscheduler._lightbox_controls.get_template_control = function(result) {\r\n\tresult.control = result.node;\r\n\treturn result;\r\n};\r\nscheduler._lightbox_controls.get_select_control = function(result) {\r\n\tresult.control = result.node.getElementsByTagName('select')[0];\r\n\treturn result;\r\n};\r\nscheduler._lightbox_controls.get_textarea_control = function(result) {\r\n\tresult.control = result.node.getElementsByTagName('textarea')[0];\r\n\treturn result;\r\n};\r\nscheduler._lightbox_controls.get_time_control = function(result) {\r\n\tresult.control = result.node.getElementsByTagName('select'); // array\r\n\treturn result;\r\n};\r\nscheduler.form_blocks={\r\n\ttemplate:{\r\n\t\t\trender: function(sns){\r\n\t\t\tvar height=(sns.height||\"30\")+\"px\";\r\n\t\t\treturn \"<div class='dhx_cal_ltext dhx_cal_template' style='height:\"+height+\";'></div>\";\r\n\t\t},\r\n\t\tset_value:function(node,value,ev,config){\r\n\t\t\tnode.innerHTML = value||\"\";\r\n\t\t},\r\n\t\tget_value:function(node,ev,config){\r\n\t\t\treturn node.innerHTML||\"\";\r\n\t\t},\r\n\t\tfocus: function(node){\r\n\t\t}\r\n\t},\r\n\ttextarea:{\r\n\t\trender:function(sns){\r\n\t\t\tvar height=(sns.height||\"130\")+\"px\";\r\n\t\t\treturn \"<div class='dhx_cal_ltext' style='height:\"+height+\";'><textarea></textarea></div>\";\r\n\t\t},\r\n\t\tset_value:function(node,value,ev){\r\n\t\t\tnode.firstChild.value=value||\"\";\r\n\t\t},\r\n\t\tget_value:function(node,ev){\r\n\t\t\treturn node.firstChild.value;\r\n\t\t},\r\n\t\tfocus:function(node){\r\n\t\t\tvar a=node.firstChild; scheduler._focus(a, true);\r\n\t\t}\r\n\t},\r\n\tselect:{\r\n\t\trender:function(sns){\r\n\t\t\tvar height=(sns.height||\"23\")+\"px\";\r\n\t\t\tvar html=\"<div class='dhx_cal_ltext' style='height:\"+height+\";'><select style='width:100%;'>\";\r\n\t\t\tfor (var i=0; i < sns.options.length; i++)\r\n\t\t\t\thtml+=\"<option value='\"+sns.options[i].key+\"'>\"+sns.options[i].label+\"</option>\";\r\n\t\t\thtml+=\"</select></div>\";\r\n\t\t\treturn html;\r\n\t\t},\r\n\t\tset_value:function(node,value,ev,sns){\r\n\t\t\tvar select = node.firstChild;\r\n\t\t\tif (!select._dhx_onchange && sns.onchange) {\r\n\t\t\t\tselect.onchange = sns.onchange;\r\n\t\t\t\tselect._dhx_onchange = true;\r\n\t\t\t}\r\n\t\t\tif (typeof value == \"undefined\")\r\n\t\t\t\tvalue = (select.options[0]||{}).value;\r\n\t\t\tselect.value=value||\"\";\r\n\t\t},\r\n\t\tget_value:function(node,ev){\r\n\t\t\treturn node.firstChild.value;\r\n\t\t},\r\n\t\tfocus:function(node){\r\n\t\t\tvar a=node.firstChild; scheduler._focus(a, true); \r\n\t\t}\r\n\t},\r\n\ttime:{\r\n\t\trender:function(sns) {\r\n\t\t\tif (!sns.time_format) {\r\n\t\t\t\t// default order\r\n\t\t\t\tsns.time_format = [\"%H:%i\", \"%d\", \"%m\", \"%Y\"];\r\n\t\t\t}\r\n\t\t\t// map: default order => real one\r\n\t\t\tsns._time_format_order = {};\r\n\t\t\tvar time_format = sns.time_format;\r\n\r\n\t\t\tvar cfg = scheduler.config;\r\n\t\t\tvar dt = this.date.date_part(scheduler._currentDate());\r\n\t\t\tvar last = 24*60, first = 0;\r\n\t\t\tif(scheduler.config.limit_time_select){\r\n\t\t\t\tlast = 60*cfg.last_hour+1;\r\n\t\t\t\tfirst = 60*cfg.first_hour;\r\n\t\t\t\tdt.setHours(cfg.first_hour);\r\n\t\t\t}\r\n\t\t\tvar html = \"\";\r\n\r\n\t\t\tfor (var p = 0; p < time_format.length; p++) {\r\n\t\t\t\tvar time_option = time_format[p];\r\n\r\n\t\t\t\t// adding spaces between selects\r\n\t\t\t\tif (p > 0) {\r\n\t\t\t\t\thtml += \" \";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (time_option) {\r\n\t\t\t\t\tcase \"%Y\":\r\n\t\t\t\t\t\tsns._time_format_order[3] = p;\r\n\t\t\t\t\t\t//year\r\n\t\t\t\t\t\thtml+=\"<select>\";\r\n\t\t\t\t\t\tvar year = dt.getFullYear()-5; //maybe take from config?\r\n\t\t\t\t\t\tfor (var i=0; i < 10; i++)\r\n\t\t\t\t\t\t\thtml+=\"<option value='\"+(year+i)+\"'>\"+(year+i)+\"</option>\";\r\n\t\t\t\t\t\thtml+=\"</select> \";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"%m\":\r\n\t\t\t\t\t\tsns._time_format_order[2] = p;\r\n\t\t\t\t\t\t//month\r\n\t\t\t\t\t\thtml+=\"<select>\";\r\n\t\t\t\t\t\tfor (var i=0; i < 12; i++)\r\n\t\t\t\t\t\t\thtml+=\"<option value='\"+i+\"'>\"+this.locale.date.month_full[i]+\"</option>\";\r\n\t\t\t\t\t\thtml += \"</select>\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"%d\":\r\n\t\t\t\t\t\tsns._time_format_order[1] = p;\r\n\t\t\t\t\t\t//days\r\n\t\t\t\t\t\thtml+=\"<select>\";\r\n\t\t\t\t\t\tfor (var i=1; i < 32; i++)\r\n\t\t\t\t\t\t\thtml+=\"<option value='\"+i+\"'>\"+i+\"</option>\";\r\n\t\t\t\t\t\thtml += \"</select>\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"%H:%i\":\r\n\t\t\t\t\t\tsns._time_format_order[0] = p;\r\n\t\t\t\t\t\t//hours\r\n\t\t\t\t\t\thtml += \"<select>\";\r\n\t\t\t\t\t\tvar i = first;\r\n\t\t\t\t\t\tvar tdate = dt.getDate();\r\n\t\t\t\t\t\tsns._time_values = [];\r\n\r\n\t\t\t\t\t\twhile(i<last){\r\n\t\t\t\t\t\t\tvar time=this.templates.time_picker(dt);\r\n\t\t\t\t\t\t\thtml+=\"<option value='\"+i+\"'>\"+time+\"</option>\";\r\n\t\t\t\t\t\t\tsns._time_values.push(i);\r\n\t\t\t\t\t\t\tdt.setTime(dt.valueOf()+this.config.time_step*60*1000);\r\n\t\t\t\t\t\t\tvar diff = (dt.getDate()!=tdate)?1:0; // moved or not to the next day\r\n\t\t\t\t\t\t\ti=diff*24*60+dt.getHours()*60+dt.getMinutes();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += \"</select>\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn \"<div style='height:30px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>\"+html+\"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>\"+html+\"</div>\";\r\n\t\t},\r\n\t\tset_value:function(node,value,ev,config){\r\n\t\t\tvar cfg = scheduler.config;\r\n\t\t\tvar s=node.getElementsByTagName(\"select\");\r\n\t\t\tvar map = config._time_format_order;\r\n\t\t\tvar start_date, end_date;\r\n\r\n\t\t\tif(cfg.full_day) {\r\n\t\t\t\tif (!node._full_day){\r\n\t\t\t\t\tvar html = \"<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> \"+scheduler.locale.labels.full_day+\"&nbsp;</label></input>\";\r\n\t\t\t\t\tif (!scheduler.config.wide_form)\r\n\t\t\t\t\t\thtml = node.previousSibling.innerHTML+html;\r\n\t\t\t\t\tnode.previousSibling.innerHTML=html;\r\n\t\t\t\t\tnode._full_day=true;\r\n\t\t\t\t}\r\n\t\t\t\tvar input=node.previousSibling.getElementsByTagName(\"input\")[0];\r\n\t\t\t\tinput.checked = (scheduler.date.time_part(ev.start_date)===0 && scheduler.date.time_part(ev.end_date)===0);\r\n\r\n\t\t\t\ts[map[0]].disabled=input.checked;\r\n\t\t\t\ts[ map[0] + s.length/2 ].disabled=input.checked;\r\n\r\n\t\t\t\tinput.onclick = function(){ \r\n\t\t\t\t\tif(input.checked) {\r\n\t\t\t\t\t\tvar obj = {};\r\n\t\t\t\t\t\tscheduler.form_blocks.time.get_value(node,obj,config);\r\n\r\n\t\t\t\t\t\tstart_date = scheduler.date.date_part(obj.start_date);\r\n\t\t\t\t\t\tend_date = scheduler.date.date_part(obj.end_date);\r\n\r\n\t\t\t\t\t\tif (+end_date == +start_date || (+end_date >= +start_date && (ev.end_date.getHours() !== 0 || ev.end_date.getMinutes() !== 0)))\r\n\t\t\t\t\t\t\tend_date = scheduler.date.add(end_date, 1, \"day\");\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tstart_date = null;\r\n\t\t\t\t\t\tend_date = null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ts[map[0]].disabled=input.checked;\r\n\t\t\t\t\ts[ map[0] + s.length/2 ].disabled=input.checked;\r\n\t\t\t\t\t\r\n\t\t\t\t\t_fill_lightbox_select(s,0,start_date||ev.start_date);\r\n\t\t\t\t\t_fill_lightbox_select(s,4,end_date||ev.end_date);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(cfg.auto_end_date && cfg.event_duration) {\r\n\t\t\t\tvar _update_lightbox_select = function () {\r\n\t\t\t\t\tstart_date = new Date(s[map[3]].value,s[map[2]].value,s[map[1]].value,0,s[map[0]].value);\r\n\t\t\t\t\tend_date = new Date(start_date.getTime() + (scheduler.config.event_duration * 60 * 1000));\r\n\t\t\t\t\t_fill_lightbox_select(s, 4, end_date);\r\n\t\t\t\t};\r\n\t\t\t\tfor(var i=0; i<4; i++) {\r\n\t\t\t\t\ts[i].onchange = _update_lightbox_select;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction _fill_lightbox_select(s,i,d) {\r\n\t\t\t\tvar time_values = config._time_values;\r\n\t\t\t\tvar direct_value = d.getHours()*60+d.getMinutes();\r\n\t\t\t\tvar fixed_value = direct_value;\r\n\t\t\t\tvar value_found = false;\r\n\t\t\t\tfor (var k=0; k<time_values.length; k++) {\r\n\t\t\t\t\tvar t_v = time_values[k];\r\n\t\t\t\t\tif (t_v === direct_value) {\r\n\t\t\t\t\t\tvalue_found = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t_v < direct_value)\r\n\t\t\t\t\t\tfixed_value = t_v;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ts[i+map[0]].value=(value_found)?direct_value:fixed_value;\r\n\t\t\t\tif(!(value_found || fixed_value)){\r\n\t\t\t\t\ts[i+map[0]].selectedIndex = -1;//show empty select in FF\r\n\t\t\t\t}\r\n\t\t\t\ts[i+map[1]].value=d.getDate();\r\n\t\t\t\ts[i+map[2]].value=d.getMonth();\r\n\t\t\t\ts[i+map[3]].value=d.getFullYear();\r\n\t\t\t}\r\n\r\n\t\t\t_fill_lightbox_select(s,0,ev.start_date);\r\n\t\t\t_fill_lightbox_select(s,4,ev.end_date);\r\n\t\t},\r\n\t\tget_value:function(node, ev, config) {\r\n\t\t\tvar s = node.getElementsByTagName(\"select\");\r\n\t\t\tvar map = config._time_format_order;\r\n\r\n\t\t\tev.start_date=new Date(s[map[3]].value,s[map[2]].value,s[map[1]].value,0,s[map[0]].value);\r\n\t\t\tev.end_date=new Date(s[map[3]+4].value,s[map[2]+4].value,s[map[1]+4].value,0,s[map[0]+4].value);\r\n\r\n\t\t\tif(!(s[map[3]].value && s[map[3]+4].value)){\r\n\t\t\t\t// use the previous date if start/end years are empty (outside lightbox range)\r\n\t\t\t\tvar original = this.getEvent(this._lightbox_id);\r\n\t\t\t\tif(original){\r\n\t\t\t\t\tev.start_date = original.start_date;\r\n\t\t\t\t\tev.end_date = original.end_date;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (ev.end_date<=ev.start_date) \r\n\t\t\t\tev.end_date=scheduler.date.add(ev.start_date,scheduler.config.time_step,\"minute\");\r\n\t\t\treturn {\r\n\t\t\t\tstart_date: new Date(ev.start_date),\r\n\t\t\t\tend_date: new Date(ev.end_date)\r\n\t\t\t};\r\n\t\t},\r\n\t\tfocus:function(node){\r\n\t\t\tscheduler._focus(node.getElementsByTagName(\"select\")[0]); \r\n\t\t}\r\n\t}\r\n};\r\nscheduler.showCover=function(box){\r\n\tif (box){\r\n\t\tbox.style.display=\"block\";\r\n\r\n\t\tvar scroll_top = window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;\r\n\t\tvar scroll_left = window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;\r\n\r\n\t\tvar view_height = window.innerHeight||document.documentElement.clientHeight;\r\n\r\n\t\tif(scroll_top) // if vertical scroll on window\r\n\t\t\tbox.style.top=Math.round(scroll_top+Math.max((view_height-box.offsetHeight)/2, 0))+\"px\";\r\n\t\telse // vertical scroll on body\r\n\t\t\tbox.style.top=Math.round(Math.max(((view_height-box.offsetHeight)/2), 0) + 9)+\"px\"; // +9 for compatibility with auto tests\r\n\r\n\t\t// not quite accurate but used for compatibility reasons\r\n\t\tif(document.documentElement.scrollWidth > document.body.offsetWidth) // if horizontal scroll on the window\r\n\t\t\tbox.style.left=Math.round(scroll_left+(document.body.offsetWidth-box.offsetWidth)/2)+\"px\";\r\n\t\telse // horizontal scroll on the body\r\n\t\t\tbox.style.left=Math.round((document.body.offsetWidth-box.offsetWidth)/2)+\"px\";\r\n\t}\r\n    this.show_cover();\r\n};\r\nscheduler.showLightbox=function(id){\r\n\tif (!id) return;\r\n\tif (!this.callEvent(\"onBeforeLightbox\",[id])) {\r\n\t\tif (this._new_event)\r\n\t\t\tthis._new_event = null;\r\n\t\treturn;\r\n\t}\r\n\tvar box = this.getLightbox();\r\n\tthis.showCover(box);\r\n\tthis._fill_lightbox(id,box);\r\n\tthis.callEvent(\"onLightbox\",[id]);\r\n};\r\nscheduler._fill_lightbox = function(id, box) {\r\n\tvar ev = this.getEvent(id);\r\n\tvar s = box.getElementsByTagName(\"span\");\r\n\tif (scheduler.templates.lightbox_header) {\r\n\t\ts[1].innerHTML = \"\";\r\n\t\ts[2].innerHTML = scheduler.templates.lightbox_header(ev.start_date, ev.end_date, ev);\r\n\t} else {\r\n\t\ts[1].innerHTML = this.templates.event_header(ev.start_date, ev.end_date, ev);\r\n\t\ts[2].innerHTML = (this.templates.event_bar_text(ev.start_date, ev.end_date, ev) || \"\").substr(0, 70); //IE6 fix\r\n\t}\r\n\r\n\tvar sns = this.config.lightbox.sections;\r\n\tfor (var i = 0; i < sns.length; i++) {\r\n\t\tvar current_sns = sns[i];\r\n\t\tvar node = document.getElementById(current_sns.id).nextSibling;\r\n\t\tvar block = this.form_blocks[current_sns.type];\r\n\t\tvar value = (ev[current_sns.map_to] !== undefined) ? ev[current_sns.map_to] : current_sns.default_value;\r\n\t\tblock.set_value.call(this, node, value, ev, current_sns);\r\n\t\tif (sns[i].focus)\r\n\t\t\tblock.focus.call(this, node);\r\n\t}\r\n\r\n\tscheduler._lightbox_id = id;\r\n};\r\nscheduler._lightbox_out=function(ev){\r\n\tvar sns = this.config.lightbox.sections;\r\n\tfor (var i=0; i < sns.length; i++) {\r\n\t\tvar node = document.getElementById(sns[i].id);\r\n\t\tnode=(node?node.nextSibling:node);\r\n\t\tvar block=this.form_blocks[sns[i].type];\r\n\t\tvar res=block.get_value.call(this,node,ev, sns[i]);\r\n\t\tif (sns[i].map_to!=\"auto\")\r\n\t\t\tev[sns[i].map_to]=res;\r\n\t}\r\n\treturn ev;\r\n};\r\nscheduler._empty_lightbox=function(data){\r\n\tvar id=scheduler._lightbox_id;\r\n\tvar ev=this.getEvent(id);\r\n\tvar box=this.getLightbox();\r\n\r\n\tthis._lame_copy(ev, data);\r\n\r\n\tthis.setEvent(ev.id,ev);\r\n\tthis._edit_stop_event(ev,true);\r\n\tthis.render_view_data();\r\n};\r\nscheduler.hide_lightbox=function(id){\r\n\tthis.hideCover(this.getLightbox());\r\n\tthis._lightbox_id = null;\r\n\tthis.callEvent(\"onAfterLightbox\",[]);\r\n};\r\nscheduler.hideCover=function(box){\r\n\tif (box) box.style.display=\"none\";\r\n\tthis.hide_cover();\r\n};\r\nscheduler.hide_cover=function(){\r\n\tif (this._cover) \r\n\t\tthis._cover.parentNode.removeChild(this._cover);\r\n\tthis._cover=null;\r\n};\r\nscheduler.show_cover=function(){\r\n\tif(this._cover)\r\n\t\treturn;\r\n\r\n\tthis._cover=document.createElement(\"DIV\");\r\n\tthis._cover.className=\"dhx_cal_cover\";\r\n\tvar _document_height = ((document.height !== undefined) ? document.height : document.body.offsetHeight);\r\n\tvar _scroll_height = ((document.documentElement) ? document.documentElement.scrollHeight : 0);\r\n\tthis._cover.style.height = Math.max(_document_height, _scroll_height) + 'px';\r\n\tdocument.body.appendChild(this._cover);\r\n};\r\nscheduler.save_lightbox=function(){\r\n\tvar data = this._lightbox_out({}, this._lame_copy(this.getEvent(this._lightbox_id)));\r\n\tif (this.checkEvent(\"onEventSave\") && !this.callEvent(\"onEventSave\",[this._lightbox_id, data, this._new_event]))\r\n\t\treturn;\r\n\tthis._empty_lightbox(data);\r\n\tthis.hide_lightbox();\r\n};\r\nscheduler.startLightbox = function(id, box){\r\n\tthis._lightbox_id = id;\r\n\tthis._custom_lightbox = true;\r\n\r\n\tthis._temp_lightbox = this._lightbox;\r\n\tthis._lightbox = box;\r\n\tthis.showCover(box);\r\n};\r\nscheduler.endLightbox = function(mode, box){\r\n\tthis._edit_stop_event(scheduler.getEvent(this._lightbox_id),mode);\r\n\tif (mode)\r\n\t\tscheduler.render_view_data();\r\n\tthis.hideCover(box);\r\n\r\n\tif (this._custom_lightbox){\r\n\t\tthis._lightbox = this._temp_lightbox;\r\n\t\tthis._custom_lightbox = false;\r\n\t}\r\n\tthis._temp_lightbox = this._lightbox_id = null; // in case of custom lightbox user only calls endLightbox so we need to reset _lightbox_id\r\n};\r\nscheduler.resetLightbox = function(){\r\n\tif (scheduler._lightbox && !scheduler._custom_lightbox)\r\n\t\tscheduler._lightbox.parentNode.removeChild(scheduler._lightbox);\r\n\tscheduler._lightbox = null;\r\n};\r\nscheduler.cancel_lightbox=function(){\r\n\tthis.callEvent(\"onEventCancel\",[this._lightbox_id, this._new_event]);\r\n\tthis.endLightbox(false);\r\n\tthis.hide_lightbox();\r\n};\r\nscheduler._init_lightbox_events=function(){\r\n\tthis.getLightbox().onclick=function(e){\r\n\t\tvar src=e?e.target:event.srcElement;\r\n\t\tif (!src.className) src=src.previousSibling;\r\n\t\tif (src && src.className)\r\n\t\t\tswitch(src.className){\r\n\t\t\t\tcase \"dhx_save_btn\":\r\n\t\t\t\t\tscheduler.save_lightbox();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"dhx_delete_btn\":\r\n\t\t\t\t\tvar c=scheduler.locale.labels.confirm_deleting;\r\n\r\n\t\t\t\t\tscheduler._dhtmlx_confirm(c, scheduler.locale.labels.title_confirm_deleting, function(){\r\n\t\t\t\t\t\tscheduler.deleteEvent(scheduler._lightbox_id);\r\n\t\t\t\t\t\tscheduler._new_event = null; //clear flag, if it was unsaved event\r\n\t\t\t\t\t\tscheduler.hide_lightbox();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"dhx_cancel_btn\":\r\n\t\t\t\t\tscheduler.cancel_lightbox();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif (src.getAttribute(\"dhx_button\")) {\r\n\t\t\t\t\t\tscheduler.callEvent(\"onLightboxButton\", [src.className, src, e]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar index, block, sec;\r\n\t\t\t\t\t\tif (src.className.indexOf(\"dhx_custom_button\") != -1) {\r\n\t\t\t\t\t\t\tif (src.className.indexOf(\"dhx_custom_button_\") != -1) {\r\n\t\t\t\t\t\t\t\tindex = src.parentNode.getAttribute(\"index\");\r\n\t\t\t\t\t\t\t\tsec = src.parentNode.parentNode;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tindex = src.getAttribute(\"index\");\r\n\t\t\t\t\t\t\t\tsec = src.parentNode;\r\n\t\t\t\t\t\t\t\tsrc = src.firstChild;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (index) {\r\n\t\t\t\t\t\t\tblock = scheduler.form_blocks[scheduler.config.lightbox.sections[index].type];\r\n\t\t\t\t\t\t\tblock.button_click(index, src, sec, sec.nextSibling);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t};\r\n\tthis.getLightbox().onkeydown=function(e){\r\n\t\tswitch((e||event).keyCode){\r\n\t\t\tcase scheduler.keys.edit_save:\r\n\t\t\t\tif ((e||event).shiftKey) return;\r\n\t\t\t\tscheduler.save_lightbox();\r\n\t\t\t\tbreak;\r\n\t\t\tcase scheduler.keys.edit_cancel:\r\n\t\t\t\tscheduler.cancel_lightbox();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n};\r\nscheduler.setLightboxSize=function(){\r\n\tvar d = this._lightbox;\r\n\tif (!d) return;\r\n\r\n\tvar con = d.childNodes[1];\r\n\tcon.style.height=\"0px\";\r\n\tcon.style.height=con.scrollHeight+\"px\";\r\n\td.style.height=con.scrollHeight+scheduler.xy.lightbox_additional_height+\"px\";\r\n\tcon.style.height=con.scrollHeight+\"px\"; //it is incredible , how ugly IE can be\r\n};\r\n\r\nscheduler._init_dnd_events = function(){\r\n\tdhtmlxEvent(document.body, \"mousemove\", scheduler._move_while_dnd);\r\n\tdhtmlxEvent(document.body, \"mouseup\", scheduler._finish_dnd);\r\n\tscheduler._init_dnd_events = function(){};\r\n};\r\nscheduler._move_while_dnd = function(e){\r\n\tif (scheduler._dnd_start_lb){\r\n\t\tif (!document.dhx_unselectable){\r\n\t\t\tdocument.body.className += \" dhx_unselectable\";\r\n\t\t\tdocument.dhx_unselectable = true;\r\n\t\t}\r\n\t\tvar lb = scheduler.getLightbox();\r\n\t\tvar now = (e&&e.target)?[e.pageX, e.pageY]:[event.clientX, event.clientY];\r\n\t\tlb.style.top = scheduler._lb_start[1]+now[1]-scheduler._dnd_start_lb[1]+\"px\";\r\n\t\tlb.style.left = scheduler._lb_start[0]+now[0]-scheduler._dnd_start_lb[0]+\"px\";\r\n\t}\r\n};\r\nscheduler._ready_to_dnd = function(e){\r\n\tvar lb = scheduler.getLightbox();\r\n\tscheduler._lb_start = [parseInt(lb.style.left,10), parseInt(lb.style.top,10)];\r\n\tscheduler._dnd_start_lb = (e&&e.target)?[e.pageX, e.pageY]:[event.clientX, event.clientY];\r\n};\r\nscheduler._finish_dnd = function(){\r\n\tif (scheduler._lb_start){\r\n\t\tscheduler._lb_start = scheduler._dnd_start_lb = false;\r\n\t\tdocument.body.className = document.body.className.replace(\" dhx_unselectable\",\"\");\r\n\t\tdocument.dhx_unselectable = false;\r\n\t}\r\n};\r\nscheduler.getLightbox=function(){ //scheduler.config.wide_form=true;\r\n\tif (!this._lightbox){\r\n\t\tvar d=document.createElement(\"DIV\");\r\n\t\td.className=\"dhx_cal_light\";\r\n\t\tif (scheduler.config.wide_form)\r\n\t\t\td.className+=\" dhx_cal_light_wide\";\r\n\t\tif (scheduler.form_blocks.recurring)\r\n\t\t\td.className+=\" dhx_cal_light_rec\";\r\n\t\t\t\r\n\t\tif (/msie|MSIE 6/.test(navigator.userAgent))\r\n\t\t\td.className+=\" dhx_ie6\";\r\n\t\td.style.visibility=\"hidden\";\r\n\t\tvar html = this._lightbox_template;\r\n\r\n\t\tvar buttons = this.config.buttons_left;\r\n\t\tfor (var i = 0; i < buttons.length; i++)\r\n\t\t\thtml+=\"<div class='dhx_btn_set dhx_left_btn_set \"+buttons[i]+\"_set'><div dhx_button='1' class='\"+buttons[i]+\"'></div><div>\"+scheduler.locale.labels[buttons[i]]+\"</div></div>\";\r\n\r\n\t\tbuttons = this.config.buttons_right;\r\n\t\tfor (var i = 0; i < buttons.length; i++)\r\n\t\t\thtml+=\"<div class='dhx_btn_set dhx_right_btn_set \"+buttons[i]+\"_set' style='float:right;'><div dhx_button='1' class='\"+buttons[i]+\"'></div><div>\"+scheduler.locale.labels[buttons[i]]+\"</div></div>\";\r\n\r\n\t\thtml+=\"</div>\";\r\n\t\td.innerHTML=html;\r\n\t\tif (scheduler.config.drag_lightbox){\r\n\t\t\td.firstChild.onmousedown = scheduler._ready_to_dnd;\r\n\t\t\td.firstChild.onselectstart = function(){ return false; };\r\n\t\t\td.firstChild.style.cursor = \"pointer\";\r\n\t\t\tscheduler._init_dnd_events();\r\n\r\n\t\t}\r\n\t\tdocument.body.insertBefore(d,document.body.firstChild);\r\n\t\tthis._lightbox=d;\r\n\t\t\r\n\t\tvar sns=this.config.lightbox.sections;\r\n\t\thtml=\"\";\r\n\t\tfor (var i=0; i < sns.length; i++) {\r\n\t\t\tvar block=this.form_blocks[sns[i].type];\r\n\t\t\tif (!block) continue; //ignore incorrect blocks\r\n\t\t\tsns[i].id=\"area_\"+this.uid();\r\n\t\t\tvar button = \"\";\r\n\t\t\tif (sns[i].button){\r\n\t\t\t \tbutton = \"<div class='dhx_custom_button' index='\"+i+\"'><div class='dhx_custom_button_\"+sns[i].button+\"'></div><div>\"+this.locale.labels[\"button_\"+sns[i].button]+\"</div></div>\";\r\n\t\t\t }\r\n\t\t\t\r\n\t\t\tif (this.config.wide_form){\r\n\t\t\t\thtml+=\"<div class='dhx_wrap_section'>\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar label_name = this.locale.labels[\"section_\"+sns[i].name];\r\n\t\t\tif(typeof label_name !== \"string\"){\r\n\t\t\t\tlabel_name = sns[i].name;\r\n\t\t\t}\r\n\t\t\thtml+=\"<div id='\"+sns[i].id+\"' class='dhx_cal_lsection'>\"+button+label_name+\"</div>\"+block.render.call(this,sns[i]);\r\n\t\t\thtml+=\"</div>\";\r\n\t\t}\r\n\r\n\t\tvar ds=d.getElementsByTagName(\"div\");\r\n\t\tfor (var i=0; i<ds.length; i++) {\r\n\t\t\tvar t_ds = ds[i];\r\n\t\t\tif (t_ds.className == \"dhx_cal_larea\") {\r\n\t\t\t\tt_ds.innerHTML = html;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//sizes\r\n\t\tthis.setLightboxSize();\r\n\r\n\t\tthis._init_lightbox_events(this);\r\n\t\td.style.display=\"none\";\r\n\t\td.style.visibility=\"visible\";\r\n\t}\r\n\treturn this._lightbox;\r\n};\r\n\r\nscheduler.attachEvent(\"onEventIdChange\", function(old_id, new_id){\r\n\tif(this._lightbox_id == old_id)\r\n\t\tthis._lightbox_id = new_id;\r\n});\r\n\r\nscheduler._lightbox_template=\"<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span></div><div class='dhx_cal_larea'></div>\";\r\n\r\nscheduler._init_touch_events = function(){\r\n\tif (this.config.touch != \"force\")\r\n\t\tthis.config.touch = this.config.touch  &&\r\n\t\t\t    ( (navigator.userAgent.indexOf(\"Mobile\")!=-1)   ||\r\n\t\t\t\t(navigator.userAgent.indexOf(\"iPad\")!=-1)       ||\r\n\t\t\t\t(navigator.userAgent.indexOf(\"Android\")!=-1)    ||\r\n\t\t\t\t(navigator.userAgent.indexOf(\"Touch\")!=-1));\r\n\r\n\tif (this.config.touch){\r\n\t\tthis.xy.scroll_width = 0;\r\n\t\tif (window.navigator.msPointerEnabled){\r\n\t\t\tthis._touch_events([\"MSPointerMove\", \"MSPointerDown\", \"MSPointerUp\"], function(ev){\r\n\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE ) return null;\r\n\t\t\t\treturn ev;\r\n\t\t\t}, function(ev){\r\n\t\t\t\treturn (!ev || ev.pointerType == ev.MSPOINTER_TYPE_MOUSE);\r\n\t\t\t});\r\n\t\t\tthis._obj.ondblclick = function(){};\r\n\t\t} else\r\n\t\t\tthis._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function(ev){\r\n\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\r\n\t\t\t\tif (ev.touches[0])\r\n\t\t\t\t\treturn { target:ev.target, pageX:ev.touches[0].pageX, pageY:ev.touches[0].pageY };\r\n\t\t\t\telse \r\n\t\t\t\t\treturn ev;\r\n\t\t\t}, function(){ return false; });\r\n\t}\r\n};\r\n\r\nscheduler._touch_events = function(names, accessor, ignore){\r\n\t//webkit on android need to be handled separately\r\n\tvar a_webkit = (navigator.userAgent.indexOf(\"Android\")!=-1) && (navigator.userAgent.indexOf(\"WebKit\")!=-1);\r\n\tvar source, tracker, timer, drag_mode, scroll_mode, action_mode;\r\n\tvar dblclicktime = 0;\r\n\r\n\tfunction attachTouchEvent(element, name, callback){\r\n\t\t//touch gestures must be disabled when ligthbox is opened\r\n\t\tdhtmlxEvent(element, name, function(e){\r\n\t\t\tif(scheduler._is_lightbox_open()){\r\n\t\t\t\treturn true;\r\n\t\t\t}else{\r\n\t\t\t\treturn callback(e);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction check_direction_swipe(s_ev, e_ev, step, max_dy){\r\n\t\tif (!s_ev || !e_ev) return;\r\n\r\n\t\tvar t = s_ev.target;\r\n\t\twhile(t && t != scheduler._obj){\r\n\t\t\tt = t.parentNode;\r\n\t\t}\r\n\t\tif(t != scheduler._obj){\r\n\t\t\t//swipe outside scheduler\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar dy = Math.abs(s_ev.pageY - e_ev.pageY);\r\n\t\tvar dx = Math.abs(s_ev.pageX - e_ev.pageX);\r\n\t\tif (dy < max_dy && dx>step && (!dy || (dx/dy > 3))){\r\n\t\t\tif (s_ev.pageX > e_ev.pageX)\r\n\t\t\t\tscheduler._click.dhx_cal_next_button();\r\n\t\t\telse\r\n\t\t\t\tscheduler._click.dhx_cal_prev_button();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction doMouseMove(e){\r\n\t\tvar dnd = scheduler.getState().drag_mode,\r\n\t\t\ttimeline = scheduler.matrix ? scheduler.matrix[scheduler._mode] : false;\r\n\r\n\t\tvar original_render = scheduler.render_view_data;\r\n\t\tif(dnd == 'create' && timeline){\r\n\t\t\t//suppress full redraw of timeline on creating event\r\n\t\t\tscheduler.render_view_data = function() {\r\n\t\t\t\tvar id = scheduler.getState().drag_id;\r\n\t\t\t\tvar ev = scheduler.getEvent(id);\r\n\t\t\t\tvar property = timeline.y_property;\r\n\r\n\t\t\t\tvar evs = scheduler.getEvents(ev.start_date, ev.end_date);\r\n\t\t\t\tfor(var i = 0; i < evs.length; i++){\r\n\t\t\t\t\tif(evs[i][property] != ev[property]){\r\n\t\t\t\t\t\tevs.splice(i, 1);\r\n\t\t\t\t\t\ti--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tev._sorder = evs.length - 1;\r\n\t\t\t\tev._count = evs.length;\r\n\r\n\t\t\t\tthis.render_data([ev], scheduler.getState().mode);\r\n\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tscheduler._on_mouse_move(e);\r\n\r\n\t\tif(dnd == 'create' && timeline){\r\n\t\t\tscheduler.render_view_data = original_render;\r\n\t\t}\r\n\t}\r\n\tattachTouchEvent(document.body, names[0], function(e){\r\n\t\tif (ignore(e)) return;\r\n\r\n\t\tif (drag_mode){\r\n\t\t\tdoMouseMove(accessor(e));\r\n\t\t\tscheduler._update_global_tip();\r\n\t\t\tif (e.preventDefault)\r\n\t\t\t\te.preventDefault();\r\n\t\t\te.cancelBubble = true;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t//if (tracker && a_webkit){\r\n\t\t//\tcheck_direction_swipe(tracker, accessor(e), 0);\r\n\t\t//}\r\n\r\n\t\ttracker = accessor(e);\r\n\t\t//ignore common and scrolling moves\r\n\t\tif (!action_mode) return;\r\n\r\n\t\t//multitouch\t\t\r\n\t\tif (!tracker){\r\n\t\t\tscroll_mode = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//target changed - probably in scroll mode\r\n\r\n\t\tif (source.target != tracker.target || (Math.abs(source.pageX - tracker.pageX) > 5) || (Math.abs(source.pageY - tracker.pageY) > 5)){\r\n\t\t\tscroll_mode = true;\r\n\t\t\tclearTimeout(timer);\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], \"scroll\", drag_cancel);\r\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], \"touchcancel\", drag_cancel);\r\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], \"contextmenu\", function(e){\r\n\t\tif (action_mode){\r\n\t\t\tif (e && e.preventDefault)\r\n\t\t\t\te.preventDefault();\r\n\t\t\t(e||event).cancelBubble = true;\r\n\t\t\treturn false;\r\n\t\t}\r\n\t});\r\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], names[1], function(e){\r\n\t\tif (ignore(e)) return;\r\n\t\t\r\n\t\tvar fake_event;\r\n\t\tdrag_mode = scroll_mode = false;\r\n\t\taction_mode = true;\r\n\t\tscheduler._temp_touch_block = true;\r\n\t\tfake_event = tracker = accessor(e);\r\n\r\n\t\tif (!fake_event){\r\n\t\t\tscroll_mode = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//dbl click\r\n\t\tvar now = new Date();\r\n\r\n\t\tif (!scroll_mode && !drag_mode && now - dblclicktime < 250){\r\n\t\t\tscheduler._click.dhx_cal_data(fake_event);\r\n\t\t\twindow.setTimeout(function(){\r\n\t\t\t\tscheduler._on_dbl_click(fake_event);\r\n\t\t\t}, 50);\r\n\t\t\t\r\n\t\t\tif (e.preventDefault)\r\n\t\t\t\te.preventDefault();\r\n\t\t\te.cancelBubble = true;\r\n\t\t\tscheduler._block_next_stop = true;\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tdblclicktime = now;\r\n\r\n\t\t//drag\r\n\t\t\r\n\t\tif (scroll_mode || drag_mode || !scheduler.config.touch_drag)\r\n\t\t\treturn;\r\n\r\n\t\tvar actTask = scheduler._locate_event(document.activeElement);\r\n\t\tvar fakeTask = scheduler._locate_event(fake_event.target);\r\n\t\tvar sourceTask = source? scheduler._locate_event(source.target) : null;\r\n\r\n\t\tif(actTask && fakeTask && actTask == fakeTask && actTask != sourceTask)\r\n\t\t{\r\n\t\t\tif(e.preventDefault) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t\te.cancelBubble = true;\r\n\t\t\tscheduler._ignore_next_click = false;\r\n\t\t\tscheduler._click.dhx_cal_data(fake_event);\r\n\t\t\tsource = fake_event;\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t//there is no target\r\n\t\ttimer = setTimeout(function(){\r\n\r\n\t\t\tdrag_mode = true;\r\n\t\t\tvar target = source.target;\r\n\t\t\tif (target && target.className && target.className.indexOf(\"dhx_body\") != -1)\r\n\t\t\t\ttarget = target.previousSibling;\r\n\r\n\t\t\tscheduler._on_mouse_down(source, target);\r\n\t\t\tif (scheduler._drag_mode && scheduler._drag_mode != \"create\"){\r\n\t\t\t\t//var pos = -1;\r\n\t\t\t\tscheduler.for_rendered(scheduler._drag_id, function(node, i) {\r\n\t\t\t\t//\tpos = node.getBoundingClientRect().top;\r\n\t\t\t\t\tnode.style.display='none';\r\n\t\t\t\t\tscheduler._rendered.splice(i, 1);\r\n\t\t\t\t});\r\n\t\t\t\t/*if (pos>=0){\r\n\t\t\t\t\tvar step = scheduler.config.time_step;\r\n\t\t\t\t\tscheduler._move_pos_shift = step* Math.round((fake_event.pageY - pos)*60/(scheduler.config.hour_size_px*step));\r\n\t\t\t\t}*/\r\n\t\t\t}\r\n\r\n\t\t\tif (scheduler.config.touch_tip)\r\n\t\t\t\tscheduler._show_global_tip();\r\n\t\t\tscheduler._on_mouse_move(source);\r\n\t\t},scheduler.config.touch_drag);\r\n\r\n\t\tsource = fake_event;\r\n\t});\r\n\tfunction drag_cancel(e){\r\n\t\tscheduler._hide_global_tip();\r\n\t\tif (drag_mode){\r\n\t\t\tscheduler._on_mouse_up( accessor(e||event) );\r\n\t\t\tscheduler._temp_touch_block = false;\r\n\t\t}\r\n\t\tscheduler._drag_id = null;\r\n\t\tscheduler._drag_mode=null;\r\n\t\tscheduler._drag_pos=null;\r\n\t\t\r\n\t\tclearTimeout(timer);\r\n\t\tdrag_mode = action_mode = false;\r\n\t\tscroll_mode = true;\r\n\t}\r\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], names[2], function(e){\r\n\t\tif (ignore(e)) return;\r\n\r\n\t\tif (!drag_mode)\r\n\t\t\tcheck_direction_swipe(source, tracker, 200, 100);\r\n\t\t\r\n\t\tif (drag_mode)\r\n\t\t\tscheduler._ignore_next_click = true;\r\n\r\n\t\tdrag_cancel(e);\r\n\t\tif (scheduler._block_next_stop){\r\n\t\t\tscheduler._block_next_stop = false;\r\n\t\t\tif (e.preventDefault)\r\n\t\t\t\te.preventDefault();\r\n\t\t\te.cancelBubble = true;\r\n\t\t\treturn false;\t\r\n\t\t}\r\n\t});\t\r\n\r\n\tdhtmlxEvent(document.body, names[2], drag_cancel);\r\n};\r\n\r\nscheduler._show_global_tip = function(){\r\n\tscheduler._hide_global_tip();\r\n\r\n\tvar toptip = scheduler._global_tip = document.createElement(\"DIV\");\r\n\ttoptip.className='dhx_global_tip';\r\n\r\n\tscheduler._update_global_tip(1);\r\n\r\n\tdocument.body.appendChild(toptip);\r\n};\r\nscheduler._update_global_tip = function(init){\r\n\tvar toptip = scheduler._global_tip;\r\n\tif (toptip){\r\n\t\tvar time = \"\";\r\n\t\tif (scheduler._drag_id && !init){\r\n\t\t\tvar ev = scheduler.getEvent(scheduler._drag_id);\r\n\t\t\tif (ev)\r\n\t\t\t\ttime = \"<div>\" + (ev._timed ? scheduler.templates.event_header(ev.start_date, ev.end_date, ev):scheduler.templates.day_date(ev.start_date, ev.end_date, ev)) + \"</div>\";\r\n\t\t}\r\n\r\n\t\tif (scheduler._drag_mode == \"create\" || scheduler._drag_mode == \"new-size\")\r\n\t\t\ttoptip.innerHTML = (scheduler.locale.drag_to_create || \"Drag to create\")+time;\r\n\t\telse\r\n\t\t\ttoptip.innerHTML = (scheduler.locale.drag_to_move || \"Drag to move\")+time;\r\n\t}\r\n};\r\nscheduler._hide_global_tip = function(){\r\n\tvar toptip = scheduler._global_tip;\r\n\tif (toptip && toptip.parentNode){\r\n\t\ttoptip.parentNode.removeChild(toptip);\r\n\t\tscheduler._global_tip = 0;\r\n\t}\r\n};\r\n\r\nscheduler._dp_init=function(dp){\r\n\tdp._methods=[\"_set_event_text_style\",\"\",\"changeEventId\",\"_dp_hook_delete\"];\r\n\t\r\n\tthis._dp_hook_delete = function(id){\r\n\t\treturn this.deleteEvent(id, true);\r\n\t};\r\n\tthis.attachEvent(\"onEventAdded\",function(id){\r\n\t\tif (!this._loading && this._validId(id))\r\n\t\t\tdp.setUpdated(id,true,\"inserted\");\r\n\t});\r\n\tthis.attachEvent(\"onConfirmedBeforeEventDelete\", function(id){\r\n\t\tif (!this._validId(id)) return;\r\n\t\tvar z=dp.getState(id);\r\n        \r\n\t\tif (z==\"inserted\" || this._new_event) {  dp.setUpdated(id,false);\t\treturn true; }\r\n\t\tif (z==\"deleted\")  return false;\r\n    \tif (z==\"true_deleted\")  return true;\r\n    \t\r\n\t\tdp.setUpdated(id,true,\"deleted\");\r\n      \treturn false;\r\n\t});\r\n\tthis.attachEvent(\"onEventChanged\",function(id){\r\n\t\tif (!this._loading && this._validId(id))\r\n\t\t\tdp.setUpdated(id,true,\"updated\");\r\n\t});\r\n\t\r\n\tdp._getRowData=function(id,pref){\r\n\t\tvar ev=this.obj.getEvent(id);\r\n\t\tvar data = {};\r\n\t\t\r\n\t\tfor (var a in ev){\r\n\t\t\tif (a.indexOf(\"_\") === 0) continue;\r\n\t\t\tif (ev[a] && ev[a].getUTCFullYear) //not very good, but will work\r\n\t\t\t\tdata[a] = this.obj.templates.xml_format(ev[a]);\r\n\t\t\telse\r\n\t\t\t\tdata[a] = ev[a];\r\n\t\t}\r\n\t\t\r\n\t\treturn data;\r\n\t};\r\n\tdp._clearUpdateFlag=function(){};\r\n\t\r\n\tdp.attachEvent(\"insertCallback\", scheduler._update_callback);\r\n\tdp.attachEvent(\"updateCallback\", scheduler._update_callback);\r\n\tdp.attachEvent(\"deleteCallback\", function(upd, id) {\r\n\t\tthis.obj.setUserData(id, this.action_param, \"true_deleted\");\r\n\t\tthis.obj.deleteEvent(id);\r\n\t});\r\n\t\t\r\n};\r\n\r\nscheduler._validId=function(id){\r\n\treturn true;\r\n};\r\n\r\nscheduler.setUserData=function(id,name,value){\r\n\tif (id)\r\n\t\tthis.getEvent(id)[name]=value;\r\n\telse\r\n\t\tthis._userdata[name]=value;\r\n};\r\nscheduler.getUserData=function(id,name){\r\n\treturn id?this.getEvent(id)[name]:this._userdata[name];\r\n};\r\nscheduler._set_event_text_style=function(id,style){\r\n\tthis.for_rendered(id,function(r){\r\n\t\tr.style.cssText+=\";\"+style;\r\n\t});\r\n\tvar ev = this.getEvent(id);\r\n\tev[\"_text_style\"]=style;\r\n\tthis.event_updated(ev);\r\n};\r\n\r\nscheduler._update_callback = function(upd,id){\r\n\tvar data\t\t=\tscheduler._xmlNodeToJSON(upd.firstChild);\r\n\tdata.text\t\t=\tdata.text||data._tagvalue;\r\n\tdata.start_date\t=\tscheduler.templates.xml_date(data.start_date);\r\n\tdata.end_date\t=\tscheduler.templates.xml_date(data.end_date);\r\n\t\r\n\tscheduler.addEvent(data);\r\n};\r\nscheduler._skin_settings = {\r\n\tfix_tab_position: [1,0],\r\n\tuse_select_menu_space: [1,0],\r\n\twide_form: [1,0],\r\n\r\n\thour_size_px: [44,42],\r\n\tdisplayed_event_color: [\"#ff4a4a\", \"ffc5ab\"],\r\n\tdisplayed_event_text_color: [\"#ffef80\", \"7e2727\"]\r\n};\r\n\r\nscheduler._skin_xy = {\r\n\tlightbox_additional_height: [90,50],\r\n\tnav_height: [59,22],\r\n\tbar_height: [24,20]\r\n};\r\n\r\nscheduler._configure = function(col, data, skin){\r\n\tfor (var key in data)\r\n\t\tif (typeof col[key] == \"undefined\")\r\n\t\t\tcol[key] = data[key][skin];\r\n};\r\nscheduler._skin_init = function(){\r\n\tif (!scheduler.skin){\r\n\t\tvar links = document.getElementsByTagName(\"link\");\r\n\t\tfor (var i = 0; i < links.length; i++) {\r\n\t\t\tvar res = links[i].href.match(\"dhtmlxscheduler_([a-z]+).css\");\r\n\t\t\tif (res){\r\n\t\t\t\tscheduler.skin = res[1];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\t\r\n\tvar set = 0;\r\n\tif (scheduler.skin && (scheduler.skin === \"classic\" || scheduler.skin === \"glossy\")) set = 1;\r\n\r\n\t//apply skin related settings\r\n\tthis._configure(scheduler.config, scheduler._skin_settings, set);\r\n\tthis._configure(scheduler.xy, scheduler._skin_xy, set);\r\n\r\n\tif (scheduler.skin === \"flat\"){\r\n\t\tscheduler.xy.scale_height = 35;\r\n\t\tscheduler.templates.hour_scale = function(date){\r\n\t\t\tvar min = date.getMinutes();\r\n\t\t\tmin = min < 10 ? \"0\"+min : min;\r\n\t\t\tvar html = \"<span class='dhx_scale_h'>\"+ date.getHours() +\"</span>\"+\r\n\t\t\t\t\"<span class='dhx_scale_m'>&nbsp;\"+ min +\"</span>\";\r\n\t\t\treturn html;\r\n\t\t};\r\n\t}\r\n\r\n\t//classic skin need not any further customization\r\n\tif (set) return;\r\n\t\r\n\t\r\n\tvar minic = scheduler.config.minicalendar;\r\n\tif (minic) minic.padding = 14;\r\n\r\n\tscheduler.templates.event_bar_date = function(start,end,ev) {\r\n\t\treturn \"• <b>\"+scheduler.templates.event_date(start)+\"</b> \";\r\n\t};\r\n\r\n\t//scheduler._lightbox_template=\"<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span><div class='dhx_close_icon'></div></div><div class='dhx_cal_larea'></div>\";\r\n\tscheduler.attachEvent(\"onTemplatesReady\", function() {\r\n\r\n\t\tvar date_to_str = scheduler.date.date_to_str(\"%d\");\r\n\t\tif(!scheduler.templates._old_month_day){\r\n\t\t\tscheduler.templates._old_month_day = scheduler.templates.month_day;\r\n\t\t}\r\n\t\tvar old_month_day = scheduler.templates._old_month_day;\r\n\t\tscheduler.templates.month_day = function(date) {\r\n\t\t\tif (this._mode == \"month\") {\r\n\t\t\t\tvar label = date_to_str(date);\r\n\t\t\t\tif (date.getDate() == 1) {\r\n\t\t\t\t\tlabel = scheduler.locale.date.month_full[date.getMonth()] + \" \" + label;\r\n\t\t\t\t}\r\n\t\t\t\tif (+date == +scheduler.date.date_part(new Date())) {\r\n\t\t\t\t\tlabel = scheduler.locale.labels.dhx_cal_today_button + \" \" + label;\r\n\t\t\t\t}\r\n\t\t\t\treturn label;\r\n\t\t\t} else {\r\n\t\t\t\treturn old_month_day.call(this, date);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tif (scheduler.config.fix_tab_position){\r\n\t\t\tvar navline_divs = scheduler._els[\"dhx_cal_navline\"][0].getElementsByTagName('div');\r\n\t\t\tvar minical = null;\r\n\t\t\tvar tabs = [];\r\n\t\t\tvar last = 211;\r\n\t\t\tfor (var i=0; i<navline_divs.length; i++) {\r\n\t\t\t\tvar div = navline_divs[i];\r\n\t\t\t\tvar name = div.getAttribute(\"name\");\r\n\t\t\t\tif (name) { // mode tab\r\n\t\t\t\t\tdiv.style.right = \"auto\";\r\n\t\t\t\t\tswitch (name) {\r\n\t\t\t\t\t\tcase \"day_tab\":\r\n\t\t\t\t\t\t\tdiv.style.left = \"14px\";\r\n\t\t\t\t\t\t\tdiv.className += \" dhx_cal_tab_first\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"week_tab\":\r\n\t\t\t\t\t\t\tdiv.style.left = \"75px\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"month_tab\":\r\n\t\t\t\t\t\t\tdiv.style.left = \"136px\";\r\n\t\t\t\t\t\t\tdiv.className += \" dhx_cal_tab_last\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tdiv.style.left = last+\"px\";\r\n\t\t\t\t\t\t\tdiv.className += \" dhx_cal_tab_standalone\";\r\n\t\t\t\t\t\t\tlast = last + 14 + div.offsetWidth;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif((div.className || \"\").indexOf(\"dhx_minical_icon\") === 0 &&\r\n\t\t\t\t\t\tdiv.parentNode == scheduler._els[\"dhx_cal_navline\"][0]){\r\n\t\t\t\t\t\t// if default minicalendar icon\r\n\t\t\t\t\t\tminical = div;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif(minical){\r\n\t\t\t\tminical.style.left = last+\"px\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\tscheduler._skin_init = function(){};\r\n};\r\n\r\n\r\nif (window.jQuery){\r\n\r\n(function( $ ){\r\n\tvar counter = 0;\r\n\tvar methods = [];\r\n\t$.fn.dhx_scheduler = function(config){\r\n\t\tif (typeof(config) === 'string') {\r\n\t\t\tif (methods[config] ) {\r\n\t\t\t\treturn methods[config].apply(this, []);\r\n\t\t\t}else {\r\n\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_scheduler');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar views = [];\r\n\t\t\tthis.each(function() {\r\n\t\t\t\tif (this && this.getAttribute){\r\n\t\t\t\t\tif (!this.getAttribute(\"dhxscheduler\")){\r\n\t\t\t\t\t\tvar name = \"scheduler\";\r\n\t\t\t\t\t\tif (counter){\r\n\t\t\t\t\t\t\tname = \"scheduler\" + (counter+1);\r\n\t\t\t\t\t\t\twindow[name] = Scheduler.getSchedulerInstance();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar comp  = window[name];\r\n\r\n\t\t\t\t\t\tthis.setAttribute(\"dhxscheduler\", name);\r\n\t\t\t\t\t\tfor (var key in config)\r\n\t\t\t\t\t\t\tif (key!=\"data\")\r\n\t\t\t\t\t\t\t\tcomp.config[key] = config[key];\r\n\r\n\t\t\t\t\t\tif (!this.getElementsByTagName(\"div\").length){\r\n\t\t\t\t\t\t\tthis.innerHTML = '<div class=\"dhx_cal_navline\"><div class=\"dhx_cal_prev_button\">&nbsp;</div><div class=\"dhx_cal_next_button\">&nbsp;</div><div class=\"dhx_cal_today_button\"></div><div class=\"dhx_cal_date\"></div><div class=\"dhx_cal_tab\" name=\"day_tab\" style=\"right:204px;\"></div><div class=\"dhx_cal_tab\" name=\"week_tab\" style=\"right:140px;\"></div><div class=\"dhx_cal_tab\" name=\"month_tab\" style=\"right:76px;\"></div></div><div class=\"dhx_cal_header\"></div><div class=\"dhx_cal_data\"></div>';\r\n\t\t\t\t\t\t\tthis.className += \" dhx_cal_container\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcomp.init(this, comp.config.date, comp.config.mode);\r\n\t\t\t\t\t\tif (config.data)\r\n\t\t\t\t\t\t\tcomp.parse(config.data);\r\n\r\n\t\t\t\t\t\tviews.push(comp);\r\n\t\t\t\t\t\tcounter++;\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\tviews.push(window[this.getAttribute(\"dhxscheduler\")]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (views.length === 1) return views[0];\r\n\t\t\treturn views;\r\n\t\t}\r\n\t};\r\n\t\r\n\r\n\t\r\n\r\n})(jQuery);\r\n\r\n}\r\n(function(){\r\n\r\n\tvar setCurrentView = scheduler.setCurrentView,\r\n\t\tupdateView = scheduler.updateView;\r\n\tvar update_view_timer = null,\r\n\t\tcurr_view_timer = null;\r\n\r\n\tvar lazy_setCurrentView = function(date, mode){\r\n\t\tvar self = this;\r\n\t\twindow.clearTimeout(curr_view_timer);\r\n\t\twindow.clearTimeout(update_view_timer);\r\n\r\n\t\tupdateFlags(this, date, mode);\r\n\r\n\t\tcurr_view_timer = setTimeout(function(){\r\n\r\n\t\t\tif (!self.callEvent(\"onBeforeViewChange\", [self._mode, self._date, mode || self._mode, date || self._date])) return;\r\n\t\t\tupdateView.call(self, date, mode);\r\n\t\t\tself.callEvent(\"onViewChange\", [self._mode, self._date]);\r\n\r\n\t\t\twindow.clearTimeout(update_view_timer);\r\n\t\t\tcurr_view_timer = 0;\r\n\t\t}, scheduler.config.delay_render);\r\n\t};\r\n\tvar lazy_updateView = function(date, mode){\r\n\t\tvar self = this,\r\n\t\t\tars = arguments;\r\n\r\n\t\tupdateFlags(this, date, mode);\r\n\r\n\t\twindow.clearTimeout(update_view_timer);\r\n\t\tupdate_view_timer = setTimeout(function(){\r\n\t\t\tif(curr_view_timer)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tupdateView.apply(self, ars);\r\n\t\t}, scheduler.config.delay_render);\r\n\t};\r\n\tfunction updateFlags(scheduler, date, mode){\r\n\t\tif(date)\r\n\t\t\tscheduler._date = date;\r\n\t\tif(mode)\r\n\t\t\tscheduler._mode = mode;\r\n\r\n\t}\r\n\tscheduler.attachEvent(\"onSchedulerReady\", function(){\r\n\t\tif(scheduler.config.delay_render){\r\n\t\t\tscheduler.setCurrentView = lazy_setCurrentView;\r\n\t\t\tscheduler.updateView = lazy_updateView;\r\n\t\t}else{\r\n\t\t\tscheduler.setCurrentView = setCurrentView;\r\n\t\t\tscheduler.updateView = updateView;\r\n\t\t}\r\n\t});\r\n\r\n})();\r\n\r\n\tfor (var i=0; i<Scheduler._schedulerPlugins.length; i++) {\r\n\t\tScheduler._schedulerPlugins[i](scheduler);\r\n\t}\r\n\tscheduler._internal_id = Scheduler._seed++;\r\n\r\n\tif (Scheduler.$syncFactory)\r\n\tScheduler.$syncFactory(scheduler);\r\n\r\n\treturn scheduler;\r\n};\r\n\r\nwindow.scheduler = Scheduler.getSchedulerInstance(); // default instance\r\n\r\nif (dhtmlx && dhtmlx.attaches) {\r\n\tdhtmlx.attaches.attachScheduler = function(day, mode, tabs, scheduler) {\r\n\t\tvar tabs = tabs || '<div class=\"dhx_cal_tab\" name=\"day_tab\" style=\"right:204px;\"></div><div class=\"dhx_cal_tab\" name=\"week_tab\" style=\"right:140px;\"></div><div class=\"dhx_cal_tab\" name=\"month_tab\" style=\"right:76px;\"></div>';\r\n\t\tvar obj = document.createElement(\"DIV\");\r\n\t\tobj.id = \"dhxSchedObj_\"+this._genStr(12);\r\n\t\tobj.innerHTML = '<div id=\"'+obj.id+'\" class=\"dhx_cal_container\" style=\"width:100%; height:100%;\"><div class=\"dhx_cal_navline\"><div class=\"dhx_cal_prev_button\">&nbsp;</div><div class=\"dhx_cal_next_button\">&nbsp;</div><div class=\"dhx_cal_today_button\"></div><div class=\"dhx_cal_date\"></div>'+tabs+'</div><div class=\"dhx_cal_header\"></div><div class=\"dhx_cal_data\"></div></div>';\r\n\t\tdocument.body.appendChild(obj.firstChild);\r\n\r\n\t\tthis.attachObject(obj.id, false, true);\r\n\r\n\t\tthis.vs[this.av].sched = scheduler;\r\n\t\tthis.vs[this.av].schedId = obj.id;\r\n\t\tscheduler.setSizes = scheduler.updateView;\r\n\t\tscheduler.destructor=function(){};\r\n\t\tscheduler.init(obj.id,day,mode);\r\n\r\n\t\treturn this.vs[this._viewRestore()].sched;\r\n\t};\r\n}\r\n"

/***/ },
/* 8 */
/*!*******************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!C:/building/src/main/webapp/resources/WebContent/codebase/locale/locale_en.js ***!
  \*******************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/locale/locale_en.js */ 9)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/locale/locale_en.js")

/***/ },
/* 9 */
/*!****************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/locale/locale_en.js ***!
  \****************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\n@license\r\ndhtmlxScheduler v.4.3.1 \r\n\r\nThis software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n\r\n(c) Dinamenta, UAB.\r\n*/\r\nScheduler.plugin(function(e){e.locale={date:{month_full:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],month_short:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],day_full:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],day_short:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"]},labels:{dhx_cal_today_button:\"Today\",day_tab:\"Day\",week_tab:\"Week\",month_tab:\"Month\",new_event:\"New event\",icon_save:\"Save\",\r\nicon_cancel:\"Cancel\",icon_details:\"Details\",icon_edit:\"Edit\",icon_delete:\"Delete\",confirm_closing:\"\",confirm_deleting:\"Event will be deleted permanently, are you sure?\",section_description:\"Description\",section_time:\"Time period\",full_day:\"Full day\",confirm_recurring:\"Do you want to edit the whole set of repeated events?\",section_recurring:\"Repeat event\",button_recurring:\"Disabled\",button_recurring_open:\"Enabled\",button_edit_series:\"Edit series\",button_edit_occurrence:\"Edit occurrence\",agenda_tab:\"Agenda\",\r\ndate:\"Date\",description:\"Description\",year_tab:\"Year\",week_agenda_tab:\"Agenda\",grid_tab:\"Grid\",drag_to_create:\"Drag to create\",drag_to_move:\"Drag to move\",message_ok:\"OK\",message_cancel:\"Cancel\"}}});\r\n//# sourceMappingURL=../sources/locale/locale_en.js.map"

/***/ },
/* 10 */
/*!******************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_tooltip.js ***!
  \******************************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_tooltip.js */ 11)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_tooltip.js")

/***/ },
/* 11 */
/*!***************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_tooltip.js ***!
  \***************************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\n@license\r\ndhtmlxScheduler v.4.3.1 \r\n\r\nThis software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n\r\n(c) Dinamenta, UAB.\r\n*/\r\nScheduler.plugin(function(e){!function(){var t=e.dhtmlXTooltip=e.tooltip={};t.config={className:\"dhtmlXTooltip tooltip\",timeout_to_display:50,timeout_to_hide:50,delta_x:15,delta_y:-20},t.tooltip=document.createElement(\"div\"),t.tooltip.className=t.config.className,t.show=function(a,n){if(!e.config.touch||e.config.touch_tooltip){var i=t,r=this.tooltip,o=r.style;i.tooltip.className=i.config.className;var l=this.position(a),d=a.target||a.srcElement;if(!this.isTooltip(d)){var s=l.x+(i.config.delta_x||0),_=l.y-(i.config.delta_y||0);\r\n\r\no.visibility=\"hidden\",o.removeAttribute?(o.removeAttribute(\"right\"),o.removeAttribute(\"bottom\")):(o.removeProperty(\"right\"),o.removeProperty(\"bottom\")),o.left=\"0\",o.top=\"0\",this.tooltip.innerHTML=n,document.body.appendChild(this.tooltip);var c=this.tooltip.offsetWidth,u=this.tooltip.offsetHeight;document.body.offsetWidth-s-c<0?(o.removeAttribute?o.removeAttribute(\"left\"):o.removeProperty(\"left\"),o.right=document.body.offsetWidth-s+2*(i.config.delta_x||0)+\"px\"):0>s?o.left=l.x+Math.abs(i.config.delta_x||0)+\"px\":o.left=s+\"px\",\r\ndocument.body.offsetHeight-_-u<0?(o.removeAttribute?o.removeAttribute(\"top\"):o.removeProperty(\"top\"),o.bottom=document.body.offsetHeight-_-2*(i.config.delta_y||0)+\"px\"):0>_?o.top=l.y+Math.abs(i.config.delta_y||0)+\"px\":o.top=_+\"px\",o.visibility=\"visible\",this.tooltip.onmouseleave=function(t){t=t||window.event;for(var a=e.dhtmlXTooltip,n=t.relatedTarget;n!=e._obj&&n;)n=n.parentNode;n!=e._obj&&a.delay(a.hide,a,[],a.config.timeout_to_hide)},e.callEvent(\"onTooltipDisplayed\",[this.tooltip,this.tooltip.event_id]);\r\n\r\n}}},t._clearTimeout=function(){this.tooltip._timeout_id&&window.clearTimeout(this.tooltip._timeout_id)},t.hide=function(){if(this.tooltip.parentNode){var t=this.tooltip.event_id;this.tooltip.event_id=null,this.tooltip.onmouseleave=null,this.tooltip.parentNode.removeChild(this.tooltip),e.callEvent(\"onAfterTooltip\",[t])}this._clearTimeout()},t.delay=function(e,t,a,n){this._clearTimeout(),this.tooltip._timeout_id=setTimeout(function(){var n=e.apply(t,a);return e=t=a=null,n},n||this.config.timeout_to_display);\r\n\r\n},t.isTooltip=function(e){var t=!1;for(\"dhtmlXTooltip\"==e.className.split(\" \")[0];e&&!t;)t=e.className==this.tooltip.className,e=e.parentNode;return t},t.position=function(e){if(e=e||window.event,e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};var t=window._isIE&&\"BackCompat\"!=document.compatMode?document.documentElement:document.body;return{x:e.clientX+t.scrollLeft-t.clientLeft,y:e.clientY+t.scrollTop-t.clientTop}},e.attachEvent(\"onMouseMove\",function(a,n){var i=window.event||n,r=i.target||i.srcElement,o=t,l=o.isTooltip(r),d=o.isTooltipTarget&&o.isTooltipTarget(r);\r\n\r\nif(a||l||d){var s;if(a||o.tooltip.event_id){var _=e.getEvent(a)||e.getEvent(o.tooltip.event_id);if(!_)return;if(o.tooltip.event_id=_.id,s=e.templates.tooltip_text(_.start_date,_.end_date,_),!s)return o.hide()}d&&(s=\"\");var c;if(_isIE){c={pageX:void 0,pageY:void 0,clientX:void 0,clientY:void 0,target:void 0,srcElement:void 0};for(var u in c)c[u]=i[u]}if(!e.callEvent(\"onBeforeTooltip\",[a])||!s)return;o.delay(o.show,o,[c||i,s])}else o.delay(o.hide,o,[],o.config.timeout_to_hide)}),e.attachEvent(\"onBeforeDrag\",function(){\r\nreturn t.hide(),!0}),e.attachEvent(\"onEventDeleted\",function(){return t.hide(),!0}),e.templates.tooltip_date_format=e.date.date_to_str(\"%Y-%m-%d %H:%i\"),e.templates.tooltip_text=function(t,a,n){return\"<b>Event:</b> \"+n.text+\"<br/><b>Start date:</b> \"+e.templates.tooltip_date_format(t)+\"<br/><b>End date:</b> \"+e.templates.tooltip_date_format(a)}}()});\r\n//# sourceMappingURL=../sources/ext/dhtmlxscheduler_tooltip.js.map"

/***/ },
/* 12 */
/*!**********************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_agenda_view.js ***!
  \**********************************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_agenda_view.js */ 13)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_agenda_view.js")

/***/ },
/* 13 */
/*!*******************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/ext/dhtmlxscheduler_agenda_view.js ***!
  \*******************************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\n@license\r\ndhtmlxScheduler v.4.3.1 \r\n\r\nThis software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n\r\n(c) Dinamenta, UAB.\r\n*/\r\nScheduler.plugin(function(e){e.date.add_agenda=function(t){return e.date.add(t,1,\"year\")},e.templates.agenda_time=function(t,i,s){return s._timed?this.day_date(s.start_date,s.end_date,s)+\" \"+this.event_date(t):e.templates.day_date(t)+\" &ndash; \"+e.templates.day_date(i)},e.templates.agenda_text=function(e,t,i){return i.text},e.templates.agenda_date=function(){return\"\"},e.date.agenda_start=function(){return e.date.date_part(e._currentDate())},e.attachEvent(\"onTemplatesReady\",function(){function t(t){\r\nif(t){var i=e.locale.labels;e._els.dhx_cal_header[0].innerHTML=\"<div class='dhx_agenda_line'><div>\"+i.date+\"</div><span style='padding-left:25px'>\"+i.description+\"</span></div>\",e._table_view=!0,e.set_sizes()}}function i(){var t=(e._date,e.get_visible_events());t.sort(function(e,t){return e.start_date>t.start_date?1:-1});for(var i=\"<div class='dhx_agenda_area'>\",s=0;s<t.length;s++){var a=t[s],n=a.color?\"background:\"+a.color+\";\":\"\",r=a.textColor?\"color:\"+a.textColor+\";\":\"\",d=e.templates.event_class(a.start_date,a.end_date,a);\r\n\r\ni+=\"<div class='dhx_agenda_line\"+(d?\" \"+d:\"\")+\"' event_id='\"+a.id+\"' style='\"+r+n+(a._text_style||\"\")+\"'><div class='dhx_agenda_event_time'>\"+e.templates.agenda_time(a.start_date,a.end_date,a)+\"</div>\",i+=\"<div class='dhx_event_icon icon_details'>&nbsp</div>\",i+=\"<span>\"+e.templates.agenda_text(a.start_date,a.end_date,a)+\"</span></div>\"}i+=\"<div class='dhx_v_border'></div></div>\",e._els.dhx_cal_data[0].innerHTML=i,e._els.dhx_cal_data[0].childNodes[0].scrollTop=e._agendaScrollTop||0;var o=e._els.dhx_cal_data[0].childNodes[0],l=o.childNodes[o.childNodes.length-1];\r\n\r\nl.style.height=o.offsetHeight<e._els.dhx_cal_data[0].offsetHeight?\"100%\":o.offsetHeight+\"px\";var _=e._els.dhx_cal_data[0].firstChild.childNodes;e._els.dhx_cal_date[0].innerHTML=e.templates.agenda_date(e._min_date,e._max_date,e._mode),e._rendered=[];for(var s=0;s<_.length-1;s++)e._rendered[s]=_[s]}var s=e.dblclick_dhx_cal_data;e.dblclick_dhx_cal_data=function(){if(\"agenda\"==this._mode)!this.config.readonly&&this.config.dblclick_create&&this.addEventNow();else if(s)return s.apply(this,arguments)},e.attachEvent(\"onSchedulerResize\",function(){\r\nreturn\"agenda\"==this._mode?(this.agenda_view(!0),!1):!0});var a=e.render_data;e.render_data=function(e){return\"agenda\"!=this._mode?a.apply(this,arguments):void i()};var n=e.render_view_data;e.render_view_data=function(){return\"agenda\"==this._mode&&(e._agendaScrollTop=e._els.dhx_cal_data[0].childNodes[0].scrollTop,e._els.dhx_cal_data[0].childNodes[0].scrollTop=0),n.apply(this,arguments)},e.agenda_view=function(s){e._min_date=e.config.agenda_start||e.date.agenda_start(e._date),e._max_date=e.config.agenda_end||e.date.add_agenda(e._min_date,1),\r\ne._table_view=!0,t(s),s&&i()}})});\r\n//# sourceMappingURL=../sources/ext/dhtmlxscheduler_agenda_view.js.map"

/***/ },
/* 14 */
/*!****************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!C:/building/src/main/webapp/resources/WebContent/codebase/scheduler.api.js ***!
  \****************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/scheduler.api.js */ 15)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/scheduler.api.js")

/***/ },
/* 15 */
/*!*************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/scheduler.api.js ***!
  \*************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "(function(){\r\n\r\nvar export_mode = false;\r\n\r\nfunction defaults(obj, std){\r\n    for (var key in std)\r\n        if (!obj[key])\r\n            obj[key] = std[key];\r\n    return obj;\r\n}\r\n\r\nfunction add_export_methods(scheduler){\r\n\r\n    scheduler.exportToPDF = function(config){\r\n        config = defaults((config || {}), {\r\n            name:\"calendar.pdf\",\r\n            format:\"A4\",\r\n            orientation:\"landscape\",\r\n            dpi:96,\r\n            zoom:1\r\n        });\r\n        config.html = config.html || this._export_html(config);\r\n            config.mode = this.getState().mode;\r\n        this._send_to_export(config, \"pdf\");\r\n    };\r\n\r\n    scheduler.exportToPNG = function(config){\r\n        config = defaults((config || {}), {\r\n            name:\"calendar.png\",\r\n            format:\"A4\",\r\n            orientation:\"landscape\",\r\n            dpi:96,\r\n            zoom:1\r\n        });\r\n        config.html = config.html || this._export_html(config);\r\n            config.mode = this.getState().mode;\r\n        this._send_to_export(config, \"png\");\r\n    };\r\n\r\n    scheduler.exportToICal = function(config){\r\n        config = defaults((config || {}), {\r\n            name:\"calendar.ical\",\r\n            data:this._serialize_plain(null, config)\r\n        });\r\n        this._send_to_export(config, \"ical\");\r\n    };\r\n\r\n    scheduler.exportToExcel = function(config){\r\n        config = defaults((config || {}), {\r\n            name:\"calendar.xlsx\",\r\n            title:\"Events\",\r\n            data:this._serialize_plain( this.templates.xml_format, config),\r\n            columns:this._serialize_columns()\r\n        });\r\n        this._send_to_export(config, \"excel\");\r\n    };\r\n\r\n    scheduler._ajax_to_export = function(data, type, callback){\r\n        delete data.callback;\r\n        var url = data.server || \"https://export.dhtmlx.com/scheduler\";\r\n\r\n        dhtmlxAjax.post(url,\r\n            \"type=\"+type+\"&store=1&data=\"+encodeURIComponent(JSON.stringify(data)),\r\n            function(loader){\r\n                var fail = loader.xmlDoc.status > 400;\r\n                var info = null;\r\n\r\n                if (!fail){\r\n                    try{\r\n                        info = JSON.parse(loader.xmlDoc.responseText);\r\n                    }catch(e){}\r\n                }\r\n                callback(info);\r\n            }\r\n        );\r\n    };\r\n\r\n\r\n    scheduler._plain_export_copy = function(source, format){\r\n        var target = {};\r\n        for (var key in source)\r\n            target[key] = source[key];\r\n\r\n        target.start_date = format(target.start_date);\r\n        target.end_date = format(target.end_date);\r\n        target.$text = this.templates.event_text(source.start_date, source.end_date, source);\r\n\r\n        return target;\r\n    };\r\n\r\n    scheduler._serialize_plain = function(format, config){\r\n        format = format || scheduler.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\r\n\r\n        var events;\r\n        if (config && config.start && config.end)\r\n            events = scheduler.getEvents(config.start, config.end);\r\n        else\r\n            events = scheduler.getEvents();\r\n\r\n        var data = [];\r\n        for (var i = 0; i< events.length; i++)\r\n            data[i] = this._plain_export_copy(events[i], format);\r\n\r\n        return data;\r\n    };\r\n\r\n    scheduler._serialize_columns = function(){\r\n        return [\r\n            { id:\"start_date\", header:\"Start Date\", width:30 },\r\n            { id:\"end_date\", header:\"End Date\", width:30 },\r\n            { id:\"$text\", header:\"Text\", width:100 }\r\n        ];\r\n    };\r\n\r\n    scheduler._send_to_export = function(data, type){\r\n        if (data.callback)\r\n                return scheduler._ajax_to_export(data, type, data.callback);\r\n\r\n        var form = this._create_hidden_form();\r\n\r\n        form.firstChild.action = data.server || \"https://export.dhtmlx.com/scheduler\";\r\n        form.firstChild.childNodes[0].value = JSON.stringify(data);\r\n        form.firstChild.childNodes[1].value = type;\r\n        form.firstChild.submit();\r\n    };\r\n\r\n    scheduler._create_hidden_form = function(){\r\n        if (!this._hidden_export_form){\r\n            var t = this._hidden_export_form = document.createElement(\"div\");\r\n            t.style.display = \"none\";\r\n            t.innerHTML = \"<form method='POST' target='_blank'><input type='text' name='data'><input type='hidden' name='type' value=''></form>\";\r\n            document.body.appendChild(t);\r\n        }\r\n        return this._hidden_export_form;\r\n    };\r\n\r\n    scheduler._export_resize = function(){\r\n        if (scheduler.callEvent(\"onSchedulerResize\",[]))  {\r\n            scheduler.update_view();\r\n            scheduler.callEvent(\"onAfterSchedulerResize\", []);\r\n        }\r\n    };\r\n\r\n\r\n    scheduler._get_export_size = function(format, orientation, zoom, dpi){\r\n        var border = 10;\r\n            dpi = dpi/25.4;\r\n        var sizes = {\r\n            \"A5\":{ x:148, y:210 },\r\n            \"A4\":{ x:210, y:297 },\r\n            \"A3\":{ x:297, y:420 },\r\n            \"A2\":{ x:420, y:594 },\r\n            \"A1\":{ x:594, y:841 },\r\n            \"A0\":{ x:841, y:1189 }\r\n        };\r\n\r\n        var cSize = { x:sizes[format].x, y:sizes[format].y };\r\n        if (orientation == \"landscape\"){\r\n            var c = cSize.x;\r\n            cSize.x = cSize.y;\r\n            cSize.y = c;\r\n        }\r\n\r\n        cSize.x = Math.floor( (cSize.x - border*2 ) * dpi ) * 1/zoom;\r\n        cSize.y = Math.floor( (cSize.y - border*2 ) * dpi );\r\n\r\n        return cSize;\r\n\r\n    };\r\n\r\n    scheduler._export_html = function(obj){\r\n        var hy = scheduler.xy.nav_height;\r\n        var sw = scheduler.xy.scroll_width;\r\n        var xs = scheduler._obj.style.width;\r\n        var ys = scheduler._obj.style.height;\r\n\r\n        var size = scheduler._get_export_size(obj.format, obj.orientation, obj.zoom, obj.dpi);\r\n        scheduler._obj.style.width  = size.x + \"px\";\r\n        scheduler._obj.style.height = size.y + \"px\";\r\n\r\n        scheduler.xy.nav_height = 0;\r\n        scheduler.xy.scroll_width = 0;\r\n\r\n        export_mode = true;\r\n        scheduler._export_resize();\r\n        export_mode = false;\r\n\r\n        var html = scheduler._obj.innerHTML;\r\n\r\n        scheduler.xy.scroll_width = sw;\r\n        scheduler.xy.nav_height = hy;\r\n        scheduler._obj.style.width  = xs;\r\n        scheduler._obj.style.height = ys;\r\n\r\n        scheduler._export_resize();\r\n        return html;\r\n    };\r\n\r\n}\r\n\r\nadd_export_methods(scheduler);\r\nif (window.Scheduler && Scheduler.plugin)\r\n    Scheduler.plugin(add_export_methods);\r\n\r\n})();"

/***/ },
/* 16 */
/*!**************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_minical.js ***!
  \**************************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_minical.js */ 17)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_minical.js")

/***/ },
/* 17 */
/*!***********************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_minical.js ***!
  \***********************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\n@license\r\ndhtmlxScheduler v.4.3.1 \r\n\r\nThis software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n\r\n(c) Dinamenta, UAB.\r\n*/\r\nScheduler.plugin(function(e){e.templates.calendar_month=e.date.date_to_str(\"%F %Y\"),e.templates.calendar_scale_date=e.date.date_to_str(\"%D\"),e.templates.calendar_date=e.date.date_to_str(\"%d\"),e.config.minicalendar={mark_events:!0},e._synced_minicalendars=[],e.renderCalendar=function(t,a,n){var i=null,r=t.date||e._currentDate();if(\"string\"==typeof r&&(r=this.templates.api_date(r)),a)i=this._render_calendar(a.parentNode,r,t,a),e.unmarkCalendar(i);else{var d=t.container,l=t.position;if(\"string\"==typeof d&&(d=document.getElementById(d)),\r\n\"string\"==typeof l&&(l=document.getElementById(l)),l&&\"undefined\"==typeof l.left){var o=getOffset(l);l={top:o.top+l.offsetHeight,left:o.left}}d||(d=e._get_def_cont(l)),i=this._render_calendar(d,r,t),i.onclick=function(t){t=t||event;var a=t.target||t.srcElement;if(-1!=a.className.indexOf(\"dhx_month_head\")){var n=a.parentNode.className;if(-1==n.indexOf(\"dhx_after\")&&-1==n.indexOf(\"dhx_before\")){var i=e.templates.xml_date(this.getAttribute(\"date\"));i.setDate(parseInt(a.innerHTML,10)),e.unmarkCalendar(this),\r\ne.markCalendar(this,i,\"dhx_calendar_click\"),this._last_date=i,this.conf.handler&&this.conf.handler.call(e,i,this)}}}}if(e.config.minicalendar.mark_events)for(var s=e.date.month_start(r),_=e.date.add(s,1,\"month\"),c=this.getEvents(s,_),u=this[\"filter_\"+this._mode],h=0;h<c.length;h++){var p=c[h];if(!u||u(p.id,p)){var v=p.start_date;for(v.valueOf()<s.valueOf()&&(v=s),v=e.date.date_part(new Date(v.valueOf()));v<p.end_date&&(this.markCalendar(i,v,\"dhx_year_event\"),v=this.date.add(v,1,\"day\"),!(v.valueOf()>=_.valueOf())););\r\n}}return this._markCalendarCurrentDate(i),i.conf=t,t.sync&&!n&&this._synced_minicalendars.push(i),i.conf._on_xle_handler||(i.conf._on_xle_handler=e.attachEvent(\"onXLE\",function(){e.updateCalendar(i,i.conf.date)})),i},e._get_def_cont=function(e){return this._def_count||(this._def_count=document.createElement(\"DIV\"),this._def_count.className=\"dhx_minical_popup\",this._def_count.onclick=function(e){(e||event).cancelBubble=!0},document.body.appendChild(this._def_count)),this._def_count.style.left=e.left+\"px\",\r\nthis._def_count.style.top=e.top+\"px\",this._def_count._created=new Date,this._def_count},e._locateCalendar=function(t,a){if(\"string\"==typeof a&&(a=e.templates.api_date(a)),+a>+t._max_date||+a<+t._min_date)return null;for(var n=t.childNodes[2].childNodes[0],i=0,r=new Date(t._min_date);+this.date.add(r,1,\"week\")<=+a;)r=this.date.add(r,1,\"week\"),i++;var d=e.config.start_on_monday,l=(a.getDay()||(d?7:0))-(d?1:0);return n.rows[i].cells[l].firstChild},e.markCalendar=function(e,t,a){var n=this._locateCalendar(e,t);\r\n\r\nn&&(n.className+=\" \"+a)},e.unmarkCalendar=function(e,t,a){if(t=t||e._last_date,a=a||\"dhx_calendar_click\",t){var n=this._locateCalendar(e,t);n&&(n.className=(n.className||\"\").replace(RegExp(a,\"g\")))}},e._week_template=function(t){for(var a=t||250,n=0,i=document.createElement(\"div\"),r=this.date.week_start(e._currentDate()),d=0;7>d;d++)this._cols[d]=Math.floor(a/(7-d)),this._render_x_header(d,n,r,i),r=this.date.add(r,1,\"day\"),a-=this._cols[d],n+=this._cols[d];return i.lastChild.className+=\" dhx_scale_bar_last\",\r\ni},e.updateCalendar=function(e,t){e.conf.date=t,this.renderCalendar(e.conf,e,!0)},e._mini_cal_arrows=[\"&nbsp\",\"&nbsp\"],e._render_calendar=function(t,a,n,i){var r=e.templates,d=this._cols;this._cols=[];var l=this._mode;this._mode=\"calendar\";var o=this._colsS;this._colsS={height:0};var s=new Date(this._min_date),_=new Date(this._max_date),c=new Date(e._date),u=r.month_day,h=this._ignores_detected;this._ignores_detected=0,r.month_day=r.calendar_date,a=this.date.month_start(a);var p,v=this._week_template(t.offsetWidth-1-this.config.minicalendar.padding);\r\n\r\nif(i?p=i:(p=document.createElement(\"DIV\"),p.className=\"dhx_cal_container dhx_mini_calendar\"),p.setAttribute(\"date\",this.templates.xml_format(a)),p.innerHTML=\"<div class='dhx_year_month'></div><div class='dhx_year_week'>\"+v.innerHTML+\"</div><div class='dhx_year_body'></div>\",p.childNodes[0].innerHTML=this.templates.calendar_month(a),n.navigation)for(var m=function(t,a){var n=e.date.add(t._date,a,\"month\");e.updateCalendar(t,n),e._date.getMonth()==t._date.getMonth()&&e._date.getFullYear()==t._date.getFullYear()&&e._markCalendarCurrentDate(t);\r\n\r\n},g=[\"dhx_cal_prev_button\",\"dhx_cal_next_button\"],b=[\"left:1px;top:2px;position:absolute;\",\"left:auto; right:1px;top:2px;position:absolute;\"],f=[-1,1],y=function(t){return function(){if(n.sync)for(var a=e._synced_minicalendars,i=0;i<a.length;i++)m(a[i],t);else m(p,t)}},x=0;2>x;x++){var k=document.createElement(\"DIV\");k.className=g[x],k.style.cssText=b[x],k.innerHTML=this._mini_cal_arrows[x],p.firstChild.appendChild(k),k.onclick=y(f[x])}p._date=new Date(a),p.week_start=(a.getDay()-(this.config.start_on_monday?1:0)+7)%7;\r\n\r\nvar w=p._min_date=this.date.week_start(a);p._max_date=this.date.add(p._min_date,6,\"week\"),this._reset_month_scale(p.childNodes[2],a,w);for(var D=p.childNodes[2].firstChild.rows,E=D.length;6>E;E++){var M=D[D.length-1];D[0].parentNode.appendChild(M.cloneNode(!0));var S=parseInt(M.childNodes[M.childNodes.length-1].childNodes[0].innerHTML);S=10>S?S:0;for(var O=0;O<D[E].childNodes.length;O++)D[E].childNodes[O].className=\"dhx_after\",D[E].childNodes[O].childNodes[0].innerHTML=e.date.to_fixed(++S)}return i||t.appendChild(p),\r\np.childNodes[1].style.height=p.childNodes[1].childNodes[0].offsetHeight-1+\"px\",this._cols=d,this._mode=l,this._colsS=o,this._min_date=s,this._max_date=_,e._date=c,r.month_day=u,this._ignores_detected=h,p},e.destroyCalendar=function(t,a){!t&&this._def_count&&this._def_count.firstChild&&(a||(new Date).valueOf()-this._def_count._created.valueOf()>500)&&(t=this._def_count.firstChild),t&&(t.onclick=null,t.innerHTML=\"\",t.parentNode&&t.parentNode.removeChild(t),this._def_count&&(this._def_count.style.top=\"-1000px\"),\r\nt.conf&&t.conf._on_xle_handler&&e.detachEvent(t.conf._on_xle_handler))},e.isCalendarVisible=function(){return this._def_count&&parseInt(this._def_count.style.top,10)>0?this._def_count:!1},e._attach_minical_events=function(){dhtmlxEvent(document.body,\"click\",function(){e.destroyCalendar()}),e._attach_minical_events=function(){}},e.attachEvent(\"onTemplatesReady\",function(){e._attach_minical_events()}),e.templates.calendar_time=e.date.date_to_str(\"%d-%m-%Y\"),e.form_blocks.calendar_time={render:function(){\r\nvar t=\"<input class='dhx_readonly' type='text' readonly='true'>\",a=e.config,n=this.date.date_part(e._currentDate()),i=1440,r=0;a.limit_time_select&&(r=60*a.first_hour,i=60*a.last_hour+1),n.setHours(r/60),t+=\" <select>\";for(var d=r;i>d;d+=1*this.config.time_step){var l=this.templates.time_picker(n);t+=\"<option value='\"+d+\"'>\"+l+\"</option>\",n=this.date.add(n,this.config.time_step,\"minute\")}t+=\"</select>\";e.config.full_day;return\"<div style='height:30px;padding-top:0; font-size:inherit;' class='dhx_section_time'>\"+t+\"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>\"+t+\"</div>\";\r\n\r\n},set_value:function(t,a,n){function i(t,a,n){s(t,a,n),t.value=e.templates.calendar_time(a),t._date=e.date.date_part(new Date(a))}var r,d,l=t.getElementsByTagName(\"input\"),o=t.getElementsByTagName(\"select\"),s=function(t,a,n){t.onclick=function(){e.destroyCalendar(null,!0),e.renderCalendar({position:t,date:new Date(this._date),navigation:!0,handler:function(a){t.value=e.templates.calendar_time(a),t._date=new Date(a),e.destroyCalendar(),e.config.event_duration&&e.config.auto_end_date&&0===n&&h()}});\r\n\r\n}};if(e.config.full_day){if(!t._full_day){var _=\"<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> \"+e.locale.labels.full_day+\"&nbsp;</label></input>\";e.config.wide_form||(_=t.previousSibling.innerHTML+_),t.previousSibling.innerHTML=_,t._full_day=!0}var c=t.previousSibling.getElementsByTagName(\"input\")[0],u=0===e.date.time_part(n.start_date)&&0===e.date.time_part(n.end_date);c.checked=u,o[0].disabled=c.checked,o[1].disabled=c.checked,c.onclick=function(){if(c.checked===!0){\r\nvar a={};e.form_blocks.calendar_time.get_value(t,a),r=e.date.date_part(a.start_date),d=e.date.date_part(a.end_date),(+d==+r||+d>=+r&&(0!==n.end_date.getHours()||0!==n.end_date.getMinutes()))&&(d=e.date.add(d,1,\"day\"))}var s=r||n.start_date,_=d||n.end_date;i(l[0],s),i(l[1],_),o[0].value=60*s.getHours()+s.getMinutes(),o[1].value=60*_.getHours()+_.getMinutes(),o[0].disabled=c.checked,o[1].disabled=c.checked}}if(e.config.event_duration&&e.config.auto_end_date){var h=function(){r=e.date.add(l[0]._date,o[0].value,\"minute\"),\r\nd=new Date(r.getTime()+60*e.config.event_duration*1e3),l[1].value=e.templates.calendar_time(d),l[1]._date=e.date.date_part(new Date(d)),o[1].value=60*d.getHours()+d.getMinutes()};o[0].onchange=h}i(l[0],n.start_date,0),i(l[1],n.end_date,1),s=function(){},o[0].value=60*n.start_date.getHours()+n.start_date.getMinutes(),o[1].value=60*n.end_date.getHours()+n.end_date.getMinutes()},get_value:function(t,a){var n=t.getElementsByTagName(\"input\"),i=t.getElementsByTagName(\"select\");return a.start_date=e.date.add(n[0]._date,i[0].value,\"minute\"),\r\na.end_date=e.date.add(n[1]._date,i[1].value,\"minute\"),a.end_date<=a.start_date&&(a.end_date=e.date.add(a.start_date,e.config.time_step,\"minute\")),{start_date:new Date(a.start_date),end_date:new Date(a.end_date)}},focus:function(e){}},e.linkCalendar=function(t,a){var n=function(){var n=e._date,i=new Date(n.valueOf());return a&&(i=a(i)),i.setDate(1),e.updateCalendar(t,i),!0};e.attachEvent(\"onViewChange\",n),e.attachEvent(\"onXLE\",n),e.attachEvent(\"onEventAdded\",n),e.attachEvent(\"onEventChanged\",n),e.attachEvent(\"onAfterEventDelete\",n),\r\nn()},e._markCalendarCurrentDate=function(t){var a=e._date,n=e._mode,i=e.date.month_start(new Date(t._date)),r=e.date.add(i,1,\"month\");if(\"day\"==n||this._props&&this._props[n])i.valueOf()<=a.valueOf()&&r>a&&e.markCalendar(t,a,\"dhx_calendar_click\");else if(\"week\"==n)for(var d=e.date.week_start(new Date(a.valueOf())),l=0;7>l;l++)i.valueOf()<=d.valueOf()&&r>d&&e.markCalendar(t,d,\"dhx_calendar_click\"),d=e.date.add(d,1,\"day\")},e.attachEvent(\"onEventCancel\",function(){e.destroyCalendar(null,!0)})});\r\n//# sourceMappingURL=../sources/ext/dhtmlxscheduler_minical.js.map"

/***/ },
/* 18 */
/*!***************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_timeline.js ***!
  \***************************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_timeline.js */ 19)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_timeline.js")

/***/ },
/* 19 */
/*!************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!C:/building/src/main/webapp/resources/WebContent/codebase/dhtmlxscheduler_timeline.js ***!
  \************************************************************************************************************************************************/
/***/ function(module, exports) {

	module.exports = "/*\r\n@license\r\ndhtmlxScheduler v.4.3.1 \r\n\r\nThis software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n\r\n(c) Dinamenta, UAB.\r\n*/\r\nScheduler.plugin(function(e){e._temp_matrix_scope=function(){function t(){for(var t=e.get_visible_events(),a=[],n=0;n<this.y_unit.length;n++)a[n]=[];a[i]||(a[i]=[]);for(var n=0;n<t.length;n++){for(var i=this.order[t[n][this.y_property]],r=0;this._trace_x[r+1]&&t[n].start_date>=this._trace_x[r+1];)r++;for(;this._trace_x[r]&&t[n].end_date>this._trace_x[r];)a[i][r]||(a[i][r]=[]),a[i][r].push(t[n]),r++}return a}function a(t,a,n){var i=0,r=n._step,d=n.round_position,l=0,o=a?t.end_date:t.start_date;o.valueOf()>e._max_date.valueOf()&&(o=e._max_date);\r\n\r\nvar s=o-e._min_date_timeline;if(s>0){var _=e._get_date_index(n,o);e._ignores[_]&&(d=!0);for(var c=0;_>c;c++)i+=e._cols[c];var u=e.date.add(e._min_date_timeline,e.matrix[e._mode].x_step*_,e.matrix[e._mode].x_unit);d?+o>+u&&a&&(l=e._cols[_]):(s=o-u,n.first_hour||n.last_hour?(s-=n._start_correction,0>s&&(s=0),l=Math.round(s/r),l>e._cols[_]&&(l=e._cols[_])):l=Math.round(s/r))}return i+=a?0===s||d?l-14:l-12:l+1}function n(t,a){var n=e._get_date_index(this,t),i=this._trace_x[n];return a&&+t!=+this._trace_x[n]&&(i=this._trace_x[n+1]?this._trace_x[n+1]:e.date.add(this._trace_x[n],this.x_step,this.x_unit)),\r\nnew Date(i)}function i(t){if(e._ignores_detected)for(var a,n,i,r,d=0;d<t.length;d++){for(r=t[d],i=!1,a=e._get_date_index(this,r.start_date),n=e._get_date_index(this,r.end_date);n>a;){if(!e._ignores[a]){i=!0;break}a++}i||a!=n||e._ignores[n]||+r.end_date>+this._trace_x[n]&&(i=!0),i||(t.splice(d,1),d--)}}function r(t){var a=\"\";if(t&&\"cell\"!=this.render){i.call(this,t),t.sort(this.sort||function(e,t){return e.start_date.valueOf()==t.start_date.valueOf()?e.id>t.id?1:-1:e.start_date>t.start_date?1:-1});\r\n\r\nfor(var r=[],d=t.length,l=0;d>l;l++){var o=t[l];o._inner=!1;var s=this.round_position?n.apply(this,[o.start_date,!1]):o.start_date;for(this.round_position?n.apply(this,[o.end_date,!0]):o.end_date;r.length;){var _=r[r.length-1];if(!(_.end_date.valueOf()<=s.valueOf()))break;r.splice(r.length-1,1)}for(var c=!1,u=0;u<r.length;u++){var h=r[u];if(h.end_date.valueOf()<=s.valueOf()){c=!0,o._sorder=h._sorder,r.splice(u,1),o._inner=!0;break}}if(r.length&&(r[r.length-1]._inner=!0),!c)if(r.length)if(r.length<=r[r.length-1]._sorder){\r\nif(r[r.length-1]._sorder)for(var p=0;p<r.length;p++){for(var v=!1,m=0;m<r.length;m++)if(r[m]._sorder==p){v=!0;break}if(!v){o._sorder=p;break}}else o._sorder=0;o._inner=!0}else{for(var g=r[0]._sorder,f=1;f<r.length;f++)r[f]._sorder>g&&(g=r[f]._sorder);o._sorder=g+1,o._inner=!1}else o._sorder=0;r.push(o),r.length>(r.max_count||0)?(r.max_count=r.length,o._count=r.length):o._count=o._count?o._count:1}for(var b=0;b<t.length;b++)t[b]._count=r.max_count;for(var y=0;d>y;y++)a+=e.render_timeline_event.call(this,t[y],!1);\r\n\r\n}return a}function d(a){var n=\"<table style='table-layout:fixed;' cellspacing='0' cellpadding='0'>\",i=[];if(e._load_mode&&e._load(),\"cell\"==this.render)i=t.call(this);else for(var d=e.get_visible_events(),l=this.order,o=0;o<d.length;o++){var s=d[o],_=s[this.y_property],c=this.order[_];if(this.show_unassigned&&!_){for(var u in l)if(l.hasOwnProperty(u)){c=l[u],i[c]||(i[c]=[]);var h=e._lame_copy({},s);h[this.y_property]=u,i[c].push(h)}}else i[c]||(i[c]=[]),i[c].push(s)}for(var p=0,v=0;v<e._cols.length;v++)p+=e._cols[v];\r\n\r\nvar m=new Date,g=e._cols.length-e._ignores_detected;m=(e.date.add(m,this.x_step*g,this.x_unit)-m-(this._start_correction+this._end_correction)*g)/p,this._step=m,this._summ=p;var f=e._colsS.heights=[],b=[];this._events_height={},this._section_height={};for(var v=0;v<this.y_unit.length;v++){var y=this._logic(this.render,this.y_unit[v],this);e._merge(y,{height:this.dy}),this.section_autoheight&&(this.y_unit.length*y.height<a.offsetHeight&&(y.height=Math.max(y.height,Math.floor((a.offsetHeight-1)/this.y_unit.length))),\r\nthis._section_height[this.y_unit[v].key]=y.height),y.td_className||(y.td_className=\"dhx_matrix_scell\"+(e.templates[this.name+\"_scaley_class\"](this.y_unit[v].key,this.y_unit[v].label,this.y_unit[v])?\" \"+e.templates[this.name+\"_scaley_class\"](this.y_unit[v].key,this.y_unit[v].label,this.y_unit[v]):\"\")),y.td_content||(y.td_content=e.templates[this.name+\"_scale_label\"](this.y_unit[v].key,this.y_unit[v].label,this.y_unit[v])),e._merge(y,{tr_className:\"\",style_height:\"height:\"+y.height+\"px;\",style_width:\"width:\"+(this.dx-1)+\"px;\",\r\nsumm_width:\"width:\"+p+\"px;\",table_className:\"\"});var x=r.call(this,i[v]);if(this.fit_events){var k=this._events_height[this.y_unit[v].key]||0;y.height=k>y.height?k:y.height,y.style_height=\"height:\"+y.height+\"px;\",this._section_height[this.y_unit[v].key]=y.height}if(n+=\"<tr class='\"+y.tr_className+\"' style='\"+y.style_height+\"'><td class='\"+y.td_className+\"' style='\"+y.style_width+\" height:\"+(y.height-1)+\"px;'>\"+y.td_content+\"</td>\",\"cell\"==this.render)for(var o=0;o<e._cols.length;o++)n+=e._ignores[o]?\"<td></td>\":\"<td class='dhx_matrix_cell \"+e.templates[this.name+\"_cell_class\"](i[v][o],this._trace_x[o],this.y_unit[v])+\"' style='width:\"+(e._cols[o]-1)+\"px'><div style='width:\"+(e._cols[o]-1)+\"px'>\"+e.templates[this.name+\"_cell_value\"](i[v][o],this._trace_x[o],this.y_unit[v])+\"</div></td>\";\r\nelse{n+=\"<td><div style='\"+y.summ_width+\" \"+y.style_height+\" position:relative;' class='dhx_matrix_line'>\",n+=x,n+=\"<table class='\"+y.table_className+\"' cellpadding='0' cellspacing='0' style='\"+y.summ_width+\" \"+y.style_height+\"' >\";for(var o=0;o<e._cols.length;o++)n+=e._ignores[o]?\"<td></td>\":\"<td class='dhx_matrix_cell \"+e.templates[this.name+\"_cell_class\"](i[v],this._trace_x[o],this.y_unit[v])+\"' style='width:\"+(e._cols[o]-1)+\"px'><div style='width:\"+(e._cols[o]-1)+\"px'></div></td>\";n+=\"</table>\",\r\nn+=\"</div></td>\"}n+=\"</tr>\",b.push(y)}n+=\"</table>\",this._matrix=i,a.innerHTML=n,e._rendered=[];for(var w=e._obj.getElementsByTagName(\"DIV\"),v=0;v<w.length;v++)w[v].getAttribute(\"event_id\")&&e._rendered.push(w[v]);this._scales={};for(var D=a.firstChild.rows,E=null,v=0,M=b.length;M>v;v++){E=this.y_unit[v],f.push(b[v].height);var S=E.key,N=this._scales[S]=e._isRender(\"cell\")?D[v]:D[v].childNodes[1].getElementsByTagName(\"div\")[0];e.callEvent(\"onScaleAdd\",[N,S])}}function l(t){var a=e._min_date,n=e._max_date;\r\n\r\ne._process_ignores(a,this.x_size,this.x_unit,this.x_step,t);for(var i=(this.x_size+(t?e._ignores_detected:0),0),r=0;+n>+a;)if(this._trace_x[r]=new Date(a),a=e.date.add(a,this.x_step,this.x_unit),e.date[this.x_unit+\"_start\"]&&(a=e.date[this.x_unit+\"_start\"](a)),e._ignores[r]||i++,r++,t)if(i<this.x_size&&!(+n>+a))n=e.date[\"add_\"+this.name+\"_private\"](n,(this.x_length||this.x_size)*this.x_step);else if(i>=this.x_size){e._max_date=a;break}return{total:r,displayed:i}}function o(t){var a=e.xy.scale_height,n=this._header_resized||e.xy.scale_height;\r\n\r\ne._cols=[],e._colsS={height:0},this._trace_x=[];var i=e._x-this.dx-e.xy.scroll_width,r=[this.dx],d=e._els.dhx_cal_header[0];d.style.width=r[0]+i+\"px\";for(var o=e._min_date_timeline=e._min_date,_=e.config.preserve_scale_length,c=l.call(this,_),u=c.displayed,h=c.total,v=0;h>v;v++)e._ignores[v]?(e._cols[v]=0,u++):e._cols[v]=Math.floor(i/(u-v)),i-=e._cols[v],r[v+1]=r[v]+e._cols[v];if(t.innerHTML=\"<div></div>\",this.second_scale){for(var m=this.second_scale.x_unit,g=[this._trace_x[0]],f=[],b=[this.dx,this.dx],y=0,x=0;x<this._trace_x.length;x++){\r\nvar k=this._trace_x[x],w=s(m,k,g[y]);w&&(++y,g[y]=k,b[y+1]=b[y]);var D=y+1;f[y]=e._cols[x]+(f[y]||0),b[D]+=e._cols[x]}t.innerHTML=\"<div></div><div></div>\";var E=t.firstChild;E.style.height=n+\"px\";var M=t.lastChild;M.style.position=\"relative\";for(var S=0;S<g.length;S++){var N=g[S],O=e.templates[this.name+\"_second_scalex_class\"](N),T=document.createElement(\"DIV\");T.className=\"dhx_scale_bar dhx_second_scale_bar\"+(O?\" \"+O:\"\"),e.set_xy(T,f[S]-1,n-3,b[S],0),T.innerHTML=e.templates[this.name+\"_second_scale_date\"](N),\r\nE.appendChild(T)}}e.xy.scale_height=n,t=t.lastChild;for(var C=0;C<this._trace_x.length;C++)if(!e._ignores[C]){o=this._trace_x[C],e._render_x_header(C,r[C],o,t);var L=e.templates[this.name+\"_scalex_class\"](o);L&&(t.lastChild.className+=\" \"+L)}e.xy.scale_height=a;var A=this._trace_x;t.onclick=function(t){var a=p(t);a&&e.callEvent(\"onXScaleClick\",[a.x,A[a.x],t||event])},t.ondblclick=function(t){var a=p(t);a&&e.callEvent(\"onXScaleDblClick\",[a.x,A[a.x],t||event])}}function s(t,a,n){switch(t){case\"hour\":\r\nreturn a.getHours()!=n.getHours()||s(\"day\",a,n);case\"day\":return!(a.getDate()==n.getDate()&&a.getMonth()==n.getMonth()&&a.getFullYear()==n.getFullYear());case\"week\":return!(e.date.getISOWeek(a)==e.date.getISOWeek(n)&&a.getFullYear()==n.getFullYear());case\"month\":return!(a.getMonth()==n.getMonth()&&a.getFullYear()==n.getFullYear());case\"year\":return!(a.getFullYear()==n.getFullYear());default:return!1}}function _(t){if(t){e.set_sizes(),e._init_matrix_tooltip();var a=e._min_date;o.call(this,e._els.dhx_cal_header[0]),\r\nd.call(this,e._els.dhx_cal_data[0]),e._min_date=a,e._els.dhx_cal_date[0].innerHTML=e.templates[this.name+\"_date\"](e._min_date,e._max_date),e._mark_now&&e._mark_now()}c()}function c(){e._tooltip&&(e._tooltip.style.display=\"none\",e._tooltip.date=\"\")}function u(t,a,n){if(\"cell\"==t.render){var i=a.x+\"_\"+a.y,r=t._matrix[a.y][a.x];if(!r)return c();if(r.sort(function(e,t){return e.start_date>t.start_date?1:-1}),e._tooltip){if(e._tooltip.date==i)return;e._tooltip.innerHTML=\"\"}else{var d=e._tooltip=document.createElement(\"DIV\");\r\n\r\nd.className=\"dhx_year_tooltip\",document.body.appendChild(d),d.onclick=e._click.dhx_cal_data}for(var l=\"\",o=0;o<r.length;o++){var s=r[o].color?\"background-color:\"+r[o].color+\";\":\"\",_=r[o].textColor?\"color:\"+r[o].textColor+\";\":\"\";l+=\"<div class='dhx_tooltip_line' event_id='\"+r[o].id+\"' style='\"+s+_+\"'>\",l+=\"<div class='dhx_tooltip_date'>\"+(r[o]._timed?e.templates.event_date(r[o].start_date):\"\")+\"</div>\",l+=\"<div class='dhx_event_icon icon_details'>&nbsp;</div>\",l+=e.templates[t.name+\"_tooltip\"](r[o].start_date,r[o].end_date,r[o])+\"</div>\";\r\n\r\n}e._tooltip.style.display=\"\",e._tooltip.style.top=\"0px\",document.body.offsetWidth-n.left-e._tooltip.offsetWidth<0?e._tooltip.style.left=n.left-e._tooltip.offsetWidth+\"px\":e._tooltip.style.left=n.left+a.src.offsetWidth+\"px\",e._tooltip.date=i,e._tooltip.innerHTML=l,document.body.offsetHeight-n.top-e._tooltip.offsetHeight<0?e._tooltip.style.top=n.top-e._tooltip.offsetHeight+a.src.offsetHeight+\"px\":e._tooltip.style.top=n.top+\"px\"}}function h(e){for(var t=e.parentNode.childNodes,a=0;a<t.length;a++)if(t[a]==e)return a;\r\n\r\nreturn-1}function p(e){e=e||event;for(var t=e.target?e.target:e.srcElement;t&&\"DIV\"!=t.tagName;)t=t.parentNode;if(t&&\"DIV\"==t.tagName){var a=t.className.split(\" \")[0];if(\"dhx_scale_bar\"==a)return{x:h(t),y:-1,src:t,scale:!0}}}e.matrix={},e._merge=function(e,t){for(var a in t)\"undefined\"==typeof e[a]&&(e[a]=t[a])},e.createTimelineView=function(t){e._skin_init(),e._merge(t,{section_autoheight:!0,name:\"matrix\",x:\"time\",y:\"time\",x_step:1,x_unit:\"hour\",y_unit:\"day\",y_step:1,x_start:0,x_size:24,y_start:0,\r\ny_size:7,render:\"cell\",dx:200,dy:50,event_dy:e.xy.bar_height-5,event_min_dy:e.xy.bar_height-5,resize_events:!0,fit_events:!0,show_unassigned:!1,second_scale:!1,round_position:!1,_logic:function(t,a,n){var i={};return e.checkEvent(\"onBeforeSectionRender\")&&(i=e.callEvent(\"onBeforeSectionRender\",[t,a,n])),i}}),t._original_x_start=t.x_start,\"day\"!=t.x_unit&&(t.first_hour=t.last_hour=0),t._start_correction=t.first_hour?60*t.first_hour*60*1e3:0,t._end_correction=t.last_hour?60*(24-t.last_hour)*60*1e3:0,\r\ne.checkEvent(\"onTimelineCreated\")&&e.callEvent(\"onTimelineCreated\",[t]);var a=e.render_data;e.render_data=function(n,i){if(this._mode!=t.name)return a.apply(this,arguments);if(i&&!t.show_unassigned&&\"cell\"!=t.render)for(var r=0;r<n.length;r++)this.clear_event(n[r]),this.render_timeline_event.call(this.matrix[this._mode],n[r],!0);else e._renderMatrix.call(t,!0,!0)},e.matrix[t.name]=t,e.templates[t.name+\"_cell_value\"]=function(e){return e?e.length:\"\"},e.templates[t.name+\"_cell_class\"]=function(e){return\"\";\r\n\r\n},e.templates[t.name+\"_scalex_class\"]=function(e){return\"\"},e.templates[t.name+\"_second_scalex_class\"]=function(e){return\"\"},e.templates[t.name+\"_scaley_class\"]=function(e,t,a){return\"\"},e.templates[t.name+\"_scale_label\"]=function(e,t,a){return t},e.templates[t.name+\"_tooltip\"]=function(e,t,a){return a.text},e.templates[t.name+\"_date\"]=function(t,a){return t.getDay()==a.getDay()&&864e5>a-t||+t==+e.date.date_part(new Date(a))||+e.date.add(t,1,\"day\")==+a&&0===a.getHours()&&0===a.getMinutes()?e.templates.day_date(t):t.getDay()!=a.getDay()&&864e5>a-t?e.templates.day_date(t)+\" &ndash; \"+e.templates.day_date(a):e.templates.week_date(t,a);\r\n\r\n},e.templates[t.name+\"_scale_date\"]=e.date.date_to_str(t.x_date||e.config.hour_date),e.templates[t.name+\"_second_scale_date\"]=e.date.date_to_str(t.second_scale&&t.second_scale.x_date?t.second_scale.x_date:e.config.hour_date),e.date[\"add_\"+t.name+\"_private\"]=function(a,n){var i=n,r=t.x_unit;if(\"minute\"==t.x_unit||\"hour\"==t.x_unit){var d=i;\"hour\"==t.x_unit&&(d*=60),d%1440||(i=d/1440,r=\"day\")}return e.date.add(a,i,r)},e.date[\"add_\"+t.name]=function(a,n,i){var r=e.date[\"add_\"+t.name+\"_private\"](a,(t.x_length||t.x_size)*t.x_step*n);\r\n\r\nif(\"minute\"==t.x_unit||\"hour\"==t.x_unit){var d=t.x_length||t.x_size,l=\"hour\"==t.x_unit?60*t.x_step:t.x_step;if(l*d%1440)if(+e.date.date_part(new Date(a))==+e.date.date_part(new Date(r)))t.x_start+=n*d;else{var o=1440/(d*l)-1,s=Math.round(o*d);n>0?t.x_start=t.x_start-s:t.x_start=s+t.x_start}}return r},e.date[t.name+\"_start\"]=function(a){var n=e.date[t.x_unit+\"_start\"]||e.date.day_start,i=n.call(e.date,a);return i=e.date.add(i,t.x_step*t.x_start,t.x_unit)},e.callEvent(\"onOptionsLoad\",[t]),e[t.name+\"_view\"]=function(a){\r\na?e._set_timeline_dates(t):e._renderMatrix.apply(t,arguments)};{var i=new Date;e.date.add(i,t.x_step,t.x_unit).valueOf()-i.valueOf()}e[\"mouse_\"+t.name]=function(a){var i=this._drag_event;this._drag_id&&(i=this.getEvent(this._drag_id)),this._drag_pos&&this._is_pos_changed(this._drag_pos,a)&&(this._drag_event._dhx_changed=!0),a.x-=t.dx;var r=e._timeline_drag_date(t,a.x);if(a.x=0,a.force_redraw=!0,a.custom=!0,\"move\"==this._drag_mode&&this._drag_id&&this._drag_event){var i=this.getEvent(this._drag_id),d=this._drag_event;\r\n\r\nif(a._ignores=this._ignores_detected||t._start_correction||t._end_correction,void 0===d._move_delta&&(d._move_delta=(i.start_date-r)/6e4,this.config.preserve_length&&a._ignores&&(d._move_delta=this._get_real_event_length(i.start_date,r,t),d._event_length=this._get_real_event_length(i.start_date,i.end_date,t))),this.config.preserve_length&&a._ignores){var l=(d._event_length,this._get_fictional_event_length(r,d._move_delta,t,!0));r=new Date(r-l)}else r=e.date.add(r,d._move_delta,\"minute\")}if(\"resize\"==this._drag_mode&&i&&(this._drag_from_start&&+r>+i.end_date?this._drag_from_start=!1:!this._drag_from_start&&+r<+i.start_date&&(this._drag_from_start=!0),\r\na.resize_from_start=this._drag_from_start),t.round_position)switch(this._drag_mode){case\"move\":this.config.preserve_length||(r=n.call(t,r,!1),\"day\"==t.x_unit&&(a.custom=!1));break;case\"resize\":this._drag_event&&((null===this._drag_event._resize_from_start||void 0===this._drag_event._resize_from_start)&&(this._drag_event._resize_from_start=a.resize_from_start),a.resize_from_start=this._drag_event._resize_from_start,r=n.call(t,r,!this._drag_event._resize_from_start))}return this._resolve_timeline_section(t,a),\r\na.section&&this._update_timeline_section({pos:a,event:this.getEvent(this._drag_id),view:t}),a.y=Math.round((this._correct_shift(r,1)-this._min_date)/(6e4*this.config.time_step)),a.shift=this.config.time_step,a}},e._get_timeline_event_height=function(e,t){var a=e[t.y_property],n=t.event_dy;return\"full\"==t.event_dy&&(n=t.section_autoheight?t._section_height[a]-6:t.dy-3),t.resize_events&&(n=Math.max(Math.floor(n/e._count),t.event_min_dy)),n},e._get_timeline_event_y=function(t,a){var n=t,i=2+n*a+(n?2*n:0);\r\n\r\nreturn e.config.cascade_event_display&&(i=2+n*e.config.cascade_event_margin+(n?2*n:0)),i},e.render_timeline_event=function(t,n){var i=t[this.y_property];if(!i)return\"\";var r=t._sorder,d=a(t,!1,this),l=a(t,!0,this),o=e._get_timeline_event_height(t,this),s=o-2;t._inner||\"full\"!=this.event_dy||(s=(s+2)*(t._count-r)-2);var _=e._get_timeline_event_y(t._sorder,o),c=o+_+2;(!this._events_height[i]||this._events_height[i]<c)&&(this._events_height[i]=c);var u=e.templates.event_class(t.start_date,t.end_date,t);\r\n\r\nu=\"dhx_cal_event_line \"+(u||\"\"),t._no_drag_move&&(u+=\" no_drag_move\");var h=t.color?\"background:\"+t.color+\";\":\"\",p=t.textColor?\"color:\"+t.textColor+\";\":\"\",v=e.templates.event_bar_text(t.start_date,t.end_date,t),m='<div event_id=\"'+t.id+'\" class=\"'+u+'\" style=\"'+h+p+\"position:absolute; top:\"+_+\"px; height: \"+s+\"px; left:\"+d+\"px; width:\"+Math.max(0,l-d)+\"px;\"+(t._text_style||\"\")+'\">';if(e.config.drag_resize&&!e.config.readonly){var g=\"dhx_event_resize\",f=\"<div class='\"+g+\" \"+g+\"_start' style='height: \"+s+\"px;'></div>\",b=\"<div class='\"+g+\" \"+g+\"_end' style='height: \"+s+\"px;'></div>\";\r\n\r\nm+=(t._no_resize_start?\"\":f)+(t._no_resize_end?\"\":b)}if(m+=v+\"</div>\",!n)return m;var y=document.createElement(\"DIV\");y.innerHTML=m;var x=this.order[i],k=e._els.dhx_cal_data[0].firstChild.rows[x].cells[1].firstChild;e._rendered.push(y.firstChild),k.appendChild(y.firstChild)},e._matrix_tooltip_handler=function(t){var a=e.matrix[e._mode];if(a&&\"cell\"==a.render){if(a){{var n=e._locate_cell_timeline(t),t=t||event;t.target||t.srcElement}if(n)return u(a,n,getOffset(n.src))}c()}},e._init_matrix_tooltip=function(){\r\ne._detachDomEvent(e._els.dhx_cal_data[0],\"mouseover\",e._matrix_tooltip_handler),dhtmlxEvent(e._els.dhx_cal_data[0],\"mouseover\",e._matrix_tooltip_handler)},e._set_timeline_dates=function(t){e._min_date=e.date[t.name+\"_start\"](new Date(e._date)),e._max_date=e.date[\"add_\"+t.name+\"_private\"](e._min_date,t.x_size*t.x_step),e.date[t.x_unit+\"_start\"]&&(e._max_date=e.date[t.x_unit+\"_start\"](e._max_date)),e._table_view=!0},e._renderMatrix=function(t,a){if(a||(e._els.dhx_cal_data[0].scrollTop=0),e._set_timeline_dates(this),\r\nthis.second_scale&&(t&&!this._header_resized&&(this._header_resized=e.xy.scale_height,e.xy.scale_height*=2,e._els.dhx_cal_header[0].className+=\" dhx_second_cal_header\"),!t&&this._header_resized)){e.xy.scale_height/=2,this._header_resized=!1;var n=e._els.dhx_cal_header[0];n.className=n.className.replace(/ dhx_second_cal_header/gi,\"\")}_.call(this,t)},e._locate_cell_timeline=function(t){t=t||event;for(var a=t.target?t.target:t.srcElement,n={},i=e.matrix[e._mode],r=e.getActionData(t),d=0;d<i._trace_x.length-1&&!(+r.date<i._trace_x[d+1]);d++);\r\nn.x=d,n.y=i.order[r.section];var l=e._isRender(\"cell\")?1:0;n.src=i._scales[r.section]?i._scales[r.section].getElementsByTagName(\"td\")[d+l]:null;for(var o=!1;0===n.x&&\"dhx_cal_data\"!=a.className&&a.parentNode;){if(\"dhx_matrix_scell\"==a.className.split(\" \")[0]){o=!0;break}a=a.parentNode}return o&&(n.x=-1,n.src=a,n.scale=!0),n};var v=e._click.dhx_cal_data;e._click.dhx_marked_timespan=e._click.dhx_cal_data=function(t){var a=v.apply(this,arguments),n=e.matrix[e._mode];if(n){var i=e._locate_cell_timeline(t);\r\n\r\ni&&(i.scale?e.callEvent(\"onYScaleClick\",[i.y,n.y_unit[i.y],t||event]):e.callEvent(\"onCellClick\",[i.x,i.y,n._trace_x[i.x],(n._matrix[i.y]||{})[i.x]||[],t||event]))}return a},e.dblclick_dhx_matrix_cell=function(t){var a=e.matrix[e._mode];if(a){var n=e._locate_cell_timeline(t);n&&(n.scale?e.callEvent(\"onYScaleDblClick\",[n.y,a.y_unit[n.y],t||event]):e.callEvent(\"onCellDblClick\",[n.x,n.y,a._trace_x[n.x],(a._matrix[n.y]||{})[n.x]||[],t||event]))}};var m=e.dblclick_dhx_marked_timespan||function(){};e.dblclick_dhx_marked_timespan=function(t){\r\nvar a=e.matrix[e._mode];return a?e.dblclick_dhx_matrix_cell(t):m.apply(this,arguments)},e.dblclick_dhx_matrix_scell=function(t){return e.dblclick_dhx_matrix_cell(t)},e._isRender=function(t){return e.matrix[e._mode]&&e.matrix[e._mode].render==t},e.attachEvent(\"onCellDblClick\",function(t,a,n,i,r){if(!this.config.readonly&&(\"dblclick\"!=r.type||this.config.dblclick_create)){var d=e.matrix[e._mode],l={};l.start_date=d._trace_x[t],l.end_date=d._trace_x[t+1]?d._trace_x[t+1]:e.date.add(d._trace_x[t],d.x_step,d.x_unit),\r\nd._start_correction&&(l.start_date=new Date(1*l.start_date+d._start_correction)),d._end_correction&&(l.end_date=new Date(l.end_date-d._end_correction)),l[d.y_property]=d.y_unit[a].key,e.addEventNow(l,null,r)}}),e.attachEvent(\"onBeforeDrag\",function(t,a,n){return!e._isRender(\"cell\")}),e.attachEvent(\"onEventChanged\",function(e,t){t._timed=this.isOneDayEvent(t)}),e.attachEvent(\"onBeforeEventChanged\",function(t,a,n,i){return e._events[t.id]&&(t._move_delta=void 0),!0}),e._is_column_visible=function(t){\r\nvar a=e.matrix[e._mode],n=e._get_date_index(a,t);return!e._ignores[n]};var g=e._render_marked_timespan;e._render_marked_timespan=function(t,n,i,r,d){if(!e.config.display_marked_timespans)return[];if(e.matrix&&e.matrix[e._mode]){if(e._isRender(\"cell\"))return;var l=e._lame_copy({},e.matrix[e._mode]);l.round_position=!1;var o=[],s=[],_=[],c=t.sections?t.sections.units||t.sections.timeline:null;if(i)_=[n],s=[i];else{var u=l.order;if(c)u.hasOwnProperty(c)&&(s.push(c),_.push(l._scales[c]));else for(var h in u)u.hasOwnProperty(h)&&(s.push(h),\r\n_.push(l._scales[h]))}var r=r?new Date(r):e._min_date,d=d?new Date(d):e._max_date;r.valueOf()<e._min_date.valueOf()&&(r=new Date(e._min_date)),d.valueOf()>e._max_date.valueOf()&&(d=new Date(e._max_date));for(var p=0;p<l._trace_x.length&&!e._is_column_visible(l._trace_x[p]);p++);if(p==l._trace_x.length)return;var v=[];if(t.days>6){var m=new Date(t.days);e.date.date_part(new Date(r))<=+m&&+d>=+m&&v.push(m)}else v.push.apply(v,e._get_dates_by_index(t.days));for(var f=t.zones,b=e._get_css_classes_by_config(t),y=0;y<s.length;y++){\r\nn=_[y],i=s[y];for(var p=0;p<v.length;p++)for(var x=v[p],k=0;k<f.length;k+=2){var w=f[k],D=f[k+1],E=new Date(+x+60*w*1e3),M=new Date(+x+60*D*1e3);if(M>r&&d>E){var S=e._get_block_by_config(t);S.className=b;var N=a({start_date:E},!1,l)-1,O=a({start_date:M},!1,l)-1,T=Math.max(1,O-N-1),C=l._section_height[i]-1;S.style.cssText=\"height: \"+C+\"px; left: \"+N+\"px; width: \"+T+\"px; top: 0;\",n.insertBefore(S,n.firstChild),o.push(S)}}}return o}return g.apply(e,[t,n,i])};var f=e._append_mark_now;e._append_mark_now=function(t,a){\r\nif(e.matrix&&e.matrix[e._mode]){var n=e._currentDate(),i=e._get_zone_minutes(n),r={days:+e.date.date_part(n),zones:[i,i+1],css:\"dhx_matrix_now_time\",type:\"dhx_now_time\"};return e._render_marked_timespan(r)}return f.apply(e,[t,a])},e.attachEvent(\"onScaleAdd\",function(t,a){var n=e._marked_timespans;if(n&&e.matrix&&e.matrix[e._mode])for(var i=e._mode,r=e._min_date,d=e._max_date,l=n.global,o=e.date.date_part(new Date(r));d>o;o=e.date.add(o,1,\"day\")){var s=+o,_=o.getDay(),c=[],u=l[s]||l[_];if(c.push.apply(c,e._get_configs_to_render(u)),\r\nn[i]&&n[i][a]){var h=[],p=e._get_types_to_render(n[i][a][_],n[i][a][s]);h.push.apply(h,e._get_configs_to_render(p)),h.length&&(c=h)}for(var v=0;v<c.length;v++){var m=c[v],g=m.days;7>g?(g=s,e._render_marked_timespan(m,t,a,o,e.date.add(o,1,\"day\")),g=_):e._render_marked_timespan(m,t,a,o,e.date.add(o,1,\"day\"))}}}),e._resolve_timeline_section=function(e,t){var a=0,n=0;for(a;a<this._colsS.heights.length&&(n+=this._colsS.heights[a],!(n>t.y));a++);e.y_unit[a]||(a=e.y_unit.length-1),this._drag_event&&!this._drag_event._orig_section&&(this._drag_event._orig_section=e.y_unit[a].key),\r\nt.fields={},a>=0&&e.y_unit[a]&&(t.section=t.fields[e.y_property]=e.y_unit[a].key)},e._update_timeline_section=function(e){var t=e.view,a=e.event,n=e.pos;if(a){if(a[t.y_property]!=n.section){var i=this._get_timeline_event_height(a,t);a._sorder=this._get_dnd_order(a._sorder,i,t._section_height[n.section])}a[t.y_property]=n.section}},e._get_date_index=function(e,t){for(var a=0,n=e._trace_x;a<n.length-1&&+t>=+n[a+1];)a++;return a},e._timeline_drag_date=function(t,a){var n,i,r=t,d={x:a},l=0,o=0;for(o;o<=this._cols.length-1;o++)if(i=this._cols[o],\r\nl+=i,l>d.x){n=(d.x-(l-i))/i,n=0>n?0:n;break}if(r.round_position){var s=1;e.getState().drag_mode&&\"move\"!=e.getState().drag_mode&&(s=.5),n>=s&&o++,n=0}if(0===o&&this._ignores[0])for(o=1,n=0;this._ignores[o];)o++;else if(o==this._cols.length&&this._ignores[o-1]){for(o=this._cols.length-1,n=0;this._ignores[o];)o--;o++}var _;if(o>=r._trace_x.length)_=e.date.add(r._trace_x[r._trace_x.length-1],r.x_step,r.x_unit),r._end_correction&&(_=new Date(_-r._end_correction));else{var c=n*i*r._step+r._start_correction;\r\n\r\n_=new Date(+r._trace_x[o]+c)}return _},e.attachEvent(\"onBeforeTodayDisplayed\",function(){for(var t in e.matrix){var a=e.matrix[t];a.x_start=a._original_x_start}return!0}),e.attachEvent(\"onOptionsLoad\",function(){for(var t in e.matrix){var a=e.matrix[t];a.order={},e.callEvent(\"onOptionsLoadStart\",[]);for(var t=0;t<a.y_unit.length;t++)a.order[a.y_unit[t].key]=t;e.callEvent(\"onOptionsLoadFinal\",[]),e._date&&a.name==e._mode&&e.setCurrentView(e._date,e._mode)}}),e.attachEvent(\"onSchedulerResize\",function(){\r\nif(e.matrix[this._mode]){var t=e.matrix[this._mode];return e._renderMatrix.call(t,!0,!0),!1}return!0}),e.attachEvent(\"onBeforeDrag\",function(t,a,n){if(\"resize\"==a){var i=n.target||n.srcElement;(i.className||\"\").indexOf(\"dhx_event_resize_end\")<0?e._drag_from_start=!0:e._drag_from_start=!1}return!0})},e._temp_matrix_scope()});\r\n//# sourceMappingURL=../sources/ext/dhtmlxscheduler_timeline.js.map"

/***/ },
/* 20 */
/*!***********************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/script-loader!./class/SFAClassIF.js ***!
  \***********************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./class/SFAClassIF.js */ 21)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/class/SFAClassIF.js")

/***/ },
/* 21 */
/*!********************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./class/SFAClassIF.js ***!
  \********************************************************************************/
/***/ function(module, exports) {

	module.exports = "/**\r\n * 反響ツリーから操作される（処理がつながっている）画面要素の共通インターフェースを定義\r\n * ただし、プロパティは持たせないこと。今回の実装方法では正しく動かないため。\r\n * また、各実装クラスでIFのメソッドを使う場合はオーバーライドして使うこと。\r\n */\r\nfunction GHClassIF() {\r\n}\r\n/**\r\n * 反響ツリーから顧客IDの配列を受け取り、そのデータをもとに情報を表示する。\r\n * @param personalIds : array[number]\r\n */\r\nGHClassIF.prototype.showPage = function(personalIds) {\r\n    console.log(\"インターフェースのメソッドshowPageが呼び出された\", personalIds);\r\n}"

/***/ },
/* 22 */
/*!********************!*\
  !*** ./gh.wins.js ***!
  \********************/
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.wins.js */ 23)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.wins.js")

/***/ },
/* 23 */
/*!***********************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.wins.js ***!
  \***********************************************************************/
/***/ function(module, exports) {

	module.exports = "// TODO Window を作成した後、hide すると親画面のレイアウトにも Window のものが反映されることがある。\r\n// この現象は親画面の Layout を unload して new しても発生するため、明らかに dhtmlx 側の不具合。\r\n// 対処法：window を hide するのではなく、close すること\r\n/**\r\n * 共通ウィンドウクラス\r\n */\r\nfunction CommonWindows() {\r\n    \"use strict\";\r\n\r\n    this.ghWins = new dhtmlXWindows();\r\n    this.ghWins.attachEvent(\"onShow\", function(win){\r\n        win.button(\"park\").hide();\r\n        win.button(\"minmax1\").hide();\r\n        win.setModal(true);\r\n        win.center();\r\n    });\r\n    this.ghWins.attachEvent(\"onClose\", function(win){\r\n        win.setModal(false);\r\n        return true;\r\n    });\r\n    this.ghWins.attachEvent(\"onHide\", function(win){\r\n        win.setModal(false);\r\n        return true;\r\n    });\r\n    this.ghWins.attachEvent(\"onFocus\", function(win){\r\n        win.setModal(true);\r\n    });\r\n    var that = this;\r\n\r\n    /**\r\n     * ウィンドウを閉じます。\r\n     * @param {String} windowName ウィンドウ名\r\n     * @param {Boolean} doClose クローズするならtrue, 隠すだけならfalse\r\n     *\r\n     */\r\n    this.closeWindow = function(windowName, doClose) {\r\n        var win = this.ghWins.window(windowName);\r\n        if (!_.isEmpty(win) && !win.isHidden()) {\r\n            if (doClose) {\r\n                win.close();\r\n            } else {\r\n                win.hide();\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * LDAPログインダイアログを開く\r\n     */\r\n    this.doGoogleLoginWin = function (context) {\r\n        var win = this.ghWins.window(\"loginWin\");\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(\"loginWin\", 20, 30, 600, 300);\r\n            win.maximize();\r\n            win.button(\"close\").hide();\r\n            win.hide();\r\n            win.setText(\"Googleログイン\");\r\n        }\r\n        win.show();\r\n        var loginForm = win.attachForm();\r\n        var auth2;\r\n        var SCOPES = [\"https://www.googleapis.com/auth/calendar\"];\r\n        loginForm.loadStruct(getTemplatePath(_GH.DATA_PATH.LOGIN_FORM), \"json\", function () {\r\n            // initialize log in with Google button\r\n            if (_.isUndefined(gapi.auth2)) {\r\n                gapi.load('auth2', function () {\r\n                    auth2 = gapi.auth2.init({\r\n                        client_id: _GH.GOOGLE_CLIENT_ID,\r\n                        cookiepolicy: 'single_host_origin',\r\n                        scope: SCOPES.join(' ')\r\n                    });\r\n\r\n                    attachSignIn($('.g-signin2').get(0));\r\n                });\r\n            }\r\n            else {\r\n                auth2 = gapi.auth2.getAuthInstance();\r\n                attachSignIn($('.g-signin2').get(0));\r\n            }\r\n        });\r\n        loginForm.setFontSize(\"16\" + \"px\");\r\n        loginForm.attachEvent(\"onValidateError\", function (name/*, value, result*/){\r\n            //エラーメッセージを表示\r\n            dhtmlx.message({ type:\"error\", text:loginForm.getItemLabel(name) + \"は必ず入力してください。\"});\r\n        });\r\n\r\n        function attachSignIn(element) {\r\n            auth2.attachClickHandler(element, {}, function (googleUser) {\r\n                googleLogin(googleUser.getAuthResponse().id_token, googleUser.getAuthResponse().access_token);\r\n            });\r\n        }\r\n        function googleLogin(token, accessToken) {\r\n            // logout before login process\r\n            getJSONSync(\"auth/logout\");\r\n            _ghUser.setLoginType(loginForm.getItemValue(\"loginType\"));\r\n            try {\r\n                var r = window.dhx4.ajax.postSync(_GHAPI.SERVER + \"auth/googleLogin\", \"token=\" + encodeURIComponent(token) + \"&accessToken=\" + encodeURIComponent(accessToken));\r\n            } catch (e) {\r\n                console.log(\"Log in with Google failure\", e);\r\n                dhtmlx.message({type:\"error\", text: JSON.parse(e.message).message});\r\n                return;\r\n            }\r\n            var t = r.xmlDoc;\r\n            //var httpStatus = t.status; // number\r\n            if (t != null) {\r\n                console.log(\"Authentication successful\");\r\n                _ghUser.setHeaderInfo(t);\r\n                console.log(_ghUser.toString());\r\n                win.close();\r\n                context.refresh();\r\n                context.init();\r\n                dhtmlx.message({text: \"ようこそ、\" + _ghUser.getName() + \"さん\"});\r\n            } else {\r\n                var message = is(\"String\", t.responseText)? JSON.parse(t.responseText).message: \"サーバーエラーが発生しました。\";\r\n                //var params = { 'status' : httpStatus, 'errorMessage' :message};\r\n                //throw new Error(JSON.stringify({message: message, params: params}));\r\n                dhtmlx.message({type:\"error\", text: message});\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    this.doBuilding = function(buildingCodeInput, buildingNameInput, formObject){\r\n        var winName = \"BuildingWin\";\r\n        var MODE =  _GH.WINS.EVENT_MODE.EVENT;\r\n        //var DEPT = (_ghUser.isNon())? _GH.WINS.EVENT_POS.KD: _GH.WINS.EVENT_POS.MS;\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            var winWidth = MODE.width;\r\n            win = this.ghWins.createWindow(winName, 20, 30, winWidth, MODE.height);\r\n            win.setText(\"Select Building\");\r\n            win.hide();\r\n            win.attachEvent(\"onClose\", function (/*win*/) {\r\n                if (!_.isEmpty(formObject)) formObject.updateValues();\r\n                return true;\r\n            });\r\n        }\r\n        var bukkenForm = win.attachForm();\r\n        bukkenForm.loadStruct(loadJSON(getTemplatePath(_GH.DATA_PATH.WIN_BUILDING_FORM_JSON)), \"json\", function() {\r\n        if (MODE.isEvent) {\r\n                this.hideItem(\"arrow\");\r\n                this.hideItem(\"info\");\r\n            }\r\n        });\r\n        var gridDataLogicFunc = function (data, id/*, rowIdx*/) {\r\n            var val;\r\n            switch (id) {\r\n                case \"buildingName\":\r\n                    val = _.isEmpty(data[id])? data[\"buildingName\"]: data[id];\r\n                    break;\r\n                default:\r\n                    val = data[id];\r\n                    break;\r\n            }\r\n            return val;\r\n        };\r\n        var leftGrid = new dhtmlXGridObject(bukkenForm.getContainer(\"leftGrid\"));\r\n        leftGrid.setImagePath(_GH.PATH_TYPE.DHX_IMGS);\r\n        leftGrid.setSkin(_GH.PATH_TYPE.SKIN);\r\n        leftGrid.attachEvent(\"onDataReady\",function(){\r\n            leftGrid.setColumnHidden(0, true);\r\n        });\r\n\r\n        var searchBuilding = function(doSearchAll) {\r\n            var buildingName = bukkenForm.getItemValue(\"searchBuildingName\");\r\n            var query = \"\";\r\n            if (!_.isEmpty(buildingName)) {\r\n                query += \"buildingName=\" + buildingName + \"&\";\r\n            }\r\n            if (_.isEmpty(query) && !doSearchAll) return;\r\n            if (leftGrid) leftGrid.clearAll();\r\n            loadGridByGet(leftGrid, _GH.DATA_PATH.BUILDING_GIRD, \"building/list?\" + query, \"buildingCode\", gridDataLogicFunc);\r\n        };\r\n\r\n        bukkenForm.attachEvent(\"onChange\", function (name/*, value*/) {\r\n            switch (name) {\r\n                case \"searchBuildingName\":\r\n                    searchBuilding();\r\n                    break;\r\n            }\r\n        });\r\n        bukkenForm.attachEvent(\"onKeyDown\",function (inp, ev, name/*, value*/) {\r\n            switch (name) {\r\n                case \"searchBuildingName\":\r\n                    if (ev.keyCode == _GH.KEY_CODE.ENTER) searchBuilding();\r\n                    break;\r\n            }\r\n        });\r\n\r\n        var previousEventId = 0;\r\n        searchBuilding(true);\r\n        leftGrid.attachEvent(\"onRowDblClicked\", function (selectBuildingCode/*, cInd*/) {\r\n            if (buildingCodeInput !== null) buildingCodeInput.value = leftGrid.cells(selectBuildingCode, 0).getValue();\r\n            if (buildingNameInput !== null) buildingNameInput.value = leftGrid.cells(selectBuildingCode, 1).getValue();\r\n            win.close();\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 担当者選択ダイアログを開く\r\n     * @param tantoIdInput {Object} 担当者IDを設定するためのInputオブジェクト\r\n     * @param tantoNameInput {Object} 担当者名を設定するためのInputオブジェクト\r\n     * @param divisionIdInput\r\n     * @param divisionName\r\n     * @param divisionSelectable\r\n     * @param initialEmp\r\n     * @param def\r\n     * @param doShowAll\r\n     * @param isCheckBox\r\n     * @param isGetName\r\n     */\r\n    this.doTantoWin = function(tantoIdInput, tantoNameInput, divisionIdInput, divisionName, divisionSelectable, initialEmp, def, doShowAll, isCheckBox, isGetName) {\r\n        var winName = \"TantoWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 400, 380);\r\n            win.hide();\r\n            win.setText(\"担当者選択\");\r\n        }\r\n        var tantoTree = null;\r\n        var tantoForm = win.attachForm();\r\n        var divisionId = !isCheckBox ? 0 : [];\r\n        var employeeId = !isCheckBox ? 0 : [];\r\n        tantoForm.loadStruct(getTemplatePath(_GH.DATA_PATH.TANTO_JSON), function() {\r\n            // TODO (confirm): only show cancel button in main screen (in SFA version: SFA page)\r\n            if (_ghUser.inMainScreen()) {\r\n                this.showItem(\"deleteTantoBtn\");\r\n            }\r\n            tantoTree = new dhtmlXTreeObject(tantoForm.getContainer(\"tantoTree\"),\"100%\",\"100%\",0);\r\n            if(isCheckBox){\r\n            \ttantoTree.enableCheckBoxes(true);\r\n                tantoTree.enableThreeStateCheckboxes(true);\r\n                this.hideItem(\"notice\");\r\n                this.showItem(\"checkBoxBtn\");\r\n            }            \r\n            tantoTree.setImagePath(_GH.PATH_TYPE.TREE_IMGS);\r\n            tantoTree.enableKeyboardNavigation(true);\r\n            //TODO ここはキャッシュで持たせたい\r\n            var uri = (doShowAll)? \"0/3\": _ghUser.getLoginType() + \"/3\";\r\n            tantoTree.parse(getJSONSync(_GHAPI.URL.TANTO + uri +\"?quitFlg=0\"), function () {\r\n                if (initialEmp) {\r\n                    // 引数で与えられた担当者IDを探す\r\n                    var allNodesIds = tantoTree.getAllSubItems(0);\r\n                    allNodesIds = allNodesIds.split(\",\");\r\n                    _.forEach(allNodesIds, function (id) {\r\n                        if(tantoTree.getUserData(id, \"employeeId\") === initialEmp){\r\n                            tantoTree.findItem(tantoTree.getItemText(id));\r\n                        }\r\n                    });\r\n                } else {\r\n                    tantoTree.findItem(_ghUser.getName());\r\n                }\r\n                // 何も選択されていなければ、ルートを開く\r\n                if (!tantoTree.getSelectedItemId()) {\r\n                    var rootId = safeCommaSplit(tantoTree.getAllItemsWithKids())[0];\r\n                    tantoTree.openItem(rootId);\r\n                }\r\n            }, \"json\");\r\n            // ダブルクリックイベント\r\n            if (!isCheckBox) {\r\n            \t  tantoTree.attachEvent(\"onDblClick\", function (/*id*/) {\r\n                    win.close();\r\n                });\r\n            }\r\n        });\r\n\r\n        // クリックイベント\r\n        tantoForm.attachEvent('onButtonClick', function(name/*, command*/){\r\n            switch(name) {\r\n                case \"searchTantoBtn\": // 検索ボタンクリック\r\n                    tantoTree.findItem(tantoForm.getItemValue(\"searchTanto\"));\r\n                    break;\r\n                case \"deleteTantoBtn\": // 取消ボタンクリック\r\n                    if(tantoIdInput) tantoIdInput.value = 0;\r\n                    if(tantoNameInput) tantoNameInput.value = \"\";\r\n                    if(divisionIdInput) divisionIdInput.value = 0;\r\n                    if(divisionName) divisionName.value = \"\";\r\n                    win.close();\r\n                    break;\r\n                case \"checkBoxBtn\":\r\n                \twin.close();\r\n                    break;\r\n            }\r\n        });\r\n\r\n        win.attachEvent(\"onClose\", function(){\r\n            var selectedId = (!isCheckBox)? tantoTree.getSelectedItemId() : tantoTree.getAllChecked();\r\n            // 何も選択されていない場合、処理を終える\r\n            if(selectedId == 0){\r\n                return true;\r\n            }\r\n            if(isCheckBox){\r\n        \t\tvar checkBoxId = _.words(selectedId, /[^, ]+/g);\r\n        \t\tif(checkBoxId === \"undefined\"){\r\n        \t\t\treturn true;\r\n        \t\t}\r\n        \t\tvar text = [];\r\n        \t\t_.forOwn(checkBoxId, function(value/*, key*/) {\r\n        \t\t\tif(tantoTree.getUserData(value, \"employeeId\") !== undefined){\r\n        \t\t\t\temployeeId.push(tantoTree.getUserData(value, \"employeeId\"));\r\n        \t\t\t\tif((divisionId.indexOf(tantoTree.getUserData(value, \"divisionId\")) == -1)){\r\n        \t\t\t\t\tdivisionId.push(tantoTree.getUserData(value, \"divisionId\"));\r\n        \t\t\t\t}\r\n        \t\t\t\ttext.push(tantoTree.getItemText(value));\r\n        \t\t\t}\r\n    \t\t\t});\r\n        \t\tif(tantoIdInput){\r\n                    tantoIdInput.value = employeeId;\r\n                }\r\n        \t\ttantoNameInput.value = text.join(\";\");\r\n        \t} else {\r\n        \t\tif (tantoTree.getUserData(selectedId, \"employeeId\") !== undefined) {\r\n                    // 担当者が選択された場合\r\n                \t\r\n                    employeeId = tantoTree.getUserData(selectedId, \"employeeId\");\r\n                    if(tantoIdInput){\r\n                        tantoIdInput.value = employeeId;\r\n                    }\r\n                    divisionId = tantoTree.getUserData(selectedId, \"divisionId\");\r\n                    if(divisionIdInput && !_.isEmpty(divisionId) && divisionId != 0){\r\n                        divisionIdInput.value = divisionId;\r\n                    }\r\n\r\n                    // 担当者名に課名も付与\r\n                    var parentId = tantoTree.getParentId(selectedId);\r\n                    var division = tantoTree.getItemText(parentId);\r\n                    (isGetName) ? $(tantoNameInput).val(tantoTree.getSelectedItemText()).change() : $(tantoNameInput).val(division + \" \" + tantoTree.getSelectedItemText()).change();\r\n                    var selectedName = tantoTree.getSelectedItemText();\r\n                    if (divisionName && !_.isEmpty(selectedName) && selectedName != 0) {\r\n                        $(divisionName).val(selectedName).change();\r\n                    }\r\n                } else {\r\n                    // 組織が選択できない場合、組織がクリックされた場合は無視する\r\n                    if(!divisionSelectable){\r\n                        console.log(\"組織を選択したため、無視する\");\r\n                        return;\r\n                    }\r\n                    divisionId = tantoTree.getUserData(selectedId, \"divisionId\");\r\n                    if(divisionIdInput && !_.isEmpty(divisionId) && divisionId != 0){\r\n                        divisionIdInput.value = divisionId;\r\n                    }\r\n                    var selectedName = tantoTree.getSelectedItemText();\r\n                    if (divisionName && !_.isEmpty(selectedName) && selectedName != 0) {\r\n                        $(divisionName).val(selectedName).change();\r\n                    }\r\n                    // 担当者情報があれば、空にする。\r\n                    if (tantoIdInput) {\r\n                        tantoIdInput.value = 0;\r\n                    }\r\n                }\r\n        \t}            \r\n            // 主に値の受け渡し\r\n            if (def) {\r\n               def.resolve(divisionId, employeeId);\r\n            }\r\n            return true;\r\n        });\r\n\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 画像アップロードウィンドウを開く\r\n     * @param ckEditor 画像アップロードで帰ってきたURLを設定するためのCKEditorオブジェクト\r\n     */\r\n    this.doImageUploadWin = function(ckEditor) {\r\n        var winName = \"ImageUploadWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 330, 160);\r\n            win.setText(\"画像アップロードウィンドウ\");\r\n            win.hide();\r\n        }\r\n        // 中身の用意\r\n        var imageForm = win.attachForm();\r\n        imageForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MAIL_IMAGE_FORM_JSON), \"json\");\r\n        imageForm.enableLiveValidation(true);\r\n        // 添付ファイルアップロードの開始\r\n        imageForm.attachEvent(\"onBeforeFileAdd\", function(file){\r\n            // 入力チェック\r\n            if (!this.validate()) {\r\n                console.log(\"バリデーションerror\");\r\n                return false;\r\n            }\r\n\r\n            // 拡張子チェック\r\n            var ext = \"\";\r\n            var k = String(file).match(/\\.([^\\.\\s]*)$/i); // \"filename.jpg\" -> [\".jpg\",\"jpg\"]\r\n            if (k != null) ext = k[1];\r\n\r\n            if (_.indexOf([\"bmp\", \"gif\", \"jpeg\", \"jpg\", \"png\"], ext.toLowerCase()) < 0) {\r\n                dhtmlx.alert({\r\n                    title:\"ファイル拡張子エラー\",\r\n                    type:\"alert-error\",\r\n                    text:\"画像ファイル（拡張子がbmp, gif, jpeg, jpg, png）ではないため、アップロードできません。\"\r\n                });\r\n                return false;\r\n            }\r\n\r\n            // 値の設定\r\n            var imageFile = imageForm.getUploader(\"imageFile\");\r\n            imageFile.setDoCompress(true);\r\n            imageFile.setImageQuality(parseFloat(imageForm.getItemValue(\"imageFileQuality\")));\r\n            imageFile.setImageMaxWidth(parseInt(imageForm.getItemValue(\"imageFileMaxWidth\")));\r\n            imageFile.setImageMaxHeight(parseInt(imageForm.getItemValue(\"imageFileMaxHeight\")));\r\n            imageFile.setSendParams(\"SFA_USER_ID\", _ghUser.getGhId());\r\n            return true;\r\n        });\r\n        // 値が変更された際の設定\r\n        imageForm.attachEvent(\"onChange\",function(name, value){\r\n            if (name == \"imageFileQuality\") {\r\n                imageForm.getUploader(\"imageFile\").setImageQuality(parseFloat(value));\r\n            } else if (name == \"imageFileMaxWidth\") {\r\n                imageForm.getUploader(\"imageFile\").setImageMaxWidth(parseInt(value));\r\n            } else if (name == \"imageFileMaxHeight\") {\r\n                imageForm.getUploader(\"imageFile\").setImageMaxHeight(parseInt(value));\r\n            }\r\n        });\r\n        // 画像ファイルアップロードの完了\r\n        imageForm.attachEvent(\"onUploadFile\",function(realName, serverName){\r\n            console.log(\"画像のフォーム\", this.getFormData());\r\n            console.log(\"<b>onUploadComplete</b> realName   = \" + realName);\r\n            console.log(\"<b>onUploadComplete</b> serverName = \" + serverName);\r\n            ckEditor.insertHtml(\"<img src='\" + _GH.FILE_ROOT + serverName + \"'/>\");\r\n        });\r\n        imageForm.attachEvent(\"onUploadComplete\",function(/*count*/){\r\n            win.close();\r\n        });\r\n        // 添付ファイルアップロードの失敗\r\n        imageForm.attachEvent(\"onUploadFail\",function(realName){\r\n            dhtmlx.alert({\r\n                title:\"画像アップロードエラー\",\r\n                type:\"alert-error\",\r\n                text:realName + \"をアップロードすることができませんでした。\"\r\n            });\r\n            win.close();\r\n        });\r\n        // バリデートエラー時の処理\r\n        imageForm.attachEvent(\"onValidateError\", function (name/*, value, result*/) {\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: imageForm.getItemLabel(name) + \"は数字で必ず入力してください。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 希望地域ダイアログを開く\r\n     * @param {Object} targetInput 希望地域ダイアログで選んだ値を設定するためのInputオブジェクト\r\n     * @param {Boolean} showOptNon 「希望地域なし」表示フラグ\r\n     * @param {Object} formObject フォームオブジェクト\r\n     */\r\n    this.doKiboAreaWin = function(targetInput, showOptNon, formObject) {\r\n        // 希望地域の区切り文字\r\n        var winName = \"KiboAreaWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            //{id: \"w2\", left: 350, top: 30,  width: 650, height: 200, text: \"希望地域ウィンドウ\", move: true},\r\n            win = this.ghWins.createWindow(winName, 20, 30, 800, 725);\r\n            win.hide();\r\n            win.setText(\"希望地域ウィンドウ\");\r\n            win.attachEvent(\"onClose\", function(/*win*/){\r\n                if (!_.isEmpty(formObject)) formObject.updateValues();\r\n                return true;\r\n            });\r\n        }\r\n        // 中身の用意\r\n        var kiboAreaForm = win.attachForm();\r\n        kiboAreaForm.loadStruct(getTemplatePath(_GH.DATA_PATH.KIBO_AREA_JSON), \"json\", function() {\r\n            // すでに地域が選択されている場合の処理\r\n            var inpVal = targetInput.value;\r\n            if (is(\"String\", inpVal) && inpVal.length > 0) {\r\n                var preSelectArea = inpVal.split(_GH.FORMAT.AREA_DELIMITER);\r\n                var dataset = {};\r\n                _.forEach(kiboAreaForm.getFormData(), function(value, key/*, object*/) {\r\n                    dataset[key] = _.indexOf(preSelectArea, kiboAreaForm.getItemValue(key)) >= 0;\r\n                });\r\n                kiboAreaForm.setFormData(dataset);\r\n            }\r\n            // 希望地域なしを表示しない場合は隠す\r\n            if (showOptNon) {\r\n                kiboAreaForm.showItem(\"opt_non\");\r\n            } else {\r\n                kiboAreaForm.hideItem(\"opt_non\");\r\n            }\r\n        });\r\n        // チェックボックス値変更\r\n        kiboAreaForm.attachEvent(\"onChange\", function (name/*, value*/){\r\n            // 「すべて」チェックボックスを押したときの動作\r\n            if (name.lastIndexOf(\"all\") > 0) {\r\n                var setval = kiboAreaForm.isItemChecked(name); // 「すべて」がチェックしているかどうか\r\n                var prefix = name.split(\"_\")[0] + \"_\"; // すべてのプレフィックスを取る。\r\n                var dataset = {};\r\n                _.forEach(kiboAreaForm.getFormData(), function(value, key/*, object*/) {\r\n                    if (key.indexOf(prefix) == 0) {\r\n                        dataset[key] = setval;\r\n                    }\r\n                });\r\n                kiboAreaForm.setFormData(dataset);\r\n            }\r\n       });\r\n        // ボタンクリック\r\n        kiboAreaForm.attachEvent(\"onButtonClick\", function(name){\r\n            if (name == \"kiboAreaSelectBtn\") {\r\n                // 選択ボタンクリック\r\n                // 選択した地域をカンマでつなげて、Inputに登録する。\r\n                var text = \"\"; \r\n                _.forEach(kiboAreaForm.getFormData(), function(value, key/*, object*/) {\r\n                    if (key.lastIndexOf(\"all\") < 0 && value != 0) {\r\n                        text += value + _GH.FORMAT.AREA_DELIMITER;//separate each area with \"/\"\r\n                    }\r\n                });\r\n                text = (text.length == 0)? \"\": \"/\" +text; // add \"/\" for first area \r\n                if(escape(text).replace(/%u.{4}/g,\"xx\").length > 600){\r\n                    dhtmlx.confirm({\r\n                        type:\"confirm\",\r\n                        text: \"希望地域の文字数が制限を超えています。\"\r\n                    });\r\n                    return;\r\n                }\r\n                targetInput.value = text;\r\n                win.close();\r\n            } else if (name == \"opt_all_chk\") {\r\n                // すべて選択\r\n                var dataset = {};\r\n                _.forEach(kiboAreaForm.getFormData(), function(value, key/*, object*/) {\r\n                    if (key !== \"opt_non\") { // 「希望地域なし」は除く\r\n                        dataset[key] = true;\r\n                    }\r\n                });\r\n                kiboAreaForm.setFormData(dataset);\r\n            } else if (name == \"opt_all_dechk\") {\r\n                // チェックをはずす\r\n                var dataset = {};\r\n                _.forEach(kiboAreaForm.getFormData(), function(value, key/*, object*/) {\r\n                    dataset[key] = false;\r\n                });\r\n                kiboAreaForm.setFormData(dataset);\r\n            }\r\n       });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 沿線ダイアログを開く\r\n     * @param {String} ensenIdInp 沿線IDを設定するための沿線Inputオブジェクト\r\n     * @param {String} ensenNameInp 沿線名を設定するための沿線Inputオブジェクト\r\n     * @param {String} ekiFromIdInp 駅IDを設定するための始駅Inputオブジェクト\r\n     * @param {String} ekiFromNameInp 駅名を設定するための始駅Inputオブジェクト\r\n     * @param {String} ekiToIdInp 駅IDを設定するための終駅Inputオブジェクト\r\n     * @param {String} ekiToNameInp 駅名を設定するための終駅Inputオブジェクト\r\n     * @param {Object} formObject フォームオブジェクト\r\n     */\r\n    this.doEnsenWin = function(ensenIdInp, ensenNameInp, ekiFromIdInp, ekiFromNameInp, ekiToIdInp, ekiToNameInp, formObject) {\r\n        var win = this.ghWins.window(\"railwayWin\");\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(\"railwayWin\", 20, 30, 550, 550);\r\n            win.hide();\r\n            win.setText(\"沿線ウィンドウ\");\r\n        }\r\n        // 中身の用意\r\n        var railwayForm = win.attachForm();\r\n        railwayForm.loadStruct(getTemplatePath(_GH.DATA_PATH.ENSEN_JSON), \"json\");\r\n        // ラジオボタン\r\n        railwayForm.attachEvent(\"onChange\", function (name, value){\r\n            // 駅ウィンドウを開く\r\n            that.doEkiWin(ensenIdInp, ensenNameInp, ekiFromIdInp, ekiFromNameInp, ekiToIdInp, ekiToNameInp, value, this.getItemLabel(name, value), formObject);\r\n            win.close();\r\n        });\r\n        // ボタンクリック\r\n        railwayForm.attachEvent('onButtonClick', function(name/*, command*/){\r\n            switch (name) {\r\n                case \"deselectBtn\": // 駅・沿線の選択取り消しボタン\r\n                    _.forEach([ensenIdInp, ensenNameInp, ekiFromIdInp, ekiFromNameInp, ekiToIdInp, ekiToNameInp], function (inpObj) {\r\n                        if (inpObj !== null) inpObj.value = \"\";\r\n                    });\r\n                    win.close();\r\n                    break;\r\n            }\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 駅ダイアログを開く\r\n     * @param {Object} ensenIdInp 沿線IDを設定するための沿線Inputオブジェクト\r\n     * @param {Object} ensenNameInp 沿線名を設定するための沿線Inputオブジェクト\r\n     * @param {Object} ekiFromIdInp 駅IDを設定するための始駅Inputオブジェクト\r\n     * @param {Object} ekiFromNameInp 駅名を設定するための始駅Inputオブジェクト\r\n     * @param {Object} ekiToIdInp 駅IDを設定するための終駅Inputオブジェクト\r\n     * @param {Object} ekiToNameInp 駅名を設定するための終駅Inputオブジェクト\r\n     * @param {Number} railwayId 沿線ID\r\n     * @param {String} ensenName 沿線名\r\n     * @param {Object} formObject フォームオブジェクト\r\n     */\r\n    this.doEkiWin = function(ensenIdInp, ensenNameInp, ekiFromIdInp, ekiFromNameInp, ekiToIdInp, ekiToNameInp, railwayId, ensenName, formObject) {\r\n        var winName = \"ekiWin\";\r\n        // 開始と終了の２駅使うかどうか\r\n        var useTowStations = (ekiToIdInp !== null && ekiToIdInp !== undefined);\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            var winWidth = useTowStations? 420: 230;\r\n            win = this.ghWins.createWindow(winName, 20, 30, winWidth, 400);\r\n            win.hide();\r\n            win.button(\"close\").attachEvent(\"onClick\", function(){\r\n                that.doEnsenWin(ensenIdInp, ensenNameInp, ekiFromIdInp, ekiFromNameInp, ekiToIdInp, ekiToNameInp, formObject);\r\n                return true;\r\n            });\r\n        }\r\n        win.setText(ensenName + \"の駅ウィンドウ\");\r\n        var startStationGrid = null;\r\n        var endStationGrid = null;\r\n        // 中身の用意\r\n        var stationForm = win.attachForm();\r\n        var templatePath = useTowStations? _GH.DATA_PATH.EKI_JSON: _GH.DATA_PATH.EKI_ONE_JSON;\r\n        stationForm.loadStruct(getTemplatePath(templatePath), \"json\", function(){\r\n            // 駅情報を取得する。\r\n            startStationGrid = new dhtmlXGridObject(stationForm.getContainer(\"startStation\"));\r\n            startStationGrid.attachEvent(\"onDataReady\",function(){\r\n                _.forEach(_GH.WINS.EKI.HIDE_COL, function(idx) { startStationGrid.setColumnHidden(idx, true);});\r\n                startStationGrid.selectRow(0); // 始発駅を選ぶ\r\n            });\r\n            loadGridByGet(startStationGrid, _GH.DATA_PATH.EKI_GRID_JSON, _GH.URL(\"RAILWAY\") + railwayId, \"ekiId\");\r\n            if (useTowStations) {\r\n                endStationGrid = new dhtmlXGridObject(stationForm.getContainer(\"endStation\"));\r\n                endStationGrid.attachEvent(\"onDataReady\",function(){\r\n                    _.forEach(_GH.WINS.EKI.HIDE_COL, function(idx) { endStationGrid.setColumnHidden(idx, true);});\r\n                    endStationGrid.selectRow(endStationGrid.getRowsNum() - 1); // 終点を選ぶ\r\n                    endStationGrid.showRow(endStationGrid.getSelectedRowId());\r\n                });\r\n                loadGridByGet(endStationGrid, _GH.DATA_PATH.EKI_GRID_JSON, _GH.URL(\"RAILWAY\") + railwayId, \"ekiId\");\r\n            }\r\n        });\r\n        // クリックイベント\r\n        stationForm.attachEvent('onButtonClick', function(name/*, command*/){\r\n            switch(name) {\r\n                case \"selectBtn\": // 選択ボタン\r\n                    // 駅が両方選ばれていることを確認\r\n                    var startSelectRowId = startStationGrid.getSelectedRowId();\r\n                    var endSelectRowId = useTowStations? endStationGrid.getSelectedRowId(): \"dummy\";\r\n                    if (startSelectRowId == null || endSelectRowId == null) {\r\n                        dhtmlx.alert({\r\n                            title:\"駅選択エラー\",\r\n                            type:\"alert-error\",\r\n                            text:\"始駅と終駅の両方を選択してください。\"\r\n                        });\r\n                        return;\r\n                    }\r\n                    // 路線情報セット\r\n                    if (ensenIdInp !== null) ensenIdInp.value = railwayId;\r\n                    if (ensenNameInp !== null) ensenNameInp.value = ensenName;\r\n                    // 始駅と終駅が逆の場合は、正しい順番にしてセットする。\r\n                    if (useTowStations) {\r\n                        if (startStationGrid.cells(startSelectRowId, 3).getValue() < endStationGrid.cells(endSelectRowId, 3).getValue()) {\r\n                            // 正順\r\n                            if (ekiFromIdInp !== null) ekiFromIdInp.value = startStationGrid.cells(startSelectRowId, 0).getValue();\r\n                            if (ekiFromNameInp !== null) ekiFromNameInp.value = startStationGrid.cells(startSelectRowId, 4).getValue();\r\n                            if (ekiToIdInp !== null) ekiToIdInp.value = endStationGrid.cells(endSelectRowId, 0).getValue();\r\n                            if (ekiToNameInp !== null) ekiToNameInp.value = endStationGrid.cells(endSelectRowId, 4).getValue();\r\n                        } else {\r\n                            // 逆順\r\n                            if (ekiToIdInp !== null) ekiToIdInp.value = startStationGrid.cells(startSelectRowId, 0).getValue();\r\n                            if (ekiToNameInp !== null) ekiToNameInp.value = startStationGrid.cells(startSelectRowId, 4).getValue();\r\n                            if (ekiFromIdInp !== null) ekiFromIdInp.value = endStationGrid.cells(endSelectRowId, 0).getValue();\r\n                            if (ekiFromNameInp !== null) ekiFromNameInp.value = endStationGrid.cells(endSelectRowId, 4).getValue();\r\n                        }\r\n                    } else {\r\n                        if (ekiFromIdInp !== null) ekiFromIdInp.value = startStationGrid.cells(startSelectRowId, 0).getValue();\r\n                        if (ekiFromNameInp !== null) ekiFromNameInp.value = startStationGrid.cells(startSelectRowId, 4).getValue();\r\n                    }\r\n                    if (!_.isEmpty(formObject)) formObject.updateValues();\r\n                    win.close();\r\n                    break;\r\n            }\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * メール作成ウィンドウ\r\n     * @param {Array} personalIds 送信対象顧客IDの配列\r\n     * @param {Object} personalInfo 顧客情報 顧客メイン／顧客詳細のFormのデータセットを想定\r\n     * @param model\r\n     */\r\n    this.doMailWindow = function(personalIds, personalInfo, model) {\r\n        var winName = \"mailWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 1050, 750);\r\n            win.hide();\r\n        }\r\n        var attachments = {}; // 添付ファイルマップ。キーは実ファイル名、バリューはサーバ上のファイル名\r\n        var ckeditor = null;\r\n        console.log(\"送信対象顧客ID\", personalIds);\r\n        // 中身の用意\r\n        var mailForm = win.attachForm();\r\n        mailForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MAIL_FORM_JSON), \"json\", function() {\r\n            // 表示設定\r\n            win.setText(\"一斉メールを作成します。\");\r\n            mailForm.setItemValue(\"toAddress\", \"一覧表でチェックされた個人にメールします。\");\r\n            mailForm.disableItem(\"toAddress\");\r\n            mailForm.disableItem(\"emailAddressDetailBtn\");\r\n            // CCの設定\r\n            mailForm.reloadOptions(\"ccType\", _prop.getOptions(_GH.CODE_DEF.MAIL_CC));\r\n            // 送信者（From）の設定\r\n            var removeValues = [];\r\n            // 営業支援であれば、送信者「自分」を除く\r\n            if (_ghUser.hasRole(_GH.ROLE.PERSONAL_ALL_SEARCH_HOUSE)) removeValues.push(1);\r\n            // 代理送信権限がないなら、送信者「担当課員」を除く\r\n            if (!_ghUser.hasRole(_GH.ROLE.MAIL_PROXY_HOUSE)) removeValues.push(2);\r\n            // @INFO送信権限がないなら、送信者「＠INFO」を除く\r\n            if (!_ghUser.hasRole(_GH.ROLE.MAIL_ATINFO_HOUSE)) removeValues.push(3);\r\n\r\n            mailForm.reloadOptions(\"fromType\", removePropOptions(_prop.getOptions(_GH.CODE_DEF.MAIL_FROM), removeValues));\r\n            // MS営業支援の個別設定\r\n            if (_ghUser.isExp() && _ghUser.hasRole(_GH.ROLE.PERSONAL_ALL_SEARCH_MANSION)) mailForm.setItemValue(\"fromType\", 3);\r\n            // カレンダーで選択できるのは今日から２週間以内。\r\n            mailForm.getCalendar(\"timerStart\").setSensitiveRange(new Date(), getAfterDate(0, 14));\r\n\r\n            // CKEditorの設定\r\n            CKEDITOR.config.height = \"400px\";\r\n            CKEDITOR.config.width = \"950px\";\r\n            ckeditor = CKEDITOR.replace( \"body\", _GH.WINS.CKEDITOR.MAIL);\r\n            // ペースト時にGmailの画像があったら強制的に削除する\r\n            //TODO ペースト時に画像があった場合は同様にすべきかも。\r\n            ckeditor.on( 'paste', function( evt ) {\r\n                var originalPasteText = evt.data.dataValue;\r\n                var foundGmailImges = originalPasteText.match(/<img.*?>/gi);\r\n                _.forEach(foundGmailImges, function(imageStr) {\r\n                    // 置換\r\n                    originalPasteText = originalPasteText.split(_.escape($(imageStr)[0].src)).join(\"\\\" alt=\\\"この画像はペーストできません。「画像の挿入」ボタンから画像を登録してください。\");\r\n                });\r\n                evt.data.dataValue = originalPasteText;\r\n            });\r\n\r\n            //TODO 添付ファイル？\r\n            // メール編集可否を見る。不可であれば、件名・本文・物件・ファイルアップロードは編集できなくする。\r\n            // メールの件名と本文をセッションストレージの値を設定する。\r\n            mailForm.setItemValue(\"subject\", getSS(_GH.S05F010ML.MAIL_SUB));\r\n            ckeditor.setData(getSS(_GH.S05F010ML.MAIL_BODY));\r\n            // メール件名が空の場合、デフォルトを入れる。\r\n            if (_.isEmpty(mailForm.getItemValue(\"subject\"))) {\r\n                mailForm.setItemValue(\"subject\", _GH.WINS.MAIL_SUBJECT);\r\n            }\r\n            CKEDITOR.config.readOnly = false;\r\n            mailForm.getUploader('attachmentFiles').setURL(_GHAPI.SERVER + _GH.URL('FILE_UPLOAD_URL'));\r\n        });\r\n        // メールフォームのクリックイベント設定\r\n        mailForm.attachEvent('onButtonClick', function(name/*, command*/){\r\n            switch(name) {\r\n                case \"emailAddressDetailBtn\": // 詳細ボタン\r\n                    that.doDetailAddressWin(personalInfo, mailForm.getInput(\"toAddress\").id);\r\n                    break;\r\n                case \"sendTestEmailBtn\": // テスト送信\r\n                    that.sendTestMail(mailForm, ckeditor, attachments, personalIds);\r\n                    break;\r\n                case \"sendEmailBtn\": // 送信\r\n                    that.sendMail(winName, mailForm, ckeditor, attachments, personalIds, model);\r\n                    break;\r\n            }\r\n        });\r\n        // ライブラリのフォーカスイベント設定\r\n        mailForm.attachEvent('onFocus', function(name/*, command*/){\r\n            switch(name) {\r\n                case \"libraryName\": // ライブラリ選択ウィンドウ\r\n                    that.doLibSelectWin(personalIds.length);\r\n                    break;\r\n                case \"eventName\": // 物件ウィンドウを開く\r\n                    that.doEvent(this.getInput(\"eventId\"), this.getInput(\"eventName\"), mailForm);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 送信者の @info を選らんだ場合、署名がつかないのでメッセージで注意喚起\r\n        mailForm.attachEvent('onChange', function(name, value/*, form*/){\r\n            switch(name){\r\n                case \"fromType\":\r\n                    if(value.toString() === _prop.getValueFromPropName(_GH.CODE_DEF.MAIL_FROM, '@INFO').toString()){\r\n                        dhtmlx.message(\"署名は手動で入力してください。\");\r\n                    }\r\n            }\r\n        });\r\n\r\n        // 添付ファイルアップロードの設定\r\n        that.setFileUploadEvents(mailForm, attachments);\r\n        win.show();\r\n    };\r\n    /**\r\n     * メール作成画面のメールアドレス詳細ウィンドウ\r\n     * @param {Object} personalInfo 顧客情報\r\n     * @param {String} toAddressId toAddress要素のID\r\n     */\r\n    this.doDetailAddressWin = function(personalInfo, toAddressId) {\r\n        var winName = \"detailAddressWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 380, 220);\r\n            win.setText(\"送信先アドレス変更ウィンドウ\");\r\n            win.hide();\r\n            win.attachEvent(\"onClose\", function(/*win*/){\r\n                return true;\r\n            });\r\n        }\r\n        var addressForm = win.attachForm();\r\n        addressForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MAIL_ADDRESS_FORM_JSON), \"json\", function() {\r\n            addressForm.setFormData(personalInfo);\r\n        });\r\n        addressForm.attachEvent('onButtonClick', function(name/*, command*/){\r\n            switch (name) {\r\n                case \"addressOKBtn\" :\r\n                    // メールアドレスと送信チェックが有効な組が１組以上あることをチェックする。\r\n                    var tempToAddress = getSendEmailsFromCustInfo(addressForm.getFormData());\r\n                    if (tempToAddress.length === 0) {\r\n                        dhtmlx.alert({\r\n                            title:\"メールアドレスチェックエラー\",\r\n                            type:\"alert-error\",\r\n                            text:\"送信先のメールアドレスを１つ以上チェックしてください。\"\r\n                        });\r\n                    } else {\r\n                        // 変更した値を保存する。\r\n                        postSyncURL(\"personal/update\", addressForm.getFormData());\r\n                        document.getElementById(toAddressId).value = tempToAddress;\r\n                        win.close();\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * ライブラリ選択ウィンドウ\r\n     * @param {Number} sendCount 送信人数\r\n     */\r\n    this.doLibSelectWin = function(sendCount) {\r\n        var winName = \"libSelectWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 1200, 450);\r\n            win.setText(\"ライブラリ選択\");\r\n            win.hide();\r\n        }\r\n        win.show();\r\n        var winLayout = win.attachLayout(\"2U\");\r\n        var mailLibTree  =  new S05F030LibTree(winLayout);\r\n        mailLibTree.initWin(sendCount);\r\n    };\r\n\r\n    /**\r\n     * ライブラリ作成・編集ウィンドウ\r\n     * @param {Number} libraryDirId ライブラリディレクトリID。新規作成時で、不明な場合は0。その他は必ず指定すること。\r\n     * @param {Number} libraryId ライブラリID。新規ライブラリの場合は0\r\n     * @param {Object} mailFormInfo メール作成ウィンドウのgetFormDataの内容\r\n     * @param {Object} collection 連鎖的に更新するためのオブジェクトコレクション\r\n     * @param {Boolean} readOnly 読み取り専用。trueの場合は読み取り専用（編集不可）\r\n     */\r\n    this.doLibWin = function(libraryDirId, libraryId, mailFormInfo, collection, readOnly) {\r\n        console.log(\"ライブラリウィンドウ表示\", libraryDirId, libraryId, mailFormInfo);\r\n        if (libraryId > 0) {\r\n            // サーバからライブラリ情報を取得する。エラーの場合、処理続行しない\r\n            var libraryData = getJSONSync(\"library/id/\" + libraryId);\r\n        }\r\n\r\n        var winName = \"libWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 1200, 750);\r\n            win.setText(\"ライブラリの作成・編集\");\r\n            win.hide();\r\n        }\r\n        var attachments = {}; // 添付ファイルマップ。キーは実ファイル名、バリューはサーバ上のファイル名\r\n        var ckeditor = null; // CKEditor（本文入力欄）\r\n        // 中身の用意\r\n        var mailForm = win.attachForm();\r\n        mailForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MAIL_LIB_FORM_JSON), \"json\", function() {\r\n            // 値の設定\r\n            mailForm.setItemValue(\"libraryDirId\", libraryDirId);\r\n            mailForm.setItemValue(\"libraryId\", libraryId);\r\n            mailForm.setItemValue(\"employeeId\", _ghUser.getGhId());\r\n            // プルダウンの設定\r\n            mailForm.reloadOptions(\"approvalSelect\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.LIB_APPROVE));\r\n            // CKEditorの設定\r\n            CKEDITOR.config.height = \"400px\";\r\n            CKEDITOR.config.width = \"950px\";\r\n            ckeditor = CKEDITOR.replace( \"libBodyTextarea\", _GH.WINS.CKEDITOR.LIB);\r\n            // ペースト時に画像があったら強制的に削除する\r\n            ckeditor.on( 'paste', function( evt ) {\r\n                var originalPasteText = evt.data.dataValue;\r\n                var foundMailImges = originalPasteText.match(/<img.*?>/gi);\r\n                _.forEach(foundMailImges, function(imageStr) {\r\n                    // 置換\r\n                    originalPasteText = originalPasteText.split(_.escape($(imageStr)[0].src)).join(\"\\\" alt=\\\"この画像はペーストできません。「画像の挿入」ボタンから画像を登録してください。\");\r\n                });\r\n                evt.data.dataValue = originalPasteText;\r\n            });\r\n            // フォームの中身をセット\r\n            if (libraryId > 0) {\r\n                mailForm.setFormData(libraryData);\r\n                ckeditor.setData(mailForm.getItemValue(\"mailBody\"));\r\n                // 承認ステータスによる制御\r\n                var libraryApprovalStatus = libraryData[\"libraryApprovalStatus\"]; // 申請ステータス\r\n                var libraryApprovalFlg = libraryData[\"libraryApprovalFlg\"]; // 承認フラグ\r\n                mailForm.setItemValue(\"approvalStatusLabel\", getLibraryApprovalStatusName(libraryApprovalStatus, libraryData[\"libraryApprovalFlg\"]));\r\n                var lockApproveArea = function() {\r\n                    mailForm.hideItem(\"referArea\");\r\n                    mailForm.hideItem(\"approveArea\");\r\n                    mailForm.lock();\r\n                    try {\r\n                        ckeditor.setReadOnly();\r\n                    } catch(e) {\r\n                        //TODO CKEditor内でエラーになるが処理自体はされているため、握りつぶす。\r\n                        console.log(\"ckeditor.setReadOnly()\", e);\r\n                    }\r\n                };\r\n                var isManager = _ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MANAGER);\r\n                var isMarketing = _ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MARKETING);\r\n                switch(libraryApprovalStatus) {\r\n                    case _GH.S05F030Lib.APPROVAL_STATUS.NONE: // 非申請\r\n                    case _GH.S05F030Lib.APPROVAL_STATUS.DISMISSAL: // 差戻し\r\n                        if (isMarketing  || isManager) {\r\n                            mailForm.hideItem(\"referArea\");\r\n                        } else {\r\n                            mailForm.hideItem(\"approveArea\");\r\n                        }\r\n                        break;\r\n                    case _GH.S05F030Lib.APPROVAL_STATUS.MANAGER: // 申請（上長）\r\n                    case _GH.S05F030Lib.APPROVAL_STATUS.MARKET: // 申請（マーケ）\r\n                        if (isManager || isMarketing) {\r\n                            mailForm.hideItem(\"referArea\");\r\n                        } else {\r\n                            lockApproveArea();\r\n                        }\r\n                        break;\r\n                    case _GH.S05F030Lib.APPROVAL_STATUS.ACCEPT: // 承認\r\n                        if (isManager) {\r\n                            // 上長承認の場合、マーケへの承認はできるようにする。\r\n                            if (libraryApprovalFlg == _GH.S05F030Lib.APPROVE_FLG.MGR) {\r\n                                // マネージャへの依頼は不要\r\n                                mailForm.reloadOptions(\"approvalSelect\",\r\n                                        removePropOptions(_prop.getOptionsWithEmpty(_GH.CODE_DEF.LIB_APPROVE),\r\n                                                [_GH.S05F030Lib.APPROVAL_STATUS.MANAGER]));\r\n                            } else {\r\n                                lockApproveArea();\r\n                            }\r\n                        } else if (isMarketing) {\r\n                            // マーケの場合、承認依頼は不要。\r\n                            mailForm.hideItem(\"referArea\");\r\n                        } else {\r\n                            lockApproveArea();\r\n                        }\r\n                        break;\r\n                }\r\n                // 添付ファイル\r\n                var uploadedFiles = libraryData[\"attachementURLList\"];\r\n                console.log(\"添付ファイル数\", uploadedFiles.length, uploadedFiles);\r\n                if (uploadedFiles.length > 0) {\r\n                    mailForm.showItem(\"uploadedFiles\");\r\n                    _.forEach(uploadedFiles, function(filepath, i){\r\n                        // extract file name from path\r\n                        var p = filepath.match(/\\?fileName=(.+)/);\r\n                        if (p) {\r\n                            p = decodeURIComponent(p[1]);\r\n                        } else {\r\n                            p = filepath;\r\n                        }\r\n                        var splitPaths = p.split('/');\r\n                        var filename = splitPaths[(splitPaths.length - 1)];\r\n                        mailForm.addItem(\"uploadedFiles\",\r\n                                {type: \"template\", label: \"添付ファイル\" + (i + 1), name: \"uploadedFile_\" + i, position:\"label-left\"\r\n                                    ,value: \"<a href=\\\"\"  + filepath + \"\\\">\" + filename + \"</a>\"\r\n                                    ,userdata: {filename: filename, filepath: filepath}}, i);\r\n                        attachments[filename] = filepath;\r\n                    });\r\n                }\r\n                // 読み取り専用モード\r\n                if (readOnly) {\r\n                    mailForm.lock();\r\n                }\r\n                mailForm.getUploader('attachmentFiles').setURL(_GHAPI.SERVER + _GH.URL('FILE_UPLOAD_URL'));\r\n            } else {\r\n                if (is(\"Object\", mailFormInfo)) {\r\n                    // ライブラリIDがない場合は、メールフォーム情報から構築する。\r\n                    mailForm.setFormData(mailFormInfo);\r\n                    ckeditor.setData(mailFormInfo[\"body\"]);\r\n                }\r\n                // メール件名が空の場合、デフォルトを入れる。\r\n                if (_.isEmpty(mailForm.getItemValue(\"mailSubject\"))) {\r\n                    mailForm.setItemValue(\"mailSubject\", _GH.WINS.MAIL_SUBJECT);\r\n                }\r\n                mailForm.disableItem(\"referTypeBtn\");// 保存するまでは有効にならない\r\n                mailForm.hideItem(\"approveArea\"); // 承認覧は不要\r\n                mailForm.hideItem(\"uploadedFiles\"); // アップロード一覧は不要\r\n            }\r\n        });\r\n        // メールフォームのクリックイベント設定\r\n        mailForm.attachEvent('onButtonClick', function(name/*, command*/){\r\n            switch(name) {\r\n                case \"sendTestEmailBtn\": // テスト送信\r\n                    mailForm.setItemValue(\"subject\", mailForm.getItemValue(\"mailSubject\"));\r\n                    that.sendTestMail(mailForm, ckeditor, attachments, [_GH.DUMMY_CUST_ID]);\r\n                    break;\r\n                case \"saveLibraryBtn\": // ライブラリ保存\r\n                    if(mailForm.getItemValue(\"libraryId\") > 0){\r\n                        that.updateTemplate(winName, mailForm, ckeditor, attachments, collection);\r\n                    } else {\r\n                        that.createTemplate(winName, mailForm, ckeditor, attachments, collection);\r\n                    }\r\n                    break;\r\n                case \"referTypeBtn\": // 承認依頼\r\n                    that.requestJudgeLibrary(winName, mailForm, ckeditor);\r\n                    break;\r\n                case \"approveBtn\": // 承認\r\n                    var approvalLevel;\r\n                    if (_ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MARKETING)) {\r\n                        approvalLevel = _GH.S05F030Lib.APPROVE_FLG.MKT;\r\n                    } else if (_ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MANAGER)) {\r\n                        approvalLevel = _GH.S05F030Lib.APPROVE_FLG.MGR;\r\n                    }\r\n                    console.log(\"承認\", approvalLevel);\r\n                    if (approvalLevel) {\r\n                        that.changeApprovalLibrary(winName, mailForm, ckeditor, approvalLevel, _GH.S05F030Lib.APPROVAL_STATUS.ACCEPT);\r\n                    }\r\n                    break;\r\n                case \"passbackBtn\": // 差戻し\r\n                    that.changeApprovalLibrary(winName, mailForm, ckeditor,\r\n                            _GH.S05F030Lib.APPROVE_FLG.DISMISSAL, _GH.S05F030Lib.APPROVAL_STATUS.DISMISSAL);\r\n                    break;\r\n            }\r\n        });\r\n        // フォーカスイベント設定\r\n        mailForm.attachEvent('onFocus', function(name/*, command*/){\r\n            switch(name) {\r\n                case \"eventName\": // 物件ウィンドウを開く\r\n                    that.doEvent(this.getInput(\"eventId\"), this.getInput(\"eventName\"), mailForm);\r\n                    break;\r\n            }\r\n        });\r\n        that.setFileUploadEvents(mailForm, attachments);\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 署名編集ウィンドウ\r\n     * @param {Number} employeeId 社員ID。指定がなければログインユーザのものを使う。\r\n     */\r\n    this.doSignatureWin = function(employeeId) {\r\n        if (_.isEmpty(employeeId)) {\r\n            employeeId = _ghUser.getGhId();\r\n        }\r\n        var winName = \"signatureWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 850, 700);\r\n            win.setText(\"署名の編集\");\r\n            win.hide();\r\n        }\r\n        var ckeditor = null; // CKEditor（本文入力欄）\r\n        // 中身の用意\r\n        var mailForm = win.attachForm();\r\n        mailForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MAIL_SIG_FORM_JSON), \"json\", function() {\r\n            // CKEditorの設定\r\n            CKEDITOR.config.height = \"400px\";\r\n            ckeditor = CKEDITOR.replace( \"signatureBodyTextarea\", _GH.WINS.CKEDITOR.LIB);\r\n            // フォームの中身をセット\r\n            var libraryData = getJSONSync(\"library/signature/\" + employeeId);\r\n            mailForm.setFormData(libraryData);\r\n            ckeditor.setData(mailForm.getItemValue(\"mailBody\"));\r\n        });\r\n        // メールフォームのクリックイベント設定\r\n        mailForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch (name) {\r\n                case \"saveSignatureBtn\": // 署名保存\r\n                    mailForm.updateValues();\r\n                    if (_.isEmpty(ckeditor.getData())) {\r\n                        dhtmlx.alert({\r\n                            title:\"署名本文チェックエラー\",\r\n                            type:\"alert-error\",\r\n                            text:\"署名の本文が入力されていません。<BR>本文は必ず入力してください。\"\r\n                        });\r\n                    } else {\r\n                        var param = mailForm.getFormData();\r\n                        param[\"mailKbn\"] = _GH.S05F030Lib.MAILKBN.SIGNATURE;\r\n                        param[\"employeeId\"] = employeeId;\r\n                        param[\"mailBody\"] = ckeditor.getData();\r\n                        var uri = (mailForm.getItemValue(\"libraryId\") > 0)? \"library/update\": \"library/create\";\r\n                        syncPutJSON(uri, param);\r\n                        win.close();\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * メール内容確認ウィンドウ\r\n     * @param {Number} mailSeqId メールシーケンスID\r\n     */\r\n    this.doMailReferWin = function(mailSeqId) {\r\n        console.log(\"メール内容確認ウィンドウ表示\", mailSeqId, CKEDITOR.config.plugins);\r\n        if (mailSeqId <= 0) {\r\n            return;\r\n        }\r\n        var winName = \"mailReferWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 815, 700);\r\n            win.setText(\"メール内容確認\");\r\n            win.hide();\r\n        }\r\n        var attachments = {}; // 添付ファイルマップ。キーは実ファイル名、バリューはサーバ上のファイル名\r\n        var ckeditor = null; // CKEditor（本文入力欄）\r\n        // 中身の用意\r\n        var mailForm = win.attachForm();\r\n        mailForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MAIL_REF_JSON), \"json\", function() {\r\n            // CKEditorの設定\r\n            CKEDITOR.config.height = \"400px\";\r\n            ckeditor = CKEDITOR.replace( \"mailReferTextarea\", _GH.WINS.CKEDITOR.REF);\r\n            // フォームの中身をセット\r\n            var libraryData = getJSONSync(\"sendmail/personalMail/\" + mailSeqId);\r\n            mailForm.setFormData(libraryData);\r\n            ckeditor.setData(mailForm.getItemValue(\"mailBody\"));\r\n            // 添付ファイル\r\n            var uploadedFiles = libraryData[\"attachementURLList\"];\r\n            console.log(\"添付ファイル数\", uploadedFiles.length, uploadedFiles);\r\n            if (uploadedFiles.length > 0) {\r\n                _.forEach(uploadedFiles, function(filepath, i){\r\n                    var splitPaths = filepath.split(\"/\");\r\n                    var filename = splitPaths[(splitPaths.length - 1)];\r\n                    mailForm.addItem(\"uploadedFiles\",\r\n                            {type: \"template\", label: \"添付ファイル\" + (i + 1), name: \"uploadedFile_\" + i, position:\"label-left\"\r\n                                ,value: \"<a href=\\\"/\"  + filepath + \"\\\">\" + filename + \"</a>\"}, i);\r\n                    attachments[filename] = filepath;\r\n                });\r\n            } else {\r\n                // 添付ファイルなし\r\n                mailForm.hideItem(\"uploadedFiles\");\r\n            }\r\n            mailForm.lock();\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 案内・来場予約作成・編集ウィンドウ\r\n     * @param {Object} personalInfo 顧客情報\r\n     * @param {Number} scheduleId スケジュールID（編集時に必要）\r\n     * @param model\r\n     */\r\n    this.doScheduleWindow = function (personalInfo, scheduleId, model, afterFunction) {\r\n        var winName = \"scheduleWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 625, 660);\r\n            win.setText(\"スケジュール登録・編集ウィンドウ\");\r\n            win.hide();\r\n        }\r\n        // 中身の用意\r\n        var scheduleForm = win.attachForm();\r\n        scheduleForm.loadStruct(getTemplatePath(_GH.DATA_PATH.SCHD_LIGHT_FORM_JSON), \"json\", function() {\r\n            // リストの設定\r\n            scheduleForm.reloadOptions(\"recruitStatus\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.STATUS));\r\n            scheduleForm.reloadOptions(\"deleteReason\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.SCHED_DEL_REASON));\r\n            if (scheduleId > 0) {\r\n                // 既存データを取得し、反映する。\r\n                var schedData = getJSONSync(\"schedules/id/\" + scheduleId);\r\n                scheduleForm.setFormData(schedData);\r\n            } else {\r\n                // スケジュールIDがない場合は、新規作成\r\n                scheduleForm.setItemValue(\"personalId\", personalInfo[\"personalId\"]); // 顧客ID\r\n                scheduleForm.setItemValue(\"entryId\", personalInfo[\"entryId\"]); // 顧客ID\r\n                scheduleForm.setItemValue(\"personalFullName\", personalInfo[\"lastName\"] + \" \" + personalInfo[\"firstName\"]); // 顧客名\r\n                scheduleForm.setItemValue(\"organizer\", _ghUser.getGhId()); // 案内者ID（ログインユーザ）\r\n                scheduleForm.setItemValue(\"organizerFullName\", _ghUser.getName()); // 案内者名（ログインユーザ）\r\n                // 開始日を現在時刻の３０分切り上げ、終了日を＋2時間とする。\r\n                var currentDate = new Date();\r\n                if (currentDate.getMinutes() < 30) {\r\n                    currentDate.setMinutes(30);\r\n                } else {\r\n                    currentDate.setHours(currentDate.getHours() + _GH.FORMAT.SCHD_INTERVAL);\r\n                    currentDate.setMinutes(0);\r\n                }\r\n                scheduleForm.setItemValue(\"scheduleTimeFrom\", currentDate);\r\n                currentDate.setHours(currentDate.getHours() + _GH.FORMAT.SCHD_INTERVAL);\r\n                scheduleForm.setItemValue(\"scheduleTimeTo\", currentDate);\r\n                scheduleForm.hideItem(\"deleteReasonArea\");\r\n            }\r\n        });\r\n        // 保存ボタンのクリックイベント設定\r\n        scheduleForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            scheduleForm.updateValues();\r\n            switch (name) {\r\n                case \"saveScheduleBtn\": // 保存ボタン\r\n                    setActDataOfSchedule(scheduleForm);\r\n                    if (scheduleForm.validate()) {\r\n                        // 過去日付登録チェック\r\n                        if (!isDateInRange(scheduleForm.getItemValue(\"scheduleTimeFrom\"), 7)) {\r\n                            if (!confirm(_MSG.S07F020.M_001)) return;\r\n                        }\r\n                        // 戸建：案内種別チェック \"scheduleStatus\"\r\n                        if (!scheduleForm.getItemValue(\"scheduleStatus\")) {\r\n                            dhtmlx.message({\r\n                                type:\"error\",\r\n                                text: \"案内種類（来社、案内、待ち合わせなど）は必須入力です。\"\r\n                            });\r\n                            return;\r\n                        }\r\n                        // 削除確認\r\n                        if (!_.isEmpty(scheduleForm.getItemValue(\"deleteReason\"))) {\r\n                            if (!confirm(_MSG.S07F020.M_002)) return;\r\n                        }\r\n                        var recruitStatusName = _prop.getPropName(_GH.CODE_DEF.STATUS, scheduleForm.getItemValue(\"recruitStatus\"));\r\n                        scheduleForm.setItemValue(\"scheduleTitle\", \"【採用】\" + recruitStatusName + \":\" + scheduleForm.getItemValue(\"personalFullName\"));\r\n                        var uri = (scheduleId > 0)? \"schedules/update\": \"schedules/regist\";\r\n                        saveForm(scheduleForm, uri, afterFunction);\r\n                        win.close();\r\n                        if (scheduleId > 0){\r\n                            if(model){model.update();}\r\n                        } else {\r\n                            if(model){model.append();}\r\n                        }\r\n                    }\r\n                    break;\r\n                case \"showScheduleBtn\": // スケジュール表示ボタン\r\n                    window.open(\"schedule.html\");\r\n                    break;\r\n            }\r\n        });\r\n        // フォーカスイベント設定\r\n        scheduleForm.attachEvent('onFocus', function (name/*, command*/) {\r\n            switch (name) {\r\n                // 物件ウィンドウを表示する。\r\n                case \"organizerFullName\":\r\n                    that.doTantoWin(this.getInput(\"organizer\"), this.getInput(\"organizerFullName\"));\r\n                    break;\r\n                case \"attendeeFullName1\":\r\n                    that.doTantoWin(this.getInput(\"attendee1\"), this.getInput(\"attendeeFullName1\"));\r\n                    break;\r\n                case \"attendeeFullName2\":\r\n                    that.doTantoWin(this.getInput(\"attendee2\"), this.getInput(\"attendeeFullName2\"));\r\n                    break;\r\n                case \"attendeeFullName3\":\r\n                    that.doTantoWin(this.getInput(\"attendee3\"), this.getInput(\"attendeeFullName3\"));\r\n                    break;\r\n            }\r\n        });\r\n        // 入力欄の変更イベント\r\n        scheduleForm.attachEvent(\"onChange\", function (name/*, value, form*/) {\r\n            var fromTime;\r\n            switch (name) {\r\n                case \"scheduleTimeFrom\": // 案内日時（開始）\r\n                    // 案内日時（終了）に２時間後の値を入れる。\r\n                    fromTime = scheduleForm.getItemValue(\"scheduleTimeFrom\");\r\n                    fromTime.setHours(fromTime.getHours() + _GH.FORMAT.SCHD_INTERVAL);\r\n                    scheduleForm.setItemValue(\"scheduleTimeTo\", fromTime);\r\n                    break;\r\n                case \"scheduleTimeTo\": // 案内日時（終了）\r\n                    // 案内日時（開始）に終了日と同じ年月日を入れる。\r\n                    fromTime = scheduleForm.getItemValue(\"scheduleTimeFrom\");\r\n                    var toTime = scheduleForm.getItemValue(\"scheduleTimeTo\");\r\n                    fromTime.setFullYear(toTime.getFullYear());\r\n                    fromTime.setMonth(toTime.getMonth());\r\n                    fromTime.setDate(toTime.getDate());\r\n                    scheduleForm.setItemValue(\"scheduleTimeFrom\", fromTime);\r\n                    break;\r\n            }\r\n        });\r\n        // バリデートエラー時の処理\r\n        scheduleForm.attachEvent(\"onValidateError\", function (name/*, value, result*/) {\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: scheduleForm.getItemLabel(name) + \"は必ず入力してください。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 顧客詳細ウィンドウ\r\n     *\r\n     * @param {Number} personalId 顧客ID\r\n     * @param {Boolean} readonly 読み込み専用フラグ。trueの場合は読み込み専用\r\n     * @param {object} personalModel 顧客情報更新通知用オブジェクト。画面の更新を行う\r\n     * @param {object} reportModel 指示報告更新通知用オブジェクト。画面の更新を行う\r\n     * @param {object} scheduleModel 案内予約更新通知用オブジェクト。画面の更新を行う\r\n     */\r\n    this.doPersonalWindow = function(personalId, readonly, personalModel, reportModel, scheduleModel) {\r\n        // 顧客情報フォーム\r\n        var winName = \"custWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(\"custWin\", 20, 30, 1124, 750);\r\n            win.setText(\"顧客詳細ウィンドウ\");\r\n            win.hide();\r\n        }\r\n        var winLayout = win.attachLayout(\"1C\");\r\n        winLayout.cells(\"a\").hideHeader();\r\n        // 中身の用意\r\n        var custForm = winLayout.cells(\"a\").attachForm();\r\n        custForm.loadStruct(getTemplatePath(_GH.DATA_PATH.CUSTWIN_JSON), \"json\", function() {\r\n            // 性別のオプション設定\r\n            custForm.reloadOptions(\"gender\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.GENDER));\r\n            custForm.reloadOptions(\"subGender\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.GENDER));\r\n            // メール許可のオプション設定\r\n            custForm.reloadOptions(\"emailstatus\", _prop.getOptions(_GH.CODE_DEF.EMAIL_STATUS));\r\n            // 都道府県のオプション設定\r\n            custForm.reloadOptions(\"prefecture\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.PREFECTURE));\r\n            // 間取りのオプション設定\r\n            custForm.reloadOptions(\"abodenowfloorplan\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.FLOOR_PLAN));\r\n            // 職業種\r\n            custForm.reloadOptions(\"jobtype\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.JOB_TYPE));\r\n            custForm.reloadOptions(\"subJobtype\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.JOB_TYPE));\r\n            // 戸建価格MIN,MAX, 土地価格MIN,MAX\r\n            custForm.reloadOptions(\"searchhousemin\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.HOPE_BUGET));\r\n            custForm.reloadOptions(\"searchhousemax\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.HOPE_BUGET));\r\n            custForm.reloadOptions(\"searchlandmin\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.HOPE_BUGET));\r\n            custForm.reloadOptions(\"searchlandmax\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.HOPE_BUGET));\r\n            // 現況住まい種類\r\n            custForm.reloadOptions(\"abodenowbuildingtype\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.BUILDING_TYPE));\r\n            // 買替有無\r\n            custForm.reloadOptions(\"abodenowreplacement\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.RE_BUY));\r\n            // 購入目的・検討理由\r\n            custForm.reloadOptions(\"purchasepurpose\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.BUY_PURPOSE));\r\n            custForm.reloadOptions(\"reason\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.BUY_REASON));\r\n            // WEB会員状態\r\n            custForm.reloadOptions(\"webMemberSTATUS\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.WEBMEMBER_STATUS));\r\n            // 追わない理由\r\n            custForm.reloadOptions(\"personalstatusreason\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.STATUS_REASON));\r\n            // 電話ステータス\r\n            custForm.reloadOptions(\"telstatus\", _prop.getOptions(_GH.CODE_DEF.TEL_STATUS));\r\n            // 自分フラグ\r\n            custForm.reloadOptions(\"empflg\", _prop.getOptions(_GH.CODE_DEF.FLG));\r\n            custForm.reloadOptions(\"managerflg\", _prop.getOptions(_GH.CODE_DEF.FLG));\r\n            custForm.reloadOptions(\"centermanagerflg\", _prop.getOptions(_GH.CODE_DEF.FLG));\r\n            // プロテクト\r\n            custForm.reloadOptions(\"protect\", _prop.getOptions(_GH.CODE_DEF.PROTECT));\r\n            // ランクのオプション設定\r\n            custForm.reloadOptions(\"emplevel\", _prop.getOptions(_GH.CODE_DEF.RANK));\r\n            custForm.reloadOptions(\"managerlevel\", _prop.getOptions(_GH.CODE_DEF.RANK));\r\n            // 設計変更\r\n            // DM対象\r\n\r\n            // 顧客検索\r\n            var custData = getJSONSync(\"personal/id/\" + personalId);\r\n            // 間取りの設定(戸建はセレクト、MSはチェックボックス）\r\n            if (_ghUser.isNon()) {\r\n                custForm.reloadOptions(\"floorplan\", _prop.getOptionsWithEmpty(_GH.CODE_DEF.FLOOR_PLAN));\r\n            } else {\r\n                setBitOperationValueAtCheckbox(custData, \"floorplan\", _GH.S03F010CM.FLOOR_CHK);\r\n            }\r\n            // 顧客ステータスのオプション設定\r\n            var custStatus = custData[\"personalstatus\"];\r\n            if (custStatus == _GH.S03F010CM.CUST_CLAIM) {\r\n                custForm.showItem(\"displayClaimStatus\");\r\n                custForm.reloadOptions(\"personalstatus\", _prop.getOptions(_GH.CODE_DEF.STATUS));\r\n            } else {\r\n                custForm.reloadOptions(\"personalstatus\", removePropOptions(_prop.getOptions(_GH.CODE_DEF.STATUS), [_GH.S03F010CM.CUST_CLAIM]));\r\n                // クレーム以外のステータス\r\n                if (custData[\"contractFlg\"] == 1 || custStatus == _GH.S03F010CM.CUST_CONTRACT) {\r\n                    // 契約の場合\r\n                    custForm.showItem(\"displayOtherStatusBlue\");\r\n                    custForm.setItemValue(\"displayOtherStatusBlue\", \"契約済\");\r\n                } else if (custStatus != _GH.S03F010CM.CUST_GO) {\r\n                    // 追客以外\r\n                    custForm.showItem(\"displayOtherStatusGreen\");\r\n                    custForm.setItemValue(\"displayOtherStatusGreen\", _prop.getPropName(_GH.CODE_DEF.STATUS, custStatus));\r\n                }\r\n            }\r\n\r\n            // 値が無い場合の初期値の設定\r\n            var mailSelect = custForm.getSelect(\"emailstatus\");\r\n            mailSelect.value = _prop.getValueFromPropName(_GH.CODE_DEF.EMAIL_STATUS, \"一斉・個別OK\");\r\n            var emplevelSelect = custForm.getSelect(\"emplevel\");\r\n            emplevelSelect.value = _prop.getValueFromPropName(_GH.CODE_DEF.RANK, \"★なし\");\r\n\r\n            custForm.setFormData(custData);\r\n            // 権限による自分フラグの表示設定\r\n            if (!_ghUser.isManager() && !_ghUser.isShien()) {\r\n                // 課員\r\n                custForm.disableItem(\"managerflg\");\r\n                custForm.disableItem(\"centermanagerflg\");\r\n                custForm.hideItem(\"managerlevel\");\r\n                custForm.hideItem(\"leadersmemo\");\r\n            }\r\n            // プロテクト権限の有無\r\n            if (_ghUser.hasRole(_GH.ROLE.PROTECT_PERSONAL_CHANGE) && _.parseInt(custForm.getItemValue(\"employeeId\")) !== 0) {\r\n                custForm.enableItem(\"protect\");\r\n            } else {\r\n                custForm.disableItem(\"protect\");\r\n            }\r\n            // 担当者の有無(自分フラグとプロテクトの利用可否が決まる）\r\n            if (custData[\"employeeId\"] == 0){\r\n                custForm.disableItem(\"empflg\");\r\n                custForm.disableItem(\"managerflg\");\r\n                custForm.disableItem(\"centermanagerflg\");\r\n            } else {\r\n                custForm.enableItem(\"empflg\");\r\n                custForm.enableItem(\"managerflg\");\r\n                custForm.enableItem(\"centermanagerflg\");\r\n            }\r\n            // ツールバーの設定\r\n            var custToolbar = winLayout.attachToolbar();\r\n            that.setPersonalWinToolbar(win, custToolbar, custForm, personalModel, reportModel, scheduleModel);\r\n        });\r\n        // 入力値の変更チェック\r\n        var formChange = false;\r\n        custForm.attachEvent(\"onBeforeChange\", function (name, old_value, new_value){\r\n            formChange = (old_value !== new_value);\r\n            if (name == \"personalstatus\") {\r\n                // ステータスを契約にした場合、契約済みフラグ/設計変更フラグを立てる。\r\n                if (new_value == _GH.S03F010CM.CUST_CONTRACT) {\r\n                    if (confirm(_MSG.S03F010.M_001)) {\r\n                        custForm.setItemValue(\"makeContractActFlg\", 1);\r\n                        custForm.checkItem(\"contractFlg\");\r\n                        custForm.checkItem(\"designupdate\");\r\n                    } else {\r\n                        custForm.setItemValue(\"makeContractActFlg\", 0);\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        // ボタンクリックイベント\r\n        custForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch(name) {\r\n                case \"addressDialogLinkBtn\": // 郵便番号検索ウィンドウを表示\r\n                    _ghWins.doPostWindow(this.getInput(\"zipcode\"), this.getSelect(\"prefecture\"), this.getInput(\"address\"), this.getInput(\"otherAddress\"));\r\n                    break;\r\n            }\r\n        });\r\n        // フォーカスイベント\r\n        custForm.attachEvent(\"onFocus\", function(name){\r\n            // 希望地域１，２\r\n            if (name == \"searchword1\") {\r\n                that.doKiboAreaWin(this.getInput(\"searchword1\"), false, custForm);\r\n            } else if (name == \"searchword2\") {\r\n                that.doKiboAreaWin(this.getInput(\"searchword2\"), false, custForm);\r\n            } else if (name == \"companyRailwayLineName\" || name == \"companyStationName\") {\r\n                // 主・勤務先駅沿線\r\n                _ghWins.doEnsenWin(this.getInput(\"companyrailwayline\"), this.getInput(\"companyRailwayLineName\"),\r\n                        this.getInput(\"companystation\"), this.getInput(\"companyStationName\"),\r\n                        null, null, custForm);\r\n            } else if (name == \"subCompanyRailwayLineName\" || name == \"subCompanyStationName\") {\r\n                // 副・勤務先駅沿線\r\n                _ghWins.doEnsenWin(this.getInput(\"subCompanyrailwayline\"), this.getInput(\"subCompanyRailwayLineName\"),\r\n                        this.getInput(\"subCompanystation\"), this.getInput(\"subCompanyStationName\"),\r\n                        null, null, custForm);\r\n            } else if (name == \"searchRailwayLineName1\" || name == \"searchStationFromName1\" || name == \"searchStationToName1\") {\r\n                // 希望沿線1\r\n                _ghWins.doEnsenWin(this.getInput(\"searchrailwayline1\"), this.getInput(\"searchRailwayLineName1\"),\r\n                        this.getInput(\"searchstationfrom1\"), this.getInput(\"searchStationFromName1\"),\r\n                        this.getInput(\"searchstationto1\"), this.getInput(\"searchStationToName1\"), custForm);\r\n            } else if (name == \"searchRailwayLineName2\" || name == \"searchStationFromName2\" || name == \"searchstationtoName2\") {\r\n                // 希望沿線2\r\n                _ghWins.doEnsenWin(this.getInput(\"searchrailwayline2\"), this.getInput(\"searchRailwayLineName2\"),\r\n                        this.getInput(\"searchstationfrom2\"), this.getInput(\"searchStationFromName2\"),\r\n                        this.getInput(\"searchstationto2\"), this.getInput(\"searchStationToName2\"), custForm);\r\n            }\r\n        });\r\n        custForm.attachEvent(\"onChange\", function (name, value){\r\n            switch (name) {\r\n                case \"emplevel\": // ランク（担当者）\r\n                    // 選択したランクに合わせて、メールステータスをおすすめのものに変える。\r\n                    setRecommendMailStatusAlongWithRank(custForm, value);\r\n                    break;\r\n                case \"birthday\": // 誕生日から年齢の設定\r\n                    this.setItemValue(\"age\", getAge(this.getItemValue(name)));\r\n                    break;\r\n                case \"subBirthday\": // 誕生日から年齢の設定\r\n                    this.setItemValue(\"subAge\", getAge(this.getItemValue(name)));\r\n                    break;\r\n                case \"address\": // 住所から郵便番号を逆引き\r\n                case \"otherAddress\": // 以下住所から郵便番号を逆引き\r\n                    setZipCodeFromAddress(this);\r\n                    break;\r\n                case \"lastNameKana\":\r\n                case \"firstNameKana\":\r\n                case \"subLastNameKana\":\r\n                case \"subFirstNameKana\":\r\n                    var toKatakana = hiraganaCodeToKatakanaCode(value);\r\n                    toKatakana = toZenkaku(toKatakana);\r\n                    custForm.setItemValue(name, toKatakana);\r\n                    break;\r\n            }\r\n\r\n            // 数値は全て半角にする\r\n            if(custForm.getItemType(name) === \"input\"){\r\n                var inputed = custForm.getItemValue(name);\r\n                inputed = toHankaku(inputed);\r\n                // 一部、ハイフンが入る物を半角ハイフンに変換する\r\n                var transHyphen = [\r\n                    \"tel1\", \"tel2\", \"tel3\", \"tel4\", \"fax\",\r\n                    \"email1\", \"email2\", \"email3\", \"email4\",\r\n                    \"zipcode\", \"otherAddress\",\r\n                    \"companyaddress\", \"subcompanyaddress\"\r\n                ];\r\n                if(_.include(transHyphen, name)){\r\n                    inputed = toHankakuHyphen(inputed);\r\n                }\r\n                custForm.setItemValue(name, inputed);\r\n            }\r\n        });\r\n\r\n        win.button(\"close\").attachEvent(\"onClick\", function(){\r\n            if (formChange) {\r\n                if (confirm(\"顧客情報が変更されています。変更を保存しますか？\")) {\r\n                    personalModel.update(custForm, \"custWin\");\r\n                }\r\n            }\r\n            win.close();\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 顧客詳細ウィンドウのツールバーの設定を行います。\r\n     */\r\n    this.setPersonalWinToolbar = function(win, custToolbar, custForm, personalModel, reportModel, scheduleModel) {\r\n        custToolbar.setIconsPath(_GH.PATH_TYPE.DHX_ICONS);\r\n        custToolbar.setIconSize(_GH.ICON_SIZE);\r\n        custToolbar.loadStruct(getTemplatePath(_GH.DATA_PATH.CUSTWIN_MENU_XML), function(){\r\n            // MS、かつ、プロテクト変更権限\r\n            if (_ghUser.isExp()) {\r\n                if (_ghUser.hasRole(_GH.ROLE.PROTECT_PERSONAL_CHANGE) && _.parseInt(custForm.getItemValue(\"employeeId\")) !== 0) {\r\n                    custToolbar.enableItem(\"detailMenuProtect\");\r\n                } else {\r\n                    custToolbar.disableItem(\"detailMenuProtect\");\r\n                }\r\n            }\r\n            // 担当者の有無(自分フラグ・プロテクト、担当への転送の利用可否が決まる）\r\n            if (_.parseInt(custForm.getItemValue(\"employeeId\")) === 0){\r\n                custToolbar.disableItem(\"detailMenuFlag\");\r\n                custToolbar.disableItem(\"detailMenuTransfer\");\r\n            } else {\r\n                custToolbar.enableItem(\"detailMenuFlag\");\r\n                custToolbar.enableItem(\"detailMenuTransfer\");\r\n            }\r\n\r\n            // 電話、メールの各ステータスごとに不許可の場合にはデータを隠す\r\n            var telNG = _prop.getValueFromPropName(_GH.CODE_DEF.TEL_STATUS, \"電話不可\");\r\n            if(custForm.getItemValue(\"telstatus\") == telNG){\r\n                custForm.hideItem(\"tel1\");\r\n                custForm.hideItem(\"telsupple1\");\r\n                custForm.hideItem(\"tel2\");\r\n                custForm.hideItem(\"telsupple2\");\r\n                custForm.hideItem(\"tel3\");\r\n                custForm.hideItem(\"telsupple3\");\r\n                custForm.hideItem(\"tel4\");\r\n                custForm.hideItem(\"telsupple4\");\r\n                custForm.hideItem(\"fax\");\r\n                custToolbar.disableItem(\"detailMenuExcel\");\r\n            }\r\n            var emailNG = _prop.getValueFromPropName(_GH.CODE_DEF.EMAIL_STATUS, \"ダメ全部NG\");\r\n            if(custForm.getItemValue(\"emailstatus\") == emailNG){\r\n                custForm.hideItem(\"email1\");\r\n                custForm.hideItem(\"emailsupple1\");\r\n                custForm.hideItem(\"emailsendableflg1\");\r\n                custForm.hideItem(\"email2\");\r\n                custForm.hideItem(\"emailsupple2\");\r\n                custForm.hideItem(\"emailsendableflg2\");\r\n                custForm.hideItem(\"email3\");\r\n                custForm.hideItem(\"emailsupple3\");\r\n                custForm.hideItem(\"emailsendableflg3\");\r\n                custForm.hideItem(\"email4\");\r\n                custForm.hideItem(\"emailsupple4\");\r\n                custForm.hideItem(\"emailsendableflg4\");\r\n                custToolbar.disableItem(\"detailMenuExcel\");\r\n            }\r\n\r\n            // 電話とメール両方ダメなら、全部隠す\r\n            if(custForm.getItemValue(\"emailstatus\") == emailNG && custForm.getItemValue(\"telstatus\") == telNG){\r\n                custForm.hideItem(\"personalInfo1\");\r\n            }\r\n\r\n            // クレームの場合\r\n            if (_.parseInt(custForm.getItemValue(\"personalstatus\")) === _GH.S03F010CM.CUST_CLAIM) {\r\n                if(_ghUser.isExp()) custToolbar.disableItem(\"detailMenuProtect\");\r\n                custToolbar.disableItem(\"detailMenuFlag\");\r\n                custToolbar.disableItem(\"detailMenuScheduler\");\r\n                custToolbar.disableItem(\"detailMenuTransfer\");\r\n                custToolbar.disableItem(\"detailMenuClaim\");\r\n                custToolbar.disableItem(\"detailMenuExcel\");\r\n                custForm.disableItem(\"personalstatus\");\r\n                custForm.hideItem(\"personalInfo1\");\r\n                custForm.hideItem(\"personalInfo2\");\r\n                custForm.hideItem(\"personalAddress\");\r\n                custForm.hideItem(\"company\");\r\n                custForm.hideItem(\"subCompany\");\r\n                custForm.showItem(\"displayClaimStatus\");\r\n            }\r\n            this.addSpacer(\"sepX\"); // スペイサーを入れて、それより右のメニューを右寄せにする。\r\n        });\r\n        custToolbar.attachEvent(\"onClick\", function(id) {\r\n            var custmerId = custForm.getItemValue(\"personalId\");\r\n            var personalName = custForm.getItemValue(\"lastName\") + \" \" + custForm.getItemValue(\"firstName\");\r\n            var employeeId = custForm.getItemValue(\"employeeId\");\r\n            switch (id) {\r\n                case \"detailMenuFlag\": // 自分フラグ\r\n                    that.changePersonalFlags(custForm, true);\r\n                    dhtmlx.message(\"フラグを更新しました。\");\r\n                    break;\r\n                case \"detailMenuProtect\": // プロテクト\r\n                    that.changePersonalFlags(custForm, false, true);\r\n                    dhtmlx.message(\"プロテクトを更新しました。\");\r\n                    break;\r\n                case \"detailMenuScheduler\": // 案内・来場予約\r\n                    that.doScheduleWindow(custForm.getFormData(), null, scheduleModel);\r\n                    break;\r\n                case \"detailMenuDirect\": // 指示登録\r\n                    that.doReportWindow(custForm.getFormData(), reportModel);\r\n                    break;\r\n                case \"detailMenuTransfer\": // 担当へ転送\r\n                    var lastName = custForm.getItemValue(\"lastName\");\r\n                    var firstName = custForm.getItemValue(\"firstName\");\r\n                    var mailBody = getPersonalInfoAsText(custForm);\r\n                     that.doTransferMailWindow(lastName, firstName, employeeId, mailBody);\r\n                    break;\r\n                case \"detailMenuExcel\": // お客様カード（Excel）出力\r\n                    var query = \"authorizedToken=\" + _ghUser.getAuthToken() + \"&personalId=\" + custmerId;\r\n                    window.open(_GHAPI.SERVER + \"personalCard/download?\" + query, \"_blank\");\r\n                    break;\r\n                case \"detailMenuCharge\": // 担当変更\r\n                    var custEmpMap = {};\r\n                    custEmpMap[custmerId] = custForm.getItemValue(\"employeeId\");\r\n                     that.doChargeWindow(custEmpMap, personalModel, _ghWins.ghWins.window(\"custWin\"));\r\n                    break;\r\n                case \"detailMenuStatus\": // 状態\r\n                    custForm.setItemFocus(\"emplevel\");\r\n                    break;\r\n                case \"detailMenuClaim\": // クレーム\r\n                     that.doClaimWindow(custmerId, personalName, employeeId, personalModel, _ghWins.ghWins.window(\"custWin\"));\r\n                    break;\r\n                case \"detailMenuContract\": // 契約関連\r\n                    dhtmlx.message(\"契約関連\");\r\n                    break;\r\n                case \"detailMenuSave\": // 保存\r\n                    personalModel.update(custForm, \"custWin\");\r\n                    break;\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * クレーム登録ウィンドウ\r\n     * @param personalId Personal ID.\r\n     * @param personalName\r\n     * @param employeeId\r\n     * @param personalModel\r\n     * @param parentWindow\r\n     */\r\n    this.doClaimWindow = function(personalId, personalName, employeeId, personalModel, parentWindow) {\r\n        var win = this.ghWins.window(\"claimWin\");\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(\"claimWin\", 20, 30, 665, 525);\r\n            win.setText(\"クレーム登録ウィンドウ：\" + personalName + \"様\");\r\n            win.hide();\r\n        }\r\n        // 中身の用意\r\n        var claimForm = win.attachForm();\r\n        claimForm.loadStruct(getTemplatePath(_GH.DATA_PATH.CLAIM_JSON), \"json\", function() {\r\n            // 表示設定\r\n            claimForm.setItemValue(\"personalId\", personalId); // 顧客ID\r\n            claimForm.setItemValue(\"employeeId\", employeeId); // 顧客の担当者\r\n            claimForm.setItemValue(\"operatorId\", _ghUser.getGhId()); // 登録者\r\n        });\r\n        // ボタンのクリックイベント設定\r\n        claimForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch (name) {\r\n                case \"claimSaveBtn\": // 保存ボタン\r\n                    claimForm.updateValues();\r\n                    if (claimForm.validate()) {\r\n                        var after = function() {\r\n                            // クレームの対応履歴登録\r\n                            registActHitoryByPost(personalId, _ghUser.getGhId(), _GH.S03F090ACT.ACT.CLAIM, _GH.S03F090ACT.ACT_D.CLAIM,\r\n                                    claimForm.getItemValue(\"claimcause\") + \" / \" + claimForm.getItemValue(\"claimmethod\") + \" / \" + claimForm.getItemValue(\"claimresult\"));\r\n                            // クレーム対象者にメール\r\n                            var sendEmpIds = [employeeId, _ghUser.getGhId(), claimForm.getItemValue(\"claimtargetemployeeId\"), claimForm.getItemValue(\"subclaimtargetemployeeId\"), claimForm.getItemValue(\"claimmanagerId\")];\r\n                            sendMessageToEmployee(sendEmpIds, \"[GH] クレーム登録：\" + personalName + \"様\",\r\n                                    \"<p>GHで【\" + personalName + \"】様がクレーム登録されました。</P><br>\"\r\n                                    + getGHPersonalLink(personalId)+ \"<br><br>\"\r\n                                    + \"【クレーム対象者１】：\" + claimForm.getItemValue(\"claimTargetFullName\") + \"<br>\"\r\n                                    + \"【クレーム対象者２】：\" + claimForm.getItemValue(\"subClaimTargetFullName\") + \"<br>\"\r\n                                    + \"【クレーム責任者】　：\" + claimForm.getItemValue(\"claimManagerFullName\") + \"<br><br>\"\r\n                                    + \"【原因　　】：\" + claimForm.getItemValue(\"claimcause\") + \"<br>\"\r\n                                    + \"【対処方法】：\" + claimForm.getItemValue(\"claimmethod\") + \"<br>\"\r\n                                    + \"【対処結果】：\" + claimForm.getItemValue(\"claimresult\") + \"<br>\");\r\n                            win.close();\r\n                        };\r\n                        // クレームの保存\r\n                        saveForm(claimForm, \"claim/regist\", after);\r\n                        if(parentWindow){\r\n                            parentWindow.close();\r\n                        }\r\n                        // 顧客データに変更を通知する\r\n                        if(personalModel){\r\n                            personalModel.toClaim(personalId);\r\n                        }\r\n                    }\r\n                    break;\r\n                default: // クレーム原因簡易入力ボタン\r\n                    var claimPhrase = _GH.S03F040CLAIM[name];\r\n                    claimForm.setItemValue(\"claimcause\", claimPhrase[\"claimcause\"]);\r\n                    claimForm.setItemValue(\"claimmethod\", claimPhrase[\"claimmethod\"]);\r\n                    claimForm.setItemValue(\"claimresult\", claimPhrase[\"claimresult\"]);\r\n                    break;\r\n            }\r\n        });\r\n        // フォーカスイベント\r\n        claimForm.attachEvent(\"onFocus\", function(name){\r\n            switch(name) {\r\n                case \"eventId\": // 物件番号、物件名\r\n                case \"eventName\":\r\n                    that.doEvent(this.getInput(\"eventId\"), this.getInput(\"eventName\"), claimForm);\r\n                    break;\r\n                case \"claimTargetFullName\": // クレーム対象者\r\n                    that.doTantoWin(this.getInput(\"claimtargetemployeeId\"), this.getInput(\"claimTargetFullName\"));\r\n                    break;\r\n                case \"subClaimTargetFullName\": // クレーム対象者2\r\n                    that.doTantoWin(this.getInput(\"subclaimtargetemployeeId\"), this.getInput(\"subClaimTargetFullName\"));\r\n                    break;\r\n                case \"claimManagerFullName\": // 対応責任者\r\n                    that.doTantoWin(this.getInput(\"claimmanagerId\"), this.getInput(\"claimManagerFullName\"));\r\n                    break;\r\n            }\r\n        });\r\n        // バリデートエラー時の処理\r\n        claimForm.attachEvent(\"onValidateError\", function (name/*, value, result*/) {\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: claimForm.getItemLabel(name) + \"は必須入力です。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * クレーム編集ウィンドウ\r\n     * @param personalId\r\n     */\r\n    this.doClaimEditWindow = function(personalId) {\r\n        if (!personalId) {\r\n            alert(\"顧客IDが指定されていないため、クレーム表示できません。\");\r\n            return;\r\n        }\r\n        var claimList = getJSONSync(\"claim/id/\" + personalId);\r\n        if (_.isEmpty(claimList)) {\r\n            alert(\"この顧客にクレームは登録されていません。\");\r\n            return;\r\n        }\r\n\r\n        var winName = \"claimEditWin\";\r\n        var win = this.ghWins.createWindow(winName, 20, 30, 665, 525);\r\n        var claimData = claimList[0];\r\n        // 中身の用意\r\n        var claimForm = win.attachForm();\r\n        claimForm.loadStruct(getTemplatePath(_GH.DATA_PATH.CLAIM_JSON), \"json\", function() {\r\n            claimForm.setItemValue(\"operatorId\", _ghUser.getGhId()); // 登録者\r\n            claimForm.enableLiveValidation(true);\r\n            claimForm.setFormData(claimData);\r\n            win.setText(\"クレーム編集ウィンドウ\");\r\n        });\r\n        // ボタンのクリックイベント設定\r\n        claimForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch (name) {\r\n                case \"claimSaveBtn\": // 保存ボタン\r\n                    claimForm.updateValues();\r\n                    if (claimForm.validate()) {\r\n                        var after = function() {\r\n                            win.close();\r\n                        };\r\n                        saveForm(claimForm, \"claim/update\", after);\r\n                    }\r\n                    break;\r\n                default: // クレーム原因簡易入力ボタン\r\n                    var claimPhrase = _GH.S03F040CLAIM[name];\r\n                    claimForm.setItemValue(\"claimcause\", claimPhrase[\"claimcause\"]);\r\n                    claimForm.setItemValue(\"claimmethod\", claimPhrase[\"claimmethod\"]);\r\n                    claimForm.setItemValue(\"claimresult\", claimPhrase[\"claimresult\"]);\r\n                    break;\r\n            }\r\n        });\r\n        // フォーカスイベント\r\n        claimForm.attachEvent(\"onFocus\", function(name){\r\n            switch(name) {\r\n                case \"eventId\": // 物件番号、物件名\r\n                case \"eventName\":\r\n                    that.doEvent(this.getInput(\"eventId\"), this.getInput(\"eventName\"), claimForm);\r\n                    break;\r\n                case \"claimTargetFullName\": // クレーム対象者\r\n                    that.doTantoWin(this.getInput(\"claimtargetemployeeId\"), this.getInput(\"claimTargetFullName\"));\r\n                    break;\r\n                case \"subClaimTargetFullName\": // クレーム対象者2\r\n                    that.doTantoWin(this.getInput(\"subclaimtargetemployeeId\"), this.getInput(\"subClaimTargetFullName\"));\r\n                    break;\r\n                case \"claimManagerFullName\": // 対応責任者\r\n                    that.doTantoWin(this.getInput(\"claimmanagerId\"), this.getInput(\"claimManagerFullName\"));\r\n                    break;\r\n            }\r\n        });\r\n        // バリデートエラー時の処理\r\n        claimForm.attachEvent(\"onValidateError\", function (name/*, value, result*/) {\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: claimForm.getItemLabel(name) + \"は必須入力です。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 担当変更ウィンドウ\r\n     * @param {Array}  personalEmployeeMap 担当変更対象顧客IDの配列\r\n     * @param {Object} personalModel      顧客変更管理オブジェクト。変更処理および変更の通知を行う\r\n     * @param {parentWindow} parentWindow 親ウインドウ。処理成功時に親ウインドウを閉じる\r\n     */\r\n    this.doChargeWindow = function(personalEmployeeMap, personalModel, parentWindow, callbackFunc) {\r\n        var winName = \"chargeWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 515, 530);\r\n            win.setText(\"担当変更\");\r\n            win.hide();\r\n        }\r\n        var personalIds = _.keys(personalEmployeeMap);\r\n        var employeeIds = _.values(personalEmployeeMap);\r\n        console.log(\"担当変更\", personalIds, employeeIds);\r\n\r\n        var chargeTree = null;\r\n        // 中身の用意\r\n        var chargeForm = win.attachForm();\r\n        chargeForm.loadStruct(getTemplatePath(_GH.DATA_PATH.CHARGE_FORM_JSON), \"json\", function() {\r\n            // 組織ツリーの設定\r\n            chargeTree = new dhtmlXTreeObject(chargeForm.getContainer(\"chargeTree\"),\"100%\",\"100%\",0);\r\n            chargeTree.setImagePath(_GH.PATH_TYPE.TREE_IMGS);\r\n            if (_ghUser.isNon()) {\r\n                chargeTree.enableRadioButtons(true);\r\n            } else {\r\n                chargeTree.enableCheckBoxes(true);\r\n                chargeTree.enableSmartCheckboxes(true);\r\n            }\r\n            //\"entry/divisionList/\" + _ghUser.getLoginType() + \"/3?quitFlg=0\"\r\n        \tchargeTree.parse(getJSONSync(_GHAPI.URL.TANTO + _ghUser.getLoginType() + \"/3?quitFlg=0\"), function(){\r\n                // ログインユーザを選択させる\r\n                chargeTree.findItem(_ghUser.getName());\r\n            }, \"json\");\r\n            chargeTree.openAllItems(1);\r\n        });\r\n        // 担当変更のクリックイベント設定\r\n        chargeForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch (name) {\r\n                case \"sameDepartmentBtn\": // 事業部内の処理の実行\r\n                    if (!chargeTree.getAllChecked()) {\r\n                        dhtmlx.alert({\r\n                            title:\"変更後の担当者未選択\",\r\n                            type:\"alert-error\",\r\n                            text:\"変更後の担当者が選ばれていません。<BR>担当者を選択してください。\"\r\n                        });\r\n                        return;\r\n                    }\r\n                    var treeIdxs = chargeTree.getAllChecked().split(\",\");\r\n                    if (personalIds.length < treeIdxs.length) {\r\n                        dhtmlx.alert({\r\n                            title:\"変更対象顧客数の不足\",\r\n                            type:\"alert-error\",\r\n                            text:\"変更対象顧客数よりも移動先の担当者が多いです。<BR>担当者を顧客数(\" + personalIds.length + \"人)以下にしてください。\"\r\n                        });\r\n                        return;\r\n                    }\r\n                    // ボタンをロックする。\r\n                    chargeForm.lock();\r\n                    // 顧客をランダムに配分する。\r\n                    personalIds = _.shuffle(personalIds); // 顧客配列をシャッフル（ランダム化）\r\n                    var unitLen = Math.ceil(personalIds.length / treeIdxs.length); // 一人あたりの顧客人数\r\n                    var currentPos = 0; // 顧客配列の現在地\r\n                    // 担当者１人ずつ処理していく\r\n                    _.forEach(treeIdxs, function(treeIdx, i) {\r\n                        console.log(treeIdx, i, chargeTree.getUserData(treeIdx, \"employeeId\"), chargeTree.getUserData(treeIdx, \"divisionId\"));\r\n                        var targetDivisionId = chargeTree.getUserData(treeIdx, \"divisionId\");\r\n                        var targetEmployeeId = chargeTree.getUserData(treeIdx, \"employeeId\");\r\n                        var targetPersonalIds = _.slice(personalIds, currentPos, currentPos + unitLen);\r\n                        if (targetPersonalIds.length > 0) {\r\n                            // 対象顧客配列がある場合に処理を実行する。\r\n                            var query = getArrayQueryParam(\"personalId\", targetPersonalIds);\r\n                            var formData = {};\r\n                            if (targetEmployeeId) {\r\n                                // 担当者変更\r\n                                formData[\"divisionId\"] = targetDivisionId;\r\n                                formData[\"employeeId\"] = targetEmployeeId;\r\n                            } else if (targetDivisionId) {\r\n                                // 課担当なし\r\n                                formData[\"divisionId\"] = targetDivisionId;\r\n                                formData[\"employeeId\"] = \"\";\r\n                            }\r\n                            formData[\"protect\"] = chargeForm.isItemChecked(\"protect\")? 1: 0;\r\n                            var response = postSyncURL(\"changeEmp/change\", formData, [], query);\r\n                            if (!response.error) {\r\n                                // １人の顧客であれば、メール送信する\r\n                                if (personalIds.length === 1) {\r\n                                    if (targetEmployeeId > 0) {\r\n                                        sendMessageToEmployee([targetEmployeeId], \"担当者変更で顧客が１名追加\",\r\n                                                \"<p>以下の顧客が新しく担当になりました。</p><br>\" + getGHPersonalLink(personalIds[0]));\r\n                                    }\r\n                                    if (employeeIds[0] > 0) {\r\n                                        sendMessageToEmployee(employeeIds, \"担当者変更で顧客が１名移動\", \"<p>担当変更により顧客が１名別のところに移動しました。</p>\");\r\n                                    }\r\n                                }\r\n                                dhtmlx.message({text: chargeTree.getItemText(treeIdx) + \"に顧客情報\" + targetPersonalIds.length + \"件を割り当てしました。\"});\r\n                            }\r\n                        }\r\n                        // 現在地をずらす\r\n                        currentPos += unitLen;\r\n                    });\r\n\r\n                    // 他の画面に変更を通知する\r\n                    if(personalModel){\r\n                        personalModel.changeCharge();\r\n                    }\r\n\r\n                    if(parentWindow){\r\n                        parentWindow.close();\r\n                    }\r\n                    if (_.isFunction(callbackFunc))\r\n                        callbackFunc();\r\n                    win.close();\r\n                    break;\r\n            }\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 指示報告ウィンドウ\r\n     * @param {Object} custFormData 顧客情報\r\n     * @param {Object} model 画面の更新通知を行うオブジェクト\r\n     * @param callBack\r\n     */\r\n    this.doReportWindow = function(custFormData, model, callBack) {\r\n        var personalId = custFormData[\"personalId\"];\r\n        //var personalName = custFormData[\"lastName\"] + \" \" + custFormData[\"firstName\"];\r\n        var personalFullName = custFormData[\"lastName\"] + \" \" + custFormData[\"firstName\"];\r\n        var employeeId = _ghUser.getGhId()\r\n        var employFullName = _ghUser.getName();\r\n\r\n        var winName = \"directWin\";\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 450, 485);\r\n            win.setText(\"指示登録\");\r\n            win.hide();\r\n        }\r\n\r\n        //フォームの作成\r\n        var directWinForm = win.attachForm();\r\n        directWinForm.loadStruct(getTemplatePath(_GH.DATA_PATH.REPORT_WIN_FORM_JSON), \"json\", function() {\r\n            //クッキーより初期設定を取得\r\n            var cokkies = getCookies();\r\n            var now  = new Date();\r\n            var param = {\r\n                 employerFullName : employFullName\r\n                ,employeeId : employeeId\r\n                ,directEmployeeId: _ghUser.getGhId()\r\n                ,divisionId : _ghUser.getDivisionId()\r\n                ,personalId : personalId\r\n                ,personalFullName : personalFullName\r\n                ,important : is(\"String\",cokkies.important)?cokkies.important:\"2\"\r\n                ,expirationDate : new Date(now.getFullYear(), now.getMonth(), now.getDate(), 22, 0, 0)\r\n                ,directMailFlg : is(\"String\",cokkies.directMailFlg)?cokkies.directMailFlg:\"0\"\r\n                ,reportMailFlg : is(\"String\",cokkies.reportMailFlg)?cokkies.reportMailFlg:\"0\"\r\n                ,directorCheckFlg : is(\"String\",cokkies.directorCheckFlg)?cokkies.directorCheckFlg:\"0\"\r\n            };\r\n            // カレンダーで選択できるのは今日から１ヶ月以内。\r\n            directWinForm.getCalendar(\"expirationDate\").setSensitiveRange(now, getAfterDate(1, 0));\r\n            console.log(\"指示ウィンドウの初期パラメータ\", param);\r\n            this.setFormData(param);\r\n        });\r\n\r\n        // 指示報告のクリックイベント設定\r\n        directWinForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch (name) {\r\n                case \"L_002\": //保存ボタン\r\n                    directWinForm.updateValues();\r\n                    var data = this.getFormData();\r\n                    setGhCookie(\"directMailFlg\", data.directMailFlg);\r\n                    setGhCookie(\"reportMailFlg\", data.reportMailFlg);\r\n                    setGhCookie(\"directorCheckFlg\", data.directorCheckFlg);\r\n                    if (directWinForm.validate()) {\r\n                        saveForm(directWinForm, \"direct/regist\");\r\n                        win.close();\r\n                        if (_.isFunction(callBack)) {\r\n                            callBack.call();\r\n                        }\r\n                        // 画面の更新通知\r\n                        if(model){model.append()}\r\n                        break;\r\n                    }\r\n            }\r\n        });\r\n\r\n        directWinForm.attachEvent(\"onFocus\", function (name/*, value*/) {\r\n            //選択画面のイベントをここに設定する。\r\n            switch (name) {\r\n                case \"employerFullName\": //担当者選択ウィンドウ\r\n                    that.doTantoWin(this.getInput(\"employeeId\"), this.getInput(\"employerFullName\"));\r\n                    break;\r\n                case \"eventName\": //物件選択ウィンドウ\r\n                    that.doEvent(this.getInput(\"eventId\"), this.getInput(\"eventName\"), directWinForm);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        directWinForm.attachEvent(\"onChange\", function (name, value/*, state*/) {\r\n            if (name == \"directMailFlg\" || name == \"reportMailFlg\" || name == \"directorCheckFlg\") {\r\n                setGhCookie(name, value);\r\n            }\r\n       });\r\n        // バリデートエラー時の処理\r\n        directWinForm.attachEvent(\"onValidateError\", function (name/*, value, result*/) {\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: directWinForm.getItemLabel(name) + \"は必須入力です。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 担当者へ転送ウィンドウ\r\n     * @param personalLastName\r\n     * @param personalFirstName\r\n     * @param employeeId\r\n     * @param mailBody\r\n     * @param employFullName\r\n     */\r\n    this.doTransferMailWindow = function(personalLastName, personalFirstName, employeeId, mailBody, employFullName) {\r\n        var winName = \"transferWin\";\r\n        var employFullName = (employFullName !== undefined) ? employFullName : \"\";\r\n        var personalName = personalLastName + \" \" + personalFirstName;\r\n\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 350, 450);\r\n            win.setText(\"担当者に転送\");\r\n            win.hide();\r\n        }\r\n\r\n        //フォームの作成\r\n        var transferForm = win.attachForm();\r\n        transferForm.loadStruct(getTemplatePath(_GH.DATA_PATH.PERSONAL_TRANSFER_JSON), \"json\", function() {\r\n            transferForm.setItemValue(\"toEmployeeIdList\", employeeId);\r\n            transferForm.setItemValue(\"subject\", \"【ohgHire担当者へ連絡】 #{\" + entryName + \"} #{\" + personalName + \"}様\");\r\n            transferForm.setItemValue(\"body\", mailBody);\r\n            transferForm.setItemValue(\"toEmployee\", employFullName);\r\n            transferForm.setItemLabel(\"warnMsg\", \"対象のお客様の情報を担当者へ送信します。<BR>この情報には個人情報も含まれますので個人情報保護法の下、個人情報の取り扱いには十分注意してください。\");\r\n            transferForm.showItem(\"warnMsg\");\r\n        });\r\n        transferForm.attachEvent(\"onFocus\", function (name/*, value*/) {\r\n            //選択画面のイベントをここに設定する。\r\n            switch (name) {\r\n                case \"toEmployee\": //担当者選択ウィンドウ\r\n                    that.doTantoWin(this.getInput(\"toEmployeeIdList\"), this.getInput(\"toEmployee\"),null ,null, true, null, null, null, true);\r\n                    break;\r\n            }\r\n        });\r\n        // 指示報告のクリックイベント設定\r\n        transferForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch (name) {\r\n                case \"tranferBtn\": //保存ボタン\r\n                \ttransferForm.setItemValue(\"toEmployee\", this.getInput(\"toEmployee\").value);\r\n                    if (transferForm.validate()) {\r\n                        var param = transferForm.getFormData();\r\n                        // 送信先社員IDを配列にする。今は１人だけしか想定していないため、下記の単純な実装とする。\r\n                        param[\"toEmployeeIdList\"] = _.map(_.words(param[\"toEmployeeIdList\"], /[^, ]+/g), _.parseInt);\r\n                        // 本文の改行コードを変換する。\r\n                        param[\"body\"] = param[\"body\"].split(\"\\n\").join(\"<BR>\");\r\n                        try{\r\n                            syncPutJSON(\"sendmail/empMessage\", param, function(/*res*/){\r\n                                dhtmlx.message({text: \"メールを送信しました。\"})\r\n                            });\r\n                        } catch(e){\r\n                            dhtmlx.message({text: \"メールを送信でエラー\"});\r\n                            throw e;\r\n                        }\r\n                        win.close();\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        // バリデートエラー時の処理\r\n        transferForm.attachEvent(\"onValidateError\", function (name/*, value, result*/){\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: transferForm.getItemLabel(name) + \"は必須入力です。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * 現場、物件マスタウィンドウを開く\r\n     * @param {Object} eventIdInput 物件IDをセットするINPUTオブジェクト\r\n     * @param {Object} eventNameInput 物件名をセットするINPUTオブジェクト\r\n     * @param {Object} formObject フォームオブジェクト\r\n     * */\r\n\r\n    /**\r\n     * 郵便番号ウィンドウ\r\n     * @param {Object} zipCodeInput 郵便番号Inputオブジェクト\r\n     * @param {Object} prefectureSelect 都道府県Selectオブジェクト(getSelect()で取得）\r\n     * @param {Object} cityInput 市区町村Inputオブジェクト\r\n     * @param {Object} townInput その他の住所Inputオブジェクト\r\n     */\r\n    this.doPostWindow = function(zipCodeInput, prefectureSelect, cityInput, townInput) {\r\n\r\n        var windowName = \"postWin\";\r\n        var win = this.ghWins.window(windowName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(windowName, 20, 30, 550, 450);\r\n            win.setText(\"郵便番号ウィンドウ\");\r\n            win.hide();\r\n        }\r\n        //フォームの作成\r\n        var postForm = win.attachForm();\r\n        postForm.loadStruct(getTemplatePath(_GH.DATA_PATH.WIN_POST_FORM_JSON), \"json\", function() {\r\n            if (zipCodeInput && zipCodeInput.value != \"\") {\r\n                this.setItemValue(\"zipCode\", zipCodeInput.value);\r\n                that.searchPostInformation(postForm, zipCodeInput, prefectureSelect, cityInput, townInput, windowName);\r\n            } else {\r\n                var address = (prefectureSelect && prefectureSelect.value)? prefectureSelect.value : \"\";\r\n                address += (cityInput && cityInput.value)? cityInput.value : \"\";\r\n                address += (townInput && townInput.value)? townInput.value : \"\";\r\n                if (address !== \"\"){\r\n                    this.setItemValue(\"address\", address);\r\n                    that.searchPostInformation(postForm, zipCodeInput, prefectureSelect, cityInput, townInput, windowName);\r\n                }\r\n            }\r\n        });\r\n        postForm.attachEvent(\"onButtonClick\", function(name){\r\n            switch(name) {\r\n                case \"L_001\": //検索\r\n                    that.searchPostInformation(postForm, zipCodeInput, prefectureSelect, cityInput, townInput, windowName);\r\n                    break;\r\n            }\r\n       });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * グリッドの列の表示／非表示を切り替えるウィンドウを表示する。\r\n     * @param {Object} grid グリッドオブジェクト\r\n     * @param {Array} unconfiguable ウィンドウに表示させない項目の配列\r\n     */\r\n    this.doShowHideColumnWindow = function(grid, unconfiguable) {\r\n        var windowName = \"showHideColumnWin\";\r\n        var win = this.ghWins.window(windowName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(windowName, 600, 30, 160, 500);\r\n            win.hide();\r\n            win.setText(\"\");\r\n        }\r\n\r\n        //フォームの作成\r\n        var showHideColumnForm = win.attachForm();\r\n\r\n        var check_list = _.map(_.range(1, grid.getColumnsNum()), function(num){\r\n            // 一週間前～未メール日数は列の表示非表示設定をさせない\r\n            var id = grid.getColumnId(num);\r\n            if(_(unconfiguable).contains(id)){\r\n                return;\r\n            }\r\n            var label = grid.getColumnLabel(num);\r\n            var checked = !grid.isColumnHidden(num);\r\n            return {type: \"checkbox\", name: id, label: label, position: \"label-right\", checked: checked};\r\n        });\r\n\r\n        showHideColumnForm.loadStruct(check_list);\r\n        showHideColumnForm.attachEvent(\"onChange\", function(name){\r\n            var ind = grid.getColIndexById(name);\r\n            var show = showHideColumnForm.isItemChecked(name);\r\n            grid.setColumnHidden(ind, !show);\r\n        });\r\n        win.show();\r\n    };\r\n    /**\r\n     * 郵便番号検索を実行するメソッド\r\n     */\r\n    this.searchPostInformation = function(postForm, zipCodeInput, prefectureSelect, cityInput, townInput, windowName) {\r\n      //入力チェック\r\n        var formData = postForm.getFormData();\r\n        var url;\r\n        if(formData.zipCode != \"\"){\r\n            // ハイフンを除いて検索にかける\r\n            url = _GH.URL(\"WIN_POST_CODE_LIST\") + formData.zipCode.split(\"-\").join(\"\");\r\n        }else if(formData.address != \"\"){\r\n            if(formData.address.length <=1){\r\n                return;\r\n            }\r\n            url = _GH.URL(\"WIN_POST_CODE_ADDRESS\") + encodeURI(formData.address);\r\n        }else{\r\n            //未入力\r\n            return;\r\n        }\r\n        // Grid表示用にデータを振り分けるロジック\r\n        var gridDataLogicFunc = function(data, id, rowIdx) {\r\n            var val;\r\n            switch(id) {\r\n                case \"no\":\r\n                    val = rowIdx + 1;\r\n                  break;\r\n              default:\r\n                  val = data[id];\r\n                  break;\r\n            }\r\n            return val;\r\n        };\r\n        // Gridの設定\r\n        var postGrid = new dhtmlXGridObject(postForm.getContainer(\"bottomGrid\"));\r\n        postGrid.setImagePath(_GH.PATH_TYPE.DHX_IMGS);\r\n        postGrid.setSkin(_GH.PATH_TYPE.SKIN);\r\n        postGrid.enableColumnMove(true);\r\n        loadGridByGet(postGrid, _GH.DATA_PATH.WIN_POST_GRID_JSON, url, null , gridDataLogicFunc);\r\n        postGrid.attachEvent(\"onRowDblClicked\", function (rId/*, cInd*/) {\r\n            if(!_.isEmpty(zipCodeInput)){ zipCodeInput.value = (postGrid.cells(rId, 0)).getValue();}\r\n            if(!_.isEmpty(prefectureSelect)){ prefectureSelect.value = (postGrid.cells(rId, 1)).getValue();}\r\n            if(!_.isEmpty(cityInput)){ cityInput.value = (postGrid.cells(rId, 2)).getValue();}\r\n            if(!_.isEmpty(townInput)){ townInput.value = (postGrid.cells(rId, 3)).getValue();}\r\n            that.closeWindow(windowName, true);\r\n        });\r\n    };\r\n\r\n    // =================================================================\r\n    /**\r\n     * [ユーティリティ関数] 担当者へメール送信ウィンドウ\r\n     * @param {Array} employeeIds メール送信する担当者ID配列\r\n     * @param {String} subject メール件名\r\n     * @param {String} body メール本文\r\n     * @param {String} warning 警告メッセージ\r\n     */\r\n    this.doSendToEmpWin = function(employeeIds, subject, body, warning) {\r\n        var winName = \"sendToEmpWin\";\r\n\r\n        var win = this.ghWins.window(winName);\r\n        if (win == null) {\r\n            win = this.ghWins.createWindow(winName, 20, 30, 350, 400);\r\n            win.setText(\"担当者にメール送信\");\r\n            win.hide();\r\n            win.button(\"park\").hide();\r\n            win.button(\"minmax1\").hide();\r\n            win.button(\"close\").attachEvent(\"onClick\", function(){\r\n                that.closeWindow(winName, true);\r\n            });\r\n        }\r\n\r\n        //フォームの作成\r\n        var sendToEmpForm = win.attachForm();\r\n        sendToEmpForm.loadStruct(getTemplatePath(_GH.DATA_PATH.PERSONAL_TRANSFER_JSON), \"json\", function() {\r\n            sendToEmpForm.hideItem(\"toEmployee\");\r\n            sendToEmpForm.setItemValue(\"toEmployee\", \"担当者\");\r\n            sendToEmpForm.setItemValue(\"subject\", subject);\r\n            sendToEmpForm.setItemValue(\"body\", body);\r\n            if (!_.isEmpty(warning)) {\r\n                sendToEmpForm.setItemLabel(\"warnMsg\", warning);\r\n                sendToEmpForm.showItem(\"warnMsg\");\r\n            }\r\n        });\r\n        sendToEmpForm.enableLiveValidation(true); // ライブバリデーションON\r\n        // 指示報告のクリックイベント設定\r\n        sendToEmpForm.attachEvent('onButtonClick', function (name/*, command*/) {\r\n            switch(name) {\r\n                case \"tranferBtn\": //保存ボタン\r\n                    if (sendToEmpForm.validate()) {\r\n                        sendMessageToEmployee(employeeIds, sendToEmpForm.getItemValue(\"subject\"), sendToEmpForm.getItemValue(\"body\"));\r\n                        that.closeWindow(winName, true);\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        // バリデートエラー時の処理\r\n        sendToEmpForm.attachEvent(\"onValidateError\", function (name/*, value, result*/) {\r\n            dhtmlx.message({\r\n                type:\"error\",\r\n                text: sendToEmpForm.getItemLabel(name) + \"は必須入力です。\"\r\n            });\r\n        });\r\n        win.show();\r\n    };\r\n\r\n    /**\r\n     * [ユーティリティ関数] メール送信メソッド\r\n     * @param {Object} winName DhtmlxWindow name.\r\n     * @param {Object} mailForm DhtmlxFormオブジェクト\r\n     * @param {Object} ckeditor CDEditorのeditor要素\r\n     * @param {Object} attachments 添付ファイルマップ（key : realName, value: serverName)\r\n     * @param {Array} personalIds List of personal IDs.\r\n     * @param model\r\n     */\r\n    this.sendMail = function (winName, mailForm, ckeditor, attachments, personalIds, model) {\r\n        console.log(\"メールフォーム\", mailForm.getFormData(), attachments, personalIds, mailForm.getItemValue(\"timerStart\"));\r\n        // バリデート\r\n        if (!that.validateMailForm(mailForm, ckeditor)) {\r\n            return;\r\n        }\r\n        var uri = (personalIds.length > 1)? \"sendmail/group/\": \"sendmail/single/\";\r\n        uri += (mailForm.getItemValue(\"timerStart\"))? \"timer\": \"direct\";\r\n        // 一斉メールでCCが付いている場合、本当に良いか、確認する。\r\n        if (mailForm.getItemValue(\"ccType\") != \"0\" && _.startsWith(uri, \"sendmail/group/\")) {\r\n            if (confirm(\"CCの設定があると、全メールがCCに設定した方に飛びます。\\nCCの設定を消しますか？\")) {\r\n                // CCを空にする。\r\n                mailForm.setItemValue(\"ccType\", \"0\");\r\n            }\r\n        }\r\n        var param = mailForm.getFormData();\r\n\r\n        // すでに添付されているファイル情報を追加する。\r\n        _.forEach(param, function(val, key) {\r\n            if (_.startsWith(key, \"uploadedFile_\")) {\r\n                var attachFilename = mailForm.getUserData(key, \"filename\");\r\n                if (!_.has(attachments, attachFilename)) {\r\n                    attachments[attachFilename] = mailForm.getUserData(key, \"filepath\");\r\n                }\r\n            }\r\n        });\r\n        // 添付ファイル情報をつける\r\n        param[\"attachementURLList\"] = _.values(attachments);\r\n        // 顧客ID\r\n        param[\"personalIdList\"] = personalIds;\r\n        // タイマー送信時間。JSONで送るため、テンプレートで設定したserverDateのパラメータが効かないため。\r\n        if (_.isDate(param[\"timerStart\"])) {\r\n            param[\"timerStart\"] = getStrDate(param[\"timerStart\"], _GH.FORMAT.YMD_HMS);\r\n        }\r\n        // 本文\r\n        param[\"body\"] = ckeditor.getData();\r\n        dhtmlx.confirm({\r\n            type:\"confirm\",\r\n            text: \"お客様へメールを送信してもよろしいですか?<BR>送信内容が適切かどうかすべてチェックしましたか？\",\r\n            callback: function(result){\r\n                if (result) {\r\n                    // 送信ボタンをロック\r\n                    mailForm.lock();\r\n                    window.dhx4.ajax.query({\r\n                        method : \"PUT\",\r\n                        url : _GHAPI.SERVER + uri,\r\n                        data : JSON.stringify(param),\r\n                        async : false,\r\n                        callback: function(res){\r\n                            if(res.xmlDoc.status === 200){\r\n                                // ライブラリを使っていない場合は、メールの件名と本文をセッションストレージに保存する。\r\n                                if (_.isEmpty(param[\"libraryId\"])) {\r\n                                    console.log(\"メールの件名と本文をセッションストレージに保存\");\r\n                                    setSS(_GH.S05F010ML.MAIL_SUB,   param[\"subject\"]);\r\n                                    setSS(_GH.S05F010ML.MAIL_BODY, param[\"body\"]);\r\n                                } else {\r\n                                    setSS(_GH.S05F010ML.MAIL_SUB,   \"\");\r\n                                    setSS(_GH.S05F010ML.MAIL_BODY, \"\");\r\n                                }\r\n                                dhtmlx.message(\"メールを送信しました。\");\r\n                                that.closeWindow(winName, true);\r\n\r\n                                // メール送信後の画面更新通知\r\n                                model.append();\r\n                            } else {\r\n                                var message = \"サーバーエラーが発生しました。\";\r\n                                var params = { 'status' : res.status, 'errorMessage' :message};\r\n                                throw new Error(JSON.stringify({message: message, params: params}));\r\n                            }\r\n                        },\r\n                        headers:{\r\n                            \"Content-Type\":\"application/json\"\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * [ユーティリティ関数] テストメール送信メソッド\r\n     * @param {Object} mailForm DhtmlxFormオブジェクト\r\n     * @param {Object} ckeditor CDEditorのeditor要素\r\n     * @param {Object} attachments 添付ファイルマップ（key : realName, value: serverName)\r\n     * @param personalIds\r\n     */\r\n    this.sendTestMail = function (mailForm, ckeditor, attachments, personalIds) {\r\n        console.log(\"メールフォーム\", mailForm.getFormData());\r\n\r\n        // バリデート\r\n        if (!that.validateMailForm(mailForm, ckeditor)) {\r\n            return;\r\n        }\r\n        var param = mailForm.getFormData();\r\n\r\n        // すでに添付されているファイル情報を追加する。\r\n        _.forEach(param, function(val, key) {\r\n            if (_.startsWith(key, \"uploadedFile_\")) {\r\n                var attachFilename = mailForm.getUserData(key, \"filename\");\r\n                if (!_.has(attachments, attachFilename)) {\r\n                    attachments[attachFilename] = mailForm.getUserData(key, \"filepath\");\r\n                }\r\n            }\r\n        });\r\n        // 添付ファイル情報をつける\r\n        param[\"attachementURLList\"] = _.values(attachments);\r\n        // 顧客ID\r\n        param[\"personalIdList\"] = personalIds;\r\n        // タイマー送信時間はテストメール時は不要。\r\n        delete param[\"timerStart\"];\r\n        // 本文\r\n        param[\"body\"] = ckeditor.getData();\r\n\r\n        var uri = \"sendmail/test\";\r\n        window.dhx4.ajax.query({\r\n            method : \"PUT\",\r\n            url : _GHAPI.SERVER + uri,\r\n            data : JSON.stringify(param),\r\n            async : false,\r\n            callback: function(res){\r\n                if(res.xmlDoc.status === 200){\r\n                    // メールの件名と本文をセッションストレージに保存する。\r\n                    setSS(_GH.S05F010ML.MAIL_SUB,   param[\"subject\"]);\r\n                    setSS(_GH.S05F010ML.MAIL_BODY, param[\"body\"]);\r\n                    dhtmlx.message(\"メールを送信しました。\");\r\n                    // CCを空にする。\r\n                    mailForm.setItemValue(\"ccType\", \"0\");\r\n                    // 本番送信を有効化する\r\n                    mailForm.enableItem(\"sendEmailBtn\");\r\n                } else {\r\n                    var message = \"サーバーエラーが発生しました。\";\r\n                    var params = { 'status' : res.status, 'errorMessage' :message};\r\n                    throw new Error(JSON.stringify({message: message, params: params}));\r\n                }\r\n            },\r\n            headers:{\r\n                \"Content-Type\":\"application/json\"\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * [ユーティリティ関数] ライブラリ新規作成メソッド\r\n     * @param {String} winName ウィンドウ名\r\n     * @param {Object} mailForm DhtmlxFormオブジェクト\r\n     * @param {Object} ckeditor CDEditorのeditor要素\r\n     * @param {Object} attachments 添付ファイルマップ（key : realName, value: serverName)\r\n     * @param {Object} collection ライブラリのコレクション\r\n     */\r\n    this.createTemplate = function(winName, mailForm, ckeditor, attachments, collection) {\r\n        mailForm.updateValues();\r\n        // バリデート\r\n        if (that.validateMailForm(mailForm, ckeditor)) {\r\n            var param = mailForm.getFormData();\r\n            // 添付ファイル情報をつける\r\n            param[\"attachementURLList\"] = _.values(attachments);\r\n            // 本文\r\n            param[\"mailBody\"] = ckeditor.getData();\r\n            // ユーザー名\r\n            param[\"employeeFullName\"] = _ghUser.getName();\r\n            // 承認依頼ボタンを有効にする。\r\n            mailForm.enableItem(\"referTypeBtn\");\r\n            var promiseTemplate = collection.create(param, winName);\r\n            $.when(promiseTemplate).done(function(){\r\n                mailForm.setItemValue(\"libraryId\", param[\"libraryId\"]);\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * [ユーティリティ関数] ライブラリ更新メソッド\r\n     * @param {String} winName ウィンドウ名\r\n     * @param {Object} mailForm DhtmlxFormオブジェクト\r\n     * @param {Object} ckeditor CDEditorのeditor要素\r\n     * @param {Object} attachments 添付ファイルマップ（key : realName, value: serverName)\r\n     * @param {Object} collection ライブラリのコレクション\r\n     */\r\n    this.updateTemplate = function(winName, mailForm, ckeditor, attachments, collection) {\r\n        mailForm.updateValues();\r\n        // バリデート\r\n        if (that.validateMailForm(mailForm, ckeditor)) {\r\n            var param = mailForm.getFormData();\r\n            // 添付ファイル情報をつける\r\n            param[\"attachementURLList\"] = _.values(attachments);\r\n            // 本文\r\n            param[\"mailBody\"] = ckeditor.getData();\r\n            console.log(\"ライブラリアップデート\", param);\r\n            collection.update(param, winName);\r\n        }\r\n    };\r\n    /**\r\n     * 承認依頼\r\n     */\r\n    this.requestJudgeLibrary = function(winName, mailForm, ckeditor) {\r\n        mailForm.updateValues();\r\n        // バリデート\r\n        if (that.validateMailForm(mailForm, ckeditor)) {\r\n            var libraryApprovalStatus = mailForm.getSelect(\"approvalSelect\").value;\r\n            if (libraryApprovalStatus === \"\") {\r\n                dhtmlx.alert({\r\n                    title:\"承認者チェックエラー\",\r\n                    type:\"alert-error\",\r\n                    text:\"承認者が選択されていません。<BR>必ず選択してください。\"\r\n                });\r\n            } else {\r\n                mailForm.setItemValue(\"libraryApprovalStatus\", libraryApprovalStatus);\r\n                mailForm.setItemValue(\"libraryApprovalFlg\", _GH.S05F030Lib.APPROVE_FLG.NONE);\r\n                saveForm(mailForm, \"library/approvalStatus/\" + mailForm.getItemValue(\"libraryId\"));\r\n                that.closeWindow(winName, true);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * 承認/差戻し\r\n     */\r\n    this.changeApprovalLibrary = function(winName, mailForm, ckeditor, approvalFlg, approvalStatus) {\r\n        mailForm.updateValues();\r\n        // バリデート\r\n        if (that.validateMailForm(mailForm, ckeditor)) {\r\n            if (mailForm.getItemValue(\"approvalMemo\") === \"\") {\r\n                dhtmlx.alert({\r\n                    title:\"承認メモチェックエラー\",\r\n                    type:\"alert-error\",\r\n                    text:\"理由が入力されていません。<BR>必ず入力してください。\"\r\n                });\r\n            } else {\r\n                // ライブラリ有効期限を承認日の１ヶ月後とする。\r\n                var expire = getAfterDate(1, 0);\r\n                mailForm.setItemValue(\"expire\", window.dhx4.date2str(expire, \"%Y/%m/%d %H:%i:%s\"));\r\n                mailForm.setItemValue(\"libraryApprovalFlg\", approvalFlg);\r\n                mailForm.setItemValue(\"libraryApprovalStatus\", approvalStatus);\r\n                saveForm(mailForm, \"library/approvalLevel/\" + mailForm.getItemValue(\"libraryId\"));\r\n                that.closeWindow(winName, true);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * メールフォームのバリデート\r\n     */\r\n    this.validateMailForm = function(mailForm, ckeditor) {\r\n        // バリデート\r\n        if (!mailForm.validate()) {\r\n            dhtmlx.alert({\r\n                title:\"宛先・件名チェックエラー\",\r\n                type:\"alert-error\",\r\n                text:\"メールの送信先または件名が入力されていません。<BR>必ず入力してください。\"\r\n            });\r\n            return false;\r\n        } else if (ckeditor.getData() === \"\") {\r\n            dhtmlx.alert({\r\n                title:\"メール本文チェックエラー\",\r\n                type:\"alert-error\",\r\n                text:\"メール本文が入力されていません。<BR>本文は必ず入力してください。\"\r\n            });\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    };\r\n    /**\r\n     * メール／ライブラリのファイルアップロード用のイベントをセットする。\r\n     * @param {Object} mailForm DhtmlxFormオブジェクト\r\n     * @param {Object} attachments 添付ファイルマップ（key : realName, value: serverName)\r\n     */\r\n    this.setFileUploadEvents = function (mailForm, attachments) {\r\n        // 添付ファイルアップロードの開始\r\n        mailForm.attachEvent(\"onFileAdd\",function (/*realName*/) {\r\n            var uploader = mailForm.getUploader(\"attachmentFiles\");\r\n            uploader.setSendParams(\"currentUserId\", _ghUser.getGhId());\r\n            uploader.setSendParams(\"uploadType\", \"mailAttachment\");\r\n            $(\".dhx_upload_files .dhx_file_delete\").hide();\r\n            $(\".dhx_upload_controls\").hide();\r\n        });\r\n        // ファイルをアップロードして、リストに追加される際のイベント\r\n        mailForm.attachEvent(\"onUploadFile\",function(realName, serverName){\r\n            console.log(\"onUploadFile\", realName, serverName);\r\n            $(\".dhx_upload_files .dhx_file_delete\").hide();\r\n            attachments[realName] = _GHAPI.SERVER + _GH.URL('FILE_GET_URL') + '?fileName=' + encodeURI(serverName);\r\n        });\r\n        // ファイル削除前の確認\r\n        mailForm.attachEvent(\"onBeforeFileRemove\", function(realName, serverName){\r\n            if (!confirm(realName+\"を本当に削除してもよろしいですか？\")) return false;\r\n            delURL(_GH.URL(\"FILE_DELETE_URL\") + \"?deleteFileName=\" + encodeURI(serverName), null, null);\r\n            return true;\r\n        });\r\n        // 添付ファイルアップロードの完了\r\n        mailForm.attachEvent(\"onUploadComplete\",function(count){\r\n            console.log(\"<b>onUploadComplete</b> \"+count+\" file\"+(count>1?\"s were\":\" was\")+\" uploaded\");\r\n            $(\".dhx_file_uploaded .dhx_file_delete\").show();\r\n            $(\".dhx_upload_controls\").show();\r\n        });\r\n        // 添付ファイルアップロードの失敗\r\n        mailForm.attachEvent(\"onUploadFail\",function(realName){\r\n            dhtmlx.alert({\r\n                title:\"ファイルアップロードエラー\",\r\n                type:\"alert-error\",\r\n                text:realName + \"をアップロードすることができませんでした。\"\r\n            });\r\n            $(\".dhx_file_uploaded .dhx_file_delete\").show();\r\n            $(\".dhx_upload_controls\").show();\r\n            console.log(\"<b>onUploadFail</b>, file: \"+realName);\r\n        });\r\n    };\r\n    /**\r\n     * メールの編集できるかどうかを判断する。\r\n     * @param {Boolean} isGroupMail 一斉メールかどうか。\r\n     * @param {Number} sendCount 送信人数\r\n     * @return {Boolean} true: メール編集可能、false: メール編集不可\r\n     */\r\n    this.doEditMail = function(isGroupMail, sendCount) {\r\n        if (isGroupMail) {\r\n            //var mgrCount = _GH.S05F010ML.APPROVE[\"MGR\" + _ghUser.getDepartment()]; // MGR承認が必要な人数\r\n            var mgrCount = _GH.S05F010ML.APPROVE[\"MGR\" + _ghUser.getLoginType()]; // MGR承認が必要な人数\r\n            //var mktCount = _GH.S05F010ML.APPROVE[\"MKT\" + _ghUser.getDepartment()]; // MKR承認が必要な人数。MGRよりも大きい。\r\n            var mktCount = _GH.S05F010ML.APPROVE[\"MKT\" + _ghUser.getLoginType()]; // MKR承認が必要な人数。MGRよりも大きい。\r\n            if (sendCount < mgrCount) {\r\n                // 制限人数より少ない場合は許可\r\n                return true;\r\n            } else if (sendCount >= mgrCount && sendCount < mktCount) {\r\n                // 制限人数がMGR以上マーケ未満なら、MGR承認権限・マーケ承認権限があればOK\r\n                return (_ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MANAGER) || _ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MARKETING));\r\n            } else {\r\n                // 制限人数がマーケ以上であれば、マーケ承認が必要\r\n                return _ghUser.hasRole(_GH.ROLE.TEMPLATE_CHECK_MARKETING);\r\n            }\r\n        } else {\r\n            // 個別メールは許可\r\n            return true;\r\n        }\r\n    };\r\n    /**\r\n     * メールウィンドウからライブラリウィンドウに飛ばすためのデータを取得する。\r\n     */\r\n    this.getMailWinFormData = function(ckeditorTextData) {\r\n        var win = this.ghWins.window(\"mailWin\");\r\n        if (_.isEmpty(win)) {\r\n            return {body: ckeditorTextData};\r\n        }\r\n        var mailForm = win.getAttachedObject();\r\n        if (_.isEmpty(mailForm)) {\r\n            return {body: ckeditorTextData};\r\n        } else {\r\n            return {body: ckeditorTextData, mailSubject: mailForm.getItemValue(\"subject\"),\r\n                eventId: mailForm.getItemValue(\"eventId\"), eventName: mailForm.getItemValue(\"eventName\"),\r\n                eventMemo: mailForm.getItemValue(\"eventMemo\")};\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 顧客のステータス類を変更する。変更しない場合はnullを指定すること\r\n     * @param {Object} custForm 顧客情報のFormData。getFormData()\r\n     * @param {Boolean} empflg 自分フラグを変更するかどうか\r\n     * @param {Boolean} protect プロテクトフラグを変更するかどうか\r\n     */\r\n    this.changePersonalFlags = function(custForm, empflg, protect) {\r\n        //TODO ログインユーザの権限を見て、判断する必要あり\r\n        var formData = custForm.getFormData();\r\n        var personalId = formData[\"personalId\"];\r\n        var params = {\r\n                protect: formData[\"protect\"],\r\n                empflg: formData[\"empflg\"],\r\n                managerflg: formData[\"managerflg\"],\r\n                centermanagerflg: formData[\"centermanagerflg\"]\r\n        };\r\n        if (protect) {\r\n            if (_ghUser.isManager()) {\r\n                var flgKey = \"protect\";\r\n                var newValue = (custForm.getItemValue(flgKey) == 1)? 0: 1;\r\n                custForm.setItemValue(flgKey, newValue);\r\n                params[flgKey] = newValue;\r\n            }\r\n        }\r\n        if (empflg) {\r\n            var flgKey;\r\n            var newValue;\r\n            //TODO センター長の判断をどうするか・・・\r\n            if (_ghUser.isManager()) {\r\n                flgKey = \"managerflg\";\r\n            } else {\r\n                flgKey = \"empflg\";\r\n            }\r\n            newValue = (custForm.getItemValue(flgKey) == 1)? 0: 1;\r\n            custForm.setItemValue(flgKey, newValue);\r\n            params[flgKey] = newValue;\r\n        }\r\n        postSyncURL(\"personal/changeFlags/\" + personalId, params);\r\n    };\r\n}\r\n"

/***/ },
/* 24 */
/*!********************!*\
  !*** ./gh.data.js ***!
  \********************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var gh_util = __webpack_require__(/*! gh_util */ 25);
	var LibListCollection_0 = __webpack_require__(/*! class/data/collections/LibListCollection.js */ 43);
	var Schedule_1 = __webpack_require__(/*! class/data/models/Schedule.js */ 44);
	var EventMst_0 = __webpack_require__(/*! class/EventMst.js */ 45);
	var SFAClassIF_1 = __webpack_require__(/*! class/SFAClassIF.js */ 46);
	var RegisterEventWindow_0 = __webpack_require__(/*! class/window/RegisterEventWindow.js */ 47);
	var ServicesAssetsWindow_1 = __webpack_require__(/*! class/window/ServicesAssetsWindow.js */ 48);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.data.js */ 49)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.data.js")


/***/ },
/* 25 */
/*!********************!*\
  !*** ./gh.util.js ***!
  \********************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var gh_config = __webpack_require__(/*! gh_config */ 26);
	var xdate = __webpack_require__(/*! xdate */ 36);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.util.js */ 42)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.util.js")


/***/ },
/* 26 */
/*!**********************!*\
  !*** ./gh.config.js ***!
  \**********************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var gh_global = __webpack_require__(/*! gh_global */ 27);
	var dhtmlx = __webpack_require__(/*! dhtmlx */ 2);
	var dhtmlxvault = __webpack_require__(/*! dhtmlxvault */ 1);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.config.js */ 35)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.config.js")


/***/ },
/* 27 */
/*!**********************!*\
  !*** ./gh.global.js ***!
  \**********************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var gh_message = __webpack_require__(/*! gh_message */ 28);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.global.js */ 34)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.global.js")


/***/ },
/* 28 */
/*!***********************!*\
  !*** ./gh.message.js ***!
  \***********************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var gh_const = __webpack_require__(/*! gh_const */ 29);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.message.js */ 33)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.message.js")


/***/ },
/* 29 */
/*!*********************!*\
  !*** ./gh.const.js ***!
  \*********************/
/***/ function(module, exports, __webpack_require__) {

	/*** IMPORTS FROM imports-loader ***/
	var lodash = __webpack_require__(/*! lodash */ 30);
	
	__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/script-loader/addScript.js */ 3)(__webpack_require__(/*! !C:/building/src/main/webapp/resources/~/raw-loader!./gh.const.js */ 32)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///C:/building/src/main/webapp/resources/WebContent/js/src/gh.const.js")


/***/ },
/* 30 */
/*!***************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/lodash/index.js ***!
  \***************************************************************/
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_RESULT__;/* WEBPACK VAR INJECTION */(function(module, global) {/**
	 * @license
	 * lodash 3.6.0 (Custom Build) <https://lodash.com/>
	 * Build: `lodash modern -d -o ./index.js`
	 * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>
	 * Based on Underscore.js 1.8.2 <http://underscorejs.org/LICENSE>
	 * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 * Available under MIT license <https://lodash.com/license>
	 */
	;(function() {
	
	  /** Used as a safe reference for `undefined` in pre-ES5 environments. */
	  var undefined;
	
	  /** Used as the semantic version number. */
	  var VERSION = '3.6.0';
	
	  /** Used to compose bitmasks for wrapper metadata. */
	  var BIND_FLAG = 1,
	      BIND_KEY_FLAG = 2,
	      CURRY_BOUND_FLAG = 4,
	      CURRY_FLAG = 8,
	      CURRY_RIGHT_FLAG = 16,
	      PARTIAL_FLAG = 32,
	      PARTIAL_RIGHT_FLAG = 64,
	      ARY_FLAG = 128,
	      REARG_FLAG = 256;
	
	  /** Used as default options for `_.trunc`. */
	  var DEFAULT_TRUNC_LENGTH = 30,
	      DEFAULT_TRUNC_OMISSION = '...';
	
	  /** Used to detect when a function becomes hot. */
	  var HOT_COUNT = 150,
	      HOT_SPAN = 16;
	
	  /** Used to indicate the type of lazy iteratees. */
	  var LAZY_DROP_WHILE_FLAG = 0,
	      LAZY_FILTER_FLAG = 1,
	      LAZY_MAP_FLAG = 2;
	
	  /** Used as the `TypeError` message for "Functions" methods. */
	  var FUNC_ERROR_TEXT = 'Expected a function';
	
	  /** Used as the internal argument placeholder. */
	  var PLACEHOLDER = '__lodash_placeholder__';
	
	  /** `Object#toString` result references. */
	  var argsTag = '[object Arguments]',
	      arrayTag = '[object Array]',
	      boolTag = '[object Boolean]',
	      dateTag = '[object Date]',
	      errorTag = '[object Error]',
	      funcTag = '[object Function]',
	      mapTag = '[object Map]',
	      numberTag = '[object Number]',
	      objectTag = '[object Object]',
	      regexpTag = '[object RegExp]',
	      setTag = '[object Set]',
	      stringTag = '[object String]',
	      weakMapTag = '[object WeakMap]';
	
	  var arrayBufferTag = '[object ArrayBuffer]',
	      float32Tag = '[object Float32Array]',
	      float64Tag = '[object Float64Array]',
	      int8Tag = '[object Int8Array]',
	      int16Tag = '[object Int16Array]',
	      int32Tag = '[object Int32Array]',
	      uint8Tag = '[object Uint8Array]',
	      uint8ClampedTag = '[object Uint8ClampedArray]',
	      uint16Tag = '[object Uint16Array]',
	      uint32Tag = '[object Uint32Array]';
	
	  /** Used to match empty string literals in compiled template source. */
	  var reEmptyStringLeading = /\b__p \+= '';/g,
	      reEmptyStringMiddle = /\b(__p \+=) '' \+/g,
	      reEmptyStringTrailing = /(__e\(.*?\)|\b__t\)) \+\n'';/g;
	
	  /** Used to match HTML entities and HTML characters. */
	  var reEscapedHtml = /&(?:amp|lt|gt|quot|#39|#96);/g,
	      reUnescapedHtml = /[&<>"'`]/g,
	      reHasEscapedHtml = RegExp(reEscapedHtml.source),
	      reHasUnescapedHtml = RegExp(reUnescapedHtml.source);
	
	  /** Used to match template delimiters. */
	  var reEscape = /<%-([\s\S]+?)%>/g,
	      reEvaluate = /<%([\s\S]+?)%>/g,
	      reInterpolate = /<%=([\s\S]+?)%>/g;
	
	  /**
	   * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).
	   */
	  var reComboMarks = /[\u0300-\u036f\ufe20-\ufe23]/g;
	
	  /**
	   * Used to match [ES template delimiters](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-template-literal-lexical-components).
	   */
	  var reEsTemplate = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;
	
	  /** Used to match `RegExp` flags from their coerced string values. */
	  var reFlags = /\w*$/;
	
	  /** Used to detect hexadecimal string values. */
	  var reHexPrefix = /^0[xX]/;
	
	  /** Used to detect host constructors (Safari > 5). */
	  var reHostCtor = /^\[object .+?Constructor\]$/;
	
	  /** Used to match latin-1 supplementary letters (excluding mathematical operators). */
	  var reLatin1 = /[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g;
	
	  /** Used to ensure capturing order of template delimiters. */
	  var reNoMatch = /($^)/;
	
	  /**
	   * Used to match `RegExp` [special characters](http://www.regular-expressions.info/characters.html#special).
	   * In addition to special characters the forward slash is escaped to allow for
	   * easier `eval` use and `Function` compilation.
	   */
	  var reRegExpChars = /[.*+?^${}()|[\]\/\\]/g,
	      reHasRegExpChars = RegExp(reRegExpChars.source);
	
	  /** Used to match unescaped characters in compiled string literals. */
	  var reUnescapedString = /['\n\r\u2028\u2029\\]/g;
	
	  /** Used to match words to create compound words. */
	  var reWords = (function() {
	    var upper = '[A-Z\\xc0-\\xd6\\xd8-\\xde]',
	        lower = '[a-z\\xdf-\\xf6\\xf8-\\xff]+';
	
	    return RegExp(upper + '+(?=' + upper + lower + ')|' + upper + '?' + lower + '|' + upper + '+|[0-9]+', 'g');
	  }());
	
	  /** Used to detect and test for whitespace. */
	  var whitespace = (
	    // Basic whitespace characters.
	    ' \t\x0b\f\xa0\ufeff' +
	
	    // Line terminators.
	    '\n\r\u2028\u2029' +
	
	    // Unicode category "Zs" space separators.
	    '\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000'
	  );
	
	  /** Used to assign default `context` object properties. */
	  var contextProps = [
	    'Array', 'ArrayBuffer', 'Date', 'Error', 'Float32Array', 'Float64Array',
	    'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Math', 'Number',
	    'Object', 'RegExp', 'Set', 'String', '_', 'clearTimeout', 'document',
	    'isFinite', 'parseInt', 'setTimeout', 'TypeError', 'Uint8Array',
	    'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',
	    'window'
	  ];
	
	  /** Used to make template sourceURLs easier to identify. */
	  var templateCounter = -1;
	
	  /** Used to identify `toStringTag` values of typed arrays. */
	  var typedArrayTags = {};
	  typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
	  typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
	  typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
	  typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
	  typedArrayTags[uint32Tag] = true;
	  typedArrayTags[argsTag] = typedArrayTags[arrayTag] =
	  typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
	  typedArrayTags[dateTag] = typedArrayTags[errorTag] =
	  typedArrayTags[funcTag] = typedArrayTags[mapTag] =
	  typedArrayTags[numberTag] = typedArrayTags[objectTag] =
	  typedArrayTags[regexpTag] = typedArrayTags[setTag] =
	  typedArrayTags[stringTag] = typedArrayTags[weakMapTag] = false;
	
	  /** Used to identify `toStringTag` values supported by `_.clone`. */
	  var cloneableTags = {};
	  cloneableTags[argsTag] = cloneableTags[arrayTag] =
	  cloneableTags[arrayBufferTag] = cloneableTags[boolTag] =
	  cloneableTags[dateTag] = cloneableTags[float32Tag] =
	  cloneableTags[float64Tag] = cloneableTags[int8Tag] =
	  cloneableTags[int16Tag] = cloneableTags[int32Tag] =
	  cloneableTags[numberTag] = cloneableTags[objectTag] =
	  cloneableTags[regexpTag] = cloneableTags[stringTag] =
	  cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =
	  cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;
	  cloneableTags[errorTag] = cloneableTags[funcTag] =
	  cloneableTags[mapTag] = cloneableTags[setTag] =
	  cloneableTags[weakMapTag] = false;
	
	  /** Used as an internal `_.debounce` options object by `_.throttle`. */
	  var debounceOptions = {
	    'leading': false,
	    'maxWait': 0,
	    'trailing': false
	  };
	
	  /** Used to map latin-1 supplementary letters to basic latin letters. */
	  var deburredLetters = {
	    '\xc0': 'A',  '\xc1': 'A', '\xc2': 'A', '\xc3': 'A', '\xc4': 'A', '\xc5': 'A',
	    '\xe0': 'a',  '\xe1': 'a', '\xe2': 'a', '\xe3': 'a', '\xe4': 'a', '\xe5': 'a',
	    '\xc7': 'C',  '\xe7': 'c',
	    '\xd0': 'D',  '\xf0': 'd',
	    '\xc8': 'E',  '\xc9': 'E', '\xca': 'E', '\xcb': 'E',
	    '\xe8': 'e',  '\xe9': 'e', '\xea': 'e', '\xeb': 'e',
	    '\xcC': 'I',  '\xcd': 'I', '\xce': 'I', '\xcf': 'I',
	    '\xeC': 'i',  '\xed': 'i', '\xee': 'i', '\xef': 'i',
	    '\xd1': 'N',  '\xf1': 'n',
	    '\xd2': 'O',  '\xd3': 'O', '\xd4': 'O', '\xd5': 'O', '\xd6': 'O', '\xd8': 'O',
	    '\xf2': 'o',  '\xf3': 'o', '\xf4': 'o', '\xf5': 'o', '\xf6': 'o', '\xf8': 'o',
	    '\xd9': 'U',  '\xda': 'U', '\xdb': 'U', '\xdc': 'U',
	    '\xf9': 'u',  '\xfa': 'u', '\xfb': 'u', '\xfc': 'u',
	    '\xdd': 'Y',  '\xfd': 'y', '\xff': 'y',
	    '\xc6': 'Ae', '\xe6': 'ae',
	    '\xde': 'Th', '\xfe': 'th',
	    '\xdf': 'ss'
	  };
	
	  /** Used to map characters to HTML entities. */
	  var htmlEscapes = {
	    '&': '&amp;',
	    '<': '&lt;',
	    '>': '&gt;',
	    '"': '&quot;',
	    "'": '&#39;',
	    '`': '&#96;'
	  };
	
	  /** Used to map HTML entities to characters. */
	  var htmlUnescapes = {
	    '&amp;': '&',
	    '&lt;': '<',
	    '&gt;': '>',
	    '&quot;': '"',
	    '&#39;': "'",
	    '&#96;': '`'
	  };
	
	  /** Used to determine if values are of the language type `Object`. */
	  var objectTypes = {
	    'function': true,
	    'object': true
	  };
	
	  /** Used to escape characters for inclusion in compiled string literals. */
	  var stringEscapes = {
	    '\\': '\\',
	    "'": "'",
	    '\n': 'n',
	    '\r': 'r',
	    '\u2028': 'u2028',
	    '\u2029': 'u2029'
	  };
	
	  /** Detect free variable `exports`. */
	  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;
	
	  /** Detect free variable `module`. */
	  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;
	
	  /** Detect free variable `global` from Node.js. */
	  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global;
	
	  /** Detect free variable `self`. */
	  var freeSelf = objectTypes[typeof self] && self && self.Object && self;
	
	  /** Detect free variable `window`. */
	  var freeWindow = objectTypes[typeof window] && window && window.Object && window;
	
	  /** Detect the popular CommonJS extension `module.exports`. */
	  var moduleExports = freeModule && freeModule.exports === freeExports && freeExports;
	
	  /**
	   * Used as a reference to the global object.
	   *
	   * The `this` value is used if it is the global object to avoid Greasemonkey's
	   * restricted `window` object, otherwise the `window` object is used.
	   */
	  var root = freeGlobal || ((freeWindow !== (this && this.window)) && freeWindow) || freeSelf || this;
	
	  /*--------------------------------------------------------------------------*/
	
	  /**
	   * The base implementation of `compareAscending` which compares values and
	   * sorts them in ascending order without guaranteeing a stable sort.
	   *
	   * @private
	   * @param {*} value The value to compare to `other`.
	   * @param {*} other The value to compare to `value`.
	   * @returns {number} Returns the sort order indicator for `value`.
	   */
	  function baseCompareAscending(value, other) {
	    if (value !== other) {
	      var valIsReflexive = value === value,
	          othIsReflexive = other === other;
	
	      if (value > other || !valIsReflexive || (typeof value == 'undefined' && othIsReflexive)) {
	        return 1;
	      }
	      if (value < other || !othIsReflexive || (typeof other == 'undefined' && valIsReflexive)) {
	        return -1;
	      }
	    }
	    return 0;
	  }
	
	  /**
	   * The base implementation of `_.findIndex` and `_.findLastIndex` without
	   * support for callback shorthands and `this` binding.
	   *
	   * @private
	   * @param {Array} array The array to search.
	   * @param {Function} predicate The function invoked per iteration.
	   * @param {boolean} [fromRight] Specify iterating from right to left.
	   * @returns {number} Returns the index of the matched value, else `-1`.
	   */
	  function baseFindIndex(array, predicate, fromRight) {
	    var length = array.length,
	        index = fromRight ? length : -1;
	
	    while ((fromRight ? index-- : ++index < length)) {
	      if (predicate(array[index], index, array)) {
	        return index;
	      }
	    }
	    return -1;
	  }
	
	  /**
	   * The base implementation of `_.indexOf` without support for binary searches.
	   *
	   * @private
	   * @param {Array} array The array to search.
	   * @param {*} value The value to search for.
	   * @param {number} fromIndex The index to search from.
	   * @returns {number} Returns the index of the matched value, else `-1`.
	   */
	  function baseIndexOf(array, value, fromIndex) {
	    if (value !== value) {
	      return indexOfNaN(array, fromIndex);
	    }
	    var index = fromIndex - 1,
	        length = array.length;
	
	    while (++index < length) {
	      if (array[index] === value) {
	        return index;
	      }
	    }
	    return -1;
	  }
	
	  /**
	   * The base implementation of `_.isFunction` without support for environments
	   * with incorrect `typeof` results.
	   *
	   * @private
	   * @param {*} value The value to check.
	   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	   */
	  function baseIsFunction(value) {
	    // Avoid a Chakra JIT bug in compatibility modes of IE 11.
	    // See https://github.com/jashkenas/underscore/issues/1621 for more details.
	    return typeof value == 'function' || false;
	  }
	
	  /**
	   * Converts `value` to a string if it is not one. An empty string is returned
	   * for `null` or `undefined` values.
	   *
	   * @private
	   * @param {*} value The value to process.
	   * @returns {string} Returns the string.
	   */
	  function baseToString(value) {
	    if (typeof value == 'string') {
	      return value;
	    }
	    return value == null ? '' : (value + '');
	  }
	
	  /**
	   * Used by `_.max` and `_.min` as the default callback for string values.
	   *
	   * @private
	   * @param {string} string The string to inspect.
	   * @returns {number} Returns the code unit of the first character of the string.
	   */
	  function charAtCallback(string) {
	    return string.charCodeAt(0);
	  }
	
	  /**
	   * Used by `_.trim` and `_.trimLeft` to get the index of the first character
	   * of `string` that is not found in `chars`.
	   *
	   * @private
	   * @param {string} string The string to inspect.
	   * @param {string} chars The characters to find.
	   * @returns {number} Returns the index of the first character not found in `chars`.
	   */
	  function charsLeftIndex(string, chars) {
	    var index = -1,
	        length = string.length;
	
	    while (++index < length && chars.indexOf(string.charAt(index)) > -1) {}
	    return index;
	  }
	
	  /**
	   * Used by `_.trim` and `_.trimRight` to get the index of the last character
	   * of `string` that is not found in `chars`.
	   *
	   * @private
	   * @param {string} string The string to inspect.
	   * @param {string} chars The characters to find.
	   * @returns {number} Returns the index of the last character not found in `chars`.
	   */
	  function charsRightIndex(string, chars) {
	    var index = string.length;
	
	    while (index-- && chars.indexOf(string.charAt(index)) > -1) {}
	    return index;
	  }
	
	  /**
	   * Used by `_.sortBy` to compare transformed elements of a collection and stable
	   * sort them in ascending order.
	   *
	   * @private
	   * @param {Object} object The object to compare to `other`.
	   * @param {Object} other The object to compare to `object`.
	   * @returns {number} Returns the sort order indicator for `object`.
	   */
	  function compareAscending(object, other) {
	    return baseCompareAscending(object.criteria, other.criteria) || (object.index - other.index);
	  }
	
	  /**
	   * Used by `_.sortByOrder` to compare multiple properties of each element
	   * in a collection and stable sort them in the following order:
	   *
	   * If orders is unspecified, sort in ascending order for all properties.
	   * Otherwise, for each property, sort in ascending order if its corresponding value in
	   * orders is true, and descending order if false.
	   *
	   * @private
	   * @param {Object} object The object to compare to `other`.
	   * @param {Object} other The object to compare to `object`.
	   * @param {boolean[]} orders The order to sort by for each property.
	   * @returns {number} Returns the sort order indicator for `object`.
	   */
	  function compareMultiple(object, other, orders) {
	    var index = -1,
	        objCriteria = object.criteria,
	        othCriteria = other.criteria,
	        length = objCriteria.length,
	        ordersLength = orders.length;
	
	    while (++index < length) {
	      var result = baseCompareAscending(objCriteria[index], othCriteria[index]);
	      if (result) {
	        if (index >= ordersLength) {
	          return result;
	        }
	        return result * (orders[index] ? 1 : -1);
	      }
	    }
	    // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications
	    // that causes it, under certain circumstances, to provide the same value for
	    // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247
	    // for more details.
	    //
	    // This also ensures a stable sort in V8 and other engines.
	    // See https://code.google.com/p/v8/issues/detail?id=90 for more details.
	    return object.index - other.index;
	  }
	
	  /**
	   * Used by `_.deburr` to convert latin-1 supplementary letters to basic latin letters.
	   *
	   * @private
	   * @param {string} letter The matched letter to deburr.
	   * @returns {string} Returns the deburred letter.
	   */
	  function deburrLetter(letter) {
	    return deburredLetters[letter];
	  }
	
	  /**
	   * Used by `_.escape` to convert characters to HTML entities.
	   *
	   * @private
	   * @param {string} chr The matched character to escape.
	   * @returns {string} Returns the escaped character.
	   */
	  function escapeHtmlChar(chr) {
	    return htmlEscapes[chr];
	  }
	
	  /**
	   * Used by `_.template` to escape characters for inclusion in compiled
	   * string literals.
	   *
	   * @private
	   * @param {string} chr The matched character to escape.
	   * @returns {string} Returns the escaped character.
	   */
	  function escapeStringChar(chr) {
	    return '\\' + stringEscapes[chr];
	  }
	
	  /**
	   * Gets the index at which the first occurrence of `NaN` is found in `array`.
	   *
	   * @private
	   * @param {Array} array The array to search.
	   * @param {number} fromIndex The index to search from.
	   * @param {boolean} [fromRight] Specify iterating from right to left.
	   * @returns {number} Returns the index of the matched `NaN`, else `-1`.
	   */
	  function indexOfNaN(array, fromIndex, fromRight) {
	    var length = array.length,
	        index = fromIndex + (fromRight ? 0 : -1);
	
	    while ((fromRight ? index-- : ++index < length)) {
	      var other = array[index];
	      if (other !== other) {
	        return index;
	      }
	    }
	    return -1;
	  }
	
	  /**
	   * Checks if `value` is object-like.
	   *
	   * @private
	   * @param {*} value The value to check.
	   * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
	   */
	  function isObjectLike(value) {
	    return !!value && typeof value == 'object';
	  }
	
	  /**
	   * Used by `trimmedLeftIndex` and `trimmedRightIndex` to determine if a
	   * character code is whitespace.
	   *
	   * @private
	   * @param {number} charCode The character code to inspect.
	   * @returns {boolean} Returns `true` if `charCode` is whitespace, else `false`.
	   */
	  function isSpace(charCode) {
	    return ((charCode <= 160 && (charCode >= 9 && charCode <= 13) || charCode == 32 || charCode == 160) || charCode == 5760 || charCode == 6158 ||
	      (charCode >= 8192 && (charCode <= 8202 || charCode == 8232 || charCode == 8233 || charCode == 8239 || charCode == 8287 || charCode == 12288 || charCode == 65279)));
	  }
	
	  /**
	   * Replaces all `placeholder` elements in `array` with an internal placeholder
	   * and returns an array of their indexes.
	   *
	   * @private
	   * @param {Array} array The array to modify.
	   * @param {*} placeholder The placeholder to replace.
	   * @returns {Array} Returns the new array of placeholder indexes.
	   */
	  function replaceHolders(array, placeholder) {
	    var index = -1,
	        length = array.length,
	        resIndex = -1,
	        result = [];
	
	    while (++index < length) {
	      if (array[index] === placeholder) {
	        array[index] = PLACEHOLDER;
	        result[++resIndex] = index;
	      }
	    }
	    return result;
	  }
	
	  /**
	   * An implementation of `_.uniq` optimized for sorted arrays without support
	   * for callback shorthands and `this` binding.
	   *
	   * @private
	   * @param {Array} array The array to inspect.
	   * @param {Function} [iteratee] The function invoked per iteration.
	   * @returns {Array} Returns the new duplicate-value-free array.
	   */
	  function sortedUniq(array, iteratee) {
	    var seen,
	        index = -1,
	        length = array.length,
	        resIndex = -1,
	        result = [];
	
	    while (++index < length) {
	      var value = array[index],
	          computed = iteratee ? iteratee(value, index, array) : value;
	
	      if (!index || seen !== computed) {
	        seen = computed;
	        result[++resIndex] = value;
	      }
	    }
	    return result;
	  }
	
	  /**
	   * Used by `_.trim` and `_.trimLeft` to get the index of the first non-whitespace
	   * character of `string`.
	   *
	   * @private
	   * @param {string} string The string to inspect.
	   * @returns {number} Returns the index of the first non-whitespace character.
	   */
	  function trimmedLeftIndex(string) {
	    var index = -1,
	        length = string.length;
	
	    while (++index < length && isSpace(string.charCodeAt(index))) {}
	    return index;
	  }
	
	  /**
	   * Used by `_.trim` and `_.trimRight` to get the index of the last non-whitespace
	   * character of `string`.
	   *
	   * @private
	   * @param {string} string The string to inspect.
	   * @returns {number} Returns the index of the last non-whitespace character.
	   */
	  function trimmedRightIndex(string) {
	    var index = string.length;
	
	    while (index-- && isSpace(string.charCodeAt(index))) {}
	    return index;
	  }
	
	  /**
	   * Used by `_.unescape` to convert HTML entities to characters.
	   *
	   * @private
	   * @param {string} chr The matched character to unescape.
	   * @returns {string} Returns the unescaped character.
	   */
	  function unescapeHtmlChar(chr) {
	    return htmlUnescapes[chr];
	  }
	
	  /*--------------------------------------------------------------------------*/
	
	  /**
	   * Create a new pristine `lodash` function using the given `context` object.
	   *
	   * @static
	   * @memberOf _
	   * @category Utility
	   * @param {Object} [context=root] The context object.
	   * @returns {Function} Returns a new `lodash` function.
	   * @example
	   *
	   * _.mixin({ 'foo': _.constant('foo') });
	   *
	   * var lodash = _.runInContext();
	   * lodash.mixin({ 'bar': lodash.constant('bar') });
	   *
	   * _.isFunction(_.foo);
	   * // => true
	   * _.isFunction(_.bar);
	   * // => false
	   *
	   * lodash.isFunction(lodash.foo);
	   * // => false
	   * lodash.isFunction(lodash.bar);
	   * // => true
	   *
	   * // using `context` to mock `Date#getTime` use in `_.now`
	   * var mock = _.runInContext({
	   *   'Date': function() {
	   *     return { 'getTime': getTimeMock };
	   *   }
	   * });
	   *
	   * // or creating a suped-up `defer` in Node.js
	   * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;
	   */
	  function runInContext(context) {
	    // Avoid issues with some ES3 environments that attempt to use values, named
	    // after built-in constructors like `Object`, for the creation of literals.
	    // ES5 clears this up by stating that literals must use built-in constructors.
	    // See https://es5.github.io/#x11.1.5 for more details.
	    context = context ? _.defaults(root.Object(), context, _.pick(root, contextProps)) : root;
	
	    /** Native constructor references. */
	    var Array = context.Array,
	        Date = context.Date,
	        Error = context.Error,
	        Function = context.Function,
	        Math = context.Math,
	        Number = context.Number,
	        Object = context.Object,
	        RegExp = context.RegExp,
	        String = context.String,
	        TypeError = context.TypeError;
	
	    /** Used for native method references. */
	    var arrayProto = Array.prototype,
	        objectProto = Object.prototype,
	        stringProto = String.prototype;
	
	    /** Used to detect DOM support. */
	    var document = (document = context.window) && document.document;
	
	    /** Used to resolve the decompiled source of functions. */
	    var fnToString = Function.prototype.toString;
	
	    /** Used to the length of n-tuples for `_.unzip`. */
	    var getLength = baseProperty('length');
	
	    /** Used to check objects for own properties. */
	    var hasOwnProperty = objectProto.hasOwnProperty;
	
	    /** Used to generate unique IDs. */
	    var idCounter = 0;
	
	    /**
	     * Used to resolve the [`toStringTag`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-object.prototype.tostring)
	     * of values.
	     */
	    var objToString = objectProto.toString;
	
	    /** Used to restore the original `_` reference in `_.noConflict`. */
	    var oldDash = context._;
	
	    /** Used to detect if a method is native. */
	    var reNative = RegExp('^' +
	      escapeRegExp(objToString)
	      .replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
	    );
	
	    /** Native method references. */
	    var ArrayBuffer = isNative(ArrayBuffer = context.ArrayBuffer) && ArrayBuffer,
	        bufferSlice = isNative(bufferSlice = ArrayBuffer && new ArrayBuffer(0).slice) && bufferSlice,
	        ceil = Math.ceil,
	        clearTimeout = context.clearTimeout,
	        floor = Math.floor,
	        getPrototypeOf = isNative(getPrototypeOf = Object.getPrototypeOf) && getPrototypeOf,
	        push = arrayProto.push,
	        propertyIsEnumerable = objectProto.propertyIsEnumerable,
	        Set = isNative(Set = context.Set) && Set,
	        setTimeout = context.setTimeout,
	        splice = arrayProto.splice,
	        Uint8Array = isNative(Uint8Array = context.Uint8Array) && Uint8Array,
	        WeakMap = isNative(WeakMap = context.WeakMap) && WeakMap;
	
	    /** Used to clone array buffers. */
	    var Float64Array = (function() {
	      // Safari 5 errors when using an array buffer to initialize a typed array
	      // where the array buffer's `byteLength` is not a multiple of the typed
	      // array's `BYTES_PER_ELEMENT`.
	      try {
	        var func = isNative(func = context.Float64Array) && func,
	            result = new func(new ArrayBuffer(10), 0, 1) && func;
	      } catch(e) {}
	      return result;
	    }());
	
	    /* Native method references for those with the same name as other `lodash` methods. */
	    var nativeIsArray = isNative(nativeIsArray = Array.isArray) && nativeIsArray,
	        nativeCreate = isNative(nativeCreate = Object.create) && nativeCreate,
	        nativeIsFinite = context.isFinite,
	        nativeKeys = isNative(nativeKeys = Object.keys) && nativeKeys,
	        nativeMax = Math.max,
	        nativeMin = Math.min,
	        nativeNow = isNative(nativeNow = Date.now) && nativeNow,
	        nativeNumIsFinite = isNative(nativeNumIsFinite = Number.isFinite) && nativeNumIsFinite,
	        nativeParseInt = context.parseInt,
	        nativeRandom = Math.random;
	
	    /** Used as references for `-Infinity` and `Infinity`. */
	    var NEGATIVE_INFINITY = Number.NEGATIVE_INFINITY,
	        POSITIVE_INFINITY = Number.POSITIVE_INFINITY;
	
	    /** Used as references for the maximum length and index of an array. */
	    var MAX_ARRAY_LENGTH = Math.pow(2, 32) - 1,
	        MAX_ARRAY_INDEX =  MAX_ARRAY_LENGTH - 1,
	        HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;
	
	    /** Used as the size, in bytes, of each `Float64Array` element. */
	    var FLOAT64_BYTES_PER_ELEMENT = Float64Array ? Float64Array.BYTES_PER_ELEMENT : 0;
	
	    /**
	     * Used as the [maximum length](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-number.max_safe_integer)
	     * of an array-like value.
	     */
	    var MAX_SAFE_INTEGER = Math.pow(2, 53) - 1;
	
	    /** Used to store function metadata. */
	    var metaMap = WeakMap && new WeakMap;
	
	    /** Used to lookup unminified function names. */
	    var realNames = {};
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates a `lodash` object which wraps `value` to enable implicit chaining.
	     * Methods that operate on and return arrays, collections, and functions can
	     * be chained together. Methods that return a boolean or single value will
	     * automatically end the chain returning the unwrapped value. Explicit chaining
	     * may be enabled using `_.chain`. The execution of chained methods is lazy,
	     * that is, execution is deferred until `_#value` is implicitly or explicitly
	     * called.
	     *
	     * Lazy evaluation allows several methods to support shortcut fusion. Shortcut
	     * fusion is an optimization that merges iteratees to avoid creating intermediate
	     * arrays and reduce the number of iteratee executions.
	     *
	     * Chaining is supported in custom builds as long as the `_#value` method is
	     * directly or indirectly included in the build.
	     *
	     * In addition to lodash methods, wrappers have `Array` and `String` methods.
	     *
	     * The wrapper `Array` methods are:
	     * `concat`, `join`, `pop`, `push`, `reverse`, `shift`, `slice`, `sort`,
	     * `splice`, and `unshift`
	     *
	     * The wrapper `String` methods are:
	     * `replace` and `split`
	     *
	     * The wrapper methods that support shortcut fusion are:
	     * `compact`, `drop`, `dropRight`, `dropRightWhile`, `dropWhile`, `filter`,
	     * `first`, `initial`, `last`, `map`, `pluck`, `reject`, `rest`, `reverse`,
	     * `slice`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, `toArray`,
	     * and `where`
	     *
	     * The chainable wrapper methods are:
	     * `after`, `ary`, `assign`, `at`, `before`, `bind`, `bindAll`, `bindKey`,
	     * `callback`, `chain`, `chunk`, `commit`, `compact`, `concat`, `constant`,
	     * `countBy`, `create`, `curry`, `debounce`, `defaults`, `defer`, `delay`,
	     * `difference`, `drop`, `dropRight`, `dropRightWhile`, `dropWhile`, `fill`,
	     * `filter`, `flatten`, `flattenDeep`, `flow`, `flowRight`, `forEach`,
	     * `forEachRight`, `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `functions`,
	     * `groupBy`, `indexBy`, `initial`, `intersection`, `invert`, `invoke`, `keys`,
	     * `keysIn`, `map`, `mapValues`, `matches`, `matchesProperty`, `memoize`, `merge`,
	     * `mixin`, `negate`, `noop`, `omit`, `once`, `pairs`, `partial`, `partialRight`,
	     * `partition`, `pick`, `plant`, `pluck`, `property`, `propertyOf`, `pull`,
	     * `pullAt`, `push`, `range`, `rearg`, `reject`, `remove`, `rest`, `reverse`,
	     * `shuffle`, `slice`, `sort`, `sortBy`, `sortByAll`, `sortByOrder`, `splice`,
	     * `spread`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, `tap`,
	     * `throttle`, `thru`, `times`, `toArray`, `toPlainObject`, `transform`,
	     * `union`, `uniq`, `unshift`, `unzip`, `values`, `valuesIn`, `where`,
	     * `without`, `wrap`, `xor`, `zip`, and `zipObject`
	     *
	     * The wrapper methods that are **not** chainable by default are:
	     * `add`, `attempt`, `camelCase`, `capitalize`, `clone`, `cloneDeep`, `deburr`,
	     * `endsWith`, `escape`, `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`,
	     * `findLast`, `findLastIndex`, `findLastKey`, `findWhere`, `first`, `has`,
	     * `identity`, `includes`, `indexOf`, `inRange`, `isArguments`, `isArray`,
	     * `isBoolean`, `isDate`, `isElement`, `isEmpty`, `isEqual`, `isError`,
	     * `isFinite`,`isFunction`, `isMatch`, `isNative`, `isNaN`, `isNull`, `isNumber`,
	     * `isObject`, `isPlainObject`, `isRegExp`, `isString`, `isUndefined`,
	     * `isTypedArray`, `join`, `kebabCase`, `last`, `lastIndexOf`, `max`, `min`,
	     * `noConflict`, `now`, `pad`, `padLeft`, `padRight`, `parseInt`, `pop`,
	     * `random`, `reduce`, `reduceRight`, `repeat`, `result`, `runInContext`,
	     * `shift`, `size`, `snakeCase`, `some`, `sortedIndex`, `sortedLastIndex`,
	     * `startCase`, `startsWith`, `sum`, `template`, `trim`, `trimLeft`,
	     * `trimRight`, `trunc`, `unescape`, `uniqueId`, `value`, and `words`
	     *
	     * The wrapper method `sample` will return a wrapped value when `n` is provided,
	     * otherwise an unwrapped value is returned.
	     *
	     * @name _
	     * @constructor
	     * @category Chain
	     * @param {*} value The value to wrap in a `lodash` instance.
	     * @returns {Object} Returns the new `lodash` wrapper instance.
	     * @example
	     *
	     * var wrapped = _([1, 2, 3]);
	     *
	     * // returns an unwrapped value
	     * wrapped.reduce(function(sum, n) {
	     *   return sum + n;
	     * });
	     * // => 6
	     *
	     * // returns a wrapped value
	     * var squares = wrapped.map(function(n) {
	     *   return n * n;
	     * });
	     *
	     * _.isArray(squares);
	     * // => false
	     *
	     * _.isArray(squares.value());
	     * // => true
	     */
	    function lodash(value) {
	      if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {
	        if (value instanceof LodashWrapper) {
	          return value;
	        }
	        if (hasOwnProperty.call(value, '__chain__') && hasOwnProperty.call(value, '__wrapped__')) {
	          return wrapperClone(value);
	        }
	      }
	      return new LodashWrapper(value);
	    }
	
	    /**
	     * The function whose prototype all chaining wrappers inherit from.
	     *
	     * @private
	     */
	    function baseLodash() {
	      // No operation performed.
	    }
	
	    /**
	     * The base constructor for creating `lodash` wrapper objects.
	     *
	     * @private
	     * @param {*} value The value to wrap.
	     * @param {boolean} [chainAll] Enable chaining for all wrapper methods.
	     * @param {Array} [actions=[]] Actions to peform to resolve the unwrapped value.
	     */
	    function LodashWrapper(value, chainAll, actions) {
	      this.__wrapped__ = value;
	      this.__actions__ = actions || [];
	      this.__chain__ = !!chainAll;
	    }
	
	    /**
	     * An object environment feature flags.
	     *
	     * @static
	     * @memberOf _
	     * @type Object
	     */
	    var support = lodash.support = {};
	
	    (function(x) {
	
	      /**
	       * Detect if functions can be decompiled by `Function#toString`
	       * (all but Firefox OS certified apps, older Opera mobile browsers, and
	       * the PlayStation 3; forced `false` for Windows 8 apps).
	       *
	       * @memberOf _.support
	       * @type boolean
	       */
	      support.funcDecomp = /\bthis\b/.test(function() { return this; });
	
	      /**
	       * Detect if `Function#name` is supported (all but IE).
	       *
	       * @memberOf _.support
	       * @type boolean
	       */
	      support.funcNames = typeof Function.name == 'string';
	
	      /**
	       * Detect if the DOM is supported.
	       *
	       * @memberOf _.support
	       * @type boolean
	       */
	      try {
	        support.dom = document.createDocumentFragment().nodeType === 11;
	      } catch(e) {
	        support.dom = false;
	      }
	
	      /**
	       * Detect if `arguments` object indexes are non-enumerable.
	       *
	       * In Firefox < 4, IE < 9, PhantomJS, and Safari < 5.1 `arguments` object
	       * indexes are non-enumerable. Chrome < 25 and Node.js < 0.11.0 treat
	       * `arguments` object indexes as non-enumerable and fail `hasOwnProperty`
	       * checks for indexes that exceed their function's formal parameters with
	       * associated values of `0`.
	       *
	       * @memberOf _.support
	       * @type boolean
	       */
	      try {
	        support.nonEnumArgs = !propertyIsEnumerable.call(arguments, 1);
	      } catch(e) {
	        support.nonEnumArgs = true;
	      }
	    }(0, 0));
	
	    /**
	     * By default, the template delimiters used by lodash are like those in
	     * embedded Ruby (ERB). Change the following template settings to use
	     * alternative delimiters.
	     *
	     * @static
	     * @memberOf _
	     * @type Object
	     */
	    lodash.templateSettings = {
	
	      /**
	       * Used to detect `data` property values to be HTML-escaped.
	       *
	       * @memberOf _.templateSettings
	       * @type RegExp
	       */
	      'escape': reEscape,
	
	      /**
	       * Used to detect code to be evaluated.
	       *
	       * @memberOf _.templateSettings
	       * @type RegExp
	       */
	      'evaluate': reEvaluate,
	
	      /**
	       * Used to detect `data` property values to inject.
	       *
	       * @memberOf _.templateSettings
	       * @type RegExp
	       */
	      'interpolate': reInterpolate,
	
	      /**
	       * Used to reference the data object in the template text.
	       *
	       * @memberOf _.templateSettings
	       * @type string
	       */
	      'variable': '',
	
	      /**
	       * Used to import variables into the compiled template.
	       *
	       * @memberOf _.templateSettings
	       * @type Object
	       */
	      'imports': {
	
	        /**
	         * A reference to the `lodash` function.
	         *
	         * @memberOf _.templateSettings.imports
	         * @type Function
	         */
	        '_': lodash
	      }
	    };
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.
	     *
	     * @private
	     * @param {*} value The value to wrap.
	     */
	    function LazyWrapper(value) {
	      this.__wrapped__ = value;
	      this.__actions__ = null;
	      this.__dir__ = 1;
	      this.__dropCount__ = 0;
	      this.__filtered__ = false;
	      this.__iteratees__ = null;
	      this.__takeCount__ = POSITIVE_INFINITY;
	      this.__views__ = null;
	    }
	
	    /**
	     * Creates a clone of the lazy wrapper object.
	     *
	     * @private
	     * @name clone
	     * @memberOf LazyWrapper
	     * @returns {Object} Returns the cloned `LazyWrapper` object.
	     */
	    function lazyClone() {
	      var actions = this.__actions__,
	          iteratees = this.__iteratees__,
	          views = this.__views__,
	          result = new LazyWrapper(this.__wrapped__);
	
	      result.__actions__ = actions ? arrayCopy(actions) : null;
	      result.__dir__ = this.__dir__;
	      result.__filtered__ = this.__filtered__;
	      result.__iteratees__ = iteratees ? arrayCopy(iteratees) : null;
	      result.__takeCount__ = this.__takeCount__;
	      result.__views__ = views ? arrayCopy(views) : null;
	      return result;
	    }
	
	    /**
	     * Reverses the direction of lazy iteration.
	     *
	     * @private
	     * @name reverse
	     * @memberOf LazyWrapper
	     * @returns {Object} Returns the new reversed `LazyWrapper` object.
	     */
	    function lazyReverse() {
	      if (this.__filtered__) {
	        var result = new LazyWrapper(this);
	        result.__dir__ = -1;
	        result.__filtered__ = true;
	      } else {
	        result = this.clone();
	        result.__dir__ *= -1;
	      }
	      return result;
	    }
	
	    /**
	     * Extracts the unwrapped value from its lazy wrapper.
	     *
	     * @private
	     * @name value
	     * @memberOf LazyWrapper
	     * @returns {*} Returns the unwrapped value.
	     */
	    function lazyValue() {
	      var array = this.__wrapped__.value();
	      if (!isArray(array)) {
	        return baseWrapperValue(array, this.__actions__);
	      }
	      var dir = this.__dir__,
	          isRight = dir < 0,
	          view = getView(0, array.length, this.__views__),
	          start = view.start,
	          end = view.end,
	          length = end - start,
	          index = isRight ? end : (start - 1),
	          takeCount = nativeMin(length, this.__takeCount__),
	          iteratees = this.__iteratees__,
	          iterLength = iteratees ? iteratees.length : 0,
	          resIndex = 0,
	          result = [];
	
	      outer:
	      while (length-- && resIndex < takeCount) {
	        index += dir;
	
	        var iterIndex = -1,
	            value = array[index];
	
	        while (++iterIndex < iterLength) {
	          var data = iteratees[iterIndex],
	              iteratee = data.iteratee,
	              type = data.type;
	
	          if (type == LAZY_DROP_WHILE_FLAG) {
	            if (data.done && (isRight ? (index > data.index) : (index < data.index))) {
	              data.count = 0;
	              data.done = false;
	            }
	            data.index = index;
	            if (!data.done) {
	              var limit = data.limit;
	              if (!(data.done = limit > -1 ? (data.count++ >= limit) : !iteratee(value))) {
	                continue outer;
	              }
	            }
	          } else {
	            var computed = iteratee(value);
	            if (type == LAZY_MAP_FLAG) {
	              value = computed;
	            } else if (!computed) {
	              if (type == LAZY_FILTER_FLAG) {
	                continue outer;
	              } else {
	                break outer;
	              }
	            }
	          }
	        }
	        result[resIndex++] = value;
	      }
	      return result;
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates a cache object to store key/value pairs.
	     *
	     * @private
	     * @static
	     * @name Cache
	     * @memberOf _.memoize
	     */
	    function MapCache() {
	      this.__data__ = {};
	    }
	
	    /**
	     * Removes `key` and its value from the cache.
	     *
	     * @private
	     * @name delete
	     * @memberOf _.memoize.Cache
	     * @param {string} key The key of the value to remove.
	     * @returns {boolean} Returns `true` if the entry was removed successfully, else `false`.
	     */
	    function mapDelete(key) {
	      return this.has(key) && delete this.__data__[key];
	    }
	
	    /**
	     * Gets the cached value for `key`.
	     *
	     * @private
	     * @name get
	     * @memberOf _.memoize.Cache
	     * @param {string} key The key of the value to get.
	     * @returns {*} Returns the cached value.
	     */
	    function mapGet(key) {
	      return key == '__proto__' ? undefined : this.__data__[key];
	    }
	
	    /**
	     * Checks if a cached value for `key` exists.
	     *
	     * @private
	     * @name has
	     * @memberOf _.memoize.Cache
	     * @param {string} key The key of the entry to check.
	     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
	     */
	    function mapHas(key) {
	      return key != '__proto__' && hasOwnProperty.call(this.__data__, key);
	    }
	
	    /**
	     * Adds `value` to `key` of the cache.
	     *
	     * @private
	     * @name set
	     * @memberOf _.memoize.Cache
	     * @param {string} key The key of the value to cache.
	     * @param {*} value The value to cache.
	     * @returns {Object} Returns the cache object.
	     */
	    function mapSet(key, value) {
	      if (key != '__proto__') {
	        this.__data__[key] = value;
	      }
	      return this;
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     *
	     * Creates a cache object to store unique values.
	     *
	     * @private
	     * @param {Array} [values] The values to cache.
	     */
	    function SetCache(values) {
	      var length = values ? values.length : 0;
	
	      this.data = { 'hash': nativeCreate(null), 'set': new Set };
	      while (length--) {
	        this.push(values[length]);
	      }
	    }
	
	    /**
	     * Checks if `value` is in `cache` mimicking the return signature of
	     * `_.indexOf` by returning `0` if the value is found, else `-1`.
	     *
	     * @private
	     * @param {Object} cache The cache to search.
	     * @param {*} value The value to search for.
	     * @returns {number} Returns `0` if `value` is found, else `-1`.
	     */
	    function cacheIndexOf(cache, value) {
	      var data = cache.data,
	          result = (typeof value == 'string' || isObject(value)) ? data.set.has(value) : data.hash[value];
	
	      return result ? 0 : -1;
	    }
	
	    /**
	     * Adds `value` to the cache.
	     *
	     * @private
	     * @name push
	     * @memberOf SetCache
	     * @param {*} value The value to cache.
	     */
	    function cachePush(value) {
	      var data = this.data;
	      if (typeof value == 'string' || isObject(value)) {
	        data.set.add(value);
	      } else {
	        data.hash[value] = true;
	      }
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Copies the values of `source` to `array`.
	     *
	     * @private
	     * @param {Array} source The array to copy values from.
	     * @param {Array} [array=[]] The array to copy values to.
	     * @returns {Array} Returns `array`.
	     */
	    function arrayCopy(source, array) {
	      var index = -1,
	          length = source.length;
	
	      array || (array = Array(length));
	      while (++index < length) {
	        array[index] = source[index];
	      }
	      return array;
	    }
	
	    /**
	     * A specialized version of `_.forEach` for arrays without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Array} Returns `array`.
	     */
	    function arrayEach(array, iteratee) {
	      var index = -1,
	          length = array.length;
	
	      while (++index < length) {
	        if (iteratee(array[index], index, array) === false) {
	          break;
	        }
	      }
	      return array;
	    }
	
	    /**
	     * A specialized version of `_.forEachRight` for arrays without support for
	     * callback shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Array} Returns `array`.
	     */
	    function arrayEachRight(array, iteratee) {
	      var length = array.length;
	
	      while (length--) {
	        if (iteratee(array[length], length, array) === false) {
	          break;
	        }
	      }
	      return array;
	    }
	
	    /**
	     * A specialized version of `_.every` for arrays without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {boolean} Returns `true` if all elements pass the predicate check,
	     *  else `false`.
	     */
	    function arrayEvery(array, predicate) {
	      var index = -1,
	          length = array.length;
	
	      while (++index < length) {
	        if (!predicate(array[index], index, array)) {
	          return false;
	        }
	      }
	      return true;
	    }
	
	    /**
	     * A specialized version of `_.filter` for arrays without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {Array} Returns the new filtered array.
	     */
	    function arrayFilter(array, predicate) {
	      var index = -1,
	          length = array.length,
	          resIndex = -1,
	          result = [];
	
	      while (++index < length) {
	        var value = array[index];
	        if (predicate(value, index, array)) {
	          result[++resIndex] = value;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * A specialized version of `_.map` for arrays without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Array} Returns the new mapped array.
	     */
	    function arrayMap(array, iteratee) {
	      var index = -1,
	          length = array.length,
	          result = Array(length);
	
	      while (++index < length) {
	        result[index] = iteratee(array[index], index, array);
	      }
	      return result;
	    }
	
	    /**
	     * A specialized version of `_.max` for arrays without support for iteratees.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @returns {*} Returns the maximum value.
	     */
	    function arrayMax(array) {
	      var index = -1,
	          length = array.length,
	          result = NEGATIVE_INFINITY;
	
	      while (++index < length) {
	        var value = array[index];
	        if (value > result) {
	          result = value;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * A specialized version of `_.min` for arrays without support for iteratees.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @returns {*} Returns the minimum value.
	     */
	    function arrayMin(array) {
	      var index = -1,
	          length = array.length,
	          result = POSITIVE_INFINITY;
	
	      while (++index < length) {
	        var value = array[index];
	        if (value < result) {
	          result = value;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * A specialized version of `_.reduce` for arrays without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {*} [accumulator] The initial value.
	     * @param {boolean} [initFromArray] Specify using the first element of `array`
	     *  as the initial value.
	     * @returns {*} Returns the accumulated value.
	     */
	    function arrayReduce(array, iteratee, accumulator, initFromArray) {
	      var index = -1,
	          length = array.length;
	
	      if (initFromArray && length) {
	        accumulator = array[++index];
	      }
	      while (++index < length) {
	        accumulator = iteratee(accumulator, array[index], index, array);
	      }
	      return accumulator;
	    }
	
	    /**
	     * A specialized version of `_.reduceRight` for arrays without support for
	     * callback shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {*} [accumulator] The initial value.
	     * @param {boolean} [initFromArray] Specify using the last element of `array`
	     *  as the initial value.
	     * @returns {*} Returns the accumulated value.
	     */
	    function arrayReduceRight(array, iteratee, accumulator, initFromArray) {
	      var length = array.length;
	      if (initFromArray && length) {
	        accumulator = array[--length];
	      }
	      while (length--) {
	        accumulator = iteratee(accumulator, array[length], length, array);
	      }
	      return accumulator;
	    }
	
	    /**
	     * A specialized version of `_.some` for arrays without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {boolean} Returns `true` if any element passes the predicate check,
	     *  else `false`.
	     */
	    function arraySome(array, predicate) {
	      var index = -1,
	          length = array.length;
	
	      while (++index < length) {
	        if (predicate(array[index], index, array)) {
	          return true;
	        }
	      }
	      return false;
	    }
	
	    /**
	     * A specialized version of `_.sum` for arrays without support for iteratees.
	     *
	     * @private
	     * @param {Array} array The array to iterate over.
	     * @returns {number} Returns the sum.
	     */
	    function arraySum(array) {
	      var length = array.length,
	          result = 0;
	
	      while (length--) {
	        result += +array[length] || 0;
	      }
	      return result;
	    }
	
	    /**
	     * Used by `_.defaults` to customize its `_.assign` use.
	     *
	     * @private
	     * @param {*} objectValue The destination object property value.
	     * @param {*} sourceValue The source object property value.
	     * @returns {*} Returns the value to assign to the destination object.
	     */
	    function assignDefaults(objectValue, sourceValue) {
	      return typeof objectValue == 'undefined' ? sourceValue : objectValue;
	    }
	
	    /**
	     * Used by `_.template` to customize its `_.assign` use.
	     *
	     * **Note:** This method is like `assignDefaults` except that it ignores
	     * inherited property values when checking if a property is `undefined`.
	     *
	     * @private
	     * @param {*} objectValue The destination object property value.
	     * @param {*} sourceValue The source object property value.
	     * @param {string} key The key associated with the object and source values.
	     * @param {Object} object The destination object.
	     * @returns {*} Returns the value to assign to the destination object.
	     */
	    function assignOwnDefaults(objectValue, sourceValue, key, object) {
	      return (typeof objectValue == 'undefined' || !hasOwnProperty.call(object, key))
	        ? sourceValue
	        : objectValue;
	    }
	
	    /**
	     * The base implementation of `_.assign` without support for argument juggling,
	     * multiple sources, and `this` binding `customizer` functions.
	     *
	     * @private
	     * @param {Object} object The destination object.
	     * @param {Object} source The source object.
	     * @param {Function} [customizer] The function to customize assigning values.
	     * @returns {Object} Returns the destination object.
	     */
	    function baseAssign(object, source, customizer) {
	      var props = keys(source);
	      if (!customizer) {
	        return baseCopy(source, object, props);
	      }
	      var index = -1,
	          length = props.length;
	
	      while (++index < length) {
	        var key = props[index],
	            value = object[key],
	            result = customizer(value, source[key], key, object, source);
	
	        if ((result === result ? (result !== value) : (value === value)) ||
	            (typeof value == 'undefined' && !(key in object))) {
	          object[key] = result;
	        }
	      }
	      return object;
	    }
	
	    /**
	     * The base implementation of `_.at` without support for strings and individual
	     * key arguments.
	     *
	     * @private
	     * @param {Array|Object} collection The collection to iterate over.
	     * @param {number[]|string[]} [props] The property names or indexes of elements to pick.
	     * @returns {Array} Returns the new array of picked elements.
	     */
	    function baseAt(collection, props) {
	      var index = -1,
	          length = collection.length,
	          isArr = isLength(length),
	          propsLength = props.length,
	          result = Array(propsLength);
	
	      while(++index < propsLength) {
	        var key = props[index];
	        if (isArr) {
	          key = parseFloat(key);
	          result[index] = isIndex(key, length) ? collection[key] : undefined;
	        } else {
	          result[index] = collection[key];
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Copies the properties of `source` to `object`.
	     *
	     * @private
	     * @param {Object} source The object to copy properties from.
	     * @param {Object} [object={}] The object to copy properties to.
	     * @param {Array} props The property names to copy.
	     * @returns {Object} Returns `object`.
	     */
	    function baseCopy(source, object, props) {
	      if (!props) {
	        props = object;
	        object = {};
	      }
	      var index = -1,
	          length = props.length;
	
	      while (++index < length) {
	        var key = props[index];
	        object[key] = source[key];
	      }
	      return object;
	    }
	
	    /**
	     * The base implementation of `_.callback` which supports specifying the
	     * number of arguments to provide to `func`.
	     *
	     * @private
	     * @param {*} [func=_.identity] The value to convert to a callback.
	     * @param {*} [thisArg] The `this` binding of `func`.
	     * @param {number} [argCount] The number of arguments to provide to `func`.
	     * @returns {Function} Returns the callback.
	     */
	    function baseCallback(func, thisArg, argCount) {
	      var type = typeof func;
	      if (type == 'function') {
	        return typeof thisArg == 'undefined'
	          ? func
	          : bindCallback(func, thisArg, argCount);
	      }
	      if (func == null) {
	        return identity;
	      }
	      if (type == 'object') {
	        return baseMatches(func);
	      }
	      return typeof thisArg == 'undefined'
	        ? baseProperty(func + '')
	        : baseMatchesProperty(func + '', thisArg);
	    }
	
	    /**
	     * The base implementation of `_.clone` without support for argument juggling
	     * and `this` binding `customizer` functions.
	     *
	     * @private
	     * @param {*} value The value to clone.
	     * @param {boolean} [isDeep] Specify a deep clone.
	     * @param {Function} [customizer] The function to customize cloning values.
	     * @param {string} [key] The key of `value`.
	     * @param {Object} [object] The object `value` belongs to.
	     * @param {Array} [stackA=[]] Tracks traversed source objects.
	     * @param {Array} [stackB=[]] Associates clones with source counterparts.
	     * @returns {*} Returns the cloned value.
	     */
	    function baseClone(value, isDeep, customizer, key, object, stackA, stackB) {
	      var result;
	      if (customizer) {
	        result = object ? customizer(value, key, object) : customizer(value);
	      }
	      if (typeof result != 'undefined') {
	        return result;
	      }
	      if (!isObject(value)) {
	        return value;
	      }
	      var isArr = isArray(value);
	      if (isArr) {
	        result = initCloneArray(value);
	        if (!isDeep) {
	          return arrayCopy(value, result);
	        }
	      } else {
	        var tag = objToString.call(value),
	            isFunc = tag == funcTag;
	
	        if (tag == objectTag || tag == argsTag || (isFunc && !object)) {
	          result = initCloneObject(isFunc ? {} : value);
	          if (!isDeep) {
	            return baseCopy(value, result, keys(value));
	          }
	        } else {
	          return cloneableTags[tag]
	            ? initCloneByTag(value, tag, isDeep)
	            : (object ? value : {});
	        }
	      }
	      // Check for circular references and return corresponding clone.
	      stackA || (stackA = []);
	      stackB || (stackB = []);
	
	      var length = stackA.length;
	      while (length--) {
	        if (stackA[length] == value) {
	          return stackB[length];
	        }
	      }
	      // Add the source value to the stack of traversed objects and associate it with its clone.
	      stackA.push(value);
	      stackB.push(result);
	
	      // Recursively populate clone (susceptible to call stack limits).
	      (isArr ? arrayEach : baseForOwn)(value, function(subValue, key) {
	        result[key] = baseClone(subValue, isDeep, customizer, key, value, stackA, stackB);
	      });
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.create` without support for assigning
	     * properties to the created object.
	     *
	     * @private
	     * @param {Object} prototype The object to inherit from.
	     * @returns {Object} Returns the new object.
	     */
	    var baseCreate = (function() {
	      function Object() {}
	      return function(prototype) {
	        if (isObject(prototype)) {
	          Object.prototype = prototype;
	          var result = new Object;
	          Object.prototype = null;
	        }
	        return result || context.Object();
	      };
	    }());
	
	    /**
	     * The base implementation of `_.delay` and `_.defer` which accepts an index
	     * of where to slice the arguments to provide to `func`.
	     *
	     * @private
	     * @param {Function} func The function to delay.
	     * @param {number} wait The number of milliseconds to delay invocation.
	     * @param {Object} args The arguments provide to `func`.
	     * @returns {number} Returns the timer id.
	     */
	    function baseDelay(func, wait, args) {
	      if (typeof func != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      return setTimeout(function() { func.apply(undefined, args); }, wait);
	    }
	
	    /**
	     * The base implementation of `_.difference` which accepts a single array
	     * of values to exclude.
	     *
	     * @private
	     * @param {Array} array The array to inspect.
	     * @param {Array} values The values to exclude.
	     * @returns {Array} Returns the new array of filtered values.
	     */
	    function baseDifference(array, values) {
	      var length = array ? array.length : 0,
	          result = [];
	
	      if (!length) {
	        return result;
	      }
	      var index = -1,
	          indexOf = getIndexOf(),
	          isCommon = indexOf == baseIndexOf,
	          cache = (isCommon && values.length >= 200) ? createCache(values) : null,
	          valuesLength = values.length;
	
	      if (cache) {
	        indexOf = cacheIndexOf;
	        isCommon = false;
	        values = cache;
	      }
	      outer:
	      while (++index < length) {
	        var value = array[index];
	
	        if (isCommon && value === value) {
	          var valuesIndex = valuesLength;
	          while (valuesIndex--) {
	            if (values[valuesIndex] === value) {
	              continue outer;
	            }
	          }
	          result.push(value);
	        }
	        else if (indexOf(values, value, 0) < 0) {
	          result.push(value);
	        }
	      }
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.forEach` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Array|Object|string} Returns `collection`.
	     */
	    var baseEach = createBaseEach(baseForOwn);
	
	    /**
	     * The base implementation of `_.forEachRight` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Array|Object|string} Returns `collection`.
	     */
	    var baseEachRight = createBaseEach(baseForOwnRight, true);
	
	    /**
	     * The base implementation of `_.every` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {boolean} Returns `true` if all elements pass the predicate check,
	     *  else `false`
	     */
	    function baseEvery(collection, predicate) {
	      var result = true;
	      baseEach(collection, function(value, index, collection) {
	        result = !!predicate(value, index, collection);
	        return result;
	      });
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.fill` without an iteratee call guard.
	     *
	     * @private
	     * @param {Array} array The array to fill.
	     * @param {*} value The value to fill `array` with.
	     * @param {number} [start=0] The start position.
	     * @param {number} [end=array.length] The end position.
	     * @returns {Array} Returns `array`.
	     */
	    function baseFill(array, value, start, end) {
	      var length = array.length;
	
	      start = start == null ? 0 : (+start || 0);
	      if (start < 0) {
	        start = -start > length ? 0 : (length + start);
	      }
	      end = (typeof end == 'undefined' || end > length) ? length : (+end || 0);
	      if (end < 0) {
	        end += length;
	      }
	      length = start > end ? 0 : (end >>> 0);
	      start >>>= 0;
	
	      while (start < length) {
	        array[start++] = value;
	      }
	      return array;
	    }
	
	    /**
	     * The base implementation of `_.filter` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {Array} Returns the new filtered array.
	     */
	    function baseFilter(collection, predicate) {
	      var result = [];
	      baseEach(collection, function(value, index, collection) {
	        if (predicate(value, index, collection)) {
	          result.push(value);
	        }
	      });
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.find`, `_.findLast`, `_.findKey`, and `_.findLastKey`,
	     * without support for callback shorthands and `this` binding, which iterates
	     * over `collection` using the provided `eachFunc`.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to search.
	     * @param {Function} predicate The function invoked per iteration.
	     * @param {Function} eachFunc The function to iterate over `collection`.
	     * @param {boolean} [retKey] Specify returning the key of the found element
	     *  instead of the element itself.
	     * @returns {*} Returns the found element or its key, else `undefined`.
	     */
	    function baseFind(collection, predicate, eachFunc, retKey) {
	      var result;
	      eachFunc(collection, function(value, key, collection) {
	        if (predicate(value, key, collection)) {
	          result = retKey ? key : value;
	          return false;
	        }
	      });
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.flatten` with added support for restricting
	     * flattening and specifying the start index.
	     *
	     * @private
	     * @param {Array} array The array to flatten.
	     * @param {boolean} isDeep Specify a deep flatten.
	     * @param {boolean} isStrict Restrict flattening to arrays and `arguments` objects.
	     * @returns {Array} Returns the new flattened array.
	     */
	    function baseFlatten(array, isDeep, isStrict) {
	      var index = -1,
	          length = array.length,
	          resIndex = -1,
	          result = [];
	
	      while (++index < length) {
	        var value = array[index];
	
	        if (isObjectLike(value) && isLength(value.length) && (isArray(value) || isArguments(value))) {
	          if (isDeep) {
	            // Recursively flatten arrays (susceptible to call stack limits).
	            value = baseFlatten(value, isDeep, isStrict);
	          }
	          var valIndex = -1,
	              valLength = value.length;
	
	          result.length += valLength;
	          while (++valIndex < valLength) {
	            result[++resIndex] = value[valIndex];
	          }
	        } else if (!isStrict) {
	          result[++resIndex] = value;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * The base implementation of `baseForIn` and `baseForOwn` which iterates
	     * over `object` properties returned by `keysFunc` invoking `iteratee` for
	     * each property. Iterator functions may exit iteration early by explicitly
	     * returning `false`.
	     *
	     * @private
	     * @param {Object} object The object to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {Function} keysFunc The function to get the keys of `object`.
	     * @returns {Object} Returns `object`.
	     */
	    var baseFor = createBaseFor();
	
	    /**
	     * This function is like `baseFor` except that it iterates over properties
	     * in the opposite order.
	     *
	     * @private
	     * @param {Object} object The object to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {Function} keysFunc The function to get the keys of `object`.
	     * @returns {Object} Returns `object`.
	     */
	    var baseForRight = createBaseFor(true);
	
	    /**
	     * The base implementation of `_.forIn` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Object} object The object to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Object} Returns `object`.
	     */
	    function baseForIn(object, iteratee) {
	      return baseFor(object, iteratee, keysIn);
	    }
	
	    /**
	     * The base implementation of `_.forOwn` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Object} object The object to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Object} Returns `object`.
	     */
	    function baseForOwn(object, iteratee) {
	      return baseFor(object, iteratee, keys);
	    }
	
	    /**
	     * The base implementation of `_.forOwnRight` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Object} object The object to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Object} Returns `object`.
	     */
	    function baseForOwnRight(object, iteratee) {
	      return baseForRight(object, iteratee, keys);
	    }
	
	    /**
	     * The base implementation of `_.functions` which creates an array of
	     * `object` function property names filtered from those provided.
	     *
	     * @private
	     * @param {Object} object The object to inspect.
	     * @param {Array} props The property names to filter.
	     * @returns {Array} Returns the new array of filtered property names.
	     */
	    function baseFunctions(object, props) {
	      var index = -1,
	          length = props.length,
	          resIndex = -1,
	          result = [];
	
	      while (++index < length) {
	        var key = props[index];
	        if (isFunction(object[key])) {
	          result[++resIndex] = key;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.isEqual` without support for `this` binding
	     * `customizer` functions.
	     *
	     * @private
	     * @param {*} value The value to compare.
	     * @param {*} other The other value to compare.
	     * @param {Function} [customizer] The function to customize comparing values.
	     * @param {boolean} [isLoose] Specify performing partial comparisons.
	     * @param {Array} [stackA] Tracks traversed `value` objects.
	     * @param {Array} [stackB] Tracks traversed `other` objects.
	     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
	     */
	    function baseIsEqual(value, other, customizer, isLoose, stackA, stackB) {
	      // Exit early for identical values.
	      if (value === other) {
	        // Treat `+0` vs. `-0` as not equal.
	        return value !== 0 || (1 / value == 1 / other);
	      }
	      var valType = typeof value,
	          othType = typeof other;
	
	      // Exit early for unlike primitive values.
	      if ((valType != 'function' && valType != 'object' && othType != 'function' && othType != 'object') ||
	          value == null || other == null) {
	        // Return `false` unless both values are `NaN`.
	        return value !== value && other !== other;
	      }
	      return baseIsEqualDeep(value, other, baseIsEqual, customizer, isLoose, stackA, stackB);
	    }
	
	    /**
	     * A specialized version of `baseIsEqual` for arrays and objects which performs
	     * deep comparisons and tracks traversed objects enabling objects with circular
	     * references to be compared.
	     *
	     * @private
	     * @param {Object} object The object to compare.
	     * @param {Object} other The other object to compare.
	     * @param {Function} equalFunc The function to determine equivalents of values.
	     * @param {Function} [customizer] The function to customize comparing objects.
	     * @param {boolean} [isLoose] Specify performing partial comparisons.
	     * @param {Array} [stackA=[]] Tracks traversed `value` objects.
	     * @param {Array} [stackB=[]] Tracks traversed `other` objects.
	     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
	     */
	    function baseIsEqualDeep(object, other, equalFunc, customizer, isLoose, stackA, stackB) {
	      var objIsArr = isArray(object),
	          othIsArr = isArray(other),
	          objTag = arrayTag,
	          othTag = arrayTag;
	
	      if (!objIsArr) {
	        objTag = objToString.call(object);
	        if (objTag == argsTag) {
	          objTag = objectTag;
	        } else if (objTag != objectTag) {
	          objIsArr = isTypedArray(object);
	        }
	      }
	      if (!othIsArr) {
	        othTag = objToString.call(other);
	        if (othTag == argsTag) {
	          othTag = objectTag;
	        } else if (othTag != objectTag) {
	          othIsArr = isTypedArray(other);
	        }
	      }
	      var objIsObj = (objTag == objectTag || (isLoose && objTag == funcTag)),
	          othIsObj = (othTag == objectTag || (isLoose && othTag == funcTag)),
	          isSameTag = objTag == othTag;
	
	      if (isSameTag && !(objIsArr || objIsObj)) {
	        return equalByTag(object, other, objTag);
	      }
	      if (isLoose) {
	        if (!isSameTag && !(objIsObj && othIsObj)) {
	          return false;
	        }
	      } else {
	        var valWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),
	            othWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');
	
	        if (valWrapped || othWrapped) {
	          return equalFunc(valWrapped ? object.value() : object, othWrapped ? other.value() : other, customizer, isLoose, stackA, stackB);
	        }
	        if (!isSameTag) {
	          return false;
	        }
	      }
	      // Assume cyclic values are equal.
	      // For more information on detecting circular references see https://es5.github.io/#JO.
	      stackA || (stackA = []);
	      stackB || (stackB = []);
	
	      var length = stackA.length;
	      while (length--) {
	        if (stackA[length] == object) {
	          return stackB[length] == other;
	        }
	      }
	      // Add `object` and `other` to the stack of traversed objects.
	      stackA.push(object);
	      stackB.push(other);
	
	      var result = (objIsArr ? equalArrays : equalObjects)(object, other, equalFunc, customizer, isLoose, stackA, stackB);
	
	      stackA.pop();
	      stackB.pop();
	
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.isMatch` without support for callback
	     * shorthands and `this` binding.
	     *
	     * @private
	     * @param {Object} object The object to inspect.
	     * @param {Array} props The source property names to match.
	     * @param {Array} values The source values to match.
	     * @param {Array} strictCompareFlags Strict comparison flags for source values.
	     * @param {Function} [customizer] The function to customize comparing objects.
	     * @returns {boolean} Returns `true` if `object` is a match, else `false`.
	     */
	    function baseIsMatch(object, props, values, strictCompareFlags, customizer) {
	      var index = -1,
	          length = props.length,
	          noCustomizer = !customizer;
	
	      while (++index < length) {
	        if ((noCustomizer && strictCompareFlags[index])
	              ? values[index] !== object[props[index]]
	              : !(props[index] in object)
	            ) {
	          return false;
	        }
	      }
	      index = -1;
	      while (++index < length) {
	        var key = props[index],
	            objValue = object[key],
	            srcValue = values[index];
	
	        if (noCustomizer && strictCompareFlags[index]) {
	          var result = typeof objValue != 'undefined' || (key in object);
	        } else {
	          result = customizer ? customizer(objValue, srcValue, key) : undefined;
	          if (typeof result == 'undefined') {
	            result = baseIsEqual(srcValue, objValue, customizer, true);
	          }
	        }
	        if (!result) {
	          return false;
	        }
	      }
	      return true;
	    }
	
	    /**
	     * The base implementation of `_.map` without support for callback shorthands
	     * and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {Array} Returns the new mapped array.
	     */
	    function baseMap(collection, iteratee) {
	      var result = [];
	      baseEach(collection, function(value, key, collection) {
	        result.push(iteratee(value, key, collection));
	      });
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.matches` which does not clone `source`.
	     *
	     * @private
	     * @param {Object} source The object of property values to match.
	     * @returns {Function} Returns the new function.
	     */
	    function baseMatches(source) {
	      var props = keys(source),
	          length = props.length;
	
	      if (!length) {
	        return constant(true);
	      }
	      if (length == 1) {
	        var key = props[0],
	            value = source[key];
	
	        if (isStrictComparable(value)) {
	          return function(object) {
	            return object != null && object[key] === value &&
	              (typeof value != 'undefined' || (key in toObject(object)));
	          };
	        }
	      }
	      var values = Array(length),
	          strictCompareFlags = Array(length);
	
	      while (length--) {
	        value = source[props[length]];
	        values[length] = value;
	        strictCompareFlags[length] = isStrictComparable(value);
	      }
	      return function(object) {
	        return object != null && baseIsMatch(toObject(object), props, values, strictCompareFlags);
	      };
	    }
	
	    /**
	     * The base implementation of `_.matchesProperty` which does not coerce `key`
	     * to a string.
	     *
	     * @private
	     * @param {string} key The key of the property to get.
	     * @param {*} value The value to compare.
	     * @returns {Function} Returns the new function.
	     */
	    function baseMatchesProperty(key, value) {
	      if (isStrictComparable(value)) {
	        return function(object) {
	          return object != null && object[key] === value &&
	            (typeof value != 'undefined' || (key in toObject(object)));
	        };
	      }
	      return function(object) {
	        return object != null && baseIsEqual(value, object[key], null, true);
	      };
	    }
	
	    /**
	     * The base implementation of `_.merge` without support for argument juggling,
	     * multiple sources, and `this` binding `customizer` functions.
	     *
	     * @private
	     * @param {Object} object The destination object.
	     * @param {Object} source The source object.
	     * @param {Function} [customizer] The function to customize merging properties.
	     * @param {Array} [stackA=[]] Tracks traversed source objects.
	     * @param {Array} [stackB=[]] Associates values with source counterparts.
	     * @returns {Object} Returns the destination object.
	     */
	    function baseMerge(object, source, customizer, stackA, stackB) {
	      if (!isObject(object)) {
	        return object;
	      }
	      var isSrcArr = isLength(source.length) && (isArray(source) || isTypedArray(source));
	      (isSrcArr ? arrayEach : baseForOwn)(source, function(srcValue, key, source) {
	        if (isObjectLike(srcValue)) {
	          stackA || (stackA = []);
	          stackB || (stackB = []);
	          return baseMergeDeep(object, source, key, baseMerge, customizer, stackA, stackB);
	        }
	        var value = object[key],
	            result = customizer ? customizer(value, srcValue, key, object, source) : undefined,
	            isCommon = typeof result == 'undefined';
	
	        if (isCommon) {
	          result = srcValue;
	        }
	        if ((isSrcArr || typeof result != 'undefined') &&
	            (isCommon || (result === result ? (result !== value) : (value === value)))) {
	          object[key] = result;
	        }
	      });
	      return object;
	    }
	
	    /**
	     * A specialized version of `baseMerge` for arrays and objects which performs
	     * deep merges and tracks traversed objects enabling objects with circular
	     * references to be merged.
	     *
	     * @private
	     * @param {Object} object The destination object.
	     * @param {Object} source The source object.
	     * @param {string} key The key of the value to merge.
	     * @param {Function} mergeFunc The function to merge values.
	     * @param {Function} [customizer] The function to customize merging properties.
	     * @param {Array} [stackA=[]] Tracks traversed source objects.
	     * @param {Array} [stackB=[]] Associates values with source counterparts.
	     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
	     */
	    function baseMergeDeep(object, source, key, mergeFunc, customizer, stackA, stackB) {
	      var length = stackA.length,
	          srcValue = source[key];
	
	      while (length--) {
	        if (stackA[length] == srcValue) {
	          object[key] = stackB[length];
	          return;
	        }
	      }
	      var value = object[key],
	          result = customizer ? customizer(value, srcValue, key, object, source) : undefined,
	          isCommon = typeof result == 'undefined';
	
	      if (isCommon) {
	        result = srcValue;
	        if (isLength(srcValue.length) && (isArray(srcValue) || isTypedArray(srcValue))) {
	          result = isArray(value)
	            ? value
	            : ((value && value.length) ? arrayCopy(value) : []);
	        }
	        else if (isPlainObject(srcValue) || isArguments(srcValue)) {
	          result = isArguments(value)
	            ? toPlainObject(value)
	            : (isPlainObject(value) ? value : {});
	        }
	        else {
	          isCommon = false;
	        }
	      }
	      // Add the source value to the stack of traversed objects and associate
	      // it with its merged value.
	      stackA.push(srcValue);
	      stackB.push(result);
	
	      if (isCommon) {
	        // Recursively merge objects and arrays (susceptible to call stack limits).
	        object[key] = mergeFunc(result, srcValue, customizer, stackA, stackB);
	      } else if (result === result ? (result !== value) : (value === value)) {
	        object[key] = result;
	      }
	    }
	
	    /**
	     * The base implementation of `_.property` which does not coerce `key` to a string.
	     *
	     * @private
	     * @param {string} key The key of the property to get.
	     * @returns {Function} Returns the new function.
	     */
	    function baseProperty(key) {
	      return function(object) {
	        return object == null ? undefined : object[key];
	      };
	    }
	
	    /**
	     * The base implementation of `_.random` without support for argument juggling
	     * and returning floating-point numbers.
	     *
	     * @private
	     * @param {number} min The minimum possible value.
	     * @param {number} max The maximum possible value.
	     * @returns {number} Returns the random number.
	     */
	    function baseRandom(min, max) {
	      return min + floor(nativeRandom() * (max - min + 1));
	    }
	
	    /**
	     * The base implementation of `_.reduce` and `_.reduceRight` without support
	     * for callback shorthands and `this` binding, which iterates over `collection`
	     * using the provided `eachFunc`.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {*} accumulator The initial value.
	     * @param {boolean} initFromCollection Specify using the first or last element
	     *  of `collection` as the initial value.
	     * @param {Function} eachFunc The function to iterate over `collection`.
	     * @returns {*} Returns the accumulated value.
	     */
	    function baseReduce(collection, iteratee, accumulator, initFromCollection, eachFunc) {
	      eachFunc(collection, function(value, index, collection) {
	        accumulator = initFromCollection
	          ? (initFromCollection = false, value)
	          : iteratee(accumulator, value, index, collection);
	      });
	      return accumulator;
	    }
	
	    /**
	     * The base implementation of `setData` without support for hot loop detection.
	     *
	     * @private
	     * @param {Function} func The function to associate metadata with.
	     * @param {*} data The metadata.
	     * @returns {Function} Returns `func`.
	     */
	    var baseSetData = !metaMap ? identity : function(func, data) {
	      metaMap.set(func, data);
	      return func;
	    };
	
	    /**
	     * The base implementation of `_.slice` without an iteratee call guard.
	     *
	     * @private
	     * @param {Array} array The array to slice.
	     * @param {number} [start=0] The start position.
	     * @param {number} [end=array.length] The end position.
	     * @returns {Array} Returns the slice of `array`.
	     */
	    function baseSlice(array, start, end) {
	      var index = -1,
	          length = array.length;
	
	      start = start == null ? 0 : (+start || 0);
	      if (start < 0) {
	        start = -start > length ? 0 : (length + start);
	      }
	      end = (typeof end == 'undefined' || end > length) ? length : (+end || 0);
	      if (end < 0) {
	        end += length;
	      }
	      length = start > end ? 0 : ((end - start) >>> 0);
	      start >>>= 0;
	
	      var result = Array(length);
	      while (++index < length) {
	        result[index] = array[index + start];
	      }
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.some` without support for callback shorthands
	     * and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {boolean} Returns `true` if any element passes the predicate check,
	     *  else `false`.
	     */
	    function baseSome(collection, predicate) {
	      var result;
	
	      baseEach(collection, function(value, index, collection) {
	        result = predicate(value, index, collection);
	        return !result;
	      });
	      return !!result;
	    }
	
	    /**
	     * The base implementation of `_.sortBy` which uses `comparer` to define
	     * the sort order of `array` and replaces criteria objects with their
	     * corresponding values.
	     *
	     * @private
	     * @param {Array} array The array to sort.
	     * @param {Function} comparer The function to define sort order.
	     * @returns {Array} Returns `array`.
	     */
	    function baseSortBy(array, comparer) {
	      var length = array.length;
	
	      array.sort(comparer);
	      while (length--) {
	        array[length] = array[length].value;
	      }
	      return array;
	    }
	
	    /**
	     * The base implementation of `_.sortByOrder` without param guards.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {string[]} props The property names to sort by.
	     * @param {boolean[]} orders The sort orders of `props`.
	     * @returns {Array} Returns the new sorted array.
	     */
	    function baseSortByOrder(collection, props, orders) {
	      var index = -1,
	          length = collection.length,
	          result = isLength(length) ? Array(length) : [];
	
	      baseEach(collection, function(value) {
	        var length = props.length,
	            criteria = Array(length);
	
	        while (length--) {
	          criteria[length] = value == null ? undefined : value[props[length]];
	        }
	        result[++index] = { 'criteria': criteria, 'index': index, 'value': value };
	      });
	
	      return baseSortBy(result, function(object, other) {
	        return compareMultiple(object, other, orders);
	      });
	    }
	
	    /**
	     * The base implementation of `_.sum` without support for callback shorthands
	     * and `this` binding.
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @returns {number} Returns the sum.
	     */
	    function baseSum(collection, iteratee) {
	      var result = 0;
	      baseEach(collection, function(value, index, collection) {
	        result += +iteratee(value, index, collection) || 0;
	      });
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.uniq` without support for callback shorthands
	     * and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to inspect.
	     * @param {Function} [iteratee] The function invoked per iteration.
	     * @returns {Array} Returns the new duplicate-value-free array.
	     */
	    function baseUniq(array, iteratee) {
	      var index = -1,
	          indexOf = getIndexOf(),
	          length = array.length,
	          isCommon = indexOf == baseIndexOf,
	          isLarge = isCommon && length >= 200,
	          seen = isLarge ? createCache() : null,
	          result = [];
	
	      if (seen) {
	        indexOf = cacheIndexOf;
	        isCommon = false;
	      } else {
	        isLarge = false;
	        seen = iteratee ? [] : result;
	      }
	      outer:
	      while (++index < length) {
	        var value = array[index],
	            computed = iteratee ? iteratee(value, index, array) : value;
	
	        if (isCommon && value === value) {
	          var seenIndex = seen.length;
	          while (seenIndex--) {
	            if (seen[seenIndex] === computed) {
	              continue outer;
	            }
	          }
	          if (iteratee) {
	            seen.push(computed);
	          }
	          result.push(value);
	        }
	        else if (indexOf(seen, computed, 0) < 0) {
	          if (iteratee || isLarge) {
	            seen.push(computed);
	          }
	          result.push(value);
	        }
	      }
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.values` and `_.valuesIn` which creates an
	     * array of `object` property values corresponding to the property names
	     * returned by `keysFunc`.
	     *
	     * @private
	     * @param {Object} object The object to query.
	     * @param {Array} props The property names to get values for.
	     * @returns {Object} Returns the array of property values.
	     */
	    function baseValues(object, props) {
	      var index = -1,
	          length = props.length,
	          result = Array(length);
	
	      while (++index < length) {
	        result[index] = object[props[index]];
	      }
	      return result;
	    }
	
	    /**
	     * The base implementation of `_.dropRightWhile`, `_.dropWhile`, `_.takeRightWhile`,
	     * and `_.takeWhile` without support for callback shorthands and `this` binding.
	     *
	     * @private
	     * @param {Array} array The array to query.
	     * @param {Function} predicate The function invoked per iteration.
	     * @param {boolean} [isDrop] Specify dropping elements instead of taking them.
	     * @param {boolean} [fromRight] Specify iterating from right to left.
	     * @returns {Array} Returns the slice of `array`.
	     */
	    function baseWhile(array, predicate, isDrop, fromRight) {
	      var length = array.length,
	          index = fromRight ? length : -1;
	
	      while ((fromRight ? index-- : ++index < length) && predicate(array[index], index, array)) {}
	      return isDrop
	        ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))
	        : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));
	    }
	
	    /**
	     * The base implementation of `wrapperValue` which returns the result of
	     * performing a sequence of actions on the unwrapped `value`, where each
	     * successive action is supplied the return value of the previous.
	     *
	     * @private
	     * @param {*} value The unwrapped value.
	     * @param {Array} actions Actions to peform to resolve the unwrapped value.
	     * @returns {*} Returns the resolved value.
	     */
	    function baseWrapperValue(value, actions) {
	      var result = value;
	      if (result instanceof LazyWrapper) {
	        result = result.value();
	      }
	      var index = -1,
	          length = actions.length;
	
	      while (++index < length) {
	        var args = [result],
	            action = actions[index];
	
	        push.apply(args, action.args);
	        result = action.func.apply(action.thisArg, args);
	      }
	      return result;
	    }
	
	    /**
	     * Performs a binary search of `array` to determine the index at which `value`
	     * should be inserted into `array` in order to maintain its sort order.
	     *
	     * @private
	     * @param {Array} array The sorted array to inspect.
	     * @param {*} value The value to evaluate.
	     * @param {boolean} [retHighest] Specify returning the highest qualified index.
	     * @returns {number} Returns the index at which `value` should be inserted
	     *  into `array`.
	     */
	    function binaryIndex(array, value, retHighest) {
	      var low = 0,
	          high = array ? array.length : low;
	
	      if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {
	        while (low < high) {
	          var mid = (low + high) >>> 1,
	              computed = array[mid];
	
	          if (retHighest ? (computed <= value) : (computed < value)) {
	            low = mid + 1;
	          } else {
	            high = mid;
	          }
	        }
	        return high;
	      }
	      return binaryIndexBy(array, value, identity, retHighest);
	    }
	
	    /**
	     * This function is like `binaryIndex` except that it invokes `iteratee` for
	     * `value` and each element of `array` to compute their sort ranking. The
	     * iteratee is invoked with one argument; (value).
	     *
	     * @private
	     * @param {Array} array The sorted array to inspect.
	     * @param {*} value The value to evaluate.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {boolean} [retHighest] Specify returning the highest qualified index.
	     * @returns {number} Returns the index at which `value` should be inserted
	     *  into `array`.
	     */
	    function binaryIndexBy(array, value, iteratee, retHighest) {
	      value = iteratee(value);
	
	      var low = 0,
	          high = array ? array.length : 0,
	          valIsNaN = value !== value,
	          valIsUndef = typeof value == 'undefined';
	
	      while (low < high) {
	        var mid = floor((low + high) / 2),
	            computed = iteratee(array[mid]),
	            isReflexive = computed === computed;
	
	        if (valIsNaN) {
	          var setLow = isReflexive || retHighest;
	        } else if (valIsUndef) {
	          setLow = isReflexive && (retHighest || typeof computed != 'undefined');
	        } else {
	          setLow = retHighest ? (computed <= value) : (computed < value);
	        }
	        if (setLow) {
	          low = mid + 1;
	        } else {
	          high = mid;
	        }
	      }
	      return nativeMin(high, MAX_ARRAY_INDEX);
	    }
	
	    /**
	     * A specialized version of `baseCallback` which only supports `this` binding
	     * and specifying the number of arguments to provide to `func`.
	     *
	     * @private
	     * @param {Function} func The function to bind.
	     * @param {*} thisArg The `this` binding of `func`.
	     * @param {number} [argCount] The number of arguments to provide to `func`.
	     * @returns {Function} Returns the callback.
	     */
	    function bindCallback(func, thisArg, argCount) {
	      if (typeof func != 'function') {
	        return identity;
	      }
	      if (typeof thisArg == 'undefined') {
	        return func;
	      }
	      switch (argCount) {
	        case 1: return function(value) {
	          return func.call(thisArg, value);
	        };
	        case 3: return function(value, index, collection) {
	          return func.call(thisArg, value, index, collection);
	        };
	        case 4: return function(accumulator, value, index, collection) {
	          return func.call(thisArg, accumulator, value, index, collection);
	        };
	        case 5: return function(value, other, key, object, source) {
	          return func.call(thisArg, value, other, key, object, source);
	        };
	      }
	      return function() {
	        return func.apply(thisArg, arguments);
	      };
	    }
	
	    /**
	     * Creates a clone of the given array buffer.
	     *
	     * @private
	     * @param {ArrayBuffer} buffer The array buffer to clone.
	     * @returns {ArrayBuffer} Returns the cloned array buffer.
	     */
	    function bufferClone(buffer) {
	      return bufferSlice.call(buffer, 0);
	    }
	    if (!bufferSlice) {
	      // PhantomJS has `ArrayBuffer` and `Uint8Array` but not `Float64Array`.
	      bufferClone = !(ArrayBuffer && Uint8Array) ? constant(null) : function(buffer) {
	        var byteLength = buffer.byteLength,
	            floatLength = Float64Array ? floor(byteLength / FLOAT64_BYTES_PER_ELEMENT) : 0,
	            offset = floatLength * FLOAT64_BYTES_PER_ELEMENT,
	            result = new ArrayBuffer(byteLength);
	
	        if (floatLength) {
	          var view = new Float64Array(result, 0, floatLength);
	          view.set(new Float64Array(buffer, 0, floatLength));
	        }
	        if (byteLength != offset) {
	          view = new Uint8Array(result, offset);
	          view.set(new Uint8Array(buffer, offset));
	        }
	        return result;
	      };
	    }
	
	    /**
	     * Creates an array that is the composition of partially applied arguments,
	     * placeholders, and provided arguments into a single array of arguments.
	     *
	     * @private
	     * @param {Array|Object} args The provided arguments.
	     * @param {Array} partials The arguments to prepend to those provided.
	     * @param {Array} holders The `partials` placeholder indexes.
	     * @returns {Array} Returns the new array of composed arguments.
	     */
	    function composeArgs(args, partials, holders) {
	      var holdersLength = holders.length,
	          argsIndex = -1,
	          argsLength = nativeMax(args.length - holdersLength, 0),
	          leftIndex = -1,
	          leftLength = partials.length,
	          result = Array(argsLength + leftLength);
	
	      while (++leftIndex < leftLength) {
	        result[leftIndex] = partials[leftIndex];
	      }
	      while (++argsIndex < holdersLength) {
	        result[holders[argsIndex]] = args[argsIndex];
	      }
	      while (argsLength--) {
	        result[leftIndex++] = args[argsIndex++];
	      }
	      return result;
	    }
	
	    /**
	     * This function is like `composeArgs` except that the arguments composition
	     * is tailored for `_.partialRight`.
	     *
	     * @private
	     * @param {Array|Object} args The provided arguments.
	     * @param {Array} partials The arguments to append to those provided.
	     * @param {Array} holders The `partials` placeholder indexes.
	     * @returns {Array} Returns the new array of composed arguments.
	     */
	    function composeArgsRight(args, partials, holders) {
	      var holdersIndex = -1,
	          holdersLength = holders.length,
	          argsIndex = -1,
	          argsLength = nativeMax(args.length - holdersLength, 0),
	          rightIndex = -1,
	          rightLength = partials.length,
	          result = Array(argsLength + rightLength);
	
	      while (++argsIndex < argsLength) {
	        result[argsIndex] = args[argsIndex];
	      }
	      var pad = argsIndex;
	      while (++rightIndex < rightLength) {
	        result[pad + rightIndex] = partials[rightIndex];
	      }
	      while (++holdersIndex < holdersLength) {
	        result[pad + holders[holdersIndex]] = args[argsIndex++];
	      }
	      return result;
	    }
	
	    /**
	     * Creates a function that aggregates a collection, creating an accumulator
	     * object composed from the results of running each element in the collection
	     * through an iteratee.
	     *
	     * **Note:** This function is used to create `_.countBy`, `_.groupBy`, `_.indexBy`,
	     * and `_.partition`.
	     *
	     * @private
	     * @param {Function} setter The function to set keys and values of the accumulator object.
	     * @param {Function} [initializer] The function to initialize the accumulator object.
	     * @returns {Function} Returns the new aggregator function.
	     */
	    function createAggregator(setter, initializer) {
	      return function(collection, iteratee, thisArg) {
	        var result = initializer ? initializer() : {};
	        iteratee = getCallback(iteratee, thisArg, 3);
	
	        if (isArray(collection)) {
	          var index = -1,
	              length = collection.length;
	
	          while (++index < length) {
	            var value = collection[index];
	            setter(result, value, iteratee(value, index, collection), collection);
	          }
	        } else {
	          baseEach(collection, function(value, key, collection) {
	            setter(result, value, iteratee(value, key, collection), collection);
	          });
	        }
	        return result;
	      };
	    }
	
	    /**
	     * Creates a function that assigns properties of source object(s) to a given
	     * destination object.
	     *
	     * **Note:** This function is used to create `_.assign`, `_.defaults`, and `_.merge`.
	     *
	     * @private
	     * @param {Function} assigner The function to assign values.
	     * @returns {Function} Returns the new assigner function.
	     */
	    function createAssigner(assigner) {
	      return function() {
	        var args = arguments,
	            length = args.length,
	            object = args[0];
	
	        if (length < 2 || object == null) {
	          return object;
	        }
	        var customizer = args[length - 2],
	            thisArg = args[length - 1],
	            guard = args[3];
	
	        if (length > 3 && typeof customizer == 'function') {
	          customizer = bindCallback(customizer, thisArg, 5);
	          length -= 2;
	        } else {
	          customizer = (length > 2 && typeof thisArg == 'function') ? thisArg : null;
	          length -= (customizer ? 1 : 0);
	        }
	        if (guard && isIterateeCall(args[1], args[2], guard)) {
	          customizer = length == 3 ? null : customizer;
	          length = 2;
	        }
	        var index = 0;
	        while (++index < length) {
	          var source = args[index];
	          if (source) {
	            assigner(object, source, customizer);
	          }
	        }
	        return object;
	      };
	    }
	
	    /**
	     * Creates a `baseEach` or `baseEachRight` function.
	     *
	     * @private
	     * @param {Function} eachFunc The function to iterate over a collection.
	     * @param {boolean} [fromRight] Specify iterating from right to left.
	     * @returns {Function} Returns the new base function.
	     */
	    function createBaseEach(eachFunc, fromRight) {
	      return function(collection, iteratee) {
	        var length = collection ? collection.length : 0;
	        if (!isLength(length)) {
	          return eachFunc(collection, iteratee);
	        }
	        var index = fromRight ? length : -1,
	            iterable = toObject(collection);
	
	        while ((fromRight ? index-- : ++index < length)) {
	          if (iteratee(iterable[index], index, iterable) === false) {
	            break;
	          }
	        }
	        return collection;
	      };
	    }
	
	    /**
	     * Creates a base function for `_.forIn` or `_.forInRight`.
	     *
	     * @private
	     * @param {boolean} [fromRight] Specify iterating from right to left.
	     * @returns {Function} Returns the new base function.
	     */
	    function createBaseFor(fromRight) {
	      return function(object, iteratee, keysFunc) {
	        var iterable = toObject(object),
	            props = keysFunc(object),
	            length = props.length,
	            index = fromRight ? length : -1;
	
	        while ((fromRight ? index-- : ++index < length)) {
	          var key = props[index];
	          if (iteratee(iterable[key], key, iterable) === false) {
	            break;
	          }
	        }
	        return object;
	      };
	    }
	
	    /**
	     * Creates a function that wraps `func` and invokes it with the `this`
	     * binding of `thisArg`.
	     *
	     * @private
	     * @param {Function} func The function to bind.
	     * @param {*} [thisArg] The `this` binding of `func`.
	     * @returns {Function} Returns the new bound function.
	     */
	    function createBindWrapper(func, thisArg) {
	      var Ctor = createCtorWrapper(func);
	
	      function wrapper() {
	        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;
	        return fn.apply(thisArg, arguments);
	      }
	      return wrapper;
	    }
	
	    /**
	     * Creates a `Set` cache object to optimize linear searches of large arrays.
	     *
	     * @private
	     * @param {Array} [values] The values to cache.
	     * @returns {null|Object} Returns the new cache object if `Set` is supported, else `null`.
	     */
	    var createCache = !(nativeCreate && Set) ? constant(null) : function(values) {
	      return new SetCache(values);
	    };
	
	    /**
	     * Creates a function that produces compound words out of the words in a
	     * given string.
	     *
	     * @private
	     * @param {Function} callback The function to combine each word.
	     * @returns {Function} Returns the new compounder function.
	     */
	    function createCompounder(callback) {
	      return function(string) {
	        var index = -1,
	            array = words(deburr(string)),
	            length = array.length,
	            result = '';
	
	        while (++index < length) {
	          result = callback(result, array[index], index);
	        }
	        return result;
	      };
	    }
	
	    /**
	     * Creates a function that produces an instance of `Ctor` regardless of
	     * whether it was invoked as part of a `new` expression or by `call` or `apply`.
	     *
	     * @private
	     * @param {Function} Ctor The constructor to wrap.
	     * @returns {Function} Returns the new wrapped function.
	     */
	    function createCtorWrapper(Ctor) {
	      return function() {
	        var thisBinding = baseCreate(Ctor.prototype),
	            result = Ctor.apply(thisBinding, arguments);
	
	        // Mimic the constructor's `return` behavior.
	        // See https://es5.github.io/#x13.2.2 for more details.
	        return isObject(result) ? result : thisBinding;
	      };
	    }
	
	    /**
	     * Creates a `_.curry` or `_.curryRight` function.
	     *
	     * @private
	     * @param {boolean} flag The curry bit flag.
	     * @returns {Function} Returns the new curry function.
	     */
	    function createCurry(flag) {
	      function curryFunc(func, arity, guard) {
	        if (guard && isIterateeCall(func, arity, guard)) {
	          arity = null;
	        }
	        var result = createWrapper(func, flag, null, null, null, null, null, arity);
	        result.placeholder = curryFunc.placeholder;
	        return result;
	      }
	      return curryFunc;
	    }
	
	    /**
	     * Creates a `_.max` or `_.min` function.
	     *
	     * @private
	     * @param {Function} arrayFunc The function to get the extremum value from an array.
	     * @param {boolean} [isMin] Specify returning the minimum, instead of the maximum,
	     *  extremum value.
	     * @returns {Function} Returns the new extremum function.
	     */
	    function createExtremum(arrayFunc, isMin) {
	      return function(collection, iteratee, thisArg) {
	        if (thisArg && isIterateeCall(collection, iteratee, thisArg)) {
	          iteratee = null;
	        }
	        var func = getCallback(),
	            noIteratee = iteratee == null;
	
	        if (!(func === baseCallback && noIteratee)) {
	          noIteratee = false;
	          iteratee = func(iteratee, thisArg, 3);
	        }
	        if (noIteratee) {
	          var isArr = isArray(collection);
	          if (!isArr && isString(collection)) {
	            iteratee = charAtCallback;
	          } else {
	            return arrayFunc(isArr ? collection : toIterable(collection));
	          }
	        }
	        return extremumBy(collection, iteratee, isMin);
	      };
	    }
	
	    /**
	     * Creates a `_.find` or `_.findLast` function.
	     *
	     * @private
	     * @param {Function} eachFunc The function to iterate over a collection.
	     * @param {boolean} [fromRight] Specify iterating from right to left.
	     * @returns {Function} Returns the new find function.
	     */
	    function createFind(eachFunc, fromRight) {
	      return function(collection, predicate, thisArg) {
	        predicate = getCallback(predicate, thisArg, 3);
	        if (isArray(collection)) {
	          var index = baseFindIndex(collection, predicate, fromRight);
	          return index > -1 ? collection[index] : undefined;
	        }
	        return baseFind(collection, predicate, eachFunc);
	      }
	    }
	
	    /**
	     * Creates a `_.findIndex` or `_.findLastIndex` function.
	     *
	     * @private
	     * @param {boolean} [fromRight] Specify iterating from right to left.
	     * @returns {Function} Returns the new find function.
	     */
	    function createFindIndex(fromRight) {
	      return function(array, predicate, thisArg) {
	        if (!(array && array.length)) {
	          return -1;
	        }
	        predicate = getCallback(predicate, thisArg, 3);
	        return baseFindIndex(array, predicate, fromRight);
	      };
	    }
	
	    /**
	     * Creates a `_.findKey` or `_.findLastKey` function.
	     *
	     * @private
	     * @param {Function} objectFunc The function to iterate over an object.
	     * @returns {Function} Returns the new find function.
	     */
	    function createFindKey(objectFunc) {
	      return function(object, predicate, thisArg) {
	        predicate = getCallback(predicate, thisArg, 3);
	        return baseFind(object, predicate, objectFunc, true);
	      };
	    }
	
	    /**
	     * Creates a `_.flow` or `_.flowRight` function.
	     *
	     * @private
	     * @param {boolean} [fromRight] Specify iterating from right to left.
	     * @returns {Function} Returns the new flow function.
	     */
	    function createFlow(fromRight) {
	      return function() {
	        var length = arguments.length;
	        if (!length) {
	          return function() { return arguments[0]; };
	        }
	        var wrapper,
	            index = fromRight ? length : -1,
	            leftIndex = 0,
	            funcs = Array(length);
	
	        while ((fromRight ? index-- : ++index < length)) {
	          var func = funcs[leftIndex++] = arguments[index];
	          if (typeof func != 'function') {
	            throw new TypeError(FUNC_ERROR_TEXT);
	          }
	          var funcName = wrapper ? '' : getFuncName(func);
	          wrapper = funcName == 'wrapper' ? new LodashWrapper([]) : wrapper;
	        }
	        index = wrapper ? -1 : length;
	        while (++index < length) {
	          func = funcs[index];
	          funcName = getFuncName(func);
	
	          var data = funcName == 'wrapper' ? getData(func) : null;
	          if (data && isLaziable(data[0])) {
	            wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);
	          } else {
	            wrapper = (func.length == 1 && isLaziable(func)) ? wrapper[funcName]() : wrapper.thru(func);
	          }
	        }
	        return function() {
	          var args = arguments;
	          if (wrapper && args.length == 1 && isArray(args[0])) {
	            return wrapper.plant(args[0]).value();
	          }
	          var index = 0,
	              result = funcs[index].apply(this, args);
	
	          while (++index < length) {
	            result = funcs[index].call(this, result);
	          }
	          return result;
	        };
	      };
	    }
	
	    /**
	     * Creates a function for `_.forEach` or `_.forEachRight`.
	     *
	     * @private
	     * @param {Function} arrayFunc The function to iterate over an array.
	     * @param {Function} eachFunc The function to iterate over a collection.
	     * @returns {Function} Returns the new each function.
	     */
	    function createForEach(arrayFunc, eachFunc) {
	      return function(collection, iteratee, thisArg) {
	        return (typeof iteratee == 'function' && typeof thisArg == 'undefined' && isArray(collection))
	          ? arrayFunc(collection, iteratee)
	          : eachFunc(collection, bindCallback(iteratee, thisArg, 3));
	      };
	    }
	
	    /**
	     * Creates a function for `_.forIn` or `_.forInRight`.
	     *
	     * @private
	     * @param {Function} objectFunc The function to iterate over an object.
	     * @returns {Function} Returns the new each function.
	     */
	    function createForIn(objectFunc) {
	      return function(object, iteratee, thisArg) {
	        if (typeof iteratee != 'function' || typeof thisArg != 'undefined') {
	          iteratee = bindCallback(iteratee, thisArg, 3);
	        }
	        return objectFunc(object, iteratee, keysIn);
	      };
	    }
	
	    /**
	     * Creates a function for `_.forOwn` or `_.forOwnRight`.
	     *
	     * @private
	     * @param {Function} objectFunc The function to iterate over an object.
	     * @returns {Function} Returns the new each function.
	     */
	    function createForOwn(objectFunc) {
	      return function(object, iteratee, thisArg) {
	        if (typeof iteratee != 'function' || typeof thisArg != 'undefined') {
	          iteratee = bindCallback(iteratee, thisArg, 3);
	        }
	        return objectFunc(object, iteratee);
	      };
	    }
	
	    /**
	     * Creates a function for `_.padLeft` or `_.padRight`.
	     *
	     * @private
	     * @param {boolean} [fromRight] Specify padding from the right.
	     * @returns {Function} Returns the new pad function.
	     */
	    function createPadDir(fromRight) {
	      return function(string, length, chars) {
	        string = baseToString(string);
	        return string && ((fromRight ? string : '') + createPadding(string, length, chars) + (fromRight ? '' : string));
	      };
	    }
	
	    /**
	     * Creates a `_.partial` or `_.partialRight` function.
	     *
	     * @private
	     * @param {boolean} flag The partial bit flag.
	     * @returns {Function} Returns the new partial function.
	     */
	    function createPartial(flag) {
	      var partialFunc = restParam(function(func, partials) {
	        var holders = replaceHolders(partials, partialFunc.placeholder);
	        return createWrapper(func, flag, null, partials, holders);
	      });
	      return partialFunc;
	    }
	
	    /**
	     * Creates a function for `_.reduce` or `_.reduceRight`.
	     *
	     * @private
	     * @param {Function} arrayFunc The function to iterate over an array.
	     * @param {Function} eachFunc The function to iterate over a collection.
	     * @returns {Function} Returns the new each function.
	     */
	    function createReduce(arrayFunc, eachFunc) {
	      return function(collection, iteratee, accumulator, thisArg) {
	        var initFromArray = arguments.length < 3;
	        return (typeof iteratee == 'function' && typeof thisArg == 'undefined' && isArray(collection))
	          ? arrayFunc(collection, iteratee, accumulator, initFromArray)
	          : baseReduce(collection, getCallback(iteratee, thisArg, 4), accumulator, initFromArray, eachFunc);
	      };
	    }
	
	    /**
	     * Creates a function that wraps `func` and invokes it with optional `this`
	     * binding of, partial application, and currying.
	     *
	     * @private
	     * @param {Function|string} func The function or method name to reference.
	     * @param {number} bitmask The bitmask of flags. See `createWrapper` for more details.
	     * @param {*} [thisArg] The `this` binding of `func`.
	     * @param {Array} [partials] The arguments to prepend to those provided to the new function.
	     * @param {Array} [holders] The `partials` placeholder indexes.
	     * @param {Array} [partialsRight] The arguments to append to those provided to the new function.
	     * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.
	     * @param {Array} [argPos] The argument positions of the new function.
	     * @param {number} [ary] The arity cap of `func`.
	     * @param {number} [arity] The arity of `func`.
	     * @returns {Function} Returns the new wrapped function.
	     */
	    function createHybridWrapper(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {
	      var isAry = bitmask & ARY_FLAG,
	          isBind = bitmask & BIND_FLAG,
	          isBindKey = bitmask & BIND_KEY_FLAG,
	          isCurry = bitmask & CURRY_FLAG,
	          isCurryBound = bitmask & CURRY_BOUND_FLAG,
	          isCurryRight = bitmask & CURRY_RIGHT_FLAG;
	
	      var Ctor = !isBindKey && createCtorWrapper(func),
	          key = func;
	
	      function wrapper() {
	        // Avoid `arguments` object use disqualifying optimizations by
	        // converting it to an array before providing it to other functions.
	        var length = arguments.length,
	            index = length,
	            args = Array(length);
	
	        while (index--) {
	          args[index] = arguments[index];
	        }
	        if (partials) {
	          args = composeArgs(args, partials, holders);
	        }
	        if (partialsRight) {
	          args = composeArgsRight(args, partialsRight, holdersRight);
	        }
	        if (isCurry || isCurryRight) {
	          var placeholder = wrapper.placeholder,
	              argsHolders = replaceHolders(args, placeholder);
	
	          length -= argsHolders.length;
	          if (length < arity) {
	            var newArgPos = argPos ? arrayCopy(argPos) : null,
	                newArity = nativeMax(arity - length, 0),
	                newsHolders = isCurry ? argsHolders : null,
	                newHoldersRight = isCurry ? null : argsHolders,
	                newPartials = isCurry ? args : null,
	                newPartialsRight = isCurry ? null : args;
	
	            bitmask |= (isCurry ? PARTIAL_FLAG : PARTIAL_RIGHT_FLAG);
	            bitmask &= ~(isCurry ? PARTIAL_RIGHT_FLAG : PARTIAL_FLAG);
	
	            if (!isCurryBound) {
	              bitmask &= ~(BIND_FLAG | BIND_KEY_FLAG);
	            }
	            var newData = [func, bitmask, thisArg, newPartials, newsHolders, newPartialsRight, newHoldersRight, newArgPos, ary, newArity],
	                result = createHybridWrapper.apply(undefined, newData);
	
	            if (isLaziable(func)) {
	              setData(result, newData);
	            }
	            result.placeholder = placeholder;
	            return result;
	          }
	        }
	        var thisBinding = isBind ? thisArg : this;
	        if (isBindKey) {
	          func = thisBinding[key];
	        }
	        if (argPos) {
	          args = reorder(args, argPos);
	        }
	        if (isAry && ary < args.length) {
	          args.length = ary;
	        }
	        var fn = (this && this !== root && this instanceof wrapper) ? (Ctor || createCtorWrapper(func)) : func;
	        return fn.apply(thisBinding, args);
	      }
	      return wrapper;
	    }
	
	    /**
	     * Creates the padding required for `string` based on the given `length`.
	     * The `chars` string is truncated if the number of characters exceeds `length`.
	     *
	     * @private
	     * @param {string} string The string to create padding for.
	     * @param {number} [length=0] The padding length.
	     * @param {string} [chars=' '] The string used as padding.
	     * @returns {string} Returns the pad for `string`.
	     */
	    function createPadding(string, length, chars) {
	      var strLength = string.length;
	      length = +length;
	
	      if (strLength >= length || !nativeIsFinite(length)) {
	        return '';
	      }
	      var padLength = length - strLength;
	      chars = chars == null ? ' ' : (chars + '');
	      return repeat(chars, ceil(padLength / chars.length)).slice(0, padLength);
	    }
	
	    /**
	     * Creates a function that wraps `func` and invokes it with the optional `this`
	     * binding of `thisArg` and the `partials` prepended to those provided to
	     * the wrapper.
	     *
	     * @private
	     * @param {Function} func The function to partially apply arguments to.
	     * @param {number} bitmask The bitmask of flags. See `createWrapper` for more details.
	     * @param {*} thisArg The `this` binding of `func`.
	     * @param {Array} partials The arguments to prepend to those provided to the new function.
	     * @returns {Function} Returns the new bound function.
	     */
	    function createPartialWrapper(func, bitmask, thisArg, partials) {
	      var isBind = bitmask & BIND_FLAG,
	          Ctor = createCtorWrapper(func);
	
	      function wrapper() {
	        // Avoid `arguments` object use disqualifying optimizations by
	        // converting it to an array before providing it `func`.
	        var argsIndex = -1,
	            argsLength = arguments.length,
	            leftIndex = -1,
	            leftLength = partials.length,
	            args = Array(argsLength + leftLength);
	
	        while (++leftIndex < leftLength) {
	          args[leftIndex] = partials[leftIndex];
	        }
	        while (argsLength--) {
	          args[leftIndex++] = arguments[++argsIndex];
	        }
	        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;
	        return fn.apply(isBind ? thisArg : this, args);
	      }
	      return wrapper;
	    }
	
	    /**
	     * Creates a `_.sortedIndex` or `_.sortedLastIndex` function.
	     *
	     * @private
	     * @param {boolean} [retHighest] Specify returning the highest qualified index.
	     * @returns {Function} Returns the new index function.
	     */
	    function createSortedIndex(retHighest) {
	      return function(array, value, iteratee, thisArg) {
	        var func = getCallback(iteratee);
	        return (func === baseCallback && iteratee == null)
	          ? binaryIndex(array, value, retHighest)
	          : binaryIndexBy(array, value, func(iteratee, thisArg, 1), retHighest);
	      };
	    }
	
	    /**
	     * Creates a function that either curries or invokes `func` with optional
	     * `this` binding and partially applied arguments.
	     *
	     * @private
	     * @param {Function|string} func The function or method name to reference.
	     * @param {number} bitmask The bitmask of flags.
	     *  The bitmask may be composed of the following flags:
	     *     1 - `_.bind`
	     *     2 - `_.bindKey`
	     *     4 - `_.curry` or `_.curryRight` of a bound function
	     *     8 - `_.curry`
	     *    16 - `_.curryRight`
	     *    32 - `_.partial`
	     *    64 - `_.partialRight`
	     *   128 - `_.rearg`
	     *   256 - `_.ary`
	     * @param {*} [thisArg] The `this` binding of `func`.
	     * @param {Array} [partials] The arguments to be partially applied.
	     * @param {Array} [holders] The `partials` placeholder indexes.
	     * @param {Array} [argPos] The argument positions of the new function.
	     * @param {number} [ary] The arity cap of `func`.
	     * @param {number} [arity] The arity of `func`.
	     * @returns {Function} Returns the new wrapped function.
	     */
	    function createWrapper(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {
	      var isBindKey = bitmask & BIND_KEY_FLAG;
	      if (!isBindKey && typeof func != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      var length = partials ? partials.length : 0;
	      if (!length) {
	        bitmask &= ~(PARTIAL_FLAG | PARTIAL_RIGHT_FLAG);
	        partials = holders = null;
	      }
	      length -= (holders ? holders.length : 0);
	      if (bitmask & PARTIAL_RIGHT_FLAG) {
	        var partialsRight = partials,
	            holdersRight = holders;
	
	        partials = holders = null;
	      }
	      var data = isBindKey ? null : getData(func),
	          newData = [func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity];
	
	      if (data) {
	        mergeData(newData, data);
	        bitmask = newData[1];
	        arity = newData[9];
	      }
	      newData[9] = arity == null
	        ? (isBindKey ? 0 : func.length)
	        : (nativeMax(arity - length, 0) || 0);
	
	      if (bitmask == BIND_FLAG) {
	        var result = createBindWrapper(newData[0], newData[2]);
	      } else if ((bitmask == PARTIAL_FLAG || bitmask == (BIND_FLAG | PARTIAL_FLAG)) && !newData[4].length) {
	        result = createPartialWrapper.apply(undefined, newData);
	      } else {
	        result = createHybridWrapper.apply(undefined, newData);
	      }
	      var setter = data ? baseSetData : setData;
	      return setter(result, newData);
	    }
	
	    /**
	     * A specialized version of `baseIsEqualDeep` for arrays with support for
	     * partial deep comparisons.
	     *
	     * @private
	     * @param {Array} array The array to compare.
	     * @param {Array} other The other array to compare.
	     * @param {Function} equalFunc The function to determine equivalents of values.
	     * @param {Function} [customizer] The function to customize comparing arrays.
	     * @param {boolean} [isLoose] Specify performing partial comparisons.
	     * @param {Array} [stackA] Tracks traversed `value` objects.
	     * @param {Array} [stackB] Tracks traversed `other` objects.
	     * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.
	     */
	    function equalArrays(array, other, equalFunc, customizer, isLoose, stackA, stackB) {
	      var index = -1,
	          arrLength = array.length,
	          othLength = other.length,
	          result = true;
	
	      if (arrLength != othLength && !(isLoose && othLength > arrLength)) {
	        return false;
	      }
	      // Deep compare the contents, ignoring non-numeric properties.
	      while (result && ++index < arrLength) {
	        var arrValue = array[index],
	            othValue = other[index];
	
	        result = undefined;
	        if (customizer) {
	          result = isLoose
	            ? customizer(othValue, arrValue, index)
	            : customizer(arrValue, othValue, index);
	        }
	        if (typeof result == 'undefined') {
	          // Recursively compare arrays (susceptible to call stack limits).
	          if (isLoose) {
	            var othIndex = othLength;
	            while (othIndex--) {
	              othValue = other[othIndex];
	              result = (arrValue && arrValue === othValue) || equalFunc(arrValue, othValue, customizer, isLoose, stackA, stackB);
	              if (result) {
	                break;
	              }
	            }
	          } else {
	            result = (arrValue && arrValue === othValue) || equalFunc(arrValue, othValue, customizer, isLoose, stackA, stackB);
	          }
	        }
	      }
	      return !!result;
	    }
	
	    /**
	     * A specialized version of `baseIsEqualDeep` for comparing objects of
	     * the same `toStringTag`.
	     *
	     * **Note:** This function only supports comparing values with tags of
	     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.
	     *
	     * @private
	     * @param {Object} value The object to compare.
	     * @param {Object} other The other object to compare.
	     * @param {string} tag The `toStringTag` of the objects to compare.
	     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
	     */
	    function equalByTag(object, other, tag) {
	      switch (tag) {
	        case boolTag:
	        case dateTag:
	          // Coerce dates and booleans to numbers, dates to milliseconds and booleans
	          // to `1` or `0` treating invalid dates coerced to `NaN` as not equal.
	          return +object == +other;
	
	        case errorTag:
	          return object.name == other.name && object.message == other.message;
	
	        case numberTag:
	          // Treat `NaN` vs. `NaN` as equal.
	          return (object != +object)
	            ? other != +other
	            // But, treat `-0` vs. `+0` as not equal.
	            : (object == 0 ? ((1 / object) == (1 / other)) : object == +other);
	
	        case regexpTag:
	        case stringTag:
	          // Coerce regexes to strings and treat strings primitives and string
	          // objects as equal. See https://es5.github.io/#x15.10.6.4 for more details.
	          return object == (other + '');
	      }
	      return false;
	    }
	
	    /**
	     * A specialized version of `baseIsEqualDeep` for objects with support for
	     * partial deep comparisons.
	     *
	     * @private
	     * @param {Object} object The object to compare.
	     * @param {Object} other The other object to compare.
	     * @param {Function} equalFunc The function to determine equivalents of values.
	     * @param {Function} [customizer] The function to customize comparing values.
	     * @param {boolean} [isLoose] Specify performing partial comparisons.
	     * @param {Array} [stackA] Tracks traversed `value` objects.
	     * @param {Array} [stackB] Tracks traversed `other` objects.
	     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
	     */
	    function equalObjects(object, other, equalFunc, customizer, isLoose, stackA, stackB) {
	      var objProps = keys(object),
	          objLength = objProps.length,
	          othProps = keys(other),
	          othLength = othProps.length;
	
	      if (objLength != othLength && !isLoose) {
	        return false;
	      }
	      var skipCtor = isLoose,
	          index = -1;
	
	      while (++index < objLength) {
	        var key = objProps[index],
	            result = isLoose ? key in other : hasOwnProperty.call(other, key);
	
	        if (result) {
	          var objValue = object[key],
	              othValue = other[key];
	
	          result = undefined;
	          if (customizer) {
	            result = isLoose
	              ? customizer(othValue, objValue, key)
	              : customizer(objValue, othValue, key);
	          }
	          if (typeof result == 'undefined') {
	            // Recursively compare objects (susceptible to call stack limits).
	            result = (objValue && objValue === othValue) || equalFunc(objValue, othValue, customizer, isLoose, stackA, stackB);
	          }
	        }
	        if (!result) {
	          return false;
	        }
	        skipCtor || (skipCtor = key == 'constructor');
	      }
	      if (!skipCtor) {
	        var objCtor = object.constructor,
	            othCtor = other.constructor;
	
	        // Non `Object` object instances with different constructors are not equal.
	        if (objCtor != othCtor &&
	            ('constructor' in object && 'constructor' in other) &&
	            !(typeof objCtor == 'function' && objCtor instanceof objCtor &&
	              typeof othCtor == 'function' && othCtor instanceof othCtor)) {
	          return false;
	        }
	      }
	      return true;
	    }
	
	    /**
	     * Gets the extremum value of `collection` invoking `iteratee` for each value
	     * in `collection` to generate the criterion by which the value is ranked.
	     * The `iteratee` is invoked with three arguments: (value, index, collection).
	     *
	     * @private
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} iteratee The function invoked per iteration.
	     * @param {boolean} [isMin] Specify returning the minimum, instead of the
	     *  maximum, extremum value.
	     * @returns {*} Returns the extremum value.
	     */
	    function extremumBy(collection, iteratee, isMin) {
	      var exValue = isMin ? POSITIVE_INFINITY : NEGATIVE_INFINITY,
	          computed = exValue,
	          result = computed;
	
	      baseEach(collection, function(value, index, collection) {
	        var current = iteratee(value, index, collection);
	        if ((isMin ? (current < computed) : (current > computed)) ||
	            (current === exValue && current === result)) {
	          computed = current;
	          result = value;
	        }
	      });
	      return result;
	    }
	
	    /**
	     * Gets the appropriate "callback" function. If the `_.callback` method is
	     * customized this function returns the custom method, otherwise it returns
	     * the `baseCallback` function. If arguments are provided the chosen function
	     * is invoked with them and its result is returned.
	     *
	     * @private
	     * @returns {Function} Returns the chosen function or its result.
	     */
	    function getCallback(func, thisArg, argCount) {
	      var result = lodash.callback || callback;
	      result = result === callback ? baseCallback : result;
	      return argCount ? result(func, thisArg, argCount) : result;
	    }
	
	    /**
	     * Gets metadata for `func`.
	     *
	     * @private
	     * @param {Function} func The function to query.
	     * @returns {*} Returns the metadata for `func`.
	     */
	    var getData = !metaMap ? noop : function(func) {
	      return metaMap.get(func);
	    };
	
	    /**
	     * Gets the name of `func`.
	     *
	     * @private
	     * @param {Function} func The function to query.
	     * @returns {string} Returns the function name.
	     */
	    var getFuncName = (function() {
	      if (!support.funcNames) {
	        return constant('');
	      }
	      if (constant.name == 'constant') {
	        return baseProperty('name');
	      }
	      return function(func) {
	        var result = func.name,
	            array = realNames[result],
	            length = array ? array.length : 0;
	
	        while (length--) {
	          var data = array[length],
	              otherFunc = data.func;
	
	          if (otherFunc == null || otherFunc == func) {
	            return data.name;
	          }
	        }
	        return result;
	      };
	    }());
	
	    /**
	     * Gets the appropriate "indexOf" function. If the `_.indexOf` method is
	     * customized this function returns the custom method, otherwise it returns
	     * the `baseIndexOf` function. If arguments are provided the chosen function
	     * is invoked with them and its result is returned.
	     *
	     * @private
	     * @returns {Function|number} Returns the chosen function or its result.
	     */
	    function getIndexOf(collection, target, fromIndex) {
	      var result = lodash.indexOf || indexOf;
	      result = result === indexOf ? baseIndexOf : result;
	      return collection ? result(collection, target, fromIndex) : result;
	    }
	
	    /**
	     * Gets the view, applying any `transforms` to the `start` and `end` positions.
	     *
	     * @private
	     * @param {number} start The start of the view.
	     * @param {number} end The end of the view.
	     * @param {Array} [transforms] The transformations to apply to the view.
	     * @returns {Object} Returns an object containing the `start` and `end`
	     *  positions of the view.
	     */
	    function getView(start, end, transforms) {
	      var index = -1,
	          length = transforms ? transforms.length : 0;
	
	      while (++index < length) {
	        var data = transforms[index],
	            size = data.size;
	
	        switch (data.type) {
	          case 'drop':      start += size; break;
	          case 'dropRight': end -= size; break;
	          case 'take':      end = nativeMin(end, start + size); break;
	          case 'takeRight': start = nativeMax(start, end - size); break;
	        }
	      }
	      return { 'start': start, 'end': end };
	    }
	
	    /**
	     * Initializes an array clone.
	     *
	     * @private
	     * @param {Array} array The array to clone.
	     * @returns {Array} Returns the initialized clone.
	     */
	    function initCloneArray(array) {
	      var length = array.length,
	          result = new array.constructor(length);
	
	      // Add array properties assigned by `RegExp#exec`.
	      if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {
	        result.index = array.index;
	        result.input = array.input;
	      }
	      return result;
	    }
	
	    /**
	     * Initializes an object clone.
	     *
	     * @private
	     * @param {Object} object The object to clone.
	     * @returns {Object} Returns the initialized clone.
	     */
	    function initCloneObject(object) {
	      var Ctor = object.constructor;
	      if (!(typeof Ctor == 'function' && Ctor instanceof Ctor)) {
	        Ctor = Object;
	      }
	      return new Ctor;
	    }
	
	    /**
	     * Initializes an object clone based on its `toStringTag`.
	     *
	     * **Note:** This function only supports cloning values with tags of
	     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.
	     *
	     *
	     * @private
	     * @param {Object} object The object to clone.
	     * @param {string} tag The `toStringTag` of the object to clone.
	     * @param {boolean} [isDeep] Specify a deep clone.
	     * @returns {Object} Returns the initialized clone.
	     */
	    function initCloneByTag(object, tag, isDeep) {
	      var Ctor = object.constructor;
	      switch (tag) {
	        case arrayBufferTag:
	          return bufferClone(object);
	
	        case boolTag:
	        case dateTag:
	          return new Ctor(+object);
	
	        case float32Tag: case float64Tag:
	        case int8Tag: case int16Tag: case int32Tag:
	        case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:
	          var buffer = object.buffer;
	          return new Ctor(isDeep ? bufferClone(buffer) : buffer, object.byteOffset, object.length);
	
	        case numberTag:
	        case stringTag:
	          return new Ctor(object);
	
	        case regexpTag:
	          var result = new Ctor(object.source, reFlags.exec(object));
	          result.lastIndex = object.lastIndex;
	      }
	      return result;
	    }
	
	    /**
	     * Checks if `value` is a valid array-like index.
	     *
	     * @private
	     * @param {*} value The value to check.
	     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
	     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
	     */
	    function isIndex(value, length) {
	      value = +value;
	      length = length == null ? MAX_SAFE_INTEGER : length;
	      return value > -1 && value % 1 == 0 && value < length;
	    }
	
	    /**
	     * Checks if the provided arguments are from an iteratee call.
	     *
	     * @private
	     * @param {*} value The potential iteratee value argument.
	     * @param {*} index The potential iteratee index or key argument.
	     * @param {*} object The potential iteratee object argument.
	     * @returns {boolean} Returns `true` if the arguments are from an iteratee call, else `false`.
	     */
	    function isIterateeCall(value, index, object) {
	      if (!isObject(object)) {
	        return false;
	      }
	      var type = typeof index;
	      if (type == 'number') {
	        var length = object.length,
	            prereq = isLength(length) && isIndex(index, length);
	      } else {
	        prereq = type == 'string' && index in object;
	      }
	      if (prereq) {
	        var other = object[index];
	        return value === value ? (value === other) : (other !== other);
	      }
	      return false;
	    }
	
	    /**
	     * Checks if `func` has a lazy counterpart.
	     *
	     * @private
	     * @param {Function} func The function to check.
	     * @returns {boolean} Returns `true` if `func` has a lazy counterpart, else `false`.
	     */
	    function isLaziable(func) {
	      var funcName = getFuncName(func);
	      return !!funcName && func === lodash[funcName] && funcName in LazyWrapper.prototype;
	    }
	
	    /**
	     * Checks if `value` is a valid array-like length.
	     *
	     * **Note:** This function is based on [`ToLength`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength).
	     *
	     * @private
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
	     */
	    function isLength(value) {
	      return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
	    }
	
	    /**
	     * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.
	     *
	     * @private
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` if suitable for strict
	     *  equality comparisons, else `false`.
	     */
	    function isStrictComparable(value) {
	      return value === value && (value === 0 ? ((1 / value) > 0) : !isObject(value));
	    }
	
	    /**
	     * Merges the function metadata of `source` into `data`.
	     *
	     * Merging metadata reduces the number of wrappers required to invoke a function.
	     * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`
	     * may be applied regardless of execution order. Methods like `_.ary` and `_.rearg`
	     * augment function arguments, making the order in which they are executed important,
	     * preventing the merging of metadata. However, we make an exception for a safe
	     * common case where curried functions have `_.ary` and or `_.rearg` applied.
	     *
	     * @private
	     * @param {Array} data The destination metadata.
	     * @param {Array} source The source metadata.
	     * @returns {Array} Returns `data`.
	     */
	    function mergeData(data, source) {
	      var bitmask = data[1],
	          srcBitmask = source[1],
	          newBitmask = bitmask | srcBitmask,
	          isCommon = newBitmask < ARY_FLAG;
	
	      var isCombo =
	        (srcBitmask == ARY_FLAG && bitmask == CURRY_FLAG) ||
	        (srcBitmask == ARY_FLAG && bitmask == REARG_FLAG && data[7].length <= source[8]) ||
	        (srcBitmask == (ARY_FLAG | REARG_FLAG) && bitmask == CURRY_FLAG);
	
	      // Exit early if metadata can't be merged.
	      if (!(isCommon || isCombo)) {
	        return data;
	      }
	      // Use source `thisArg` if available.
	      if (srcBitmask & BIND_FLAG) {
	        data[2] = source[2];
	        // Set when currying a bound function.
	        newBitmask |= (bitmask & BIND_FLAG) ? 0 : CURRY_BOUND_FLAG;
	      }
	      // Compose partial arguments.
	      var value = source[3];
	      if (value) {
	        var partials = data[3];
	        data[3] = partials ? composeArgs(partials, value, source[4]) : arrayCopy(value);
	        data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : arrayCopy(source[4]);
	      }
	      // Compose partial right arguments.
	      value = source[5];
	      if (value) {
	        partials = data[5];
	        data[5] = partials ? composeArgsRight(partials, value, source[6]) : arrayCopy(value);
	        data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : arrayCopy(source[6]);
	      }
	      // Use source `argPos` if available.
	      value = source[7];
	      if (value) {
	        data[7] = arrayCopy(value);
	      }
	      // Use source `ary` if it's smaller.
	      if (srcBitmask & ARY_FLAG) {
	        data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);
	      }
	      // Use source `arity` if one is not provided.
	      if (data[9] == null) {
	        data[9] = source[9];
	      }
	      // Use source `func` and merge bitmasks.
	      data[0] = source[0];
	      data[1] = newBitmask;
	
	      return data;
	    }
	
	    /**
	     * A specialized version of `_.pick` that picks `object` properties specified
	     * by the `props` array.
	     *
	     * @private
	     * @param {Object} object The source object.
	     * @param {string[]} props The property names to pick.
	     * @returns {Object} Returns the new object.
	     */
	    function pickByArray(object, props) {
	      object = toObject(object);
	
	      var index = -1,
	          length = props.length,
	          result = {};
	
	      while (++index < length) {
	        var key = props[index];
	        if (key in object) {
	          result[key] = object[key];
	        }
	      }
	      return result;
	    }
	
	    /**
	     * A specialized version of `_.pick` that picks `object` properties `predicate`
	     * returns truthy for.
	     *
	     * @private
	     * @param {Object} object The source object.
	     * @param {Function} predicate The function invoked per iteration.
	     * @returns {Object} Returns the new object.
	     */
	    function pickByCallback(object, predicate) {
	      var result = {};
	      baseForIn(object, function(value, key, object) {
	        if (predicate(value, key, object)) {
	          result[key] = value;
	        }
	      });
	      return result;
	    }
	
	    /**
	     * Reorder `array` according to the specified indexes where the element at
	     * the first index is assigned as the first element, the element at
	     * the second index is assigned as the second element, and so on.
	     *
	     * @private
	     * @param {Array} array The array to reorder.
	     * @param {Array} indexes The arranged array indexes.
	     * @returns {Array} Returns `array`.
	     */
	    function reorder(array, indexes) {
	      var arrLength = array.length,
	          length = nativeMin(indexes.length, arrLength),
	          oldArray = arrayCopy(array);
	
	      while (length--) {
	        var index = indexes[length];
	        array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;
	      }
	      return array;
	    }
	
	    /**
	     * Sets metadata for `func`.
	     *
	     * **Note:** If this function becomes hot, i.e. is invoked a lot in a short
	     * period of time, it will trip its breaker and transition to an identity function
	     * to avoid garbage collection pauses in V8. See [V8 issue 2070](https://code.google.com/p/v8/issues/detail?id=2070)
	     * for more details.
	     *
	     * @private
	     * @param {Function} func The function to associate metadata with.
	     * @param {*} data The metadata.
	     * @returns {Function} Returns `func`.
	     */
	    var setData = (function() {
	      var count = 0,
	          lastCalled = 0;
	
	      return function(key, value) {
	        var stamp = now(),
	            remaining = HOT_SPAN - (stamp - lastCalled);
	
	        lastCalled = stamp;
	        if (remaining > 0) {
	          if (++count >= HOT_COUNT) {
	            return key;
	          }
	        } else {
	          count = 0;
	        }
	        return baseSetData(key, value);
	      };
	    }());
	
	    /**
	     * A fallback implementation of `_.isPlainObject` which checks if `value`
	     * is an object created by the `Object` constructor or has a `[[Prototype]]`
	     * of `null`.
	     *
	     * @private
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
	     */
	    function shimIsPlainObject(value) {
	      var Ctor,
	          support = lodash.support;
	
	      // Exit early for non `Object` objects.
	      if (!(isObjectLike(value) && objToString.call(value) == objectTag) ||
	          (!hasOwnProperty.call(value, 'constructor') &&
	            (Ctor = value.constructor, typeof Ctor == 'function' && !(Ctor instanceof Ctor)))) {
	        return false;
	      }
	      // IE < 9 iterates inherited properties before own properties. If the first
	      // iterated property is an object's own property then there are no inherited
	      // enumerable properties.
	      var result;
	      // In most environments an object's own properties are iterated before
	      // its inherited properties. If the last iterated property is an object's
	      // own property then there are no inherited enumerable properties.
	      baseForIn(value, function(subValue, key) {
	        result = key;
	      });
	      return typeof result == 'undefined' || hasOwnProperty.call(value, result);
	    }
	
	    /**
	     * A fallback implementation of `Object.keys` which creates an array of the
	     * own enumerable property names of `object`.
	     *
	     * @private
	     * @param {Object} object The object to inspect.
	     * @returns {Array} Returns the array of property names.
	     */
	    function shimKeys(object) {
	      var props = keysIn(object),
	          propsLength = props.length,
	          length = propsLength && object.length,
	          support = lodash.support;
	
	      var allowIndexes = length && isLength(length) &&
	        (isArray(object) || (support.nonEnumArgs && isArguments(object)));
	
	      var index = -1,
	          result = [];
	
	      while (++index < propsLength) {
	        var key = props[index];
	        if ((allowIndexes && isIndex(key, length)) || hasOwnProperty.call(object, key)) {
	          result.push(key);
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Converts `value` to an array-like object if it is not one.
	     *
	     * @private
	     * @param {*} value The value to process.
	     * @returns {Array|Object} Returns the array-like object.
	     */
	    function toIterable(value) {
	      if (value == null) {
	        return [];
	      }
	      if (!isLength(value.length)) {
	        return values(value);
	      }
	      return isObject(value) ? value : Object(value);
	    }
	
	    /**
	     * Converts `value` to an object if it is not one.
	     *
	     * @private
	     * @param {*} value The value to process.
	     * @returns {Object} Returns the object.
	     */
	    function toObject(value) {
	      return isObject(value) ? value : Object(value);
	    }
	
	    /**
	     * Creates a clone of `wrapper`.
	     *
	     * @private
	     * @param {Object} wrapper The wrapper to clone.
	     * @returns {Object} Returns the cloned wrapper.
	     */
	    function wrapperClone(wrapper) {
	      return wrapper instanceof LazyWrapper
	        ? wrapper.clone()
	        : new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__, arrayCopy(wrapper.__actions__));
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates an array of elements split into groups the length of `size`.
	     * If `collection` can't be split evenly, the final chunk will be the remaining
	     * elements.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to process.
	     * @param {number} [size=1] The length of each chunk.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the new array containing chunks.
	     * @example
	     *
	     * _.chunk(['a', 'b', 'c', 'd'], 2);
	     * // => [['a', 'b'], ['c', 'd']]
	     *
	     * _.chunk(['a', 'b', 'c', 'd'], 3);
	     * // => [['a', 'b', 'c'], ['d']]
	     */
	    function chunk(array, size, guard) {
	      if (guard ? isIterateeCall(array, size, guard) : size == null) {
	        size = 1;
	      } else {
	        size = nativeMax(+size || 1, 1);
	      }
	      var index = 0,
	          length = array ? array.length : 0,
	          resIndex = -1,
	          result = Array(ceil(length / size));
	
	      while (index < length) {
	        result[++resIndex] = baseSlice(array, index, (index += size));
	      }
	      return result;
	    }
	
	    /**
	     * Creates an array with all falsey values removed. The values `false`, `null`,
	     * `0`, `""`, `undefined`, and `NaN` are falsey.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to compact.
	     * @returns {Array} Returns the new array of filtered values.
	     * @example
	     *
	     * _.compact([0, 1, false, 2, '', 3]);
	     * // => [1, 2, 3]
	     */
	    function compact(array) {
	      var index = -1,
	          length = array ? array.length : 0,
	          resIndex = -1,
	          result = [];
	
	      while (++index < length) {
	        var value = array[index];
	        if (value) {
	          result[++resIndex] = value;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Creates an array excluding all values of the provided arrays using
	     * `SameValueZero` for equality comparisons.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to inspect.
	     * @param {...Array} [values] The arrays of values to exclude.
	     * @returns {Array} Returns the new array of filtered values.
	     * @example
	     *
	     * _.difference([1, 2, 3], [4, 2]);
	     * // => [1, 3]
	     */
	    var difference = restParam(function(array, values) {
	      return (isArray(array) || isArguments(array))
	        ? baseDifference(array, baseFlatten(values, false, true))
	        : [];
	    });
	
	    /**
	     * Creates a slice of `array` with `n` elements dropped from the beginning.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {number} [n=1] The number of elements to drop.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.drop([1, 2, 3]);
	     * // => [2, 3]
	     *
	     * _.drop([1, 2, 3], 2);
	     * // => [3]
	     *
	     * _.drop([1, 2, 3], 5);
	     * // => []
	     *
	     * _.drop([1, 2, 3], 0);
	     * // => [1, 2, 3]
	     */
	    function drop(array, n, guard) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (guard ? isIterateeCall(array, n, guard) : n == null) {
	        n = 1;
	      }
	      return baseSlice(array, n < 0 ? 0 : n);
	    }
	
	    /**
	     * Creates a slice of `array` with `n` elements dropped from the end.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {number} [n=1] The number of elements to drop.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.dropRight([1, 2, 3]);
	     * // => [1, 2]
	     *
	     * _.dropRight([1, 2, 3], 2);
	     * // => [1]
	     *
	     * _.dropRight([1, 2, 3], 5);
	     * // => []
	     *
	     * _.dropRight([1, 2, 3], 0);
	     * // => [1, 2, 3]
	     */
	    function dropRight(array, n, guard) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (guard ? isIterateeCall(array, n, guard) : n == null) {
	        n = 1;
	      }
	      n = length - (+n || 0);
	      return baseSlice(array, 0, n < 0 ? 0 : n);
	    }
	
	    /**
	     * Creates a slice of `array` excluding elements dropped from the end.
	     * Elements are dropped until `predicate` returns falsey. The predicate is
	     * bound to `thisArg` and invoked with three arguments: (value, index, array).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that match the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.dropRightWhile([1, 2, 3], function(n) {
	     *   return n > 1;
	     * });
	     * // => [1]
	     *
	     * var users = [
	     *   { 'user': 'barney',  'active': true },
	     *   { 'user': 'fred',    'active': false },
	     *   { 'user': 'pebbles', 'active': false }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.pluck(_.dropRightWhile(users, { 'user': 'pebbles', 'active': false }), 'user');
	     * // => ['barney', 'fred']
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.pluck(_.dropRightWhile(users, 'active', false), 'user');
	     * // => ['barney']
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.dropRightWhile(users, 'active'), 'user');
	     * // => ['barney', 'fred', 'pebbles']
	     */
	    function dropRightWhile(array, predicate, thisArg) {
	      return (array && array.length)
	        ? baseWhile(array, getCallback(predicate, thisArg, 3), true, true)
	        : [];
	    }
	
	    /**
	     * Creates a slice of `array` excluding elements dropped from the beginning.
	     * Elements are dropped until `predicate` returns falsey. The predicate is
	     * bound to `thisArg` and invoked with three arguments: (value, index, array).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.dropWhile([1, 2, 3], function(n) {
	     *   return n < 3;
	     * });
	     * // => [3]
	     *
	     * var users = [
	     *   { 'user': 'barney',  'active': false },
	     *   { 'user': 'fred',    'active': false },
	     *   { 'user': 'pebbles', 'active': true }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.pluck(_.dropWhile(users, { 'user': 'barney', 'active': false }), 'user');
	     * // => ['fred', 'pebbles']
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.pluck(_.dropWhile(users, 'active', false), 'user');
	     * // => ['pebbles']
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.dropWhile(users, 'active'), 'user');
	     * // => ['barney', 'fred', 'pebbles']
	     */
	    function dropWhile(array, predicate, thisArg) {
	      return (array && array.length)
	        ? baseWhile(array, getCallback(predicate, thisArg, 3), true)
	        : [];
	    }
	
	    /**
	     * Fills elements of `array` with `value` from `start` up to, but not
	     * including, `end`.
	     *
	     * **Note:** This method mutates `array`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to fill.
	     * @param {*} value The value to fill `array` with.
	     * @param {number} [start=0] The start position.
	     * @param {number} [end=array.length] The end position.
	     * @returns {Array} Returns `array`.
	     * @example
	     *
	     * var array = [1, 2, 3];
	     *
	     * _.fill(array, 'a');
	     * console.log(array);
	     * // => ['a', 'a', 'a']
	     *
	     * _.fill(Array(3), 2);
	     * // => [2, 2, 2]
	     *
	     * _.fill([4, 6, 8], '*', 1, 2);
	     * // => [4, '*', 8]
	     */
	    function fill(array, value, start, end) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {
	        start = 0;
	        end = length;
	      }
	      return baseFill(array, value, start, end);
	    }
	
	    /**
	     * This method is like `_.find` except that it returns the index of the first
	     * element `predicate` returns truthy for instead of the element itself.
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to search.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {number} Returns the index of the found element, else `-1`.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney',  'active': false },
	     *   { 'user': 'fred',    'active': false },
	     *   { 'user': 'pebbles', 'active': true }
	     * ];
	     *
	     * _.findIndex(users, function(chr) {
	     *   return chr.user == 'barney';
	     * });
	     * // => 0
	     *
	     * // using the `_.matches` callback shorthand
	     * _.findIndex(users, { 'user': 'fred', 'active': false });
	     * // => 1
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.findIndex(users, 'active', false);
	     * // => 0
	     *
	     * // using the `_.property` callback shorthand
	     * _.findIndex(users, 'active');
	     * // => 2
	     */
	    var findIndex = createFindIndex();
	
	    /**
	     * This method is like `_.findIndex` except that it iterates over elements
	     * of `collection` from right to left.
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to search.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {number} Returns the index of the found element, else `-1`.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney',  'active': true },
	     *   { 'user': 'fred',    'active': false },
	     *   { 'user': 'pebbles', 'active': false }
	     * ];
	     *
	     * _.findLastIndex(users, function(chr) {
	     *   return chr.user == 'pebbles';
	     * });
	     * // => 2
	     *
	     * // using the `_.matches` callback shorthand
	     * _.findLastIndex(users, { 'user': 'barney', 'active': true });
	     * // => 0
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.findLastIndex(users, 'active', false);
	     * // => 2
	     *
	     * // using the `_.property` callback shorthand
	     * _.findLastIndex(users, 'active');
	     * // => 0
	     */
	    var findLastIndex = createFindIndex(true);
	
	    /**
	     * Gets the first element of `array`.
	     *
	     * @static
	     * @memberOf _
	     * @alias head
	     * @category Array
	     * @param {Array} array The array to query.
	     * @returns {*} Returns the first element of `array`.
	     * @example
	     *
	     * _.first([1, 2, 3]);
	     * // => 1
	     *
	     * _.first([]);
	     * // => undefined
	     */
	    function first(array) {
	      return array ? array[0] : undefined;
	    }
	
	    /**
	     * Flattens a nested array. If `isDeep` is `true` the array is recursively
	     * flattened, otherwise it is only flattened a single level.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to flatten.
	     * @param {boolean} [isDeep] Specify a deep flatten.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the new flattened array.
	     * @example
	     *
	     * _.flatten([1, [2, 3, [4]]]);
	     * // => [1, 2, 3, [4]]
	     *
	     * // using `isDeep`
	     * _.flatten([1, [2, 3, [4]]], true);
	     * // => [1, 2, 3, 4]
	     */
	    function flatten(array, isDeep, guard) {
	      var length = array ? array.length : 0;
	      if (guard && isIterateeCall(array, isDeep, guard)) {
	        isDeep = false;
	      }
	      return length ? baseFlatten(array, isDeep) : [];
	    }
	
	    /**
	     * Recursively flattens a nested array.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to recursively flatten.
	     * @returns {Array} Returns the new flattened array.
	     * @example
	     *
	     * _.flattenDeep([1, [2, 3, [4]]]);
	     * // => [1, 2, 3, 4]
	     */
	    function flattenDeep(array) {
	      var length = array ? array.length : 0;
	      return length ? baseFlatten(array, true) : [];
	    }
	
	    /**
	     * Gets the index at which the first occurrence of `value` is found in `array`
	     * using `SameValueZero` for equality comparisons. If `fromIndex` is negative,
	     * it is used as the offset from the end of `array`. If `array` is sorted
	     * providing `true` for `fromIndex` performs a faster binary search.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to search.
	     * @param {*} value The value to search for.
	     * @param {boolean|number} [fromIndex=0] The index to search from or `true`
	     *  to perform a binary search on a sorted array.
	     * @returns {number} Returns the index of the matched value, else `-1`.
	     * @example
	     *
	     * _.indexOf([1, 2, 1, 2], 2);
	     * // => 1
	     *
	     * // using `fromIndex`
	     * _.indexOf([1, 2, 1, 2], 2, 2);
	     * // => 3
	     *
	     * // performing a binary search
	     * _.indexOf([1, 1, 2, 2], 2, true);
	     * // => 2
	     */
	    function indexOf(array, value, fromIndex) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return -1;
	      }
	      if (typeof fromIndex == 'number') {
	        fromIndex = fromIndex < 0 ? nativeMax(length + fromIndex, 0) : fromIndex;
	      } else if (fromIndex) {
	        var index = binaryIndex(array, value),
	            other = array[index];
	
	        if (value === value ? (value === other) : (other !== other)) {
	          return index;
	        }
	        return -1;
	      }
	      return baseIndexOf(array, value, fromIndex || 0);
	    }
	
	    /**
	     * Gets all but the last element of `array`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.initial([1, 2, 3]);
	     * // => [1, 2]
	     */
	    function initial(array) {
	      return dropRight(array, 1);
	    }
	
	    /**
	     * Creates an array of unique values in all provided arrays using `SameValueZero`
	     * for equality comparisons.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {...Array} [arrays] The arrays to inspect.
	     * @returns {Array} Returns the new array of shared values.
	     * @example
	     * _.intersection([1, 2], [4, 2], [2, 1]);
	     * // => [2]
	     */
	    function intersection() {
	      var args = [],
	          argsIndex = -1,
	          argsLength = arguments.length,
	          caches = [],
	          indexOf = getIndexOf(),
	          isCommon = indexOf == baseIndexOf;
	
	      while (++argsIndex < argsLength) {
	        var value = arguments[argsIndex];
	        if (isArray(value) || isArguments(value)) {
	          args.push(value);
	          caches.push((isCommon && value.length >= 120) ? createCache(argsIndex && value) : null);
	        }
	      }
	      argsLength = args.length;
	      var array = args[0],
	          index = -1,
	          length = array ? array.length : 0,
	          result = [],
	          seen = caches[0];
	
	      outer:
	      while (++index < length) {
	        value = array[index];
	        if ((seen ? cacheIndexOf(seen, value) : indexOf(result, value, 0)) < 0) {
	          argsIndex = argsLength;
	          while (--argsIndex) {
	            var cache = caches[argsIndex];
	            if ((cache ? cacheIndexOf(cache, value) : indexOf(args[argsIndex], value, 0)) < 0) {
	              continue outer;
	            }
	          }
	          if (seen) {
	            seen.push(value);
	          }
	          result.push(value);
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Gets the last element of `array`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @returns {*} Returns the last element of `array`.
	     * @example
	     *
	     * _.last([1, 2, 3]);
	     * // => 3
	     */
	    function last(array) {
	      var length = array ? array.length : 0;
	      return length ? array[length - 1] : undefined;
	    }
	
	    /**
	     * This method is like `_.indexOf` except that it iterates over elements of
	     * `array` from right to left.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to search.
	     * @param {*} value The value to search for.
	     * @param {boolean|number} [fromIndex=array.length-1] The index to search from
	     *  or `true` to perform a binary search on a sorted array.
	     * @returns {number} Returns the index of the matched value, else `-1`.
	     * @example
	     *
	     * _.lastIndexOf([1, 2, 1, 2], 2);
	     * // => 3
	     *
	     * // using `fromIndex`
	     * _.lastIndexOf([1, 2, 1, 2], 2, 2);
	     * // => 1
	     *
	     * // performing a binary search
	     * _.lastIndexOf([1, 1, 2, 2], 2, true);
	     * // => 3
	     */
	    function lastIndexOf(array, value, fromIndex) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return -1;
	      }
	      var index = length;
	      if (typeof fromIndex == 'number') {
	        index = (fromIndex < 0 ? nativeMax(length + fromIndex, 0) : nativeMin(fromIndex || 0, length - 1)) + 1;
	      } else if (fromIndex) {
	        index = binaryIndex(array, value, true) - 1;
	        var other = array[index];
	        if (value === value ? (value === other) : (other !== other)) {
	          return index;
	        }
	        return -1;
	      }
	      if (value !== value) {
	        return indexOfNaN(array, index, true);
	      }
	      while (index--) {
	        if (array[index] === value) {
	          return index;
	        }
	      }
	      return -1;
	    }
	
	    /**
	     * Removes all provided values from `array` using `SameValueZero` for equality
	     * comparisons.
	     *
	     * **Notes:**
	     *  - Unlike `_.without`, this method mutates `array`
	     *  - [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     *    comparisons are like strict equality comparisons, e.g. `===`, except
	     *    that `NaN` matches `NaN`
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to modify.
	     * @param {...*} [values] The values to remove.
	     * @returns {Array} Returns `array`.
	     * @example
	     *
	     * var array = [1, 2, 3, 1, 2, 3];
	     *
	     * _.pull(array, 2, 3);
	     * console.log(array);
	     * // => [1, 1]
	     */
	    function pull() {
	      var args = arguments,
	          array = args[0];
	
	      if (!(array && array.length)) {
	        return array;
	      }
	      var index = 0,
	          indexOf = getIndexOf(),
	          length = args.length;
	
	      while (++index < length) {
	        var fromIndex = 0,
	            value = args[index];
	
	        while ((fromIndex = indexOf(array, value, fromIndex)) > -1) {
	          splice.call(array, fromIndex, 1);
	        }
	      }
	      return array;
	    }
	
	    /**
	     * Removes elements from `array` corresponding to the given indexes and returns
	     * an array of the removed elements. Indexes may be specified as an array of
	     * indexes or as individual arguments.
	     *
	     * **Note:** Unlike `_.at`, this method mutates `array`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to modify.
	     * @param {...(number|number[])} [indexes] The indexes of elements to remove,
	     *  specified as individual indexes or arrays of indexes.
	     * @returns {Array} Returns the new array of removed elements.
	     * @example
	     *
	     * var array = [5, 10, 15, 20];
	     * var evens = _.pullAt(array, 1, 3);
	     *
	     * console.log(array);
	     * // => [5, 15]
	     *
	     * console.log(evens);
	     * // => [10, 20]
	     */
	    var pullAt = restParam(function(array, indexes) {
	      array || (array = []);
	      indexes = baseFlatten(indexes);
	
	      var length = indexes.length,
	          result = baseAt(array, indexes);
	
	      indexes.sort(baseCompareAscending);
	      while (length--) {
	        var index = parseFloat(indexes[length]);
	        if (index != previous && isIndex(index)) {
	          var previous = index;
	          splice.call(array, index, 1);
	        }
	      }
	      return result;
	    });
	
	    /**
	     * Removes all elements from `array` that `predicate` returns truthy for
	     * and returns an array of the removed elements. The predicate is bound to
	     * `thisArg` and invoked with three arguments: (value, index, array).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * **Note:** Unlike `_.filter`, this method mutates `array`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to modify.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the new array of removed elements.
	     * @example
	     *
	     * var array = [1, 2, 3, 4];
	     * var evens = _.remove(array, function(n) {
	     *   return n % 2 == 0;
	     * });
	     *
	     * console.log(array);
	     * // => [1, 3]
	     *
	     * console.log(evens);
	     * // => [2, 4]
	     */
	    function remove(array, predicate, thisArg) {
	      var index = -1,
	          length = array ? array.length : 0,
	          result = [];
	
	      predicate = getCallback(predicate, thisArg, 3);
	      while (++index < length) {
	        var value = array[index];
	        if (predicate(value, index, array)) {
	          result.push(value);
	          splice.call(array, index--, 1);
	          length--;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Gets all but the first element of `array`.
	     *
	     * @static
	     * @memberOf _
	     * @alias tail
	     * @category Array
	     * @param {Array} array The array to query.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.rest([1, 2, 3]);
	     * // => [2, 3]
	     */
	    function rest(array) {
	      return drop(array, 1);
	    }
	
	    /**
	     * Creates a slice of `array` from `start` up to, but not including, `end`.
	     *
	     * **Note:** This function is used instead of `Array#slice` to support node
	     * lists in IE < 9 and to ensure dense arrays are returned.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to slice.
	     * @param {number} [start=0] The start position.
	     * @param {number} [end=array.length] The end position.
	     * @returns {Array} Returns the slice of `array`.
	     */
	    function slice(array, start, end) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {
	        start = 0;
	        end = length;
	      }
	      return baseSlice(array, start, end);
	    }
	
	    /**
	     * Uses a binary search to determine the lowest index at which `value` should
	     * be inserted into `array` in order to maintain its sort order. If an iteratee
	     * function is provided it is invoked for `value` and each element of `array`
	     * to compute their sort ranking. The iteratee is bound to `thisArg` and
	     * invoked with one argument; (value).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The sorted array to inspect.
	     * @param {*} value The value to evaluate.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {number} Returns the index at which `value` should be inserted
	     *  into `array`.
	     * @example
	     *
	     * _.sortedIndex([30, 50], 40);
	     * // => 1
	     *
	     * _.sortedIndex([4, 4, 5, 5], 5);
	     * // => 2
	     *
	     * var dict = { 'data': { 'thirty': 30, 'forty': 40, 'fifty': 50 } };
	     *
	     * // using an iteratee function
	     * _.sortedIndex(['thirty', 'fifty'], 'forty', function(word) {
	     *   return this.data[word];
	     * }, dict);
	     * // => 1
	     *
	     * // using the `_.property` callback shorthand
	     * _.sortedIndex([{ 'x': 30 }, { 'x': 50 }], { 'x': 40 }, 'x');
	     * // => 1
	     */
	    var sortedIndex = createSortedIndex();
	
	    /**
	     * This method is like `_.sortedIndex` except that it returns the highest
	     * index at which `value` should be inserted into `array` in order to
	     * maintain its sort order.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The sorted array to inspect.
	     * @param {*} value The value to evaluate.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {number} Returns the index at which `value` should be inserted
	     *  into `array`.
	     * @example
	     *
	     * _.sortedLastIndex([4, 4, 5, 5], 5);
	     * // => 4
	     */
	    var sortedLastIndex = createSortedIndex(true);
	
	    /**
	     * Creates a slice of `array` with `n` elements taken from the beginning.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {number} [n=1] The number of elements to take.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.take([1, 2, 3]);
	     * // => [1]
	     *
	     * _.take([1, 2, 3], 2);
	     * // => [1, 2]
	     *
	     * _.take([1, 2, 3], 5);
	     * // => [1, 2, 3]
	     *
	     * _.take([1, 2, 3], 0);
	     * // => []
	     */
	    function take(array, n, guard) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (guard ? isIterateeCall(array, n, guard) : n == null) {
	        n = 1;
	      }
	      return baseSlice(array, 0, n < 0 ? 0 : n);
	    }
	
	    /**
	     * Creates a slice of `array` with `n` elements taken from the end.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {number} [n=1] The number of elements to take.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.takeRight([1, 2, 3]);
	     * // => [3]
	     *
	     * _.takeRight([1, 2, 3], 2);
	     * // => [2, 3]
	     *
	     * _.takeRight([1, 2, 3], 5);
	     * // => [1, 2, 3]
	     *
	     * _.takeRight([1, 2, 3], 0);
	     * // => []
	     */
	    function takeRight(array, n, guard) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (guard ? isIterateeCall(array, n, guard) : n == null) {
	        n = 1;
	      }
	      n = length - (+n || 0);
	      return baseSlice(array, n < 0 ? 0 : n);
	    }
	
	    /**
	     * Creates a slice of `array` with elements taken from the end. Elements are
	     * taken until `predicate` returns falsey. The predicate is bound to `thisArg`
	     * and invoked with three arguments: (value, index, array).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.takeRightWhile([1, 2, 3], function(n) {
	     *   return n > 1;
	     * });
	     * // => [2, 3]
	     *
	     * var users = [
	     *   { 'user': 'barney',  'active': true },
	     *   { 'user': 'fred',    'active': false },
	     *   { 'user': 'pebbles', 'active': false }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.pluck(_.takeRightWhile(users, { 'user': 'pebbles', 'active': false }), 'user');
	     * // => ['pebbles']
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.pluck(_.takeRightWhile(users, 'active', false), 'user');
	     * // => ['fred', 'pebbles']
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.takeRightWhile(users, 'active'), 'user');
	     * // => []
	     */
	    function takeRightWhile(array, predicate, thisArg) {
	      return (array && array.length)
	        ? baseWhile(array, getCallback(predicate, thisArg, 3), false, true)
	        : [];
	    }
	
	    /**
	     * Creates a slice of `array` with elements taken from the beginning. Elements
	     * are taken until `predicate` returns falsey. The predicate is bound to
	     * `thisArg` and invoked with three arguments: (value, index, array).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to query.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the slice of `array`.
	     * @example
	     *
	     * _.takeWhile([1, 2, 3], function(n) {
	     *   return n < 3;
	     * });
	     * // => [1, 2]
	     *
	     * var users = [
	     *   { 'user': 'barney',  'active': false },
	     *   { 'user': 'fred',    'active': false},
	     *   { 'user': 'pebbles', 'active': true }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.pluck(_.takeWhile(users, { 'user': 'barney', 'active': false }), 'user');
	     * // => ['barney']
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.pluck(_.takeWhile(users, 'active', false), 'user');
	     * // => ['barney', 'fred']
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.takeWhile(users, 'active'), 'user');
	     * // => []
	     */
	    function takeWhile(array, predicate, thisArg) {
	      return (array && array.length)
	        ? baseWhile(array, getCallback(predicate, thisArg, 3))
	        : [];
	    }
	
	    /**
	     * Creates an array of unique values, in order, of the provided arrays using
	     * `SameValueZero` for equality comparisons.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {...Array} [arrays] The arrays to inspect.
	     * @returns {Array} Returns the new array of combined values.
	     * @example
	     *
	     * _.union([1, 2], [4, 2], [2, 1]);
	     * // => [1, 2, 4]
	     */
	    var union = restParam(function(arrays) {
	      return baseUniq(baseFlatten(arrays, false, true));
	    });
	
	    /**
	     * Creates a duplicate-value-free version of an array using `SameValueZero`
	     * for equality comparisons. Providing `true` for `isSorted` performs a faster
	     * search algorithm for sorted arrays. If an iteratee function is provided it
	     * is invoked for each value in the array to generate the criterion by which
	     * uniqueness is computed. The `iteratee` is bound to `thisArg` and invoked
	     * with three arguments: (value, index, array).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @alias unique
	     * @category Array
	     * @param {Array} array The array to inspect.
	     * @param {boolean} [isSorted] Specify the array is sorted.
	     * @param {Function|Object|string} [iteratee] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Array} Returns the new duplicate-value-free array.
	     * @example
	     *
	     * _.uniq([1, 2, 1]);
	     * // => [1, 2]
	     *
	     * // using `isSorted`
	     * _.uniq([1, 1, 2], true);
	     * // => [1, 2]
	     *
	     * // using an iteratee function
	     * _.uniq([1, 2.5, 1.5, 2], function(n) {
	     *   return this.floor(n);
	     * }, Math);
	     * // => [1, 2.5]
	     *
	     * // using the `_.property` callback shorthand
	     * _.uniq([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');
	     * // => [{ 'x': 1 }, { 'x': 2 }]
	     */
	    function uniq(array, isSorted, iteratee, thisArg) {
	      var length = array ? array.length : 0;
	      if (!length) {
	        return [];
	      }
	      if (isSorted != null && typeof isSorted != 'boolean') {
	        thisArg = iteratee;
	        iteratee = isIterateeCall(array, isSorted, thisArg) ? null : isSorted;
	        isSorted = false;
	      }
	      var func = getCallback();
	      if (!(func === baseCallback && iteratee == null)) {
	        iteratee = func(iteratee, thisArg, 3);
	      }
	      return (isSorted && getIndexOf() == baseIndexOf)
	        ? sortedUniq(array, iteratee)
	        : baseUniq(array, iteratee);
	    }
	
	    /**
	     * This method is like `_.zip` except that it accepts an array of grouped
	     * elements and creates an array regrouping the elements to their pre-`_.zip`
	     * configuration.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array of grouped elements to process.
	     * @returns {Array} Returns the new array of regrouped elements.
	     * @example
	     *
	     * var zipped = _.zip(['fred', 'barney'], [30, 40], [true, false]);
	     * // => [['fred', 30, true], ['barney', 40, false]]
	     *
	     * _.unzip(zipped);
	     * // => [['fred', 'barney'], [30, 40], [true, false]]
	     */
	    function unzip(array) {
	      var index = -1,
	          length = (array && array.length && arrayMax(arrayMap(array, getLength))) >>> 0,
	          result = Array(length);
	
	      while (++index < length) {
	        result[index] = arrayMap(array, baseProperty(index));
	      }
	      return result;
	    }
	
	    /**
	     * Creates an array excluding all provided values using `SameValueZero` for
	     * equality comparisons.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {Array} array The array to filter.
	     * @param {...*} [values] The values to exclude.
	     * @returns {Array} Returns the new array of filtered values.
	     * @example
	     *
	     * _.without([1, 2, 1, 3], 1, 2);
	     * // => [3]
	     */
	    var without = restParam(function(array, values) {
	      return (isArray(array) || isArguments(array))
	        ? baseDifference(array, values)
	        : [];
	    });
	
	    /**
	     * Creates an array that is the [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)
	     * of the provided arrays.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {...Array} [arrays] The arrays to inspect.
	     * @returns {Array} Returns the new array of values.
	     * @example
	     *
	     * _.xor([1, 2], [4, 2]);
	     * // => [1, 4]
	     */
	    function xor() {
	      var index = -1,
	          length = arguments.length;
	
	      while (++index < length) {
	        var array = arguments[index];
	        if (isArray(array) || isArguments(array)) {
	          var result = result
	            ? baseDifference(result, array).concat(baseDifference(array, result))
	            : array;
	        }
	      }
	      return result ? baseUniq(result) : [];
	    }
	
	    /**
	     * Creates an array of grouped elements, the first of which contains the first
	     * elements of the given arrays, the second of which contains the second elements
	     * of the given arrays, and so on.
	     *
	     * @static
	     * @memberOf _
	     * @category Array
	     * @param {...Array} [arrays] The arrays to process.
	     * @returns {Array} Returns the new array of grouped elements.
	     * @example
	     *
	     * _.zip(['fred', 'barney'], [30, 40], [true, false]);
	     * // => [['fred', 30, true], ['barney', 40, false]]
	     */
	    var zip = restParam(unzip);
	
	    /**
	     * The inverse of `_.pairs`; this method returns an object composed from arrays
	     * of property names and values. Provide either a single two dimensional array,
	     * e.g. `[[key1, value1], [key2, value2]]` or two arrays, one of property names
	     * and one of corresponding values.
	     *
	     * @static
	     * @memberOf _
	     * @alias object
	     * @category Array
	     * @param {Array} props The property names.
	     * @param {Array} [values=[]] The property values.
	     * @returns {Object} Returns the new object.
	     * @example
	     *
	     * _.zipObject([['fred', 30], ['barney', 40]]);
	     * // => { 'fred': 30, 'barney': 40 }
	     *
	     * _.zipObject(['fred', 'barney'], [30, 40]);
	     * // => { 'fred': 30, 'barney': 40 }
	     */
	    function zipObject(props, values) {
	      var index = -1,
	          length = props ? props.length : 0,
	          result = {};
	
	      if (length && !values && !isArray(props[0])) {
	        values = [];
	      }
	      while (++index < length) {
	        var key = props[index];
	        if (values) {
	          result[key] = values[index];
	        } else if (key) {
	          result[key[0]] = key[1];
	        }
	      }
	      return result;
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates a `lodash` object that wraps `value` with explicit method
	     * chaining enabled.
	     *
	     * @static
	     * @memberOf _
	     * @category Chain
	     * @param {*} value The value to wrap.
	     * @returns {Object} Returns the new `lodash` wrapper instance.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney',  'age': 36 },
	     *   { 'user': 'fred',    'age': 40 },
	     *   { 'user': 'pebbles', 'age': 1 }
	     * ];
	     *
	     * var youngest = _.chain(users)
	     *   .sortBy('age')
	     *   .map(function(chr) {
	     *     return chr.user + ' is ' + chr.age;
	     *   })
	     *   .first()
	     *   .value();
	     * // => 'pebbles is 1'
	     */
	    function chain(value) {
	      var result = lodash(value);
	      result.__chain__ = true;
	      return result;
	    }
	
	    /**
	     * This method invokes `interceptor` and returns `value`. The interceptor is
	     * bound to `thisArg` and invoked with one argument; (value). The purpose of
	     * this method is to "tap into" a method chain in order to perform operations
	     * on intermediate results within the chain.
	     *
	     * @static
	     * @memberOf _
	     * @category Chain
	     * @param {*} value The value to provide to `interceptor`.
	     * @param {Function} interceptor The function to invoke.
	     * @param {*} [thisArg] The `this` binding of `interceptor`.
	     * @returns {*} Returns `value`.
	     * @example
	     *
	     * _([1, 2, 3])
	     *  .tap(function(array) {
	     *    array.pop();
	     *  })
	     *  .reverse()
	     *  .value();
	     * // => [2, 1]
	     */
	    function tap(value, interceptor, thisArg) {
	      interceptor.call(thisArg, value);
	      return value;
	    }
	
	    /**
	     * This method is like `_.tap` except that it returns the result of `interceptor`.
	     *
	     * @static
	     * @memberOf _
	     * @category Chain
	     * @param {*} value The value to provide to `interceptor`.
	     * @param {Function} interceptor The function to invoke.
	     * @param {*} [thisArg] The `this` binding of `interceptor`.
	     * @returns {*} Returns the result of `interceptor`.
	     * @example
	     *
	     * _('  abc  ')
	     *  .chain()
	     *  .trim()
	     *  .thru(function(value) {
	     *    return [value];
	     *  })
	     *  .value();
	     * // => ['abc']
	     */
	    function thru(value, interceptor, thisArg) {
	      return interceptor.call(thisArg, value);
	    }
	
	    /**
	     * Enables explicit method chaining on the wrapper object.
	     *
	     * @name chain
	     * @memberOf _
	     * @category Chain
	     * @returns {Object} Returns the new `lodash` wrapper instance.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 40 }
	     * ];
	     *
	     * // without explicit chaining
	     * _(users).first();
	     * // => { 'user': 'barney', 'age': 36 }
	     *
	     * // with explicit chaining
	     * _(users).chain()
	     *   .first()
	     *   .pick('user')
	     *   .value();
	     * // => { 'user': 'barney' }
	     */
	    function wrapperChain() {
	      return chain(this);
	    }
	
	    /**
	     * Executes the chained sequence and returns the wrapped result.
	     *
	     * @name commit
	     * @memberOf _
	     * @category Chain
	     * @returns {Object} Returns the new `lodash` wrapper instance.
	     * @example
	     *
	     * var array = [1, 2];
	     * var wrapper = _(array).push(3);
	     *
	     * console.log(array);
	     * // => [1, 2]
	     *
	     * wrapper = wrapper.commit();
	     * console.log(array);
	     * // => [1, 2, 3]
	     *
	     * wrapper.last();
	     * // => 3
	     *
	     * console.log(array);
	     * // => [1, 2, 3]
	     */
	    function wrapperCommit() {
	      return new LodashWrapper(this.value(), this.__chain__);
	    }
	
	    /**
	     * Creates a clone of the chained sequence planting `value` as the wrapped value.
	     *
	     * @name plant
	     * @memberOf _
	     * @category Chain
	     * @returns {Object} Returns the new `lodash` wrapper instance.
	     * @example
	     *
	     * var array = [1, 2];
	     * var wrapper = _(array).map(function(value) {
	     *   return Math.pow(value, 2);
	     * });
	     *
	     * var other = [3, 4];
	     * var otherWrapper = wrapper.plant(other);
	     *
	     * otherWrapper.value();
	     * // => [9, 16]
	     *
	     * wrapper.value();
	     * // => [1, 4]
	     */
	    function wrapperPlant(value) {
	      var result,
	          parent = this;
	
	      while (parent instanceof baseLodash) {
	        var clone = wrapperClone(parent);
	        if (result) {
	          previous.__wrapped__ = clone;
	        } else {
	          result = clone;
	        }
	        var previous = clone;
	        parent = parent.__wrapped__;
	      }
	      previous.__wrapped__ = value;
	      return result;
	    }
	
	    /**
	     * Reverses the wrapped array so the first element becomes the last, the
	     * second element becomes the second to last, and so on.
	     *
	     * **Note:** This method mutates the wrapped array.
	     *
	     * @name reverse
	     * @memberOf _
	     * @category Chain
	     * @returns {Object} Returns the new reversed `lodash` wrapper instance.
	     * @example
	     *
	     * var array = [1, 2, 3];
	     *
	     * _(array).reverse().value()
	     * // => [3, 2, 1]
	     *
	     * console.log(array);
	     * // => [3, 2, 1]
	     */
	    function wrapperReverse() {
	      var value = this.__wrapped__;
	      if (value instanceof LazyWrapper) {
	        if (this.__actions__.length) {
	          value = new LazyWrapper(this);
	        }
	        return new LodashWrapper(value.reverse(), this.__chain__);
	      }
	      return this.thru(function(value) {
	        return value.reverse();
	      });
	    }
	
	    /**
	     * Produces the result of coercing the unwrapped value to a string.
	     *
	     * @name toString
	     * @memberOf _
	     * @category Chain
	     * @returns {string} Returns the coerced string value.
	     * @example
	     *
	     * _([1, 2, 3]).toString();
	     * // => '1,2,3'
	     */
	    function wrapperToString() {
	      return (this.value() + '');
	    }
	
	    /**
	     * Executes the chained sequence to extract the unwrapped value.
	     *
	     * @name value
	     * @memberOf _
	     * @alias run, toJSON, valueOf
	     * @category Chain
	     * @returns {*} Returns the resolved unwrapped value.
	     * @example
	     *
	     * _([1, 2, 3]).value();
	     * // => [1, 2, 3]
	     */
	    function wrapperValue() {
	      return baseWrapperValue(this.__wrapped__, this.__actions__);
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates an array of elements corresponding to the given keys, or indexes,
	     * of `collection`. Keys may be specified as individual arguments or as arrays
	     * of keys.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {...(number|number[]|string|string[])} [props] The property names
	     *  or indexes of elements to pick, specified individually or in arrays.
	     * @returns {Array} Returns the new array of picked elements.
	     * @example
	     *
	     * _.at(['a', 'b', 'c'], [0, 2]);
	     * // => ['a', 'c']
	     *
	     * _.at(['barney', 'fred', 'pebbles'], 0, 2);
	     * // => ['barney', 'pebbles']
	     */
	    var at = restParam(function(collection, props) {
	      var length = collection ? collection.length : 0;
	      if (isLength(length)) {
	        collection = toIterable(collection);
	      }
	      return baseAt(collection, baseFlatten(props));
	    });
	
	    /**
	     * Creates an object composed of keys generated from the results of running
	     * each element of `collection` through `iteratee`. The corresponding value
	     * of each key is the number of times the key was returned by `iteratee`.
	     * The `iteratee` is bound to `thisArg` and invoked with three arguments:
	     * (value, index|key, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns the composed aggregate object.
	     * @example
	     *
	     * _.countBy([4.3, 6.1, 6.4], function(n) {
	     *   return Math.floor(n);
	     * });
	     * // => { '4': 1, '6': 2 }
	     *
	     * _.countBy([4.3, 6.1, 6.4], function(n) {
	     *   return this.floor(n);
	     * }, Math);
	     * // => { '4': 1, '6': 2 }
	     *
	     * _.countBy(['one', 'two', 'three'], 'length');
	     * // => { '3': 2, '5': 1 }
	     */
	    var countBy = createAggregator(function(result, value, key) {
	      hasOwnProperty.call(result, key) ? ++result[key] : (result[key] = 1);
	    });
	
	    /**
	     * Checks if `predicate` returns truthy for **all** elements of `collection`.
	     * The predicate is bound to `thisArg` and invoked with three arguments:
	     * (value, index|key, collection).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @alias all
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {boolean} Returns `true` if all elements pass the predicate check,
	     *  else `false`.
	     * @example
	     *
	     * _.every([true, 1, null, 'yes'], Boolean);
	     * // => false
	     *
	     * var users = [
	     *   { 'user': 'barney', 'active': false },
	     *   { 'user': 'fred',   'active': false }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.every(users, { 'user': 'barney', 'active': false });
	     * // => false
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.every(users, 'active', false);
	     * // => true
	     *
	     * // using the `_.property` callback shorthand
	     * _.every(users, 'active');
	     * // => false
	     */
	    function every(collection, predicate, thisArg) {
	      var func = isArray(collection) ? arrayEvery : baseEvery;
	      if (thisArg && isIterateeCall(collection, predicate, thisArg)) {
	        predicate = null;
	      }
	      if (typeof predicate != 'function' || typeof thisArg != 'undefined') {
	        predicate = getCallback(predicate, thisArg, 3);
	      }
	      return func(collection, predicate);
	    }
	
	    /**
	     * Iterates over elements of `collection`, returning an array of all elements
	     * `predicate` returns truthy for. The predicate is bound to `thisArg` and
	     * invoked with three arguments: (value, index|key, collection).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @alias select
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the new filtered array.
	     * @example
	     *
	     * _.filter([4, 5, 6], function(n) {
	     *   return n % 2 == 0;
	     * });
	     * // => [4, 6]
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36, 'active': true },
	     *   { 'user': 'fred',   'age': 40, 'active': false }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.pluck(_.filter(users, { 'age': 36, 'active': true }), 'user');
	     * // => ['barney']
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.pluck(_.filter(users, 'active', false), 'user');
	     * // => ['fred']
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.filter(users, 'active'), 'user');
	     * // => ['barney']
	     */
	    function filter(collection, predicate, thisArg) {
	      var func = isArray(collection) ? arrayFilter : baseFilter;
	      predicate = getCallback(predicate, thisArg, 3);
	      return func(collection, predicate);
	    }
	
	    /**
	     * Iterates over elements of `collection`, returning the first element
	     * `predicate` returns truthy for. The predicate is bound to `thisArg` and
	     * invoked with three arguments: (value, index|key, collection).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @alias detect
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to search.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {*} Returns the matched element, else `undefined`.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney',  'age': 36, 'active': true },
	     *   { 'user': 'fred',    'age': 40, 'active': false },
	     *   { 'user': 'pebbles', 'age': 1,  'active': true }
	     * ];
	     *
	     * _.result(_.find(users, function(chr) {
	     *   return chr.age < 40;
	     * }), 'user');
	     * // => 'barney'
	     *
	     * // using the `_.matches` callback shorthand
	     * _.result(_.find(users, { 'age': 1, 'active': true }), 'user');
	     * // => 'pebbles'
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.result(_.find(users, 'active', false), 'user');
	     * // => 'fred'
	     *
	     * // using the `_.property` callback shorthand
	     * _.result(_.find(users, 'active'), 'user');
	     * // => 'barney'
	     */
	    var find = createFind(baseEach);
	
	    /**
	     * This method is like `_.find` except that it iterates over elements of
	     * `collection` from right to left.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to search.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {*} Returns the matched element, else `undefined`.
	     * @example
	     *
	     * _.findLast([1, 2, 3, 4], function(n) {
	     *   return n % 2 == 1;
	     * });
	     * // => 3
	     */
	    var findLast = createFind(baseEachRight, true);
	
	    /**
	     * Performs a deep comparison between each element in `collection` and the
	     * source object, returning the first element that has equivalent property
	     * values.
	     *
	     * **Note:** This method supports comparing arrays, booleans, `Date` objects,
	     * numbers, `Object` objects, regexes, and strings. Objects are compared by
	     * their own, not inherited, enumerable properties. For comparing a single
	     * own or inherited property value see `_.matchesProperty`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to search.
	     * @param {Object} source The object of property values to match.
	     * @returns {*} Returns the matched element, else `undefined`.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36, 'active': true },
	     *   { 'user': 'fred',   'age': 40, 'active': false }
	     * ];
	     *
	     * _.result(_.findWhere(users, { 'age': 36, 'active': true }), 'user');
	     * // => 'barney'
	     *
	     * _.result(_.findWhere(users, { 'age': 40, 'active': false }), 'user');
	     * // => 'fred'
	     */
	    function findWhere(collection, source) {
	      return find(collection, baseMatches(source));
	    }
	
	    /**
	     * Iterates over elements of `collection` invoking `iteratee` for each element.
	     * The `iteratee` is bound to `thisArg` and invoked with three arguments:
	     * (value, index|key, collection). Iterator functions may exit iteration early
	     * by explicitly returning `false`.
	     *
	     * **Note:** As with other "Collections" methods, objects with a `length` property
	     * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`
	     * may be used for object iteration.
	     *
	     * @static
	     * @memberOf _
	     * @alias each
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Array|Object|string} Returns `collection`.
	     * @example
	     *
	     * _([1, 2]).forEach(function(n) {
	     *   console.log(n);
	     * }).value();
	     * // => logs each value from left to right and returns the array
	     *
	     * _.forEach({ 'a': 1, 'b': 2 }, function(n, key) {
	     *   console.log(n, key);
	     * });
	     * // => logs each value-key pair and returns the object (iteration order is not guaranteed)
	     */
	    var forEach = createForEach(arrayEach, baseEach);
	
	    /**
	     * This method is like `_.forEach` except that it iterates over elements of
	     * `collection` from right to left.
	     *
	     * @static
	     * @memberOf _
	     * @alias eachRight
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Array|Object|string} Returns `collection`.
	     * @example
	     *
	     * _([1, 2]).forEachRight(function(n) {
	     *   console.log(n);
	     * }).value();
	     * // => logs each value from right to left and returns the array
	     */
	    var forEachRight = createForEach(arrayEachRight, baseEachRight);
	
	    /**
	     * Creates an object composed of keys generated from the results of running
	     * each element of `collection` through `iteratee`. The corresponding value
	     * of each key is an array of the elements responsible for generating the key.
	     * The `iteratee` is bound to `thisArg` and invoked with three arguments:
	     * (value, index|key, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns the composed aggregate object.
	     * @example
	     *
	     * _.groupBy([4.2, 6.1, 6.4], function(n) {
	     *   return Math.floor(n);
	     * });
	     * // => { '4': [4.2], '6': [6.1, 6.4] }
	     *
	     * _.groupBy([4.2, 6.1, 6.4], function(n) {
	     *   return this.floor(n);
	     * }, Math);
	     * // => { '4': [4.2], '6': [6.1, 6.4] }
	     *
	     * // using the `_.property` callback shorthand
	     * _.groupBy(['one', 'two', 'three'], 'length');
	     * // => { '3': ['one', 'two'], '5': ['three'] }
	     */
	    var groupBy = createAggregator(function(result, value, key) {
	      if (hasOwnProperty.call(result, key)) {
	        result[key].push(value);
	      } else {
	        result[key] = [value];
	      }
	    });
	
	    /**
	     * Checks if `value` is in `collection` using `SameValueZero` for equality
	     * comparisons. If `fromIndex` is negative, it is used as the offset from
	     * the end of `collection`.
	     *
	     * **Note:** [`SameValueZero`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-samevaluezero)
	     * comparisons are like strict equality comparisons, e.g. `===`, except that
	     * `NaN` matches `NaN`.
	     *
	     * @static
	     * @memberOf _
	     * @alias contains, include
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to search.
	     * @param {*} target The value to search for.
	     * @param {number} [fromIndex=0] The index to search from.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.reduce`.
	     * @returns {boolean} Returns `true` if a matching element is found, else `false`.
	     * @example
	     *
	     * _.includes([1, 2, 3], 1);
	     * // => true
	     *
	     * _.includes([1, 2, 3], 1, 2);
	     * // => false
	     *
	     * _.includes({ 'user': 'fred', 'age': 40 }, 'fred');
	     * // => true
	     *
	     * _.includes('pebbles', 'eb');
	     * // => true
	     */
	    function includes(collection, target, fromIndex, guard) {
	      var length = collection ? collection.length : 0;
	      if (!isLength(length)) {
	        collection = values(collection);
	        length = collection.length;
	      }
	      if (!length) {
	        return false;
	      }
	      if (typeof fromIndex != 'number' || (guard && isIterateeCall(target, fromIndex, guard))) {
	        fromIndex = 0;
	      } else {
	        fromIndex = fromIndex < 0 ? nativeMax(length + fromIndex, 0) : (fromIndex || 0);
	      }
	      return (typeof collection == 'string' || !isArray(collection) && isString(collection))
	        ? (fromIndex < length && collection.indexOf(target, fromIndex) > -1)
	        : (getIndexOf(collection, target, fromIndex) > -1);
	    }
	
	    /**
	     * Creates an object composed of keys generated from the results of running
	     * each element of `collection` through `iteratee`. The corresponding value
	     * of each key is the last element responsible for generating the key. The
	     * iteratee function is bound to `thisArg` and invoked with three arguments:
	     * (value, index|key, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns the composed aggregate object.
	     * @example
	     *
	     * var keyData = [
	     *   { 'dir': 'left', 'code': 97 },
	     *   { 'dir': 'right', 'code': 100 }
	     * ];
	     *
	     * _.indexBy(keyData, 'dir');
	     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }
	     *
	     * _.indexBy(keyData, function(object) {
	     *   return String.fromCharCode(object.code);
	     * });
	     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }
	     *
	     * _.indexBy(keyData, function(object) {
	     *   return this.fromCharCode(object.code);
	     * }, String);
	     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }
	     */
	    var indexBy = createAggregator(function(result, value, key) {
	      result[key] = value;
	    });
	
	    /**
	     * Invokes the method named by `methodName` on each element in `collection`,
	     * returning an array of the results of each invoked method. Any additional
	     * arguments are provided to each invoked method. If `methodName` is a function
	     * it is invoked for, and `this` bound to, each element in `collection`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|string} methodName The name of the method to invoke or
	     *  the function invoked per iteration.
	     * @param {...*} [args] The arguments to invoke the method with.
	     * @returns {Array} Returns the array of results.
	     * @example
	     *
	     * _.invoke([[5, 1, 7], [3, 2, 1]], 'sort');
	     * // => [[1, 5, 7], [1, 2, 3]]
	     *
	     * _.invoke([123, 456], String.prototype.split, '');
	     * // => [['1', '2', '3'], ['4', '5', '6']]
	     */
	    var invoke = restParam(function(collection, methodName, args) {
	      var index = -1,
	          isFunc = typeof methodName == 'function',
	          length = collection ? collection.length : 0,
	          result = isLength(length) ? Array(length) : [];
	
	      baseEach(collection, function(value) {
	        var func = isFunc ? methodName : (value != null && value[methodName]);
	        result[++index] = func ? func.apply(value, args) : undefined;
	      });
	      return result;
	    });
	
	    /**
	     * Creates an array of values by running each element in `collection` through
	     * `iteratee`. The `iteratee` is bound to `thisArg` and invoked with three
	     * arguments: (value, index|key, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * Many lodash methods are guarded to work as interatees for methods like
	     * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.
	     *
	     * The guarded methods are:
	     * `ary`, `callback`, `chunk`, `clone`, `create`, `curry`, `curryRight`, `drop`,
	     * `dropRight`, `every`, `fill`, `flatten`, `invert`, `max`, `min`, `parseInt`,
	     * `slice`, `sortBy`, `take`, `takeRight`, `template`, `trim`, `trimLeft`,
	     * `trimRight`, `trunc`, `random`, `range`, `sample`, `some`, `uniq`, and `words`
	     *
	     * @static
	     * @memberOf _
	     * @alias collect
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     *  create a `_.property` or `_.matches` style callback respectively.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Array} Returns the new mapped array.
	     * @example
	     *
	     * function timesThree(n) {
	     *   return n * 3;
	     * }
	     *
	     * _.map([1, 2], timesThree);
	     * // => [3, 6]
	     *
	     * _.map({ 'a': 1, 'b': 2 }, timesThree);
	     * // => [3, 6] (iteration order is not guaranteed)
	     *
	     * var users = [
	     *   { 'user': 'barney' },
	     *   { 'user': 'fred' }
	     * ];
	     *
	     * // using the `_.property` callback shorthand
	     * _.map(users, 'user');
	     * // => ['barney', 'fred']
	     */
	    function map(collection, iteratee, thisArg) {
	      var func = isArray(collection) ? arrayMap : baseMap;
	      iteratee = getCallback(iteratee, thisArg, 3);
	      return func(collection, iteratee);
	    }
	
	    /**
	     * Creates an array of elements split into two groups, the first of which
	     * contains elements `predicate` returns truthy for, while the second of which
	     * contains elements `predicate` returns falsey for. The predicate is bound
	     * to `thisArg` and invoked with three arguments: (value, index|key, collection).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the array of grouped elements.
	     * @example
	     *
	     * _.partition([1, 2, 3], function(n) {
	     *   return n % 2;
	     * });
	     * // => [[1, 3], [2]]
	     *
	     * _.partition([1.2, 2.3, 3.4], function(n) {
	     *   return this.floor(n) % 2;
	     * }, Math);
	     * // => [[1.2, 3.4], [2.3]]
	     *
	     * var users = [
	     *   { 'user': 'barney',  'age': 36, 'active': false },
	     *   { 'user': 'fred',    'age': 40, 'active': true },
	     *   { 'user': 'pebbles', 'age': 1,  'active': false }
	     * ];
	     *
	     * var mapper = function(array) {
	     *   return _.pluck(array, 'user');
	     * };
	     *
	     * // using the `_.matches` callback shorthand
	     * _.map(_.partition(users, { 'age': 1, 'active': false }), mapper);
	     * // => [['pebbles'], ['barney', 'fred']]
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.map(_.partition(users, 'active', false), mapper);
	     * // => [['barney', 'pebbles'], ['fred']]
	     *
	     * // using the `_.property` callback shorthand
	     * _.map(_.partition(users, 'active'), mapper);
	     * // => [['fred'], ['barney', 'pebbles']]
	     */
	    var partition = createAggregator(function(result, value, key) {
	      result[key ? 0 : 1].push(value);
	    }, function() { return [[], []]; });
	
	    /**
	     * Gets the value of `key` from all elements in `collection`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {string} key The key of the property to pluck.
	     * @returns {Array} Returns the property values.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 40 }
	     * ];
	     *
	     * _.pluck(users, 'user');
	     * // => ['barney', 'fred']
	     *
	     * var userIndex = _.indexBy(users, 'user');
	     * _.pluck(userIndex, 'age');
	     * // => [36, 40] (iteration order is not guaranteed)
	     */
	    function pluck(collection, key) {
	      return map(collection, baseProperty(key));
	    }
	
	    /**
	     * Reduces `collection` to a value which is the accumulated result of running
	     * each element in `collection` through `iteratee`, where each successive
	     * invocation is supplied the return value of the previous. If `accumulator`
	     * is not provided the first element of `collection` is used as the initial
	     * value. The `iteratee` is bound to `thisArg` and invoked with four arguments:
	     * (accumulator, value, index|key, collection).
	     *
	     * Many lodash methods are guarded to work as interatees for methods like
	     * `_.reduce`, `_.reduceRight`, and `_.transform`.
	     *
	     * The guarded methods are:
	     * `assign`, `defaults`, `includes`, `merge`, `sortByAll`, and `sortByOrder`
	     *
	     * @static
	     * @memberOf _
	     * @alias foldl, inject
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [accumulator] The initial value.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {*} Returns the accumulated value.
	     * @example
	     *
	     * _.reduce([1, 2], function(sum, n) {
	     *   return sum + n;
	     * });
	     * // => 3
	     *
	     * _.reduce({ 'a': 1, 'b': 2 }, function(result, n, key) {
	     *   result[key] = n * 3;
	     *   return result;
	     * }, {});
	     * // => { 'a': 3, 'b': 6 } (iteration order is not guaranteed)
	     */
	    var reduce = createReduce(arrayReduce, baseEach);
	
	    /**
	     * This method is like `_.reduce` except that it iterates over elements of
	     * `collection` from right to left.
	     *
	     * @static
	     * @memberOf _
	     * @alias foldr
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [accumulator] The initial value.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {*} Returns the accumulated value.
	     * @example
	     *
	     * var array = [[0, 1], [2, 3], [4, 5]];
	     *
	     * _.reduceRight(array, function(flattened, other) {
	     *   return flattened.concat(other);
	     * }, []);
	     * // => [4, 5, 2, 3, 0, 1]
	     */
	    var reduceRight =  createReduce(arrayReduceRight, baseEachRight);
	
	    /**
	     * The opposite of `_.filter`; this method returns the elements of `collection`
	     * that `predicate` does **not** return truthy for.
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Array} Returns the new filtered array.
	     * @example
	     *
	     * _.reject([1, 2, 3, 4], function(n) {
	     *   return n % 2 == 0;
	     * });
	     * // => [1, 3]
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36, 'active': false },
	     *   { 'user': 'fred',   'age': 40, 'active': true }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.pluck(_.reject(users, { 'age': 40, 'active': true }), 'user');
	     * // => ['barney']
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.pluck(_.reject(users, 'active', false), 'user');
	     * // => ['fred']
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.reject(users, 'active'), 'user');
	     * // => ['barney']
	     */
	    function reject(collection, predicate, thisArg) {
	      var func = isArray(collection) ? arrayFilter : baseFilter;
	      predicate = getCallback(predicate, thisArg, 3);
	      return func(collection, function(value, index, collection) {
	        return !predicate(value, index, collection);
	      });
	    }
	
	    /**
	     * Gets a random element or `n` random elements from a collection.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to sample.
	     * @param {number} [n] The number of elements to sample.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {*} Returns the random sample(s).
	     * @example
	     *
	     * _.sample([1, 2, 3, 4]);
	     * // => 2
	     *
	     * _.sample([1, 2, 3, 4], 2);
	     * // => [3, 1]
	     */
	    function sample(collection, n, guard) {
	      if (guard ? isIterateeCall(collection, n, guard) : n == null) {
	        collection = toIterable(collection);
	        var length = collection.length;
	        return length > 0 ? collection[baseRandom(0, length - 1)] : undefined;
	      }
	      var result = shuffle(collection);
	      result.length = nativeMin(n < 0 ? 0 : (+n || 0), result.length);
	      return result;
	    }
	
	    /**
	     * Creates an array of shuffled values, using a version of the
	     * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to shuffle.
	     * @returns {Array} Returns the new shuffled array.
	     * @example
	     *
	     * _.shuffle([1, 2, 3, 4]);
	     * // => [4, 1, 3, 2]
	     */
	    function shuffle(collection) {
	      collection = toIterable(collection);
	
	      var index = -1,
	          length = collection.length,
	          result = Array(length);
	
	      while (++index < length) {
	        var rand = baseRandom(0, index);
	        if (index != rand) {
	          result[index] = result[rand];
	        }
	        result[rand] = collection[index];
	      }
	      return result;
	    }
	
	    /**
	     * Gets the size of `collection` by returning its length for array-like
	     * values or the number of own enumerable properties for objects.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to inspect.
	     * @returns {number} Returns the size of `collection`.
	     * @example
	     *
	     * _.size([1, 2, 3]);
	     * // => 3
	     *
	     * _.size({ 'a': 1, 'b': 2 });
	     * // => 2
	     *
	     * _.size('pebbles');
	     * // => 7
	     */
	    function size(collection) {
	      var length = collection ? collection.length : 0;
	      return isLength(length) ? length : keys(collection).length;
	    }
	
	    /**
	     * Checks if `predicate` returns truthy for **any** element of `collection`.
	     * The function returns as soon as it finds a passing value and does not iterate
	     * over the entire collection. The predicate is bound to `thisArg` and invoked
	     * with three arguments: (value, index|key, collection).
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @alias any
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {boolean} Returns `true` if any element passes the predicate check,
	     *  else `false`.
	     * @example
	     *
	     * _.some([null, 0, 'yes', false], Boolean);
	     * // => true
	     *
	     * var users = [
	     *   { 'user': 'barney', 'active': true },
	     *   { 'user': 'fred',   'active': false }
	     * ];
	     *
	     * // using the `_.matches` callback shorthand
	     * _.some(users, { 'user': 'barney', 'active': false });
	     * // => false
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.some(users, 'active', false);
	     * // => true
	     *
	     * // using the `_.property` callback shorthand
	     * _.some(users, 'active');
	     * // => true
	     */
	    function some(collection, predicate, thisArg) {
	      var func = isArray(collection) ? arraySome : baseSome;
	      if (thisArg && isIterateeCall(collection, predicate, thisArg)) {
	        predicate = null;
	      }
	      if (typeof predicate != 'function' || typeof thisArg != 'undefined') {
	        predicate = getCallback(predicate, thisArg, 3);
	      }
	      return func(collection, predicate);
	    }
	
	    /**
	     * Creates an array of elements, sorted in ascending order by the results of
	     * running each element in a collection through `iteratee`. This method performs
	     * a stable sort, that is, it preserves the original sort order of equal elements.
	     * The `iteratee` is bound to `thisArg` and invoked with three arguments:
	     * (value, index|key, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Array|Function|Object|string} [iteratee=_.identity] The function
	     *  invoked per iteration. If a property name or an object is provided it is
	     *  used to create a `_.property` or `_.matches` style callback respectively.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Array} Returns the new sorted array.
	     * @example
	     *
	     * _.sortBy([1, 2, 3], function(n) {
	     *   return Math.sin(n);
	     * });
	     * // => [3, 1, 2]
	     *
	     * _.sortBy([1, 2, 3], function(n) {
	     *   return this.sin(n);
	     * }, Math);
	     * // => [3, 1, 2]
	     *
	     * var users = [
	     *   { 'user': 'fred' },
	     *   { 'user': 'pebbles' },
	     *   { 'user': 'barney' }
	     * ];
	     *
	     * // using the `_.property` callback shorthand
	     * _.pluck(_.sortBy(users, 'user'), 'user');
	     * // => ['barney', 'fred', 'pebbles']
	     */
	    function sortBy(collection, iteratee, thisArg) {
	      if (collection == null) {
	        return [];
	      }
	      var index = -1,
	          length = collection.length,
	          result = isLength(length) ? Array(length) : [];
	
	      if (thisArg && isIterateeCall(collection, iteratee, thisArg)) {
	        iteratee = null;
	      }
	      iteratee = getCallback(iteratee, thisArg, 3);
	      baseEach(collection, function(value, key, collection) {
	        result[++index] = { 'criteria': iteratee(value, key, collection), 'index': index, 'value': value };
	      });
	      return baseSortBy(result, compareAscending);
	    }
	
	    /**
	     * This method is like `_.sortBy` except that it sorts by property names
	     * instead of an iteratee function.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {...(string|string[])} props The property names to sort by,
	     *  specified as individual property names or arrays of property names.
	     * @returns {Array} Returns the new sorted array.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 40 },
	     *   { 'user': 'barney', 'age': 26 },
	     *   { 'user': 'fred',   'age': 30 }
	     * ];
	     *
	     * _.map(_.sortByAll(users, ['user', 'age']), _.values);
	     * // => [['barney', 26], ['barney', 36], ['fred', 30], ['fred', 40]]
	     */
	    function sortByAll() {
	      var args = arguments,
	          collection = args[0],
	          guard = args[3],
	          index = 0,
	          length = args.length - 1;
	
	      if (collection == null) {
	        return [];
	      }
	      var props = Array(length);
	      while (index < length) {
	        props[index] = args[++index];
	      }
	      if (guard && isIterateeCall(args[1], args[2], guard)) {
	        props = args[1];
	      }
	      return baseSortByOrder(collection, baseFlatten(props), []);
	    }
	
	    /**
	     * This method is like `_.sortByAll` except that it allows specifying the
	     * sort orders of the property names to sort by. A truthy value in `orders`
	     * will sort the corresponding property name in ascending order while a
	     * falsey value will sort it in descending order.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {string[]} props The property names to sort by.
	     * @param {boolean[]} orders The sort orders of `props`.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.reduce`.
	     * @returns {Array} Returns the new sorted array.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 26 },
	     *   { 'user': 'fred',   'age': 40 },
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 30 }
	     * ];
	     *
	     * // sort by `user` in ascending order and by `age` in descending order
	     * _.map(_.sortByOrder(users, ['user', 'age'], [true, false]), _.values);
	     * // => [['barney', 36], ['barney', 26], ['fred', 40], ['fred', 30]]
	     */
	    function sortByOrder(collection, props, orders, guard) {
	      if (collection == null) {
	        return [];
	      }
	      if (guard && isIterateeCall(props, orders, guard)) {
	        orders = null;
	      }
	      if (!isArray(props)) {
	        props = props == null ? [] : [props];
	      }
	      if (!isArray(orders)) {
	        orders = orders == null ? [] : [orders];
	      }
	      return baseSortByOrder(collection, props, orders);
	    }
	
	    /**
	     * Performs a deep comparison between each element in `collection` and the
	     * source object, returning an array of all elements that have equivalent
	     * property values.
	     *
	     * **Note:** This method supports comparing arrays, booleans, `Date` objects,
	     * numbers, `Object` objects, regexes, and strings. Objects are compared by
	     * their own, not inherited, enumerable properties. For comparing a single
	     * own or inherited property value see `_.matchesProperty`.
	     *
	     * @static
	     * @memberOf _
	     * @category Collection
	     * @param {Array|Object|string} collection The collection to search.
	     * @param {Object} source The object of property values to match.
	     * @returns {Array} Returns the new filtered array.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36, 'active': false, 'pets': ['hoppy'] },
	     *   { 'user': 'fred',   'age': 40, 'active': true, 'pets': ['baby puss', 'dino'] }
	     * ];
	     *
	     * _.pluck(_.where(users, { 'age': 36, 'active': false }), 'user');
	     * // => ['barney']
	     *
	     * _.pluck(_.where(users, { 'pets': ['dino'] }), 'user');
	     * // => ['fred']
	     */
	    function where(collection, source) {
	      return filter(collection, baseMatches(source));
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Gets the number of milliseconds that have elapsed since the Unix epoch
	     * (1 January 1970 00:00:00 UTC).
	     *
	     * @static
	     * @memberOf _
	     * @category Date
	     * @example
	     *
	     * _.defer(function(stamp) {
	     *   console.log(_.now() - stamp);
	     * }, _.now());
	     * // => logs the number of milliseconds it took for the deferred function to be invoked
	     */
	    var now = nativeNow || function() {
	      return new Date().getTime();
	    };
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * The opposite of `_.before`; this method creates a function that invokes
	     * `func` once it is called `n` or more times.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {number} n The number of calls before `func` is invoked.
	     * @param {Function} func The function to restrict.
	     * @returns {Function} Returns the new restricted function.
	     * @example
	     *
	     * var saves = ['profile', 'settings'];
	     *
	     * var done = _.after(saves.length, function() {
	     *   console.log('done saving!');
	     * });
	     *
	     * _.forEach(saves, function(type) {
	     *   asyncSave({ 'type': type, 'complete': done });
	     * });
	     * // => logs 'done saving!' after the two async saves have completed
	     */
	    function after(n, func) {
	      if (typeof func != 'function') {
	        if (typeof n == 'function') {
	          var temp = n;
	          n = func;
	          func = temp;
	        } else {
	          throw new TypeError(FUNC_ERROR_TEXT);
	        }
	      }
	      n = nativeIsFinite(n = +n) ? n : 0;
	      return function() {
	        if (--n < 1) {
	          return func.apply(this, arguments);
	        }
	      };
	    }
	
	    /**
	     * Creates a function that accepts up to `n` arguments ignoring any
	     * additional arguments.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to cap arguments for.
	     * @param {number} [n=func.length] The arity cap.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * _.map(['6', '8', '10'], _.ary(parseInt, 1));
	     * // => [6, 8, 10]
	     */
	    function ary(func, n, guard) {
	      if (guard && isIterateeCall(func, n, guard)) {
	        n = null;
	      }
	      n = (func && n == null) ? func.length : nativeMax(+n || 0, 0);
	      return createWrapper(func, ARY_FLAG, null, null, null, null, n);
	    }
	
	    /**
	     * Creates a function that invokes `func`, with the `this` binding and arguments
	     * of the created function, while it is called less than `n` times. Subsequent
	     * calls to the created function return the result of the last `func` invocation.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {number} n The number of calls at which `func` is no longer invoked.
	     * @param {Function} func The function to restrict.
	     * @returns {Function} Returns the new restricted function.
	     * @example
	     *
	     * jQuery('#add').on('click', _.before(5, addContactToList));
	     * // => allows adding up to 4 contacts to the list
	     */
	    function before(n, func) {
	      var result;
	      if (typeof func != 'function') {
	        if (typeof n == 'function') {
	          var temp = n;
	          n = func;
	          func = temp;
	        } else {
	          throw new TypeError(FUNC_ERROR_TEXT);
	        }
	      }
	      return function() {
	        if (--n > 0) {
	          result = func.apply(this, arguments);
	        } else {
	          func = null;
	        }
	        return result;
	      };
	    }
	
	    /**
	     * Creates a function that invokes `func` with the `this` binding of `thisArg`
	     * and prepends any additional `_.bind` arguments to those provided to the
	     * bound function.
	     *
	     * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,
	     * may be used as a placeholder for partially applied arguments.
	     *
	     * **Note:** Unlike native `Function#bind` this method does not set the `length`
	     * property of bound functions.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to bind.
	     * @param {*} thisArg The `this` binding of `func`.
	     * @param {...*} [partials] The arguments to be partially applied.
	     * @returns {Function} Returns the new bound function.
	     * @example
	     *
	     * var greet = function(greeting, punctuation) {
	     *   return greeting + ' ' + this.user + punctuation;
	     * };
	     *
	     * var object = { 'user': 'fred' };
	     *
	     * var bound = _.bind(greet, object, 'hi');
	     * bound('!');
	     * // => 'hi fred!'
	     *
	     * // using placeholders
	     * var bound = _.bind(greet, object, _, '!');
	     * bound('hi');
	     * // => 'hi fred!'
	     */
	    var bind = restParam(function(func, thisArg, partials) {
	      var bitmask = BIND_FLAG;
	      if (partials.length) {
	        var holders = replaceHolders(partials, bind.placeholder);
	        bitmask |= PARTIAL_FLAG;
	      }
	      return createWrapper(func, bitmask, thisArg, partials, holders);
	    });
	
	    /**
	     * Binds methods of an object to the object itself, overwriting the existing
	     * method. Method names may be specified as individual arguments or as arrays
	     * of method names. If no method names are provided all enumerable function
	     * properties, own and inherited, of `object` are bound.
	     *
	     * **Note:** This method does not set the `length` property of bound functions.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Object} object The object to bind and assign the bound methods to.
	     * @param {...(string|string[])} [methodNames] The object method names to bind,
	     *  specified as individual method names or arrays of method names.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * var view = {
	     *   'label': 'docs',
	     *   'onClick': function() {
	     *     console.log('clicked ' + this.label);
	     *   }
	     * };
	     *
	     * _.bindAll(view);
	     * jQuery('#docs').on('click', view.onClick);
	     * // => logs 'clicked docs' when the element is clicked
	     */
	    var bindAll = restParam(function(object, methodNames) {
	      methodNames = methodNames.length ? baseFlatten(methodNames) : functions(object);
	
	      var index = -1,
	          length = methodNames.length;
	
	      while (++index < length) {
	        var key = methodNames[index];
	        object[key] = createWrapper(object[key], BIND_FLAG, object);
	      }
	      return object;
	    });
	
	    /**
	     * Creates a function that invokes the method at `object[key]` and prepends
	     * any additional `_.bindKey` arguments to those provided to the bound function.
	     *
	     * This method differs from `_.bind` by allowing bound functions to reference
	     * methods that may be redefined or don't yet exist.
	     * See [Peter Michaux's article](http://michaux.ca/articles/lazy-function-definition-pattern)
	     * for more details.
	     *
	     * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic
	     * builds, may be used as a placeholder for partially applied arguments.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Object} object The object the method belongs to.
	     * @param {string} key The key of the method.
	     * @param {...*} [partials] The arguments to be partially applied.
	     * @returns {Function} Returns the new bound function.
	     * @example
	     *
	     * var object = {
	     *   'user': 'fred',
	     *   'greet': function(greeting, punctuation) {
	     *     return greeting + ' ' + this.user + punctuation;
	     *   }
	     * };
	     *
	     * var bound = _.bindKey(object, 'greet', 'hi');
	     * bound('!');
	     * // => 'hi fred!'
	     *
	     * object.greet = function(greeting, punctuation) {
	     *   return greeting + 'ya ' + this.user + punctuation;
	     * };
	     *
	     * bound('!');
	     * // => 'hiya fred!'
	     *
	     * // using placeholders
	     * var bound = _.bindKey(object, 'greet', _, '!');
	     * bound('hi');
	     * // => 'hiya fred!'
	     */
	    var bindKey = restParam(function(object, key, partials) {
	      var bitmask = BIND_FLAG | BIND_KEY_FLAG;
	      if (partials.length) {
	        var holders = replaceHolders(partials, bindKey.placeholder);
	        bitmask |= PARTIAL_FLAG;
	      }
	      return createWrapper(key, bitmask, object, partials, holders);
	    });
	
	    /**
	     * Creates a function that accepts one or more arguments of `func` that when
	     * called either invokes `func` returning its result, if all `func` arguments
	     * have been provided, or returns a function that accepts one or more of the
	     * remaining `func` arguments, and so on. The arity of `func` may be specified
	     * if `func.length` is not sufficient.
	     *
	     * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,
	     * may be used as a placeholder for provided arguments.
	     *
	     * **Note:** This method does not set the `length` property of curried functions.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to curry.
	     * @param {number} [arity=func.length] The arity of `func`.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Function} Returns the new curried function.
	     * @example
	     *
	     * var abc = function(a, b, c) {
	     *   return [a, b, c];
	     * };
	     *
	     * var curried = _.curry(abc);
	     *
	     * curried(1)(2)(3);
	     * // => [1, 2, 3]
	     *
	     * curried(1, 2)(3);
	     * // => [1, 2, 3]
	     *
	     * curried(1, 2, 3);
	     * // => [1, 2, 3]
	     *
	     * // using placeholders
	     * curried(1)(_, 3)(2);
	     * // => [1, 2, 3]
	     */
	    var curry = createCurry(CURRY_FLAG);
	
	    /**
	     * This method is like `_.curry` except that arguments are applied to `func`
	     * in the manner of `_.partialRight` instead of `_.partial`.
	     *
	     * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic
	     * builds, may be used as a placeholder for provided arguments.
	     *
	     * **Note:** This method does not set the `length` property of curried functions.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to curry.
	     * @param {number} [arity=func.length] The arity of `func`.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Function} Returns the new curried function.
	     * @example
	     *
	     * var abc = function(a, b, c) {
	     *   return [a, b, c];
	     * };
	     *
	     * var curried = _.curryRight(abc);
	     *
	     * curried(3)(2)(1);
	     * // => [1, 2, 3]
	     *
	     * curried(2, 3)(1);
	     * // => [1, 2, 3]
	     *
	     * curried(1, 2, 3);
	     * // => [1, 2, 3]
	     *
	     * // using placeholders
	     * curried(3)(1, _)(2);
	     * // => [1, 2, 3]
	     */
	    var curryRight = createCurry(CURRY_RIGHT_FLAG);
	
	    /**
	     * Creates a function that delays invoking `func` until after `wait` milliseconds
	     * have elapsed since the last time it was invoked. The created function comes
	     * with a `cancel` method to cancel delayed invocations. Provide an options
	     * object to indicate that `func` should be invoked on the leading and/or
	     * trailing edge of the `wait` timeout. Subsequent calls to the debounced
	     * function return the result of the last `func` invocation.
	     *
	     * **Note:** If `leading` and `trailing` options are `true`, `func` is invoked
	     * on the trailing edge of the timeout only if the the debounced function is
	     * invoked more than once during the `wait` timeout.
	     *
	     * See [David Corbacho's article](http://drupalmotion.com/article/debounce-and-throttle-visual-explanation)
	     * for details over the differences between `_.debounce` and `_.throttle`.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to debounce.
	     * @param {number} [wait=0] The number of milliseconds to delay.
	     * @param {Object} [options] The options object.
	     * @param {boolean} [options.leading=false] Specify invoking on the leading
	     *  edge of the timeout.
	     * @param {number} [options.maxWait] The maximum time `func` is allowed to be
	     *  delayed before it is invoked.
	     * @param {boolean} [options.trailing=true] Specify invoking on the trailing
	     *  edge of the timeout.
	     * @returns {Function} Returns the new debounced function.
	     * @example
	     *
	     * // avoid costly calculations while the window size is in flux
	     * jQuery(window).on('resize', _.debounce(calculateLayout, 150));
	     *
	     * // invoke `sendMail` when the click event is fired, debouncing subsequent calls
	     * jQuery('#postbox').on('click', _.debounce(sendMail, 300, {
	     *   'leading': true,
	     *   'trailing': false
	     * }));
	     *
	     * // ensure `batchLog` is invoked once after 1 second of debounced calls
	     * var source = new EventSource('/stream');
	     * jQuery(source).on('message', _.debounce(batchLog, 250, {
	     *   'maxWait': 1000
	     * }));
	     *
	     * // cancel a debounced call
	     * var todoChanges = _.debounce(batchLog, 1000);
	     * Object.observe(models.todo, todoChanges);
	     *
	     * Object.observe(models, function(changes) {
	     *   if (_.find(changes, { 'user': 'todo', 'type': 'delete'})) {
	     *     todoChanges.cancel();
	     *   }
	     * }, ['delete']);
	     *
	     * // ...at some point `models.todo` is changed
	     * models.todo.completed = true;
	     *
	     * // ...before 1 second has passed `models.todo` is deleted
	     * // which cancels the debounced `todoChanges` call
	     * delete models.todo;
	     */
	    function debounce(func, wait, options) {
	      var args,
	          maxTimeoutId,
	          result,
	          stamp,
	          thisArg,
	          timeoutId,
	          trailingCall,
	          lastCalled = 0,
	          maxWait = false,
	          trailing = true;
	
	      if (typeof func != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      wait = wait < 0 ? 0 : (+wait || 0);
	      if (options === true) {
	        var leading = true;
	        trailing = false;
	      } else if (isObject(options)) {
	        leading = options.leading;
	        maxWait = 'maxWait' in options && nativeMax(+options.maxWait || 0, wait);
	        trailing = 'trailing' in options ? options.trailing : trailing;
	      }
	
	      function cancel() {
	        if (timeoutId) {
	          clearTimeout(timeoutId);
	        }
	        if (maxTimeoutId) {
	          clearTimeout(maxTimeoutId);
	        }
	        maxTimeoutId = timeoutId = trailingCall = undefined;
	      }
	
	      function delayed() {
	        var remaining = wait - (now() - stamp);
	        if (remaining <= 0 || remaining > wait) {
	          if (maxTimeoutId) {
	            clearTimeout(maxTimeoutId);
	          }
	          var isCalled = trailingCall;
	          maxTimeoutId = timeoutId = trailingCall = undefined;
	          if (isCalled) {
	            lastCalled = now();
	            result = func.apply(thisArg, args);
	            if (!timeoutId && !maxTimeoutId) {
	              args = thisArg = null;
	            }
	          }
	        } else {
	          timeoutId = setTimeout(delayed, remaining);
	        }
	      }
	
	      function maxDelayed() {
	        if (timeoutId) {
	          clearTimeout(timeoutId);
	        }
	        maxTimeoutId = timeoutId = trailingCall = undefined;
	        if (trailing || (maxWait !== wait)) {
	          lastCalled = now();
	          result = func.apply(thisArg, args);
	          if (!timeoutId && !maxTimeoutId) {
	            args = thisArg = null;
	          }
	        }
	      }
	
	      function debounced() {
	        args = arguments;
	        stamp = now();
	        thisArg = this;
	        trailingCall = trailing && (timeoutId || !leading);
	
	        if (maxWait === false) {
	          var leadingCall = leading && !timeoutId;
	        } else {
	          if (!maxTimeoutId && !leading) {
	            lastCalled = stamp;
	          }
	          var remaining = maxWait - (stamp - lastCalled),
	              isCalled = remaining <= 0 || remaining > maxWait;
	
	          if (isCalled) {
	            if (maxTimeoutId) {
	              maxTimeoutId = clearTimeout(maxTimeoutId);
	            }
	            lastCalled = stamp;
	            result = func.apply(thisArg, args);
	          }
	          else if (!maxTimeoutId) {
	            maxTimeoutId = setTimeout(maxDelayed, remaining);
	          }
	        }
	        if (isCalled && timeoutId) {
	          timeoutId = clearTimeout(timeoutId);
	        }
	        else if (!timeoutId && wait !== maxWait) {
	          timeoutId = setTimeout(delayed, wait);
	        }
	        if (leadingCall) {
	          isCalled = true;
	          result = func.apply(thisArg, args);
	        }
	        if (isCalled && !timeoutId && !maxTimeoutId) {
	          args = thisArg = null;
	        }
	        return result;
	      }
	      debounced.cancel = cancel;
	      return debounced;
	    }
	
	    /**
	     * Defers invoking the `func` until the current call stack has cleared. Any
	     * additional arguments are provided to `func` when it is invoked.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to defer.
	     * @param {...*} [args] The arguments to invoke the function with.
	     * @returns {number} Returns the timer id.
	     * @example
	     *
	     * _.defer(function(text) {
	     *   console.log(text);
	     * }, 'deferred');
	     * // logs 'deferred' after one or more milliseconds
	     */
	    var defer = restParam(function(func, args) {
	      return baseDelay(func, 1, args);
	    });
	
	    /**
	     * Invokes `func` after `wait` milliseconds. Any additional arguments are
	     * provided to `func` when it is invoked.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to delay.
	     * @param {number} wait The number of milliseconds to delay invocation.
	     * @param {...*} [args] The arguments to invoke the function with.
	     * @returns {number} Returns the timer id.
	     * @example
	     *
	     * _.delay(function(text) {
	     *   console.log(text);
	     * }, 1000, 'later');
	     * // => logs 'later' after one second
	     */
	    var delay = restParam(function(func, wait, args) {
	      return baseDelay(func, wait, args);
	    });
	
	    /**
	     * Creates a function that returns the result of invoking the provided
	     * functions with the `this` binding of the created function, where each
	     * successive invocation is supplied the return value of the previous.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {...Function} [funcs] Functions to invoke.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * function square(n) {
	     *   return n * n;
	     * }
	     *
	     * var addSquare = _.flow(_.add, square);
	     * addSquare(1, 2);
	     * // => 9
	     */
	    var flow = createFlow();
	
	    /**
	     * This method is like `_.flow` except that it creates a function that
	     * invokes the provided functions from right to left.
	     *
	     * @static
	     * @memberOf _
	     * @alias backflow, compose
	     * @category Function
	     * @param {...Function} [funcs] Functions to invoke.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * function square(n) {
	     *   return n * n;
	     * }
	     *
	     * var addSquare = _.flowRight(square, _.add);
	     * addSquare(1, 2);
	     * // => 9
	     */
	    var flowRight = createFlow(true);
	
	    /**
	     * Creates a function that memoizes the result of `func`. If `resolver` is
	     * provided it determines the cache key for storing the result based on the
	     * arguments provided to the memoized function. By default, the first argument
	     * provided to the memoized function is coerced to a string and used as the
	     * cache key. The `func` is invoked with the `this` binding of the memoized
	     * function.
	     *
	     * **Note:** The cache is exposed as the `cache` property on the memoized
	     * function. Its creation may be customized by replacing the `_.memoize.Cache`
	     * constructor with one whose instances implement the [`Map`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-properties-of-the-map-prototype-object)
	     * method interface of `get`, `has`, and `set`.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to have its output memoized.
	     * @param {Function} [resolver] The function to resolve the cache key.
	     * @returns {Function} Returns the new memoizing function.
	     * @example
	     *
	     * var upperCase = _.memoize(function(string) {
	     *   return string.toUpperCase();
	     * });
	     *
	     * upperCase('fred');
	     * // => 'FRED'
	     *
	     * // modifying the result cache
	     * upperCase.cache.set('fred', 'BARNEY');
	     * upperCase('fred');
	     * // => 'BARNEY'
	     *
	     * // replacing `_.memoize.Cache`
	     * var object = { 'user': 'fred' };
	     * var other = { 'user': 'barney' };
	     * var identity = _.memoize(_.identity);
	     *
	     * identity(object);
	     * // => { 'user': 'fred' }
	     * identity(other);
	     * // => { 'user': 'fred' }
	     *
	     * _.memoize.Cache = WeakMap;
	     * var identity = _.memoize(_.identity);
	     *
	     * identity(object);
	     * // => { 'user': 'fred' }
	     * identity(other);
	     * // => { 'user': 'barney' }
	     */
	    function memoize(func, resolver) {
	      if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      var memoized = function() {
	        var args = arguments,
	            cache = memoized.cache,
	            key = resolver ? resolver.apply(this, args) : args[0];
	
	        if (cache.has(key)) {
	          return cache.get(key);
	        }
	        var result = func.apply(this, args);
	        cache.set(key, result);
	        return result;
	      };
	      memoized.cache = new memoize.Cache;
	      return memoized;
	    }
	
	    /**
	     * Creates a function that negates the result of the predicate `func`. The
	     * `func` predicate is invoked with the `this` binding and arguments of the
	     * created function.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} predicate The predicate to negate.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * function isEven(n) {
	     *   return n % 2 == 0;
	     * }
	     *
	     * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));
	     * // => [1, 3, 5]
	     */
	    function negate(predicate) {
	      if (typeof predicate != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      return function() {
	        return !predicate.apply(this, arguments);
	      };
	    }
	
	    /**
	     * Creates a function that is restricted to invoking `func` once. Repeat calls
	     * to the function return the value of the first call. The `func` is invoked
	     * with the `this` binding and arguments of the created function.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to restrict.
	     * @returns {Function} Returns the new restricted function.
	     * @example
	     *
	     * var initialize = _.once(createApplication);
	     * initialize();
	     * initialize();
	     * // `initialize` invokes `createApplication` once
	     */
	    function once(func) {
	      return before(func, 2);
	    }
	
	    /**
	     * Creates a function that invokes `func` with `partial` arguments prepended
	     * to those provided to the new function. This method is like `_.bind` except
	     * it does **not** alter the `this` binding.
	     *
	     * The `_.partial.placeholder` value, which defaults to `_` in monolithic
	     * builds, may be used as a placeholder for partially applied arguments.
	     *
	     * **Note:** This method does not set the `length` property of partially
	     * applied functions.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to partially apply arguments to.
	     * @param {...*} [partials] The arguments to be partially applied.
	     * @returns {Function} Returns the new partially applied function.
	     * @example
	     *
	     * var greet = function(greeting, name) {
	     *   return greeting + ' ' + name;
	     * };
	     *
	     * var sayHelloTo = _.partial(greet, 'hello');
	     * sayHelloTo('fred');
	     * // => 'hello fred'
	     *
	     * // using placeholders
	     * var greetFred = _.partial(greet, _, 'fred');
	     * greetFred('hi');
	     * // => 'hi fred'
	     */
	    var partial = createPartial(PARTIAL_FLAG);
	
	    /**
	     * This method is like `_.partial` except that partially applied arguments
	     * are appended to those provided to the new function.
	     *
	     * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic
	     * builds, may be used as a placeholder for partially applied arguments.
	     *
	     * **Note:** This method does not set the `length` property of partially
	     * applied functions.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to partially apply arguments to.
	     * @param {...*} [partials] The arguments to be partially applied.
	     * @returns {Function} Returns the new partially applied function.
	     * @example
	     *
	     * var greet = function(greeting, name) {
	     *   return greeting + ' ' + name;
	     * };
	     *
	     * var greetFred = _.partialRight(greet, 'fred');
	     * greetFred('hi');
	     * // => 'hi fred'
	     *
	     * // using placeholders
	     * var sayHelloTo = _.partialRight(greet, 'hello', _);
	     * sayHelloTo('fred');
	     * // => 'hello fred'
	     */
	    var partialRight = createPartial(PARTIAL_RIGHT_FLAG);
	
	    /**
	     * Creates a function that invokes `func` with arguments arranged according
	     * to the specified indexes where the argument value at the first index is
	     * provided as the first argument, the argument value at the second index is
	     * provided as the second argument, and so on.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to rearrange arguments for.
	     * @param {...(number|number[])} indexes The arranged argument indexes,
	     *  specified as individual indexes or arrays of indexes.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var rearged = _.rearg(function(a, b, c) {
	     *   return [a, b, c];
	     * }, 2, 0, 1);
	     *
	     * rearged('b', 'c', 'a')
	     * // => ['a', 'b', 'c']
	     *
	     * var map = _.rearg(_.map, [1, 0]);
	     * map(function(n) {
	     *   return n * 3;
	     * }, [1, 2, 3]);
	     * // => [3, 6, 9]
	     */
	    var rearg = restParam(function(func, indexes) {
	      return createWrapper(func, REARG_FLAG, null, null, null, baseFlatten(indexes));
	    });
	
	    /**
	     * Creates a function that invokes `func` with the `this` binding of the
	     * created function and arguments from `start` and beyond provided as an array.
	     *
	     * **Note:** This method is based on the [rest parameter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters).
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to apply a rest parameter to.
	     * @param {number} [start=func.length-1] The start position of the rest parameter.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var say = _.restParam(function(what, names) {
	     *   return what + ' ' + _.initial(names).join(', ') +
	     *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);
	     * });
	     *
	     * say('hello', 'fred', 'barney', 'pebbles');
	     * // => 'hello fred, barney, & pebbles'
	     */
	    function restParam(func, start) {
	      if (typeof func != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      start = nativeMax(typeof start == 'undefined' ? (func.length - 1) : (+start || 0), 0);
	      return function() {
	        var args = arguments,
	            index = -1,
	            length = nativeMax(args.length - start, 0),
	            rest = Array(length);
	
	        while (++index < length) {
	          rest[index] = args[start + index];
	        }
	        switch (start) {
	          case 0: return func.call(this, rest);
	          case 1: return func.call(this, args[0], rest);
	          case 2: return func.call(this, args[0], args[1], rest);
	        }
	        var otherArgs = Array(start + 1);
	        index = -1;
	        while (++index < start) {
	          otherArgs[index] = args[index];
	        }
	        otherArgs[start] = rest;
	        return func.apply(this, otherArgs);
	      };
	    }
	
	    /**
	     * Creates a function that invokes `func` with the `this` binding of the created
	     * function and an array of arguments much like [`Function#apply`](https://es5.github.io/#x15.3.4.3).
	     *
	     * **Note:** This method is based on the [spread operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator).
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to spread arguments over.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var say = _.spread(function(who, what) {
	     *   return who + ' says ' + what;
	     * });
	     *
	     * say(['fred', 'hello']);
	     * // => 'fred says hello'
	     *
	     * // with a Promise
	     * var numbers = Promise.all([
	     *   Promise.resolve(40),
	     *   Promise.resolve(36)
	     * ]);
	     *
	     * numbers.then(_.spread(function(x, y) {
	     *   return x + y;
	     * }));
	     * // => a Promise of 76
	     */
	    function spread(func) {
	      if (typeof func != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      return function(array) {
	        return func.apply(this, array);
	      };
	    }
	
	    /**
	     * Creates a function that only invokes `func` at most once per every `wait`
	     * milliseconds. The created function comes with a `cancel` method to cancel
	     * delayed invocations. Provide an options object to indicate that `func`
	     * should be invoked on the leading and/or trailing edge of the `wait` timeout.
	     * Subsequent calls to the throttled function return the result of the last
	     * `func` call.
	     *
	     * **Note:** If `leading` and `trailing` options are `true`, `func` is invoked
	     * on the trailing edge of the timeout only if the the throttled function is
	     * invoked more than once during the `wait` timeout.
	     *
	     * See [David Corbacho's article](http://drupalmotion.com/article/debounce-and-throttle-visual-explanation)
	     * for details over the differences between `_.throttle` and `_.debounce`.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {Function} func The function to throttle.
	     * @param {number} [wait=0] The number of milliseconds to throttle invocations to.
	     * @param {Object} [options] The options object.
	     * @param {boolean} [options.leading=true] Specify invoking on the leading
	     *  edge of the timeout.
	     * @param {boolean} [options.trailing=true] Specify invoking on the trailing
	     *  edge of the timeout.
	     * @returns {Function} Returns the new throttled function.
	     * @example
	     *
	     * // avoid excessively updating the position while scrolling
	     * jQuery(window).on('scroll', _.throttle(updatePosition, 100));
	     *
	     * // invoke `renewToken` when the click event is fired, but not more than once every 5 minutes
	     * jQuery('.interactive').on('click', _.throttle(renewToken, 300000, {
	     *   'trailing': false
	     * }));
	     *
	     * // cancel a trailing throttled call
	     * jQuery(window).on('popstate', throttled.cancel);
	     */
	    function throttle(func, wait, options) {
	      var leading = true,
	          trailing = true;
	
	      if (typeof func != 'function') {
	        throw new TypeError(FUNC_ERROR_TEXT);
	      }
	      if (options === false) {
	        leading = false;
	      } else if (isObject(options)) {
	        leading = 'leading' in options ? !!options.leading : leading;
	        trailing = 'trailing' in options ? !!options.trailing : trailing;
	      }
	      debounceOptions.leading = leading;
	      debounceOptions.maxWait = +wait;
	      debounceOptions.trailing = trailing;
	      return debounce(func, wait, debounceOptions);
	    }
	
	    /**
	     * Creates a function that provides `value` to the wrapper function as its
	     * first argument. Any additional arguments provided to the function are
	     * appended to those provided to the wrapper function. The wrapper is invoked
	     * with the `this` binding of the created function.
	     *
	     * @static
	     * @memberOf _
	     * @category Function
	     * @param {*} value The value to wrap.
	     * @param {Function} wrapper The wrapper function.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var p = _.wrap(_.escape, function(func, text) {
	     *   return '<p>' + func(text) + '</p>';
	     * });
	     *
	     * p('fred, barney, & pebbles');
	     * // => '<p>fred, barney, &amp; pebbles</p>'
	     */
	    function wrap(value, wrapper) {
	      wrapper = wrapper == null ? identity : wrapper;
	      return createWrapper(wrapper, PARTIAL_FLAG, null, [value], []);
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Creates a clone of `value`. If `isDeep` is `true` nested objects are cloned,
	     * otherwise they are assigned by reference. If `customizer` is provided it is
	     * invoked to produce the cloned values. If `customizer` returns `undefined`
	     * cloning is handled by the method instead. The `customizer` is bound to
	     * `thisArg` and invoked with two argument; (value [, index|key, object]).
	     *
	     * **Note:** This method is loosely based on the
	     * [structured clone algorithm](http://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm).
	     * The enumerable properties of `arguments` objects and objects created by
	     * constructors other than `Object` are cloned to plain `Object` objects. An
	     * empty object is returned for uncloneable values such as functions, DOM nodes,
	     * Maps, Sets, and WeakMaps.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to clone.
	     * @param {boolean} [isDeep] Specify a deep clone.
	     * @param {Function} [customizer] The function to customize cloning values.
	     * @param {*} [thisArg] The `this` binding of `customizer`.
	     * @returns {*} Returns the cloned value.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney' },
	     *   { 'user': 'fred' }
	     * ];
	     *
	     * var shallow = _.clone(users);
	     * shallow[0] === users[0];
	     * // => true
	     *
	     * var deep = _.clone(users, true);
	     * deep[0] === users[0];
	     * // => false
	     *
	     * // using a customizer callback
	     * var el = _.clone(document.body, function(value) {
	     *   if (_.isElement(value)) {
	     *     return value.cloneNode(false);
	     *   }
	     * });
	     *
	     * el === document.body
	     * // => false
	     * el.nodeName
	     * // => BODY
	     * el.childNodes.length;
	     * // => 0
	     */
	    function clone(value, isDeep, customizer, thisArg) {
	      if (isDeep && typeof isDeep != 'boolean' && isIterateeCall(value, isDeep, customizer)) {
	        isDeep = false;
	      }
	      else if (typeof isDeep == 'function') {
	        thisArg = customizer;
	        customizer = isDeep;
	        isDeep = false;
	      }
	      customizer = typeof customizer == 'function' && bindCallback(customizer, thisArg, 1);
	      return baseClone(value, isDeep, customizer);
	    }
	
	    /**
	     * Creates a deep clone of `value`. If `customizer` is provided it is invoked
	     * to produce the cloned values. If `customizer` returns `undefined` cloning
	     * is handled by the method instead. The `customizer` is bound to `thisArg`
	     * and invoked with two argument; (value [, index|key, object]).
	     *
	     * **Note:** This method is loosely based on the
	     * [structured clone algorithm](http://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm).
	     * The enumerable properties of `arguments` objects and objects created by
	     * constructors other than `Object` are cloned to plain `Object` objects. An
	     * empty object is returned for uncloneable values such as functions, DOM nodes,
	     * Maps, Sets, and WeakMaps.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to deep clone.
	     * @param {Function} [customizer] The function to customize cloning values.
	     * @param {*} [thisArg] The `this` binding of `customizer`.
	     * @returns {*} Returns the deep cloned value.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney' },
	     *   { 'user': 'fred' }
	     * ];
	     *
	     * var deep = _.cloneDeep(users);
	     * deep[0] === users[0];
	     * // => false
	     *
	     * // using a customizer callback
	     * var el = _.cloneDeep(document.body, function(value) {
	     *   if (_.isElement(value)) {
	     *     return value.cloneNode(true);
	     *   }
	     * });
	     *
	     * el === document.body
	     * // => false
	     * el.nodeName
	     * // => BODY
	     * el.childNodes.length;
	     * // => 20
	     */
	    function cloneDeep(value, customizer, thisArg) {
	      customizer = typeof customizer == 'function' && bindCallback(customizer, thisArg, 1);
	      return baseClone(value, true, customizer);
	    }
	
	    /**
	     * Checks if `value` is classified as an `arguments` object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isArguments(function() { return arguments; }());
	     * // => true
	     *
	     * _.isArguments([1, 2, 3]);
	     * // => false
	     */
	    function isArguments(value) {
	      var length = isObjectLike(value) ? value.length : undefined;
	      return isLength(length) && objToString.call(value) == argsTag;
	    }
	
	    /**
	     * Checks if `value` is classified as an `Array` object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isArray([1, 2, 3]);
	     * // => true
	     *
	     * _.isArray(function() { return arguments; }());
	     * // => false
	     */
	    var isArray = nativeIsArray || function(value) {
	      return isObjectLike(value) && isLength(value.length) && objToString.call(value) == arrayTag;
	    };
	
	    /**
	     * Checks if `value` is classified as a boolean primitive or object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isBoolean(false);
	     * // => true
	     *
	     * _.isBoolean(null);
	     * // => false
	     */
	    function isBoolean(value) {
	      return value === true || value === false || (isObjectLike(value) && objToString.call(value) == boolTag);
	    }
	
	    /**
	     * Checks if `value` is classified as a `Date` object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isDate(new Date);
	     * // => true
	     *
	     * _.isDate('Mon April 23 2012');
	     * // => false
	     */
	    function isDate(value) {
	      return isObjectLike(value) && objToString.call(value) == dateTag;
	    }
	
	    /**
	     * Checks if `value` is a DOM element.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.
	     * @example
	     *
	     * _.isElement(document.body);
	     * // => true
	     *
	     * _.isElement('<body>');
	     * // => false
	     */
	    function isElement(value) {
	      return !!value && value.nodeType === 1 && isObjectLike(value) &&
	        (objToString.call(value).indexOf('Element') > -1);
	    }
	    // Fallback for environments without DOM support.
	    if (!support.dom) {
	      isElement = function(value) {
	        return !!value && value.nodeType === 1 && isObjectLike(value) && !isPlainObject(value);
	      };
	    }
	
	    /**
	     * Checks if `value` is empty. A value is considered empty unless it is an
	     * `arguments` object, array, string, or jQuery-like collection with a length
	     * greater than `0` or an object with own enumerable properties.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {Array|Object|string} value The value to inspect.
	     * @returns {boolean} Returns `true` if `value` is empty, else `false`.
	     * @example
	     *
	     * _.isEmpty(null);
	     * // => true
	     *
	     * _.isEmpty(true);
	     * // => true
	     *
	     * _.isEmpty(1);
	     * // => true
	     *
	     * _.isEmpty([1, 2, 3]);
	     * // => false
	     *
	     * _.isEmpty({ 'a': 1 });
	     * // => false
	     */
	    function isEmpty(value) {
	      if (value == null) {
	        return true;
	      }
	      var length = value.length;
	      if (isLength(length) && (isArray(value) || isString(value) || isArguments(value) ||
	          (isObjectLike(value) && isFunction(value.splice)))) {
	        return !length;
	      }
	      return !keys(value).length;
	    }
	
	    /**
	     * Performs a deep comparison between two values to determine if they are
	     * equivalent. If `customizer` is provided it is invoked to compare values.
	     * If `customizer` returns `undefined` comparisons are handled by the method
	     * instead. The `customizer` is bound to `thisArg` and invoked with three
	     * arguments: (value, other [, index|key]).
	     *
	     * **Note:** This method supports comparing arrays, booleans, `Date` objects,
	     * numbers, `Object` objects, regexes, and strings. Objects are compared by
	     * their own, not inherited, enumerable properties. Functions and DOM nodes
	     * are **not** supported. Provide a customizer function to extend support
	     * for comparing other values.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to compare.
	     * @param {*} other The other value to compare.
	     * @param {Function} [customizer] The function to customize comparing values.
	     * @param {*} [thisArg] The `this` binding of `customizer`.
	     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
	     * @example
	     *
	     * var object = { 'user': 'fred' };
	     * var other = { 'user': 'fred' };
	     *
	     * object == other;
	     * // => false
	     *
	     * _.isEqual(object, other);
	     * // => true
	     *
	     * // using a customizer callback
	     * var array = ['hello', 'goodbye'];
	     * var other = ['hi', 'goodbye'];
	     *
	     * _.isEqual(array, other, function(value, other) {
	     *   if (_.every([value, other], RegExp.prototype.test, /^h(?:i|ello)$/)) {
	     *     return true;
	     *   }
	     * });
	     * // => true
	     */
	    function isEqual(value, other, customizer, thisArg) {
	      customizer = typeof customizer == 'function' && bindCallback(customizer, thisArg, 3);
	      if (!customizer && isStrictComparable(value) && isStrictComparable(other)) {
	        return value === other;
	      }
	      var result = customizer ? customizer(value, other) : undefined;
	      return typeof result == 'undefined' ? baseIsEqual(value, other, customizer) : !!result;
	    }
	
	    /**
	     * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,
	     * `SyntaxError`, `TypeError`, or `URIError` object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is an error object, else `false`.
	     * @example
	     *
	     * _.isError(new Error);
	     * // => true
	     *
	     * _.isError(Error);
	     * // => false
	     */
	    function isError(value) {
	      return isObjectLike(value) && typeof value.message == 'string' && objToString.call(value) == errorTag;
	    }
	
	    /**
	     * Checks if `value` is a finite primitive number.
	     *
	     * **Note:** This method is based on [`Number.isFinite`](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-number.isfinite).
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.
	     * @example
	     *
	     * _.isFinite(10);
	     * // => true
	     *
	     * _.isFinite('10');
	     * // => false
	     *
	     * _.isFinite(true);
	     * // => false
	     *
	     * _.isFinite(Object(10));
	     * // => false
	     *
	     * _.isFinite(Infinity);
	     * // => false
	     */
	    var isFinite = nativeNumIsFinite || function(value) {
	      return typeof value == 'number' && nativeIsFinite(value);
	    };
	
	    /**
	     * Checks if `value` is classified as a `Function` object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isFunction(_);
	     * // => true
	     *
	     * _.isFunction(/abc/);
	     * // => false
	     */
	    var isFunction = !(baseIsFunction(/x/) || (Uint8Array && !baseIsFunction(Uint8Array))) ? baseIsFunction : function(value) {
	      // The use of `Object#toString` avoids issues with the `typeof` operator
	      // in older versions of Chrome and Safari which return 'function' for regexes
	      // and Safari 8 equivalents which return 'object' for typed array constructors.
	      return objToString.call(value) == funcTag;
	    };
	
	    /**
	     * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.
	     * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is an object, else `false`.
	     * @example
	     *
	     * _.isObject({});
	     * // => true
	     *
	     * _.isObject([1, 2, 3]);
	     * // => true
	     *
	     * _.isObject(1);
	     * // => false
	     */
	    function isObject(value) {
	      // Avoid a V8 JIT bug in Chrome 19-20.
	      // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.
	      var type = typeof value;
	      return type == 'function' || (!!value && type == 'object');
	    }
	
	    /**
	     * Performs a deep comparison between `object` and `source` to determine if
	     * `object` contains equivalent property values. If `customizer` is provided
	     * it is invoked to compare values. If `customizer` returns `undefined`
	     * comparisons are handled by the method instead. The `customizer` is bound
	     * to `thisArg` and invoked with three arguments: (value, other, index|key).
	     *
	     * **Note:** This method supports comparing properties of arrays, booleans,
	     * `Date` objects, numbers, `Object` objects, regexes, and strings. Functions
	     * and DOM nodes are **not** supported. Provide a customizer function to extend
	     * support for comparing other values.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {Object} object The object to inspect.
	     * @param {Object} source The object of property values to match.
	     * @param {Function} [customizer] The function to customize comparing values.
	     * @param {*} [thisArg] The `this` binding of `customizer`.
	     * @returns {boolean} Returns `true` if `object` is a match, else `false`.
	     * @example
	     *
	     * var object = { 'user': 'fred', 'age': 40 };
	     *
	     * _.isMatch(object, { 'age': 40 });
	     * // => true
	     *
	     * _.isMatch(object, { 'age': 36 });
	     * // => false
	     *
	     * // using a customizer callback
	     * var object = { 'greeting': 'hello' };
	     * var source = { 'greeting': 'hi' };
	     *
	     * _.isMatch(object, source, function(value, other) {
	     *   return _.every([value, other], RegExp.prototype.test, /^h(?:i|ello)$/) || undefined;
	     * });
	     * // => true
	     */
	    function isMatch(object, source, customizer, thisArg) {
	      var props = keys(source),
	          length = props.length;
	
	      if (!length) {
	        return true;
	      }
	      if (object == null) {
	        return false;
	      }
	      customizer = typeof customizer == 'function' && bindCallback(customizer, thisArg, 3);
	      if (!customizer && length == 1) {
	        var key = props[0],
	            value = source[key];
	
	        if (isStrictComparable(value)) {
	          return value === object[key] && (typeof value != 'undefined' || (key in toObject(object)));
	        }
	      }
	      var values = Array(length),
	          strictCompareFlags = Array(length);
	
	      while (length--) {
	        value = values[length] = source[props[length]];
	        strictCompareFlags[length] = isStrictComparable(value);
	      }
	      return baseIsMatch(toObject(object), props, values, strictCompareFlags, customizer);
	    }
	
	    /**
	     * Checks if `value` is `NaN`.
	     *
	     * **Note:** This method is not the same as [`isNaN`](https://es5.github.io/#x15.1.2.4)
	     * which returns `true` for `undefined` and other non-numeric values.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
	     * @example
	     *
	     * _.isNaN(NaN);
	     * // => true
	     *
	     * _.isNaN(new Number(NaN));
	     * // => true
	     *
	     * isNaN(undefined);
	     * // => true
	     *
	     * _.isNaN(undefined);
	     * // => false
	     */
	    function isNaN(value) {
	      // An `NaN` primitive is the only value that is not equal to itself.
	      // Perform the `toStringTag` check first to avoid errors with some host objects in IE.
	      return isNumber(value) && value != +value;
	    }
	
	    /**
	     * Checks if `value` is a native function.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is a native function, else `false`.
	     * @example
	     *
	     * _.isNative(Array.prototype.push);
	     * // => true
	     *
	     * _.isNative(_);
	     * // => false
	     */
	    function isNative(value) {
	      if (value == null) {
	        return false;
	      }
	      if (objToString.call(value) == funcTag) {
	        return reNative.test(fnToString.call(value));
	      }
	      return isObjectLike(value) && reHostCtor.test(value);
	    }
	
	    /**
	     * Checks if `value` is `null`.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is `null`, else `false`.
	     * @example
	     *
	     * _.isNull(null);
	     * // => true
	     *
	     * _.isNull(void 0);
	     * // => false
	     */
	    function isNull(value) {
	      return value === null;
	    }
	
	    /**
	     * Checks if `value` is classified as a `Number` primitive or object.
	     *
	     * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are classified
	     * as numbers, use the `_.isFinite` method.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isNumber(8.4);
	     * // => true
	     *
	     * _.isNumber(NaN);
	     * // => true
	     *
	     * _.isNumber('8.4');
	     * // => false
	     */
	    function isNumber(value) {
	      return typeof value == 'number' || (isObjectLike(value) && objToString.call(value) == numberTag);
	    }
	
	    /**
	     * Checks if `value` is a plain object, that is, an object created by the
	     * `Object` constructor or one with a `[[Prototype]]` of `null`.
	     *
	     * **Note:** This method assumes objects created by the `Object` constructor
	     * have no inherited enumerable properties.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     * }
	     *
	     * _.isPlainObject(new Foo);
	     * // => false
	     *
	     * _.isPlainObject([1, 2, 3]);
	     * // => false
	     *
	     * _.isPlainObject({ 'x': 0, 'y': 0 });
	     * // => true
	     *
	     * _.isPlainObject(Object.create(null));
	     * // => true
	     */
	    var isPlainObject = !getPrototypeOf ? shimIsPlainObject : function(value) {
	      if (!(value && objToString.call(value) == objectTag)) {
	        return false;
	      }
	      var valueOf = value.valueOf,
	          objProto = isNative(valueOf) && (objProto = getPrototypeOf(valueOf)) && getPrototypeOf(objProto);
	
	      return objProto
	        ? (value == objProto || getPrototypeOf(value) == objProto)
	        : shimIsPlainObject(value);
	    };
	
	    /**
	     * Checks if `value` is classified as a `RegExp` object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isRegExp(/abc/);
	     * // => true
	     *
	     * _.isRegExp('/abc/');
	     * // => false
	     */
	    function isRegExp(value) {
	      return (isObjectLike(value) && objToString.call(value) == regexpTag) || false;
	    }
	
	    /**
	     * Checks if `value` is classified as a `String` primitive or object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isString('abc');
	     * // => true
	     *
	     * _.isString(1);
	     * // => false
	     */
	    function isString(value) {
	      return typeof value == 'string' || (isObjectLike(value) && objToString.call(value) == stringTag);
	    }
	
	    /**
	     * Checks if `value` is classified as a typed array.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
	     * @example
	     *
	     * _.isTypedArray(new Uint8Array);
	     * // => true
	     *
	     * _.isTypedArray([]);
	     * // => false
	     */
	    function isTypedArray(value) {
	      return isObjectLike(value) && isLength(value.length) && !!typedArrayTags[objToString.call(value)];
	    }
	
	    /**
	     * Checks if `value` is `undefined`.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to check.
	     * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.
	     * @example
	     *
	     * _.isUndefined(void 0);
	     * // => true
	     *
	     * _.isUndefined(null);
	     * // => false
	     */
	    function isUndefined(value) {
	      return typeof value == 'undefined';
	    }
	
	    /**
	     * Converts `value` to an array.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to convert.
	     * @returns {Array} Returns the converted array.
	     * @example
	     *
	     * (function() {
	     *   return _.toArray(arguments).slice(1);
	     * }(1, 2, 3));
	     * // => [2, 3]
	     */
	    function toArray(value) {
	      var length = value ? value.length : 0;
	      if (!isLength(length)) {
	        return values(value);
	      }
	      if (!length) {
	        return [];
	      }
	      return arrayCopy(value);
	    }
	
	    /**
	     * Converts `value` to a plain object flattening inherited enumerable
	     * properties of `value` to own properties of the plain object.
	     *
	     * @static
	     * @memberOf _
	     * @category Lang
	     * @param {*} value The value to convert.
	     * @returns {Object} Returns the converted plain object.
	     * @example
	     *
	     * function Foo() {
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.assign({ 'a': 1 }, new Foo);
	     * // => { 'a': 1, 'b': 2 }
	     *
	     * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));
	     * // => { 'a': 1, 'b': 2, 'c': 3 }
	     */
	    function toPlainObject(value) {
	      return baseCopy(value, keysIn(value));
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Assigns own enumerable properties of source object(s) to the destination
	     * object. Subsequent sources overwrite property assignments of previous sources.
	     * If `customizer` is provided it is invoked to produce the assigned values.
	     * The `customizer` is bound to `thisArg` and invoked with five arguments:
	     * (objectValue, sourceValue, key, object, source).
	     *
	     * @static
	     * @memberOf _
	     * @alias extend
	     * @category Object
	     * @param {Object} object The destination object.
	     * @param {...Object} [sources] The source objects.
	     * @param {Function} [customizer] The function to customize assigning values.
	     * @param {*} [thisArg] The `this` binding of `customizer`.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * _.assign({ 'user': 'barney' }, { 'age': 40 }, { 'user': 'fred' });
	     * // => { 'user': 'fred', 'age': 40 }
	     *
	     * // using a customizer callback
	     * var defaults = _.partialRight(_.assign, function(value, other) {
	     *   return typeof value == 'undefined' ? other : value;
	     * });
	     *
	     * defaults({ 'user': 'barney' }, { 'age': 36 }, { 'user': 'fred' });
	     * // => { 'user': 'barney', 'age': 36 }
	     */
	    var assign = createAssigner(baseAssign);
	
	    /**
	     * Creates an object that inherits from the given `prototype` object. If a
	     * `properties` object is provided its own enumerable properties are assigned
	     * to the created object.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} prototype The object to inherit from.
	     * @param {Object} [properties] The properties to assign to the object.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Object} Returns the new object.
	     * @example
	     *
	     * function Shape() {
	     *   this.x = 0;
	     *   this.y = 0;
	     * }
	     *
	     * function Circle() {
	     *   Shape.call(this);
	     * }
	     *
	     * Circle.prototype = _.create(Shape.prototype, {
	     *   'constructor': Circle
	     * });
	     *
	     * var circle = new Circle;
	     * circle instanceof Circle;
	     * // => true
	     *
	     * circle instanceof Shape;
	     * // => true
	     */
	    function create(prototype, properties, guard) {
	      var result = baseCreate(prototype);
	      if (guard && isIterateeCall(prototype, properties, guard)) {
	        properties = null;
	      }
	      return properties ? baseCopy(properties, result, keys(properties)) : result;
	    }
	
	    /**
	     * Assigns own enumerable properties of source object(s) to the destination
	     * object for all destination properties that resolve to `undefined`. Once a
	     * property is set, additional values of the same property are ignored.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The destination object.
	     * @param {...Object} [sources] The source objects.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * _.defaults({ 'user': 'barney' }, { 'age': 36 }, { 'user': 'fred' });
	     * // => { 'user': 'barney', 'age': 36 }
	     */
	    var defaults = restParam(function(args) {
	      var object = args[0];
	      if (object == null) {
	        return object;
	      }
	      args.push(assignDefaults);
	      return assign.apply(undefined, args);
	    });
	
	    /**
	     * This method is like `_.find` except that it returns the key of the first
	     * element `predicate` returns truthy for instead of the element itself.
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to search.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {string|undefined} Returns the key of the matched element, else `undefined`.
	     * @example
	     *
	     * var users = {
	     *   'barney':  { 'age': 36, 'active': true },
	     *   'fred':    { 'age': 40, 'active': false },
	     *   'pebbles': { 'age': 1,  'active': true }
	     * };
	     *
	     * _.findKey(users, function(chr) {
	     *   return chr.age < 40;
	     * });
	     * // => 'barney' (iteration order is not guaranteed)
	     *
	     * // using the `_.matches` callback shorthand
	     * _.findKey(users, { 'age': 1, 'active': true });
	     * // => 'pebbles'
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.findKey(users, 'active', false);
	     * // => 'fred'
	     *
	     * // using the `_.property` callback shorthand
	     * _.findKey(users, 'active');
	     * // => 'barney'
	     */
	    var findKey = createFindKey(baseForOwn);
	
	    /**
	     * This method is like `_.findKey` except that it iterates over elements of
	     * a collection in the opposite order.
	     *
	     * If a property name is provided for `predicate` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `predicate` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to search.
	     * @param {Function|Object|string} [predicate=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {string|undefined} Returns the key of the matched element, else `undefined`.
	     * @example
	     *
	     * var users = {
	     *   'barney':  { 'age': 36, 'active': true },
	     *   'fred':    { 'age': 40, 'active': false },
	     *   'pebbles': { 'age': 1,  'active': true }
	     * };
	     *
	     * _.findLastKey(users, function(chr) {
	     *   return chr.age < 40;
	     * });
	     * // => returns `pebbles` assuming `_.findKey` returns `barney`
	     *
	     * // using the `_.matches` callback shorthand
	     * _.findLastKey(users, { 'age': 36, 'active': true });
	     * // => 'barney'
	     *
	     * // using the `_.matchesProperty` callback shorthand
	     * _.findLastKey(users, 'active', false);
	     * // => 'fred'
	     *
	     * // using the `_.property` callback shorthand
	     * _.findLastKey(users, 'active');
	     * // => 'pebbles'
	     */
	    var findLastKey = createFindKey(baseForOwnRight);
	
	    /**
	     * Iterates over own and inherited enumerable properties of an object invoking
	     * `iteratee` for each property. The `iteratee` is bound to `thisArg` and invoked
	     * with three arguments: (value, key, object). Iterator functions may exit
	     * iteration early by explicitly returning `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.forIn(new Foo, function(value, key) {
	     *   console.log(key);
	     * });
	     * // => logs 'a', 'b', and 'c' (iteration order is not guaranteed)
	     */
	    var forIn = createForIn(baseFor);
	
	    /**
	     * This method is like `_.forIn` except that it iterates over properties of
	     * `object` in the opposite order.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.forInRight(new Foo, function(value, key) {
	     *   console.log(key);
	     * });
	     * // => logs 'c', 'b', and 'a' assuming `_.forIn ` logs 'a', 'b', and 'c'
	     */
	    var forInRight = createForIn(baseForRight);
	
	    /**
	     * Iterates over own enumerable properties of an object invoking `iteratee`
	     * for each property. The `iteratee` is bound to `thisArg` and invoked with
	     * three arguments: (value, key, object). Iterator functions may exit iteration
	     * early by explicitly returning `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.forOwn(new Foo, function(value, key) {
	     *   console.log(key);
	     * });
	     * // => logs 'a' and 'b' (iteration order is not guaranteed)
	     */
	    var forOwn = createForOwn(baseForOwn);
	
	    /**
	     * This method is like `_.forOwn` except that it iterates over properties of
	     * `object` in the opposite order.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.forOwnRight(new Foo, function(value, key) {
	     *   console.log(key);
	     * });
	     * // => logs 'b' and 'a' assuming `_.forOwn` logs 'a' and 'b'
	     */
	    var forOwnRight = createForOwn(baseForOwnRight);
	
	    /**
	     * Creates an array of function property names from all enumerable properties,
	     * own and inherited, of `object`.
	     *
	     * @static
	     * @memberOf _
	     * @alias methods
	     * @category Object
	     * @param {Object} object The object to inspect.
	     * @returns {Array} Returns the new array of property names.
	     * @example
	     *
	     * _.functions(_);
	     * // => ['after', 'ary', 'assign', ...]
	     */
	    function functions(object) {
	      return baseFunctions(object, keysIn(object));
	    }
	
	    /**
	     * Checks if `key` exists as a direct property of `object` instead of an
	     * inherited property.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to inspect.
	     * @param {string} key The key to check.
	     * @returns {boolean} Returns `true` if `key` is a direct property, else `false`.
	     * @example
	     *
	     * var object = { 'a': 1, 'b': 2, 'c': 3 };
	     *
	     * _.has(object, 'b');
	     * // => true
	     */
	    function has(object, key) {
	      return object ? hasOwnProperty.call(object, key) : false;
	    }
	
	    /**
	     * Creates an object composed of the inverted keys and values of `object`.
	     * If `object` contains duplicate values, subsequent values overwrite property
	     * assignments of previous values unless `multiValue` is `true`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to invert.
	     * @param {boolean} [multiValue] Allow multiple values per key.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Object} Returns the new inverted object.
	     * @example
	     *
	     * var object = { 'a': 1, 'b': 2, 'c': 1 };
	     *
	     * _.invert(object);
	     * // => { '1': 'c', '2': 'b' }
	     *
	     * // with `multiValue`
	     * _.invert(object, true);
	     * // => { '1': ['a', 'c'], '2': ['b'] }
	     */
	    function invert(object, multiValue, guard) {
	      if (guard && isIterateeCall(object, multiValue, guard)) {
	        multiValue = null;
	      }
	      var index = -1,
	          props = keys(object),
	          length = props.length,
	          result = {};
	
	      while (++index < length) {
	        var key = props[index],
	            value = object[key];
	
	        if (multiValue) {
	          if (hasOwnProperty.call(result, value)) {
	            result[value].push(key);
	          } else {
	            result[value] = [key];
	          }
	        }
	        else {
	          result[value] = key;
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Creates an array of the own enumerable property names of `object`.
	     *
	     * **Note:** Non-object values are coerced to objects. See the
	     * [ES spec](https://people.mozilla.org/~jorendorff/es6-draft.html#sec-object.keys)
	     * for more details.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to inspect.
	     * @returns {Array} Returns the array of property names.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.keys(new Foo);
	     * // => ['a', 'b'] (iteration order is not guaranteed)
	     *
	     * _.keys('hi');
	     * // => ['0', '1']
	     */
	    var keys = !nativeKeys ? shimKeys : function(object) {
	      if (object) {
	        var Ctor = object.constructor,
	            length = object.length;
	      }
	      if ((typeof Ctor == 'function' && Ctor.prototype === object) ||
	          (typeof object != 'function' && (length && isLength(length)))) {
	        return shimKeys(object);
	      }
	      return isObject(object) ? nativeKeys(object) : [];
	    };
	
	    /**
	     * Creates an array of the own and inherited enumerable property names of `object`.
	     *
	     * **Note:** Non-object values are coerced to objects.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to inspect.
	     * @returns {Array} Returns the array of property names.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.keysIn(new Foo);
	     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)
	     */
	    function keysIn(object) {
	      if (object == null) {
	        return [];
	      }
	      if (!isObject(object)) {
	        object = Object(object);
	      }
	      var length = object.length;
	      length = (length && isLength(length) &&
	        (isArray(object) || (support.nonEnumArgs && isArguments(object))) && length) || 0;
	
	      var Ctor = object.constructor,
	          index = -1,
	          isProto = typeof Ctor == 'function' && Ctor.prototype === object,
	          result = Array(length),
	          skipIndexes = length > 0;
	
	      while (++index < length) {
	        result[index] = (index + '');
	      }
	      for (var key in object) {
	        if (!(skipIndexes && isIndex(key, length)) &&
	            !(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {
	          result.push(key);
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Creates an object with the same keys as `object` and values generated by
	     * running each own enumerable property of `object` through `iteratee`. The
	     * iteratee function is bound to `thisArg` and invoked with three arguments:
	     * (value, key, object).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to iterate over.
	     * @param {Function|Object|string} [iteratee=_.identity] The function invoked
	     *  per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Object} Returns the new mapped object.
	     * @example
	     *
	     * _.mapValues({ 'a': 1, 'b': 2 }, function(n) {
	     *   return n * 3;
	     * });
	     * // => { 'a': 3, 'b': 6 }
	     *
	     * var users = {
	     *   'fred':    { 'user': 'fred',    'age': 40 },
	     *   'pebbles': { 'user': 'pebbles', 'age': 1 }
	     * };
	     *
	     * // using the `_.property` callback shorthand
	     * _.mapValues(users, 'age');
	     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)
	     */
	    function mapValues(object, iteratee, thisArg) {
	      var result = {};
	      iteratee = getCallback(iteratee, thisArg, 3);
	
	      baseForOwn(object, function(value, key, object) {
	        result[key] = iteratee(value, key, object);
	      });
	      return result;
	    }
	
	    /**
	     * Recursively merges own enumerable properties of the source object(s), that
	     * don't resolve to `undefined` into the destination object. Subsequent sources
	     * overwrite property assignments of previous sources. If `customizer` is
	     * provided it is invoked to produce the merged values of the destination and
	     * source properties. If `customizer` returns `undefined` merging is handled
	     * by the method instead. The `customizer` is bound to `thisArg` and invoked
	     * with five arguments: (objectValue, sourceValue, key, object, source).
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The destination object.
	     * @param {...Object} [sources] The source objects.
	     * @param {Function} [customizer] The function to customize merging properties.
	     * @param {*} [thisArg] The `this` binding of `customizer`.
	     * @returns {Object} Returns `object`.
	     * @example
	     *
	     * var users = {
	     *   'data': [{ 'user': 'barney' }, { 'user': 'fred' }]
	     * };
	     *
	     * var ages = {
	     *   'data': [{ 'age': 36 }, { 'age': 40 }]
	     * };
	     *
	     * _.merge(users, ages);
	     * // => { 'data': [{ 'user': 'barney', 'age': 36 }, { 'user': 'fred', 'age': 40 }] }
	     *
	     * // using a customizer callback
	     * var object = {
	     *   'fruits': ['apple'],
	     *   'vegetables': ['beet']
	     * };
	     *
	     * var other = {
	     *   'fruits': ['banana'],
	     *   'vegetables': ['carrot']
	     * };
	     *
	     * _.merge(object, other, function(a, b) {
	     *   if (_.isArray(a)) {
	     *     return a.concat(b);
	     *   }
	     * });
	     * // => { 'fruits': ['apple', 'banana'], 'vegetables': ['beet', 'carrot'] }
	     */
	    var merge = createAssigner(baseMerge);
	
	    /**
	     * The opposite of `_.pick`; this method creates an object composed of the
	     * own and inherited enumerable properties of `object` that are not omitted.
	     * Property names may be specified as individual arguments or as arrays of
	     * property names. If `predicate` is provided it is invoked for each property
	     * of `object` omitting the properties `predicate` returns truthy for. The
	     * predicate is bound to `thisArg` and invoked with three arguments:
	     * (value, key, object).
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The source object.
	     * @param {Function|...(string|string[])} [predicate] The function invoked per
	     *  iteration or property names to omit, specified as individual property
	     *  names or arrays of property names.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Object} Returns the new object.
	     * @example
	     *
	     * var object = { 'user': 'fred', 'age': 40 };
	     *
	     * _.omit(object, 'age');
	     * // => { 'user': 'fred' }
	     *
	     * _.omit(object, _.isNumber);
	     * // => { 'user': 'fred' }
	     */
	    var omit = restParam(function(object, props) {
	      if (object == null) {
	        return {};
	      }
	      if (typeof props[0] != 'function') {
	        var props = arrayMap(baseFlatten(props), String);
	        return pickByArray(object, baseDifference(keysIn(object), props));
	      }
	      var predicate = bindCallback(props[0], props[1], 3);
	      return pickByCallback(object, function(value, key, object) {
	        return !predicate(value, key, object);
	      });
	    });
	
	    /**
	     * Creates a two dimensional array of the key-value pairs for `object`,
	     * e.g. `[[key1, value1], [key2, value2]]`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to inspect.
	     * @returns {Array} Returns the new array of key-value pairs.
	     * @example
	     *
	     * _.pairs({ 'barney': 36, 'fred': 40 });
	     * // => [['barney', 36], ['fred', 40]] (iteration order is not guaranteed)
	     */
	    function pairs(object) {
	      var index = -1,
	          props = keys(object),
	          length = props.length,
	          result = Array(length);
	
	      while (++index < length) {
	        var key = props[index];
	        result[index] = [key, object[key]];
	      }
	      return result;
	    }
	
	    /**
	     * Creates an object composed of the picked `object` properties. Property
	     * names may be specified as individual arguments or as arrays of property
	     * names. If `predicate` is provided it is invoked for each property of `object`
	     * picking the properties `predicate` returns truthy for. The predicate is
	     * bound to `thisArg` and invoked with three arguments: (value, key, object).
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The source object.
	     * @param {Function|...(string|string[])} [predicate] The function invoked per
	     *  iteration or property names to pick, specified as individual property
	     *  names or arrays of property names.
	     * @param {*} [thisArg] The `this` binding of `predicate`.
	     * @returns {Object} Returns the new object.
	     * @example
	     *
	     * var object = { 'user': 'fred', 'age': 40 };
	     *
	     * _.pick(object, 'user');
	     * // => { 'user': 'fred' }
	     *
	     * _.pick(object, _.isString);
	     * // => { 'user': 'fred' }
	     */
	    var pick = restParam(function(object, props) {
	      if (object == null) {
	        return {};
	      }
	      return typeof props[0] == 'function'
	        ? pickByCallback(object, bindCallback(props[0], props[1], 3))
	        : pickByArray(object, baseFlatten(props));
	    });
	
	    /**
	     * Resolves the value of property `key` on `object`. If the value of `key` is
	     * a function it is invoked with the `this` binding of `object` and its result
	     * is returned, else the property value is returned. If the property value is
	     * `undefined` the `defaultValue` is used in its place.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to query.
	     * @param {string} key The key of the property to resolve.
	     * @param {*} [defaultValue] The value returned if the property value
	     *  resolves to `undefined`.
	     * @returns {*} Returns the resolved value.
	     * @example
	     *
	     * var object = { 'user': 'fred', 'age': _.constant(40) };
	     *
	     * _.result(object, 'user');
	     * // => 'fred'
	     *
	     * _.result(object, 'age');
	     * // => 40
	     *
	     * _.result(object, 'status', 'busy');
	     * // => 'busy'
	     *
	     * _.result(object, 'status', _.constant('busy'));
	     * // => 'busy'
	     */
	    function result(object, key, defaultValue) {
	      var value = object == null ? undefined : object[key];
	      if (typeof value == 'undefined') {
	        value = defaultValue;
	      }
	      return isFunction(value) ? value.call(object) : value;
	    }
	
	    /**
	     * An alternative to `_.reduce`; this method transforms `object` to a new
	     * `accumulator` object which is the result of running each of its own enumerable
	     * properties through `iteratee`, with each invocation potentially mutating
	     * the `accumulator` object. The `iteratee` is bound to `thisArg` and invoked
	     * with four arguments: (accumulator, value, key, object). Iterator functions
	     * may exit iteration early by explicitly returning `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Array|Object} object The object to iterate over.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [accumulator] The custom accumulator value.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {*} Returns the accumulated value.
	     * @example
	     *
	     * _.transform([2, 3, 4], function(result, n) {
	     *   result.push(n *= n);
	     *   return n % 2 == 0;
	     * });
	     * // => [4, 9]
	     *
	     * _.transform({ 'a': 1, 'b': 2 }, function(result, n, key) {
	     *   result[key] = n * 3;
	     * });
	     * // => { 'a': 3, 'b': 6 }
	     */
	    function transform(object, iteratee, accumulator, thisArg) {
	      var isArr = isArray(object) || isTypedArray(object);
	      iteratee = getCallback(iteratee, thisArg, 4);
	
	      if (accumulator == null) {
	        if (isArr || isObject(object)) {
	          var Ctor = object.constructor;
	          if (isArr) {
	            accumulator = isArray(object) ? new Ctor : [];
	          } else {
	            accumulator = baseCreate(isFunction(Ctor) && Ctor.prototype);
	          }
	        } else {
	          accumulator = {};
	        }
	      }
	      (isArr ? arrayEach : baseForOwn)(object, function(value, index, object) {
	        return iteratee(accumulator, value, index, object);
	      });
	      return accumulator;
	    }
	
	    /**
	     * Creates an array of the own enumerable property values of `object`.
	     *
	     * **Note:** Non-object values are coerced to objects.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to query.
	     * @returns {Array} Returns the array of property values.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.values(new Foo);
	     * // => [1, 2] (iteration order is not guaranteed)
	     *
	     * _.values('hi');
	     * // => ['h', 'i']
	     */
	    function values(object) {
	      return baseValues(object, keys(object));
	    }
	
	    /**
	     * Creates an array of the own and inherited enumerable property values
	     * of `object`.
	     *
	     * **Note:** Non-object values are coerced to objects.
	     *
	     * @static
	     * @memberOf _
	     * @category Object
	     * @param {Object} object The object to query.
	     * @returns {Array} Returns the array of property values.
	     * @example
	     *
	     * function Foo() {
	     *   this.a = 1;
	     *   this.b = 2;
	     * }
	     *
	     * Foo.prototype.c = 3;
	     *
	     * _.valuesIn(new Foo);
	     * // => [1, 2, 3] (iteration order is not guaranteed)
	     */
	    function valuesIn(object) {
	      return baseValues(object, keysIn(object));
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Checks if `n` is between `start` and up to but not including, `end`. If
	     * `end` is not specified it is set to `start` with `start` then set to `0`.
	     *
	     * @static
	     * @memberOf _
	     * @category Number
	     * @param {number} n The number to check.
	     * @param {number} [start=0] The start of the range.
	     * @param {number} end The end of the range.
	     * @returns {boolean} Returns `true` if `n` is in the range, else `false`.
	     * @example
	     *
	     * _.inRange(3, 2, 4);
	     * // => true
	     *
	     * _.inRange(4, 8);
	     * // => true
	     *
	     * _.inRange(4, 2);
	     * // => false
	     *
	     * _.inRange(2, 2);
	     * // => false
	     *
	     * _.inRange(1.2, 2);
	     * // => true
	     *
	     * _.inRange(5.2, 4);
	     * // => false
	     */
	    function inRange(value, start, end) {
	      start = +start || 0;
	      if (typeof end === 'undefined') {
	        end = start;
	        start = 0;
	      } else {
	        end = +end || 0;
	      }
	      return value >= start && value < end;
	    }
	
	    /**
	     * Produces a random number between `min` and `max` (inclusive). If only one
	     * argument is provided a number between `0` and the given number is returned.
	     * If `floating` is `true`, or either `min` or `max` are floats, a floating-point
	     * number is returned instead of an integer.
	     *
	     * @static
	     * @memberOf _
	     * @category Number
	     * @param {number} [min=0] The minimum possible value.
	     * @param {number} [max=1] The maximum possible value.
	     * @param {boolean} [floating] Specify returning a floating-point number.
	     * @returns {number} Returns the random number.
	     * @example
	     *
	     * _.random(0, 5);
	     * // => an integer between 0 and 5
	     *
	     * _.random(5);
	     * // => also an integer between 0 and 5
	     *
	     * _.random(5, true);
	     * // => a floating-point number between 0 and 5
	     *
	     * _.random(1.2, 5.2);
	     * // => a floating-point number between 1.2 and 5.2
	     */
	    function random(min, max, floating) {
	      if (floating && isIterateeCall(min, max, floating)) {
	        max = floating = null;
	      }
	      var noMin = min == null,
	          noMax = max == null;
	
	      if (floating == null) {
	        if (noMax && typeof min == 'boolean') {
	          floating = min;
	          min = 1;
	        }
	        else if (typeof max == 'boolean') {
	          floating = max;
	          noMax = true;
	        }
	      }
	      if (noMin && noMax) {
	        max = 1;
	        noMax = false;
	      }
	      min = +min || 0;
	      if (noMax) {
	        max = min;
	        min = 0;
	      } else {
	        max = +max || 0;
	      }
	      if (floating || min % 1 || max % 1) {
	        var rand = nativeRandom();
	        return nativeMin(min + (rand * (max - min + parseFloat('1e-' + ((rand + '').length - 1)))), max);
	      }
	      return baseRandom(min, max);
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to convert.
	     * @returns {string} Returns the camel cased string.
	     * @example
	     *
	     * _.camelCase('Foo Bar');
	     * // => 'fooBar'
	     *
	     * _.camelCase('--foo-bar');
	     * // => 'fooBar'
	     *
	     * _.camelCase('__foo_bar__');
	     * // => 'fooBar'
	     */
	    var camelCase = createCompounder(function(result, word, index) {
	      word = word.toLowerCase();
	      return result + (index ? (word.charAt(0).toUpperCase() + word.slice(1)) : word);
	    });
	
	    /**
	     * Capitalizes the first character of `string`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to capitalize.
	     * @returns {string} Returns the capitalized string.
	     * @example
	     *
	     * _.capitalize('fred');
	     * // => 'Fred'
	     */
	    function capitalize(string) {
	      string = baseToString(string);
	      return string && (string.charAt(0).toUpperCase() + string.slice(1));
	    }
	
	    /**
	     * Deburrs `string` by converting [latin-1 supplementary letters](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)
	     * to basic latin letters and removing [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to deburr.
	     * @returns {string} Returns the deburred string.
	     * @example
	     *
	     * _.deburr('déjà vu');
	     * // => 'deja vu'
	     */
	    function deburr(string) {
	      string = baseToString(string);
	      return string && string.replace(reLatin1, deburrLetter).replace(reComboMarks, '');
	    }
	
	    /**
	     * Checks if `string` ends with the given target string.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to search.
	     * @param {string} [target] The string to search for.
	     * @param {number} [position=string.length] The position to search from.
	     * @returns {boolean} Returns `true` if `string` ends with `target`, else `false`.
	     * @example
	     *
	     * _.endsWith('abc', 'c');
	     * // => true
	     *
	     * _.endsWith('abc', 'b');
	     * // => false
	     *
	     * _.endsWith('abc', 'b', 2);
	     * // => true
	     */
	    function endsWith(string, target, position) {
	      string = baseToString(string);
	      target = (target + '');
	
	      var length = string.length;
	      position = typeof position == 'undefined'
	        ? length
	        : nativeMin(position < 0 ? 0 : (+position || 0), length);
	
	      position -= target.length;
	      return position >= 0 && string.indexOf(target, position) == position;
	    }
	
	    /**
	     * Converts the characters "&", "<", ">", '"', "'", and "\`", in `string` to
	     * their corresponding HTML entities.
	     *
	     * **Note:** No other characters are escaped. To escape additional characters
	     * use a third-party library like [_he_](https://mths.be/he).
	     *
	     * Though the ">" character is escaped for symmetry, characters like
	     * ">" and "/" don't require escaping in HTML and have no special meaning
	     * unless they're part of a tag or unquoted attribute value.
	     * See [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)
	     * (under "semi-related fun fact") for more details.
	     *
	     * Backticks are escaped because in Internet Explorer < 9, they can break out
	     * of attribute values or HTML comments. See [#102](https://html5sec.org/#102),
	     * [#108](https://html5sec.org/#108), and [#133](https://html5sec.org/#133) of
	     * the [HTML5 Security Cheatsheet](https://html5sec.org/) for more details.
	     *
	     * When working with HTML you should always [quote attribute values](http://wonko.com/post/html-escaping)
	     * to reduce XSS vectors.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to escape.
	     * @returns {string} Returns the escaped string.
	     * @example
	     *
	     * _.escape('fred, barney, & pebbles');
	     * // => 'fred, barney, &amp; pebbles'
	     */
	    function escape(string) {
	      // Reset `lastIndex` because in IE < 9 `String#replace` does not.
	      string = baseToString(string);
	      return (string && reHasUnescapedHtml.test(string))
	        ? string.replace(reUnescapedHtml, escapeHtmlChar)
	        : string;
	    }
	
	    /**
	     * Escapes the `RegExp` special characters "\", "/", "^", "$", ".", "|", "?",
	     * "*", "+", "(", ")", "[", "]", "{" and "}" in `string`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to escape.
	     * @returns {string} Returns the escaped string.
	     * @example
	     *
	     * _.escapeRegExp('[lodash](https://lodash.com/)');
	     * // => '\[lodash\]\(https:\/\/lodash\.com\/\)'
	     */
	    function escapeRegExp(string) {
	      string = baseToString(string);
	      return (string && reHasRegExpChars.test(string))
	        ? string.replace(reRegExpChars, '\\$&')
	        : string;
	    }
	
	    /**
	     * Converts `string` to [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to convert.
	     * @returns {string} Returns the kebab cased string.
	     * @example
	     *
	     * _.kebabCase('Foo Bar');
	     * // => 'foo-bar'
	     *
	     * _.kebabCase('fooBar');
	     * // => 'foo-bar'
	     *
	     * _.kebabCase('__foo_bar__');
	     * // => 'foo-bar'
	     */
	    var kebabCase = createCompounder(function(result, word, index) {
	      return result + (index ? '-' : '') + word.toLowerCase();
	    });
	
	    /**
	     * Pads `string` on the left and right sides if it is shorter than `length`.
	     * Padding characters are truncated if they can't be evenly divided by `length`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to pad.
	     * @param {number} [length=0] The padding length.
	     * @param {string} [chars=' '] The string used as padding.
	     * @returns {string} Returns the padded string.
	     * @example
	     *
	     * _.pad('abc', 8);
	     * // => '  abc   '
	     *
	     * _.pad('abc', 8, '_-');
	     * // => '_-abc_-_'
	     *
	     * _.pad('abc', 3);
	     * // => 'abc'
	     */
	    function pad(string, length, chars) {
	      string = baseToString(string);
	      length = +length;
	
	      var strLength = string.length;
	      if (strLength >= length || !nativeIsFinite(length)) {
	        return string;
	      }
	      var mid = (length - strLength) / 2,
	          leftLength = floor(mid),
	          rightLength = ceil(mid);
	
	      chars = createPadding('', rightLength, chars);
	      return chars.slice(0, leftLength) + string + chars;
	    }
	
	    /**
	     * Pads `string` on the left side if it is shorter than `length`. Padding
	     * characters are truncated if they exceed `length`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to pad.
	     * @param {number} [length=0] The padding length.
	     * @param {string} [chars=' '] The string used as padding.
	     * @returns {string} Returns the padded string.
	     * @example
	     *
	     * _.padLeft('abc', 6);
	     * // => '   abc'
	     *
	     * _.padLeft('abc', 6, '_-');
	     * // => '_-_abc'
	     *
	     * _.padLeft('abc', 3);
	     * // => 'abc'
	     */
	    var padLeft = createPadDir();
	
	    /**
	     * Pads `string` on the right side if it is shorter than `length`. Padding
	     * characters are truncated if they exceed `length`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to pad.
	     * @param {number} [length=0] The padding length.
	     * @param {string} [chars=' '] The string used as padding.
	     * @returns {string} Returns the padded string.
	     * @example
	     *
	     * _.padRight('abc', 6);
	     * // => 'abc   '
	     *
	     * _.padRight('abc', 6, '_-');
	     * // => 'abc_-_'
	     *
	     * _.padRight('abc', 3);
	     * // => 'abc'
	     */
	    var padRight = createPadDir(true);
	
	    /**
	     * Converts `string` to an integer of the specified radix. If `radix` is
	     * `undefined` or `0`, a `radix` of `10` is used unless `value` is a hexadecimal,
	     * in which case a `radix` of `16` is used.
	     *
	     * **Note:** This method aligns with the [ES5 implementation](https://es5.github.io/#E)
	     * of `parseInt`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} string The string to convert.
	     * @param {number} [radix] The radix to interpret `value` by.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {number} Returns the converted integer.
	     * @example
	     *
	     * _.parseInt('08');
	     * // => 8
	     *
	     * _.map(['6', '08', '10'], _.parseInt);
	     * // => [6, 8, 10]
	     */
	    function parseInt(string, radix, guard) {
	      if (guard && isIterateeCall(string, radix, guard)) {
	        radix = 0;
	      }
	      return nativeParseInt(string, radix);
	    }
	    // Fallback for environments with pre-ES5 implementations.
	    if (nativeParseInt(whitespace + '08') != 8) {
	      parseInt = function(string, radix, guard) {
	        // Firefox < 21 and Opera < 15 follow ES3 for `parseInt`.
	        // Chrome fails to trim leading <BOM> whitespace characters.
	        // See https://code.google.com/p/v8/issues/detail?id=3109 for more details.
	        if (guard ? isIterateeCall(string, radix, guard) : radix == null) {
	          radix = 0;
	        } else if (radix) {
	          radix = +radix;
	        }
	        string = trim(string);
	        return nativeParseInt(string, radix || (reHexPrefix.test(string) ? 16 : 10));
	      };
	    }
	
	    /**
	     * Repeats the given string `n` times.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to repeat.
	     * @param {number} [n=0] The number of times to repeat the string.
	     * @returns {string} Returns the repeated string.
	     * @example
	     *
	     * _.repeat('*', 3);
	     * // => '***'
	     *
	     * _.repeat('abc', 2);
	     * // => 'abcabc'
	     *
	     * _.repeat('abc', 0);
	     * // => ''
	     */
	    function repeat(string, n) {
	      var result = '';
	      string = baseToString(string);
	      n = +n;
	      if (n < 1 || !string || !nativeIsFinite(n)) {
	        return result;
	      }
	      // Leverage the exponentiation by squaring algorithm for a faster repeat.
	      // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.
	      do {
	        if (n % 2) {
	          result += string;
	        }
	        n = floor(n / 2);
	        string += string;
	      } while (n);
	
	      return result;
	    }
	
	    /**
	     * Converts `string` to [snake case](https://en.wikipedia.org/wiki/Snake_case).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to convert.
	     * @returns {string} Returns the snake cased string.
	     * @example
	     *
	     * _.snakeCase('Foo Bar');
	     * // => 'foo_bar'
	     *
	     * _.snakeCase('fooBar');
	     * // => 'foo_bar'
	     *
	     * _.snakeCase('--foo-bar');
	     * // => 'foo_bar'
	     */
	    var snakeCase = createCompounder(function(result, word, index) {
	      return result + (index ? '_' : '') + word.toLowerCase();
	    });
	
	    /**
	     * Converts `string` to [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to convert.
	     * @returns {string} Returns the start cased string.
	     * @example
	     *
	     * _.startCase('--foo-bar');
	     * // => 'Foo Bar'
	     *
	     * _.startCase('fooBar');
	     * // => 'Foo Bar'
	     *
	     * _.startCase('__foo_bar__');
	     * // => 'Foo Bar'
	     */
	    var startCase = createCompounder(function(result, word, index) {
	      return result + (index ? ' ' : '') + (word.charAt(0).toUpperCase() + word.slice(1));
	    });
	
	    /**
	     * Checks if `string` starts with the given target string.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to search.
	     * @param {string} [target] The string to search for.
	     * @param {number} [position=0] The position to search from.
	     * @returns {boolean} Returns `true` if `string` starts with `target`, else `false`.
	     * @example
	     *
	     * _.startsWith('abc', 'a');
	     * // => true
	     *
	     * _.startsWith('abc', 'b');
	     * // => false
	     *
	     * _.startsWith('abc', 'b', 1);
	     * // => true
	     */
	    function startsWith(string, target, position) {
	      string = baseToString(string);
	      position = position == null
	        ? 0
	        : nativeMin(position < 0 ? 0 : (+position || 0), string.length);
	
	      return string.lastIndexOf(target, position) == position;
	    }
	
	    /**
	     * Creates a compiled template function that can interpolate data properties
	     * in "interpolate" delimiters, HTML-escape interpolated data properties in
	     * "escape" delimiters, and execute JavaScript in "evaluate" delimiters. Data
	     * properties may be accessed as free variables in the template. If a setting
	     * object is provided it takes precedence over `_.templateSettings` values.
	     *
	     * **Note:** In the development build `_.template` utilizes
	     * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)
	     * for easier debugging.
	     *
	     * For more information on precompiling templates see
	     * [lodash's custom builds documentation](https://lodash.com/custom-builds).
	     *
	     * For more information on Chrome extension sandboxes see
	     * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The template string.
	     * @param {Object} [options] The options object.
	     * @param {RegExp} [options.escape] The HTML "escape" delimiter.
	     * @param {RegExp} [options.evaluate] The "evaluate" delimiter.
	     * @param {Object} [options.imports] An object to import into the template as free variables.
	     * @param {RegExp} [options.interpolate] The "interpolate" delimiter.
	     * @param {string} [options.sourceURL] The sourceURL of the template's compiled source.
	     * @param {string} [options.variable] The data object variable name.
	     * @param- {Object} [otherOptions] Enables the legacy `options` param signature.
	     * @returns {Function} Returns the compiled template function.
	     * @example
	     *
	     * // using the "interpolate" delimiter to create a compiled template
	     * var compiled = _.template('hello <%= user %>!');
	     * compiled({ 'user': 'fred' });
	     * // => 'hello fred!'
	     *
	     * // using the HTML "escape" delimiter to escape data property values
	     * var compiled = _.template('<b><%- value %></b>');
	     * compiled({ 'value': '<script>' });
	     * // => '<b>&lt;script&gt;</b>'
	     *
	     * // using the "evaluate" delimiter to execute JavaScript and generate HTML
	     * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');
	     * compiled({ 'users': ['fred', 'barney'] });
	     * // => '<li>fred</li><li>barney</li>'
	     *
	     * // using the internal `print` function in "evaluate" delimiters
	     * var compiled = _.template('<% print("hello " + user); %>!');
	     * compiled({ 'user': 'barney' });
	     * // => 'hello barney!'
	     *
	     * // using the ES delimiter as an alternative to the default "interpolate" delimiter
	     * var compiled = _.template('hello ${ user }!');
	     * compiled({ 'user': 'pebbles' });
	     * // => 'hello pebbles!'
	     *
	     * // using custom template delimiters
	     * _.templateSettings.interpolate = /{{([\s\S]+?)}}/g;
	     * var compiled = _.template('hello {{ user }}!');
	     * compiled({ 'user': 'mustache' });
	     * // => 'hello mustache!'
	     *
	     * // using backslashes to treat delimiters as plain text
	     * var compiled = _.template('<%= "\\<%- value %\\>" %>');
	     * compiled({ 'value': 'ignored' });
	     * // => '<%- value %>'
	     *
	     * // using the `imports` option to import `jQuery` as `jq`
	     * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';
	     * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });
	     * compiled({ 'users': ['fred', 'barney'] });
	     * // => '<li>fred</li><li>barney</li>'
	     *
	     * // using the `sourceURL` option to specify a custom sourceURL for the template
	     * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });
	     * compiled(data);
	     * // => find the source of "greeting.jst" under the Sources tab or Resources panel of the web inspector
	     *
	     * // using the `variable` option to ensure a with-statement isn't used in the compiled template
	     * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });
	     * compiled.source;
	     * // => function(data) {
	     * //   var __t, __p = '';
	     * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';
	     * //   return __p;
	     * // }
	     *
	     * // using the `source` property to inline compiled templates for meaningful
	     * // line numbers in error messages and a stack trace
	     * fs.writeFileSync(path.join(cwd, 'jst.js'), '\
	     *   var JST = {\
	     *     "main": ' + _.template(mainText).source + '\
	     *   };\
	     * ');
	     */
	    function template(string, options, otherOptions) {
	      // Based on John Resig's `tmpl` implementation (http://ejohn.org/blog/javascript-micro-templating/)
	      // and Laura Doktorova's doT.js (https://github.com/olado/doT).
	      var settings = lodash.templateSettings;
	
	      if (otherOptions && isIterateeCall(string, options, otherOptions)) {
	        options = otherOptions = null;
	      }
	      string = baseToString(string);
	      options = baseAssign(baseAssign({}, otherOptions || options), settings, assignOwnDefaults);
	
	      var imports = baseAssign(baseAssign({}, options.imports), settings.imports, assignOwnDefaults),
	          importsKeys = keys(imports),
	          importsValues = baseValues(imports, importsKeys);
	
	      var isEscaping,
	          isEvaluating,
	          index = 0,
	          interpolate = options.interpolate || reNoMatch,
	          source = "__p += '";
	
	      // Compile the regexp to match each delimiter.
	      var reDelimiters = RegExp(
	        (options.escape || reNoMatch).source + '|' +
	        interpolate.source + '|' +
	        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +
	        (options.evaluate || reNoMatch).source + '|$'
	      , 'g');
	
	      // Use a sourceURL for easier debugging.
	      var sourceURL = '//# sourceURL=' +
	        ('sourceURL' in options
	          ? options.sourceURL
	          : ('lodash.templateSources[' + (++templateCounter) + ']')
	        ) + '\n';
	
	      string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {
	        interpolateValue || (interpolateValue = esTemplateValue);
	
	        // Escape characters that can't be included in string literals.
	        source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);
	
	        // Replace delimiters with snippets.
	        if (escapeValue) {
	          isEscaping = true;
	          source += "' +\n__e(" + escapeValue + ") +\n'";
	        }
	        if (evaluateValue) {
	          isEvaluating = true;
	          source += "';\n" + evaluateValue + ";\n__p += '";
	        }
	        if (interpolateValue) {
	          source += "' +\n((__t = (" + interpolateValue + ")) == null ? '' : __t) +\n'";
	        }
	        index = offset + match.length;
	
	        // The JS engine embedded in Adobe products requires returning the `match`
	        // string in order to produce the correct `offset` value.
	        return match;
	      });
	
	      source += "';\n";
	
	      // If `variable` is not specified wrap a with-statement around the generated
	      // code to add the data object to the top of the scope chain.
	      var variable = options.variable;
	      if (!variable) {
	        source = 'with (obj) {\n' + source + '\n}\n';
	      }
	      // Cleanup code by stripping empty strings.
	      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)
	        .replace(reEmptyStringMiddle, '$1')
	        .replace(reEmptyStringTrailing, '$1;');
	
	      // Frame code as the function body.
	      source = 'function(' + (variable || 'obj') + ') {\n' +
	        (variable
	          ? ''
	          : 'obj || (obj = {});\n'
	        ) +
	        "var __t, __p = ''" +
	        (isEscaping
	           ? ', __e = _.escape'
	           : ''
	        ) +
	        (isEvaluating
	          ? ', __j = Array.prototype.join;\n' +
	            "function print() { __p += __j.call(arguments, '') }\n"
	          : ';\n'
	        ) +
	        source +
	        'return __p\n}';
	
	      var result = attempt(function() {
	        return Function(importsKeys, sourceURL + 'return ' + source).apply(undefined, importsValues);
	      });
	
	      // Provide the compiled function's source by its `toString` method or
	      // the `source` property as a convenience for inlining compiled templates.
	      result.source = source;
	      if (isError(result)) {
	        throw result;
	      }
	      return result;
	    }
	
	    /**
	     * Removes leading and trailing whitespace or specified characters from `string`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to trim.
	     * @param {string} [chars=whitespace] The characters to trim.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {string} Returns the trimmed string.
	     * @example
	     *
	     * _.trim('  abc  ');
	     * // => 'abc'
	     *
	     * _.trim('-_-abc-_-', '_-');
	     * // => 'abc'
	     *
	     * _.map(['  foo  ', '  bar  '], _.trim);
	     * // => ['foo', 'bar']
	     */
	    function trim(string, chars, guard) {
	      var value = string;
	      string = baseToString(string);
	      if (!string) {
	        return string;
	      }
	      if (guard ? isIterateeCall(value, chars, guard) : chars == null) {
	        return string.slice(trimmedLeftIndex(string), trimmedRightIndex(string) + 1);
	      }
	      chars = (chars + '');
	      return string.slice(charsLeftIndex(string, chars), charsRightIndex(string, chars) + 1);
	    }
	
	    /**
	     * Removes leading whitespace or specified characters from `string`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to trim.
	     * @param {string} [chars=whitespace] The characters to trim.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {string} Returns the trimmed string.
	     * @example
	     *
	     * _.trimLeft('  abc  ');
	     * // => 'abc  '
	     *
	     * _.trimLeft('-_-abc-_-', '_-');
	     * // => 'abc-_-'
	     */
	    function trimLeft(string, chars, guard) {
	      var value = string;
	      string = baseToString(string);
	      if (!string) {
	        return string;
	      }
	      if (guard ? isIterateeCall(value, chars, guard) : chars == null) {
	        return string.slice(trimmedLeftIndex(string));
	      }
	      return string.slice(charsLeftIndex(string, (chars + '')));
	    }
	
	    /**
	     * Removes trailing whitespace or specified characters from `string`.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to trim.
	     * @param {string} [chars=whitespace] The characters to trim.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {string} Returns the trimmed string.
	     * @example
	     *
	     * _.trimRight('  abc  ');
	     * // => '  abc'
	     *
	     * _.trimRight('-_-abc-_-', '_-');
	     * // => '-_-abc'
	     */
	    function trimRight(string, chars, guard) {
	      var value = string;
	      string = baseToString(string);
	      if (!string) {
	        return string;
	      }
	      if (guard ? isIterateeCall(value, chars, guard) : chars == null) {
	        return string.slice(0, trimmedRightIndex(string) + 1);
	      }
	      return string.slice(0, charsRightIndex(string, (chars + '')) + 1);
	    }
	
	    /**
	     * Truncates `string` if it is longer than the given maximum string length.
	     * The last characters of the truncated string are replaced with the omission
	     * string which defaults to "...".
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to truncate.
	     * @param {Object|number} [options] The options object or maximum string length.
	     * @param {number} [options.length=30] The maximum string length.
	     * @param {string} [options.omission='...'] The string to indicate text is omitted.
	     * @param {RegExp|string} [options.separator] The separator pattern to truncate to.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {string} Returns the truncated string.
	     * @example
	     *
	     * _.trunc('hi-diddly-ho there, neighborino');
	     * // => 'hi-diddly-ho there, neighbo...'
	     *
	     * _.trunc('hi-diddly-ho there, neighborino', 24);
	     * // => 'hi-diddly-ho there, n...'
	     *
	     * _.trunc('hi-diddly-ho there, neighborino', {
	     *   'length': 24,
	     *   'separator': ' '
	     * });
	     * // => 'hi-diddly-ho there,...'
	     *
	     * _.trunc('hi-diddly-ho there, neighborino', {
	     *   'length': 24,
	     *   'separator': /,? +/
	     * });
	     * // => 'hi-diddly-ho there...'
	     *
	     * _.trunc('hi-diddly-ho there, neighborino', {
	     *   'omission': ' [...]'
	     * });
	     * // => 'hi-diddly-ho there, neig [...]'
	     */
	    function trunc(string, options, guard) {
	      if (guard && isIterateeCall(string, options, guard)) {
	        options = null;
	      }
	      var length = DEFAULT_TRUNC_LENGTH,
	          omission = DEFAULT_TRUNC_OMISSION;
	
	      if (options != null) {
	        if (isObject(options)) {
	          var separator = 'separator' in options ? options.separator : separator;
	          length = 'length' in options ? (+options.length || 0) : length;
	          omission = 'omission' in options ? baseToString(options.omission) : omission;
	        } else {
	          length = +options || 0;
	        }
	      }
	      string = baseToString(string);
	      if (length >= string.length) {
	        return string;
	      }
	      var end = length - omission.length;
	      if (end < 1) {
	        return omission;
	      }
	      var result = string.slice(0, end);
	      if (separator == null) {
	        return result + omission;
	      }
	      if (isRegExp(separator)) {
	        if (string.slice(end).search(separator)) {
	          var match,
	              newEnd,
	              substring = string.slice(0, end);
	
	          if (!separator.global) {
	            separator = RegExp(separator.source, (reFlags.exec(separator) || '') + 'g');
	          }
	          separator.lastIndex = 0;
	          while ((match = separator.exec(substring))) {
	            newEnd = match.index;
	          }
	          result = result.slice(0, newEnd == null ? end : newEnd);
	        }
	      } else if (string.indexOf(separator, end) != end) {
	        var index = result.lastIndexOf(separator);
	        if (index > -1) {
	          result = result.slice(0, index);
	        }
	      }
	      return result + omission;
	    }
	
	    /**
	     * The inverse of `_.escape`; this method converts the HTML entities
	     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, `&#39;`, and `&#96;` in `string` to their
	     * corresponding characters.
	     *
	     * **Note:** No other HTML entities are unescaped. To unescape additional HTML
	     * entities use a third-party library like [_he_](https://mths.be/he).
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to unescape.
	     * @returns {string} Returns the unescaped string.
	     * @example
	     *
	     * _.unescape('fred, barney, &amp; pebbles');
	     * // => 'fred, barney, & pebbles'
	     */
	    function unescape(string) {
	      string = baseToString(string);
	      return (string && reHasEscapedHtml.test(string))
	        ? string.replace(reEscapedHtml, unescapeHtmlChar)
	        : string;
	    }
	
	    /**
	     * Splits `string` into an array of its words.
	     *
	     * @static
	     * @memberOf _
	     * @category String
	     * @param {string} [string=''] The string to inspect.
	     * @param {RegExp|string} [pattern] The pattern to match words.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Array} Returns the words of `string`.
	     * @example
	     *
	     * _.words('fred, barney, & pebbles');
	     * // => ['fred', 'barney', 'pebbles']
	     *
	     * _.words('fred, barney, & pebbles', /[^, ]+/g);
	     * // => ['fred', 'barney', '&', 'pebbles']
	     */
	    function words(string, pattern, guard) {
	      if (guard && isIterateeCall(string, pattern, guard)) {
	        pattern = null;
	      }
	      string = baseToString(string);
	      return string.match(pattern || reWords) || [];
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Attempts to invoke `func`, returning either the result or the caught error
	     * object. Any additional arguments are provided to `func` when it is invoked.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {Function} func The function to attempt.
	     * @returns {*} Returns the `func` result or error object.
	     * @example
	     *
	     * // avoid throwing errors for invalid selectors
	     * var elements = _.attempt(function(selector) {
	     *   return document.querySelectorAll(selector);
	     * }, '>_>');
	     *
	     * if (_.isError(elements)) {
	     *   elements = [];
	     * }
	     */
	    var attempt = restParam(function(func, args) {
	      try {
	        return func.apply(undefined, args);
	      } catch(e) {
	        return isError(e) ? e : new Error(e);
	      }
	    });
	
	    /**
	     * Creates a function that invokes `func` with the `this` binding of `thisArg`
	     * and arguments of the created function. If `func` is a property name the
	     * created callback returns the property value for a given element. If `func`
	     * is an object the created callback returns `true` for elements that contain
	     * the equivalent object properties, otherwise it returns `false`.
	     *
	     * @static
	     * @memberOf _
	     * @alias iteratee
	     * @category Utility
	     * @param {*} [func=_.identity] The value to convert to a callback.
	     * @param {*} [thisArg] The `this` binding of `func`.
	     * @param- {Object} [guard] Enables use as a callback for functions like `_.map`.
	     * @returns {Function} Returns the callback.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 40 }
	     * ];
	     *
	     * // wrap to create custom callback shorthands
	     * _.callback = _.wrap(_.callback, function(callback, func, thisArg) {
	     *   var match = /^(.+?)__([gl]t)(.+)$/.exec(func);
	     *   if (!match) {
	     *     return callback(func, thisArg);
	     *   }
	     *   return function(object) {
	     *     return match[2] == 'gt'
	     *       ? object[match[1]] > match[3]
	     *       : object[match[1]] < match[3];
	     *   };
	     * });
	     *
	     * _.filter(users, 'age__gt36');
	     * // => [{ 'user': 'fred', 'age': 40 }]
	     */
	    function callback(func, thisArg, guard) {
	      if (guard && isIterateeCall(func, thisArg, guard)) {
	        thisArg = null;
	      }
	      return isObjectLike(func)
	        ? matches(func)
	        : baseCallback(func, thisArg);
	    }
	
	    /**
	     * Creates a function that returns `value`.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {*} value The value to return from the new function.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var object = { 'user': 'fred' };
	     * var getter = _.constant(object);
	     *
	     * getter() === object;
	     * // => true
	     */
	    function constant(value) {
	      return function() {
	        return value;
	      };
	    }
	
	    /**
	     * This method returns the first argument provided to it.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {*} value Any value.
	     * @returns {*} Returns `value`.
	     * @example
	     *
	     * var object = { 'user': 'fred' };
	     *
	     * _.identity(object) === object;
	     * // => true
	     */
	    function identity(value) {
	      return value;
	    }
	
	    /**
	     * Creates a function which performs a deep comparison between a given object
	     * and `source`, returning `true` if the given object has equivalent property
	     * values, else `false`.
	     *
	     * **Note:** This method supports comparing arrays, booleans, `Date` objects,
	     * numbers, `Object` objects, regexes, and strings. Objects are compared by
	     * their own, not inherited, enumerable properties. For comparing a single
	     * own or inherited property value see `_.matchesProperty`.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {Object} source The object of property values to match.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36, 'active': true },
	     *   { 'user': 'fred',   'age': 40, 'active': false }
	     * ];
	     *
	     * _.filter(users, _.matches({ 'age': 40, 'active': false }));
	     * // => [{ 'user': 'fred', 'age': 40, 'active': false }]
	     */
	    function matches(source) {
	      return baseMatches(baseClone(source, true));
	    }
	
	    /**
	     * Creates a function which compares the property value of `key` on a given
	     * object to `value`.
	     *
	     * **Note:** This method supports comparing arrays, booleans, `Date` objects,
	     * numbers, `Object` objects, regexes, and strings. Objects are compared by
	     * their own, not inherited, enumerable properties.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {string} key The key of the property to get.
	     * @param {*} value The value to compare.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'barney' },
	     *   { 'user': 'fred' }
	     * ];
	     *
	     * _.find(users, _.matchesProperty('user', 'fred'));
	     * // => { 'user': 'fred' }
	     */
	    function matchesProperty(key, value) {
	      return baseMatchesProperty(key + '', baseClone(value, true));
	    }
	
	    /**
	     * Adds all own enumerable function properties of a source object to the
	     * destination object. If `object` is a function then methods are added to
	     * its prototype as well.
	     *
	     * **Note:** Use `_.runInContext` to create a pristine `lodash` function
	     * for mixins to avoid conflicts caused by modifying the original.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {Function|Object} [object=this] object The destination object.
	     * @param {Object} source The object of functions to add.
	     * @param {Object} [options] The options object.
	     * @param {boolean} [options.chain=true] Specify whether the functions added
	     *  are chainable.
	     * @returns {Function|Object} Returns `object`.
	     * @example
	     *
	     * function vowels(string) {
	     *   return _.filter(string, function(v) {
	     *     return /[aeiou]/i.test(v);
	     *   });
	     * }
	     *
	     * // use `_.runInContext` to avoid conflicts (esp. in Node.js)
	     * var _ = require('lodash').runInContext();
	     *
	     * _.mixin({ 'vowels': vowels });
	     * _.vowels('fred');
	     * // => ['e']
	     *
	     * _('fred').vowels().value();
	     * // => ['e']
	     *
	     * _.mixin({ 'vowels': vowels }, { 'chain': false });
	     * _('fred').vowels();
	     * // => ['e']
	     */
	    function mixin(object, source, options) {
	      if (options == null) {
	        var isObj = isObject(source),
	            props = isObj && keys(source),
	            methodNames = props && props.length && baseFunctions(source, props);
	
	        if (!(methodNames ? methodNames.length : isObj)) {
	          methodNames = false;
	          options = source;
	          source = object;
	          object = this;
	        }
	      }
	      if (!methodNames) {
	        methodNames = baseFunctions(source, keys(source));
	      }
	      var chain = true,
	          index = -1,
	          isFunc = isFunction(object),
	          length = methodNames.length;
	
	      if (options === false) {
	        chain = false;
	      } else if (isObject(options) && 'chain' in options) {
	        chain = options.chain;
	      }
	      while (++index < length) {
	        var methodName = methodNames[index],
	            func = source[methodName];
	
	        object[methodName] = func;
	        if (isFunc) {
	          object.prototype[methodName] = (function(func) {
	            return function() {
	              var chainAll = this.__chain__;
	              if (chain || chainAll) {
	                var result = object(this.__wrapped__),
	                    actions = result.__actions__ = arrayCopy(this.__actions__);
	
	                actions.push({ 'func': func, 'args': arguments, 'thisArg': object });
	                result.__chain__ = chainAll;
	                return result;
	              }
	              var args = [this.value()];
	              push.apply(args, arguments);
	              return func.apply(object, args);
	            };
	          }(func));
	        }
	      }
	      return object;
	    }
	
	    /**
	     * Reverts the `_` variable to its previous value and returns a reference to
	     * the `lodash` function.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @returns {Function} Returns the `lodash` function.
	     * @example
	     *
	     * var lodash = _.noConflict();
	     */
	    function noConflict() {
	      context._ = oldDash;
	      return this;
	    }
	
	    /**
	     * A no-operation function which returns `undefined` regardless of the
	     * arguments it receives.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @example
	     *
	     * var object = { 'user': 'fred' };
	     *
	     * _.noop(object) === undefined;
	     * // => true
	     */
	    function noop() {
	      // No operation performed.
	    }
	
	    /**
	     * Creates a function which returns the property value of `key` on a given object.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {string} key The key of the property to get.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var users = [
	     *   { 'user': 'fred' },
	     *   { 'user': 'barney' }
	     * ];
	     *
	     * var getName = _.property('user');
	     *
	     * _.map(users, getName);
	     * // => ['fred', 'barney']
	     *
	     * _.pluck(_.sortBy(users, getName), 'user');
	     * // => ['barney', 'fred']
	     */
	    function property(key) {
	      return baseProperty(key + '');
	    }
	
	    /**
	     * The opposite of `_.property`; this method creates a function which returns
	     * the property value of a given key on `object`.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {Object} object The object to inspect.
	     * @returns {Function} Returns the new function.
	     * @example
	     *
	     * var object = { 'a': 3, 'b': 1, 'c': 2 };
	     *
	     * _.map(['a', 'c'], _.propertyOf(object));
	     * // => [3, 2]
	     *
	     * _.sortBy(['a', 'b', 'c'], _.propertyOf(object));
	     * // => ['b', 'c', 'a']
	     */
	    function propertyOf(object) {
	      return function(key) {
	        return object == null ? undefined : object[key];
	      };
	    }
	
	    /**
	     * Creates an array of numbers (positive and/or negative) progressing from
	     * `start` up to, but not including, `end`. If `end` is not specified it is
	     * set to `start` with `start` then set to `0`. If `start` is less than `end`
	     * a zero-length range is created unless a negative `step` is specified.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {number} [start=0] The start of the range.
	     * @param {number} end The end of the range.
	     * @param {number} [step=1] The value to increment or decrement by.
	     * @returns {Array} Returns the new array of numbers.
	     * @example
	     *
	     * _.range(4);
	     * // => [0, 1, 2, 3]
	     *
	     * _.range(1, 5);
	     * // => [1, 2, 3, 4]
	     *
	     * _.range(0, 20, 5);
	     * // => [0, 5, 10, 15]
	     *
	     * _.range(0, -4, -1);
	     * // => [0, -1, -2, -3]
	     *
	     * _.range(1, 4, 0);
	     * // => [1, 1, 1]
	     *
	     * _.range(0);
	     * // => []
	     */
	    function range(start, end, step) {
	      if (step && isIterateeCall(start, end, step)) {
	        end = step = null;
	      }
	      start = +start || 0;
	      step = step == null ? 1 : (+step || 0);
	
	      if (end == null) {
	        end = start;
	        start = 0;
	      } else {
	        end = +end || 0;
	      }
	      // Use `Array(length)` so engines like Chakra and V8 avoid slower modes.
	      // See https://youtu.be/XAqIpGU8ZZk#t=17m25s for more details.
	      var index = -1,
	          length = nativeMax(ceil((end - start) / (step || 1)), 0),
	          result = Array(length);
	
	      while (++index < length) {
	        result[index] = start;
	        start += step;
	      }
	      return result;
	    }
	
	    /**
	     * Invokes the iteratee function `n` times, returning an array of the results
	     * of each invocation. The `iteratee` is bound to `thisArg` and invoked with
	     * one argument; (index).
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {number} n The number of times to invoke `iteratee`.
	     * @param {Function} [iteratee=_.identity] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {Array} Returns the array of results.
	     * @example
	     *
	     * var diceRolls = _.times(3, _.partial(_.random, 1, 6, false));
	     * // => [3, 6, 4]
	     *
	     * _.times(3, function(n) {
	     *   mage.castSpell(n);
	     * });
	     * // => invokes `mage.castSpell(n)` three times with `n` of `0`, `1`, and `2` respectively
	     *
	     * _.times(3, function(n) {
	     *   this.cast(n);
	     * }, mage);
	     * // => also invokes `mage.castSpell(n)` three times
	     */
	    function times(n, iteratee, thisArg) {
	      n = +n;
	
	      // Exit early to avoid a JSC JIT bug in Safari 8
	      // where `Array(0)` is treated as `Array(1)`.
	      if (n < 1 || !nativeIsFinite(n)) {
	        return [];
	      }
	      var index = -1,
	          result = Array(nativeMin(n, MAX_ARRAY_LENGTH));
	
	      iteratee = bindCallback(iteratee, thisArg, 1);
	      while (++index < n) {
	        if (index < MAX_ARRAY_LENGTH) {
	          result[index] = iteratee(index);
	        } else {
	          iteratee(index);
	        }
	      }
	      return result;
	    }
	
	    /**
	     * Generates a unique ID. If `prefix` is provided the ID is appended to it.
	     *
	     * @static
	     * @memberOf _
	     * @category Utility
	     * @param {string} [prefix] The value to prefix the ID with.
	     * @returns {string} Returns the unique ID.
	     * @example
	     *
	     * _.uniqueId('contact_');
	     * // => 'contact_104'
	     *
	     * _.uniqueId();
	     * // => '105'
	     */
	    function uniqueId(prefix) {
	      var id = ++idCounter;
	      return baseToString(prefix) + id;
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * Adds two numbers.
	     *
	     * @static
	     * @memberOf _
	     * @category Math
	     * @param {number} augend The first number to add.
	     * @param {number} addend The second number to add.
	     * @returns {number} Returns the sum.
	     * @example
	     *
	     * _.add(6, 4);
	     * // => 10
	     */
	    function add(augend, addend) {
	      return augend + addend;
	    }
	
	    /**
	     * Gets the maximum value of `collection`. If `collection` is empty or falsey
	     * `-Infinity` is returned. If an iteratee function is provided it is invoked
	     * for each value in `collection` to generate the criterion by which the value
	     * is ranked. The `iteratee` is bound to `thisArg` and invoked with three
	     * arguments: (value, index, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Math
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {*} Returns the maximum value.
	     * @example
	     *
	     * _.max([4, 2, 8, 6]);
	     * // => 8
	     *
	     * _.max([]);
	     * // => -Infinity
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 40 }
	     * ];
	     *
	     * _.max(users, function(chr) {
	     *   return chr.age;
	     * });
	     * // => { 'user': 'fred', 'age': 40 }
	     *
	     * // using the `_.property` callback shorthand
	     * _.max(users, 'age');
	     * // => { 'user': 'fred', 'age': 40 }
	     */
	    var max = createExtremum(arrayMax);
	
	    /**
	     * Gets the minimum value of `collection`. If `collection` is empty or falsey
	     * `Infinity` is returned. If an iteratee function is provided it is invoked
	     * for each value in `collection` to generate the criterion by which the value
	     * is ranked. The `iteratee` is bound to `thisArg` and invoked with three
	     * arguments: (value, index, collection).
	     *
	     * If a property name is provided for `iteratee` the created `_.property`
	     * style callback returns the property value of the given element.
	     *
	     * If a value is also provided for `thisArg` the created `_.matchesProperty`
	     * style callback returns `true` for elements that have a matching property
	     * value, else `false`.
	     *
	     * If an object is provided for `iteratee` the created `_.matches` style
	     * callback returns `true` for elements that have the properties of the given
	     * object, else `false`.
	     *
	     * @static
	     * @memberOf _
	     * @category Math
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {*} Returns the minimum value.
	     * @example
	     *
	     * _.min([4, 2, 8, 6]);
	     * // => 2
	     *
	     * _.min([]);
	     * // => Infinity
	     *
	     * var users = [
	     *   { 'user': 'barney', 'age': 36 },
	     *   { 'user': 'fred',   'age': 40 }
	     * ];
	     *
	     * _.min(users, function(chr) {
	     *   return chr.age;
	     * });
	     * // => { 'user': 'barney', 'age': 36 }
	     *
	     * // using the `_.property` callback shorthand
	     * _.min(users, 'age');
	     * // => { 'user': 'barney', 'age': 36 }
	     */
	    var min = createExtremum(arrayMin, true);
	
	    /**
	     * Gets the sum of the values in `collection`.
	     *
	     * @static
	     * @memberOf _
	     * @category Math
	     * @param {Array|Object|string} collection The collection to iterate over.
	     * @param {Function|Object|string} [iteratee] The function invoked per iteration.
	     * @param {*} [thisArg] The `this` binding of `iteratee`.
	     * @returns {number} Returns the sum.
	     * @example
	     *
	     * _.sum([4, 6]);
	     * // => 10
	     *
	     * _.sum({ 'a': 4, 'b': 6 });
	     * // => 10
	     *
	     * var objects = [
	     *   { 'n': 4 },
	     *   { 'n': 6 }
	     * ];
	     *
	     * _.sum(objects, function(object) {
	     *   return object.n;
	     * });
	     * // => 10
	     *
	     * // using the `_.property` callback shorthand
	     * _.sum(objects, 'n');
	     * // => 10
	     */
	    function sum(collection, iteratee, thisArg) {
	      if (thisArg && isIterateeCall(collection, iteratee, thisArg)) {
	        iteratee = null;
	      }
	      var func = getCallback(),
	          noIteratee = iteratee == null;
	
	      if (!(func === baseCallback && noIteratee)) {
	        noIteratee = false;
	        iteratee = func(iteratee, thisArg, 3);
	      }
	      return noIteratee
	        ? arraySum(isArray(collection) ? collection : toIterable(collection))
	        : baseSum(collection, iteratee);
	    }
	
	    /*------------------------------------------------------------------------*/
	
	    // Ensure wrappers are instances of `baseLodash`.
	    lodash.prototype = baseLodash.prototype;
	
	    LodashWrapper.prototype = baseCreate(baseLodash.prototype);
	    LodashWrapper.prototype.constructor = LodashWrapper;
	
	    LazyWrapper.prototype = baseCreate(baseLodash.prototype);
	    LazyWrapper.prototype.constructor = LazyWrapper;
	
	    // Add functions to the `Map` cache.
	    MapCache.prototype['delete'] = mapDelete;
	    MapCache.prototype.get = mapGet;
	    MapCache.prototype.has = mapHas;
	    MapCache.prototype.set = mapSet;
	
	    // Add functions to the `Set` cache.
	    SetCache.prototype.push = cachePush;
	
	    // Assign cache to `_.memoize`.
	    memoize.Cache = MapCache;
	
	    // Add functions that return wrapped values when chaining.
	    lodash.after = after;
	    lodash.ary = ary;
	    lodash.assign = assign;
	    lodash.at = at;
	    lodash.before = before;
	    lodash.bind = bind;
	    lodash.bindAll = bindAll;
	    lodash.bindKey = bindKey;
	    lodash.callback = callback;
	    lodash.chain = chain;
	    lodash.chunk = chunk;
	    lodash.compact = compact;
	    lodash.constant = constant;
	    lodash.countBy = countBy;
	    lodash.create = create;
	    lodash.curry = curry;
	    lodash.curryRight = curryRight;
	    lodash.debounce = debounce;
	    lodash.defaults = defaults;
	    lodash.defer = defer;
	    lodash.delay = delay;
	    lodash.difference = difference;
	    lodash.drop = drop;
	    lodash.dropRight = dropRight;
	    lodash.dropRightWhile = dropRightWhile;
	    lodash.dropWhile = dropWhile;
	    lodash.fill = fill;
	    lodash.filter = filter;
	    lodash.flatten = flatten;
	    lodash.flattenDeep = flattenDeep;
	    lodash.flow = flow;
	    lodash.flowRight = flowRight;
	    lodash.forEach = forEach;
	    lodash.forEachRight = forEachRight;
	    lodash.forIn = forIn;
	    lodash.forInRight = forInRight;
	    lodash.forOwn = forOwn;
	    lodash.forOwnRight = forOwnRight;
	    lodash.functions = functions;
	    lodash.groupBy = groupBy;
	    lodash.indexBy = indexBy;
	    lodash.initial = initial;
	    lodash.intersection = intersection;
	    lodash.invert = invert;
	    lodash.invoke = invoke;
	    lodash.keys = keys;
	    lodash.keysIn = keysIn;
	    lodash.map = map;
	    lodash.mapValues = mapValues;
	    lodash.matches = matches;
	    lodash.matchesProperty = matchesProperty;
	    lodash.memoize = memoize;
	    lodash.merge = merge;
	    lodash.mixin = mixin;
	    lodash.negate = negate;
	    lodash.omit = omit;
	    lodash.once = once;
	    lodash.pairs = pairs;
	    lodash.partial = partial;
	    lodash.partialRight = partialRight;
	    lodash.partition = partition;
	    lodash.pick = pick;
	    lodash.pluck = pluck;
	    lodash.property = property;
	    lodash.propertyOf = propertyOf;
	    lodash.pull = pull;
	    lodash.pullAt = pullAt;
	    lodash.range = range;
	    lodash.rearg = rearg;
	    lodash.reject = reject;
	    lodash.remove = remove;
	    lodash.rest = rest;
	    lodash.restParam = restParam;
	    lodash.shuffle = shuffle;
	    lodash.slice = slice;
	    lodash.sortBy = sortBy;
	    lodash.sortByAll = sortByAll;
	    lodash.sortByOrder = sortByOrder;
	    lodash.spread = spread;
	    lodash.take = take;
	    lodash.takeRight = takeRight;
	    lodash.takeRightWhile = takeRightWhile;
	    lodash.takeWhile = takeWhile;
	    lodash.tap = tap;
	    lodash.throttle = throttle;
	    lodash.thru = thru;
	    lodash.times = times;
	    lodash.toArray = toArray;
	    lodash.toPlainObject = toPlainObject;
	    lodash.transform = transform;
	    lodash.union = union;
	    lodash.uniq = uniq;
	    lodash.unzip = unzip;
	    lodash.values = values;
	    lodash.valuesIn = valuesIn;
	    lodash.where = where;
	    lodash.without = without;
	    lodash.wrap = wrap;
	    lodash.xor = xor;
	    lodash.zip = zip;
	    lodash.zipObject = zipObject;
	
	    // Add aliases.
	    lodash.backflow = flowRight;
	    lodash.collect = map;
	    lodash.compose = flowRight;
	    lodash.each = forEach;
	    lodash.eachRight = forEachRight;
	    lodash.extend = assign;
	    lodash.iteratee = callback;
	    lodash.methods = functions;
	    lodash.object = zipObject;
	    lodash.select = filter;
	    lodash.tail = rest;
	    lodash.unique = uniq;
	
	    // Add functions to `lodash.prototype`.
	    mixin(lodash, lodash);
	
	    /*------------------------------------------------------------------------*/
	
	    // Add functions that return unwrapped values when chaining.
	    lodash.add = add;
	    lodash.attempt = attempt;
	    lodash.camelCase = camelCase;
	    lodash.capitalize = capitalize;
	    lodash.clone = clone;
	    lodash.cloneDeep = cloneDeep;
	    lodash.deburr = deburr;
	    lodash.endsWith = endsWith;
	    lodash.escape = escape;
	    lodash.escapeRegExp = escapeRegExp;
	    lodash.every = every;
	    lodash.find = find;
	    lodash.findIndex = findIndex;
	    lodash.findKey = findKey;
	    lodash.findLast = findLast;
	    lodash.findLastIndex = findLastIndex;
	    lodash.findLastKey = findLastKey;
	    lodash.findWhere = findWhere;
	    lodash.first = first;
	    lodash.has = has;
	    lodash.identity = identity;
	    lodash.includes = includes;
	    lodash.indexOf = indexOf;
	    lodash.inRange = inRange;
	    lodash.isArguments = isArguments;
	    lodash.isArray = isArray;
	    lodash.isBoolean = isBoolean;
	    lodash.isDate = isDate;
	    lodash.isElement = isElement;
	    lodash.isEmpty = isEmpty;
	    lodash.isEqual = isEqual;
	    lodash.isError = isError;
	    lodash.isFinite = isFinite;
	    lodash.isFunction = isFunction;
	    lodash.isMatch = isMatch;
	    lodash.isNaN = isNaN;
	    lodash.isNative = isNative;
	    lodash.isNull = isNull;
	    lodash.isNumber = isNumber;
	    lodash.isObject = isObject;
	    lodash.isPlainObject = isPlainObject;
	    lodash.isRegExp = isRegExp;
	    lodash.isString = isString;
	    lodash.isTypedArray = isTypedArray;
	    lodash.isUndefined = isUndefined;
	    lodash.kebabCase = kebabCase;
	    lodash.last = last;
	    lodash.lastIndexOf = lastIndexOf;
	    lodash.max = max;
	    lodash.min = min;
	    lodash.noConflict = noConflict;
	    lodash.noop = noop;
	    lodash.now = now;
	    lodash.pad = pad;
	    lodash.padLeft = padLeft;
	    lodash.padRight = padRight;
	    lodash.parseInt = parseInt;
	    lodash.random = random;
	    lodash.reduce = reduce;
	    lodash.reduceRight = reduceRight;
	    lodash.repeat = repeat;
	    lodash.result = result;
	    lodash.runInContext = runInContext;
	    lodash.size = size;
	    lodash.snakeCase = snakeCase;
	    lodash.some = some;
	    lodash.sortedIndex = sortedIndex;
	    lodash.sortedLastIndex = sortedLastIndex;
	    lodash.startCase = startCase;
	    lodash.startsWith = startsWith;
	    lodash.sum = sum;
	    lodash.template = template;
	    lodash.trim = trim;
	    lodash.trimLeft = trimLeft;
	    lodash.trimRight = trimRight;
	    lodash.trunc = trunc;
	    lodash.unescape = unescape;
	    lodash.uniqueId = uniqueId;
	    lodash.words = words;
	
	    // Add aliases.
	    lodash.all = every;
	    lodash.any = some;
	    lodash.contains = includes;
	    lodash.detect = find;
	    lodash.foldl = reduce;
	    lodash.foldr = reduceRight;
	    lodash.head = first;
	    lodash.include = includes;
	    lodash.inject = reduce;
	
	    mixin(lodash, (function() {
	      var source = {};
	      baseForOwn(lodash, function(func, methodName) {
	        if (!lodash.prototype[methodName]) {
	          source[methodName] = func;
	        }
	      });
	      return source;
	    }()), false);
	
	    /*------------------------------------------------------------------------*/
	
	    // Add functions capable of returning wrapped and unwrapped values when chaining.
	    lodash.sample = sample;
	
	    lodash.prototype.sample = function(n) {
	      if (!this.__chain__ && n == null) {
	        return sample(this.value());
	      }
	      return this.thru(function(value) {
	        return sample(value, n);
	      });
	    };
	
	    /*------------------------------------------------------------------------*/
	
	    /**
	     * The semantic version number.
	     *
	     * @static
	     * @memberOf _
	     * @type string
	     */
	    lodash.VERSION = VERSION;
	
	    // Assign default placeholders.
	    arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {
	      lodash[methodName].placeholder = lodash;
	    });
	
	    // Add `LazyWrapper` methods that accept an `iteratee` value.
	    arrayEach(['dropWhile', 'filter', 'map', 'takeWhile'], function(methodName, type) {
	      var isFilter = type != LAZY_MAP_FLAG,
	          isDropWhile = type == LAZY_DROP_WHILE_FLAG;
	
	      LazyWrapper.prototype[methodName] = function(iteratee, thisArg) {
	        var filtered = this.__filtered__,
	            result = (filtered && isDropWhile) ? new LazyWrapper(this) : this.clone(),
	            iteratees = result.__iteratees__ || (result.__iteratees__ = []);
	
	        iteratees.push({
	          'done': false,
	          'count': 0,
	          'index': 0,
	          'iteratee': getCallback(iteratee, thisArg, 1),
	          'limit': -1,
	          'type': type
	        });
	
	        result.__filtered__ = filtered || isFilter;
	        return result;
	      };
	    });
	
	    // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.
	    arrayEach(['drop', 'take'], function(methodName, index) {
	      var whileName = methodName + 'While';
	
	      LazyWrapper.prototype[methodName] = function(n) {
	        var filtered = this.__filtered__,
	            result = (filtered && !index) ? this.dropWhile() : this.clone();
	
	        n = n == null ? 1 : nativeMax(floor(n) || 0, 0);
	        if (filtered) {
	          if (index) {
	            result.__takeCount__ = nativeMin(result.__takeCount__, n);
	          } else {
	            last(result.__iteratees__).limit = n;
	          }
	        } else {
	          var views = result.__views__ || (result.__views__ = []);
	          views.push({ 'size': n, 'type': methodName + (result.__dir__ < 0 ? 'Right' : '') });
	        }
	        return result;
	      };
	
	      LazyWrapper.prototype[methodName + 'Right'] = function(n) {
	        return this.reverse()[methodName](n).reverse();
	      };
	
	      LazyWrapper.prototype[methodName + 'RightWhile'] = function(predicate, thisArg) {
	        return this.reverse()[whileName](predicate, thisArg).reverse();
	      };
	    });
	
	    // Add `LazyWrapper` methods for `_.first` and `_.last`.
	    arrayEach(['first', 'last'], function(methodName, index) {
	      var takeName = 'take' + (index ? 'Right' : '');
	
	      LazyWrapper.prototype[methodName] = function() {
	        return this[takeName](1).value()[0];
	      };
	    });
	
	    // Add `LazyWrapper` methods for `_.initial` and `_.rest`.
	    arrayEach(['initial', 'rest'], function(methodName, index) {
	      var dropName = 'drop' + (index ? '' : 'Right');
	
	      LazyWrapper.prototype[methodName] = function() {
	        return this[dropName](1);
	      };
	    });
	
	    // Add `LazyWrapper` methods for `_.pluck` and `_.where`.
	    arrayEach(['pluck', 'where'], function(methodName, index) {
	      var operationName = index ? 'filter' : 'map',
	          createCallback = index ? baseMatches : baseProperty;
	
	      LazyWrapper.prototype[methodName] = function(value) {
	        return this[operationName](createCallback(value));
	      };
	    });
	
	    LazyWrapper.prototype.compact = function() {
	      return this.filter(identity);
	    };
	
	    LazyWrapper.prototype.reject = function(predicate, thisArg) {
	      predicate = getCallback(predicate, thisArg, 1);
	      return this.filter(function(value) {
	        return !predicate(value);
	      });
	    };
	
	    LazyWrapper.prototype.slice = function(start, end) {
	      start = start == null ? 0 : (+start || 0);
	      var result = start < 0 ? this.takeRight(-start) : this.drop(start);
	
	      if (typeof end != 'undefined') {
	        end = (+end || 0);
	        result = end < 0 ? result.dropRight(-end) : result.take(end - start);
	      }
	      return result;
	    };
	
	    LazyWrapper.prototype.toArray = function() {
	      return this.drop(0);
	    };
	
	    // Add `LazyWrapper` methods to `lodash.prototype`.
	    baseForOwn(LazyWrapper.prototype, function(func, methodName) {
	      var lodashFunc = lodash[methodName];
	      if (!lodashFunc) {
	        return;
	      }
	      var checkIteratee = /^(?:filter|map|reject)|While$/.test(methodName),
	          retUnwrapped = /^(?:first|last)$/.test(methodName);
	
	      lodash.prototype[methodName] = function() {
	        var args = arguments,
	            length = args.length,
	            chainAll = this.__chain__,
	            value = this.__wrapped__,
	            isHybrid = !!this.__actions__.length,
	            isLazy = value instanceof LazyWrapper,
	            iteratee = args[0],
	            useLazy = isLazy || isArray(value);
	
	        if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {
	          // avoid lazy use if the iteratee has a `length` other than `1`
	          isLazy = useLazy = false;
	        }
	        var onlyLazy = isLazy && !isHybrid;
	        if (retUnwrapped && !chainAll) {
	          return onlyLazy
	            ? func.call(value)
	            : lodashFunc.call(lodash, this.value());
	        }
	        var interceptor = function(value) {
	          var otherArgs = [value];
	          push.apply(otherArgs, args);
	          return lodashFunc.apply(lodash, otherArgs);
	        };
	        if (useLazy) {
	          var wrapper = onlyLazy ? value : new LazyWrapper(this),
	              result = func.apply(wrapper, args);
	
	          if (!retUnwrapped && (isHybrid || result.__actions__)) {
	            var actions = result.__actions__ || (result.__actions__ = []);
	            actions.push({ 'func': thru, 'args': [interceptor], 'thisArg': lodash });
	          }
	          return new LodashWrapper(result, chainAll);
	        }
	        return this.thru(interceptor);
	      };
	    });
	
	    // Add `Array` and `String` methods to `lodash.prototype`.
	    arrayEach(['concat', 'join', 'pop', 'push', 'replace', 'shift', 'sort', 'splice', 'split', 'unshift'], function(methodName) {
	      var func = (/^(?:replace|split)$/.test(methodName) ? stringProto : arrayProto)[methodName],
	          chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',
	          retUnwrapped = /^(?:join|pop|replace|shift)$/.test(methodName);
	
	      lodash.prototype[methodName] = function() {
	        var args = arguments;
	        if (retUnwrapped && !this.__chain__) {
	          return func.apply(this.value(), args);
	        }
	        return this[chainName](function(value) {
	          return func.apply(value, args);
	        });
	      };
	    });
	
	    // Map minified function names to their real names.
	    baseForOwn(LazyWrapper.prototype, function(func, methodName) {
	      var lodashFunc = lodash[methodName];
	      if (lodashFunc) {
	        var key = lodashFunc.name,
	            names = realNames[key] || (realNames[key] = []);
	
	        names.push({ 'name': methodName, 'func': lodashFunc });
	      }
	    });
	
	    realNames[createHybridWrapper(null, BIND_KEY_FLAG).name] = [{ 'name': 'wrapper', 'func': null }];
	
	    // Add functions to the lazy wrapper.
	    LazyWrapper.prototype.clone = lazyClone;
	    LazyWrapper.prototype.reverse = lazyReverse;
	    LazyWrapper.prototype.value = lazyValue;
	
	    // Add chaining functions to the `lodash` wrapper.
	    lodash.prototype.chain = wrapperChain;
	    lodash.prototype.commit = wrapperCommit;
	    lodash.prototype.plant = wrapperPlant;
	    lodash.prototype.reverse = wrapperReverse;
	    lodash.prototype.toString = wrapperToString;
	    lodash.prototype.run = lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;
	
	    // Add function aliases to the `lodash` wrapper.
	    lodash.prototype.collect = lodash.prototype.map;
	    lodash.prototype.head = lodash.prototype.first;
	    lodash.prototype.select = lodash.prototype.filter;
	    lodash.prototype.tail = lodash.prototype.rest;
	
	    return lodash;
	  }
	
	  /*--------------------------------------------------------------------------*/
	
	  // Export lodash.
	  var _ = runInContext();
	
	  // Some AMD build optimizers like r.js check for condition patterns like the following:
	  if (true) {
	    // Expose lodash to the global object when an AMD loader is present to avoid
	    // errors in cases where lodash is loaded by a script tag and not intended
	    // as an AMD module. See http://requirejs.org/docs/errors.html#mismatch for
	    // more details.
	    root._ = _;
	
	    // Define as an anonymous module so, through path mapping, it can be
	    // referenced as the "underscore" module.
	    !(__WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      return _;
	    }.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  }
	  // Check for `exports` after `define` in case a build optimizer adds an `exports` object.
	  else if (freeExports && freeModule) {
	    // Export for Node.js or RingoJS.
	    if (moduleExports) {
	      (freeModule.exports = _)._ = _;
	    }
	    // Export for Narwhal or Rhino -require.
	    else {
	      freeExports._ = _;
	    }
	  }
	  else {
	    // Export for a browser or Rhino.
	    root._ = _;
	  }
	}.call(this));
	
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! ./../webpack/buildin/module.js */ 31)(module), (function() { return this; }())))

/***/ },
/* 31 */
/*!***********************************!*\
  !*** (webpack)/buildin/module.js ***!
  \***********************************/
/***/ function(module, exports) {

	module.exports = function(module) {
		if(!module.webpackPolyfill) {
			module.deprecate = function() {};
			module.paths = [];
			// module.parent = undefined by default
			module.children = [];
			module.webpackPolyfill = 1;
		}
		return module;
	}


/***/ },
/* 32 */
/*!************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.const.js ***!
  \************************************************************************/
/***/ function(module, exports) {

	module.exports = "// テスト時は書き換えること。本番はnull, テストはその他\r\nvar _GH_MODE_LIST = [\"PROD\", \"TEST\", \"DEV\"];\r\nvar _GH_MODE = _GH_MODE_LIST[2];\r\nvar _GH_CONNS = {\r\n    PROD: \"\",\r\n    TEST: window.location.protocol + \"//\" + window.location.host + \"/GH_API/gh/\",\r\n    DEV : \"http://localhost:3000/\"\r\n};\r\n\r\n/**\r\n * API接続先情報\r\n * TODO モードによって切り替えたい\r\n */\r\nvar _GHAPI = {\r\n    SERVER : window.location.protocol + \"//\" + window.location.host + \"/\",\r\n    URL : {\r\n        AUTH : \"auth/login/\"\r\n    },\r\n    FCM_PATH:{\r\n        SW_PATH:'/resources/WebContent/js/src/firebasejs/sw.js'\r\n    },\r\n};\r\nvar _GH = (function(){\r\n    \"use strict\"\r\n    return {\r\n        URL: function(url) {\r\n            return _GHAPI.URL[url];\r\n        },\r\n        FILE_ROOT: window.location.protocol + \"//\" + window.location.host + \"/\",\r\n        ICON_SIZE: 24,\r\n        SCREEN_TYPE : {\r\n            SCHEDULE: {pattern : \"2E\", name : \"Request Booking\", hash: \"#schedule\", useEntryTree: false, loginType: [1, 2]}\r\n        },\r\n        PATH_TYPE : {\r\n            TEMPLATE : \"/resources/WebContent/template/data/\",\r\n            DHX_ICONS : \"/resources/WebContent/codebase/imgs/dhxtoolbar_skyblue\",\r\n            SKIN : \"dhx_skyblue\",\r\n            GRID_NAV: \"bricks\",\r\n            DHX_IMGS : \"/resources/WebContent/codebase/imgs/\",\r\n            CODE_DEF : \"/resources/WebContent/template/codeDef.json\"\r\n        },\r\n        // コード定義\r\n        CODE_DEF : {\r\n            STATUS: 1,\r\n            SCHED_DEL_REASON : 67,\r\n            SCHED_MS_PURPOSE : 69,\r\n            SCHED_COUNT   : 95,\r\n            SCHED_COND        : 96,\r\n            SCHED_MS_PLACE : 97\r\n        },\r\n        // データファイル名\r\n        DATA_PATH : {\r\n            SCHD_FORM_JSON : {filename: \"FilterRequest.json\", common: true},\r\n            SCHD_LIGHT_FORM_JSON : {filename: \"BookingForm.json\", common: true},\r\n            SERVICES_ASSETS_WIN : {filename: \"ServicesAssetsWin.json\", common: true},\r\n            SERVICES_ASSETS_GRID : {filename: \"ServicesAssetsGrid.json\", common: true},\r\n            WIN_BUILDING_FORM_JSON : {filename: \"BuildingWinForm.json\", common: true},\r\n            BUILDING_GIRD : {filename: \"BuildingGrid.json\", common: true}\r\n        },\r\n        FORMAT : {\r\n            YMD : \"%Y/%m/%d\",\r\n            YMD_HM : \"%Y/%m/%d %H:%i\",\r\n            YMD_HMS : \"%Y/%m/%d %H:%i:%s\",\r\n            YMDHMS : \"%Y%m%d%H%i%s\",\r\n            AREA_DELIMITER: \"/\",\r\n            SCHD_INTERVAL: 2,\r\n            GRID_NAV: {\r\n                records:\"レコード数&nbsp;&nbsp;\",\r\n                to:\" - \",\r\n                page:\"ページ\",\r\n                perpage:\"行 / ページ\",\r\n                of:\" / 全\",\r\n                notfound:\"該当データがありませんでした。\"\r\n            },\r\n            GRID_BORDER1: \"border-style: solid; border-width: 0px 0.5px; border-color: rgba(118, 118, 118, 0.5);\" /** 縦にGrayの罫線を引く */\r\n        },\r\n        // キーボードのキーコード\r\n        KEY_CODE : {\r\n            ENTER: 13\r\n        },\r\n        WINS : {\r\n            EVENT_MODE : {\r\n                // ウィンドウの幅、ウィンドウの高さ、物件専用フラグ、物件＋部屋フラグ\r\n                EVENT: {width: 360, height: 410, isEvent: true, isRoom: false}\r\n            }\r\n        },\r\n        // スケジュール\r\n        S07F010Sche : {\r\n            HTML: {\r\n                // カレンダー表示切り替えボタン用のソース\r\n                CAL_BTN : '<div class=\"dhx_cal_tab\" name=\"day_tab\" style=\"right:204px;\"></div>'\r\n                                + '<div class=\"dhx_cal_tab\" name=\"week_tab\" style=\"right:140px;\"></div>'\r\n                                + '<div class=\"dhx_cal_tab\" name=\"month_tab\" style=\"right:76px;\"></div>'\r\n                                + '<div class=\"dhx_cal_tab\" name=\"agenda_tab\" style=\"right:280px;\"></div>'\r\n            },\r\n            // イベントのカラー定義\r\n            EVENT_COLOR: {\r\n                NORMAL: { // １つ目は薄い色、２つ目は濃い色。事業部によって定義が異なる。\r\n                    1: {back: \"#1D2088\", text: \"#000000\"},\r\n                    2: {back: \"#A3BCE2\", text: \"#000000\"},\r\n                    3: {back: \"#6C9BD2\", text: \"#000000\"}\r\n                }\r\n            },\r\n            // Calendar Viewの種別定義\r\n            VIEW_MODE: {\r\n                DAY : \"day\",\r\n                WEEK : \"week\",\r\n                MONTH : \"month\"\r\n            },\r\n            // 絞込ウィンドウ\r\n            FILTER_WIN_FORM : [\r\n                {type: \"settings\", position: \"label-right\"},\r\n                {type: \"fieldset\", label: \"表示させる項目を選んでください\", width: 300, offsetLeft: 15, list:[]},\r\n                {type: \"fieldset\", label: \"オプション\", width: 300, offsetLeft: 15, list:[\r\n                    {type: \"button\", name: \"allCheck\", value: \"すべてチェック\"},\r\n                    {type: \"newcolumn\"},\r\n                    {type: \"button\", name: \"allUncheck\", value: \"すべてはずす\", offsetLeft: 15}\r\n                ]},\r\n               {type: \"button\", name: \"selectBtn\", value: \"選択する\", offsetLeft: 200}\r\n           ],\r\n           TANTO_TYPE: {\r\n               // 案内者\r\n               1 : {id: \"organizer\", name: \"organizerFullName\"},\r\n               // 同行者\r\n               2 : {id: \"attendee1\", name: \"attendeeFullName1\"},\r\n               // 接客者\r\n               3 : {id: \"attendee2\", name: \"attendeeFullName2\"},\r\n               4 : {id: \"attendee3\", name: \"attendeeFullName3\"}\r\n           }\r\n        }\r\n    };\r\n}());\r\n"

/***/ },
/* 33 */
/*!**************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.message.js ***!
  \**************************************************************************/
/***/ function(module, exports) {

	module.exports = "/**\r\n * SFAのメッセージ出力定数クラス\r\n */\r\nvar _MSG = (function(){\r\n    \"use strict\";\r\n        // 本番モード\r\n        return {\r\n            //共通\r\n            COMMON : {\r\n                UNLOAD: \"SFA/CRMのページの確認です。\"\r\n            },\r\n            //ログイン\r\n            S01F000 : {\r\n            },\r\n            //ログアウト\r\n            S01F005 : {\r\n            },\r\n            //メニュー\r\n            S01F010 : {\r\n            },\r\n            //Top\r\n            S01F020 : {\r\n            },\r\n            //担当者ウィンドウ\r\n            S01F500 : {\r\n            },\r\n            //希望地域ウィンドウ\r\n            S01F510 : {\r\n            },\r\n            //現場名ウィンドウ\r\n            S01F520 : {\r\n            },\r\n            //物件ウィンドウ\r\n            S01F530 : {\r\n            },\r\n            //沿線ウィンドウ\r\n            S01F540 : {\r\n            },\r\n            //駅ウィンドウ\r\n            S01F545 : {\r\n            },\r\n            //郵便番号ウィンドウ\r\n            S01F550 : {\r\n            },\r\n            //顧客検索ウィンドウ表示\r\n            S01F560 : {\r\n            },\r\n            //追客履歴ウィンドウ表示\r\n            S01F570 : {\r\n            },\r\n            //問合せ物件ウィンドウ表示\r\n            S01F580 : {\r\n            },\r\n            //反響ツリー\r\n            S02F010 : {\r\n            },\r\n            //簡易検索\r\n            S02F020 : {\r\n            },\r\n            //詳細検索\r\n            S02F030 : {\r\n            },\r\n            //顧客メイン\r\n            S03F010 : {\r\n                M_001 : \"顧客ステータスを契約にして保存すると、契約済み顧客となりますが、本当によろしいですか？\"\r\n            },\r\n            //顧客詳細ウィンドウ\r\n            S03F020 : {\r\n            },\r\n            //担当者へ転送ウィンドウ\r\n            S03F030 : {\r\n            },\r\n            //クレームウィンドウ\r\n            S03F040 : {\r\n            },\r\n            //契約一覧\r\n            S03F050 : {\r\n            },\r\n            //新規契約\r\n            S03F060 : {\r\n            },\r\n            //契約増減\r\n            S03F070 : {\r\n            },\r\n            //解約\r\n            S03F080 : {\r\n            },\r\n            //対応履歴タブ\r\n            S03F090 : {\r\n                M_001 : \"対象の対応履歴を削除します。<br>この機能は間違えて登録してしまった場合以外は使用しないでください。<br>(不正に削除した場合、削除した理由を提出していただきます。)\"\r\n            },\r\n            //電話つながるグラフ\r\n            S03F100 : {\r\n            },\r\n            //電話掛けTop\r\n            S04F010 : {\r\n            },\r\n            //一斉メールTop\r\n            S05F010 : {\r\n            },\r\n            //メール作成ウィンドウ\r\n            S05F020 : {\r\n            },\r\n            // library management\r\n            S05F030 : {\r\n                M_001 : \"フォルダの階層は10階層までしか作成できません。\"\r\n                ,M_002 : \"選択しているフォルダは削除できません。<br>システムフォルダやフォルダの中にライブラリを持っているフォルダは削除できません。\"\r\n                ,M_003 : \"選択しているライブラリを削除する権限がないため、削除できません。\"\r\n                ,M_004 : \"同じ名前のフォルダがあるため、処理ができません。\"\r\n                ,M_005 : \"同じ名前のライブラリがあるため、処理ができません。\"\r\n                ,M_006 : \"このフォルダー以下に含まれる全ファイルを表示するため、表示に時間がかかります。<br>よろしいですか？\"\r\n                ,M_007 : \"選択しているフォルダは名前の変更ができません。<br>システムフォルダやごみ箱は変更できません。\"\r\n                ,M_008 : \"該当フォルダにはフォルダを作成することができません。\"\r\n                ,M_009 : \"他の事業部のフォルダー内は操作することができません。\"\r\n                ,M_010 : \"選択したライブラリを操作する権限がありません。\"\r\n                ,M_011 : \"他の事業部のライブラリは操作することができません。\"\r\n            },\r\n            //ライブラリ選択ウィンドウ\r\n            S05F050 : {\r\n            },\r\n            //ライブラリ作成／編集ウィンドウ\r\n            S05F060 : {\r\n            },\r\n            //未送信管理\r\n            S05F070 : {\r\n            },\r\n            //DMTop\r\n            S06F010 : {\r\n            },\r\n            //案内一覧\r\n            S07F010 : {\r\n            },\r\n            //案内予約登録／変更ウィンドウ\r\n            S07F020 : {\r\n                M_001: \"ルールで決まっている７日よりも前の予約を登録しようとしていますが、よろしいですか？\"\r\n            },\r\n            //行動実績Top\r\n            S09F010 : {\r\n            },\r\n            //帳票Top\r\n            S09F020 : {\r\n            },\r\n            //案内予定表\r\n            S09F500 : {\r\n            },\r\n            //課毎契約一覧\r\n            S09F505 : {\r\n            },\r\n            //今週の売上\r\n            S09F510 : {\r\n            },\r\n            //月次報告-店舗×媒体契約率など\r\n            S09F515 : {\r\n            },\r\n            //鳴り物件一覧\r\n            S09F520 : {\r\n            },\r\n            //案内集計\r\n            S09F525 : {\r\n            },\r\n            //営業の追客実績集計\r\n            S09F530 : {\r\n            },\r\n            //月次報告-ポータルサイト評価\r\n            S09F535 : {\r\n            },\r\n            //反響数集計（現：反響簿）\r\n            S09F540 : {\r\n            },\r\n            //役員会資料用データ\r\n            S09F545 : {\r\n            },\r\n            //経営ボード会議用データ\r\n            S09F550 : {\r\n            },\r\n            //販売MGR会議用データ\r\n            S09F555 : {\r\n            },\r\n            //センター長会議資料用データ\r\n            S09F560 : {\r\n            },\r\n            //契約一覧データ\r\n            S09F565 : {\r\n            },\r\n            //営業マン別対応履歴（戸建）\r\n            S09F570 : {\r\n            },\r\n            //反響媒体別件数\r\n            S09F700 : {\r\n            },\r\n            //成績表（１）\r\n            S09F705 : {\r\n            },\r\n            //成績表（２）\r\n            S09F710 : {\r\n            },\r\n            //成績表（３）\r\n            S09F715 : {\r\n            },\r\n            //成績表（４）\r\n            S09F720 : {\r\n            },\r\n            //販売進捗状況\r\n            S09F725 : {\r\n            },\r\n            //業務予定書\r\n            S09F730 : {\r\n            },\r\n            //見込み客リスト\r\n            S09F735 : {\r\n            },\r\n            //交渉件数\r\n            S09F740 : {\r\n            },\r\n            //物件別交渉件数\r\n            S09F745 : {\r\n            },\r\n            //期間内進捗状況表\r\n            S09F750 : {\r\n            },\r\n            //週間来場者分析\r\n            S09F755 : {\r\n            },\r\n            //価格表（進捗表）\r\n            S09F760 : {\r\n            },\r\n            //契約一覧\r\n            S09F765 : {\r\n            },\r\n            //指示・報告Top\r\n            S10F010 : {\r\n                M_001 : \"指示報告を完了するためには、報告を入力してください。\"\r\n            },\r\n            //指示・報告タブ\r\n            S10F020 : {\r\n            },\r\n            //指示ウィンドウ\r\n            S10F030 : {\r\n            },\r\n            //担当変更Top\r\n            S11F010 : {\r\n            },\r\n            //担当変更ウィンドウ\r\n            S11F020 : {\r\n            },\r\n            //レコメンド物件タブ\r\n            S12F010 : {\r\n            },\r\n            //問合せ物件タブ\r\n            S12F020 : {\r\n                M_001 : \"問合せ物件を削除します。よろしいですか？\",\r\n                M_002 : \"本当にこのイベントを削除してもよろしいですか？\"\r\n            },\r\n            //成績表Top\r\n            S13F010 : {\r\n            },\r\n            //顧客登録・検索\r\n            C01F010 : {\r\n                M_001 : \"選択した問合せ物件を削除しますか？\"\r\n                ,M_002 : \"現在編集中の顧客情報は破棄されます。よろしいですか？\"\r\n                ,M_003 : \"姓とかな（姓）のどちらかは必ず入力してください。\"\r\n                ,M_004 : \"反響日は必ず入力してください。\"\r\n                ,M_005 : \"担当者は必ず入力してください。\"\r\n                ,M_006 : \"媒体は必ず入力してください。\"\r\n                ,M_007 : \"選択した反響に変更します。よろしいですか？\"\r\n                ,M_008 : \"画面下の重複エントリー一覧から対象となる行を選択してください。\"\r\n                ,M_009 : \"希望地域の文字数が多すぎます。\"\r\n                ,M_010 : \"再反基準日は必ず入力してください。\"\r\n                ,M_011 : \"登録しました。引き続き編集しますか？\"\r\n                ,M_012 : \"顧客を削除します。よろしいですか？\"\r\n            },\r\n            //顧客検索結果\r\n            C01F020 : {\r\n                M_001 : \"再反基準日は必ず入力してください。\"\r\n            },\r\n            //Web未処理反響一覧\r\n            C01F030 : {\r\n                M_001 : \"該当の反響情報を削除しますか？<br>(削除を行うと、反響情報のデータが全て消えます。)\",\r\n                M_002 : \"該当の反響情報を登録しますか？\"\r\n            },\r\n            //顧客の結合\r\n            C01F040 : {\r\n                M_001 : \"結合処理を実行します。サブ情報は削除されます。一度削除したデータは元に戻せません。結合処理を実行してもよろしいですか？\",\r\n                M_002 : \"その顧客情報は既に選択されています。\",\r\n                M_003 : \"他事業部間の顧客同士は結合ができません。\",\r\n                M_004 : \"現在編集中の顧客情報は破棄されます。よろしいですか？\"\r\n            },\r\n            //リレーション登録・解除\r\n            C01F050 : {\r\n            },\r\n            //担当者へ連絡ウィンドウ\r\n            C01F060 : {\r\n            },\r\n            //リンク\r\n            C01F070 : {\r\n            },\r\n            //リンク（マスタメンテ）タブ\r\n            M01F010 : {\r\n            },\r\n            //現場名マスタ\r\n            M01F020 : {\r\n            },\r\n            //物件マスタ\r\n            M01F030 : {\r\n            },\r\n            //反響媒体マスタ\r\n            M01F040 : {\r\n            },\r\n            //組織マスタ\r\n            M01F050 : {\r\n                M_001 : \"組織は5階層までしか作成できません。\"\r\n                ,M_002 : \"選択した組織を削除しますか？\"\r\n                ,M_003 : \"削除しようとした組織には子組織または所属するユーザ存在するため削除できません。<br>小組織がある場合は、先にそちらを削除してください。<br>また所属するユーザがいれば、そのユーザを別の組織に移動させてください。\"\r\n            },\r\n            //ユーザマスタ\r\n            M01F060 : {\r\n            },\r\n            //カレンダーマスタ\r\n            M01F070 : {\r\n            },\r\n            //目標管理マスタ\r\n            M01F080 : {\r\n            }\r\n        };\r\n}());\r\n"

/***/ },
/* 34 */
/*!*************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.global.js ***!
  \*************************************************************************/
/***/ function(module, exports) {

	module.exports = "/**\r\n * SFAで使うグローバル変数\r\n */\r\n/**\r\n * ユーザ情報\r\n */\r\nvar _ghUser = (function() {\r\n    \"use strict\";\r\n    var _ghId = 0;   // user ID（GH ID）\r\n    var _adId = \"\";   // ActiveDirectoryID\r\n    var _pwd = \"\";\r\n    var _name = \"\"; // ユーザ名（社員名）\r\n    var _manDivisionIds = []; // 権限のある組織ID\r\n    var _divisionId = \"\";    // 所属組織ID\r\n    var _divisionName = \"\";    // 所属組織\r\n    var _role = [];   // ロール\r\n    var _authToken = \"\"; // 認証トークン\r\n    var _admitDepartment = 1; // 承認用事業部\r\n    var _kmType = _GH.KD; // 戸建て／MS種別（戸建て／MSどちらを表示するか）\r\n    var _login = false;     // ログインしているかどうか\r\n    var _loginType = _GH.NON;\r\n    var _neType = _GH.NON;\r\n\r\n    // Cookieにログイン情報を格納する。\r\n    function _saveCookie() {\r\n        var loginInfo = {\r\n            ghId : _ghId,\r\n            adId: _adId,\r\n            pwd: _pwd,\r\n            name : _name,\r\n            manDivisionIds : _manDivisionIds,\r\n            divisionId : _divisionId,\r\n            role : _role,\r\n            authToken : _authToken,\r\n            admitDepartment: _admitDepartment,\r\n            kmType : _kmType,\r\n            login : _login,\r\n            loginType : _loginType,\r\n            neType : _neType\r\n        };\r\n        setGhCookie(_GH.COOKIE.LOGIN, encodeURI(JSON.stringify(loginInfo)));\r\n    };\r\n\r\n    // 認証トークンが有効かどうかをテストする。\r\n    function  _testAuthToken() {\r\n        var result = false;\r\n        try {\r\n            if (!_.isEmpty(_authToken) && _loginType) {\r\n                var division = getJSONSync(\"employee/connect\");\r\n                result = !_.isEmpty(division);\r\n            }\r\n        } catch(e) {\r\n            console.log(\"認証トークン確認中エラー\", e);\r\n        }\r\n        return result;\r\n    }\r\n    function _setHeaderInfo(response, adId, pwd) {\r\n        console.log(\"認証レスポンス\", response);\r\n        _authToken = response.getResponseHeader(\"AUTHORIZED_TOKEN\");\r\n        _role = safeCommaSplit(response.getResponseHeader(\"ROLEID_LIST\"));\r\n        _loginType = _.parseInt(response.getResponseHeader(\"LOGIN_TYPE\"));\r\n        _admitDepartment = safeCommaSplit(response.getResponseHeader(\"AUTHORIZED_ADMIT_DEPARTMENTS\"), true);\r\n        _neType = _GH.NE_TYPE[_loginType];\r\n        _ghId = _.parseInt(response.getResponseHeader(\"LOGIN_USER_ID\"));\r\n        _name = b64_to_utf8(response.getResponseHeader(\"LOGIN_USER_NAME\"));\r\n        _manDivisionIds = safeCommaSplit(response.getResponseHeader(\"MANAGE_DIVISON_IDS\"), true);\r\n        _divisionId = _.parseInt(response.getResponseHeader(\"EMPLOYEE_DIVISION_ID\"));\r\n        _divisionName = b64_to_utf8(response.getResponseHeader(\"EMPLOYEE_DIVISION_NAME\"));\r\n        console.log(\"login type:\" + _loginType);\r\n        if(adId) _adId = adId;\r\n        if(pwd) _pwd = window.btoa(pwd);\r\n        _login = true;\r\n        _saveCookie();\r\n    }\r\n    function _connectApi(moveErrPage) {\r\n        var r = null;\r\n        var url = _GHAPI.SERVER + \"employee/connect\";\r\n        try {\r\n            // 認証トークンや事業部がない場合はCookieから取る。\r\n            var cookies = getCookies();\r\n            var loginInfo = (_.isEmpty(cookies[_GH.COOKIE.LOGIN]))? null: JSON.parse(decodeURI(cookies[_GH.COOKIE.LOGIN]));\r\n            // Cookie情報が正しい場合は、ログイン情報をセットする。\r\n            if (loginInfo) {\r\n                _ghId = loginInfo.ghId;\r\n                _adId = loginInfo.adId;\r\n                _pwd = loginInfo.pwd;\r\n                _name = loginInfo.name;\r\n                _manDivisionIds = loginInfo.manDivisionIds;\r\n                _divisionId = loginInfo.divisionId;\r\n                _role = loginInfo.role;\r\n                _authToken = loginInfo.authToken;\r\n                _admitDepartment = loginInfo.admitDepartment;\r\n                _kmType = loginInfo.kmType;\r\n                _login = loginInfo.login;\r\n                _loginType = loginInfo.loginType;\r\n                _neType = loginInfo.neType;\r\n            }\r\n            if (! _loginType) {\r\n                // default to recruit type - NON if when no recruit type was selected\r\n                _loginType = _GH.LOGIN_TYPE.NON;\r\n            }\r\n            if (!_.isEmpty(_authToken)) {\r\n                r = window.dhx4.ajax.getSync(url);\r\n            } else {\r\n                return false;\r\n            }\r\n        } catch(e) {\r\n            //FIXME Windows統合認証をする場合はエラーになったら事業部を変える必要がある\r\n            console.log(\"認証トークン確認中エラー\", e);\r\n            if (moveErrPage) {\r\n                location.href = \"login_error.html\";\r\n                window.onbeforeunload = null;\r\n            }\r\n            return false;\r\n        }\r\n        var t = null;\r\n        t = r.xmlDoc;\r\n        var httpStatus = t.status; // number\r\n        if (t != null) {\r\n            if(!_login) {\r\n                _setHeaderInfo(t);\r\n                dhtmlx.message({text: \"ようこそ、\" + _ghUser.getName() + \"さん\"});\r\n            }\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n    /**\r\n     * ログアウトする\r\n     */\r\n    function _logout() {\r\n        try {\r\n            getJSONSync(\"auth/logout\");\r\n        } catch (e) {\r\n            console.log(\"ログアウト時のエラー\", e);\r\n        }\r\n    }\r\n\r\n    return {\r\n        // user ID (GH ID)\r\n        getGhId : function() {\r\n            return _ghId;\r\n        },\r\n        setGhId : function(ghId) {\r\n            _ghId = ghId;\r\n        },\r\n        getAdId : function() {\r\n            return _adId;\r\n        },\r\n        getPwd : function() {\r\n            return window.atob(_pwd);\r\n        },\r\n        // ユーザ名（社員名）\r\n        getName : function() {\r\n            return _name;\r\n        },\r\n        setName : function(name) {\r\n            _name = name;\r\n        },\r\n        // login type\r\n        getLoginType : function() {\r\n            return _loginType;\r\n        },\r\n        setLoginType : function(loginType) {\r\n            _loginType = _.parseInt(loginType);\r\n            _neType = _GH.NE_TYPE[_loginType];\r\n        },\r\n        // 所属組織ID\r\n        getDivisionId : function() {\r\n            return _divisionId;\r\n        },\r\n        setDivisionId : function(orgId) {\r\n            _divisionId = orgId;\r\n        },\r\n        // 所属組織\r\n        getDivisionName : function() {\r\n            return _divisionName;\r\n        },\r\n        setDivisionName : function(org) {\r\n            _divisionName = org;\r\n        },\r\n        // 権限のある組織\r\n        getManDivisionIds : function() {\r\n           return _manDivisionIds;\r\n        },\r\n        // 引数の組織IDに対して権限があるかどうか\r\n        hasManDivision : function(divisionId) {\r\n            if (!divisionId) return false;\r\n            if (!_.isNumber(divisionId)) divisionId = _.parseInt(divisionId.toString());\r\n            return _.indexOf(_manDivisionIds, divisionId) >= 0;\r\n        },\r\n        // ロール\r\n        getRole : function() {\r\n            return _role;\r\n        },\r\n        setRole : function(roleString) {\r\n            _role = roleString.split(\",\");\r\n        },\r\n        hasRole : function(roleString) {\r\n            // 指定したロールを持っているかどうかを確認。ECMAScript5\r\n            return _role.indexOf(roleString) >= 0;\r\n        },\r\n        isShien : function() {\r\n            // 営業支援ロールを持っているかどうかを確認\r\n//            var role = (_department == _GH.DEPTARTMENT.MS)?\r\n//                    _GH.ROLE.PERSONAL_ALL_SEARCH_MANSION: _GH.ROLE.PERSONAL_ALL_SEARCH_HOUSE;\r\n//            return _role.indexOf(role) >= 0;\r\n        \treturn true;\r\n        },\r\n        isApprove : function() {\r\n            // ライブラリ承認権限があるかどうか\r\n            return _role.indexOf(_GH.ROLE.TEMPLATE_CHECK_MANAGER) >= 0 || _role.indexOf(_GH.ROLE.TEMPLATE_CHECK_MARKETING) >= 0;\r\n        },\r\n        // 認証トークン\r\n        getAuthToken : function() {\r\n            return _authToken;\r\n        },\r\n        setAuthToken : function(authToken) {\r\n            _authToken = authToken;\r\n        },\r\n        // 戸建て／MS種別\r\n        getKMType : function() {\r\n            return _kmType;\r\n        },\r\n        getNEType : function() {\r\n            return _neType;\r\n        },\r\n        isNon : function() {\r\n            return _neType == _GH.NON;\r\n        },\r\n        isExp : function() {\r\n            return _neType == _GH.EXP;\r\n        },\r\n        setKD : function() {\r\n            _kmType = _GH.KD;\r\n        },\r\n        setMS : function() {\r\n            _kmType = _GH.MS;\r\n        },\r\n        swapKMType : function() {\r\n            if (_kmType == _GH.KD) {\r\n                _kmType = _GH.MS;\r\n            } else {\r\n                _kmType = _GH.KD;\r\n            }\r\n        },\r\n        // 営業員かどうか(営業であればTrue、支援やマーケ、情シスであればFalse)\r\n        isSales : function() {\r\n            return _role.indexOf(_GH.ROLE.EIGYOIN) >= 0;\r\n        },\r\n        // MSのリフォーム担当（オーダーシステム課）かどうか\r\n        isMSReform : function() {\r\n            return _kmType == _GH.MS && _role.indexOf(_GH.ROLE.REFORM_MANSION) >= 0;\r\n        },\r\n        // 上長かどうかを判断する。\r\n        isManager : function(divisionId) {\r\n//            console.log(\"Lodashのテスト1\", _.has([1,2,3,4,5], 4));\r\n//            console.log(\"Lodashのテスト2\", _.has([1,2,3,4,5], 9));\r\n            //TODO 顧客のDivisionIdを見て判断すること\r\n            return (_manDivisionIds.length > 0);\r\n        },\r\n        // ログインフラグ\r\n        isLogin : function() {\r\n            return _login;\r\n        },\r\n        setLogin : function(login) {\r\n            _login = login;\r\n        },\r\n        /**\r\n         * Checks whether you're in the main screen (index.html)\r\n         * @returns {boolean} Returns true when in main screen, otherwise false.\r\n         */\r\n        inMainScreen: function() {\r\n            return _.endsWith(window.location.pathname, 'index.html');\r\n        },\r\n        // レスポンスヘッダーから値を取得する\r\n        setHeaderInfo: function(response, adId, pwd) {\r\n            _setHeaderInfo(response, adId, pwd);\r\n        },\r\n        // APIへの接続確認を実施する。\r\n        checkConnect : function() {\r\n            return _connectApi(false);\r\n        },\r\n        logout : function() {\r\n            _logout();\r\n        },\r\n        // toStringのオーバーライド\r\n        toString : function() {\r\n            var str = \"戸建て/MS[\" + _kmType + \"], SFA_ID[\" + _ghId + \"], ユーザ名[\" + _name + \"], 所属組織[\" + _divisionName + \"], ロール[\"\r\n                + JSON.stringify(_role) + \"], 認証トークン[\" + _authToken + \"], マネージャ権限組織[\" + _manDivisionIds + \"]\";\r\n            console.log(str);\r\n            return str;\r\n        }\r\n    };\r\n}());\r\n\r\n/**\r\n * 共通ウィンドウ群\r\n */\r\nvar _ghWins = null;\r\n\r\n/**\r\n * コード定義（プロパティ）\r\n */\r\nvar _prop = (function() {\r\n    \"use strict\";\r\n    var _propString = null;\r\n    var _prop = null;\r\n    var _propCache = {};\r\n    var _previousKMType = null;\r\n    function _initProp() {\r\n        // ファイルからコード定義を読み込む\r\n        var r = window.dhx4.ajax.getSync(_GH.PATH_TYPE.CODE_DEF);\r\n        _propString = r.xmlDoc.responseText;\r\n        // 使わない項目（kmType = 'x'のもの）を落とす\r\n        _prop = _.filter(JSON.parse(_propString), function(p) {\r\n            return p.tmType !== \"x\";\r\n        });\r\n        console.log(\"コード定義を初期化しました。\");\r\n    }\r\n    /**\r\n     * コード定義（プロパティ）を取得する。\r\n     * kmType(戸建て・MS区分）による選別は行わない。\r\n     * @param codeId : string 一意のコードID\r\n     * @return {\"groupId\":1,\"groupName\":\"プロテクト\",\"codeId\":\"1_0\",\"CodeName\":\"プロテクトではない\",\"Value\":0, \"kmType\": \"ms\"}\r\n     */\r\n    function _getProp(codeId) {\r\n        if (_prop == null) {\r\n            _initProp();\r\n        }\r\n        var index = _.findIndex(_prop, { 'codeId': codeId });\r\n        if (index < 0) {\r\n            console.log(\"コード定義にコードID[%s]は存在しません。\", codeId);\r\n            return {};\r\n        } else {\r\n            return _prop[index];\r\n        }\r\n    }\r\n    /**\r\n     * コード定義（プロパティ）グループを取得する。\r\n     * kmType(戸建て・MS区分）による選別は行う。\r\n     * @param groupId : int グループID\r\n     * @return [{\"groupId\":1,\"groupName\":\"プロテクト\",\"codeId\":\"1_0\",\"codeName\":\"プロテクトではない\",\"value\":0, \"kmType\": \"ms\"}, ・・・]\r\n     */\r\n    function _getPropGroup(groupId) {\r\n        if (_prop == null) {\r\n            _initProp();\r\n        }\r\n        // 引数のグループIDと同じ、かつ、戸建て・MS区分に合致するものだけに絞る\r\n        return _.filter(_prop, function(p) {\r\n            return p.groupId == groupId && (p.kmType == null || p.kmType == _ghUser.getKMType());\r\n        });\r\n    }\r\n    /**\r\n     * コード定義（プロパティ）グループのValueにマッチしたCodeNameを取得する。\r\n     * @param groupId : int グループID\r\n     * @param value : int 区分値\r\n     * @return CodeNameの値\r\n     */\r\n    function _getPropName(groupId, value) {\r\n        _clearCache();\r\n        if (_propCache[groupId] === undefined) {\r\n            _propCache[groupId] = {};\r\n            _.forEach(_getPropGroup(groupId), function(v/*, key, object*/) {\r\n                _propCache[groupId][v.value] = v.codeName;\r\n            });\r\n        }\r\n        var propName = _propCache[groupId][value];\r\n        return _.isEmpty(propName)? \"\": propName;\r\n    }\r\n    /**\r\n     * コード名（画面に表示するプロパティの翻訳）からプロパティ値を取得する。（逆引き）\r\n     * @param groupId グループID\r\n     * @param codeName コード名（画面に表示するプロパティの翻訳）\r\n     */\r\n    function _getValueFromPropName(groupId, codeName) {\r\n        var props = _getPropGroup(groupId);\r\n        if (props) {\r\n            return _.result(_.find(props, function(props){\r\n                return props[\"codeName\"] == codeName;\r\n            }), \"value\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n    /**\r\n     * プロパティのキャッシュをクリアする。\r\n     */\r\n    function _clearCache() {\r\n        if (_previousKMType !== _ghUser.getKMType()) {\r\n            // キャッシュをクリアする。\r\n            _propCache = {};\r\n            _previousKMType = _ghUser.getKMType();\r\n            console.log(\"プロパティのキャッシュをクリアしました。\")\r\n        }\r\n    }\r\n\r\n    /**\r\n     * SelectリストのOption用のデータを取得する。\r\n     *\r\n     * @param groupId : int グループID\r\n     * @param opts: array 初期化したい配列。渡した配列にデータが追記される。\r\n     * @return [{text: \"Registered users\", value: \"Option 1\", selected: true},\r\n     *               {text: \"Guests\", value: \"Option 2\", selected: true}]\r\n     */\r\n    function _getOptions(groupId, opts) {\r\n        _.forEach(_getPropGroup(groupId), function(value/*, key, object*/) {\r\n            var opt = {text: value.codeName, value: value.value};\r\n            if (value.selected == 1) {\r\n                opt.selected = 1;\r\n            }\r\n            opts.push(opt);\r\n        });\r\n        return opts;\r\n    }\r\n\r\n    return {\r\n        // コード定義（プロパティ）グループを取得する。\r\n        getPropGroup : function(groupId) {\r\n            return _getPropGroup(groupId);\r\n        },\r\n        // コード定義（プロパティ）を取得する。\r\n        getProp : function(codeId) {\r\n            return _getProp(codeId);\r\n        },\r\n        // コード名（画面に表示するプロパティの翻訳）からプロパティ値を取得する。（逆引き）\r\n        getValueFromPropName : function(groupId, codeName) {\r\n            return _getValueFromPropName(groupId, codeName);\r\n        },\r\n        // コード定義（プロパティ）の値を取得する。\r\n        getPropValue : function(codeId) {\r\n            return _getProp(codeId).value;\r\n        },\r\n        // SelectリストのOption用のデータを取得する。\r\n        getOptions : function(groupId) {\r\n            return _getOptions(groupId, []);\r\n        },\r\n        // 空を選んだ状態のSelectリストのOption用のデータを取得する。\r\n        getOptionsWithEmpty : function(groupId) {\r\n            return _getOptions(groupId, [{text: \"\", value: \"\", selected: true}]);\r\n        },\r\n        // ComboリストのOption用のデータを取得する。指定されたvalueのデータがOptionにない場合は1つ目に追加する。ただし、表示テキストと値は同じとする。\r\n        getComboOptions : function(groupId, value) {\r\n            var opts = _getOptions(groupId, []);\r\n            if (!_.includes(opts, value)) {\r\n                opts.push({text: value, value: value});\r\n                opts = _.sortBy(opts, 'value');\r\n            }\r\n            return opts;\r\n        },\r\n        // コード定義（プロパティ）グループのValueにマッチしたCodeNameを取得する\r\n        getPropName : function(groupId, value) {\r\n            return _getPropName(groupId, value);\r\n        },\r\n\t\t/**\r\n         * @param name of value\r\n         * @param name of text\r\n         * @param objects list objects value\r\n         * @returns {Array}\r\n         */\r\n        setOptionsWithObjects : function(value, text, objects) {\r\n            var opts = [{text: \"\", value: \"\", selected: true}];\r\n            $.each(objects, function(index, obj) {\r\n                opts.push({value: obj[value], text: obj[text] });\r\n            });\r\n            return opts;\r\n        }\r\n    }\r\n}());\r\n\r\n/** ------------------------------------------------\r\n *  ■バリデートルールのスクリプト\r\n *   ------------------------------------------------ */\r\n/**\r\n * @param data\r\n * @returns {boolean}\r\n */\r\nfunction ValidTel(data) {\r\n    if (_.isEmpty(data)) {\r\n        return true;\r\n    }\r\n    return !_.isEmpty(data.toString().match(/^[0-9]+-{0,1}[0-9]+-{0,1}[0-9]+$/));\r\n}\r\n/**\r\n * @return {boolean}\r\n */\r\nfunction ValidZip(data) {\r\n    if (_.isEmpty(data)) {\r\n        return true;\r\n    }\r\n    return !_.isEmpty(data.toString().match(/^[0-9]{3}[\\-]?[0-9]{4}$/));\r\n}\r\n\r\n//set zero value to element if it's null\r\nfunction setZeroIfNull(form, name){\r\n\tif(form.getItemValue(name) == \"\" || form.getItemValue(name) === null){\r\n\t\tform.setItemValue(name, \"0\");\r\n\t}\r\n}\r\n"

/***/ },
/* 35 */
/*!*************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.config.js ***!
  \*************************************************************************/
/***/ function(module, exports) {

	module.exports = "/**\r\n * カレンダーの日本語化設定\r\n * add once, make sure dhtmlxcalendar.js is loaded\r\n */\r\ndhtmlXCalendarObject.prototype.langData[\"jp\"] = {\r\n    // date format\r\n    dateformat: \"%Y/%m/%d %H:%i:%s\",\r\n\r\n    //カレンダー表示時の年月表記\r\n    hdrformat:\"%Y年 %n月\",\r\n\r\n    // full names of months\r\n    monthesFNames: [\r\n        \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\r\n        \"8月\",\"9月\",\"10月\",\"11月\",\"12月\"\r\n    ],\r\n    // short names of months\r\n    monthesSNames: [\r\n        \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\r\n        \"8月\",\"9月\",\"10月\",\"11月\",\"12月\"\r\n    ],\r\n    // full names of days\r\n    daysFNames: [\r\n        \"日曜日\",\"月曜日\",\"火曜日\",\"水曜日\",\r\n        \"木曜日\",\"金曜日\",\"土曜日\"\r\n    ],\r\n    // short names of days\r\n    daysSNames: [\r\n        \"日\",\"月\",\"火\",\"水\",\r\n        \"木\",\"金\",\"土\"\r\n    ],\r\n    // starting day of a week. Number from 1(Monday) to 7(Sunday)\r\n    weekstart: 1,\r\n    // the title of the week number column\r\n    weekname: \"週\"\r\n};\r\n//make custom language default\r\ndhtmlXCalendarObject.prototype.lang = \"jp\";\r\n\r\n/**\r\n * ファイルアップロード用\r\n */\r\ndhtmlXVaultObject.prototype.strings = {\r\n    done:       \"完了しました。\",     // text under filename in files list\r\n    error:      \"エラーが発生しました。\",    // text under filename in files list\r\n    size_exceeded: \"アップロード可能な容量を超えています。 (最大 #size#)\",\r\n    btnAdd:     \"ファイルを追加\",   // button \"add files\"\r\n    btnUpload:  \"アップロード\",   // button \"upload\"\r\n    btnCancel:  \"キャンセル\",   // button \"cancel uploading\"\r\n    btnClean:   \"クリアー\",    // button \"clear all\"\r\n\r\n    dnd:        \"ここにドラッグ＆ドロップ\"  // dnd text while the user is dragging files\r\n};\r\n"

/***/ },
/* 36 */
/*!***************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/WebContent/lib/xdate/xdate.js ***!
  \***************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(global) {module.exports = global["XDate"] = __webpack_require__(/*! -!C:/building/src/main/webapp/resources/~/imports-loader?jquery!C:/building/src/main/webapp/resources/~/exports-loader?XDate!C:/building/src/main/webapp/resources/WebContent/lib/xdate/xdate.js */ 37);
	/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))

/***/ },
/* 37 */
/*!******************************************************************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/imports-loader?jquery!C:/building/src/main/webapp/resources/~/exports-loader?XDate!C:/building/src/main/webapp/resources/WebContent/lib/xdate/xdate.js ***!
  \******************************************************************************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*** IMPORTS FROM imports-loader ***/
	var jquery = __webpack_require__(/*! jquery */ 38);
	
	/*
	 XDate v0.8
	 Docs & Licensing: http://arshaw.com/xdate/
	*/
	var XDate=function(g,n,A,p){function f(){var a=this instanceof f?this:new f,c=arguments,b=c.length,d;typeof c[b-1]=="boolean"&&(d=c[--b],c=q(c,0,b));if(b)if(b==1)if(b=c[0],b instanceof g||typeof b=="number")a[0]=new g(+b);else if(b instanceof f){var c=a,h=new g(+b[0]);if(l(b))h.toString=v;c[0]=h}else{if(typeof b=="string"){a[0]=new g(0);a:{for(var c=b,b=d||!1,h=f.parsers,w=0,e;w<h.length;w++)if(e=h[w](c,b,a)){a=e;break a}a[0]=new g(c)}}}else a[0]=new g(m.apply(g,c)),d||(a[0]=r(a[0]));else a[0]=new g;
	typeof d=="boolean"&&B(a,d);return a}function l(a){return a[0].toString===v}function B(a,c,b){if(c){if(!l(a))b&&(a[0]=new g(m(a[0].getFullYear(),a[0].getMonth(),a[0].getDate(),a[0].getHours(),a[0].getMinutes(),a[0].getSeconds(),a[0].getMilliseconds()))),a[0].toString=v}else l(a)&&(a[0]=b?r(a[0]):new g(+a[0]));return a}function C(a,c,b,d,h){var e=k(j,a[0],h),a=k(D,a[0],h),h=!1;d.length==2&&typeof d[1]=="boolean"&&(h=d[1],d=[b]);b=c==1?(b%12+12)%12:e(1);a(c,d);h&&e(1)!=b&&(a(1,[e(1)-1]),a(2,[E(e(0),
	e(1))]))}function F(a,c,b,d){var b=Number(b),h=n.floor(b);a["set"+o[c]](a["get"+o[c]]()+h,d||!1);h!=b&&c<6&&F(a,c+1,(b-h)*G[c],d)}function H(a,c,b){var a=a.clone().setUTCMode(!0,!0),c=f(c).setUTCMode(!0,!0),d=0;if(b==0||b==1){for(var h=6;h>=b;h--)d/=G[h],d+=j(c,!1,h)-j(a,!1,h);b==1&&(d+=(c.getFullYear()-a.getFullYear())*12)}else b==2?(b=a.toDate().setUTCHours(0,0,0,0),d=c.toDate().setUTCHours(0,0,0,0),d=n.round((d-b)/864E5)+(c-d-(a-b))/864E5):d=(c-a)/[36E5,6E4,1E3,1][b-3];return d}function s(a){var c=
	a(0),b=a(1),d=a(2),a=new g(m(c,b,d)),c=t(I(c,b,d));return n.floor(n.round((a-c)/864E5)/7)+1}function I(a,c,b){c=new g(m(a,c,b));if(c<t(a))return a-1;else if(c>=t(a+1))return a+1;return a}function t(a){a=new g(m(a,0,4));a.setUTCDate(a.getUTCDate()-(a.getUTCDay()+6)%7);return a}function J(a,c,b,d){var h=k(j,a,d),e=k(D,a,d);b===p&&(b=I(h(0),h(1),h(2)));b=t(b);d||(b=r(b));a.setTime(+b);e(2,[h(2)+(c-1)*7])}function K(a,c,b,d,h){var e=f.locales,g=e[f.defaultLocale]||{},i=k(j,a,h),b=(typeof b=="string"?
	e[b]:b)||{};return x(a,c,function(a){if(d)for(var b=(a==7?2:a)-1;b>=0;b--)d.push(i(b));return i(a)},function(a){return b[a]||g[a]},h)}function x(a,c,b,d,e){for(var f,g,i="";f=c.match(N);){i+=c.substr(0,f.index);if(f[1]){g=i;for(var i=a,j=f[1],l=b,m=d,n=e,k=j.length,o=void 0,q="";k>0;)o=O(i,j.substr(0,k),l,m,n),o!==p?(q+=o,j=j.substr(k),k=j.length):k--;i=g+(q+j)}else f[3]?(g=x(a,f[4],b,d,e),parseInt(g.replace(/\D/g,""),10)&&(i+=g)):i+=f[7]||"'";c=c.substr(f.index+f[0].length)}return i+c}function O(a,
	c,b,d,e){var g=f.formatters[c];if(typeof g=="string")return x(a,g,b,d,e);else if(typeof g=="function")return g(a,e||!1,d);switch(c){case "fff":return i(b(6),3);case "s":return b(5);case "ss":return i(b(5));case "m":return b(4);case "mm":return i(b(4));case "h":return b(3)%12||12;case "hh":return i(b(3)%12||12);case "H":return b(3);case "HH":return i(b(3));case "d":return b(2);case "dd":return i(b(2));case "ddd":return d("dayNamesShort")[b(7)]||"";case "dddd":return d("dayNames")[b(7)]||"";case "M":return b(1)+
	1;case "MM":return i(b(1)+1);case "MMM":return d("monthNamesShort")[b(1)]||"";case "MMMM":return d("monthNames")[b(1)]||"";case "yy":return(b(0)+"").substring(2);case "yyyy":return b(0);case "t":return u(b,d).substr(0,1).toLowerCase();case "tt":return u(b,d).toLowerCase();case "T":return u(b,d).substr(0,1);case "TT":return u(b,d);case "z":case "zz":case "zzz":return e?c="Z":(d=a.getTimezoneOffset(),a=d<0?"+":"-",b=n.floor(n.abs(d)/60),d=n.abs(d)%60,e=b,c=="zz"?e=i(b):c=="zzz"&&(e=i(b)+":"+i(d)),c=
	a+e),c;case "w":return s(b);case "ww":return i(s(b));case "S":return c=b(2),c>10&&c<20?"th":["st","nd","rd"][c%10-1]||"th"}}function u(a,c){return a(3)<12?c("amDesignator"):c("pmDesignator")}function y(a){return!isNaN(+a[0])}function j(a,c,b){return a["get"+(c?"UTC":"")+o[b]]()}function D(a,c,b,d){a["set"+(c?"UTC":"")+o[b]].apply(a,d)}function r(a){return new g(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())}function E(a,
	c){return 32-(new g(m(a,c,32))).getUTCDate()}function z(a){return function(){return a.apply(p,[this].concat(q(arguments)))}}function k(a){var c=q(arguments,1);return function(){return a.apply(p,c.concat(q(arguments)))}}function q(a,c,b){return A.prototype.slice.call(a,c||0,b===p?a.length:b)}function L(a,c){for(var b=0;b<a.length;b++)c(a[b],b)}function i(a,c){c=c||2;for(a+="";a.length<c;)a="0"+a;return a}var o="FullYear,Month,Date,Hours,Minutes,Seconds,Milliseconds,Day,Year".split(","),M=["Years",
	"Months","Days"],G=[12,31,24,60,60,1E3,1],N=/(([a-zA-Z])\2*)|(\((('.*?'|\(.*?\)|.)*?)\))|('(.*?)')/,m=g.UTC,v=g.prototype.toUTCString,e=f.prototype;e.length=1;e.splice=A.prototype.splice;e.getUTCMode=z(l);e.setUTCMode=z(B);e.getTimezoneOffset=function(){return l(this)?0:this[0].getTimezoneOffset()};L(o,function(a,c){e["get"+a]=function(){return j(this[0],l(this),c)};c!=8&&(e["getUTC"+a]=function(){return j(this[0],!0,c)});c!=7&&(e["set"+a]=function(a){C(this,c,a,arguments,l(this));return this},c!=
	8&&(e["setUTC"+a]=function(a){C(this,c,a,arguments,!0);return this},e["add"+(M[c]||a)]=function(a,d){F(this,c,a,d);return this},e["diff"+(M[c]||a)]=function(a){return H(this,a,c)}))});e.getWeek=function(){return s(k(j,this,!1))};e.getUTCWeek=function(){return s(k(j,this,!0))};e.setWeek=function(a,c){J(this,a,c,!1);return this};e.setUTCWeek=function(a,c){J(this,a,c,!0);return this};e.addWeeks=function(a){return this.addDays(Number(a)*7)};e.diffWeeks=function(a){return H(this,a,2)/7};f.parsers=[function(a,
	c,b){if(a=a.match(/^(\d{4})(-(\d{2})(-(\d{2})([T ](\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/)){var d=new g(m(a[1],a[3]?a[3]-1:0,a[5]||1,a[7]||0,a[8]||0,a[10]||0,a[12]?Number("0."+a[12])*1E3:0));a[13]?a[14]&&d.setUTCMinutes(d.getUTCMinutes()+(a[15]=="-"?1:-1)*(Number(a[16])*60+(a[18]?Number(a[18]):0))):c||(d=r(d));return b.setTime(+d)}}];f.parse=function(a){return+f(""+a)};e.toString=function(a,c,b){return a===p||!y(this)?this[0].toString():K(this,a,c,b,l(this))};
	e.toUTCString=e.toGMTString=function(a,c,b){return a===p||!y(this)?this[0].toUTCString():K(this,a,c,b,!0)};e.toISOString=function(){return this.toUTCString("yyyy-MM-dd'T'HH:mm:ss(.fff)zzz")};f.defaultLocale="";f.locales={"":{monthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthNamesShort:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),dayNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),dayNamesShort:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),
	amDesignator:"AM",pmDesignator:"PM"}};f.formatters={i:"yyyy-MM-dd'T'HH:mm:ss(.fff)",u:"yyyy-MM-dd'T'HH:mm:ss(.fff)zzz"};L("getTime,valueOf,toDateString,toTimeString,toLocaleString,toLocaleDateString,toLocaleTimeString,toJSON".split(","),function(a){e[a]=function(){return this[0][a]()}});e.setTime=function(a){this[0].setTime(a);return this};e.valid=z(y);e.clone=function(){return new f(this)};e.clearTime=function(){return this.setHours(0,0,0,0)};e.toDate=function(){return new g(+this[0])};f.now=function(){return+new g};
	f.today=function(){return(new f).clearTime()};f.UTC=m;f.getDaysInMonth=E;if(typeof module!=="undefined"&&module.exports)module.exports=f;"function"==="function"&&__webpack_require__(/*! !webpack amd options */ 41)&&!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function(){return f}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));return f}(Date,Math,Array);
	
	
	/*** EXPORTS FROM exports-loader ***/
	module.exports = XDate;


/***/ },
/* 38 */
/*!*********************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/jquery/dist/jquery.js ***!
  \*********************************************************************/
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(global) {module.exports = global["$"] = __webpack_require__(/*! -!C:/building/src/main/webapp/resources/~/expose-loader?jQuery!C:/building/src/main/webapp/resources/~/imports-loader?define=>false!C:/building/src/main/webapp/resources/~/jquery/dist/jquery.js */ 39);
	/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))

/***/ },
/* 39 */
/*!*******************************************************************************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/expose-loader?jQuery!C:/building/src/main/webapp/resources/~/imports-loader?define=>false!C:/building/src/main/webapp/resources/~/jquery/dist/jquery.js ***!
  \*******************************************************************************************************************************************************************************************************/
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(global) {module.exports = global["jQuery"] = __webpack_require__(/*! -!C:/building/src/main/webapp/resources/~/imports-loader?define=>false!C:/building/src/main/webapp/resources/~/jquery/dist/jquery.js */ 40);
	/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))

/***/ },
/* 40 */
/*!******************************************************************************************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/imports-loader?define=>false!C:/building/src/main/webapp/resources/~/jquery/dist/jquery.js ***!
  \******************************************************************************************************************************************/
/***/ function(module, exports) {

	/*** IMPORTS FROM imports-loader ***/
	var define = false;
	
	/*!
	 * jQuery JavaScript Library v2.1.4
	 * http://jquery.com/
	 *
	 * Includes Sizzle.js
	 * http://sizzlejs.com/
	 *
	 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2015-04-28T16:01Z
	 */
	
	(function( global, factory ) {
	
		if ( typeof module === "object" && typeof module.exports === "object" ) {
			// For CommonJS and CommonJS-like environments where a proper `window`
			// is present, execute the factory and get jQuery.
			// For environments that do not have a `window` with a `document`
			// (such as Node.js), expose a factory as module.exports.
			// This accentuates the need for the creation of a real `window`.
			// e.g. var jQuery = require("jquery")(window);
			// See ticket #14549 for more info.
			module.exports = global.document ?
				factory( global, true ) :
				function( w ) {
					if ( !w.document ) {
						throw new Error( "jQuery requires a window with a document" );
					}
					return factory( w );
				};
		} else {
			factory( global );
		}
	
	// Pass this if window is not defined yet
	}(typeof window !== "undefined" ? window : this, function( window, noGlobal ) {
	
	// Support: Firefox 18+
	// Can't be in strict mode, several libs including ASP.NET trace
	// the stack via arguments.caller.callee and Firefox dies if
	// you try to trace through "use strict" call chains. (#13335)
	//
	
	var arr = [];
	
	var slice = arr.slice;
	
	var concat = arr.concat;
	
	var push = arr.push;
	
	var indexOf = arr.indexOf;
	
	var class2type = {};
	
	var toString = class2type.toString;
	
	var hasOwn = class2type.hasOwnProperty;
	
	var support = {};
	
	
	
	var
		// Use the correct document accordingly with window argument (sandbox)
		document = window.document,
	
		version = "2.1.4",
	
		// Define a local copy of jQuery
		jQuery = function( selector, context ) {
			// The jQuery object is actually just the init constructor 'enhanced'
			// Need init if jQuery is called (just allow error to be thrown if not included)
			return new jQuery.fn.init( selector, context );
		},
	
		// Support: Android<4.1
		// Make sure we trim BOM and NBSP
		rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
	
		// Matches dashed string for camelizing
		rmsPrefix = /^-ms-/,
		rdashAlpha = /-([\da-z])/gi,
	
		// Used by jQuery.camelCase as callback to replace()
		fcamelCase = function( all, letter ) {
			return letter.toUpperCase();
		};
	
	jQuery.fn = jQuery.prototype = {
		// The current version of jQuery being used
		jquery: version,
	
		constructor: jQuery,
	
		// Start with an empty selector
		selector: "",
	
		// The default length of a jQuery object is 0
		length: 0,
	
		toArray: function() {
			return slice.call( this );
		},
	
		// Get the Nth element in the matched element set OR
		// Get the whole matched element set as a clean array
		get: function( num ) {
			return num != null ?
	
				// Return just the one element from the set
				( num < 0 ? this[ num + this.length ] : this[ num ] ) :
	
				// Return all the elements in a clean array
				slice.call( this );
		},
	
		// Take an array of elements and push it onto the stack
		// (returning the new matched element set)
		pushStack: function( elems ) {
	
			// Build a new jQuery matched element set
			var ret = jQuery.merge( this.constructor(), elems );
	
			// Add the old object onto the stack (as a reference)
			ret.prevObject = this;
			ret.context = this.context;
	
			// Return the newly-formed element set
			return ret;
		},
	
		// Execute a callback for every element in the matched set.
		// (You can seed the arguments with an array of args, but this is
		// only used internally.)
		each: function( callback, args ) {
			return jQuery.each( this, callback, args );
		},
	
		map: function( callback ) {
			return this.pushStack( jQuery.map(this, function( elem, i ) {
				return callback.call( elem, i, elem );
			}));
		},
	
		slice: function() {
			return this.pushStack( slice.apply( this, arguments ) );
		},
	
		first: function() {
			return this.eq( 0 );
		},
	
		last: function() {
			return this.eq( -1 );
		},
	
		eq: function( i ) {
			var len = this.length,
				j = +i + ( i < 0 ? len : 0 );
			return this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );
		},
	
		end: function() {
			return this.prevObject || this.constructor(null);
		},
	
		// For internal use only.
		// Behaves like an Array's method, not like a jQuery method.
		push: push,
		sort: arr.sort,
		splice: arr.splice
	};
	
	jQuery.extend = jQuery.fn.extend = function() {
		var options, name, src, copy, copyIsArray, clone,
			target = arguments[0] || {},
			i = 1,
			length = arguments.length,
			deep = false;
	
		// Handle a deep copy situation
		if ( typeof target === "boolean" ) {
			deep = target;
	
			// Skip the boolean and the target
			target = arguments[ i ] || {};
			i++;
		}
	
		// Handle case when target is a string or something (possible in deep copy)
		if ( typeof target !== "object" && !jQuery.isFunction(target) ) {
			target = {};
		}
	
		// Extend jQuery itself if only one argument is passed
		if ( i === length ) {
			target = this;
			i--;
		}
	
		for ( ; i < length; i++ ) {
			// Only deal with non-null/undefined values
			if ( (options = arguments[ i ]) != null ) {
				// Extend the base object
				for ( name in options ) {
					src = target[ name ];
					copy = options[ name ];
	
					// Prevent never-ending loop
					if ( target === copy ) {
						continue;
					}
	
					// Recurse if we're merging plain objects or arrays
					if ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {
						if ( copyIsArray ) {
							copyIsArray = false;
							clone = src && jQuery.isArray(src) ? src : [];
	
						} else {
							clone = src && jQuery.isPlainObject(src) ? src : {};
						}
	
						// Never move original objects, clone them
						target[ name ] = jQuery.extend( deep, clone, copy );
	
					// Don't bring in undefined values
					} else if ( copy !== undefined ) {
						target[ name ] = copy;
					}
				}
			}
		}
	
		// Return the modified object
		return target;
	};
	
	jQuery.extend({
		// Unique for each copy of jQuery on the page
		expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),
	
		// Assume jQuery is ready without the ready module
		isReady: true,
	
		error: function( msg ) {
			throw new Error( msg );
		},
	
		noop: function() {},
	
		isFunction: function( obj ) {
			return jQuery.type(obj) === "function";
		},
	
		isArray: Array.isArray,
	
		isWindow: function( obj ) {
			return obj != null && obj === obj.window;
		},
	
		isNumeric: function( obj ) {
			// parseFloat NaNs numeric-cast false positives (null|true|false|"")
			// ...but misinterprets leading-number strings, particularly hex literals ("0x...")
			// subtraction forces infinities to NaN
			// adding 1 corrects loss of precision from parseFloat (#15100)
			return !jQuery.isArray( obj ) && (obj - parseFloat( obj ) + 1) >= 0;
		},
	
		isPlainObject: function( obj ) {
			// Not plain objects:
			// - Any object or value whose internal [[Class]] property is not "[object Object]"
			// - DOM nodes
			// - window
			if ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {
				return false;
			}
	
			if ( obj.constructor &&
					!hasOwn.call( obj.constructor.prototype, "isPrototypeOf" ) ) {
				return false;
			}
	
			// If the function hasn't returned already, we're confident that
			// |obj| is a plain object, created by {} or constructed with new Object
			return true;
		},
	
		isEmptyObject: function( obj ) {
			var name;
			for ( name in obj ) {
				return false;
			}
			return true;
		},
	
		type: function( obj ) {
			if ( obj == null ) {
				return obj + "";
			}
			// Support: Android<4.0, iOS<6 (functionish RegExp)
			return typeof obj === "object" || typeof obj === "function" ?
				class2type[ toString.call(obj) ] || "object" :
				typeof obj;
		},
	
		// Evaluates a script in a global context
		globalEval: function( code ) {
			var script,
				indirect = eval;
	
			code = jQuery.trim( code );
	
			if ( code ) {
				// If the code includes a valid, prologue position
				// strict mode pragma, execute code by injecting a
				// script tag into the document.
				if ( code.indexOf("use strict") === 1 ) {
					script = document.createElement("script");
					script.text = code;
					document.head.appendChild( script ).parentNode.removeChild( script );
				} else {
				// Otherwise, avoid the DOM node creation, insertion
				// and removal by using an indirect global eval
					indirect( code );
				}
			}
		},
	
		// Convert dashed to camelCase; used by the css and data modules
		// Support: IE9-11+
		// Microsoft forgot to hump their vendor prefix (#9572)
		camelCase: function( string ) {
			return string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );
		},
	
		nodeName: function( elem, name ) {
			return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
		},
	
		// args is for internal usage only
		each: function( obj, callback, args ) {
			var value,
				i = 0,
				length = obj.length,
				isArray = isArraylike( obj );
	
			if ( args ) {
				if ( isArray ) {
					for ( ; i < length; i++ ) {
						value = callback.apply( obj[ i ], args );
	
						if ( value === false ) {
							break;
						}
					}
				} else {
					for ( i in obj ) {
						value = callback.apply( obj[ i ], args );
	
						if ( value === false ) {
							break;
						}
					}
				}
	
			// A special, fast, case for the most common use of each
			} else {
				if ( isArray ) {
					for ( ; i < length; i++ ) {
						value = callback.call( obj[ i ], i, obj[ i ] );
	
						if ( value === false ) {
							break;
						}
					}
				} else {
					for ( i in obj ) {
						value = callback.call( obj[ i ], i, obj[ i ] );
	
						if ( value === false ) {
							break;
						}
					}
				}
			}
	
			return obj;
		},
	
		// Support: Android<4.1
		trim: function( text ) {
			return text == null ?
				"" :
				( text + "" ).replace( rtrim, "" );
		},
	
		// results is for internal usage only
		makeArray: function( arr, results ) {
			var ret = results || [];
	
			if ( arr != null ) {
				if ( isArraylike( Object(arr) ) ) {
					jQuery.merge( ret,
						typeof arr === "string" ?
						[ arr ] : arr
					);
				} else {
					push.call( ret, arr );
				}
			}
	
			return ret;
		},
	
		inArray: function( elem, arr, i ) {
			return arr == null ? -1 : indexOf.call( arr, elem, i );
		},
	
		merge: function( first, second ) {
			var len = +second.length,
				j = 0,
				i = first.length;
	
			for ( ; j < len; j++ ) {
				first[ i++ ] = second[ j ];
			}
	
			first.length = i;
	
			return first;
		},
	
		grep: function( elems, callback, invert ) {
			var callbackInverse,
				matches = [],
				i = 0,
				length = elems.length,
				callbackExpect = !invert;
	
			// Go through the array, only saving the items
			// that pass the validator function
			for ( ; i < length; i++ ) {
				callbackInverse = !callback( elems[ i ], i );
				if ( callbackInverse !== callbackExpect ) {
					matches.push( elems[ i ] );
				}
			}
	
			return matches;
		},
	
		// arg is for internal usage only
		map: function( elems, callback, arg ) {
			var value,
				i = 0,
				length = elems.length,
				isArray = isArraylike( elems ),
				ret = [];
	
			// Go through the array, translating each of the items to their new values
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback( elems[ i ], i, arg );
	
					if ( value != null ) {
						ret.push( value );
					}
				}
	
			// Go through every key on the object,
			} else {
				for ( i in elems ) {
					value = callback( elems[ i ], i, arg );
	
					if ( value != null ) {
						ret.push( value );
					}
				}
			}
	
			// Flatten any nested arrays
			return concat.apply( [], ret );
		},
	
		// A global GUID counter for objects
		guid: 1,
	
		// Bind a function to a context, optionally partially applying any
		// arguments.
		proxy: function( fn, context ) {
			var tmp, args, proxy;
	
			if ( typeof context === "string" ) {
				tmp = fn[ context ];
				context = fn;
				fn = tmp;
			}
	
			// Quick check to determine if target is callable, in the spec
			// this throws a TypeError, but we will just return undefined.
			if ( !jQuery.isFunction( fn ) ) {
				return undefined;
			}
	
			// Simulated bind
			args = slice.call( arguments, 2 );
			proxy = function() {
				return fn.apply( context || this, args.concat( slice.call( arguments ) ) );
			};
	
			// Set the guid of unique handler to the same of original handler, so it can be removed
			proxy.guid = fn.guid = fn.guid || jQuery.guid++;
	
			return proxy;
		},
	
		now: Date.now,
	
		// jQuery.support is not used in Core but other projects attach their
		// properties to it so it needs to exist.
		support: support
	});
	
	// Populate the class2type map
	jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
		class2type[ "[object " + name + "]" ] = name.toLowerCase();
	});
	
	function isArraylike( obj ) {
	
		// Support: iOS 8.2 (not reproducible in simulator)
		// `in` check used to prevent JIT error (gh-2145)
		// hasOwn isn't used here due to false negatives
		// regarding Nodelist length in IE
		var length = "length" in obj && obj.length,
			type = jQuery.type( obj );
	
		if ( type === "function" || jQuery.isWindow( obj ) ) {
			return false;
		}
	
		if ( obj.nodeType === 1 && length ) {
			return true;
		}
	
		return type === "array" || length === 0 ||
			typeof length === "number" && length > 0 && ( length - 1 ) in obj;
	}
	var Sizzle =
	/*!
	 * Sizzle CSS Selector Engine v2.2.0-pre
	 * http://sizzlejs.com/
	 *
	 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2014-12-16
	 */
	(function( window ) {
	
	var i,
		support,
		Expr,
		getText,
		isXML,
		tokenize,
		compile,
		select,
		outermostContext,
		sortInput,
		hasDuplicate,
	
		// Local document vars
		setDocument,
		document,
		docElem,
		documentIsHTML,
		rbuggyQSA,
		rbuggyMatches,
		matches,
		contains,
	
		// Instance-specific data
		expando = "sizzle" + 1 * new Date(),
		preferredDoc = window.document,
		dirruns = 0,
		done = 0,
		classCache = createCache(),
		tokenCache = createCache(),
		compilerCache = createCache(),
		sortOrder = function( a, b ) {
			if ( a === b ) {
				hasDuplicate = true;
			}
			return 0;
		},
	
		// General-purpose constants
		MAX_NEGATIVE = 1 << 31,
	
		// Instance methods
		hasOwn = ({}).hasOwnProperty,
		arr = [],
		pop = arr.pop,
		push_native = arr.push,
		push = arr.push,
		slice = arr.slice,
		// Use a stripped-down indexOf as it's faster than native
		// http://jsperf.com/thor-indexof-vs-for/5
		indexOf = function( list, elem ) {
			var i = 0,
				len = list.length;
			for ( ; i < len; i++ ) {
				if ( list[i] === elem ) {
					return i;
				}
			}
			return -1;
		},
	
		booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
	
		// Regular expressions
	
		// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace
		whitespace = "[\\x20\\t\\r\\n\\f]",
		// http://www.w3.org/TR/css3-syntax/#characters
		characterEncoding = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
	
		// Loosely modeled on CSS identifier characters
		// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors
		// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier
		identifier = characterEncoding.replace( "w", "w#" ),
	
		// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors
		attributes = "\\[" + whitespace + "*(" + characterEncoding + ")(?:" + whitespace +
			// Operator (capture 2)
			"*([*^$|!~]?=)" + whitespace +
			// "Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]"
			"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace +
			"*\\]",
	
		pseudos = ":(" + characterEncoding + ")(?:\\((" +
			// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:
			// 1. quoted (capture 3; capture 4 or capture 5)
			"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" +
			// 2. simple (capture 6)
			"((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" +
			// 3. anything else (capture 2)
			".*" +
			")\\)|)",
	
		// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter
		rwhitespace = new RegExp( whitespace + "+", "g" ),
		rtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g" ),
	
		rcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),
		rcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),
	
		rattributeQuotes = new RegExp( "=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g" ),
	
		rpseudo = new RegExp( pseudos ),
		ridentifier = new RegExp( "^" + identifier + "$" ),
	
		matchExpr = {
			"ID": new RegExp( "^#(" + characterEncoding + ")" ),
			"CLASS": new RegExp( "^\\.(" + characterEncoding + ")" ),
			"TAG": new RegExp( "^(" + characterEncoding.replace( "w", "w*" ) + ")" ),
			"ATTR": new RegExp( "^" + attributes ),
			"PSEUDO": new RegExp( "^" + pseudos ),
			"CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace +
				"*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +
				"*(\\d+)|))" + whitespace + "*\\)|)", "i" ),
			"bool": new RegExp( "^(?:" + booleans + ")$", "i" ),
			// For use in libraries implementing .is()
			// We use this for POS matching in `select`
			"needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" +
				whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i" )
		},
	
		rinputs = /^(?:input|select|textarea|button)$/i,
		rheader = /^h\d$/i,
	
		rnative = /^[^{]+\{\s*\[native \w/,
	
		// Easily-parseable/retrievable ID or TAG or CLASS selectors
		rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
	
		rsibling = /[+~]/,
		rescape = /'|\\/g,
	
		// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters
		runescape = new RegExp( "\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),
		funescape = function( _, escaped, escapedWhitespace ) {
			var high = "0x" + escaped - 0x10000;
			// NaN means non-codepoint
			// Support: Firefox<24
			// Workaround erroneous numeric interpretation of +"0x"
			return high !== high || escapedWhitespace ?
				escaped :
				high < 0 ?
					// BMP codepoint
					String.fromCharCode( high + 0x10000 ) :
					// Supplemental Plane codepoint (surrogate pair)
					String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );
		},
	
		// Used for iframes
		// See setDocument()
		// Removing the function wrapper causes a "Permission Denied"
		// error in IE
		unloadHandler = function() {
			setDocument();
		};
	
	// Optimize for push.apply( _, NodeList )
	try {
		push.apply(
			(arr = slice.call( preferredDoc.childNodes )),
			preferredDoc.childNodes
		);
		// Support: Android<4.0
		// Detect silently failing push.apply
		arr[ preferredDoc.childNodes.length ].nodeType;
	} catch ( e ) {
		push = { apply: arr.length ?
	
			// Leverage slice if possible
			function( target, els ) {
				push_native.apply( target, slice.call(els) );
			} :
	
			// Support: IE<9
			// Otherwise append directly
			function( target, els ) {
				var j = target.length,
					i = 0;
				// Can't trust NodeList.length
				while ( (target[j++] = els[i++]) ) {}
				target.length = j - 1;
			}
		};
	}
	
	function Sizzle( selector, context, results, seed ) {
		var match, elem, m, nodeType,
			// QSA vars
			i, groups, old, nid, newContext, newSelector;
	
		if ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {
			setDocument( context );
		}
	
		context = context || document;
		results = results || [];
		nodeType = context.nodeType;
	
		if ( typeof selector !== "string" || !selector ||
			nodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {
	
			return results;
		}
	
		if ( !seed && documentIsHTML ) {
	
			// Try to shortcut find operations when possible (e.g., not under DocumentFragment)
			if ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {
				// Speed-up: Sizzle("#ID")
				if ( (m = match[1]) ) {
					if ( nodeType === 9 ) {
						elem = context.getElementById( m );
						// Check parentNode to catch when Blackberry 4.6 returns
						// nodes that are no longer in the document (jQuery #6963)
						if ( elem && elem.parentNode ) {
							// Handle the case where IE, Opera, and Webkit return items
							// by name instead of ID
							if ( elem.id === m ) {
								results.push( elem );
								return results;
							}
						} else {
							return results;
						}
					} else {
						// Context is not a document
						if ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&
							contains( context, elem ) && elem.id === m ) {
							results.push( elem );
							return results;
						}
					}
	
				// Speed-up: Sizzle("TAG")
				} else if ( match[2] ) {
					push.apply( results, context.getElementsByTagName( selector ) );
					return results;
	
				// Speed-up: Sizzle(".CLASS")
				} else if ( (m = match[3]) && support.getElementsByClassName ) {
					push.apply( results, context.getElementsByClassName( m ) );
					return results;
				}
			}
	
			// QSA path
			if ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {
				nid = old = expando;
				newContext = context;
				newSelector = nodeType !== 1 && selector;
	
				// qSA works strangely on Element-rooted queries
				// We can work around this by specifying an extra ID on the root
				// and working up from there (Thanks to Andrew Dupont for the technique)
				// IE 8 doesn't work on object elements
				if ( nodeType === 1 && context.nodeName.toLowerCase() !== "object" ) {
					groups = tokenize( selector );
	
					if ( (old = context.getAttribute("id")) ) {
						nid = old.replace( rescape, "\\$&" );
					} else {
						context.setAttribute( "id", nid );
					}
					nid = "[id='" + nid + "'] ";
	
					i = groups.length;
					while ( i-- ) {
						groups[i] = nid + toSelector( groups[i] );
					}
					newContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;
					newSelector = groups.join(",");
				}
	
				if ( newSelector ) {
					try {
						push.apply( results,
							newContext.querySelectorAll( newSelector )
						);
						return results;
					} catch(qsaError) {
					} finally {
						if ( !old ) {
							context.removeAttribute("id");
						}
					}
				}
			}
		}
	
		// All others
		return select( selector.replace( rtrim, "$1" ), context, results, seed );
	}
	
	/**
	 * Create key-value caches of limited size
	 * @returns {Function(string, Object)} Returns the Object data after storing it on itself with
	 *	property name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)
	 *	deleting the oldest entry
	 */
	function createCache() {
		var keys = [];
	
		function cache( key, value ) {
			// Use (key + " ") to avoid collision with native prototype properties (see Issue #157)
			if ( keys.push( key + " " ) > Expr.cacheLength ) {
				// Only keep the most recent entries
				delete cache[ keys.shift() ];
			}
			return (cache[ key + " " ] = value);
		}
		return cache;
	}
	
	/**
	 * Mark a function for special use by Sizzle
	 * @param {Function} fn The function to mark
	 */
	function markFunction( fn ) {
		fn[ expando ] = true;
		return fn;
	}
	
	/**
	 * Support testing using an element
	 * @param {Function} fn Passed the created div and expects a boolean result
	 */
	function assert( fn ) {
		var div = document.createElement("div");
	
		try {
			return !!fn( div );
		} catch (e) {
			return false;
		} finally {
			// Remove from its parent by default
			if ( div.parentNode ) {
				div.parentNode.removeChild( div );
			}
			// release memory in IE
			div = null;
		}
	}
	
	/**
	 * Adds the same handler for all of the specified attrs
	 * @param {String} attrs Pipe-separated list of attributes
	 * @param {Function} handler The method that will be applied
	 */
	function addHandle( attrs, handler ) {
		var arr = attrs.split("|"),
			i = attrs.length;
	
		while ( i-- ) {
			Expr.attrHandle[ arr[i] ] = handler;
		}
	}
	
	/**
	 * Checks document order of two siblings
	 * @param {Element} a
	 * @param {Element} b
	 * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b
	 */
	function siblingCheck( a, b ) {
		var cur = b && a,
			diff = cur && a.nodeType === 1 && b.nodeType === 1 &&
				( ~b.sourceIndex || MAX_NEGATIVE ) -
				( ~a.sourceIndex || MAX_NEGATIVE );
	
		// Use IE sourceIndex if available on both nodes
		if ( diff ) {
			return diff;
		}
	
		// Check if b follows a
		if ( cur ) {
			while ( (cur = cur.nextSibling) ) {
				if ( cur === b ) {
					return -1;
				}
			}
		}
	
		return a ? 1 : -1;
	}
	
	/**
	 * Returns a function to use in pseudos for input types
	 * @param {String} type
	 */
	function createInputPseudo( type ) {
		return function( elem ) {
			var name = elem.nodeName.toLowerCase();
			return name === "input" && elem.type === type;
		};
	}
	
	/**
	 * Returns a function to use in pseudos for buttons
	 * @param {String} type
	 */
	function createButtonPseudo( type ) {
		return function( elem ) {
			var name = elem.nodeName.toLowerCase();
			return (name === "input" || name === "button") && elem.type === type;
		};
	}
	
	/**
	 * Returns a function to use in pseudos for positionals
	 * @param {Function} fn
	 */
	function createPositionalPseudo( fn ) {
		return markFunction(function( argument ) {
			argument = +argument;
			return markFunction(function( seed, matches ) {
				var j,
					matchIndexes = fn( [], seed.length, argument ),
					i = matchIndexes.length;
	
				// Match elements found at the specified indexes
				while ( i-- ) {
					if ( seed[ (j = matchIndexes[i]) ] ) {
						seed[j] = !(matches[j] = seed[j]);
					}
				}
			});
		});
	}
	
	/**
	 * Checks a node for validity as a Sizzle context
	 * @param {Element|Object=} context
	 * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value
	 */
	function testContext( context ) {
		return context && typeof context.getElementsByTagName !== "undefined" && context;
	}
	
	// Expose support vars for convenience
	support = Sizzle.support = {};
	
	/**
	 * Detects XML nodes
	 * @param {Element|Object} elem An element or a document
	 * @returns {Boolean} True iff elem is a non-HTML XML node
	 */
	isXML = Sizzle.isXML = function( elem ) {
		// documentElement is verified for cases where it doesn't yet exist
		// (such as loading iframes in IE - #4833)
		var documentElement = elem && (elem.ownerDocument || elem).documentElement;
		return documentElement ? documentElement.nodeName !== "HTML" : false;
	};
	
	/**
	 * Sets document-related variables once based on the current document
	 * @param {Element|Object} [doc] An element or document object to use to set the document
	 * @returns {Object} Returns the current document
	 */
	setDocument = Sizzle.setDocument = function( node ) {
		var hasCompare, parent,
			doc = node ? node.ownerDocument || node : preferredDoc;
	
		// If no document and documentElement is available, return
		if ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {
			return document;
		}
	
		// Set our document
		document = doc;
		docElem = doc.documentElement;
		parent = doc.defaultView;
	
		// Support: IE>8
		// If iframe document is assigned to "document" variable and if iframe has been reloaded,
		// IE will throw "permission denied" error when accessing "document" variable, see jQuery #13936
		// IE6-8 do not support the defaultView property so parent will be undefined
		if ( parent && parent !== parent.top ) {
			// IE11 does not have attachEvent, so all must suffer
			if ( parent.addEventListener ) {
				parent.addEventListener( "unload", unloadHandler, false );
			} else if ( parent.attachEvent ) {
				parent.attachEvent( "onunload", unloadHandler );
			}
		}
	
		/* Support tests
		---------------------------------------------------------------------- */
		documentIsHTML = !isXML( doc );
	
		/* Attributes
		---------------------------------------------------------------------- */
	
		// Support: IE<8
		// Verify that getAttribute really returns attributes and not properties
		// (excepting IE8 booleans)
		support.attributes = assert(function( div ) {
			div.className = "i";
			return !div.getAttribute("className");
		});
	
		/* getElement(s)By*
		---------------------------------------------------------------------- */
	
		// Check if getElementsByTagName("*") returns only elements
		support.getElementsByTagName = assert(function( div ) {
			div.appendChild( doc.createComment("") );
			return !div.getElementsByTagName("*").length;
		});
	
		// Support: IE<9
		support.getElementsByClassName = rnative.test( doc.getElementsByClassName );
	
		// Support: IE<10
		// Check if getElementById returns elements by name
		// The broken getElementById methods don't pick up programatically-set names,
		// so use a roundabout getElementsByName test
		support.getById = assert(function( div ) {
			docElem.appendChild( div ).id = expando;
			return !doc.getElementsByName || !doc.getElementsByName( expando ).length;
		});
	
		// ID find and filter
		if ( support.getById ) {
			Expr.find["ID"] = function( id, context ) {
				if ( typeof context.getElementById !== "undefined" && documentIsHTML ) {
					var m = context.getElementById( id );
					// Check parentNode to catch when Blackberry 4.6 returns
					// nodes that are no longer in the document #6963
					return m && m.parentNode ? [ m ] : [];
				}
			};
			Expr.filter["ID"] = function( id ) {
				var attrId = id.replace( runescape, funescape );
				return function( elem ) {
					return elem.getAttribute("id") === attrId;
				};
			};
		} else {
			// Support: IE6/7
			// getElementById is not reliable as a find shortcut
			delete Expr.find["ID"];
	
			Expr.filter["ID"] =  function( id ) {
				var attrId = id.replace( runescape, funescape );
				return function( elem ) {
					var node = typeof elem.getAttributeNode !== "undefined" && elem.getAttributeNode("id");
					return node && node.value === attrId;
				};
			};
		}
	
		// Tag
		Expr.find["TAG"] = support.getElementsByTagName ?
			function( tag, context ) {
				if ( typeof context.getElementsByTagName !== "undefined" ) {
					return context.getElementsByTagName( tag );
	
				// DocumentFragment nodes don't have gEBTN
				} else if ( support.qsa ) {
					return context.querySelectorAll( tag );
				}
			} :
	
			function( tag, context ) {
				var elem,
					tmp = [],
					i = 0,
					// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too
					results = context.getElementsByTagName( tag );
	
				// Filter out possible comments
				if ( tag === "*" ) {
					while ( (elem = results[i++]) ) {
						if ( elem.nodeType === 1 ) {
							tmp.push( elem );
						}
					}
	
					return tmp;
				}
				return results;
			};
	
		// Class
		Expr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {
			if ( documentIsHTML ) {
				return context.getElementsByClassName( className );
			}
		};
	
		/* QSA/matchesSelector
		---------------------------------------------------------------------- */
	
		// QSA and matchesSelector support
	
		// matchesSelector(:active) reports false when true (IE9/Opera 11.5)
		rbuggyMatches = [];
	
		// qSa(:focus) reports false when true (Chrome 21)
		// We allow this because of a bug in IE8/9 that throws an error
		// whenever `document.activeElement` is accessed on an iframe
		// So, we allow :focus to pass through QSA all the time to avoid the IE error
		// See http://bugs.jquery.com/ticket/13378
		rbuggyQSA = [];
	
		if ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {
			// Build QSA regex
			// Regex strategy adopted from Diego Perini
			assert(function( div ) {
				// Select is set to empty string on purpose
				// This is to test IE's treatment of not explicitly
				// setting a boolean content attribute,
				// since its presence should be enough
				// http://bugs.jquery.com/ticket/12359
				docElem.appendChild( div ).innerHTML = "<a id='" + expando + "'></a>" +
					"<select id='" + expando + "-\f]' msallowcapture=''>" +
					"<option selected=''></option></select>";
	
				// Support: IE8, Opera 11-12.16
				// Nothing should be selected when empty strings follow ^= or $= or *=
				// The test attribute must be unknown in Opera but "safe" for WinRT
				// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section
				if ( div.querySelectorAll("[msallowcapture^='']").length ) {
					rbuggyQSA.push( "[*^$]=" + whitespace + "*(?:''|\"\")" );
				}
	
				// Support: IE8
				// Boolean attributes and "value" are not treated correctly
				if ( !div.querySelectorAll("[selected]").length ) {
					rbuggyQSA.push( "\\[" + whitespace + "*(?:value|" + booleans + ")" );
				}
	
				// Support: Chrome<29, Android<4.2+, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.7+
				if ( !div.querySelectorAll( "[id~=" + expando + "-]" ).length ) {
					rbuggyQSA.push("~=");
				}
	
				// Webkit/Opera - :checked should return selected option elements
				// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
				// IE8 throws error here and will not see later tests
				if ( !div.querySelectorAll(":checked").length ) {
					rbuggyQSA.push(":checked");
				}
	
				// Support: Safari 8+, iOS 8+
				// https://bugs.webkit.org/show_bug.cgi?id=136851
				// In-page `selector#id sibing-combinator selector` fails
				if ( !div.querySelectorAll( "a#" + expando + "+*" ).length ) {
					rbuggyQSA.push(".#.+[+~]");
				}
			});
	
			assert(function( div ) {
				// Support: Windows 8 Native Apps
				// The type and name attributes are restricted during .innerHTML assignment
				var input = doc.createElement("input");
				input.setAttribute( "type", "hidden" );
				div.appendChild( input ).setAttribute( "name", "D" );
	
				// Support: IE8
				// Enforce case-sensitivity of name attribute
				if ( div.querySelectorAll("[name=d]").length ) {
					rbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );
				}
	
				// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)
				// IE8 throws error here and will not see later tests
				if ( !div.querySelectorAll(":enabled").length ) {
					rbuggyQSA.push( ":enabled", ":disabled" );
				}
	
				// Opera 10-11 does not throw on post-comma invalid pseudos
				div.querySelectorAll("*,:x");
				rbuggyQSA.push(",.*:");
			});
		}
	
		if ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||
			docElem.webkitMatchesSelector ||
			docElem.mozMatchesSelector ||
			docElem.oMatchesSelector ||
			docElem.msMatchesSelector) )) ) {
	
			assert(function( div ) {
				// Check to see if it's possible to do matchesSelector
				// on a disconnected node (IE 9)
				support.disconnectedMatch = matches.call( div, "div" );
	
				// This should fail with an exception
				// Gecko does not error, returns false instead
				matches.call( div, "[s!='']:x" );
				rbuggyMatches.push( "!=", pseudos );
			});
		}
	
		rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );
		rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );
	
		/* Contains
		---------------------------------------------------------------------- */
		hasCompare = rnative.test( docElem.compareDocumentPosition );
	
		// Element contains another
		// Purposefully does not implement inclusive descendent
		// As in, an element does not contain itself
		contains = hasCompare || rnative.test( docElem.contains ) ?
			function( a, b ) {
				var adown = a.nodeType === 9 ? a.documentElement : a,
					bup = b && b.parentNode;
				return a === bup || !!( bup && bup.nodeType === 1 && (
					adown.contains ?
						adown.contains( bup ) :
						a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16
				));
			} :
			function( a, b ) {
				if ( b ) {
					while ( (b = b.parentNode) ) {
						if ( b === a ) {
							return true;
						}
					}
				}
				return false;
			};
	
		/* Sorting
		---------------------------------------------------------------------- */
	
		// Document order sorting
		sortOrder = hasCompare ?
		function( a, b ) {
	
			// Flag for duplicate removal
			if ( a === b ) {
				hasDuplicate = true;
				return 0;
			}
	
			// Sort on method existence if only one input has compareDocumentPosition
			var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
			if ( compare ) {
				return compare;
			}
	
			// Calculate position if both inputs belong to the same document
			compare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?
				a.compareDocumentPosition( b ) :
	
				// Otherwise we know they are disconnected
				1;
	
			// Disconnected nodes
			if ( compare & 1 ||
				(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {
	
				// Choose the first element that is related to our preferred document
				if ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {
					return -1;
				}
				if ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {
					return 1;
				}
	
				// Maintain original order
				return sortInput ?
					( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
					0;
			}
	
			return compare & 4 ? -1 : 1;
		} :
		function( a, b ) {
			// Exit early if the nodes are identical
			if ( a === b ) {
				hasDuplicate = true;
				return 0;
			}
	
			var cur,
				i = 0,
				aup = a.parentNode,
				bup = b.parentNode,
				ap = [ a ],
				bp = [ b ];
	
			// Parentless nodes are either documents or disconnected
			if ( !aup || !bup ) {
				return a === doc ? -1 :
					b === doc ? 1 :
					aup ? -1 :
					bup ? 1 :
					sortInput ?
					( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
					0;
	
			// If the nodes are siblings, we can do a quick check
			} else if ( aup === bup ) {
				return siblingCheck( a, b );
			}
	
			// Otherwise we need full lists of their ancestors for comparison
			cur = a;
			while ( (cur = cur.parentNode) ) {
				ap.unshift( cur );
			}
			cur = b;
			while ( (cur = cur.parentNode) ) {
				bp.unshift( cur );
			}
	
			// Walk down the tree looking for a discrepancy
			while ( ap[i] === bp[i] ) {
				i++;
			}
	
			return i ?
				// Do a sibling check if the nodes have a common ancestor
				siblingCheck( ap[i], bp[i] ) :
	
				// Otherwise nodes in our document sort first
				ap[i] === preferredDoc ? -1 :
				bp[i] === preferredDoc ? 1 :
				0;
		};
	
		return doc;
	};
	
	Sizzle.matches = function( expr, elements ) {
		return Sizzle( expr, null, null, elements );
	};
	
	Sizzle.matchesSelector = function( elem, expr ) {
		// Set document vars if needed
		if ( ( elem.ownerDocument || elem ) !== document ) {
			setDocument( elem );
		}
	
		// Make sure that attribute selectors are quoted
		expr = expr.replace( rattributeQuotes, "='$1']" );
	
		if ( support.matchesSelector && documentIsHTML &&
			( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&
			( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {
	
			try {
				var ret = matches.call( elem, expr );
	
				// IE 9's matchesSelector returns false on disconnected nodes
				if ( ret || support.disconnectedMatch ||
						// As well, disconnected nodes are said to be in a document
						// fragment in IE 9
						elem.document && elem.document.nodeType !== 11 ) {
					return ret;
				}
			} catch (e) {}
		}
	
		return Sizzle( expr, document, null, [ elem ] ).length > 0;
	};
	
	Sizzle.contains = function( context, elem ) {
		// Set document vars if needed
		if ( ( context.ownerDocument || context ) !== document ) {
			setDocument( context );
		}
		return contains( context, elem );
	};
	
	Sizzle.attr = function( elem, name ) {
		// Set document vars if needed
		if ( ( elem.ownerDocument || elem ) !== document ) {
			setDocument( elem );
		}
	
		var fn = Expr.attrHandle[ name.toLowerCase() ],
			// Don't get fooled by Object.prototype properties (jQuery #13807)
			val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?
				fn( elem, name, !documentIsHTML ) :
				undefined;
	
		return val !== undefined ?
			val :
			support.attributes || !documentIsHTML ?
				elem.getAttribute( name ) :
				(val = elem.getAttributeNode(name)) && val.specified ?
					val.value :
					null;
	};
	
	Sizzle.error = function( msg ) {
		throw new Error( "Syntax error, unrecognized expression: " + msg );
	};
	
	/**
	 * Document sorting and removing duplicates
	 * @param {ArrayLike} results
	 */
	Sizzle.uniqueSort = function( results ) {
		var elem,
			duplicates = [],
			j = 0,
			i = 0;
	
		// Unless we *know* we can detect duplicates, assume their presence
		hasDuplicate = !support.detectDuplicates;
		sortInput = !support.sortStable && results.slice( 0 );
		results.sort( sortOrder );
	
		if ( hasDuplicate ) {
			while ( (elem = results[i++]) ) {
				if ( elem === results[ i ] ) {
					j = duplicates.push( i );
				}
			}
			while ( j-- ) {
				results.splice( duplicates[ j ], 1 );
			}
		}
	
		// Clear input after sorting to release objects
		// See https://github.com/jquery/sizzle/pull/225
		sortInput = null;
	
		return results;
	};
	
	/**
	 * Utility function for retrieving the text value of an array of DOM nodes
	 * @param {Array|Element} elem
	 */
	getText = Sizzle.getText = function( elem ) {
		var node,
			ret = "",
			i = 0,
			nodeType = elem.nodeType;
	
		if ( !nodeType ) {
			// If no nodeType, this is expected to be an array
			while ( (node = elem[i++]) ) {
				// Do not traverse comment nodes
				ret += getText( node );
			}
		} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {
			// Use textContent for elements
			// innerText usage removed for consistency of new lines (jQuery #11153)
			if ( typeof elem.textContent === "string" ) {
				return elem.textContent;
			} else {
				// Traverse its children
				for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
					ret += getText( elem );
				}
			}
		} else if ( nodeType === 3 || nodeType === 4 ) {
			return elem.nodeValue;
		}
		// Do not include comment or processing instruction nodes
	
		return ret;
	};
	
	Expr = Sizzle.selectors = {
	
		// Can be adjusted by the user
		cacheLength: 50,
	
		createPseudo: markFunction,
	
		match: matchExpr,
	
		attrHandle: {},
	
		find: {},
	
		relative: {
			">": { dir: "parentNode", first: true },
			" ": { dir: "parentNode" },
			"+": { dir: "previousSibling", first: true },
			"~": { dir: "previousSibling" }
		},
	
		preFilter: {
			"ATTR": function( match ) {
				match[1] = match[1].replace( runescape, funescape );
	
				// Move the given value to match[3] whether quoted or unquoted
				match[3] = ( match[3] || match[4] || match[5] || "" ).replace( runescape, funescape );
	
				if ( match[2] === "~=" ) {
					match[3] = " " + match[3] + " ";
				}
	
				return match.slice( 0, 4 );
			},
	
			"CHILD": function( match ) {
				/* matches from matchExpr["CHILD"]
					1 type (only|nth|...)
					2 what (child|of-type)
					3 argument (even|odd|\d*|\d*n([+-]\d+)?|...)
					4 xn-component of xn+y argument ([+-]?\d*n|)
					5 sign of xn-component
					6 x of xn-component
					7 sign of y-component
					8 y of y-component
				*/
				match[1] = match[1].toLowerCase();
	
				if ( match[1].slice( 0, 3 ) === "nth" ) {
					// nth-* requires argument
					if ( !match[3] ) {
						Sizzle.error( match[0] );
					}
	
					// numeric x and y parameters for Expr.filter.CHILD
					// remember that false/true cast respectively to 0/1
					match[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );
					match[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );
	
				// other types prohibit arguments
				} else if ( match[3] ) {
					Sizzle.error( match[0] );
				}
	
				return match;
			},
	
			"PSEUDO": function( match ) {
				var excess,
					unquoted = !match[6] && match[2];
	
				if ( matchExpr["CHILD"].test( match[0] ) ) {
					return null;
				}
	
				// Accept quoted arguments as-is
				if ( match[3] ) {
					match[2] = match[4] || match[5] || "";
	
				// Strip excess characters from unquoted arguments
				} else if ( unquoted && rpseudo.test( unquoted ) &&
					// Get excess from tokenize (recursively)
					(excess = tokenize( unquoted, true )) &&
					// advance to the next closing parenthesis
					(excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {
	
					// excess is a negative index
					match[0] = match[0].slice( 0, excess );
					match[2] = unquoted.slice( 0, excess );
				}
	
				// Return only captures needed by the pseudo filter method (type and argument)
				return match.slice( 0, 3 );
			}
		},
	
		filter: {
	
			"TAG": function( nodeNameSelector ) {
				var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();
				return nodeNameSelector === "*" ?
					function() { return true; } :
					function( elem ) {
						return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
					};
			},
	
			"CLASS": function( className ) {
				var pattern = classCache[ className + " " ];
	
				return pattern ||
					(pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&
					classCache( className, function( elem ) {
						return pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "" );
					});
			},
	
			"ATTR": function( name, operator, check ) {
				return function( elem ) {
					var result = Sizzle.attr( elem, name );
	
					if ( result == null ) {
						return operator === "!=";
					}
					if ( !operator ) {
						return true;
					}
	
					result += "";
	
					return operator === "=" ? result === check :
						operator === "!=" ? result !== check :
						operator === "^=" ? check && result.indexOf( check ) === 0 :
						operator === "*=" ? check && result.indexOf( check ) > -1 :
						operator === "$=" ? check && result.slice( -check.length ) === check :
						operator === "~=" ? ( " " + result.replace( rwhitespace, " " ) + " " ).indexOf( check ) > -1 :
						operator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :
						false;
				};
			},
	
			"CHILD": function( type, what, argument, first, last ) {
				var simple = type.slice( 0, 3 ) !== "nth",
					forward = type.slice( -4 ) !== "last",
					ofType = what === "of-type";
	
				return first === 1 && last === 0 ?
	
					// Shortcut for :nth-*(n)
					function( elem ) {
						return !!elem.parentNode;
					} :
	
					function( elem, context, xml ) {
						var cache, outerCache, node, diff, nodeIndex, start,
							dir = simple !== forward ? "nextSibling" : "previousSibling",
							parent = elem.parentNode,
							name = ofType && elem.nodeName.toLowerCase(),
							useCache = !xml && !ofType;
	
						if ( parent ) {
	
							// :(first|last|only)-(child|of-type)
							if ( simple ) {
								while ( dir ) {
									node = elem;
									while ( (node = node[ dir ]) ) {
										if ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {
											return false;
										}
									}
									// Reverse direction for :only-* (if we haven't yet done so)
									start = dir = type === "only" && !start && "nextSibling";
								}
								return true;
							}
	
							start = [ forward ? parent.firstChild : parent.lastChild ];
	
							// non-xml :nth-child(...) stores cache data on `parent`
							if ( forward && useCache ) {
								// Seek `elem` from a previously-cached index
								outerCache = parent[ expando ] || (parent[ expando ] = {});
								cache = outerCache[ type ] || [];
								nodeIndex = cache[0] === dirruns && cache[1];
								diff = cache[0] === dirruns && cache[2];
								node = nodeIndex && parent.childNodes[ nodeIndex ];
	
								while ( (node = ++nodeIndex && node && node[ dir ] ||
	
									// Fallback to seeking `elem` from the start
									(diff = nodeIndex = 0) || start.pop()) ) {
	
									// When found, cache indexes on `parent` and break
									if ( node.nodeType === 1 && ++diff && node === elem ) {
										outerCache[ type ] = [ dirruns, nodeIndex, diff ];
										break;
									}
								}
	
							// Use previously-cached element index if available
							} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {
								diff = cache[1];
	
							// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)
							} else {
								// Use the same loop as above to seek `elem` from the start
								while ( (node = ++nodeIndex && node && node[ dir ] ||
									(diff = nodeIndex = 0) || start.pop()) ) {
	
									if ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {
										// Cache the index of each encountered element
										if ( useCache ) {
											(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];
										}
	
										if ( node === elem ) {
											break;
										}
									}
								}
							}
	
							// Incorporate the offset, then check against cycle size
							diff -= last;
							return diff === first || ( diff % first === 0 && diff / first >= 0 );
						}
					};
			},
	
			"PSEUDO": function( pseudo, argument ) {
				// pseudo-class names are case-insensitive
				// http://www.w3.org/TR/selectors/#pseudo-classes
				// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters
				// Remember that setFilters inherits from pseudos
				var args,
					fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||
						Sizzle.error( "unsupported pseudo: " + pseudo );
	
				// The user may use createPseudo to indicate that
				// arguments are needed to create the filter function
				// just as Sizzle does
				if ( fn[ expando ] ) {
					return fn( argument );
				}
	
				// But maintain support for old signatures
				if ( fn.length > 1 ) {
					args = [ pseudo, pseudo, "", argument ];
					return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?
						markFunction(function( seed, matches ) {
							var idx,
								matched = fn( seed, argument ),
								i = matched.length;
							while ( i-- ) {
								idx = indexOf( seed, matched[i] );
								seed[ idx ] = !( matches[ idx ] = matched[i] );
							}
						}) :
						function( elem ) {
							return fn( elem, 0, args );
						};
				}
	
				return fn;
			}
		},
	
		pseudos: {
			// Potentially complex pseudos
			"not": markFunction(function( selector ) {
				// Trim the selector passed to compile
				// to avoid treating leading and trailing
				// spaces as combinators
				var input = [],
					results = [],
					matcher = compile( selector.replace( rtrim, "$1" ) );
	
				return matcher[ expando ] ?
					markFunction(function( seed, matches, context, xml ) {
						var elem,
							unmatched = matcher( seed, null, xml, [] ),
							i = seed.length;
	
						// Match elements unmatched by `matcher`
						while ( i-- ) {
							if ( (elem = unmatched[i]) ) {
								seed[i] = !(matches[i] = elem);
							}
						}
					}) :
					function( elem, context, xml ) {
						input[0] = elem;
						matcher( input, null, xml, results );
						// Don't keep the element (issue #299)
						input[0] = null;
						return !results.pop();
					};
			}),
	
			"has": markFunction(function( selector ) {
				return function( elem ) {
					return Sizzle( selector, elem ).length > 0;
				};
			}),
	
			"contains": markFunction(function( text ) {
				text = text.replace( runescape, funescape );
				return function( elem ) {
					return ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;
				};
			}),
	
			// "Whether an element is represented by a :lang() selector
			// is based solely on the element's language value
			// being equal to the identifier C,
			// or beginning with the identifier C immediately followed by "-".
			// The matching of C against the element's language value is performed case-insensitively.
			// The identifier C does not have to be a valid language name."
			// http://www.w3.org/TR/selectors/#lang-pseudo
			"lang": markFunction( function( lang ) {
				// lang value must be a valid identifier
				if ( !ridentifier.test(lang || "") ) {
					Sizzle.error( "unsupported lang: " + lang );
				}
				lang = lang.replace( runescape, funescape ).toLowerCase();
				return function( elem ) {
					var elemLang;
					do {
						if ( (elemLang = documentIsHTML ?
							elem.lang :
							elem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {
	
							elemLang = elemLang.toLowerCase();
							return elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;
						}
					} while ( (elem = elem.parentNode) && elem.nodeType === 1 );
					return false;
				};
			}),
	
			// Miscellaneous
			"target": function( elem ) {
				var hash = window.location && window.location.hash;
				return hash && hash.slice( 1 ) === elem.id;
			},
	
			"root": function( elem ) {
				return elem === docElem;
			},
	
			"focus": function( elem ) {
				return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);
			},
	
			// Boolean properties
			"enabled": function( elem ) {
				return elem.disabled === false;
			},
	
			"disabled": function( elem ) {
				return elem.disabled === true;
			},
	
			"checked": function( elem ) {
				// In CSS3, :checked should return both checked and selected elements
				// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
				var nodeName = elem.nodeName.toLowerCase();
				return (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);
			},
	
			"selected": function( elem ) {
				// Accessing this property makes selected-by-default
				// options in Safari work properly
				if ( elem.parentNode ) {
					elem.parentNode.selectedIndex;
				}
	
				return elem.selected === true;
			},
	
			// Contents
			"empty": function( elem ) {
				// http://www.w3.org/TR/selectors/#empty-pseudo
				// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),
				//   but not by others (comment: 8; processing instruction: 7; etc.)
				// nodeType < 6 works because attributes (2) do not appear as children
				for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
					if ( elem.nodeType < 6 ) {
						return false;
					}
				}
				return true;
			},
	
			"parent": function( elem ) {
				return !Expr.pseudos["empty"]( elem );
			},
	
			// Element/input types
			"header": function( elem ) {
				return rheader.test( elem.nodeName );
			},
	
			"input": function( elem ) {
				return rinputs.test( elem.nodeName );
			},
	
			"button": function( elem ) {
				var name = elem.nodeName.toLowerCase();
				return name === "input" && elem.type === "button" || name === "button";
			},
	
			"text": function( elem ) {
				var attr;
				return elem.nodeName.toLowerCase() === "input" &&
					elem.type === "text" &&
	
					// Support: IE<8
					// New HTML5 attribute values (e.g., "search") appear with elem.type === "text"
					( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text" );
			},
	
			// Position-in-collection
			"first": createPositionalPseudo(function() {
				return [ 0 ];
			}),
	
			"last": createPositionalPseudo(function( matchIndexes, length ) {
				return [ length - 1 ];
			}),
	
			"eq": createPositionalPseudo(function( matchIndexes, length, argument ) {
				return [ argument < 0 ? argument + length : argument ];
			}),
	
			"even": createPositionalPseudo(function( matchIndexes, length ) {
				var i = 0;
				for ( ; i < length; i += 2 ) {
					matchIndexes.push( i );
				}
				return matchIndexes;
			}),
	
			"odd": createPositionalPseudo(function( matchIndexes, length ) {
				var i = 1;
				for ( ; i < length; i += 2 ) {
					matchIndexes.push( i );
				}
				return matchIndexes;
			}),
	
			"lt": createPositionalPseudo(function( matchIndexes, length, argument ) {
				var i = argument < 0 ? argument + length : argument;
				for ( ; --i >= 0; ) {
					matchIndexes.push( i );
				}
				return matchIndexes;
			}),
	
			"gt": createPositionalPseudo(function( matchIndexes, length, argument ) {
				var i = argument < 0 ? argument + length : argument;
				for ( ; ++i < length; ) {
					matchIndexes.push( i );
				}
				return matchIndexes;
			})
		}
	};
	
	Expr.pseudos["nth"] = Expr.pseudos["eq"];
	
	// Add button/input type pseudos
	for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {
		Expr.pseudos[ i ] = createInputPseudo( i );
	}
	for ( i in { submit: true, reset: true } ) {
		Expr.pseudos[ i ] = createButtonPseudo( i );
	}
	
	// Easy API for creating new setFilters
	function setFilters() {}
	setFilters.prototype = Expr.filters = Expr.pseudos;
	Expr.setFilters = new setFilters();
	
	tokenize = Sizzle.tokenize = function( selector, parseOnly ) {
		var matched, match, tokens, type,
			soFar, groups, preFilters,
			cached = tokenCache[ selector + " " ];
	
		if ( cached ) {
			return parseOnly ? 0 : cached.slice( 0 );
		}
	
		soFar = selector;
		groups = [];
		preFilters = Expr.preFilter;
	
		while ( soFar ) {
	
			// Comma and first run
			if ( !matched || (match = rcomma.exec( soFar )) ) {
				if ( match ) {
					// Don't consume trailing commas as valid
					soFar = soFar.slice( match[0].length ) || soFar;
				}
				groups.push( (tokens = []) );
			}
	
			matched = false;
	
			// Combinators
			if ( (match = rcombinators.exec( soFar )) ) {
				matched = match.shift();
				tokens.push({
					value: matched,
					// Cast descendant combinators to space
					type: match[0].replace( rtrim, " " )
				});
				soFar = soFar.slice( matched.length );
			}
	
			// Filters
			for ( type in Expr.filter ) {
				if ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||
					(match = preFilters[ type ]( match ))) ) {
					matched = match.shift();
					tokens.push({
						value: matched,
						type: type,
						matches: match
					});
					soFar = soFar.slice( matched.length );
				}
			}
	
			if ( !matched ) {
				break;
			}
		}
	
		// Return the length of the invalid excess
		// if we're just parsing
		// Otherwise, throw an error or return tokens
		return parseOnly ?
			soFar.length :
			soFar ?
				Sizzle.error( selector ) :
				// Cache the tokens
				tokenCache( selector, groups ).slice( 0 );
	};
	
	function toSelector( tokens ) {
		var i = 0,
			len = tokens.length,
			selector = "";
		for ( ; i < len; i++ ) {
			selector += tokens[i].value;
		}
		return selector;
	}
	
	function addCombinator( matcher, combinator, base ) {
		var dir = combinator.dir,
			checkNonElements = base && dir === "parentNode",
			doneName = done++;
	
		return combinator.first ?
			// Check against closest ancestor/preceding element
			function( elem, context, xml ) {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						return matcher( elem, context, xml );
					}
				}
			} :
	
			// Check against all ancestor/preceding elements
			function( elem, context, xml ) {
				var oldCache, outerCache,
					newCache = [ dirruns, doneName ];
	
				// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching
				if ( xml ) {
					while ( (elem = elem[ dir ]) ) {
						if ( elem.nodeType === 1 || checkNonElements ) {
							if ( matcher( elem, context, xml ) ) {
								return true;
							}
						}
					}
				} else {
					while ( (elem = elem[ dir ]) ) {
						if ( elem.nodeType === 1 || checkNonElements ) {
							outerCache = elem[ expando ] || (elem[ expando ] = {});
							if ( (oldCache = outerCache[ dir ]) &&
								oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {
	
								// Assign to newCache so results back-propagate to previous elements
								return (newCache[ 2 ] = oldCache[ 2 ]);
							} else {
								// Reuse newcache so results back-propagate to previous elements
								outerCache[ dir ] = newCache;
	
								// A match means we're done; a fail means we have to keep checking
								if ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {
									return true;
								}
							}
						}
					}
				}
			};
	}
	
	function elementMatcher( matchers ) {
		return matchers.length > 1 ?
			function( elem, context, xml ) {
				var i = matchers.length;
				while ( i-- ) {
					if ( !matchers[i]( elem, context, xml ) ) {
						return false;
					}
				}
				return true;
			} :
			matchers[0];
	}
	
	function multipleContexts( selector, contexts, results ) {
		var i = 0,
			len = contexts.length;
		for ( ; i < len; i++ ) {
			Sizzle( selector, contexts[i], results );
		}
		return results;
	}
	
	function condense( unmatched, map, filter, context, xml ) {
		var elem,
			newUnmatched = [],
			i = 0,
			len = unmatched.length,
			mapped = map != null;
	
		for ( ; i < len; i++ ) {
			if ( (elem = unmatched[i]) ) {
				if ( !filter || filter( elem, context, xml ) ) {
					newUnmatched.push( elem );
					if ( mapped ) {
						map.push( i );
					}
				}
			}
		}
	
		return newUnmatched;
	}
	
	function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {
		if ( postFilter && !postFilter[ expando ] ) {
			postFilter = setMatcher( postFilter );
		}
		if ( postFinder && !postFinder[ expando ] ) {
			postFinder = setMatcher( postFinder, postSelector );
		}
		return markFunction(function( seed, results, context, xml ) {
			var temp, i, elem,
				preMap = [],
				postMap = [],
				preexisting = results.length,
	
				// Get initial elements from seed or context
				elems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),
	
				// Prefilter to get matcher input, preserving a map for seed-results synchronization
				matcherIn = preFilter && ( seed || !selector ) ?
					condense( elems, preMap, preFilter, context, xml ) :
					elems,
	
				matcherOut = matcher ?
					// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,
					postFinder || ( seed ? preFilter : preexisting || postFilter ) ?
	
						// ...intermediate processing is necessary
						[] :
	
						// ...otherwise use results directly
						results :
					matcherIn;
	
			// Find primary matches
			if ( matcher ) {
				matcher( matcherIn, matcherOut, context, xml );
			}
	
			// Apply postFilter
			if ( postFilter ) {
				temp = condense( matcherOut, postMap );
				postFilter( temp, [], context, xml );
	
				// Un-match failing elements by moving them back to matcherIn
				i = temp.length;
				while ( i-- ) {
					if ( (elem = temp[i]) ) {
						matcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);
					}
				}
			}
	
			if ( seed ) {
				if ( postFinder || preFilter ) {
					if ( postFinder ) {
						// Get the final matcherOut by condensing this intermediate into postFinder contexts
						temp = [];
						i = matcherOut.length;
						while ( i-- ) {
							if ( (elem = matcherOut[i]) ) {
								// Restore matcherIn since elem is not yet a final match
								temp.push( (matcherIn[i] = elem) );
							}
						}
						postFinder( null, (matcherOut = []), temp, xml );
					}
	
					// Move matched elements from seed to results to keep them synchronized
					i = matcherOut.length;
					while ( i-- ) {
						if ( (elem = matcherOut[i]) &&
							(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {
	
							seed[temp] = !(results[temp] = elem);
						}
					}
				}
	
			// Add elements to results, through postFinder if defined
			} else {
				matcherOut = condense(
					matcherOut === results ?
						matcherOut.splice( preexisting, matcherOut.length ) :
						matcherOut
				);
				if ( postFinder ) {
					postFinder( null, results, matcherOut, xml );
				} else {
					push.apply( results, matcherOut );
				}
			}
		});
	}
	
	function matcherFromTokens( tokens ) {
		var checkContext, matcher, j,
			len = tokens.length,
			leadingRelative = Expr.relative[ tokens[0].type ],
			implicitRelative = leadingRelative || Expr.relative[" "],
			i = leadingRelative ? 1 : 0,
	
			// The foundational matcher ensures that elements are reachable from top-level context(s)
			matchContext = addCombinator( function( elem ) {
				return elem === checkContext;
			}, implicitRelative, true ),
			matchAnyContext = addCombinator( function( elem ) {
				return indexOf( checkContext, elem ) > -1;
			}, implicitRelative, true ),
			matchers = [ function( elem, context, xml ) {
				var ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (
					(checkContext = context).nodeType ?
						matchContext( elem, context, xml ) :
						matchAnyContext( elem, context, xml ) );
				// Avoid hanging onto element (issue #299)
				checkContext = null;
				return ret;
			} ];
	
		for ( ; i < len; i++ ) {
			if ( (matcher = Expr.relative[ tokens[i].type ]) ) {
				matchers = [ addCombinator(elementMatcher( matchers ), matcher) ];
			} else {
				matcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );
	
				// Return special upon seeing a positional matcher
				if ( matcher[ expando ] ) {
					// Find the next relative operator (if any) for proper handling
					j = ++i;
					for ( ; j < len; j++ ) {
						if ( Expr.relative[ tokens[j].type ] ) {
							break;
						}
					}
					return setMatcher(
						i > 1 && elementMatcher( matchers ),
						i > 1 && toSelector(
							// If the preceding token was a descendant combinator, insert an implicit any-element `*`
							tokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })
						).replace( rtrim, "$1" ),
						matcher,
						i < j && matcherFromTokens( tokens.slice( i, j ) ),
						j < len && matcherFromTokens( (tokens = tokens.slice( j )) ),
						j < len && toSelector( tokens )
					);
				}
				matchers.push( matcher );
			}
		}
	
		return elementMatcher( matchers );
	}
	
	function matcherFromGroupMatchers( elementMatchers, setMatchers ) {
		var bySet = setMatchers.length > 0,
			byElement = elementMatchers.length > 0,
			superMatcher = function( seed, context, xml, results, outermost ) {
				var elem, j, matcher,
					matchedCount = 0,
					i = "0",
					unmatched = seed && [],
					setMatched = [],
					contextBackup = outermostContext,
					// We must always have either seed elements or outermost context
					elems = seed || byElement && Expr.find["TAG"]( "*", outermost ),
					// Use integer dirruns iff this is the outermost matcher
					dirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),
					len = elems.length;
	
				if ( outermost ) {
					outermostContext = context !== document && context;
				}
	
				// Add elements passing elementMatchers directly to results
				// Keep `i` a string if there are no elements so `matchedCount` will be "00" below
				// Support: IE<9, Safari
				// Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id
				for ( ; i !== len && (elem = elems[i]) != null; i++ ) {
					if ( byElement && elem ) {
						j = 0;
						while ( (matcher = elementMatchers[j++]) ) {
							if ( matcher( elem, context, xml ) ) {
								results.push( elem );
								break;
							}
						}
						if ( outermost ) {
							dirruns = dirrunsUnique;
						}
					}
	
					// Track unmatched elements for set filters
					if ( bySet ) {
						// They will have gone through all possible matchers
						if ( (elem = !matcher && elem) ) {
							matchedCount--;
						}
	
						// Lengthen the array for every element, matched or not
						if ( seed ) {
							unmatched.push( elem );
						}
					}
				}
	
				// Apply set filters to unmatched elements
				matchedCount += i;
				if ( bySet && i !== matchedCount ) {
					j = 0;
					while ( (matcher = setMatchers[j++]) ) {
						matcher( unmatched, setMatched, context, xml );
					}
	
					if ( seed ) {
						// Reintegrate element matches to eliminate the need for sorting
						if ( matchedCount > 0 ) {
							while ( i-- ) {
								if ( !(unmatched[i] || setMatched[i]) ) {
									setMatched[i] = pop.call( results );
								}
							}
						}
	
						// Discard index placeholder values to get only actual matches
						setMatched = condense( setMatched );
					}
	
					// Add matches to results
					push.apply( results, setMatched );
	
					// Seedless set matches succeeding multiple successful matchers stipulate sorting
					if ( outermost && !seed && setMatched.length > 0 &&
						( matchedCount + setMatchers.length ) > 1 ) {
	
						Sizzle.uniqueSort( results );
					}
				}
	
				// Override manipulation of globals by nested matchers
				if ( outermost ) {
					dirruns = dirrunsUnique;
					outermostContext = contextBackup;
				}
	
				return unmatched;
			};
	
		return bySet ?
			markFunction( superMatcher ) :
			superMatcher;
	}
	
	compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {
		var i,
			setMatchers = [],
			elementMatchers = [],
			cached = compilerCache[ selector + " " ];
	
		if ( !cached ) {
			// Generate a function of recursive functions that can be used to check each element
			if ( !match ) {
				match = tokenize( selector );
			}
			i = match.length;
			while ( i-- ) {
				cached = matcherFromTokens( match[i] );
				if ( cached[ expando ] ) {
					setMatchers.push( cached );
				} else {
					elementMatchers.push( cached );
				}
			}
	
			// Cache the compiled function
			cached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );
	
			// Save selector and tokenization
			cached.selector = selector;
		}
		return cached;
	};
	
	/**
	 * A low-level selection function that works with Sizzle's compiled
	 *  selector functions
	 * @param {String|Function} selector A selector or a pre-compiled
	 *  selector function built with Sizzle.compile
	 * @param {Element} context
	 * @param {Array} [results]
	 * @param {Array} [seed] A set of elements to match against
	 */
	select = Sizzle.select = function( selector, context, results, seed ) {
		var i, tokens, token, type, find,
			compiled = typeof selector === "function" && selector,
			match = !seed && tokenize( (selector = compiled.selector || selector) );
	
		results = results || [];
	
		// Try to minimize operations if there is no seed and only one group
		if ( match.length === 1 ) {
	
			// Take a shortcut and set the context if the root selector is an ID
			tokens = match[0] = match[0].slice( 0 );
			if ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&
					support.getById && context.nodeType === 9 && documentIsHTML &&
					Expr.relative[ tokens[1].type ] ) {
	
				context = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];
				if ( !context ) {
					return results;
	
				// Precompiled matchers will still verify ancestry, so step up a level
				} else if ( compiled ) {
					context = context.parentNode;
				}
	
				selector = selector.slice( tokens.shift().value.length );
			}
	
			// Fetch a seed set for right-to-left matching
			i = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;
			while ( i-- ) {
				token = tokens[i];
	
				// Abort if we hit a combinator
				if ( Expr.relative[ (type = token.type) ] ) {
					break;
				}
				if ( (find = Expr.find[ type ]) ) {
					// Search, expanding context for leading sibling combinators
					if ( (seed = find(
						token.matches[0].replace( runescape, funescape ),
						rsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context
					)) ) {
	
						// If seed is empty or no tokens remain, we can return early
						tokens.splice( i, 1 );
						selector = seed.length && toSelector( tokens );
						if ( !selector ) {
							push.apply( results, seed );
							return results;
						}
	
						break;
					}
				}
			}
		}
	
		// Compile and execute a filtering function if one is not provided
		// Provide `match` to avoid retokenization if we modified the selector above
		( compiled || compile( selector, match ) )(
			seed,
			context,
			!documentIsHTML,
			results,
			rsibling.test( selector ) && testContext( context.parentNode ) || context
		);
		return results;
	};
	
	// One-time assignments
	
	// Sort stability
	support.sortStable = expando.split("").sort( sortOrder ).join("") === expando;
	
	// Support: Chrome 14-35+
	// Always assume duplicates if they aren't passed to the comparison function
	support.detectDuplicates = !!hasDuplicate;
	
	// Initialize against the default document
	setDocument();
	
	// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)
	// Detached nodes confoundingly follow *each other*
	support.sortDetached = assert(function( div1 ) {
		// Should return 1, but returns 4 (following)
		return div1.compareDocumentPosition( document.createElement("div") ) & 1;
	});
	
	// Support: IE<8
	// Prevent attribute/property "interpolation"
	// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx
	if ( !assert(function( div ) {
		div.innerHTML = "<a href='#'></a>";
		return div.firstChild.getAttribute("href") === "#" ;
	}) ) {
		addHandle( "type|href|height|width", function( elem, name, isXML ) {
			if ( !isXML ) {
				return elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );
			}
		});
	}
	
	// Support: IE<9
	// Use defaultValue in place of getAttribute("value")
	if ( !support.attributes || !assert(function( div ) {
		div.innerHTML = "<input/>";
		div.firstChild.setAttribute( "value", "" );
		return div.firstChild.getAttribute( "value" ) === "";
	}) ) {
		addHandle( "value", function( elem, name, isXML ) {
			if ( !isXML && elem.nodeName.toLowerCase() === "input" ) {
				return elem.defaultValue;
			}
		});
	}
	
	// Support: IE<9
	// Use getAttributeNode to fetch booleans when getAttribute lies
	if ( !assert(function( div ) {
		return div.getAttribute("disabled") == null;
	}) ) {
		addHandle( booleans, function( elem, name, isXML ) {
			var val;
			if ( !isXML ) {
				return elem[ name ] === true ? name.toLowerCase() :
						(val = elem.getAttributeNode( name )) && val.specified ?
						val.value :
					null;
			}
		});
	}
	
	return Sizzle;
	
	})( window );
	
	
	
	jQuery.find = Sizzle;
	jQuery.expr = Sizzle.selectors;
	jQuery.expr[":"] = jQuery.expr.pseudos;
	jQuery.unique = Sizzle.uniqueSort;
	jQuery.text = Sizzle.getText;
	jQuery.isXMLDoc = Sizzle.isXML;
	jQuery.contains = Sizzle.contains;
	
	
	
	var rneedsContext = jQuery.expr.match.needsContext;
	
	var rsingleTag = (/^<(\w+)\s*\/?>(?:<\/\1>|)$/);
	
	
	
	var risSimple = /^.[^:#\[\.,]*$/;
	
	// Implement the identical functionality for filter and not
	function winnow( elements, qualifier, not ) {
		if ( jQuery.isFunction( qualifier ) ) {
			return jQuery.grep( elements, function( elem, i ) {
				/* jshint -W018 */
				return !!qualifier.call( elem, i, elem ) !== not;
			});
	
		}
	
		if ( qualifier.nodeType ) {
			return jQuery.grep( elements, function( elem ) {
				return ( elem === qualifier ) !== not;
			});
	
		}
	
		if ( typeof qualifier === "string" ) {
			if ( risSimple.test( qualifier ) ) {
				return jQuery.filter( qualifier, elements, not );
			}
	
			qualifier = jQuery.filter( qualifier, elements );
		}
	
		return jQuery.grep( elements, function( elem ) {
			return ( indexOf.call( qualifier, elem ) >= 0 ) !== not;
		});
	}
	
	jQuery.filter = function( expr, elems, not ) {
		var elem = elems[ 0 ];
	
		if ( not ) {
			expr = ":not(" + expr + ")";
		}
	
		return elems.length === 1 && elem.nodeType === 1 ?
			jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :
			jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {
				return elem.nodeType === 1;
			}));
	};
	
	jQuery.fn.extend({
		find: function( selector ) {
			var i,
				len = this.length,
				ret = [],
				self = this;
	
			if ( typeof selector !== "string" ) {
				return this.pushStack( jQuery( selector ).filter(function() {
					for ( i = 0; i < len; i++ ) {
						if ( jQuery.contains( self[ i ], this ) ) {
							return true;
						}
					}
				}) );
			}
	
			for ( i = 0; i < len; i++ ) {
				jQuery.find( selector, self[ i ], ret );
			}
	
			// Needed because $( selector, context ) becomes $( context ).find( selector )
			ret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );
			ret.selector = this.selector ? this.selector + " " + selector : selector;
			return ret;
		},
		filter: function( selector ) {
			return this.pushStack( winnow(this, selector || [], false) );
		},
		not: function( selector ) {
			return this.pushStack( winnow(this, selector || [], true) );
		},
		is: function( selector ) {
			return !!winnow(
				this,
	
				// If this is a positional/relative selector, check membership in the returned set
				// so $("p:first").is("p:last") won't return true for a doc with two "p".
				typeof selector === "string" && rneedsContext.test( selector ) ?
					jQuery( selector ) :
					selector || [],
				false
			).length;
		}
	});
	
	
	// Initialize a jQuery object
	
	
	// A central reference to the root jQuery(document)
	var rootjQuery,
	
		// A simple way to check for HTML strings
		// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
		// Strict HTML recognition (#11290: must start with <)
		rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
	
		init = jQuery.fn.init = function( selector, context ) {
			var match, elem;
	
			// HANDLE: $(""), $(null), $(undefined), $(false)
			if ( !selector ) {
				return this;
			}
	
			// Handle HTML strings
			if ( typeof selector === "string" ) {
				if ( selector[0] === "<" && selector[ selector.length - 1 ] === ">" && selector.length >= 3 ) {
					// Assume that strings that start and end with <> are HTML and skip the regex check
					match = [ null, selector, null ];
	
				} else {
					match = rquickExpr.exec( selector );
				}
	
				// Match html or make sure no context is specified for #id
				if ( match && (match[1] || !context) ) {
	
					// HANDLE: $(html) -> $(array)
					if ( match[1] ) {
						context = context instanceof jQuery ? context[0] : context;
	
						// Option to run scripts is true for back-compat
						// Intentionally let the error be thrown if parseHTML is not present
						jQuery.merge( this, jQuery.parseHTML(
							match[1],
							context && context.nodeType ? context.ownerDocument || context : document,
							true
						) );
	
						// HANDLE: $(html, props)
						if ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {
							for ( match in context ) {
								// Properties of context are called as methods if possible
								if ( jQuery.isFunction( this[ match ] ) ) {
									this[ match ]( context[ match ] );
	
								// ...and otherwise set as attributes
								} else {
									this.attr( match, context[ match ] );
								}
							}
						}
	
						return this;
	
					// HANDLE: $(#id)
					} else {
						elem = document.getElementById( match[2] );
	
						// Support: Blackberry 4.6
						// gEBID returns nodes no longer in the document (#6963)
						if ( elem && elem.parentNode ) {
							// Inject the element directly into the jQuery object
							this.length = 1;
							this[0] = elem;
						}
	
						this.context = document;
						this.selector = selector;
						return this;
					}
	
				// HANDLE: $(expr, $(...))
				} else if ( !context || context.jquery ) {
					return ( context || rootjQuery ).find( selector );
	
				// HANDLE: $(expr, context)
				// (which is just equivalent to: $(context).find(expr)
				} else {
					return this.constructor( context ).find( selector );
				}
	
			// HANDLE: $(DOMElement)
			} else if ( selector.nodeType ) {
				this.context = this[0] = selector;
				this.length = 1;
				return this;
	
			// HANDLE: $(function)
			// Shortcut for document ready
			} else if ( jQuery.isFunction( selector ) ) {
				return typeof rootjQuery.ready !== "undefined" ?
					rootjQuery.ready( selector ) :
					// Execute immediately if ready is not present
					selector( jQuery );
			}
	
			if ( selector.selector !== undefined ) {
				this.selector = selector.selector;
				this.context = selector.context;
			}
	
			return jQuery.makeArray( selector, this );
		};
	
	// Give the init function the jQuery prototype for later instantiation
	init.prototype = jQuery.fn;
	
	// Initialize central reference
	rootjQuery = jQuery( document );
	
	
	var rparentsprev = /^(?:parents|prev(?:Until|All))/,
		// Methods guaranteed to produce a unique set when starting from a unique set
		guaranteedUnique = {
			children: true,
			contents: true,
			next: true,
			prev: true
		};
	
	jQuery.extend({
		dir: function( elem, dir, until ) {
			var matched = [],
				truncate = until !== undefined;
	
			while ( (elem = elem[ dir ]) && elem.nodeType !== 9 ) {
				if ( elem.nodeType === 1 ) {
					if ( truncate && jQuery( elem ).is( until ) ) {
						break;
					}
					matched.push( elem );
				}
			}
			return matched;
		},
	
		sibling: function( n, elem ) {
			var matched = [];
	
			for ( ; n; n = n.nextSibling ) {
				if ( n.nodeType === 1 && n !== elem ) {
					matched.push( n );
				}
			}
	
			return matched;
		}
	});
	
	jQuery.fn.extend({
		has: function( target ) {
			var targets = jQuery( target, this ),
				l = targets.length;
	
			return this.filter(function() {
				var i = 0;
				for ( ; i < l; i++ ) {
					if ( jQuery.contains( this, targets[i] ) ) {
						return true;
					}
				}
			});
		},
	
		closest: function( selectors, context ) {
			var cur,
				i = 0,
				l = this.length,
				matched = [],
				pos = rneedsContext.test( selectors ) || typeof selectors !== "string" ?
					jQuery( selectors, context || this.context ) :
					0;
	
			for ( ; i < l; i++ ) {
				for ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {
					// Always skip document fragments
					if ( cur.nodeType < 11 && (pos ?
						pos.index(cur) > -1 :
	
						// Don't pass non-elements to Sizzle
						cur.nodeType === 1 &&
							jQuery.find.matchesSelector(cur, selectors)) ) {
	
						matched.push( cur );
						break;
					}
				}
			}
	
			return this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );
		},
	
		// Determine the position of an element within the set
		index: function( elem ) {
	
			// No argument, return index in parent
			if ( !elem ) {
				return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;
			}
	
			// Index in selector
			if ( typeof elem === "string" ) {
				return indexOf.call( jQuery( elem ), this[ 0 ] );
			}
	
			// Locate the position of the desired element
			return indexOf.call( this,
	
				// If it receives a jQuery object, the first element is used
				elem.jquery ? elem[ 0 ] : elem
			);
		},
	
		add: function( selector, context ) {
			return this.pushStack(
				jQuery.unique(
					jQuery.merge( this.get(), jQuery( selector, context ) )
				)
			);
		},
	
		addBack: function( selector ) {
			return this.add( selector == null ?
				this.prevObject : this.prevObject.filter(selector)
			);
		}
	});
	
	function sibling( cur, dir ) {
		while ( (cur = cur[dir]) && cur.nodeType !== 1 ) {}
		return cur;
	}
	
	jQuery.each({
		parent: function( elem ) {
			var parent = elem.parentNode;
			return parent && parent.nodeType !== 11 ? parent : null;
		},
		parents: function( elem ) {
			return jQuery.dir( elem, "parentNode" );
		},
		parentsUntil: function( elem, i, until ) {
			return jQuery.dir( elem, "parentNode", until );
		},
		next: function( elem ) {
			return sibling( elem, "nextSibling" );
		},
		prev: function( elem ) {
			return sibling( elem, "previousSibling" );
		},
		nextAll: function( elem ) {
			return jQuery.dir( elem, "nextSibling" );
		},
		prevAll: function( elem ) {
			return jQuery.dir( elem, "previousSibling" );
		},
		nextUntil: function( elem, i, until ) {
			return jQuery.dir( elem, "nextSibling", until );
		},
		prevUntil: function( elem, i, until ) {
			return jQuery.dir( elem, "previousSibling", until );
		},
		siblings: function( elem ) {
			return jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );
		},
		children: function( elem ) {
			return jQuery.sibling( elem.firstChild );
		},
		contents: function( elem ) {
			return elem.contentDocument || jQuery.merge( [], elem.childNodes );
		}
	}, function( name, fn ) {
		jQuery.fn[ name ] = function( until, selector ) {
			var matched = jQuery.map( this, fn, until );
	
			if ( name.slice( -5 ) !== "Until" ) {
				selector = until;
			}
	
			if ( selector && typeof selector === "string" ) {
				matched = jQuery.filter( selector, matched );
			}
	
			if ( this.length > 1 ) {
				// Remove duplicates
				if ( !guaranteedUnique[ name ] ) {
					jQuery.unique( matched );
				}
	
				// Reverse order for parents* and prev-derivatives
				if ( rparentsprev.test( name ) ) {
					matched.reverse();
				}
			}
	
			return this.pushStack( matched );
		};
	});
	var rnotwhite = (/\S+/g);
	
	
	
	// String to Object options format cache
	var optionsCache = {};
	
	// Convert String-formatted options into Object-formatted ones and store in cache
	function createOptions( options ) {
		var object = optionsCache[ options ] = {};
		jQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {
			object[ flag ] = true;
		});
		return object;
	}
	
	/*
	 * Create a callback list using the following parameters:
	 *
	 *	options: an optional list of space-separated options that will change how
	 *			the callback list behaves or a more traditional option object
	 *
	 * By default a callback list will act like an event callback list and can be
	 * "fired" multiple times.
	 *
	 * Possible options:
	 *
	 *	once:			will ensure the callback list can only be fired once (like a Deferred)
	 *
	 *	memory:			will keep track of previous values and will call any callback added
	 *					after the list has been fired right away with the latest "memorized"
	 *					values (like a Deferred)
	 *
	 *	unique:			will ensure a callback can only be added once (no duplicate in the list)
	 *
	 *	stopOnFalse:	interrupt callings when a callback returns false
	 *
	 */
	jQuery.Callbacks = function( options ) {
	
		// Convert options from String-formatted to Object-formatted if needed
		// (we check in cache first)
		options = typeof options === "string" ?
			( optionsCache[ options ] || createOptions( options ) ) :
			jQuery.extend( {}, options );
	
		var // Last fire value (for non-forgettable lists)
			memory,
			// Flag to know if list was already fired
			fired,
			// Flag to know if list is currently firing
			firing,
			// First callback to fire (used internally by add and fireWith)
			firingStart,
			// End of the loop when firing
			firingLength,
			// Index of currently firing callback (modified by remove if needed)
			firingIndex,
			// Actual callback list
			list = [],
			// Stack of fire calls for repeatable lists
			stack = !options.once && [],
			// Fire callbacks
			fire = function( data ) {
				memory = options.memory && data;
				fired = true;
				firingIndex = firingStart || 0;
				firingStart = 0;
				firingLength = list.length;
				firing = true;
				for ( ; list && firingIndex < firingLength; firingIndex++ ) {
					if ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {
						memory = false; // To prevent further calls using add
						break;
					}
				}
				firing = false;
				if ( list ) {
					if ( stack ) {
						if ( stack.length ) {
							fire( stack.shift() );
						}
					} else if ( memory ) {
						list = [];
					} else {
						self.disable();
					}
				}
			},
			// Actual Callbacks object
			self = {
				// Add a callback or a collection of callbacks to the list
				add: function() {
					if ( list ) {
						// First, we save the current length
						var start = list.length;
						(function add( args ) {
							jQuery.each( args, function( _, arg ) {
								var type = jQuery.type( arg );
								if ( type === "function" ) {
									if ( !options.unique || !self.has( arg ) ) {
										list.push( arg );
									}
								} else if ( arg && arg.length && type !== "string" ) {
									// Inspect recursively
									add( arg );
								}
							});
						})( arguments );
						// Do we need to add the callbacks to the
						// current firing batch?
						if ( firing ) {
							firingLength = list.length;
						// With memory, if we're not firing then
						// we should call right away
						} else if ( memory ) {
							firingStart = start;
							fire( memory );
						}
					}
					return this;
				},
				// Remove a callback from the list
				remove: function() {
					if ( list ) {
						jQuery.each( arguments, function( _, arg ) {
							var index;
							while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {
								list.splice( index, 1 );
								// Handle firing indexes
								if ( firing ) {
									if ( index <= firingLength ) {
										firingLength--;
									}
									if ( index <= firingIndex ) {
										firingIndex--;
									}
								}
							}
						});
					}
					return this;
				},
				// Check if a given callback is in the list.
				// If no argument is given, return whether or not list has callbacks attached.
				has: function( fn ) {
					return fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );
				},
				// Remove all callbacks from the list
				empty: function() {
					list = [];
					firingLength = 0;
					return this;
				},
				// Have the list do nothing anymore
				disable: function() {
					list = stack = memory = undefined;
					return this;
				},
				// Is it disabled?
				disabled: function() {
					return !list;
				},
				// Lock the list in its current state
				lock: function() {
					stack = undefined;
					if ( !memory ) {
						self.disable();
					}
					return this;
				},
				// Is it locked?
				locked: function() {
					return !stack;
				},
				// Call all callbacks with the given context and arguments
				fireWith: function( context, args ) {
					if ( list && ( !fired || stack ) ) {
						args = args || [];
						args = [ context, args.slice ? args.slice() : args ];
						if ( firing ) {
							stack.push( args );
						} else {
							fire( args );
						}
					}
					return this;
				},
				// Call all the callbacks with the given arguments
				fire: function() {
					self.fireWith( this, arguments );
					return this;
				},
				// To know if the callbacks have already been called at least once
				fired: function() {
					return !!fired;
				}
			};
	
		return self;
	};
	
	
	jQuery.extend({
	
		Deferred: function( func ) {
			var tuples = [
					// action, add listener, listener list, final state
					[ "resolve", "done", jQuery.Callbacks("once memory"), "resolved" ],
					[ "reject", "fail", jQuery.Callbacks("once memory"), "rejected" ],
					[ "notify", "progress", jQuery.Callbacks("memory") ]
				],
				state = "pending",
				promise = {
					state: function() {
						return state;
					},
					always: function() {
						deferred.done( arguments ).fail( arguments );
						return this;
					},
					then: function( /* fnDone, fnFail, fnProgress */ ) {
						var fns = arguments;
						return jQuery.Deferred(function( newDefer ) {
							jQuery.each( tuples, function( i, tuple ) {
								var fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];
								// deferred[ done | fail | progress ] for forwarding actions to newDefer
								deferred[ tuple[1] ](function() {
									var returned = fn && fn.apply( this, arguments );
									if ( returned && jQuery.isFunction( returned.promise ) ) {
										returned.promise()
											.done( newDefer.resolve )
											.fail( newDefer.reject )
											.progress( newDefer.notify );
									} else {
										newDefer[ tuple[ 0 ] + "With" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );
									}
								});
							});
							fns = null;
						}).promise();
					},
					// Get a promise for this deferred
					// If obj is provided, the promise aspect is added to the object
					promise: function( obj ) {
						return obj != null ? jQuery.extend( obj, promise ) : promise;
					}
				},
				deferred = {};
	
			// Keep pipe for back-compat
			promise.pipe = promise.then;
	
			// Add list-specific methods
			jQuery.each( tuples, function( i, tuple ) {
				var list = tuple[ 2 ],
					stateString = tuple[ 3 ];
	
				// promise[ done | fail | progress ] = list.add
				promise[ tuple[1] ] = list.add;
	
				// Handle state
				if ( stateString ) {
					list.add(function() {
						// state = [ resolved | rejected ]
						state = stateString;
	
					// [ reject_list | resolve_list ].disable; progress_list.lock
					}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );
				}
	
				// deferred[ resolve | reject | notify ]
				deferred[ tuple[0] ] = function() {
					deferred[ tuple[0] + "With" ]( this === deferred ? promise : this, arguments );
					return this;
				};
				deferred[ tuple[0] + "With" ] = list.fireWith;
			});
	
			// Make the deferred a promise
			promise.promise( deferred );
	
			// Call given func if any
			if ( func ) {
				func.call( deferred, deferred );
			}
	
			// All done!
			return deferred;
		},
	
		// Deferred helper
		when: function( subordinate /* , ..., subordinateN */ ) {
			var i = 0,
				resolveValues = slice.call( arguments ),
				length = resolveValues.length,
	
				// the count of uncompleted subordinates
				remaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,
	
				// the master Deferred. If resolveValues consist of only a single Deferred, just use that.
				deferred = remaining === 1 ? subordinate : jQuery.Deferred(),
	
				// Update function for both resolve and progress values
				updateFunc = function( i, contexts, values ) {
					return function( value ) {
						contexts[ i ] = this;
						values[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;
						if ( values === progressValues ) {
							deferred.notifyWith( contexts, values );
						} else if ( !( --remaining ) ) {
							deferred.resolveWith( contexts, values );
						}
					};
				},
	
				progressValues, progressContexts, resolveContexts;
	
			// Add listeners to Deferred subordinates; treat others as resolved
			if ( length > 1 ) {
				progressValues = new Array( length );
				progressContexts = new Array( length );
				resolveContexts = new Array( length );
				for ( ; i < length; i++ ) {
					if ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {
						resolveValues[ i ].promise()
							.done( updateFunc( i, resolveContexts, resolveValues ) )
							.fail( deferred.reject )
							.progress( updateFunc( i, progressContexts, progressValues ) );
					} else {
						--remaining;
					}
				}
			}
	
			// If we're not waiting on anything, resolve the master
			if ( !remaining ) {
				deferred.resolveWith( resolveContexts, resolveValues );
			}
	
			return deferred.promise();
		}
	});
	
	
	// The deferred used on DOM ready
	var readyList;
	
	jQuery.fn.ready = function( fn ) {
		// Add the callback
		jQuery.ready.promise().done( fn );
	
		return this;
	};
	
	jQuery.extend({
		// Is the DOM ready to be used? Set to true once it occurs.
		isReady: false,
	
		// A counter to track how many items to wait for before
		// the ready event fires. See #6781
		readyWait: 1,
	
		// Hold (or release) the ready event
		holdReady: function( hold ) {
			if ( hold ) {
				jQuery.readyWait++;
			} else {
				jQuery.ready( true );
			}
		},
	
		// Handle when the DOM is ready
		ready: function( wait ) {
	
			// Abort if there are pending holds or we're already ready
			if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {
				return;
			}
	
			// Remember that the DOM is ready
			jQuery.isReady = true;
	
			// If a normal DOM Ready event fired, decrement, and wait if need be
			if ( wait !== true && --jQuery.readyWait > 0 ) {
				return;
			}
	
			// If there are functions bound, to execute
			readyList.resolveWith( document, [ jQuery ] );
	
			// Trigger any bound ready events
			if ( jQuery.fn.triggerHandler ) {
				jQuery( document ).triggerHandler( "ready" );
				jQuery( document ).off( "ready" );
			}
		}
	});
	
	/**
	 * The ready event handler and self cleanup method
	 */
	function completed() {
		document.removeEventListener( "DOMContentLoaded", completed, false );
		window.removeEventListener( "load", completed, false );
		jQuery.ready();
	}
	
	jQuery.ready.promise = function( obj ) {
		if ( !readyList ) {
	
			readyList = jQuery.Deferred();
	
			// Catch cases where $(document).ready() is called after the browser event has already occurred.
			// We once tried to use readyState "interactive" here, but it caused issues like the one
			// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15
			if ( document.readyState === "complete" ) {
				// Handle it asynchronously to allow scripts the opportunity to delay ready
				setTimeout( jQuery.ready );
	
			} else {
	
				// Use the handy event callback
				document.addEventListener( "DOMContentLoaded", completed, false );
	
				// A fallback to window.onload, that will always work
				window.addEventListener( "load", completed, false );
			}
		}
		return readyList.promise( obj );
	};
	
	// Kick off the DOM ready check even if the user does not
	jQuery.ready.promise();
	
	
	
	
	// Multifunctional method to get and set values of a collection
	// The value/s can optionally be executed if it's a function
	var access = jQuery.access = function( elems, fn, key, value, chainable, emptyGet, raw ) {
		var i = 0,
			len = elems.length,
			bulk = key == null;
	
		// Sets many values
		if ( jQuery.type( key ) === "object" ) {
			chainable = true;
			for ( i in key ) {
				jQuery.access( elems, fn, i, key[i], true, emptyGet, raw );
			}
	
		// Sets one value
		} else if ( value !== undefined ) {
			chainable = true;
	
			if ( !jQuery.isFunction( value ) ) {
				raw = true;
			}
	
			if ( bulk ) {
				// Bulk operations run against the entire set
				if ( raw ) {
					fn.call( elems, value );
					fn = null;
	
				// ...except when executing function values
				} else {
					bulk = fn;
					fn = function( elem, key, value ) {
						return bulk.call( jQuery( elem ), value );
					};
				}
			}
	
			if ( fn ) {
				for ( ; i < len; i++ ) {
					fn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );
				}
			}
		}
	
		return chainable ?
			elems :
	
			// Gets
			bulk ?
				fn.call( elems ) :
				len ? fn( elems[0], key ) : emptyGet;
	};
	
	
	/**
	 * Determines whether an object can have data
	 */
	jQuery.acceptData = function( owner ) {
		// Accepts only:
		//  - Node
		//    - Node.ELEMENT_NODE
		//    - Node.DOCUMENT_NODE
		//  - Object
		//    - Any
		/* jshint -W018 */
		return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );
	};
	
	
	function Data() {
		// Support: Android<4,
		// Old WebKit does not have Object.preventExtensions/freeze method,
		// return new empty object instead with no [[set]] accessor
		Object.defineProperty( this.cache = {}, 0, {
			get: function() {
				return {};
			}
		});
	
		this.expando = jQuery.expando + Data.uid++;
	}
	
	Data.uid = 1;
	Data.accepts = jQuery.acceptData;
	
	Data.prototype = {
		key: function( owner ) {
			// We can accept data for non-element nodes in modern browsers,
			// but we should not, see #8335.
			// Always return the key for a frozen object.
			if ( !Data.accepts( owner ) ) {
				return 0;
			}
	
			var descriptor = {},
				// Check if the owner object already has a cache key
				unlock = owner[ this.expando ];
	
			// If not, create one
			if ( !unlock ) {
				unlock = Data.uid++;
	
				// Secure it in a non-enumerable, non-writable property
				try {
					descriptor[ this.expando ] = { value: unlock };
					Object.defineProperties( owner, descriptor );
	
				// Support: Android<4
				// Fallback to a less secure definition
				} catch ( e ) {
					descriptor[ this.expando ] = unlock;
					jQuery.extend( owner, descriptor );
				}
			}
	
			// Ensure the cache object
			if ( !this.cache[ unlock ] ) {
				this.cache[ unlock ] = {};
			}
	
			return unlock;
		},
		set: function( owner, data, value ) {
			var prop,
				// There may be an unlock assigned to this node,
				// if there is no entry for this "owner", create one inline
				// and set the unlock as though an owner entry had always existed
				unlock = this.key( owner ),
				cache = this.cache[ unlock ];
	
			// Handle: [ owner, key, value ] args
			if ( typeof data === "string" ) {
				cache[ data ] = value;
	
			// Handle: [ owner, { properties } ] args
			} else {
				// Fresh assignments by object are shallow copied
				if ( jQuery.isEmptyObject( cache ) ) {
					jQuery.extend( this.cache[ unlock ], data );
				// Otherwise, copy the properties one-by-one to the cache object
				} else {
					for ( prop in data ) {
						cache[ prop ] = data[ prop ];
					}
				}
			}
			return cache;
		},
		get: function( owner, key ) {
			// Either a valid cache is found, or will be created.
			// New caches will be created and the unlock returned,
			// allowing direct access to the newly created
			// empty data object. A valid owner object must be provided.
			var cache = this.cache[ this.key( owner ) ];
	
			return key === undefined ?
				cache : cache[ key ];
		},
		access: function( owner, key, value ) {
			var stored;
			// In cases where either:
			//
			//   1. No key was specified
			//   2. A string key was specified, but no value provided
			//
			// Take the "read" path and allow the get method to determine
			// which value to return, respectively either:
			//
			//   1. The entire cache object
			//   2. The data stored at the key
			//
			if ( key === undefined ||
					((key && typeof key === "string") && value === undefined) ) {
	
				stored = this.get( owner, key );
	
				return stored !== undefined ?
					stored : this.get( owner, jQuery.camelCase(key) );
			}
	
			// [*]When the key is not a string, or both a key and value
			// are specified, set or extend (existing objects) with either:
			//
			//   1. An object of properties
			//   2. A key and value
			//
			this.set( owner, key, value );
	
			// Since the "set" path can have two possible entry points
			// return the expected data based on which path was taken[*]
			return value !== undefined ? value : key;
		},
		remove: function( owner, key ) {
			var i, name, camel,
				unlock = this.key( owner ),
				cache = this.cache[ unlock ];
	
			if ( key === undefined ) {
				this.cache[ unlock ] = {};
	
			} else {
				// Support array or space separated string of keys
				if ( jQuery.isArray( key ) ) {
					// If "name" is an array of keys...
					// When data is initially created, via ("key", "val") signature,
					// keys will be converted to camelCase.
					// Since there is no way to tell _how_ a key was added, remove
					// both plain key and camelCase key. #12786
					// This will only penalize the array argument path.
					name = key.concat( key.map( jQuery.camelCase ) );
				} else {
					camel = jQuery.camelCase( key );
					// Try the string as a key before any manipulation
					if ( key in cache ) {
						name = [ key, camel ];
					} else {
						// If a key with the spaces exists, use it.
						// Otherwise, create an array by matching non-whitespace
						name = camel;
						name = name in cache ?
							[ name ] : ( name.match( rnotwhite ) || [] );
					}
				}
	
				i = name.length;
				while ( i-- ) {
					delete cache[ name[ i ] ];
				}
			}
		},
		hasData: function( owner ) {
			return !jQuery.isEmptyObject(
				this.cache[ owner[ this.expando ] ] || {}
			);
		},
		discard: function( owner ) {
			if ( owner[ this.expando ] ) {
				delete this.cache[ owner[ this.expando ] ];
			}
		}
	};
	var data_priv = new Data();
	
	var data_user = new Data();
	
	
	
	//	Implementation Summary
	//
	//	1. Enforce API surface and semantic compatibility with 1.9.x branch
	//	2. Improve the module's maintainability by reducing the storage
	//		paths to a single mechanism.
	//	3. Use the same single mechanism to support "private" and "user" data.
	//	4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)
	//	5. Avoid exposing implementation details on user objects (eg. expando properties)
	//	6. Provide a clear path for implementation upgrade to WeakMap in 2014
	
	var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
		rmultiDash = /([A-Z])/g;
	
	function dataAttr( elem, key, data ) {
		var name;
	
		// If nothing was found internally, try to fetch any
		// data from the HTML5 data-* attribute
		if ( data === undefined && elem.nodeType === 1 ) {
			name = "data-" + key.replace( rmultiDash, "-$1" ).toLowerCase();
			data = elem.getAttribute( name );
	
			if ( typeof data === "string" ) {
				try {
					data = data === "true" ? true :
						data === "false" ? false :
						data === "null" ? null :
						// Only convert to a number if it doesn't change the string
						+data + "" === data ? +data :
						rbrace.test( data ) ? jQuery.parseJSON( data ) :
						data;
				} catch( e ) {}
	
				// Make sure we set the data so it isn't changed later
				data_user.set( elem, key, data );
			} else {
				data = undefined;
			}
		}
		return data;
	}
	
	jQuery.extend({
		hasData: function( elem ) {
			return data_user.hasData( elem ) || data_priv.hasData( elem );
		},
	
		data: function( elem, name, data ) {
			return data_user.access( elem, name, data );
		},
	
		removeData: function( elem, name ) {
			data_user.remove( elem, name );
		},
	
		// TODO: Now that all calls to _data and _removeData have been replaced
		// with direct calls to data_priv methods, these can be deprecated.
		_data: function( elem, name, data ) {
			return data_priv.access( elem, name, data );
		},
	
		_removeData: function( elem, name ) {
			data_priv.remove( elem, name );
		}
	});
	
	jQuery.fn.extend({
		data: function( key, value ) {
			var i, name, data,
				elem = this[ 0 ],
				attrs = elem && elem.attributes;
	
			// Gets all values
			if ( key === undefined ) {
				if ( this.length ) {
					data = data_user.get( elem );
	
					if ( elem.nodeType === 1 && !data_priv.get( elem, "hasDataAttrs" ) ) {
						i = attrs.length;
						while ( i-- ) {
	
							// Support: IE11+
							// The attrs elements can be null (#14894)
							if ( attrs[ i ] ) {
								name = attrs[ i ].name;
								if ( name.indexOf( "data-" ) === 0 ) {
									name = jQuery.camelCase( name.slice(5) );
									dataAttr( elem, name, data[ name ] );
								}
							}
						}
						data_priv.set( elem, "hasDataAttrs", true );
					}
				}
	
				return data;
			}
	
			// Sets multiple values
			if ( typeof key === "object" ) {
				return this.each(function() {
					data_user.set( this, key );
				});
			}
	
			return access( this, function( value ) {
				var data,
					camelKey = jQuery.camelCase( key );
	
				// The calling jQuery object (element matches) is not empty
				// (and therefore has an element appears at this[ 0 ]) and the
				// `value` parameter was not undefined. An empty jQuery object
				// will result in `undefined` for elem = this[ 0 ] which will
				// throw an exception if an attempt to read a data cache is made.
				if ( elem && value === undefined ) {
					// Attempt to get data from the cache
					// with the key as-is
					data = data_user.get( elem, key );
					if ( data !== undefined ) {
						return data;
					}
	
					// Attempt to get data from the cache
					// with the key camelized
					data = data_user.get( elem, camelKey );
					if ( data !== undefined ) {
						return data;
					}
	
					// Attempt to "discover" the data in
					// HTML5 custom data-* attrs
					data = dataAttr( elem, camelKey, undefined );
					if ( data !== undefined ) {
						return data;
					}
	
					// We tried really hard, but the data doesn't exist.
					return;
				}
	
				// Set the data...
				this.each(function() {
					// First, attempt to store a copy or reference of any
					// data that might've been store with a camelCased key.
					var data = data_user.get( this, camelKey );
	
					// For HTML5 data-* attribute interop, we have to
					// store property names with dashes in a camelCase form.
					// This might not apply to all properties...*
					data_user.set( this, camelKey, value );
	
					// *... In the case of properties that might _actually_
					// have dashes, we need to also store a copy of that
					// unchanged property.
					if ( key.indexOf("-") !== -1 && data !== undefined ) {
						data_user.set( this, key, value );
					}
				});
			}, null, value, arguments.length > 1, null, true );
		},
	
		removeData: function( key ) {
			return this.each(function() {
				data_user.remove( this, key );
			});
		}
	});
	
	
	jQuery.extend({
		queue: function( elem, type, data ) {
			var queue;
	
			if ( elem ) {
				type = ( type || "fx" ) + "queue";
				queue = data_priv.get( elem, type );
	
				// Speed up dequeue by getting out quickly if this is just a lookup
				if ( data ) {
					if ( !queue || jQuery.isArray( data ) ) {
						queue = data_priv.access( elem, type, jQuery.makeArray(data) );
					} else {
						queue.push( data );
					}
				}
				return queue || [];
			}
		},
	
		dequeue: function( elem, type ) {
			type = type || "fx";
	
			var queue = jQuery.queue( elem, type ),
				startLength = queue.length,
				fn = queue.shift(),
				hooks = jQuery._queueHooks( elem, type ),
				next = function() {
					jQuery.dequeue( elem, type );
				};
	
			// If the fx queue is dequeued, always remove the progress sentinel
			if ( fn === "inprogress" ) {
				fn = queue.shift();
				startLength--;
			}
	
			if ( fn ) {
	
				// Add a progress sentinel to prevent the fx queue from being
				// automatically dequeued
				if ( type === "fx" ) {
					queue.unshift( "inprogress" );
				}
	
				// Clear up the last queue stop function
				delete hooks.stop;
				fn.call( elem, next, hooks );
			}
	
			if ( !startLength && hooks ) {
				hooks.empty.fire();
			}
		},
	
		// Not public - generate a queueHooks object, or return the current one
		_queueHooks: function( elem, type ) {
			var key = type + "queueHooks";
			return data_priv.get( elem, key ) || data_priv.access( elem, key, {
				empty: jQuery.Callbacks("once memory").add(function() {
					data_priv.remove( elem, [ type + "queue", key ] );
				})
			});
		}
	});
	
	jQuery.fn.extend({
		queue: function( type, data ) {
			var setter = 2;
	
			if ( typeof type !== "string" ) {
				data = type;
				type = "fx";
				setter--;
			}
	
			if ( arguments.length < setter ) {
				return jQuery.queue( this[0], type );
			}
	
			return data === undefined ?
				this :
				this.each(function() {
					var queue = jQuery.queue( this, type, data );
	
					// Ensure a hooks for this queue
					jQuery._queueHooks( this, type );
	
					if ( type === "fx" && queue[0] !== "inprogress" ) {
						jQuery.dequeue( this, type );
					}
				});
		},
		dequeue: function( type ) {
			return this.each(function() {
				jQuery.dequeue( this, type );
			});
		},
		clearQueue: function( type ) {
			return this.queue( type || "fx", [] );
		},
		// Get a promise resolved when queues of a certain type
		// are emptied (fx is the type by default)
		promise: function( type, obj ) {
			var tmp,
				count = 1,
				defer = jQuery.Deferred(),
				elements = this,
				i = this.length,
				resolve = function() {
					if ( !( --count ) ) {
						defer.resolveWith( elements, [ elements ] );
					}
				};
	
			if ( typeof type !== "string" ) {
				obj = type;
				type = undefined;
			}
			type = type || "fx";
	
			while ( i-- ) {
				tmp = data_priv.get( elements[ i ], type + "queueHooks" );
				if ( tmp && tmp.empty ) {
					count++;
					tmp.empty.add( resolve );
				}
			}
			resolve();
			return defer.promise( obj );
		}
	});
	var pnum = (/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;
	
	var cssExpand = [ "Top", "Right", "Bottom", "Left" ];
	
	var isHidden = function( elem, el ) {
			// isHidden might be called from jQuery#filter function;
			// in that case, element will be second argument
			elem = el || elem;
			return jQuery.css( elem, "display" ) === "none" || !jQuery.contains( elem.ownerDocument, elem );
		};
	
	var rcheckableType = (/^(?:checkbox|radio)$/i);
	
	
	
	(function() {
		var fragment = document.createDocumentFragment(),
			div = fragment.appendChild( document.createElement( "div" ) ),
			input = document.createElement( "input" );
	
		// Support: Safari<=5.1
		// Check state lost if the name is set (#11217)
		// Support: Windows Web Apps (WWA)
		// `name` and `type` must use .setAttribute for WWA (#14901)
		input.setAttribute( "type", "radio" );
		input.setAttribute( "checked", "checked" );
		input.setAttribute( "name", "t" );
	
		div.appendChild( input );
	
		// Support: Safari<=5.1, Android<4.2
		// Older WebKit doesn't clone checked state correctly in fragments
		support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;
	
		// Support: IE<=11+
		// Make sure textarea (and checkbox) defaultValue is properly cloned
		div.innerHTML = "<textarea>x</textarea>";
		support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;
	})();
	var strundefined = typeof undefined;
	
	
	
	support.focusinBubbles = "onfocusin" in window;
	
	
	var
		rkeyEvent = /^key/,
		rmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,
		rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,
		rtypenamespace = /^([^.]*)(?:\.(.+)|)$/;
	
	function returnTrue() {
		return true;
	}
	
	function returnFalse() {
		return false;
	}
	
	function safeActiveElement() {
		try {
			return document.activeElement;
		} catch ( err ) { }
	}
	
	/*
	 * Helper functions for managing events -- not part of the public interface.
	 * Props to Dean Edwards' addEvent library for many of the ideas.
	 */
	jQuery.event = {
	
		global: {},
	
		add: function( elem, types, handler, data, selector ) {
	
			var handleObjIn, eventHandle, tmp,
				events, t, handleObj,
				special, handlers, type, namespaces, origType,
				elemData = data_priv.get( elem );
	
			// Don't attach events to noData or text/comment nodes (but allow plain objects)
			if ( !elemData ) {
				return;
			}
	
			// Caller can pass in an object of custom data in lieu of the handler
			if ( handler.handler ) {
				handleObjIn = handler;
				handler = handleObjIn.handler;
				selector = handleObjIn.selector;
			}
	
			// Make sure that the handler has a unique ID, used to find/remove it later
			if ( !handler.guid ) {
				handler.guid = jQuery.guid++;
			}
	
			// Init the element's event structure and main handler, if this is the first
			if ( !(events = elemData.events) ) {
				events = elemData.events = {};
			}
			if ( !(eventHandle = elemData.handle) ) {
				eventHandle = elemData.handle = function( e ) {
					// Discard the second event of a jQuery.event.trigger() and
					// when an event is called after a page has unloaded
					return typeof jQuery !== strundefined && jQuery.event.triggered !== e.type ?
						jQuery.event.dispatch.apply( elem, arguments ) : undefined;
				};
			}
	
			// Handle multiple events separated by a space
			types = ( types || "" ).match( rnotwhite ) || [ "" ];
			t = types.length;
			while ( t-- ) {
				tmp = rtypenamespace.exec( types[t] ) || [];
				type = origType = tmp[1];
				namespaces = ( tmp[2] || "" ).split( "." ).sort();
	
				// There *must* be a type, no attaching namespace-only handlers
				if ( !type ) {
					continue;
				}
	
				// If event changes its type, use the special event handlers for the changed type
				special = jQuery.event.special[ type ] || {};
	
				// If selector defined, determine special event api type, otherwise given type
				type = ( selector ? special.delegateType : special.bindType ) || type;
	
				// Update special based on newly reset type
				special = jQuery.event.special[ type ] || {};
	
				// handleObj is passed to all event handlers
				handleObj = jQuery.extend({
					type: type,
					origType: origType,
					data: data,
					handler: handler,
					guid: handler.guid,
					selector: selector,
					needsContext: selector && jQuery.expr.match.needsContext.test( selector ),
					namespace: namespaces.join(".")
				}, handleObjIn );
	
				// Init the event handler queue if we're the first
				if ( !(handlers = events[ type ]) ) {
					handlers = events[ type ] = [];
					handlers.delegateCount = 0;
	
					// Only use addEventListener if the special events handler returns false
					if ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {
						if ( elem.addEventListener ) {
							elem.addEventListener( type, eventHandle, false );
						}
					}
				}
	
				if ( special.add ) {
					special.add.call( elem, handleObj );
	
					if ( !handleObj.handler.guid ) {
						handleObj.handler.guid = handler.guid;
					}
				}
	
				// Add to the element's handler list, delegates in front
				if ( selector ) {
					handlers.splice( handlers.delegateCount++, 0, handleObj );
				} else {
					handlers.push( handleObj );
				}
	
				// Keep track of which events have ever been used, for event optimization
				jQuery.event.global[ type ] = true;
			}
	
		},
	
		// Detach an event or set of events from an element
		remove: function( elem, types, handler, selector, mappedTypes ) {
	
			var j, origCount, tmp,
				events, t, handleObj,
				special, handlers, type, namespaces, origType,
				elemData = data_priv.hasData( elem ) && data_priv.get( elem );
	
			if ( !elemData || !(events = elemData.events) ) {
				return;
			}
	
			// Once for each type.namespace in types; type may be omitted
			types = ( types || "" ).match( rnotwhite ) || [ "" ];
			t = types.length;
			while ( t-- ) {
				tmp = rtypenamespace.exec( types[t] ) || [];
				type = origType = tmp[1];
				namespaces = ( tmp[2] || "" ).split( "." ).sort();
	
				// Unbind all events (on this namespace, if provided) for the element
				if ( !type ) {
					for ( type in events ) {
						jQuery.event.remove( elem, type + types[ t ], handler, selector, true );
					}
					continue;
				}
	
				special = jQuery.event.special[ type ] || {};
				type = ( selector ? special.delegateType : special.bindType ) || type;
				handlers = events[ type ] || [];
				tmp = tmp[2] && new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" );
	
				// Remove matching events
				origCount = j = handlers.length;
				while ( j-- ) {
					handleObj = handlers[ j ];
	
					if ( ( mappedTypes || origType === handleObj.origType ) &&
						( !handler || handler.guid === handleObj.guid ) &&
						( !tmp || tmp.test( handleObj.namespace ) ) &&
						( !selector || selector === handleObj.selector || selector === "**" && handleObj.selector ) ) {
						handlers.splice( j, 1 );
	
						if ( handleObj.selector ) {
							handlers.delegateCount--;
						}
						if ( special.remove ) {
							special.remove.call( elem, handleObj );
						}
					}
				}
	
				// Remove generic event handler if we removed something and no more handlers exist
				// (avoids potential for endless recursion during removal of special event handlers)
				if ( origCount && !handlers.length ) {
					if ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {
						jQuery.removeEvent( elem, type, elemData.handle );
					}
	
					delete events[ type ];
				}
			}
	
			// Remove the expando if it's no longer used
			if ( jQuery.isEmptyObject( events ) ) {
				delete elemData.handle;
				data_priv.remove( elem, "events" );
			}
		},
	
		trigger: function( event, data, elem, onlyHandlers ) {
	
			var i, cur, tmp, bubbleType, ontype, handle, special,
				eventPath = [ elem || document ],
				type = hasOwn.call( event, "type" ) ? event.type : event,
				namespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split(".") : [];
	
			cur = tmp = elem = elem || document;
	
			// Don't do events on text and comment nodes
			if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
				return;
			}
	
			// focus/blur morphs to focusin/out; ensure we're not firing them right now
			if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {
				return;
			}
	
			if ( type.indexOf(".") >= 0 ) {
				// Namespaced trigger; create a regexp to match event type in handle()
				namespaces = type.split(".");
				type = namespaces.shift();
				namespaces.sort();
			}
			ontype = type.indexOf(":") < 0 && "on" + type;
	
			// Caller can pass in a jQuery.Event object, Object, or just an event type string
			event = event[ jQuery.expando ] ?
				event :
				new jQuery.Event( type, typeof event === "object" && event );
	
			// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)
			event.isTrigger = onlyHandlers ? 2 : 3;
			event.namespace = namespaces.join(".");
			event.namespace_re = event.namespace ?
				new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" ) :
				null;
	
			// Clean up the event in case it is being reused
			event.result = undefined;
			if ( !event.target ) {
				event.target = elem;
			}
	
			// Clone any incoming data and prepend the event, creating the handler arg list
			data = data == null ?
				[ event ] :
				jQuery.makeArray( data, [ event ] );
	
			// Allow special events to draw outside the lines
			special = jQuery.event.special[ type ] || {};
			if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {
				return;
			}
	
			// Determine event propagation path in advance, per W3C events spec (#9951)
			// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)
			if ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {
	
				bubbleType = special.delegateType || type;
				if ( !rfocusMorph.test( bubbleType + type ) ) {
					cur = cur.parentNode;
				}
				for ( ; cur; cur = cur.parentNode ) {
					eventPath.push( cur );
					tmp = cur;
				}
	
				// Only add window if we got to document (e.g., not plain obj or detached DOM)
				if ( tmp === (elem.ownerDocument || document) ) {
					eventPath.push( tmp.defaultView || tmp.parentWindow || window );
				}
			}
	
			// Fire handlers on the event path
			i = 0;
			while ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {
	
				event.type = i > 1 ?
					bubbleType :
					special.bindType || type;
	
				// jQuery handler
				handle = ( data_priv.get( cur, "events" ) || {} )[ event.type ] && data_priv.get( cur, "handle" );
				if ( handle ) {
					handle.apply( cur, data );
				}
	
				// Native handler
				handle = ontype && cur[ ontype ];
				if ( handle && handle.apply && jQuery.acceptData( cur ) ) {
					event.result = handle.apply( cur, data );
					if ( event.result === false ) {
						event.preventDefault();
					}
				}
			}
			event.type = type;
	
			// If nobody prevented the default action, do it now
			if ( !onlyHandlers && !event.isDefaultPrevented() ) {
	
				if ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&
					jQuery.acceptData( elem ) ) {
	
					// Call a native DOM method on the target with the same name name as the event.
					// Don't do default actions on window, that's where global variables be (#6170)
					if ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {
	
						// Don't re-trigger an onFOO event when we call its FOO() method
						tmp = elem[ ontype ];
	
						if ( tmp ) {
							elem[ ontype ] = null;
						}
	
						// Prevent re-triggering of the same event, since we already bubbled it above
						jQuery.event.triggered = type;
						elem[ type ]();
						jQuery.event.triggered = undefined;
	
						if ( tmp ) {
							elem[ ontype ] = tmp;
						}
					}
				}
			}
	
			return event.result;
		},
	
		dispatch: function( event ) {
	
			// Make a writable jQuery.Event from the native event object
			event = jQuery.event.fix( event );
	
			var i, j, ret, matched, handleObj,
				handlerQueue = [],
				args = slice.call( arguments ),
				handlers = ( data_priv.get( this, "events" ) || {} )[ event.type ] || [],
				special = jQuery.event.special[ event.type ] || {};
	
			// Use the fix-ed jQuery.Event rather than the (read-only) native event
			args[0] = event;
			event.delegateTarget = this;
	
			// Call the preDispatch hook for the mapped type, and let it bail if desired
			if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {
				return;
			}
	
			// Determine handlers
			handlerQueue = jQuery.event.handlers.call( this, event, handlers );
	
			// Run delegates first; they may want to stop propagation beneath us
			i = 0;
			while ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {
				event.currentTarget = matched.elem;
	
				j = 0;
				while ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {
	
					// Triggered event must either 1) have no namespace, or 2) have namespace(s)
					// a subset or equal to those in the bound event (both can have no namespace).
					if ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {
	
						event.handleObj = handleObj;
						event.data = handleObj.data;
	
						ret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )
								.apply( matched.elem, args );
	
						if ( ret !== undefined ) {
							if ( (event.result = ret) === false ) {
								event.preventDefault();
								event.stopPropagation();
							}
						}
					}
				}
			}
	
			// Call the postDispatch hook for the mapped type
			if ( special.postDispatch ) {
				special.postDispatch.call( this, event );
			}
	
			return event.result;
		},
	
		handlers: function( event, handlers ) {
			var i, matches, sel, handleObj,
				handlerQueue = [],
				delegateCount = handlers.delegateCount,
				cur = event.target;
	
			// Find delegate handlers
			// Black-hole SVG <use> instance trees (#13180)
			// Avoid non-left-click bubbling in Firefox (#3861)
			if ( delegateCount && cur.nodeType && (!event.button || event.type !== "click") ) {
	
				for ( ; cur !== this; cur = cur.parentNode || this ) {
	
					// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)
					if ( cur.disabled !== true || event.type !== "click" ) {
						matches = [];
						for ( i = 0; i < delegateCount; i++ ) {
							handleObj = handlers[ i ];
	
							// Don't conflict with Object.prototype properties (#13203)
							sel = handleObj.selector + " ";
	
							if ( matches[ sel ] === undefined ) {
								matches[ sel ] = handleObj.needsContext ?
									jQuery( sel, this ).index( cur ) >= 0 :
									jQuery.find( sel, this, null, [ cur ] ).length;
							}
							if ( matches[ sel ] ) {
								matches.push( handleObj );
							}
						}
						if ( matches.length ) {
							handlerQueue.push({ elem: cur, handlers: matches });
						}
					}
				}
			}
	
			// Add the remaining (directly-bound) handlers
			if ( delegateCount < handlers.length ) {
				handlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });
			}
	
			return handlerQueue;
		},
	
		// Includes some event props shared by KeyEvent and MouseEvent
		props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
	
		fixHooks: {},
	
		keyHooks: {
			props: "char charCode key keyCode".split(" "),
			filter: function( event, original ) {
	
				// Add which for key events
				if ( event.which == null ) {
					event.which = original.charCode != null ? original.charCode : original.keyCode;
				}
	
				return event;
			}
		},
	
		mouseHooks: {
			props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
			filter: function( event, original ) {
				var eventDoc, doc, body,
					button = original.button;
	
				// Calculate pageX/Y if missing and clientX/Y available
				if ( event.pageX == null && original.clientX != null ) {
					eventDoc = event.target.ownerDocument || document;
					doc = eventDoc.documentElement;
					body = eventDoc.body;
	
					event.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );
					event.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );
				}
	
				// Add which for click: 1 === left; 2 === middle; 3 === right
				// Note: button is not normalized, so don't use it
				if ( !event.which && button !== undefined ) {
					event.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
				}
	
				return event;
			}
		},
	
		fix: function( event ) {
			if ( event[ jQuery.expando ] ) {
				return event;
			}
	
			// Create a writable copy of the event object and normalize some properties
			var i, prop, copy,
				type = event.type,
				originalEvent = event,
				fixHook = this.fixHooks[ type ];
	
			if ( !fixHook ) {
				this.fixHooks[ type ] = fixHook =
					rmouseEvent.test( type ) ? this.mouseHooks :
					rkeyEvent.test( type ) ? this.keyHooks :
					{};
			}
			copy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;
	
			event = new jQuery.Event( originalEvent );
	
			i = copy.length;
			while ( i-- ) {
				prop = copy[ i ];
				event[ prop ] = originalEvent[ prop ];
			}
	
			// Support: Cordova 2.5 (WebKit) (#13255)
			// All events should have a target; Cordova deviceready doesn't
			if ( !event.target ) {
				event.target = document;
			}
	
			// Support: Safari 6.0+, Chrome<28
			// Target should not be a text node (#504, #13143)
			if ( event.target.nodeType === 3 ) {
				event.target = event.target.parentNode;
			}
	
			return fixHook.filter ? fixHook.filter( event, originalEvent ) : event;
		},
	
		special: {
			load: {
				// Prevent triggered image.load events from bubbling to window.load
				noBubble: true
			},
			focus: {
				// Fire native event if possible so blur/focus sequence is correct
				trigger: function() {
					if ( this !== safeActiveElement() && this.focus ) {
						this.focus();
						return false;
					}
				},
				delegateType: "focusin"
			},
			blur: {
				trigger: function() {
					if ( this === safeActiveElement() && this.blur ) {
						this.blur();
						return false;
					}
				},
				delegateType: "focusout"
			},
			click: {
				// For checkbox, fire native event so checked state will be right
				trigger: function() {
					if ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {
						this.click();
						return false;
					}
				},
	
				// For cross-browser consistency, don't fire native .click() on links
				_default: function( event ) {
					return jQuery.nodeName( event.target, "a" );
				}
			},
	
			beforeunload: {
				postDispatch: function( event ) {
	
					// Support: Firefox 20+
					// Firefox doesn't alert if the returnValue field is not set.
					if ( event.result !== undefined && event.originalEvent ) {
						event.originalEvent.returnValue = event.result;
					}
				}
			}
		},
	
		simulate: function( type, elem, event, bubble ) {
			// Piggyback on a donor event to simulate a different one.
			// Fake originalEvent to avoid donor's stopPropagation, but if the
			// simulated event prevents default then we do the same on the donor.
			var e = jQuery.extend(
				new jQuery.Event(),
				event,
				{
					type: type,
					isSimulated: true,
					originalEvent: {}
				}
			);
			if ( bubble ) {
				jQuery.event.trigger( e, null, elem );
			} else {
				jQuery.event.dispatch.call( elem, e );
			}
			if ( e.isDefaultPrevented() ) {
				event.preventDefault();
			}
		}
	};
	
	jQuery.removeEvent = function( elem, type, handle ) {
		if ( elem.removeEventListener ) {
			elem.removeEventListener( type, handle, false );
		}
	};
	
	jQuery.Event = function( src, props ) {
		// Allow instantiation without the 'new' keyword
		if ( !(this instanceof jQuery.Event) ) {
			return new jQuery.Event( src, props );
		}
	
		// Event object
		if ( src && src.type ) {
			this.originalEvent = src;
			this.type = src.type;
	
			// Events bubbling up the document may have been marked as prevented
			// by a handler lower down the tree; reflect the correct value.
			this.isDefaultPrevented = src.defaultPrevented ||
					src.defaultPrevented === undefined &&
					// Support: Android<4.0
					src.returnValue === false ?
				returnTrue :
				returnFalse;
	
		// Event type
		} else {
			this.type = src;
		}
	
		// Put explicitly provided properties onto the event object
		if ( props ) {
			jQuery.extend( this, props );
		}
	
		// Create a timestamp if incoming event doesn't have one
		this.timeStamp = src && src.timeStamp || jQuery.now();
	
		// Mark it as fixed
		this[ jQuery.expando ] = true;
	};
	
	// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
	// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
	jQuery.Event.prototype = {
		isDefaultPrevented: returnFalse,
		isPropagationStopped: returnFalse,
		isImmediatePropagationStopped: returnFalse,
	
		preventDefault: function() {
			var e = this.originalEvent;
	
			this.isDefaultPrevented = returnTrue;
	
			if ( e && e.preventDefault ) {
				e.preventDefault();
			}
		},
		stopPropagation: function() {
			var e = this.originalEvent;
	
			this.isPropagationStopped = returnTrue;
	
			if ( e && e.stopPropagation ) {
				e.stopPropagation();
			}
		},
		stopImmediatePropagation: function() {
			var e = this.originalEvent;
	
			this.isImmediatePropagationStopped = returnTrue;
	
			if ( e && e.stopImmediatePropagation ) {
				e.stopImmediatePropagation();
			}
	
			this.stopPropagation();
		}
	};
	
	// Create mouseenter/leave events using mouseover/out and event-time checks
	// Support: Chrome 15+
	jQuery.each({
		mouseenter: "mouseover",
		mouseleave: "mouseout",
		pointerenter: "pointerover",
		pointerleave: "pointerout"
	}, function( orig, fix ) {
		jQuery.event.special[ orig ] = {
			delegateType: fix,
			bindType: fix,
	
			handle: function( event ) {
				var ret,
					target = this,
					related = event.relatedTarget,
					handleObj = event.handleObj;
	
				// For mousenter/leave call the handler if related is outside the target.
				// NB: No relatedTarget if the mouse left/entered the browser window
				if ( !related || (related !== target && !jQuery.contains( target, related )) ) {
					event.type = handleObj.origType;
					ret = handleObj.handler.apply( this, arguments );
					event.type = fix;
				}
				return ret;
			}
		};
	});
	
	// Support: Firefox, Chrome, Safari
	// Create "bubbling" focus and blur events
	if ( !support.focusinBubbles ) {
		jQuery.each({ focus: "focusin", blur: "focusout" }, function( orig, fix ) {
	
			// Attach a single capturing handler on the document while someone wants focusin/focusout
			var handler = function( event ) {
					jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );
				};
	
			jQuery.event.special[ fix ] = {
				setup: function() {
					var doc = this.ownerDocument || this,
						attaches = data_priv.access( doc, fix );
	
					if ( !attaches ) {
						doc.addEventListener( orig, handler, true );
					}
					data_priv.access( doc, fix, ( attaches || 0 ) + 1 );
				},
				teardown: function() {
					var doc = this.ownerDocument || this,
						attaches = data_priv.access( doc, fix ) - 1;
	
					if ( !attaches ) {
						doc.removeEventListener( orig, handler, true );
						data_priv.remove( doc, fix );
	
					} else {
						data_priv.access( doc, fix, attaches );
					}
				}
			};
		});
	}
	
	jQuery.fn.extend({
	
		on: function( types, selector, data, fn, /*INTERNAL*/ one ) {
			var origFn, type;
	
			// Types can be a map of types/handlers
			if ( typeof types === "object" ) {
				// ( types-Object, selector, data )
				if ( typeof selector !== "string" ) {
					// ( types-Object, data )
					data = data || selector;
					selector = undefined;
				}
				for ( type in types ) {
					this.on( type, selector, data, types[ type ], one );
				}
				return this;
			}
	
			if ( data == null && fn == null ) {
				// ( types, fn )
				fn = selector;
				data = selector = undefined;
			} else if ( fn == null ) {
				if ( typeof selector === "string" ) {
					// ( types, selector, fn )
					fn = data;
					data = undefined;
				} else {
					// ( types, data, fn )
					fn = data;
					data = selector;
					selector = undefined;
				}
			}
			if ( fn === false ) {
				fn = returnFalse;
			} else if ( !fn ) {
				return this;
			}
	
			if ( one === 1 ) {
				origFn = fn;
				fn = function( event ) {
					// Can use an empty set, since event contains the info
					jQuery().off( event );
					return origFn.apply( this, arguments );
				};
				// Use same guid so caller can remove using origFn
				fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
			}
			return this.each( function() {
				jQuery.event.add( this, types, fn, data, selector );
			});
		},
		one: function( types, selector, data, fn ) {
			return this.on( types, selector, data, fn, 1 );
		},
		off: function( types, selector, fn ) {
			var handleObj, type;
			if ( types && types.preventDefault && types.handleObj ) {
				// ( event )  dispatched jQuery.Event
				handleObj = types.handleObj;
				jQuery( types.delegateTarget ).off(
					handleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType,
					handleObj.selector,
					handleObj.handler
				);
				return this;
			}
			if ( typeof types === "object" ) {
				// ( types-object [, selector] )
				for ( type in types ) {
					this.off( type, selector, types[ type ] );
				}
				return this;
			}
			if ( selector === false || typeof selector === "function" ) {
				// ( types [, fn] )
				fn = selector;
				selector = undefined;
			}
			if ( fn === false ) {
				fn = returnFalse;
			}
			return this.each(function() {
				jQuery.event.remove( this, types, fn, selector );
			});
		},
	
		trigger: function( type, data ) {
			return this.each(function() {
				jQuery.event.trigger( type, data, this );
			});
		},
		triggerHandler: function( type, data ) {
			var elem = this[0];
			if ( elem ) {
				return jQuery.event.trigger( type, data, elem, true );
			}
		}
	});
	
	
	var
		rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
		rtagName = /<([\w:]+)/,
		rhtml = /<|&#?\w+;/,
		rnoInnerhtml = /<(?:script|style|link)/i,
		// checked="checked" or checked
		rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
		rscriptType = /^$|\/(?:java|ecma)script/i,
		rscriptTypeMasked = /^true\/(.*)/,
		rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
	
		// We have to close these tags to support XHTML (#13200)
		wrapMap = {
	
			// Support: IE9
			option: [ 1, "<select multiple='multiple'>", "</select>" ],
	
			thead: [ 1, "<table>", "</table>" ],
			col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
			tr: [ 2, "<table><tbody>", "</tbody></table>" ],
			td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],
	
			_default: [ 0, "", "" ]
		};
	
	// Support: IE9
	wrapMap.optgroup = wrapMap.option;
	
	wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
	wrapMap.th = wrapMap.td;
	
	// Support: 1.x compatibility
	// Manipulating tables requires a tbody
	function manipulationTarget( elem, content ) {
		return jQuery.nodeName( elem, "table" ) &&
			jQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ?
	
			elem.getElementsByTagName("tbody")[0] ||
				elem.appendChild( elem.ownerDocument.createElement("tbody") ) :
			elem;
	}
	
	// Replace/restore the type attribute of script elements for safe DOM manipulation
	function disableScript( elem ) {
		elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;
		return elem;
	}
	function restoreScript( elem ) {
		var match = rscriptTypeMasked.exec( elem.type );
	
		if ( match ) {
			elem.type = match[ 1 ];
		} else {
			elem.removeAttribute("type");
		}
	
		return elem;
	}
	
	// Mark scripts as having already been evaluated
	function setGlobalEval( elems, refElements ) {
		var i = 0,
			l = elems.length;
	
		for ( ; i < l; i++ ) {
			data_priv.set(
				elems[ i ], "globalEval", !refElements || data_priv.get( refElements[ i ], "globalEval" )
			);
		}
	}
	
	function cloneCopyEvent( src, dest ) {
		var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;
	
		if ( dest.nodeType !== 1 ) {
			return;
		}
	
		// 1. Copy private data: events, handlers, etc.
		if ( data_priv.hasData( src ) ) {
			pdataOld = data_priv.access( src );
			pdataCur = data_priv.set( dest, pdataOld );
			events = pdataOld.events;
	
			if ( events ) {
				delete pdataCur.handle;
				pdataCur.events = {};
	
				for ( type in events ) {
					for ( i = 0, l = events[ type ].length; i < l; i++ ) {
						jQuery.event.add( dest, type, events[ type ][ i ] );
					}
				}
			}
		}
	
		// 2. Copy user data
		if ( data_user.hasData( src ) ) {
			udataOld = data_user.access( src );
			udataCur = jQuery.extend( {}, udataOld );
	
			data_user.set( dest, udataCur );
		}
	}
	
	function getAll( context, tag ) {
		var ret = context.getElementsByTagName ? context.getElementsByTagName( tag || "*" ) :
				context.querySelectorAll ? context.querySelectorAll( tag || "*" ) :
				[];
	
		return tag === undefined || tag && jQuery.nodeName( context, tag ) ?
			jQuery.merge( [ context ], ret ) :
			ret;
	}
	
	// Fix IE bugs, see support tests
	function fixInput( src, dest ) {
		var nodeName = dest.nodeName.toLowerCase();
	
		// Fails to persist the checked state of a cloned checkbox or radio button.
		if ( nodeName === "input" && rcheckableType.test( src.type ) ) {
			dest.checked = src.checked;
	
		// Fails to return the selected option to the default selected state when cloning options
		} else if ( nodeName === "input" || nodeName === "textarea" ) {
			dest.defaultValue = src.defaultValue;
		}
	}
	
	jQuery.extend({
		clone: function( elem, dataAndEvents, deepDataAndEvents ) {
			var i, l, srcElements, destElements,
				clone = elem.cloneNode( true ),
				inPage = jQuery.contains( elem.ownerDocument, elem );
	
			// Fix IE cloning issues
			if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&
					!jQuery.isXMLDoc( elem ) ) {
	
				// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2
				destElements = getAll( clone );
				srcElements = getAll( elem );
	
				for ( i = 0, l = srcElements.length; i < l; i++ ) {
					fixInput( srcElements[ i ], destElements[ i ] );
				}
			}
	
			// Copy the events from the original to the clone
			if ( dataAndEvents ) {
				if ( deepDataAndEvents ) {
					srcElements = srcElements || getAll( elem );
					destElements = destElements || getAll( clone );
	
					for ( i = 0, l = srcElements.length; i < l; i++ ) {
						cloneCopyEvent( srcElements[ i ], destElements[ i ] );
					}
				} else {
					cloneCopyEvent( elem, clone );
				}
			}
	
			// Preserve script evaluation history
			destElements = getAll( clone, "script" );
			if ( destElements.length > 0 ) {
				setGlobalEval( destElements, !inPage && getAll( elem, "script" ) );
			}
	
			// Return the cloned set
			return clone;
		},
	
		buildFragment: function( elems, context, scripts, selection ) {
			var elem, tmp, tag, wrap, contains, j,
				fragment = context.createDocumentFragment(),
				nodes = [],
				i = 0,
				l = elems.length;
	
			for ( ; i < l; i++ ) {
				elem = elems[ i ];
	
				if ( elem || elem === 0 ) {
	
					// Add nodes directly
					if ( jQuery.type( elem ) === "object" ) {
						// Support: QtWebKit, PhantomJS
						// push.apply(_, arraylike) throws on ancient WebKit
						jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );
	
					// Convert non-html into a text node
					} else if ( !rhtml.test( elem ) ) {
						nodes.push( context.createTextNode( elem ) );
	
					// Convert html into DOM nodes
					} else {
						tmp = tmp || fragment.appendChild( context.createElement("div") );
	
						// Deserialize a standard representation
						tag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();
						wrap = wrapMap[ tag ] || wrapMap._default;
						tmp.innerHTML = wrap[ 1 ] + elem.replace( rxhtmlTag, "<$1></$2>" ) + wrap[ 2 ];
	
						// Descend through wrappers to the right content
						j = wrap[ 0 ];
						while ( j-- ) {
							tmp = tmp.lastChild;
						}
	
						// Support: QtWebKit, PhantomJS
						// push.apply(_, arraylike) throws on ancient WebKit
						jQuery.merge( nodes, tmp.childNodes );
	
						// Remember the top-level container
						tmp = fragment.firstChild;
	
						// Ensure the created nodes are orphaned (#12392)
						tmp.textContent = "";
					}
				}
			}
	
			// Remove wrapper from fragment
			fragment.textContent = "";
	
			i = 0;
			while ( (elem = nodes[ i++ ]) ) {
	
				// #4087 - If origin and destination elements are the same, and this is
				// that element, do not do anything
				if ( selection && jQuery.inArray( elem, selection ) !== -1 ) {
					continue;
				}
	
				contains = jQuery.contains( elem.ownerDocument, elem );
	
				// Append to fragment
				tmp = getAll( fragment.appendChild( elem ), "script" );
	
				// Preserve script evaluation history
				if ( contains ) {
					setGlobalEval( tmp );
				}
	
				// Capture executables
				if ( scripts ) {
					j = 0;
					while ( (elem = tmp[ j++ ]) ) {
						if ( rscriptType.test( elem.type || "" ) ) {
							scripts.push( elem );
						}
					}
				}
			}
	
			return fragment;
		},
	
		cleanData: function( elems ) {
			var data, elem, type, key,
				special = jQuery.event.special,
				i = 0;
	
			for ( ; (elem = elems[ i ]) !== undefined; i++ ) {
				if ( jQuery.acceptData( elem ) ) {
					key = elem[ data_priv.expando ];
	
					if ( key && (data = data_priv.cache[ key ]) ) {
						if ( data.events ) {
							for ( type in data.events ) {
								if ( special[ type ] ) {
									jQuery.event.remove( elem, type );
	
								// This is a shortcut to avoid jQuery.event.remove's overhead
								} else {
									jQuery.removeEvent( elem, type, data.handle );
								}
							}
						}
						if ( data_priv.cache[ key ] ) {
							// Discard any remaining `private` data
							delete data_priv.cache[ key ];
						}
					}
				}
				// Discard any remaining `user` data
				delete data_user.cache[ elem[ data_user.expando ] ];
			}
		}
	});
	
	jQuery.fn.extend({
		text: function( value ) {
			return access( this, function( value ) {
				return value === undefined ?
					jQuery.text( this ) :
					this.empty().each(function() {
						if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
							this.textContent = value;
						}
					});
			}, null, value, arguments.length );
		},
	
		append: function() {
			return this.domManip( arguments, function( elem ) {
				if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
					var target = manipulationTarget( this, elem );
					target.appendChild( elem );
				}
			});
		},
	
		prepend: function() {
			return this.domManip( arguments, function( elem ) {
				if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
					var target = manipulationTarget( this, elem );
					target.insertBefore( elem, target.firstChild );
				}
			});
		},
	
		before: function() {
			return this.domManip( arguments, function( elem ) {
				if ( this.parentNode ) {
					this.parentNode.insertBefore( elem, this );
				}
			});
		},
	
		after: function() {
			return this.domManip( arguments, function( elem ) {
				if ( this.parentNode ) {
					this.parentNode.insertBefore( elem, this.nextSibling );
				}
			});
		},
	
		remove: function( selector, keepData /* Internal Use Only */ ) {
			var elem,
				elems = selector ? jQuery.filter( selector, this ) : this,
				i = 0;
	
			for ( ; (elem = elems[i]) != null; i++ ) {
				if ( !keepData && elem.nodeType === 1 ) {
					jQuery.cleanData( getAll( elem ) );
				}
	
				if ( elem.parentNode ) {
					if ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {
						setGlobalEval( getAll( elem, "script" ) );
					}
					elem.parentNode.removeChild( elem );
				}
			}
	
			return this;
		},
	
		empty: function() {
			var elem,
				i = 0;
	
			for ( ; (elem = this[i]) != null; i++ ) {
				if ( elem.nodeType === 1 ) {
	
					// Prevent memory leaks
					jQuery.cleanData( getAll( elem, false ) );
	
					// Remove any remaining nodes
					elem.textContent = "";
				}
			}
	
			return this;
		},
	
		clone: function( dataAndEvents, deepDataAndEvents ) {
			dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
			deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;
	
			return this.map(function() {
				return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
			});
		},
	
		html: function( value ) {
			return access( this, function( value ) {
				var elem = this[ 0 ] || {},
					i = 0,
					l = this.length;
	
				if ( value === undefined && elem.nodeType === 1 ) {
					return elem.innerHTML;
				}
	
				// See if we can take a shortcut and just use innerHTML
				if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
					!wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {
	
					value = value.replace( rxhtmlTag, "<$1></$2>" );
	
					try {
						for ( ; i < l; i++ ) {
							elem = this[ i ] || {};
	
							// Remove element nodes and prevent memory leaks
							if ( elem.nodeType === 1 ) {
								jQuery.cleanData( getAll( elem, false ) );
								elem.innerHTML = value;
							}
						}
	
						elem = 0;
	
					// If using innerHTML throws an exception, use the fallback method
					} catch( e ) {}
				}
	
				if ( elem ) {
					this.empty().append( value );
				}
			}, null, value, arguments.length );
		},
	
		replaceWith: function() {
			var arg = arguments[ 0 ];
	
			// Make the changes, replacing each context element with the new content
			this.domManip( arguments, function( elem ) {
				arg = this.parentNode;
	
				jQuery.cleanData( getAll( this ) );
	
				if ( arg ) {
					arg.replaceChild( elem, this );
				}
			});
	
			// Force removal if there was no new content (e.g., from empty arguments)
			return arg && (arg.length || arg.nodeType) ? this : this.remove();
		},
	
		detach: function( selector ) {
			return this.remove( selector, true );
		},
	
		domManip: function( args, callback ) {
	
			// Flatten any nested arrays
			args = concat.apply( [], args );
	
			var fragment, first, scripts, hasScripts, node, doc,
				i = 0,
				l = this.length,
				set = this,
				iNoClone = l - 1,
				value = args[ 0 ],
				isFunction = jQuery.isFunction( value );
	
			// We can't cloneNode fragments that contain checked, in WebKit
			if ( isFunction ||
					( l > 1 && typeof value === "string" &&
						!support.checkClone && rchecked.test( value ) ) ) {
				return this.each(function( index ) {
					var self = set.eq( index );
					if ( isFunction ) {
						args[ 0 ] = value.call( this, index, self.html() );
					}
					self.domManip( args, callback );
				});
			}
	
			if ( l ) {
				fragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, this );
				first = fragment.firstChild;
	
				if ( fragment.childNodes.length === 1 ) {
					fragment = first;
				}
	
				if ( first ) {
					scripts = jQuery.map( getAll( fragment, "script" ), disableScript );
					hasScripts = scripts.length;
	
					// Use the original fragment for the last item instead of the first because it can end up
					// being emptied incorrectly in certain situations (#8070).
					for ( ; i < l; i++ ) {
						node = fragment;
	
						if ( i !== iNoClone ) {
							node = jQuery.clone( node, true, true );
	
							// Keep references to cloned scripts for later restoration
							if ( hasScripts ) {
								// Support: QtWebKit
								// jQuery.merge because push.apply(_, arraylike) throws
								jQuery.merge( scripts, getAll( node, "script" ) );
							}
						}
	
						callback.call( this[ i ], node, i );
					}
	
					if ( hasScripts ) {
						doc = scripts[ scripts.length - 1 ].ownerDocument;
	
						// Reenable scripts
						jQuery.map( scripts, restoreScript );
	
						// Evaluate executable scripts on first document insertion
						for ( i = 0; i < hasScripts; i++ ) {
							node = scripts[ i ];
							if ( rscriptType.test( node.type || "" ) &&
								!data_priv.access( node, "globalEval" ) && jQuery.contains( doc, node ) ) {
	
								if ( node.src ) {
									// Optional AJAX dependency, but won't run scripts if not present
									if ( jQuery._evalUrl ) {
										jQuery._evalUrl( node.src );
									}
								} else {
									jQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );
								}
							}
						}
					}
				}
			}
	
			return this;
		}
	});
	
	jQuery.each({
		appendTo: "append",
		prependTo: "prepend",
		insertBefore: "before",
		insertAfter: "after",
		replaceAll: "replaceWith"
	}, function( name, original ) {
		jQuery.fn[ name ] = function( selector ) {
			var elems,
				ret = [],
				insert = jQuery( selector ),
				last = insert.length - 1,
				i = 0;
	
			for ( ; i <= last; i++ ) {
				elems = i === last ? this : this.clone( true );
				jQuery( insert[ i ] )[ original ]( elems );
	
				// Support: QtWebKit
				// .get() because push.apply(_, arraylike) throws
				push.apply( ret, elems.get() );
			}
	
			return this.pushStack( ret );
		};
	});
	
	
	var iframe,
		elemdisplay = {};
	
	/**
	 * Retrieve the actual display of a element
	 * @param {String} name nodeName of the element
	 * @param {Object} doc Document object
	 */
	// Called only from within defaultDisplay
	function actualDisplay( name, doc ) {
		var style,
			elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),
	
			// getDefaultComputedStyle might be reliably used only on attached element
			display = window.getDefaultComputedStyle && ( style = window.getDefaultComputedStyle( elem[ 0 ] ) ) ?
	
				// Use of this method is a temporary fix (more like optimization) until something better comes along,
				// since it was removed from specification and supported only in FF
				style.display : jQuery.css( elem[ 0 ], "display" );
	
		// We don't have any data stored on the element,
		// so use "detach" method as fast way to get rid of the element
		elem.detach();
	
		return display;
	}
	
	/**
	 * Try to determine the default display value of an element
	 * @param {String} nodeName
	 */
	function defaultDisplay( nodeName ) {
		var doc = document,
			display = elemdisplay[ nodeName ];
	
		if ( !display ) {
			display = actualDisplay( nodeName, doc );
	
			// If the simple way fails, read from inside an iframe
			if ( display === "none" || !display ) {
	
				// Use the already-created iframe if possible
				iframe = (iframe || jQuery( "<iframe frameborder='0' width='0' height='0'/>" )).appendTo( doc.documentElement );
	
				// Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse
				doc = iframe[ 0 ].contentDocument;
	
				// Support: IE
				doc.write();
				doc.close();
	
				display = actualDisplay( nodeName, doc );
				iframe.detach();
			}
	
			// Store the correct default display
			elemdisplay[ nodeName ] = display;
		}
	
		return display;
	}
	var rmargin = (/^margin/);
	
	var rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );
	
	var getStyles = function( elem ) {
			// Support: IE<=11+, Firefox<=30+ (#15098, #14150)
			// IE throws on elements created in popups
			// FF meanwhile throws on frame elements through "defaultView.getComputedStyle"
			if ( elem.ownerDocument.defaultView.opener ) {
				return elem.ownerDocument.defaultView.getComputedStyle( elem, null );
			}
	
			return window.getComputedStyle( elem, null );
		};
	
	
	
	function curCSS( elem, name, computed ) {
		var width, minWidth, maxWidth, ret,
			style = elem.style;
	
		computed = computed || getStyles( elem );
	
		// Support: IE9
		// getPropertyValue is only needed for .css('filter') (#12537)
		if ( computed ) {
			ret = computed.getPropertyValue( name ) || computed[ name ];
		}
	
		if ( computed ) {
	
			if ( ret === "" && !jQuery.contains( elem.ownerDocument, elem ) ) {
				ret = jQuery.style( elem, name );
			}
	
			// Support: iOS < 6
			// A tribute to the "awesome hack by Dean Edwards"
			// iOS < 6 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels
			// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values
			if ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {
	
				// Remember the original values
				width = style.width;
				minWidth = style.minWidth;
				maxWidth = style.maxWidth;
	
				// Put in the new values to get a computed value out
				style.minWidth = style.maxWidth = style.width = ret;
				ret = computed.width;
	
				// Revert the changed values
				style.width = width;
				style.minWidth = minWidth;
				style.maxWidth = maxWidth;
			}
		}
	
		return ret !== undefined ?
			// Support: IE
			// IE returns zIndex value as an integer.
			ret + "" :
			ret;
	}
	
	
	function addGetHookIf( conditionFn, hookFn ) {
		// Define the hook, we'll check on the first run if it's really needed.
		return {
			get: function() {
				if ( conditionFn() ) {
					// Hook not needed (or it's not possible to use it due
					// to missing dependency), remove it.
					delete this.get;
					return;
				}
	
				// Hook needed; redefine it so that the support test is not executed again.
				return (this.get = hookFn).apply( this, arguments );
			}
		};
	}
	
	
	(function() {
		var pixelPositionVal, boxSizingReliableVal,
			docElem = document.documentElement,
			container = document.createElement( "div" ),
			div = document.createElement( "div" );
	
		if ( !div.style ) {
			return;
		}
	
		// Support: IE9-11+
		// Style of cloned element affects source element cloned (#8908)
		div.style.backgroundClip = "content-box";
		div.cloneNode( true ).style.backgroundClip = "";
		support.clearCloneStyle = div.style.backgroundClip === "content-box";
	
		container.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;" +
			"position:absolute";
		container.appendChild( div );
	
		// Executing both pixelPosition & boxSizingReliable tests require only one layout
		// so they're executed at the same time to save the second computation.
		function computePixelPositionAndBoxSizingReliable() {
			div.style.cssText =
				// Support: Firefox<29, Android 2.3
				// Vendor-prefix box-sizing
				"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;" +
				"box-sizing:border-box;display:block;margin-top:1%;top:1%;" +
				"border:1px;padding:1px;width:4px;position:absolute";
			div.innerHTML = "";
			docElem.appendChild( container );
	
			var divStyle = window.getComputedStyle( div, null );
			pixelPositionVal = divStyle.top !== "1%";
			boxSizingReliableVal = divStyle.width === "4px";
	
			docElem.removeChild( container );
		}
	
		// Support: node.js jsdom
		// Don't assume that getComputedStyle is a property of the global object
		if ( window.getComputedStyle ) {
			jQuery.extend( support, {
				pixelPosition: function() {
	
					// This test is executed only once but we still do memoizing
					// since we can use the boxSizingReliable pre-computing.
					// No need to check if the test was already performed, though.
					computePixelPositionAndBoxSizingReliable();
					return pixelPositionVal;
				},
				boxSizingReliable: function() {
					if ( boxSizingReliableVal == null ) {
						computePixelPositionAndBoxSizingReliable();
					}
					return boxSizingReliableVal;
				},
				reliableMarginRight: function() {
	
					// Support: Android 2.3
					// Check if div with explicit width and no margin-right incorrectly
					// gets computed margin-right based on width of container. (#3333)
					// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right
					// This support function is only executed once so no memoizing is needed.
					var ret,
						marginDiv = div.appendChild( document.createElement( "div" ) );
	
					// Reset CSS: box-sizing; display; margin; border; padding
					marginDiv.style.cssText = div.style.cssText =
						// Support: Firefox<29, Android 2.3
						// Vendor-prefix box-sizing
						"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;" +
						"box-sizing:content-box;display:block;margin:0;border:0;padding:0";
					marginDiv.style.marginRight = marginDiv.style.width = "0";
					div.style.width = "1px";
					docElem.appendChild( container );
	
					ret = !parseFloat( window.getComputedStyle( marginDiv, null ).marginRight );
	
					docElem.removeChild( container );
					div.removeChild( marginDiv );
	
					return ret;
				}
			});
		}
	})();
	
	
	// A method for quickly swapping in/out CSS properties to get correct calculations.
	jQuery.swap = function( elem, options, callback, args ) {
		var ret, name,
			old = {};
	
		// Remember the old values, and insert the new ones
		for ( name in options ) {
			old[ name ] = elem.style[ name ];
			elem.style[ name ] = options[ name ];
		}
	
		ret = callback.apply( elem, args || [] );
	
		// Revert the old values
		for ( name in options ) {
			elem.style[ name ] = old[ name ];
		}
	
		return ret;
	};
	
	
	var
		// Swappable if display is none or starts with table except "table", "table-cell", or "table-caption"
		// See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display
		rdisplayswap = /^(none|table(?!-c[ea]).+)/,
		rnumsplit = new RegExp( "^(" + pnum + ")(.*)$", "i" ),
		rrelNum = new RegExp( "^([+-])=(" + pnum + ")", "i" ),
	
		cssShow = { position: "absolute", visibility: "hidden", display: "block" },
		cssNormalTransform = {
			letterSpacing: "0",
			fontWeight: "400"
		},
	
		cssPrefixes = [ "Webkit", "O", "Moz", "ms" ];
	
	// Return a css property mapped to a potentially vendor prefixed property
	function vendorPropName( style, name ) {
	
		// Shortcut for names that are not vendor prefixed
		if ( name in style ) {
			return name;
		}
	
		// Check for vendor prefixed names
		var capName = name[0].toUpperCase() + name.slice(1),
			origName = name,
			i = cssPrefixes.length;
	
		while ( i-- ) {
			name = cssPrefixes[ i ] + capName;
			if ( name in style ) {
				return name;
			}
		}
	
		return origName;
	}
	
	function setPositiveNumber( elem, value, subtract ) {
		var matches = rnumsplit.exec( value );
		return matches ?
			// Guard against undefined "subtract", e.g., when used as in cssHooks
			Math.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || "px" ) :
			value;
	}
	
	function augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {
		var i = extra === ( isBorderBox ? "border" : "content" ) ?
			// If we already have the right measurement, avoid augmentation
			4 :
			// Otherwise initialize for horizontal or vertical properties
			name === "width" ? 1 : 0,
	
			val = 0;
	
		for ( ; i < 4; i += 2 ) {
			// Both box models exclude margin, so add it if we want it
			if ( extra === "margin" ) {
				val += jQuery.css( elem, extra + cssExpand[ i ], true, styles );
			}
	
			if ( isBorderBox ) {
				// border-box includes padding, so remove it if we want content
				if ( extra === "content" ) {
					val -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
				}
	
				// At this point, extra isn't border nor margin, so remove border
				if ( extra !== "margin" ) {
					val -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
				}
			} else {
				// At this point, extra isn't content, so add padding
				val += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
	
				// At this point, extra isn't content nor padding, so add border
				if ( extra !== "padding" ) {
					val += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
				}
			}
		}
	
		return val;
	}
	
	function getWidthOrHeight( elem, name, extra ) {
	
		// Start with offset property, which is equivalent to the border-box value
		var valueIsBorderBox = true,
			val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
			styles = getStyles( elem ),
			isBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";
	
		// Some non-html elements return undefined for offsetWidth, so check for null/undefined
		// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285
		// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668
		if ( val <= 0 || val == null ) {
			// Fall back to computed then uncomputed css if necessary
			val = curCSS( elem, name, styles );
			if ( val < 0 || val == null ) {
				val = elem.style[ name ];
			}
	
			// Computed unit is not pixels. Stop here and return.
			if ( rnumnonpx.test(val) ) {
				return val;
			}
	
			// Check for style in case a browser which returns unreliable values
			// for getComputedStyle silently falls back to the reliable elem.style
			valueIsBorderBox = isBorderBox &&
				( support.boxSizingReliable() || val === elem.style[ name ] );
	
			// Normalize "", auto, and prepare for extra
			val = parseFloat( val ) || 0;
		}
	
		// Use the active box-sizing model to add/subtract irrelevant styles
		return ( val +
			augmentWidthOrHeight(
				elem,
				name,
				extra || ( isBorderBox ? "border" : "content" ),
				valueIsBorderBox,
				styles
			)
		) + "px";
	}
	
	function showHide( elements, show ) {
		var display, elem, hidden,
			values = [],
			index = 0,
			length = elements.length;
	
		for ( ; index < length; index++ ) {
			elem = elements[ index ];
			if ( !elem.style ) {
				continue;
			}
	
			values[ index ] = data_priv.get( elem, "olddisplay" );
			display = elem.style.display;
			if ( show ) {
				// Reset the inline display of this element to learn if it is
				// being hidden by cascaded rules or not
				if ( !values[ index ] && display === "none" ) {
					elem.style.display = "";
				}
	
				// Set elements which have been overridden with display: none
				// in a stylesheet to whatever the default browser style is
				// for such an element
				if ( elem.style.display === "" && isHidden( elem ) ) {
					values[ index ] = data_priv.access( elem, "olddisplay", defaultDisplay(elem.nodeName) );
				}
			} else {
				hidden = isHidden( elem );
	
				if ( display !== "none" || !hidden ) {
					data_priv.set( elem, "olddisplay", hidden ? display : jQuery.css( elem, "display" ) );
				}
			}
		}
	
		// Set the display of most of the elements in a second loop
		// to avoid the constant reflow
		for ( index = 0; index < length; index++ ) {
			elem = elements[ index ];
			if ( !elem.style ) {
				continue;
			}
			if ( !show || elem.style.display === "none" || elem.style.display === "" ) {
				elem.style.display = show ? values[ index ] || "" : "none";
			}
		}
	
		return elements;
	}
	
	jQuery.extend({
	
		// Add in style property hooks for overriding the default
		// behavior of getting and setting a style property
		cssHooks: {
			opacity: {
				get: function( elem, computed ) {
					if ( computed ) {
	
						// We should always get a number back from opacity
						var ret = curCSS( elem, "opacity" );
						return ret === "" ? "1" : ret;
					}
				}
			}
		},
	
		// Don't automatically add "px" to these possibly-unitless properties
		cssNumber: {
			"columnCount": true,
			"fillOpacity": true,
			"flexGrow": true,
			"flexShrink": true,
			"fontWeight": true,
			"lineHeight": true,
			"opacity": true,
			"order": true,
			"orphans": true,
			"widows": true,
			"zIndex": true,
			"zoom": true
		},
	
		// Add in properties whose names you wish to fix before
		// setting or getting the value
		cssProps: {
			"float": "cssFloat"
		},
	
		// Get and set the style property on a DOM Node
		style: function( elem, name, value, extra ) {
	
			// Don't set styles on text and comment nodes
			if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {
				return;
			}
	
			// Make sure that we're working with the right name
			var ret, type, hooks,
				origName = jQuery.camelCase( name ),
				style = elem.style;
	
			name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );
	
			// Gets hook for the prefixed version, then unprefixed version
			hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];
	
			// Check if we're setting a value
			if ( value !== undefined ) {
				type = typeof value;
	
				// Convert "+=" or "-=" to relative numbers (#7345)
				if ( type === "string" && (ret = rrelNum.exec( value )) ) {
					value = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );
					// Fixes bug #9237
					type = "number";
				}
	
				// Make sure that null and NaN values aren't set (#7116)
				if ( value == null || value !== value ) {
					return;
				}
	
				// If a number, add 'px' to the (except for certain CSS properties)
				if ( type === "number" && !jQuery.cssNumber[ origName ] ) {
					value += "px";
				}
	
				// Support: IE9-11+
				// background-* props affect original clone's values
				if ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {
					style[ name ] = "inherit";
				}
	
				// If a hook was provided, use that value, otherwise just set the specified value
				if ( !hooks || !("set" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {
					style[ name ] = value;
				}
	
			} else {
				// If a hook was provided get the non-computed value from there
				if ( hooks && "get" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {
					return ret;
				}
	
				// Otherwise just get the value from the style object
				return style[ name ];
			}
		},
	
		css: function( elem, name, extra, styles ) {
			var val, num, hooks,
				origName = jQuery.camelCase( name );
	
			// Make sure that we're working with the right name
			name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );
	
			// Try prefixed name followed by the unprefixed name
			hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];
	
			// If a hook was provided get the computed value from there
			if ( hooks && "get" in hooks ) {
				val = hooks.get( elem, true, extra );
			}
	
			// Otherwise, if a way to get the computed value exists, use that
			if ( val === undefined ) {
				val = curCSS( elem, name, styles );
			}
	
			// Convert "normal" to computed value
			if ( val === "normal" && name in cssNormalTransform ) {
				val = cssNormalTransform[ name ];
			}
	
			// Make numeric if forced or a qualifier was provided and val looks numeric
			if ( extra === "" || extra ) {
				num = parseFloat( val );
				return extra === true || jQuery.isNumeric( num ) ? num || 0 : val;
			}
			return val;
		}
	});
	
	jQuery.each([ "height", "width" ], function( i, name ) {
		jQuery.cssHooks[ name ] = {
			get: function( elem, computed, extra ) {
				if ( computed ) {
	
					// Certain elements can have dimension info if we invisibly show them
					// but it must have a current display style that would benefit
					return rdisplayswap.test( jQuery.css( elem, "display" ) ) && elem.offsetWidth === 0 ?
						jQuery.swap( elem, cssShow, function() {
							return getWidthOrHeight( elem, name, extra );
						}) :
						getWidthOrHeight( elem, name, extra );
				}
			},
	
			set: function( elem, value, extra ) {
				var styles = extra && getStyles( elem );
				return setPositiveNumber( elem, value, extra ?
					augmentWidthOrHeight(
						elem,
						name,
						extra,
						jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
						styles
					) : 0
				);
			}
		};
	});
	
	// Support: Android 2.3
	jQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,
		function( elem, computed ) {
			if ( computed ) {
				return jQuery.swap( elem, { "display": "inline-block" },
					curCSS, [ elem, "marginRight" ] );
			}
		}
	);
	
	// These hooks are used by animate to expand properties
	jQuery.each({
		margin: "",
		padding: "",
		border: "Width"
	}, function( prefix, suffix ) {
		jQuery.cssHooks[ prefix + suffix ] = {
			expand: function( value ) {
				var i = 0,
					expanded = {},
	
					// Assumes a single number if not a string
					parts = typeof value === "string" ? value.split(" ") : [ value ];
	
				for ( ; i < 4; i++ ) {
					expanded[ prefix + cssExpand[ i ] + suffix ] =
						parts[ i ] || parts[ i - 2 ] || parts[ 0 ];
				}
	
				return expanded;
			}
		};
	
		if ( !rmargin.test( prefix ) ) {
			jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;
		}
	});
	
	jQuery.fn.extend({
		css: function( name, value ) {
			return access( this, function( elem, name, value ) {
				var styles, len,
					map = {},
					i = 0;
	
				if ( jQuery.isArray( name ) ) {
					styles = getStyles( elem );
					len = name.length;
	
					for ( ; i < len; i++ ) {
						map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );
					}
	
					return map;
				}
	
				return value !== undefined ?
					jQuery.style( elem, name, value ) :
					jQuery.css( elem, name );
			}, name, value, arguments.length > 1 );
		},
		show: function() {
			return showHide( this, true );
		},
		hide: function() {
			return showHide( this );
		},
		toggle: function( state ) {
			if ( typeof state === "boolean" ) {
				return state ? this.show() : this.hide();
			}
	
			return this.each(function() {
				if ( isHidden( this ) ) {
					jQuery( this ).show();
				} else {
					jQuery( this ).hide();
				}
			});
		}
	});
	
	
	function Tween( elem, options, prop, end, easing ) {
		return new Tween.prototype.init( elem, options, prop, end, easing );
	}
	jQuery.Tween = Tween;
	
	Tween.prototype = {
		constructor: Tween,
		init: function( elem, options, prop, end, easing, unit ) {
			this.elem = elem;
			this.prop = prop;
			this.easing = easing || "swing";
			this.options = options;
			this.start = this.now = this.cur();
			this.end = end;
			this.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );
		},
		cur: function() {
			var hooks = Tween.propHooks[ this.prop ];
	
			return hooks && hooks.get ?
				hooks.get( this ) :
				Tween.propHooks._default.get( this );
		},
		run: function( percent ) {
			var eased,
				hooks = Tween.propHooks[ this.prop ];
	
			if ( this.options.duration ) {
				this.pos = eased = jQuery.easing[ this.easing ](
					percent, this.options.duration * percent, 0, 1, this.options.duration
				);
			} else {
				this.pos = eased = percent;
			}
			this.now = ( this.end - this.start ) * eased + this.start;
	
			if ( this.options.step ) {
				this.options.step.call( this.elem, this.now, this );
			}
	
			if ( hooks && hooks.set ) {
				hooks.set( this );
			} else {
				Tween.propHooks._default.set( this );
			}
			return this;
		}
	};
	
	Tween.prototype.init.prototype = Tween.prototype;
	
	Tween.propHooks = {
		_default: {
			get: function( tween ) {
				var result;
	
				if ( tween.elem[ tween.prop ] != null &&
					(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {
					return tween.elem[ tween.prop ];
				}
	
				// Passing an empty string as a 3rd parameter to .css will automatically
				// attempt a parseFloat and fallback to a string if the parse fails.
				// Simple values such as "10px" are parsed to Float;
				// complex values such as "rotate(1rad)" are returned as-is.
				result = jQuery.css( tween.elem, tween.prop, "" );
				// Empty strings, null, undefined and "auto" are converted to 0.
				return !result || result === "auto" ? 0 : result;
			},
			set: function( tween ) {
				// Use step hook for back compat.
				// Use cssHook if its there.
				// Use .style if available and use plain properties where available.
				if ( jQuery.fx.step[ tween.prop ] ) {
					jQuery.fx.step[ tween.prop ]( tween );
				} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {
					jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
				} else {
					tween.elem[ tween.prop ] = tween.now;
				}
			}
		}
	};
	
	// Support: IE9
	// Panic based approach to setting things on disconnected nodes
	Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
		set: function( tween ) {
			if ( tween.elem.nodeType && tween.elem.parentNode ) {
				tween.elem[ tween.prop ] = tween.now;
			}
		}
	};
	
	jQuery.easing = {
		linear: function( p ) {
			return p;
		},
		swing: function( p ) {
			return 0.5 - Math.cos( p * Math.PI ) / 2;
		}
	};
	
	jQuery.fx = Tween.prototype.init;
	
	// Back Compat <1.8 extension point
	jQuery.fx.step = {};
	
	
	
	
	var
		fxNow, timerId,
		rfxtypes = /^(?:toggle|show|hide)$/,
		rfxnum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" ),
		rrun = /queueHooks$/,
		animationPrefilters = [ defaultPrefilter ],
		tweeners = {
			"*": [ function( prop, value ) {
				var tween = this.createTween( prop, value ),
					target = tween.cur(),
					parts = rfxnum.exec( value ),
					unit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),
	
					// Starting value computation is required for potential unit mismatches
					start = ( jQuery.cssNumber[ prop ] || unit !== "px" && +target ) &&
						rfxnum.exec( jQuery.css( tween.elem, prop ) ),
					scale = 1,
					maxIterations = 20;
	
				if ( start && start[ 3 ] !== unit ) {
					// Trust units reported by jQuery.css
					unit = unit || start[ 3 ];
	
					// Make sure we update the tween properties later on
					parts = parts || [];
	
					// Iteratively approximate from a nonzero starting point
					start = +target || 1;
	
					do {
						// If previous iteration zeroed out, double until we get *something*.
						// Use string for doubling so we don't accidentally see scale as unchanged below
						scale = scale || ".5";
	
						// Adjust and apply
						start = start / scale;
						jQuery.style( tween.elem, prop, start + unit );
	
					// Update scale, tolerating zero or NaN from tween.cur(),
					// break the loop if scale is unchanged or perfect, or if we've just had enough
					} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );
				}
	
				// Update tween properties
				if ( parts ) {
					start = tween.start = +start || +target || 0;
					tween.unit = unit;
					// If a +=/-= token was provided, we're doing a relative animation
					tween.end = parts[ 1 ] ?
						start + ( parts[ 1 ] + 1 ) * parts[ 2 ] :
						+parts[ 2 ];
				}
	
				return tween;
			} ]
		};
	
	// Animations created synchronously will run synchronously
	function createFxNow() {
		setTimeout(function() {
			fxNow = undefined;
		});
		return ( fxNow = jQuery.now() );
	}
	
	// Generate parameters to create a standard animation
	function genFx( type, includeWidth ) {
		var which,
			i = 0,
			attrs = { height: type };
	
		// If we include width, step value is 1 to do all cssExpand values,
		// otherwise step value is 2 to skip over Left and Right
		includeWidth = includeWidth ? 1 : 0;
		for ( ; i < 4 ; i += 2 - includeWidth ) {
			which = cssExpand[ i ];
			attrs[ "margin" + which ] = attrs[ "padding" + which ] = type;
		}
	
		if ( includeWidth ) {
			attrs.opacity = attrs.width = type;
		}
	
		return attrs;
	}
	
	function createTween( value, prop, animation ) {
		var tween,
			collection = ( tweeners[ prop ] || [] ).concat( tweeners[ "*" ] ),
			index = 0,
			length = collection.length;
		for ( ; index < length; index++ ) {
			if ( (tween = collection[ index ].call( animation, prop, value )) ) {
	
				// We're done with this property
				return tween;
			}
		}
	}
	
	function defaultPrefilter( elem, props, opts ) {
		/* jshint validthis: true */
		var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,
			anim = this,
			orig = {},
			style = elem.style,
			hidden = elem.nodeType && isHidden( elem ),
			dataShow = data_priv.get( elem, "fxshow" );
	
		// Handle queue: false promises
		if ( !opts.queue ) {
			hooks = jQuery._queueHooks( elem, "fx" );
			if ( hooks.unqueued == null ) {
				hooks.unqueued = 0;
				oldfire = hooks.empty.fire;
				hooks.empty.fire = function() {
					if ( !hooks.unqueued ) {
						oldfire();
					}
				};
			}
			hooks.unqueued++;
	
			anim.always(function() {
				// Ensure the complete handler is called before this completes
				anim.always(function() {
					hooks.unqueued--;
					if ( !jQuery.queue( elem, "fx" ).length ) {
						hooks.empty.fire();
					}
				});
			});
		}
	
		// Height/width overflow pass
		if ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {
			// Make sure that nothing sneaks out
			// Record all 3 overflow attributes because IE9-10 do not
			// change the overflow attribute when overflowX and
			// overflowY are set to the same value
			opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];
	
			// Set display property to inline-block for height/width
			// animations on inline elements that are having width/height animated
			display = jQuery.css( elem, "display" );
	
			// Test default display if display is currently "none"
			checkDisplay = display === "none" ?
				data_priv.get( elem, "olddisplay" ) || defaultDisplay( elem.nodeName ) : display;
	
			if ( checkDisplay === "inline" && jQuery.css( elem, "float" ) === "none" ) {
				style.display = "inline-block";
			}
		}
	
		if ( opts.overflow ) {
			style.overflow = "hidden";
			anim.always(function() {
				style.overflow = opts.overflow[ 0 ];
				style.overflowX = opts.overflow[ 1 ];
				style.overflowY = opts.overflow[ 2 ];
			});
		}
	
		// show/hide pass
		for ( prop in props ) {
			value = props[ prop ];
			if ( rfxtypes.exec( value ) ) {
				delete props[ prop ];
				toggle = toggle || value === "toggle";
				if ( value === ( hidden ? "hide" : "show" ) ) {
	
					// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden
					if ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {
						hidden = true;
					} else {
						continue;
					}
				}
				orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );
	
			// Any non-fx value stops us from restoring the original display value
			} else {
				display = undefined;
			}
		}
	
		if ( !jQuery.isEmptyObject( orig ) ) {
			if ( dataShow ) {
				if ( "hidden" in dataShow ) {
					hidden = dataShow.hidden;
				}
			} else {
				dataShow = data_priv.access( elem, "fxshow", {} );
			}
	
			// Store state if its toggle - enables .stop().toggle() to "reverse"
			if ( toggle ) {
				dataShow.hidden = !hidden;
			}
			if ( hidden ) {
				jQuery( elem ).show();
			} else {
				anim.done(function() {
					jQuery( elem ).hide();
				});
			}
			anim.done(function() {
				var prop;
	
				data_priv.remove( elem, "fxshow" );
				for ( prop in orig ) {
					jQuery.style( elem, prop, orig[ prop ] );
				}
			});
			for ( prop in orig ) {
				tween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );
	
				if ( !( prop in dataShow ) ) {
					dataShow[ prop ] = tween.start;
					if ( hidden ) {
						tween.end = tween.start;
						tween.start = prop === "width" || prop === "height" ? 1 : 0;
					}
				}
			}
	
		// If this is a noop like .hide().hide(), restore an overwritten display value
		} else if ( (display === "none" ? defaultDisplay( elem.nodeName ) : display) === "inline" ) {
			style.display = display;
		}
	}
	
	function propFilter( props, specialEasing ) {
		var index, name, easing, value, hooks;
	
		// camelCase, specialEasing and expand cssHook pass
		for ( index in props ) {
			name = jQuery.camelCase( index );
			easing = specialEasing[ name ];
			value = props[ index ];
			if ( jQuery.isArray( value ) ) {
				easing = value[ 1 ];
				value = props[ index ] = value[ 0 ];
			}
	
			if ( index !== name ) {
				props[ name ] = value;
				delete props[ index ];
			}
	
			hooks = jQuery.cssHooks[ name ];
			if ( hooks && "expand" in hooks ) {
				value = hooks.expand( value );
				delete props[ name ];
	
				// Not quite $.extend, this won't overwrite existing keys.
				// Reusing 'index' because we have the correct "name"
				for ( index in value ) {
					if ( !( index in props ) ) {
						props[ index ] = value[ index ];
						specialEasing[ index ] = easing;
					}
				}
			} else {
				specialEasing[ name ] = easing;
			}
		}
	}
	
	function Animation( elem, properties, options ) {
		var result,
			stopped,
			index = 0,
			length = animationPrefilters.length,
			deferred = jQuery.Deferred().always( function() {
				// Don't match elem in the :animated selector
				delete tick.elem;
			}),
			tick = function() {
				if ( stopped ) {
					return false;
				}
				var currentTime = fxNow || createFxNow(),
					remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),
					// Support: Android 2.3
					// Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)
					temp = remaining / animation.duration || 0,
					percent = 1 - temp,
					index = 0,
					length = animation.tweens.length;
	
				for ( ; index < length ; index++ ) {
					animation.tweens[ index ].run( percent );
				}
	
				deferred.notifyWith( elem, [ animation, percent, remaining ]);
	
				if ( percent < 1 && length ) {
					return remaining;
				} else {
					deferred.resolveWith( elem, [ animation ] );
					return false;
				}
			},
			animation = deferred.promise({
				elem: elem,
				props: jQuery.extend( {}, properties ),
				opts: jQuery.extend( true, { specialEasing: {} }, options ),
				originalProperties: properties,
				originalOptions: options,
				startTime: fxNow || createFxNow(),
				duration: options.duration,
				tweens: [],
				createTween: function( prop, end ) {
					var tween = jQuery.Tween( elem, animation.opts, prop, end,
							animation.opts.specialEasing[ prop ] || animation.opts.easing );
					animation.tweens.push( tween );
					return tween;
				},
				stop: function( gotoEnd ) {
					var index = 0,
						// If we are going to the end, we want to run all the tweens
						// otherwise we skip this part
						length = gotoEnd ? animation.tweens.length : 0;
					if ( stopped ) {
						return this;
					}
					stopped = true;
					for ( ; index < length ; index++ ) {
						animation.tweens[ index ].run( 1 );
					}
	
					// Resolve when we played the last frame; otherwise, reject
					if ( gotoEnd ) {
						deferred.resolveWith( elem, [ animation, gotoEnd ] );
					} else {
						deferred.rejectWith( elem, [ animation, gotoEnd ] );
					}
					return this;
				}
			}),
			props = animation.props;
	
		propFilter( props, animation.opts.specialEasing );
	
		for ( ; index < length ; index++ ) {
			result = animationPrefilters[ index ].call( animation, elem, props, animation.opts );
			if ( result ) {
				return result;
			}
		}
	
		jQuery.map( props, createTween, animation );
	
		if ( jQuery.isFunction( animation.opts.start ) ) {
			animation.opts.start.call( elem, animation );
		}
	
		jQuery.fx.timer(
			jQuery.extend( tick, {
				elem: elem,
				anim: animation,
				queue: animation.opts.queue
			})
		);
	
		// attach callbacks from options
		return animation.progress( animation.opts.progress )
			.done( animation.opts.done, animation.opts.complete )
			.fail( animation.opts.fail )
			.always( animation.opts.always );
	}
	
	jQuery.Animation = jQuery.extend( Animation, {
	
		tweener: function( props, callback ) {
			if ( jQuery.isFunction( props ) ) {
				callback = props;
				props = [ "*" ];
			} else {
				props = props.split(" ");
			}
	
			var prop,
				index = 0,
				length = props.length;
	
			for ( ; index < length ; index++ ) {
				prop = props[ index ];
				tweeners[ prop ] = tweeners[ prop ] || [];
				tweeners[ prop ].unshift( callback );
			}
		},
	
		prefilter: function( callback, prepend ) {
			if ( prepend ) {
				animationPrefilters.unshift( callback );
			} else {
				animationPrefilters.push( callback );
			}
		}
	});
	
	jQuery.speed = function( speed, easing, fn ) {
		var opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {
			complete: fn || !fn && easing ||
				jQuery.isFunction( speed ) && speed,
			duration: speed,
			easing: fn && easing || easing && !jQuery.isFunction( easing ) && easing
		};
	
		opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration :
			opt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;
	
		// Normalize opt.queue - true/undefined/null -> "fx"
		if ( opt.queue == null || opt.queue === true ) {
			opt.queue = "fx";
		}
	
		// Queueing
		opt.old = opt.complete;
	
		opt.complete = function() {
			if ( jQuery.isFunction( opt.old ) ) {
				opt.old.call( this );
			}
	
			if ( opt.queue ) {
				jQuery.dequeue( this, opt.queue );
			}
		};
	
		return opt;
	};
	
	jQuery.fn.extend({
		fadeTo: function( speed, to, easing, callback ) {
	
			// Show any hidden elements after setting opacity to 0
			return this.filter( isHidden ).css( "opacity", 0 ).show()
	
				// Animate to the value specified
				.end().animate({ opacity: to }, speed, easing, callback );
		},
		animate: function( prop, speed, easing, callback ) {
			var empty = jQuery.isEmptyObject( prop ),
				optall = jQuery.speed( speed, easing, callback ),
				doAnimation = function() {
					// Operate on a copy of prop so per-property easing won't be lost
					var anim = Animation( this, jQuery.extend( {}, prop ), optall );
	
					// Empty animations, or finishing resolves immediately
					if ( empty || data_priv.get( this, "finish" ) ) {
						anim.stop( true );
					}
				};
				doAnimation.finish = doAnimation;
	
			return empty || optall.queue === false ?
				this.each( doAnimation ) :
				this.queue( optall.queue, doAnimation );
		},
		stop: function( type, clearQueue, gotoEnd ) {
			var stopQueue = function( hooks ) {
				var stop = hooks.stop;
				delete hooks.stop;
				stop( gotoEnd );
			};
	
			if ( typeof type !== "string" ) {
				gotoEnd = clearQueue;
				clearQueue = type;
				type = undefined;
			}
			if ( clearQueue && type !== false ) {
				this.queue( type || "fx", [] );
			}
	
			return this.each(function() {
				var dequeue = true,
					index = type != null && type + "queueHooks",
					timers = jQuery.timers,
					data = data_priv.get( this );
	
				if ( index ) {
					if ( data[ index ] && data[ index ].stop ) {
						stopQueue( data[ index ] );
					}
				} else {
					for ( index in data ) {
						if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {
							stopQueue( data[ index ] );
						}
					}
				}
	
				for ( index = timers.length; index--; ) {
					if ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {
						timers[ index ].anim.stop( gotoEnd );
						dequeue = false;
						timers.splice( index, 1 );
					}
				}
	
				// Start the next in the queue if the last step wasn't forced.
				// Timers currently will call their complete callbacks, which
				// will dequeue but only if they were gotoEnd.
				if ( dequeue || !gotoEnd ) {
					jQuery.dequeue( this, type );
				}
			});
		},
		finish: function( type ) {
			if ( type !== false ) {
				type = type || "fx";
			}
			return this.each(function() {
				var index,
					data = data_priv.get( this ),
					queue = data[ type + "queue" ],
					hooks = data[ type + "queueHooks" ],
					timers = jQuery.timers,
					length = queue ? queue.length : 0;
	
				// Enable finishing flag on private data
				data.finish = true;
	
				// Empty the queue first
				jQuery.queue( this, type, [] );
	
				if ( hooks && hooks.stop ) {
					hooks.stop.call( this, true );
				}
	
				// Look for any active animations, and finish them
				for ( index = timers.length; index--; ) {
					if ( timers[ index ].elem === this && timers[ index ].queue === type ) {
						timers[ index ].anim.stop( true );
						timers.splice( index, 1 );
					}
				}
	
				// Look for any animations in the old queue and finish them
				for ( index = 0; index < length; index++ ) {
					if ( queue[ index ] && queue[ index ].finish ) {
						queue[ index ].finish.call( this );
					}
				}
	
				// Turn off finishing flag
				delete data.finish;
			});
		}
	});
	
	jQuery.each([ "toggle", "show", "hide" ], function( i, name ) {
		var cssFn = jQuery.fn[ name ];
		jQuery.fn[ name ] = function( speed, easing, callback ) {
			return speed == null || typeof speed === "boolean" ?
				cssFn.apply( this, arguments ) :
				this.animate( genFx( name, true ), speed, easing, callback );
		};
	});
	
	// Generate shortcuts for custom animations
	jQuery.each({
		slideDown: genFx("show"),
		slideUp: genFx("hide"),
		slideToggle: genFx("toggle"),
		fadeIn: { opacity: "show" },
		fadeOut: { opacity: "hide" },
		fadeToggle: { opacity: "toggle" }
	}, function( name, props ) {
		jQuery.fn[ name ] = function( speed, easing, callback ) {
			return this.animate( props, speed, easing, callback );
		};
	});
	
	jQuery.timers = [];
	jQuery.fx.tick = function() {
		var timer,
			i = 0,
			timers = jQuery.timers;
	
		fxNow = jQuery.now();
	
		for ( ; i < timers.length; i++ ) {
			timer = timers[ i ];
			// Checks the timer has not already been removed
			if ( !timer() && timers[ i ] === timer ) {
				timers.splice( i--, 1 );
			}
		}
	
		if ( !timers.length ) {
			jQuery.fx.stop();
		}
		fxNow = undefined;
	};
	
	jQuery.fx.timer = function( timer ) {
		jQuery.timers.push( timer );
		if ( timer() ) {
			jQuery.fx.start();
		} else {
			jQuery.timers.pop();
		}
	};
	
	jQuery.fx.interval = 13;
	
	jQuery.fx.start = function() {
		if ( !timerId ) {
			timerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );
		}
	};
	
	jQuery.fx.stop = function() {
		clearInterval( timerId );
		timerId = null;
	};
	
	jQuery.fx.speeds = {
		slow: 600,
		fast: 200,
		// Default speed
		_default: 400
	};
	
	
	// Based off of the plugin by Clint Helfers, with permission.
	// http://blindsignals.com/index.php/2009/07/jquery-delay/
	jQuery.fn.delay = function( time, type ) {
		time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;
		type = type || "fx";
	
		return this.queue( type, function( next, hooks ) {
			var timeout = setTimeout( next, time );
			hooks.stop = function() {
				clearTimeout( timeout );
			};
		});
	};
	
	
	(function() {
		var input = document.createElement( "input" ),
			select = document.createElement( "select" ),
			opt = select.appendChild( document.createElement( "option" ) );
	
		input.type = "checkbox";
	
		// Support: iOS<=5.1, Android<=4.2+
		// Default value for a checkbox should be "on"
		support.checkOn = input.value !== "";
	
		// Support: IE<=11+
		// Must access selectedIndex to make default options select
		support.optSelected = opt.selected;
	
		// Support: Android<=2.3
		// Options inside disabled selects are incorrectly marked as disabled
		select.disabled = true;
		support.optDisabled = !opt.disabled;
	
		// Support: IE<=11+
		// An input loses its value after becoming a radio
		input = document.createElement( "input" );
		input.value = "t";
		input.type = "radio";
		support.radioValue = input.value === "t";
	})();
	
	
	var nodeHook, boolHook,
		attrHandle = jQuery.expr.attrHandle;
	
	jQuery.fn.extend({
		attr: function( name, value ) {
			return access( this, jQuery.attr, name, value, arguments.length > 1 );
		},
	
		removeAttr: function( name ) {
			return this.each(function() {
				jQuery.removeAttr( this, name );
			});
		}
	});
	
	jQuery.extend({
		attr: function( elem, name, value ) {
			var hooks, ret,
				nType = elem.nodeType;
	
			// don't get/set attributes on text, comment and attribute nodes
			if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
				return;
			}
	
			// Fallback to prop when attributes are not supported
			if ( typeof elem.getAttribute === strundefined ) {
				return jQuery.prop( elem, name, value );
			}
	
			// All attributes are lowercase
			// Grab necessary hook if one is defined
			if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
				name = name.toLowerCase();
				hooks = jQuery.attrHooks[ name ] ||
					( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );
			}
	
			if ( value !== undefined ) {
	
				if ( value === null ) {
					jQuery.removeAttr( elem, name );
	
				} else if ( hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {
					return ret;
	
				} else {
					elem.setAttribute( name, value + "" );
					return value;
				}
	
			} else if ( hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ) {
				return ret;
	
			} else {
				ret = jQuery.find.attr( elem, name );
	
				// Non-existent attributes return null, we normalize to undefined
				return ret == null ?
					undefined :
					ret;
			}
		},
	
		removeAttr: function( elem, value ) {
			var name, propName,
				i = 0,
				attrNames = value && value.match( rnotwhite );
	
			if ( attrNames && elem.nodeType === 1 ) {
				while ( (name = attrNames[i++]) ) {
					propName = jQuery.propFix[ name ] || name;
	
					// Boolean attributes get special treatment (#10870)
					if ( jQuery.expr.match.bool.test( name ) ) {
						// Set corresponding property to false
						elem[ propName ] = false;
					}
	
					elem.removeAttribute( name );
				}
			}
		},
	
		attrHooks: {
			type: {
				set: function( elem, value ) {
					if ( !support.radioValue && value === "radio" &&
						jQuery.nodeName( elem, "input" ) ) {
						var val = elem.value;
						elem.setAttribute( "type", value );
						if ( val ) {
							elem.value = val;
						}
						return value;
					}
				}
			}
		}
	});
	
	// Hooks for boolean attributes
	boolHook = {
		set: function( elem, value, name ) {
			if ( value === false ) {
				// Remove boolean attributes when set to false
				jQuery.removeAttr( elem, name );
			} else {
				elem.setAttribute( name, name );
			}
			return name;
		}
	};
	jQuery.each( jQuery.expr.match.bool.source.match( /\w+/g ), function( i, name ) {
		var getter = attrHandle[ name ] || jQuery.find.attr;
	
		attrHandle[ name ] = function( elem, name, isXML ) {
			var ret, handle;
			if ( !isXML ) {
				// Avoid an infinite loop by temporarily removing this function from the getter
				handle = attrHandle[ name ];
				attrHandle[ name ] = ret;
				ret = getter( elem, name, isXML ) != null ?
					name.toLowerCase() :
					null;
				attrHandle[ name ] = handle;
			}
			return ret;
		};
	});
	
	
	
	
	var rfocusable = /^(?:input|select|textarea|button)$/i;
	
	jQuery.fn.extend({
		prop: function( name, value ) {
			return access( this, jQuery.prop, name, value, arguments.length > 1 );
		},
	
		removeProp: function( name ) {
			return this.each(function() {
				delete this[ jQuery.propFix[ name ] || name ];
			});
		}
	});
	
	jQuery.extend({
		propFix: {
			"for": "htmlFor",
			"class": "className"
		},
	
		prop: function( elem, name, value ) {
			var ret, hooks, notxml,
				nType = elem.nodeType;
	
			// Don't get/set properties on text, comment and attribute nodes
			if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
				return;
			}
	
			notxml = nType !== 1 || !jQuery.isXMLDoc( elem );
	
			if ( notxml ) {
				// Fix name and attach hooks
				name = jQuery.propFix[ name ] || name;
				hooks = jQuery.propHooks[ name ];
			}
	
			if ( value !== undefined ) {
				return hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?
					ret :
					( elem[ name ] = value );
	
			} else {
				return hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ?
					ret :
					elem[ name ];
			}
		},
	
		propHooks: {
			tabIndex: {
				get: function( elem ) {
					return elem.hasAttribute( "tabindex" ) || rfocusable.test( elem.nodeName ) || elem.href ?
						elem.tabIndex :
						-1;
				}
			}
		}
	});
	
	if ( !support.optSelected ) {
		jQuery.propHooks.selected = {
			get: function( elem ) {
				var parent = elem.parentNode;
				if ( parent && parent.parentNode ) {
					parent.parentNode.selectedIndex;
				}
				return null;
			}
		};
	}
	
	jQuery.each([
		"tabIndex",
		"readOnly",
		"maxLength",
		"cellSpacing",
		"cellPadding",
		"rowSpan",
		"colSpan",
		"useMap",
		"frameBorder",
		"contentEditable"
	], function() {
		jQuery.propFix[ this.toLowerCase() ] = this;
	});
	
	
	
	
	var rclass = /[\t\r\n\f]/g;
	
	jQuery.fn.extend({
		addClass: function( value ) {
			var classes, elem, cur, clazz, j, finalValue,
				proceed = typeof value === "string" && value,
				i = 0,
				len = this.length;
	
			if ( jQuery.isFunction( value ) ) {
				return this.each(function( j ) {
					jQuery( this ).addClass( value.call( this, j, this.className ) );
				});
			}
	
			if ( proceed ) {
				// The disjunction here is for better compressibility (see removeClass)
				classes = ( value || "" ).match( rnotwhite ) || [];
	
				for ( ; i < len; i++ ) {
					elem = this[ i ];
					cur = elem.nodeType === 1 && ( elem.className ?
						( " " + elem.className + " " ).replace( rclass, " " ) :
						" "
					);
	
					if ( cur ) {
						j = 0;
						while ( (clazz = classes[j++]) ) {
							if ( cur.indexOf( " " + clazz + " " ) < 0 ) {
								cur += clazz + " ";
							}
						}
	
						// only assign if different to avoid unneeded rendering.
						finalValue = jQuery.trim( cur );
						if ( elem.className !== finalValue ) {
							elem.className = finalValue;
						}
					}
				}
			}
	
			return this;
		},
	
		removeClass: function( value ) {
			var classes, elem, cur, clazz, j, finalValue,
				proceed = arguments.length === 0 || typeof value === "string" && value,
				i = 0,
				len = this.length;
	
			if ( jQuery.isFunction( value ) ) {
				return this.each(function( j ) {
					jQuery( this ).removeClass( value.call( this, j, this.className ) );
				});
			}
			if ( proceed ) {
				classes = ( value || "" ).match( rnotwhite ) || [];
	
				for ( ; i < len; i++ ) {
					elem = this[ i ];
					// This expression is here for better compressibility (see addClass)
					cur = elem.nodeType === 1 && ( elem.className ?
						( " " + elem.className + " " ).replace( rclass, " " ) :
						""
					);
	
					if ( cur ) {
						j = 0;
						while ( (clazz = classes[j++]) ) {
							// Remove *all* instances
							while ( cur.indexOf( " " + clazz + " " ) >= 0 ) {
								cur = cur.replace( " " + clazz + " ", " " );
							}
						}
	
						// Only assign if different to avoid unneeded rendering.
						finalValue = value ? jQuery.trim( cur ) : "";
						if ( elem.className !== finalValue ) {
							elem.className = finalValue;
						}
					}
				}
			}
	
			return this;
		},
	
		toggleClass: function( value, stateVal ) {
			var type = typeof value;
	
			if ( typeof stateVal === "boolean" && type === "string" ) {
				return stateVal ? this.addClass( value ) : this.removeClass( value );
			}
	
			if ( jQuery.isFunction( value ) ) {
				return this.each(function( i ) {
					jQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );
				});
			}
	
			return this.each(function() {
				if ( type === "string" ) {
					// Toggle individual class names
					var className,
						i = 0,
						self = jQuery( this ),
						classNames = value.match( rnotwhite ) || [];
	
					while ( (className = classNames[ i++ ]) ) {
						// Check each className given, space separated list
						if ( self.hasClass( className ) ) {
							self.removeClass( className );
						} else {
							self.addClass( className );
						}
					}
	
				// Toggle whole class name
				} else if ( type === strundefined || type === "boolean" ) {
					if ( this.className ) {
						// store className if set
						data_priv.set( this, "__className__", this.className );
					}
	
					// If the element has a class name or if we're passed `false`,
					// then remove the whole classname (if there was one, the above saved it).
					// Otherwise bring back whatever was previously saved (if anything),
					// falling back to the empty string if nothing was stored.
					this.className = this.className || value === false ? "" : data_priv.get( this, "__className__" ) || "";
				}
			});
		},
	
		hasClass: function( selector ) {
			var className = " " + selector + " ",
				i = 0,
				l = this.length;
			for ( ; i < l; i++ ) {
				if ( this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf( className ) >= 0 ) {
					return true;
				}
			}
	
			return false;
		}
	});
	
	
	
	
	var rreturn = /\r/g;
	
	jQuery.fn.extend({
		val: function( value ) {
			var hooks, ret, isFunction,
				elem = this[0];
	
			if ( !arguments.length ) {
				if ( elem ) {
					hooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];
	
					if ( hooks && "get" in hooks && (ret = hooks.get( elem, "value" )) !== undefined ) {
						return ret;
					}
	
					ret = elem.value;
	
					return typeof ret === "string" ?
						// Handle most common string cases
						ret.replace(rreturn, "") :
						// Handle cases where value is null/undef or number
						ret == null ? "" : ret;
				}
	
				return;
			}
	
			isFunction = jQuery.isFunction( value );
	
			return this.each(function( i ) {
				var val;
	
				if ( this.nodeType !== 1 ) {
					return;
				}
	
				if ( isFunction ) {
					val = value.call( this, i, jQuery( this ).val() );
				} else {
					val = value;
				}
	
				// Treat null/undefined as ""; convert numbers to string
				if ( val == null ) {
					val = "";
	
				} else if ( typeof val === "number" ) {
					val += "";
	
				} else if ( jQuery.isArray( val ) ) {
					val = jQuery.map( val, function( value ) {
						return value == null ? "" : value + "";
					});
				}
	
				hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];
	
				// If set returns undefined, fall back to normal setting
				if ( !hooks || !("set" in hooks) || hooks.set( this, val, "value" ) === undefined ) {
					this.value = val;
				}
			});
		}
	});
	
	jQuery.extend({
		valHooks: {
			option: {
				get: function( elem ) {
					var val = jQuery.find.attr( elem, "value" );
					return val != null ?
						val :
						// Support: IE10-11+
						// option.text throws exceptions (#14686, #14858)
						jQuery.trim( jQuery.text( elem ) );
				}
			},
			select: {
				get: function( elem ) {
					var value, option,
						options = elem.options,
						index = elem.selectedIndex,
						one = elem.type === "select-one" || index < 0,
						values = one ? null : [],
						max = one ? index + 1 : options.length,
						i = index < 0 ?
							max :
							one ? index : 0;
	
					// Loop through all the selected options
					for ( ; i < max; i++ ) {
						option = options[ i ];
	
						// IE6-9 doesn't update selected after form reset (#2551)
						if ( ( option.selected || i === index ) &&
								// Don't return options that are disabled or in a disabled optgroup
								( support.optDisabled ? !option.disabled : option.getAttribute( "disabled" ) === null ) &&
								( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {
	
							// Get the specific value for the option
							value = jQuery( option ).val();
	
							// We don't need an array for one selects
							if ( one ) {
								return value;
							}
	
							// Multi-Selects return an array
							values.push( value );
						}
					}
	
					return values;
				},
	
				set: function( elem, value ) {
					var optionSet, option,
						options = elem.options,
						values = jQuery.makeArray( value ),
						i = options.length;
	
					while ( i-- ) {
						option = options[ i ];
						if ( (option.selected = jQuery.inArray( option.value, values ) >= 0) ) {
							optionSet = true;
						}
					}
	
					// Force browsers to behave consistently when non-matching value is set
					if ( !optionSet ) {
						elem.selectedIndex = -1;
					}
					return values;
				}
			}
		}
	});
	
	// Radios and checkboxes getter/setter
	jQuery.each([ "radio", "checkbox" ], function() {
		jQuery.valHooks[ this ] = {
			set: function( elem, value ) {
				if ( jQuery.isArray( value ) ) {
					return ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );
				}
			}
		};
		if ( !support.checkOn ) {
			jQuery.valHooks[ this ].get = function( elem ) {
				return elem.getAttribute("value") === null ? "on" : elem.value;
			};
		}
	});
	
	
	
	
	// Return jQuery for attributes-only inclusion
	
	
	jQuery.each( ("blur focus focusin focusout load resize scroll unload click dblclick " +
		"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +
		"change select submit keydown keypress keyup error contextmenu").split(" "), function( i, name ) {
	
		// Handle event binding
		jQuery.fn[ name ] = function( data, fn ) {
			return arguments.length > 0 ?
				this.on( name, null, data, fn ) :
				this.trigger( name );
		};
	});
	
	jQuery.fn.extend({
		hover: function( fnOver, fnOut ) {
			return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
		},
	
		bind: function( types, data, fn ) {
			return this.on( types, null, data, fn );
		},
		unbind: function( types, fn ) {
			return this.off( types, null, fn );
		},
	
		delegate: function( selector, types, data, fn ) {
			return this.on( types, selector, data, fn );
		},
		undelegate: function( selector, types, fn ) {
			// ( namespace ) or ( selector, types [, fn] )
			return arguments.length === 1 ? this.off( selector, "**" ) : this.off( types, selector || "**", fn );
		}
	});
	
	
	var nonce = jQuery.now();
	
	var rquery = (/\?/);
	
	
	
	// Support: Android 2.3
	// Workaround failure to string-cast null input
	jQuery.parseJSON = function( data ) {
		return JSON.parse( data + "" );
	};
	
	
	// Cross-browser xml parsing
	jQuery.parseXML = function( data ) {
		var xml, tmp;
		if ( !data || typeof data !== "string" ) {
			return null;
		}
	
		// Support: IE9
		try {
			tmp = new DOMParser();
			xml = tmp.parseFromString( data, "text/xml" );
		} catch ( e ) {
			xml = undefined;
		}
	
		if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
			jQuery.error( "Invalid XML: " + data );
		}
		return xml;
	};
	
	
	var
		rhash = /#.*$/,
		rts = /([?&])_=[^&]*/,
		rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,
		// #7653, #8125, #8152: local protocol detection
		rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
		rnoContent = /^(?:GET|HEAD)$/,
		rprotocol = /^\/\//,
		rurl = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
	
		/* Prefilters
		 * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)
		 * 2) These are called:
		 *    - BEFORE asking for a transport
		 *    - AFTER param serialization (s.data is a string if s.processData is true)
		 * 3) key is the dataType
		 * 4) the catchall symbol "*" can be used
		 * 5) execution will start with transport dataType and THEN continue down to "*" if needed
		 */
		prefilters = {},
	
		/* Transports bindings
		 * 1) key is the dataType
		 * 2) the catchall symbol "*" can be used
		 * 3) selection will start with transport dataType and THEN go to "*" if needed
		 */
		transports = {},
	
		// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression
		allTypes = "*/".concat( "*" ),
	
		// Document location
		ajaxLocation = window.location.href,
	
		// Segment location into parts
		ajaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];
	
	// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport
	function addToPrefiltersOrTransports( structure ) {
	
		// dataTypeExpression is optional and defaults to "*"
		return function( dataTypeExpression, func ) {
	
			if ( typeof dataTypeExpression !== "string" ) {
				func = dataTypeExpression;
				dataTypeExpression = "*";
			}
	
			var dataType,
				i = 0,
				dataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];
	
			if ( jQuery.isFunction( func ) ) {
				// For each dataType in the dataTypeExpression
				while ( (dataType = dataTypes[i++]) ) {
					// Prepend if requested
					if ( dataType[0] === "+" ) {
						dataType = dataType.slice( 1 ) || "*";
						(structure[ dataType ] = structure[ dataType ] || []).unshift( func );
	
					// Otherwise append
					} else {
						(structure[ dataType ] = structure[ dataType ] || []).push( func );
					}
				}
			}
		};
	}
	
	// Base inspection function for prefilters and transports
	function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {
	
		var inspected = {},
			seekingTransport = ( structure === transports );
	
		function inspect( dataType ) {
			var selected;
			inspected[ dataType ] = true;
			jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {
				var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );
				if ( typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {
					options.dataTypes.unshift( dataTypeOrTransport );
					inspect( dataTypeOrTransport );
					return false;
				} else if ( seekingTransport ) {
					return !( selected = dataTypeOrTransport );
				}
			});
			return selected;
		}
	
		return inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );
	}
	
	// A special extend for ajax options
	// that takes "flat" options (not to be deep extended)
	// Fixes #9887
	function ajaxExtend( target, src ) {
		var key, deep,
			flatOptions = jQuery.ajaxSettings.flatOptions || {};
	
		for ( key in src ) {
			if ( src[ key ] !== undefined ) {
				( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];
			}
		}
		if ( deep ) {
			jQuery.extend( true, target, deep );
		}
	
		return target;
	}
	
	/* Handles responses to an ajax request:
	 * - finds the right dataType (mediates between content-type and expected dataType)
	 * - returns the corresponding response
	 */
	function ajaxHandleResponses( s, jqXHR, responses ) {
	
		var ct, type, finalDataType, firstDataType,
			contents = s.contents,
			dataTypes = s.dataTypes;
	
		// Remove auto dataType and get content-type in the process
		while ( dataTypes[ 0 ] === "*" ) {
			dataTypes.shift();
			if ( ct === undefined ) {
				ct = s.mimeType || jqXHR.getResponseHeader("Content-Type");
			}
		}
	
		// Check if we're dealing with a known content-type
		if ( ct ) {
			for ( type in contents ) {
				if ( contents[ type ] && contents[ type ].test( ct ) ) {
					dataTypes.unshift( type );
					break;
				}
			}
		}
	
		// Check to see if we have a response for the expected dataType
		if ( dataTypes[ 0 ] in responses ) {
			finalDataType = dataTypes[ 0 ];
		} else {
			// Try convertible dataTypes
			for ( type in responses ) {
				if ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[0] ] ) {
					finalDataType = type;
					break;
				}
				if ( !firstDataType ) {
					firstDataType = type;
				}
			}
			// Or just use first one
			finalDataType = finalDataType || firstDataType;
		}
	
		// If we found a dataType
		// We add the dataType to the list if needed
		// and return the corresponding response
		if ( finalDataType ) {
			if ( finalDataType !== dataTypes[ 0 ] ) {
				dataTypes.unshift( finalDataType );
			}
			return responses[ finalDataType ];
		}
	}
	
	/* Chain conversions given the request and the original response
	 * Also sets the responseXXX fields on the jqXHR instance
	 */
	function ajaxConvert( s, response, jqXHR, isSuccess ) {
		var conv2, current, conv, tmp, prev,
			converters = {},
			// Work with a copy of dataTypes in case we need to modify it for conversion
			dataTypes = s.dataTypes.slice();
	
		// Create converters map with lowercased keys
		if ( dataTypes[ 1 ] ) {
			for ( conv in s.converters ) {
				converters[ conv.toLowerCase() ] = s.converters[ conv ];
			}
		}
	
		current = dataTypes.shift();
	
		// Convert to each sequential dataType
		while ( current ) {
	
			if ( s.responseFields[ current ] ) {
				jqXHR[ s.responseFields[ current ] ] = response;
			}
	
			// Apply the dataFilter if provided
			if ( !prev && isSuccess && s.dataFilter ) {
				response = s.dataFilter( response, s.dataType );
			}
	
			prev = current;
			current = dataTypes.shift();
	
			if ( current ) {
	
			// There's only work to do if current dataType is non-auto
				if ( current === "*" ) {
	
					current = prev;
	
				// Convert response if prev dataType is non-auto and differs from current
				} else if ( prev !== "*" && prev !== current ) {
	
					// Seek a direct converter
					conv = converters[ prev + " " + current ] || converters[ "* " + current ];
	
					// If none found, seek a pair
					if ( !conv ) {
						for ( conv2 in converters ) {
	
							// If conv2 outputs current
							tmp = conv2.split( " " );
							if ( tmp[ 1 ] === current ) {
	
								// If prev can be converted to accepted input
								conv = converters[ prev + " " + tmp[ 0 ] ] ||
									converters[ "* " + tmp[ 0 ] ];
								if ( conv ) {
									// Condense equivalence converters
									if ( conv === true ) {
										conv = converters[ conv2 ];
	
									// Otherwise, insert the intermediate dataType
									} else if ( converters[ conv2 ] !== true ) {
										current = tmp[ 0 ];
										dataTypes.unshift( tmp[ 1 ] );
									}
									break;
								}
							}
						}
					}
	
					// Apply converter (if not an equivalence)
					if ( conv !== true ) {
	
						// Unless errors are allowed to bubble, catch and return them
						if ( conv && s[ "throws" ] ) {
							response = conv( response );
						} else {
							try {
								response = conv( response );
							} catch ( e ) {
								return { state: "parsererror", error: conv ? e : "No conversion from " + prev + " to " + current };
							}
						}
					}
				}
			}
		}
	
		return { state: "success", data: response };
	}
	
	jQuery.extend({
	
		// Counter for holding the number of active queries
		active: 0,
	
		// Last-Modified header cache for next request
		lastModified: {},
		etag: {},
	
		ajaxSettings: {
			url: ajaxLocation,
			type: "GET",
			isLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),
			global: true,
			processData: true,
			async: true,
			contentType: "application/x-www-form-urlencoded; charset=UTF-8",
			/*
			timeout: 0,
			data: null,
			dataType: null,
			username: null,
			password: null,
			cache: null,
			throws: false,
			traditional: false,
			headers: {},
			*/
	
			accepts: {
				"*": allTypes,
				text: "text/plain",
				html: "text/html",
				xml: "application/xml, text/xml",
				json: "application/json, text/javascript"
			},
	
			contents: {
				xml: /xml/,
				html: /html/,
				json: /json/
			},
	
			responseFields: {
				xml: "responseXML",
				text: "responseText",
				json: "responseJSON"
			},
	
			// Data converters
			// Keys separate source (or catchall "*") and destination types with a single space
			converters: {
	
				// Convert anything to text
				"* text": String,
	
				// Text to html (true = no transformation)
				"text html": true,
	
				// Evaluate text as a json expression
				"text json": jQuery.parseJSON,
	
				// Parse text as xml
				"text xml": jQuery.parseXML
			},
	
			// For options that shouldn't be deep extended:
			// you can add your own custom options here if
			// and when you create one that shouldn't be
			// deep extended (see ajaxExtend)
			flatOptions: {
				url: true,
				context: true
			}
		},
	
		// Creates a full fledged settings object into target
		// with both ajaxSettings and settings fields.
		// If target is omitted, writes into ajaxSettings.
		ajaxSetup: function( target, settings ) {
			return settings ?
	
				// Building a settings object
				ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :
	
				// Extending ajaxSettings
				ajaxExtend( jQuery.ajaxSettings, target );
		},
	
		ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),
		ajaxTransport: addToPrefiltersOrTransports( transports ),
	
		// Main method
		ajax: function( url, options ) {
	
			// If url is an object, simulate pre-1.5 signature
			if ( typeof url === "object" ) {
				options = url;
				url = undefined;
			}
	
			// Force options to be an object
			options = options || {};
	
			var transport,
				// URL without anti-cache param
				cacheURL,
				// Response headers
				responseHeadersString,
				responseHeaders,
				// timeout handle
				timeoutTimer,
				// Cross-domain detection vars
				parts,
				// To know if global events are to be dispatched
				fireGlobals,
				// Loop variable
				i,
				// Create the final options object
				s = jQuery.ajaxSetup( {}, options ),
				// Callbacks context
				callbackContext = s.context || s,
				// Context for global events is callbackContext if it is a DOM node or jQuery collection
				globalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?
					jQuery( callbackContext ) :
					jQuery.event,
				// Deferreds
				deferred = jQuery.Deferred(),
				completeDeferred = jQuery.Callbacks("once memory"),
				// Status-dependent callbacks
				statusCode = s.statusCode || {},
				// Headers (they are sent all at once)
				requestHeaders = {},
				requestHeadersNames = {},
				// The jqXHR state
				state = 0,
				// Default abort message
				strAbort = "canceled",
				// Fake xhr
				jqXHR = {
					readyState: 0,
	
					// Builds headers hashtable if needed
					getResponseHeader: function( key ) {
						var match;
						if ( state === 2 ) {
							if ( !responseHeaders ) {
								responseHeaders = {};
								while ( (match = rheaders.exec( responseHeadersString )) ) {
									responseHeaders[ match[1].toLowerCase() ] = match[ 2 ];
								}
							}
							match = responseHeaders[ key.toLowerCase() ];
						}
						return match == null ? null : match;
					},
	
					// Raw string
					getAllResponseHeaders: function() {
						return state === 2 ? responseHeadersString : null;
					},
	
					// Caches the header
					setRequestHeader: function( name, value ) {
						var lname = name.toLowerCase();
						if ( !state ) {
							name = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;
							requestHeaders[ name ] = value;
						}
						return this;
					},
	
					// Overrides response content-type header
					overrideMimeType: function( type ) {
						if ( !state ) {
							s.mimeType = type;
						}
						return this;
					},
	
					// Status-dependent callbacks
					statusCode: function( map ) {
						var code;
						if ( map ) {
							if ( state < 2 ) {
								for ( code in map ) {
									// Lazy-add the new callback in a way that preserves old ones
									statusCode[ code ] = [ statusCode[ code ], map[ code ] ];
								}
							} else {
								// Execute the appropriate callbacks
								jqXHR.always( map[ jqXHR.status ] );
							}
						}
						return this;
					},
	
					// Cancel the request
					abort: function( statusText ) {
						var finalText = statusText || strAbort;
						if ( transport ) {
							transport.abort( finalText );
						}
						done( 0, finalText );
						return this;
					}
				};
	
			// Attach deferreds
			deferred.promise( jqXHR ).complete = completeDeferred.add;
			jqXHR.success = jqXHR.done;
			jqXHR.error = jqXHR.fail;
	
			// Remove hash character (#7531: and string promotion)
			// Add protocol if not provided (prefilters might expect it)
			// Handle falsy url in the settings object (#10093: consistency with old signature)
			// We also use the url parameter if available
			s.url = ( ( url || s.url || ajaxLocation ) + "" ).replace( rhash, "" )
				.replace( rprotocol, ajaxLocParts[ 1 ] + "//" );
	
			// Alias method option to type as per ticket #12004
			s.type = options.method || options.type || s.method || s.type;
	
			// Extract dataTypes list
			s.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( rnotwhite ) || [ "" ];
	
			// A cross-domain request is in order when we have a protocol:host:port mismatch
			if ( s.crossDomain == null ) {
				parts = rurl.exec( s.url.toLowerCase() );
				s.crossDomain = !!( parts &&
					( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||
						( parts[ 3 ] || ( parts[ 1 ] === "http:" ? "80" : "443" ) ) !==
							( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === "http:" ? "80" : "443" ) ) )
				);
			}
	
			// Convert data if not already a string
			if ( s.data && s.processData && typeof s.data !== "string" ) {
				s.data = jQuery.param( s.data, s.traditional );
			}
	
			// Apply prefilters
			inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );
	
			// If request was aborted inside a prefilter, stop there
			if ( state === 2 ) {
				return jqXHR;
			}
	
			// We can fire global events as of now if asked to
			// Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)
			fireGlobals = jQuery.event && s.global;
	
			// Watch for a new set of requests
			if ( fireGlobals && jQuery.active++ === 0 ) {
				jQuery.event.trigger("ajaxStart");
			}
	
			// Uppercase the type
			s.type = s.type.toUpperCase();
	
			// Determine if request has content
			s.hasContent = !rnoContent.test( s.type );
	
			// Save the URL in case we're toying with the If-Modified-Since
			// and/or If-None-Match header later on
			cacheURL = s.url;
	
			// More options handling for requests with no content
			if ( !s.hasContent ) {
	
				// If data is available, append data to url
				if ( s.data ) {
					cacheURL = ( s.url += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data );
					// #9682: remove data so that it's not used in an eventual retry
					delete s.data;
				}
	
				// Add anti-cache in url if needed
				if ( s.cache === false ) {
					s.url = rts.test( cacheURL ) ?
	
						// If there is already a '_' parameter, set its value
						cacheURL.replace( rts, "$1_=" + nonce++ ) :
	
						// Otherwise add one to the end
						cacheURL + ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + nonce++;
				}
			}
	
			// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
			if ( s.ifModified ) {
				if ( jQuery.lastModified[ cacheURL ] ) {
					jqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );
				}
				if ( jQuery.etag[ cacheURL ] ) {
					jqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );
				}
			}
	
			// Set the correct header, if data is being sent
			if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {
				jqXHR.setRequestHeader( "Content-Type", s.contentType );
			}
	
			// Set the Accepts header for the server, depending on the dataType
			jqXHR.setRequestHeader(
				"Accept",
				s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?
					s.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :
					s.accepts[ "*" ]
			);
	
			// Check for headers option
			for ( i in s.headers ) {
				jqXHR.setRequestHeader( i, s.headers[ i ] );
			}
	
			// Allow custom headers/mimetypes and early abort
			if ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {
				// Abort if not done already and return
				return jqXHR.abort();
			}
	
			// Aborting is no longer a cancellation
			strAbort = "abort";
	
			// Install callbacks on deferreds
			for ( i in { success: 1, error: 1, complete: 1 } ) {
				jqXHR[ i ]( s[ i ] );
			}
	
			// Get transport
			transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );
	
			// If no transport, we auto-abort
			if ( !transport ) {
				done( -1, "No Transport" );
			} else {
				jqXHR.readyState = 1;
	
				// Send global event
				if ( fireGlobals ) {
					globalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );
				}
				// Timeout
				if ( s.async && s.timeout > 0 ) {
					timeoutTimer = setTimeout(function() {
						jqXHR.abort("timeout");
					}, s.timeout );
				}
	
				try {
					state = 1;
					transport.send( requestHeaders, done );
				} catch ( e ) {
					// Propagate exception as error if not done
					if ( state < 2 ) {
						done( -1, e );
					// Simply rethrow otherwise
					} else {
						throw e;
					}
				}
			}
	
			// Callback for when everything is done
			function done( status, nativeStatusText, responses, headers ) {
				var isSuccess, success, error, response, modified,
					statusText = nativeStatusText;
	
				// Called once
				if ( state === 2 ) {
					return;
				}
	
				// State is "done" now
				state = 2;
	
				// Clear timeout if it exists
				if ( timeoutTimer ) {
					clearTimeout( timeoutTimer );
				}
	
				// Dereference transport for early garbage collection
				// (no matter how long the jqXHR object will be used)
				transport = undefined;
	
				// Cache response headers
				responseHeadersString = headers || "";
	
				// Set readyState
				jqXHR.readyState = status > 0 ? 4 : 0;
	
				// Determine if successful
				isSuccess = status >= 200 && status < 300 || status === 304;
	
				// Get response data
				if ( responses ) {
					response = ajaxHandleResponses( s, jqXHR, responses );
				}
	
				// Convert no matter what (that way responseXXX fields are always set)
				response = ajaxConvert( s, response, jqXHR, isSuccess );
	
				// If successful, handle type chaining
				if ( isSuccess ) {
	
					// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
					if ( s.ifModified ) {
						modified = jqXHR.getResponseHeader("Last-Modified");
						if ( modified ) {
							jQuery.lastModified[ cacheURL ] = modified;
						}
						modified = jqXHR.getResponseHeader("etag");
						if ( modified ) {
							jQuery.etag[ cacheURL ] = modified;
						}
					}
	
					// if no content
					if ( status === 204 || s.type === "HEAD" ) {
						statusText = "nocontent";
	
					// if not modified
					} else if ( status === 304 ) {
						statusText = "notmodified";
	
					// If we have data, let's convert it
					} else {
						statusText = response.state;
						success = response.data;
						error = response.error;
						isSuccess = !error;
					}
				} else {
					// Extract error from statusText and normalize for non-aborts
					error = statusText;
					if ( status || !statusText ) {
						statusText = "error";
						if ( status < 0 ) {
							status = 0;
						}
					}
				}
	
				// Set data for the fake xhr object
				jqXHR.status = status;
				jqXHR.statusText = ( nativeStatusText || statusText ) + "";
	
				// Success/Error
				if ( isSuccess ) {
					deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );
				} else {
					deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );
				}
	
				// Status-dependent callbacks
				jqXHR.statusCode( statusCode );
				statusCode = undefined;
	
				if ( fireGlobals ) {
					globalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",
						[ jqXHR, s, isSuccess ? success : error ] );
				}
	
				// Complete
				completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );
	
				if ( fireGlobals ) {
					globalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );
					// Handle the global AJAX counter
					if ( !( --jQuery.active ) ) {
						jQuery.event.trigger("ajaxStop");
					}
				}
			}
	
			return jqXHR;
		},
	
		getJSON: function( url, data, callback ) {
			return jQuery.get( url, data, callback, "json" );
		},
	
		getScript: function( url, callback ) {
			return jQuery.get( url, undefined, callback, "script" );
		}
	});
	
	jQuery.each( [ "get", "post" ], function( i, method ) {
		jQuery[ method ] = function( url, data, callback, type ) {
			// Shift arguments if data argument was omitted
			if ( jQuery.isFunction( data ) ) {
				type = type || callback;
				callback = data;
				data = undefined;
			}
	
			return jQuery.ajax({
				url: url,
				type: method,
				dataType: type,
				data: data,
				success: callback
			});
		};
	});
	
	
	jQuery._evalUrl = function( url ) {
		return jQuery.ajax({
			url: url,
			type: "GET",
			dataType: "script",
			async: false,
			global: false,
			"throws": true
		});
	};
	
	
	jQuery.fn.extend({
		wrapAll: function( html ) {
			var wrap;
	
			if ( jQuery.isFunction( html ) ) {
				return this.each(function( i ) {
					jQuery( this ).wrapAll( html.call(this, i) );
				});
			}
	
			if ( this[ 0 ] ) {
	
				// The elements to wrap the target around
				wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );
	
				if ( this[ 0 ].parentNode ) {
					wrap.insertBefore( this[ 0 ] );
				}
	
				wrap.map(function() {
					var elem = this;
	
					while ( elem.firstElementChild ) {
						elem = elem.firstElementChild;
					}
	
					return elem;
				}).append( this );
			}
	
			return this;
		},
	
		wrapInner: function( html ) {
			if ( jQuery.isFunction( html ) ) {
				return this.each(function( i ) {
					jQuery( this ).wrapInner( html.call(this, i) );
				});
			}
	
			return this.each(function() {
				var self = jQuery( this ),
					contents = self.contents();
	
				if ( contents.length ) {
					contents.wrapAll( html );
	
				} else {
					self.append( html );
				}
			});
		},
	
		wrap: function( html ) {
			var isFunction = jQuery.isFunction( html );
	
			return this.each(function( i ) {
				jQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );
			});
		},
	
		unwrap: function() {
			return this.parent().each(function() {
				if ( !jQuery.nodeName( this, "body" ) ) {
					jQuery( this ).replaceWith( this.childNodes );
				}
			}).end();
		}
	});
	
	
	jQuery.expr.filters.hidden = function( elem ) {
		// Support: Opera <= 12.12
		// Opera reports offsetWidths and offsetHeights less than zero on some elements
		return elem.offsetWidth <= 0 && elem.offsetHeight <= 0;
	};
	jQuery.expr.filters.visible = function( elem ) {
		return !jQuery.expr.filters.hidden( elem );
	};
	
	
	
	
	var r20 = /%20/g,
		rbracket = /\[\]$/,
		rCRLF = /\r?\n/g,
		rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
		rsubmittable = /^(?:input|select|textarea|keygen)/i;
	
	function buildParams( prefix, obj, traditional, add ) {
		var name;
	
		if ( jQuery.isArray( obj ) ) {
			// Serialize array item.
			jQuery.each( obj, function( i, v ) {
				if ( traditional || rbracket.test( prefix ) ) {
					// Treat each array item as a scalar.
					add( prefix, v );
	
				} else {
					// Item is non-scalar (array or object), encode its numeric index.
					buildParams( prefix + "[" + ( typeof v === "object" ? i : "" ) + "]", v, traditional, add );
				}
			});
	
		} else if ( !traditional && jQuery.type( obj ) === "object" ) {
			// Serialize object item.
			for ( name in obj ) {
				buildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );
			}
	
		} else {
			// Serialize scalar item.
			add( prefix, obj );
		}
	}
	
	// Serialize an array of form elements or a set of
	// key/values into a query string
	jQuery.param = function( a, traditional ) {
		var prefix,
			s = [],
			add = function( key, value ) {
				// If value is a function, invoke it and return its value
				value = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );
				s[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );
			};
	
		// Set traditional to true for jQuery <= 1.3.2 behavior.
		if ( traditional === undefined ) {
			traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;
		}
	
		// If an array was passed in, assume that it is an array of form elements.
		if ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {
			// Serialize the form elements
			jQuery.each( a, function() {
				add( this.name, this.value );
			});
	
		} else {
			// If traditional, encode the "old" way (the way 1.3.2 or older
			// did it), otherwise encode params recursively.
			for ( prefix in a ) {
				buildParams( prefix, a[ prefix ], traditional, add );
			}
		}
	
		// Return the resulting serialization
		return s.join( "&" ).replace( r20, "+" );
	};
	
	jQuery.fn.extend({
		serialize: function() {
			return jQuery.param( this.serializeArray() );
		},
		serializeArray: function() {
			return this.map(function() {
				// Can add propHook for "elements" to filter or add form elements
				var elements = jQuery.prop( this, "elements" );
				return elements ? jQuery.makeArray( elements ) : this;
			})
			.filter(function() {
				var type = this.type;
	
				// Use .is( ":disabled" ) so that fieldset[disabled] works
				return this.name && !jQuery( this ).is( ":disabled" ) &&
					rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&
					( this.checked || !rcheckableType.test( type ) );
			})
			.map(function( i, elem ) {
				var val = jQuery( this ).val();
	
				return val == null ?
					null :
					jQuery.isArray( val ) ?
						jQuery.map( val, function( val ) {
							return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
						}) :
						{ name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
			}).get();
		}
	});
	
	
	jQuery.ajaxSettings.xhr = function() {
		try {
			return new XMLHttpRequest();
		} catch( e ) {}
	};
	
	var xhrId = 0,
		xhrCallbacks = {},
		xhrSuccessStatus = {
			// file protocol always yields status code 0, assume 200
			0: 200,
			// Support: IE9
			// #1450: sometimes IE returns 1223 when it should be 204
			1223: 204
		},
		xhrSupported = jQuery.ajaxSettings.xhr();
	
	// Support: IE9
	// Open requests must be manually aborted on unload (#5280)
	// See https://support.microsoft.com/kb/2856746 for more info
	if ( window.attachEvent ) {
		window.attachEvent( "onunload", function() {
			for ( var key in xhrCallbacks ) {
				xhrCallbacks[ key ]();
			}
		});
	}
	
	support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );
	support.ajax = xhrSupported = !!xhrSupported;
	
	jQuery.ajaxTransport(function( options ) {
		var callback;
	
		// Cross domain only allowed if supported through XMLHttpRequest
		if ( support.cors || xhrSupported && !options.crossDomain ) {
			return {
				send: function( headers, complete ) {
					var i,
						xhr = options.xhr(),
						id = ++xhrId;
	
					xhr.open( options.type, options.url, options.async, options.username, options.password );
	
					// Apply custom fields if provided
					if ( options.xhrFields ) {
						for ( i in options.xhrFields ) {
							xhr[ i ] = options.xhrFields[ i ];
						}
					}
	
					// Override mime type if needed
					if ( options.mimeType && xhr.overrideMimeType ) {
						xhr.overrideMimeType( options.mimeType );
					}
	
					// X-Requested-With header
					// For cross-domain requests, seeing as conditions for a preflight are
					// akin to a jigsaw puzzle, we simply never set it to be sure.
					// (it can always be set on a per-request basis or even using ajaxSetup)
					// For same-domain requests, won't change header if already provided.
					if ( !options.crossDomain && !headers["X-Requested-With"] ) {
						headers["X-Requested-With"] = "XMLHttpRequest";
					}
	
					// Set headers
					for ( i in headers ) {
						xhr.setRequestHeader( i, headers[ i ] );
					}
	
					// Callback
					callback = function( type ) {
						return function() {
							if ( callback ) {
								delete xhrCallbacks[ id ];
								callback = xhr.onload = xhr.onerror = null;
	
								if ( type === "abort" ) {
									xhr.abort();
								} else if ( type === "error" ) {
									complete(
										// file: protocol always yields status 0; see #8605, #14207
										xhr.status,
										xhr.statusText
									);
								} else {
									complete(
										xhrSuccessStatus[ xhr.status ] || xhr.status,
										xhr.statusText,
										// Support: IE9
										// Accessing binary-data responseText throws an exception
										// (#11426)
										typeof xhr.responseText === "string" ? {
											text: xhr.responseText
										} : undefined,
										xhr.getAllResponseHeaders()
									);
								}
							}
						};
					};
	
					// Listen to events
					xhr.onload = callback();
					xhr.onerror = callback("error");
	
					// Create the abort callback
					callback = xhrCallbacks[ id ] = callback("abort");
	
					try {
						// Do send the request (this may raise an exception)
						xhr.send( options.hasContent && options.data || null );
					} catch ( e ) {
						// #14683: Only rethrow if this hasn't been notified as an error yet
						if ( callback ) {
							throw e;
						}
					}
				},
	
				abort: function() {
					if ( callback ) {
						callback();
					}
				}
			};
		}
	});
	
	
	
	
	// Install script dataType
	jQuery.ajaxSetup({
		accepts: {
			script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
		},
		contents: {
			script: /(?:java|ecma)script/
		},
		converters: {
			"text script": function( text ) {
				jQuery.globalEval( text );
				return text;
			}
		}
	});
	
	// Handle cache's special case and crossDomain
	jQuery.ajaxPrefilter( "script", function( s ) {
		if ( s.cache === undefined ) {
			s.cache = false;
		}
		if ( s.crossDomain ) {
			s.type = "GET";
		}
	});
	
	// Bind script tag hack transport
	jQuery.ajaxTransport( "script", function( s ) {
		// This transport only deals with cross domain requests
		if ( s.crossDomain ) {
			var script, callback;
			return {
				send: function( _, complete ) {
					script = jQuery("<script>").prop({
						async: true,
						charset: s.scriptCharset,
						src: s.url
					}).on(
						"load error",
						callback = function( evt ) {
							script.remove();
							callback = null;
							if ( evt ) {
								complete( evt.type === "error" ? 404 : 200, evt.type );
							}
						}
					);
					document.head.appendChild( script[ 0 ] );
				},
				abort: function() {
					if ( callback ) {
						callback();
					}
				}
			};
		}
	});
	
	
	
	
	var oldCallbacks = [],
		rjsonp = /(=)\?(?=&|$)|\?\?/;
	
	// Default jsonp settings
	jQuery.ajaxSetup({
		jsonp: "callback",
		jsonpCallback: function() {
			var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );
			this[ callback ] = true;
			return callback;
		}
	});
	
	// Detect, normalize options and install callbacks for jsonp requests
	jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {
	
		var callbackName, overwritten, responseContainer,
			jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?
				"url" :
				typeof s.data === "string" && !( s.contentType || "" ).indexOf("application/x-www-form-urlencoded") && rjsonp.test( s.data ) && "data"
			);
	
		// Handle iff the expected data type is "jsonp" or we have a parameter to set
		if ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {
	
			// Get callback name, remembering preexisting value associated with it
			callbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?
				s.jsonpCallback() :
				s.jsonpCallback;
	
			// Insert callback into url or form data
			if ( jsonProp ) {
				s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );
			} else if ( s.jsonp !== false ) {
				s.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;
			}
	
			// Use data converter to retrieve json after script execution
			s.converters["script json"] = function() {
				if ( !responseContainer ) {
					jQuery.error( callbackName + " was not called" );
				}
				return responseContainer[ 0 ];
			};
	
			// force json dataType
			s.dataTypes[ 0 ] = "json";
	
			// Install callback
			overwritten = window[ callbackName ];
			window[ callbackName ] = function() {
				responseContainer = arguments;
			};
	
			// Clean-up function (fires after converters)
			jqXHR.always(function() {
				// Restore preexisting value
				window[ callbackName ] = overwritten;
	
				// Save back as free
				if ( s[ callbackName ] ) {
					// make sure that re-using the options doesn't screw things around
					s.jsonpCallback = originalSettings.jsonpCallback;
	
					// save the callback name for future use
					oldCallbacks.push( callbackName );
				}
	
				// Call if it was a function and we have a response
				if ( responseContainer && jQuery.isFunction( overwritten ) ) {
					overwritten( responseContainer[ 0 ] );
				}
	
				responseContainer = overwritten = undefined;
			});
	
			// Delegate to script
			return "script";
		}
	});
	
	
	
	
	// data: string of html
	// context (optional): If specified, the fragment will be created in this context, defaults to document
	// keepScripts (optional): If true, will include scripts passed in the html string
	jQuery.parseHTML = function( data, context, keepScripts ) {
		if ( !data || typeof data !== "string" ) {
			return null;
		}
		if ( typeof context === "boolean" ) {
			keepScripts = context;
			context = false;
		}
		context = context || document;
	
		var parsed = rsingleTag.exec( data ),
			scripts = !keepScripts && [];
	
		// Single tag
		if ( parsed ) {
			return [ context.createElement( parsed[1] ) ];
		}
	
		parsed = jQuery.buildFragment( [ data ], context, scripts );
	
		if ( scripts && scripts.length ) {
			jQuery( scripts ).remove();
		}
	
		return jQuery.merge( [], parsed.childNodes );
	};
	
	
	// Keep a copy of the old load method
	var _load = jQuery.fn.load;
	
	/**
	 * Load a url into a page
	 */
	jQuery.fn.load = function( url, params, callback ) {
		if ( typeof url !== "string" && _load ) {
			return _load.apply( this, arguments );
		}
	
		var selector, type, response,
			self = this,
			off = url.indexOf(" ");
	
		if ( off >= 0 ) {
			selector = jQuery.trim( url.slice( off ) );
			url = url.slice( 0, off );
		}
	
		// If it's a function
		if ( jQuery.isFunction( params ) ) {
	
			// We assume that it's the callback
			callback = params;
			params = undefined;
	
		// Otherwise, build a param string
		} else if ( params && typeof params === "object" ) {
			type = "POST";
		}
	
		// If we have elements to modify, make the request
		if ( self.length > 0 ) {
			jQuery.ajax({
				url: url,
	
				// if "type" variable is undefined, then "GET" method will be used
				type: type,
				dataType: "html",
				data: params
			}).done(function( responseText ) {
	
				// Save response for use in complete callback
				response = arguments;
	
				self.html( selector ?
	
					// If a selector was specified, locate the right elements in a dummy div
					// Exclude scripts to avoid IE 'Permission Denied' errors
					jQuery("<div>").append( jQuery.parseHTML( responseText ) ).find( selector ) :
	
					// Otherwise use the full result
					responseText );
	
			}).complete( callback && function( jqXHR, status ) {
				self.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );
			});
		}
	
		return this;
	};
	
	
	
	
	// Attach a bunch of functions for handling common AJAX events
	jQuery.each( [ "ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend" ], function( i, type ) {
		jQuery.fn[ type ] = function( fn ) {
			return this.on( type, fn );
		};
	});
	
	
	
	
	jQuery.expr.filters.animated = function( elem ) {
		return jQuery.grep(jQuery.timers, function( fn ) {
			return elem === fn.elem;
		}).length;
	};
	
	
	
	
	var docElem = window.document.documentElement;
	
	/**
	 * Gets a window from an element
	 */
	function getWindow( elem ) {
		return jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;
	}
	
	jQuery.offset = {
		setOffset: function( elem, options, i ) {
			var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,
				position = jQuery.css( elem, "position" ),
				curElem = jQuery( elem ),
				props = {};
	
			// Set position first, in-case top/left are set even on static elem
			if ( position === "static" ) {
				elem.style.position = "relative";
			}
	
			curOffset = curElem.offset();
			curCSSTop = jQuery.css( elem, "top" );
			curCSSLeft = jQuery.css( elem, "left" );
			calculatePosition = ( position === "absolute" || position === "fixed" ) &&
				( curCSSTop + curCSSLeft ).indexOf("auto") > -1;
	
			// Need to be able to calculate position if either
			// top or left is auto and position is either absolute or fixed
			if ( calculatePosition ) {
				curPosition = curElem.position();
				curTop = curPosition.top;
				curLeft = curPosition.left;
	
			} else {
				curTop = parseFloat( curCSSTop ) || 0;
				curLeft = parseFloat( curCSSLeft ) || 0;
			}
	
			if ( jQuery.isFunction( options ) ) {
				options = options.call( elem, i, curOffset );
			}
	
			if ( options.top != null ) {
				props.top = ( options.top - curOffset.top ) + curTop;
			}
			if ( options.left != null ) {
				props.left = ( options.left - curOffset.left ) + curLeft;
			}
	
			if ( "using" in options ) {
				options.using.call( elem, props );
	
			} else {
				curElem.css( props );
			}
		}
	};
	
	jQuery.fn.extend({
		offset: function( options ) {
			if ( arguments.length ) {
				return options === undefined ?
					this :
					this.each(function( i ) {
						jQuery.offset.setOffset( this, options, i );
					});
			}
	
			var docElem, win,
				elem = this[ 0 ],
				box = { top: 0, left: 0 },
				doc = elem && elem.ownerDocument;
	
			if ( !doc ) {
				return;
			}
	
			docElem = doc.documentElement;
	
			// Make sure it's not a disconnected DOM node
			if ( !jQuery.contains( docElem, elem ) ) {
				return box;
			}
	
			// Support: BlackBerry 5, iOS 3 (original iPhone)
			// If we don't have gBCR, just use 0,0 rather than error
			if ( typeof elem.getBoundingClientRect !== strundefined ) {
				box = elem.getBoundingClientRect();
			}
			win = getWindow( doc );
			return {
				top: box.top + win.pageYOffset - docElem.clientTop,
				left: box.left + win.pageXOffset - docElem.clientLeft
			};
		},
	
		position: function() {
			if ( !this[ 0 ] ) {
				return;
			}
	
			var offsetParent, offset,
				elem = this[ 0 ],
				parentOffset = { top: 0, left: 0 };
	
			// Fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is its only offset parent
			if ( jQuery.css( elem, "position" ) === "fixed" ) {
				// Assume getBoundingClientRect is there when computed position is fixed
				offset = elem.getBoundingClientRect();
	
			} else {
				// Get *real* offsetParent
				offsetParent = this.offsetParent();
	
				// Get correct offsets
				offset = this.offset();
				if ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {
					parentOffset = offsetParent.offset();
				}
	
				// Add offsetParent borders
				parentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true );
				parentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true );
			}
	
			// Subtract parent offsets and element margins
			return {
				top: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),
				left: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )
			};
		},
	
		offsetParent: function() {
			return this.map(function() {
				var offsetParent = this.offsetParent || docElem;
	
				while ( offsetParent && ( !jQuery.nodeName( offsetParent, "html" ) && jQuery.css( offsetParent, "position" ) === "static" ) ) {
					offsetParent = offsetParent.offsetParent;
				}
	
				return offsetParent || docElem;
			});
		}
	});
	
	// Create scrollLeft and scrollTop methods
	jQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {
		var top = "pageYOffset" === prop;
	
		jQuery.fn[ method ] = function( val ) {
			return access( this, function( elem, method, val ) {
				var win = getWindow( elem );
	
				if ( val === undefined ) {
					return win ? win[ prop ] : elem[ method ];
				}
	
				if ( win ) {
					win.scrollTo(
						!top ? val : window.pageXOffset,
						top ? val : window.pageYOffset
					);
	
				} else {
					elem[ method ] = val;
				}
			}, method, val, arguments.length, null );
		};
	});
	
	// Support: Safari<7+, Chrome<37+
	// Add the top/left cssHooks using jQuery.fn.position
	// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084
	// Blink bug: https://code.google.com/p/chromium/issues/detail?id=229280
	// getComputedStyle returns percent when specified for top/left/bottom/right;
	// rather than make the css module depend on the offset module, just check for it here
	jQuery.each( [ "top", "left" ], function( i, prop ) {
		jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,
			function( elem, computed ) {
				if ( computed ) {
					computed = curCSS( elem, prop );
					// If curCSS returns percentage, fallback to offset
					return rnumnonpx.test( computed ) ?
						jQuery( elem ).position()[ prop ] + "px" :
						computed;
				}
			}
		);
	});
	
	
	// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods
	jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {
		jQuery.each( { padding: "inner" + name, content: type, "": "outer" + name }, function( defaultExtra, funcName ) {
			// Margin is only for outerHeight, outerWidth
			jQuery.fn[ funcName ] = function( margin, value ) {
				var chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),
					extra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );
	
				return access( this, function( elem, type, value ) {
					var doc;
	
					if ( jQuery.isWindow( elem ) ) {
						// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there
						// isn't a whole lot we can do. See pull request at this URL for discussion:
						// https://github.com/jquery/jquery/pull/764
						return elem.document.documentElement[ "client" + name ];
					}
	
					// Get document width or height
					if ( elem.nodeType === 9 ) {
						doc = elem.documentElement;
	
						// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],
						// whichever is greatest
						return Math.max(
							elem.body[ "scroll" + name ], doc[ "scroll" + name ],
							elem.body[ "offset" + name ], doc[ "offset" + name ],
							doc[ "client" + name ]
						);
					}
	
					return value === undefined ?
						// Get width or height on the element, requesting but not forcing parseFloat
						jQuery.css( elem, type, extra ) :
	
						// Set width or height on the element
						jQuery.style( elem, type, value, extra );
				}, type, chainable ? margin : undefined, chainable, null );
			};
		});
	});
	
	
	// The number of elements contained in the matched element set
	jQuery.fn.size = function() {
		return this.length;
	};
	
	jQuery.fn.andSelf = jQuery.fn.addBack;
	
	
	
	
	// Register as a named AMD module, since jQuery can be concatenated with other
	// files that may use define, but not via a proper concatenation script that
	// understands anonymous AMD modules. A named AMD is safest and most robust
	// way to register. Lowercase jquery is used because AMD module names are
	// derived from file names, and jQuery is normally delivered in a lowercase
	// file name. Do this after creating the global so that if an AMD module wants
	// to call noConflict to hide this version of jQuery, it will work.
	
	// Note that for maximum portability, libraries that are not jQuery should
	// declare themselves as anonymous modules, and avoid setting a global if an
	// AMD loader is present. jQuery is a special case. For more information, see
	// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon
	
	if ( typeof define === "function" && define.amd ) {
		define( "jquery", [], function() {
			return jQuery;
		});
	}
	
	
	
	
	var
		// Map over jQuery in case of overwrite
		_jQuery = window.jQuery,
	
		// Map over the $ in case of overwrite
		_$ = window.$;
	
	jQuery.noConflict = function( deep ) {
		if ( window.$ === jQuery ) {
			window.$ = _$;
		}
	
		if ( deep && window.jQuery === jQuery ) {
			window.jQuery = _jQuery;
		}
	
		return jQuery;
	};
	
	// Expose jQuery and $ identifiers, even in AMD
	// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)
	// and CommonJS for browser emulators (#13566)
	if ( typeof noGlobal === strundefined ) {
		window.jQuery = window.$ = jQuery;
	}
	
	
	
	
	return jQuery;
	
	}));
	


/***/ },
/* 41 */
/*!****************************************!*\
  !*** (webpack)/buildin/amd-options.js ***!
  \****************************************/
/***/ function(module, exports) {

	/* WEBPACK VAR INJECTION */(function(__webpack_amd_options__) {module.exports = __webpack_amd_options__;
	
	/* WEBPACK VAR INJECTION */}.call(exports, {}))

/***/ },
/* 42 */
/*!***********************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.util.js ***!
  \***********************************************************************/
/***/ function(module, exports) {

	module.exports = "/**\r\n * SFAのユーティリティクラス\r\n */\r\n/**\r\n * 引数を文字列として返す。\r\n */\r\nfunction toString(str) {\r\n    if (str) {\r\n        return str;\r\n    } else {\r\n        if (_.isDate(str) || _.isNumber(str)) {\r\n            return str;\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 型判定\r\n * @param type 型名（String,Number,Boolean,Date,Error,Array,Function,RegExp,Object）\r\n * @param obj 判定したいオブジェクト\r\n */\r\nfunction is(type, obj) {\r\n    var clas = Object.prototype.toString.call(obj).slice(8, -1);\r\n    return obj !== undefined && obj !== null && clas === type;\r\n}\r\n\r\n/**\r\n * null,undefined を指定した文字列に変換する。デフォルト空文字\r\n * @param value 変換対象文字列\r\n * @param target 変換文字列\r\n * */\r\nfunction replaceStr(value,target){\r\n    if(value === undefined || value === null){\r\n        var replaceStr = \"\";\r\n        if(target !== undefined && target !== null){\r\n            replaceStr = target;\r\n        }\r\n        return replaceStr\r\n    }\r\n    return value;\r\n}\r\n\r\nfunction getTemplatePath(dataPath) {\r\n    return _GH.PATH_TYPE.TEMPLATE + dataPath.filename;\r\n}\r\n\r\n// JSON文字列をJSONオブジェクトに変更する。\r\n// 安全のため、直接JSON.parseを実行せず、これを呼び出すこと。\r\nfunction parseJSON(json) {\r\n    if (!json) {\r\n        return {};\r\n    } else {\r\n        try {\r\n            return window.dhx4.s2j(json);\r\n        } catch (e) {\r\n            console.log(\"JSONのパースに失敗しました。[%s]\", e.message);\r\n            return {};\r\n        }\r\n    }\r\n}\r\n\r\nfunction getJSONValue(json, key) {\r\n    var parsedJSON;\r\n    if (!json || is(\"String\", json)) {\r\n        parsedJSON = parseJSON(json);\r\n    } else {\r\n        parsedJSON = json;\r\n    }\r\n    console.log(\"json = \", parsedJSON, typeof parsedJSON);\r\n    return parsedJSON[key];\r\n}\r\n\r\n/** ------------------------------------------------\r\n *  ■セッションストレージ用のスクリプト\r\n *   ------------------------------------------------ */\r\n/**\r\n * セッションストレージから指定したキーに対応する値を取得する。\r\n */\r\nfunction getSS(key) {\r\n    var getVal = sessionStorage.getItem(key);\r\n    if (getVal) {\r\n        return getVal;\r\n    } else {\r\n        return \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * セッションストレージに指定したキーと値をセットする。\r\n * @param key\r\n * @param value\r\n */\r\nfunction setSS(key, value) {\r\n    sessionStorage.setItem(key, value);\r\n}\r\n\r\n/**\r\n * セッションストレージに指定したキーに値を追記する。\r\n *\r\n * @param key\r\n * @param value\r\n */\r\nfunction addSS(key, value) {\r\n    var preVal = getSS(key);\r\n    setSS(key, preVal + value);\r\n}\r\n\r\n/**\r\n * セッションストレージから指定したキーの情報を削除する\r\n * @param key\r\n */\r\nfunction deleteSS(key) {\r\n    sessionStorage.removeItem(key);\r\n}\r\n\r\n/** ------------------------------------------------\r\n *  ■URL関連のスクリプト\r\n *   ------------------------------------------------ */\r\n/**\r\n * ハッシュをパースする。\r\n * ハッシュの構造は#hash_name/1という形式とする。\r\n * 戻りは以下のオブジェクトを返す。\r\n * {\r\n *   hash : hash_name,\r\n *   param : 1\r\n * }\r\n */\r\nfunction getHash() {\r\n    // ハッシュを取得する。「#hash_name/1」\r\n    var ghHash = location.hash;\r\n    // /で分割する(最大２つ）\r\n    var parts = ghHash.split(\"/\", 2);\r\n    // 長さが１の場合は、空文字を追加する。\r\n    if (parts.length == 1) {\r\n        parts.push(\"\");\r\n    }\r\n    return {\r\n        hash : parts[0],\r\n        param : parts[1]\r\n    }\r\n}\r\n/**\r\n * 現在のロケーションから画面種別を取得する。\r\n * @returns\r\n */\r\nfunction getScreenType() {\r\n    return _GH.SCREEN_TYPE.SCHEDULE;\r\n}\r\n/**\r\n * クエリ・ストリングを取得する。\r\n * @param {Object} obj キー：バリューのオブジェクト\r\n * @return POST, GET用のクエリ・ストリング foo=etc&bar=all\r\n */\r\nfunction getQueryString(obj) {\r\n    var str = [];\r\n    for(var p in obj)\r\n      if (obj.hasOwnProperty(p)) {\r\n        str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\r\n      }\r\n    return str.join(\"&\");\r\n}\r\n\r\n/**\r\n * 対象の日付の文字列型を返す\r\n * 引数なしでもOK\r\n * @param date Dateオブジェクト\r\n * @param format 日付の成形フォーマット\r\n * @return 指定フォーマットの文字列\r\n * */\r\nfunction getStrDate(date,format){\r\n    var dt;\r\n    var fmt;\r\n    if(!is(\"Date\",date)){\r\n        dt = new Date();\r\n    }else{\r\n        dt = date;\r\n    }\r\n    if(!is(\"String\",format)){\r\n        fmt = _GH.FORMAT.YMDHMS;\r\n    }else{\r\n        fmt = format;\r\n    }\r\n\r\n    var cal = new dhtmlXCalendarObject();\r\n    return cal.getFormatedDate(fmt, dt);\r\n}\r\n\r\n\r\n/**\r\n * ファイルから取得したJSONデータにヘッダー情報を設定する。\r\n * @param headerPath ヘッダー用のJSONファイルのパス\r\n * @param dataPath サーバより取得したデータ用のJSONファイルのパス\r\n *\r\n * */\r\nfunction replaceJSON(headerPath, dataPath){\r\n    // ファイルからJSONを読み込む\r\n    var jsonHeader = null;\r\n    var _jsonHeaderString = \"\";\r\n    var jsonData = null;\r\n    var _jsonDataString = \"\";\r\n    var replaceJsonString = \"\";\r\n\r\n    jsonHeader = window.dhx4.ajax.getSync(headerPath);\r\n    _jsonHeaderString = jsonHeader.xmlDoc.responseText;\r\n    jsonData = window.dhx4.ajax.getSync(dataPath);\r\n    _jsonDataString = jsonData.xmlDoc.responseText;\r\n\r\n    //ヘッダーを変換\r\n    replaceJsonString = _jsonDataString.replace(_GH.CONVERSION.JSON_HEADER,_jsonHeaderString);\r\n    //Webサイトを変換\r\n    replaceJsonString = replaceJsonString.split(_GH.CONVERSION.WEB_SITE).join(_GH.PATH_TYPE.WEB_SITE);\r\n    //Web会員(一般)アイコンを変換\r\n    replaceJsonString = replaceJsonString.split(_GH.CONVERSION.MEMBER_N).join(_GH.PATH_TYPE.WEB_MEMBER_N);\r\n    //Web会員(プレミアム)アイコンを変換\r\n    replaceJsonString = replaceJsonString.split(_GH.CONVERSION.MEMBER_P).join(_GH.PATH_TYPE.WEB_MEMBER_P);\r\n\r\n    return replaceJsonString;\r\n}\r\n\r\n/**\r\n * ファイルからJSONオブジェクトを生成する。\r\n * @param path JSONファイルのパス\r\n * @return JSONオブジェクト\r\n * */\r\nfunction loadJSON(path){\r\n    // ファイルからJSONを読み込む\r\n    var json = null;\r\n    var jsonString = \"\";\r\n\r\n    json = window.dhx4.ajax.getSync(path);\r\n    jsonString = json.xmlDoc.responseText;\r\n\r\n    return parseJSON(jsonString);\r\n}\r\n\r\n/**\r\n * BASE64をUTF8文字列に変換するメソッド\r\n * @param str\r\n * @returns\r\n */\r\nfunction b64_to_utf8(str) {\r\n    if (!str) return \"\";\r\n    return decodeURIComponent(escape(window.atob(str)));\r\n}\r\n\r\n/**\r\n * オブジェクトから指定したパラメータを取り除く。\r\n * オブジェクトから作ったクローンに対して処理をするので、元のオブジェクトは変更されない。\r\n * @param {Object} obj 要素を取り除く対象となるオブジェクト\r\n * @param {Array} removeParamArray 取り除く要素のキー配列\r\n * @returns 取り除いた後のオブジェクト\r\n */\r\nfunction remove_params_from_object_clone(obj, removeParamArray) {\r\n    if (!_.isObject(obj)) {\r\n        return obj;\r\n    }\r\n    // オブジェクトを壊さないためにクローンを作る。\r\n    var cloneObj = _.cloneDeep(obj);\r\n    _.forEach(removeParamArray, function(key) {\r\n        delete cloneObj[key];\r\n    });\r\n    return cloneObj;\r\n}\r\n\r\n/**\r\n * フォーム値変更チェック。変更されていればtrue\r\n * @param {Object} beforeDataForm 最初のフォームデータ（getFormData()で取得）\r\n * @param {Object} afterDataForm 比較するフォームデータ（getFormData()で取得）\r\n * @param {Array} exceptKeys 比較を除外するキー配列\r\n */\r\nfunction doChangeForm(beforeDataForm, afterDataForm, exceptKeys) {\r\n    var doChange = false;\r\n    if (!_.isObject(beforeDataForm)) {\r\n        return doChange;\r\n    }\r\n    if (!_.isArray(exceptKeys)) exceptKeys = [];\r\n    _.forEach(beforeDataForm, function(beforeVal, key) {\r\n        if (!_.has(exceptKeys, key) && afterDataForm[key] !== beforeVal) {\r\n            doChange = true;\r\n        }\r\n    });\r\n    return doChange;\r\n}\r\n\r\n/**\r\n * 誕生日の算出\r\n * @param {Date} birthday 誕生日\r\n * @param {Date} when 基準日\r\n * @return {String} 年齢\r\n * */\r\nfunction getAge(birthday, when){\r\n    if(!_.isDate(birthday)){\r\n        return \"\";\r\n    }\r\n    if(!_.isDate(when)){\r\n        when = new Date();\r\n    }\r\n    var b = new Date(birthday.getTime()).setFullYear(2000);\r\n    var w = new Date(when.getTime()).setFullYear(2000);\r\n    return when.getFullYear() - birthday.getFullYear() - (w >= b ? 0: 1);\r\n}\r\n/**\r\n * Cookieを設定する。\r\n * デフォルトでExpiredを設定する。\r\n * @param name {String} Cookei名\r\n * @param value {String} Cookieの値\r\n */\r\nfunction setGhCookie(name, value){\r\n    var expire = new Date();\r\n    expire.setTime(_GH.COOKIE.EXPIRE);\r\n    document.cookie = name + \"=\" + encodeURIComponent(value) + \";expires=\" + expire.toUTCString();\r\n}\r\n\r\n/**\r\n * クッキー情報をオブジェクトとして返す\r\n * @return {Array} クッキー情報\r\n * */\r\nfunction getCookies()\r\n{\r\n    var result = [];\r\n    var textCookies = document.cookie;\r\n    if( textCookies != \"\" )\r\n    {\r\n        var cookies = textCookies.split( \"; \" );\r\n\r\n        for( var i = 0; i < cookies.length; i++ )\r\n        {\r\n            var cookie = cookies[ i ].split( \"=\" );\r\n            try{\r\n                // クッキーの名前をキーとして 配列に追加する\r\n                result[ cookie[ 0 ] ] = decodeURIComponent( cookie[ 1 ] );\r\n            } catch(e){\r\n                if (!e instanceof URIError){\r\n                    throw e;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/** ------------------------------------------------\r\n *  ■DHTMLXの補助的なメソッド\r\n *   ------------------------------------------------ */\r\n/**\r\n * DHTMLXのグリッドで、指定した行を有効／無効に切り替える。\r\n */\r\nfunction disableDhtmlxGridRow(dhtmlxGrid, rowNo, disable) {\r\n    if (!is(\"Object\", dhtmlxGrid)) {\r\n        return;\r\n    }\r\n    for(var i=0; i < dhtmlxGrid.getRowsNum(); i++){\r\n        dhtmlxGrid.cells2(i, rowNo).setDisabled(disable);\r\n    }\r\n}\r\n\r\n/**\r\n * 配列型のクエリパラメータを作成する。\r\n * @param {String} name 項目名\r\n * @param {Array} values 値の配列\r\n * @returns クエリ（name=value&name=value&・・・）\r\n */\r\nfunction getArrayQueryParam(name, values) {\r\n    var query = \"\";\r\n    _.forEach(values, function(value) {\r\n    \tif(value != \"\"){ //dont add to queryString if it's null\r\n    \t\tquery += name + \"=\" + value + \"&\";\r\n    \t}\r\n    });\r\n    return query;\r\n}\r\n\r\n/**\r\n * フォーム値の大小を比較して、正しい順番にセットする。\r\n * @param {Object} dhxForm 検査するフォームオブジェクト\r\n * @param {String} fromName 開始の項目名\r\n * @param {String} toName 終了の項目名\r\n */\r\nfunction swapDhtmlxFormVal(dhxForm, fromName, toName) {\r\n    if (!_.isObject(dhxForm)) {\r\n        return;\r\n    }\r\n    var tempFrom = dhxForm.getItemValue(fromName);\r\n    var tempTo = dhxForm.getItemValue(toName);\r\n    // どちらかが空文字であれば、処理しない\r\n    if (tempFrom === \"\" || tempTo === \"\") {\r\n        return;\r\n    }\r\n\r\n    if ((_.isDate(tempFrom) || _.isNumber(tempFrom)) && ( _.isDate(tempTo) || _.isNumber(tempFrom))) {\r\n        if (tempFrom > tempTo) {\r\n            dhxForm.setItemValue(fromName, tempTo);\r\n            dhxForm.setItemValue(toName, tempFrom);\r\n        }\r\n    } else if (_.isString(tempFrom) && _.isString(tempTo)) {\r\n        if (tempFrom.match(/^[0-9]+$/i)) {\r\n            tempFrom = _.parseInt(tempFrom);\r\n        }\r\n        if (tempTo.match(/^[0-9]+$/i)) {\r\n            tempTo = _.parseInt(tempTo);\r\n        }\r\n        if (tempFrom > tempTo) {\r\n            dhxForm.setItemValue(fromName, tempTo.toString());\r\n            dhxForm.setItemValue(toName, tempFrom.toString());\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * DHTMLXのFormのTemplateのフォーマット用関数\r\n * @param name\r\n * @param value\r\n * @returns {指定フォーマットの文字列}\r\n */\r\nfunction doDateFormatYyyymmdd(name, value) {\r\n    if (_.isDate(value)) {\r\n        return getStrDate(value, \"%Y/%m/%d\");\r\n    } else {\r\n        if (_.isEmpty(value)) value = \"\";\r\n        return value.substring(0, 10);\r\n    }\r\n}\r\n\r\n/**\r\n * Web会員ステータスから顧客メインに表示する情報を返す。\r\n * @param name\r\n * @param value\r\n * @returns {指定フォーマットの文字列}\r\n */\r\nfunction doWebMenberFormat(name, value) {\r\n    var webStatus = _.parseInt(value);\r\n    if (webStatus === 3) {\r\n     // プレミアム会員\r\n        return \"<img src='./imgs/premium_icon.gif' /><span style='font-weight:bold'>Web会員登録</span>\";\r\n    } else if (webStatus > 0 && webStatus < 5) {\r\n        // 通常会員(通常会員、プレミアム申請中、プレミアム否認）\r\n        return \"<img src='./imgs/world.png' /><span style='font-weight:bold'>Web会員登録</span>\";\r\n    } else {\r\n        // 非会員\r\n        return \"Web会員未登録\";\r\n    }\r\n}\r\n\r\n/**\r\n * レコメンドの物件の文章１を取得する。\r\n * @param recommend レコメンド物件情報\r\n * @param useHtml htmlで修飾するかどうか\r\n * @returns\r\n */\r\nfunction getRecommendProdSentence1(recommend, useHtml) {\r\n    var arrangeText = function(str) {\r\n        return useHtml? \"<span style='color:red;'>\" + str + \"</span>\": str;\r\n    };\r\n    var yyyyMMdd = function(obj){\r\n        var startDate = new Date(obj.genbaStartDate);\r\n        return d2sAsMMdd(startDate);\r\n    };\r\n    var buildingType = function(obj) {\r\n        if (_.endsWith(obj.houseType, \"マンション\")) {\r\n            return \"MS\";\r\n        } else if (_.endsWith(obj.houseType ,\"土地\")) {\r\n            var val = \"\";\r\n            if (_.startsWith(obj.buildingCondition, \"建築条件\")) {\r\n                val = \"条付\";\r\n            }\r\n            return val + \"土地\";\r\n        } else if (_.endsWith(obj.houseType, \"戸建\")) {\r\n            var house = \"戸建\";\r\n            var cond = \"\";\r\n            if (obj.buildingType === \"中古一戸建\") {\r\n                house = \"中古\";\r\n            } else if (obj.buildingType === \"新築一戸建\") {\r\n                house = \"新築\";\r\n            }\r\n            if (obj.landRight === \"借地権のみ\" || obj.landRight === \"所有権・借地権混在\") {\r\n                cond = \"(借)\";\r\n            }\r\n            return arrangeText(house) + cond;\r\n        } else {\r\n            return \"\";\r\n        }\r\n    };\r\n    var floorPlan = function(obj) {\r\n        if (_.endsWith(obj.houseType ,\"土地\")) {\r\n            return \"\";\r\n        } else {\r\n            var typeS = (_.isEmpty(obj.floorTypeS) || obj.floorTypeS == \"未選択\")? \"\": obj.floorTypeS;\r\n            return obj.roomNumber + obj.floorType + typeS;\r\n        }\r\n    };\r\n    var area = function(obj) {\r\n        var val = \"土地\" + obj.landArea + \"㎡\";\r\n        if (_.endsWith(obj.houseType, \"戸建\")) {\r\n            val += \" 延床\" + obj.buildingArea + \"㎡\";\r\n        }\r\n        return val;\r\n    };\r\n    var complete = function(obj) {\r\n        return (obj.completeFlg == 1)? \"完\": \"\";\r\n    };\r\n    return [yyyyMMdd(recommend),\r\n            buildingType(recommend),\r\n            complete(recommend),\r\n            arrangeText(recommend.price + \"万\"),\r\n            arrangeText(floorPlan(recommend)),\r\n            area(recommend)\r\n            ].join(\" \");\r\n}\r\n\r\n/**\r\n * レコメンドの物件の文章２を取得する。\r\n * @param recommend レコメンド物件情報\r\n * @param useHtml htmlで修飾するかどうか\r\n * @returns\r\n */\r\nfunction getRecommendProdSentence2(recommend, useHtml) {\r\n    var clean = function(str) {\r\n        return (str)? str : \"\";\r\n    };\r\n    var arrangeText = function(str) {\r\n        return useHtml? \"<span style='color:red;'>\" + clean(str) + \"</span>\": clean(str);\r\n    };\r\n    var address = function(obj) {\r\n        var lastAddress = _.isString(obj.address4)? clean(obj.address4).split(\"丁目\").join(\"\"): clean(obj.address4);\r\n\r\n        return arrangeText(obj.address1) + clean(obj.address3) + lastAddress;\r\n    };\r\n    var locomotion = function(obj) {\r\n        if (obj.locomotion1 === \"徒歩\") {\r\n            return obj.locomotion1 + obj.walk1 + \"分\";\r\n        } else if (obj.locomotion1 === \"バス\") {\r\n            return obj.locomotion1 + obj.busTime1 + \"分\";\r\n        } else {\r\n            return \"\";\r\n        }\r\n    };\r\n    var station = function(obj) {\r\n        return (obj.station1)? \"「\" + arrangeText(obj.station1) + \"」駅\": \"\";\r\n    };\r\n    return [\r\n            address(recommend),\r\n            recommend.railway1,\r\n            station(recommend),\r\n            locomotion(recommend),\r\n            recommend.infoServiceCompany\r\n        ].join(\" \");\r\n}\r\n/**\r\n * スケジュール登録時に必要な対応履歴情報をセットする。\r\n * @param dhxSchedForm\r\n */\r\nfunction setActDataOfSchedule(dhxSchedForm) {\r\n    var actType = 5;\r\n    dhxSchedForm.setItemValue(\"actType\", actType);\r\n    dhxSchedForm.setItemValue(\"actTypeDetail\", convertScheduleStatusToActTypeDetail(dhxSchedForm.getItemValue(\"scheduleStatus\")));\r\n    dhxSchedForm.setItemValue(\"actMemo\", dhxSchedForm.getItemValue(\"memo\"));\r\n}\r\n\r\n/**\r\n * スケジュール登録時に必要な対応履歴情報をセットする。\r\n * TODO 上記のメソッドと合わせたい。\r\n * @param event\r\n */\r\nfunction setActDataOfScheduleEvent(event) {\r\n    var actType = 5;\r\n    event.actType = actType;\r\n    event.actTypeDetail = convertScheduleStatusToActTypeDetail(event.scheduleStatus);\r\n    event.actMemo = event.memo;\r\n}\r\n\r\n/**\r\n * スケジュール種別を対応履歴詳細に変換する。\r\n * @param scheduleStatus\r\n * @returns {Number}\r\n */\r\nfunction convertScheduleStatusToActTypeDetail(scheduleStatus) {\r\n    var actTypeDetail = 0;\r\n    if (!scheduleStatus) scheduleStatus = 0;\r\n    var status = _.parseInt(scheduleStatus);\r\n    switch(status) {\r\n        case 1:\r\n            actTypeDetail = 10;\r\n            break;\r\n        case 2:\r\n            actTypeDetail = 11;\r\n            break;\r\n        case 3:\r\n            actTypeDetail = 12;\r\n            break;\r\n    }\r\n    return actTypeDetail;\r\n}\r\n\r\n/**\r\n * 担当者へ顧客情報を転送するための本文を生成する。\r\n * @param dhxForm\r\n * @returns {String}\r\n */\r\nfunction getPersonalInfoAsText(dhxForm) {\r\n    var dataForClip = {};\r\n    _.forEach(_GH.S03F030TRANS.KEYS, function(label, key){\r\n        // キーが存在した場合のみ値を設定する。\r\n        var value = dhxForm.getItemValue(key);\r\n        switch(dhxForm.getItemType(key)) {\r\n            case \"input\":\r\n                break;\r\n            case \"select\":\r\n                var selectItem = dhxForm.getSelect(key);\r\n                value = selectItem.options[selectItem.selectedIndex].text;\r\n                break;\r\n            case \"calendar\":\r\n                value = getStrDate(value, _GH.FORMAT.YMD);\r\n                break;\r\n            case \"checkbox\":\r\n                if (dhxForm.isItemChecked(key)) {\r\n                    value = 1;\r\n                } else {\r\n                    value = 0;\r\n                }\r\n                break;\r\n            case \"hidden\":\r\n                break;\r\n            default: // その他のタイプは表示しない。hidden, buttonなど。\r\n                value = \"\";\r\n                break;\r\n        }\r\n        dataForClip[key] = value;\r\n    });\r\n    return getPersonalInfoText(dataForClip);\r\n}\r\n/**\r\n * SFAへのリンクを返す。\r\n */\r\nfunction getGHPersonalLink(personalId) {\r\n    return window.location.protocol + \"//\" + window.location.host + \"/GH_CLIENT/\" + _GH.PATH_TYPE.CS_MAIN + personalId;\r\n}\r\n/**\r\n  * 顧客情報のテキストを取得する。\r\n  * クリップボードにコピーや担当者に転送で利用する。\r\n  *\r\n  * @param {Object} dataForClip テンプレートに入れるためのデータ\r\n  */\r\nfunction getPersonalInfoText(dataForClip) {\r\n    var header = \"\\\r\nお疲れ様です。${myName}です。\\r\\n\\\r\n候補者情報を転送します。\\r\\n\\\r\n\\r\\n\\\r\n\";\r\n    return getPersonalInfoTextWithHeader(header, dataForClip);\r\n}\r\n\r\nfunction getPersonalInfoTextWithHeader(header, dataForClip){\r\n    var template = _.template(header + _GH.TRANSFER_MESSAGE_TEMPLATE);\r\n\r\n    var transFlg = function(f){\r\n        return f == 1 ? \"○\" : \"×\";\r\n    };\r\n\r\n    var context = {\r\n        personalId: dataForClip[\"personalId\"],\r\n        GHLink : getGHPersonalLink(dataForClip[\"personalId\"]),\r\n        webMemberId: dataForClip[\"webMemberId\"],\r\n        myName: _ghUser.getName(),\r\n        lastNameKana: dataForClip[\"lastNameKana\"],\r\n        firstNameKana: dataForClip[\"firstNameKana\"],\r\n        lastName: dataForClip[\"lastName\"],\r\n        firstName: dataForClip[\"firstName\"],\r\n        relation: dataForClip[\"relation\"],\r\n        employFullName: dataForClip[\"employFullName\"],\r\n        mobileTel: dataForClip[\"mobileTel\"],\r\n        nowAdrTel: dataForClip[\"nowAdrTel\"],\r\n        offAdrTel: dataForClip[\"offAdrTel\"],\r\n        pcEmail: dataForClip[\"pcEmail\"],\r\n        mobileEmail: dataForClip[\"mobileEmail\"],\r\n        birthday: dataForClip[\"birthday\"],\r\n        gender: dataForClip[\"gender\"],\r\n        schoolName: dataForClip[\"schoolName\"],\r\n        schoolDepartment: dataForClip[\"schoolDepartment\"],\r\n        schoolSubject: dataForClip[\"schoolSubject\"],\r\n        judgeInterviewStatus: _prop.getPropName(_GH.CODE_DEF.STATUS, dataForClip[\"judgeInterviewStatus\"]),\r\n        prospectiveImpCode: dataForClip[\"prospectiveImpCode\"],\r\n        empCode: dataForClip[\"empCode\"],\r\n        jobType: dataForClip[\"jobType\"],\r\n        jobTypeTech: dataForClip[\"jobTypeTech\"],\r\n        club: dataForClip[\"club\"],\r\n        circle: dataForClip[\"circle\"],\r\n        workedNumber: dataForClip[\"workedNumber\"],\r\n        latestCompany: dataForClip[\"latestCompany\"],\r\n        latestStartDate: doDateFormatYyyymmdd(\"\", dataForClip[\"latestStartDate\"]),\r\n        latestEndDate: doDateFormatYyyymmdd(\"\", dataForClip[\"latestEndDate\"]),\r\n        latestBelongType: dataForClip[\"latestBelongType\"],\r\n        latestBusinessType: dataForClip[\"latestBusinessType\"],\r\n        latestJobType: dataForClip[\"latestJobType\"],\r\n        latestEmpPattern: dataForClip[\"latestEmpPattern\"],\r\n        selectionDeclinationFlag: dataForClip[\"selectionDeclinationFlag\"],\r\n        divisionName: dataForClip[\"divisionName\"],\r\n        recruitStatus: _prop.getPropName(_GH.CODE_DEF.STATUS, dataForClip[\"recruitStatus\"]),\r\n        entryDate: _ghUser.isNon()? doDateFormatYyyymmdd(\"\", dataForClip[\"entryDate\"]): null\r\n    };\r\n    return template(context);\r\n}\r\n\r\n/**\r\n * 顧客ランク用のソートメソッド\r\n */\r\nfunction sortPersonalRank(a,b,order){\r\n    var n = (a === \"★なし\")? 0: a.length;\r\n    var m =(b === \"★なし\")? 0: b.length;\r\n    if(order==\"asc\")\r\n        return n>m?1:-1;\r\n    else\r\n        return n<m?1:-1;\r\n}\r\n\r\n/**\r\n * 日付のみを整形して返す\r\n * @param date 日付\r\n */\r\nfunction yyyyMMdd(date){\r\n    return date.getFullYear() + \"/\" + (date.getMonth() + 1) + \"/\" + date.getDate();\r\n}\r\n\r\n/**\r\n * 日付のみを整形して返す\r\n * @param date 日付\r\n */\r\nfunction d2sAsMMdd(date){\r\n    return (date.getMonth() + 1) + \"/\" + date.getDate();\r\n}\r\n\r\nfunction getServerDatetimeString(date) {\r\n    if (_.isDate(date)) {\r\n        return window.dhx4.date2str(date, \"%Y/%m/%d %H:%i:%s\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n}\r\n/**\r\n * 現在日から指定した月数、日数を加算した日付オブジェクトを返す。\r\n * @param month\r\n * @param day\r\n */\r\nfunction getAfterDate(month, day) {\r\n    var date = new Date();\r\n    if (_.isNumber(month)) {\r\n        date.setMonth(date.getMonth() + month);\r\n    }\r\n    if (_.isNumber(day)) {\r\n        date.setDate(date.getDate() + day);\r\n    }\r\n    return date;\r\n}\r\n\r\n/**\r\n * 安全に文字列を半角カンマでスプリットします。\r\n * @param str スプリットしたい文字列\r\n * @param isInt Int型にキャストするかどうか。デフォルトはfalse\r\n */\r\nfunction safeCommaSplit(str, isInt) {\r\n    if (_.isString(str) && _.trim(str, \" ,\").length > 0) {\r\n        var split = str.split(\",\");\r\n        return (isInt)?\r\n            _.transform(split, function(result, n) {result.push(_.parseInt(n));}):\r\n            split;\r\n    } else {\r\n        return [];\r\n    }\r\n}\r\n/**\r\n * Font AwesomeのHTMLタグを取得する。\r\n * @param name\r\n * @param isSmall\r\n */\r\nfunction getFontWesome(name, isSmall) {\r\n    if (_.isEmpty(name)) {\r\n        return \"\";\r\n    } else {\r\n        name = (_.startsWith(name, \"fa-\"))? name: \"fa-\" + name;\r\n        if (isSmall) {\r\n            return \"<i class='fa \" + name + \"'></i> \";\r\n        } else {\r\n            return \"<i class='fa \" + name + \" fa-2x'></i> \";\r\n        }\r\n    }\r\n}\r\n/**\r\n * DHXMLのFormオブジェクトの値をリセットする\r\n * @param {Object} dhxForm リセットしたいFormオブジェクト\r\n * @param {Array} exceptKeys リセットを除外したいキー配列\r\n */\r\nfunction resetDhxFormItemValues(dhxForm, exceptKeys) {\r\n    if (_.isObject(dhxForm)) {\r\n        if (!_.isArray(exceptKeys)) {\r\n            exceptKeys = [];\r\n        }\r\n        var dataset = {};\r\n        _.forEach(dhxForm.getFormData(), function(value, key) {\r\n            // 除外キー配列に値が入っていなければ消す。\r\n            if (_.indexOf(exceptKeys, key) < 0) {\r\n                dataset[key] = \"\";\r\n            }\r\n        });\r\n        dhxForm.setFormData(dataset);\r\n    }\r\n}\r\n/**\r\n * 選択したランクに合わせて、メールステータスをおすすめのものに変える。\r\n * @param dhxForm 顧客情報が入ったFormオブジェクト\r\n * @param newRankVal 変更後のランク\r\n */\r\nfunction setRecommendMailStatusAlongWithRank(dhxForm, newRankVal) {\r\n    if (_ghUser.isExp()) return; // MSは処理しない。\r\n    // クレームの場合は処理しない\r\n    if (_.parseInt(dhxForm.getItemValue(\"personalstatus\")) === _GH.S03F010CM.CUST_CLAIM) return;\r\n    // ランクが1,0は対象としない。\r\n    var newRank = _.parseInt(newRankVal);\r\n    if (newRank <= _GH.S03F010CM.RANK_NOUSE) return;\r\n    var currentMailStatus = _.parseInt(dhxForm.getItemValue(\"emailstatus\"));\r\n    // メール許可NGの場合は対象としない。\r\n    if (currentMailStatus == _GH.S03F010CM.MAIL_NONE) return;\r\n    var recommendMailStatus = (newRank > _GH.S03F010CM.RANK_STD)?\r\n            _GH.S03F010CM.MAIL_SINGLE: _GH.S03F010CM.MAIL_PROXY;\r\n    // 現在のレコメンドステータスと変更後のメールステータスが違う場合、ユーザに問う\r\n    if (currentMailStatus !== recommendMailStatus) {\r\n        var msg = (recommendMailStatus === _GH.S03F010CM.MAIL_SINGLE)?\r\n                \"個別メールのみOK に変更しますか？\": \"代行メール送信も全てOK に変更しますか？\";\r\n        if (confirm(msg)) {\r\n            dhxForm.setItemValue(\"emailstatus\", recommendMailStatus);\r\n        }\r\n    }\r\n}\r\n/**\r\n * ビット演算で格納された複数選択の値を分解して、チェックボックスに値をセットする。\r\n * 使用するのは間取り（現時点ではfloorplanのみ）\r\n * ■処理イメージ\r\n//            var floorPlan = recCondInfo[\"floorPlan\"];\r\n//            if ((floorPlan & 7) !== 0) {\r\n//                recCondInfo[\"floorPlan7\"] = true;\r\n//            }\r\n//            if ((floorPlan & 8) !== 0) {\r\n//                recCondInfo[\"floorPlan8\"] = true;\r\n//            }\r\n//            if ((floorPlan & 16) !== 0) {\r\n//                recCondInfo[\"floorPlan16\"] = true;\r\n//            }\r\n//            if ((floorPlan & 32) !== 0) {\r\n//                recCondInfo[\"floorPlan32\"] = true;\r\n//            }\r\n * ■上記の場合の呼び出しイメージ\r\n * setBitOperationValueAtCheckbox(recCondInfo, \"floorPlan\", [7, 8, 16, 32]);\r\n *\r\n * @param keyValObj Formのキー：バリューが入ったオブジェクト\r\n * @param bitValueKey ビット演算で計算された値のキー。このキーとビット値を連結したものが、チェックボックスの名前（キー）になる。\r\n * @param valueArray ビット値の数値配列\r\n */\r\nfunction setBitOperationValueAtCheckbox(keyValObj, bitValueKey, valueArray) {\r\n    // そもそもオブジェクトがない場合は処理を終える。\r\n    if (_.isEmpty(keyValObj) || _.isEmpty(bitValueKey)) return;\r\n    // ビット値を取り出す。\r\n    var bitValue = _.parseInt(keyValObj[bitValueKey]);\r\n    _.forEach(valueArray, function(value) {\r\n        // ビット値に含まれるかどうかをチェックし、含まれていればチェックボックスをONにする。\r\n        if ((bitValue & value) !== 0) {\r\n            keyValObj[bitValueKey + value] = true;\r\n        } else {\r\n            keyValObj[bitValueKey + value] = false;\r\n        }\r\n    });\r\n}\r\n/**\r\n * チェックボックスの値をビット演算して返す。\r\n * 使用するのは間取り（現時点ではfloorplanのみ）\r\n *\r\n * @param dhxForm DHXML Formオブジェクト（チェックボックスとその値を格納するHidden項目が含まれる）\r\n * @param bitValueKey ビット演算で計算が格納される項目のキー（ビット演算結果を格納するHidden項目）。このキーとビット値を連結したものが、チェックボックスの名前（キー）になる。\r\n * @param valueArray ビット値の数値配列\r\n * @returns {Number} ビット演算結果\r\n */\r\nfunction getBitOperationValueInCheckbox(dhxForm, bitValueKey, valueArray) {\r\n    var bitValue = 0;\r\n    _.forEach(valueArray, function(value) {\r\n        var chkName = bitValueKey + value;\r\n        bitValue += dhxForm.isItemChecked(chkName)? _.parseInt(dhxForm.getItemValue(chkName)) : 0;\r\n    });\r\n    return bitValue;\r\n}\r\n\r\n/**\r\n * 文字列で\"null\"と入っているものを null に変換。\"null\"をcalendarに入れると表示がおかしくなるなど、不都合がある際に使用。\r\n *\r\n * @param data      変換対象\r\n * @returns {Object} 変換後の値\r\n */\r\nfunction transNull(data){\r\n    var ret = _.transform(data, function(result, value, key){\r\n        if(value === \"null\"){\r\n            // 日付などがおかしくなるため変換\r\n            value = null;\r\n        }\r\n        result[key] = value;\r\n    });\r\n    return ret;\r\n}\r\n/**\r\n * 引数を安全に数値型にする。\r\n * 全角は半角に変換されてから、Int型にパースされる。\r\n * デフォルト値の指定がなければ、0が入る。\r\n *\r\n * @param num 数値にしたい変数\r\n * @param defaultValue デフォルト値。指定がなければ0\r\n */\r\nfunction toNumberSafety(num, defaultValue) {\r\n    var number = _.parseInt(toHankaku(num));\r\n    if (_.isNaN(number)) {\r\n        number = _.parseInt(defaultValue);\r\n        if (_.isNaN(number)) number = 0;\r\n    }\r\n    return number;\r\n}\r\n\r\n/**\r\n * 一斉メールやDM、担当者変更画面に表示されるグリッドを調整する。\r\n * @param cell\r\n * @param csListName\r\n */\r\nfunction resizeGridListInLayoutCell(cell, csListName) {\r\n    if (_.isEmpty(csListName)) csListName = \"csList\";\r\n    var gridObject = document.getElementById(csListName);\r\n    if(!_.isEmpty(gridObject)) {\r\n        gridObject.style.width = (cell.getWidth() - 15) + \"px\";\r\n        gridObject.style.height = (cell.getHeight() - 114) + \"px\";\r\n    }\r\n}\r\n\r\n/**\r\n * Formのセレクトのオプションから不要な値を除く。\r\n * @param options オプションオブジェクト。_prop.getOptions(xxx)の結果。\r\n * @param removeValueArray 取り除く値の配列。[1,2,3]\r\n */\r\nfunction removePropOptions(options, removeValueArray) {\r\n    if (_.isEmpty(options) || !_.isArray(removeValueArray)) {\r\n        return; // そのまま返す。\r\n    } else {\r\n        _.remove(options, function(opt) {\r\n            return _.indexOf(removeValueArray, _.parseInt(opt.value)) >= 0;\r\n        });\r\n        return options;\r\n    }\r\n}\r\n\r\n/**\r\n * 顧客情報のマスキングが必要かどうかを判断する。\r\n * @param personalEmployeeId 顧客の担当者ID\r\n * @param divisionId 顧客の組織ID\r\n */\r\nfunction needMaskCunstomerInfo(personalEmployeeId, divisionId) {\r\n    if (_ghUser.isShien() || _ghUser.isMSReform()) {\r\n        // 戸建（反響ツリーで絞られているため）、営業支援、オーダーシステム課はマスキングは必要なし\r\n        return false;\r\n    }\r\n    if (_ghUser.hasManDivision(divisionId)) {\r\n        // 自分の権限の範囲なら、マスキングは必要なし\r\n        return false;\r\n    }\r\n    if (personalEmployeeId == _ghUser.getGhId()) {\r\n        // 自分の顧客ならば、マスキングは必要なし\r\n        return false;\r\n    }\r\n    // 顧客が課担当なし\r\n    if (personalEmployeeId == 0) {\r\n        if (_ghUser.isNon()) {\r\n            // 戸建の場合は担当無しは操作可能\r\n            return false;\r\n        } else if (_ghUser.getDivisionId() == divisionId) {\r\n            // MSの場合は、自分の所属であればマスキングは必要なし\r\n            return false;\r\n        }\r\n    }\r\n    // ここまでに該当がなければマスキングする。\r\n    return true;\r\n}\r\n\r\n/**\r\n * [ユーティリティ関数] メールアドレスを含むFormDataからメールアドレスを取得する。\r\n * @param {Object} personalInfo 顧客情報FormのFormData（DHTMLXFormのgetFormData()をしたもの）\r\n * @return メールアドレスのセミコロン区切り\r\n */\r\nfunction getSendEmailsFromCustInfo(personalInfo) {\r\n    var tempToAddress = \"\";\r\n    for (var i = 1; i <= 3; i++) {\r\n        if (!_.isEmpty(personalInfo[\"email\" + i]) && personalInfo[\"emailsendableflg\" + i] == 1) {\r\n            tempToAddress += personalInfo[\"email\" + i] + \";\";\r\n        }\r\n    }\r\n    return tempToAddress;\r\n}\r\n/**\r\n * 与えられた文字列を半角に変換します。\r\n * @param str\r\n * @returns\r\n */\r\nfunction toHankaku(str) {\r\n    if (_.isNumber(str)) {\r\n        return str;\r\n    } else if (_.isEmpty(str)) {\r\n        return \"\";\r\n    } else {\r\n        var hen = str.replace(/[！-～]/g,function(s){\r\n            return String.fromCharCode(s.charCodeAt(0)-0xFEE0);\r\n        });\r\n        return hen;\r\n    }\r\n}\r\n\r\n/**\r\n * 全角のハイフンを半角にします\r\n * @param str\r\n * @returns\r\n */\r\nfunction toHankakuHyphen(str){\r\n    str = str.replace(/[―‐－ー]/g, '-');\r\n    return str;\r\n}\r\n\r\n/**\r\n * ハイフンを取り除きます。\r\n * @param str\r\n * @returns\r\n */\r\nfunction removeTelephoneHyphen(str) {\r\n    var tel = str.replace(/^([0-9\\-]+)$/g,function(s){\r\n        return str.split(\"-\").join(\"\");\r\n    });\r\n    return tel;\r\n}\r\n\r\n/**\r\n * 住所から郵便番号を逆引きして、設定する。\r\n * すでに郵便番号を持っている場合は何もしない。\r\n * @param personalForm 顧客詳細情報をもつDhtmlx Formオブジェクト\r\n */\r\nfunction setZipCodeFromAddress(personalForm) {\r\n    // すでに郵便番号が入っていれば無視\r\n    if (personalForm.getItemValue(\"zipcode\").length > 0) {\r\n        return;\r\n    }\r\n    if (personalForm.getItemValue(\"otherAddress\").length > 0) {\r\n        var address = personalForm.getItemValue(\"address\") + personalForm.getItemValue(\"otherAddress\");\r\n        // 住所を半角に変換して、最初の数値のところで切り落とす。（「練馬区春日町１－１」→「練馬区春日町」）\r\n        address = toHankaku(address);\r\n        var numIndex = address.indexOf(address.match(/\\d/));\r\n        if (numIndex > 0) address = address.substring(0, numIndex);\r\n        var zipInfo = getJSONSync(\"zip/address/\" + address);\r\n        if (zipInfo.length === 0) {\r\n            dhtmlx.message({text: address + \"に該当する住所がありませんでした。\"});\r\n        } else if (zipInfo.length === 1) {\r\n            var zip = zipInfo[0];\r\n            personalForm.setItemValue(\"zipcode\", zip.zipCode);\r\n            personalForm.setItemValue(\"prefecture\", zip.prefecture);\r\n            personalForm.setItemValue(\"address\", zip.city);\r\n        } else {\r\n            var addressCandidate = [];\r\n            _.forEach(zipInfo, function(zip) {\r\n                addressCandidate.push(zip.prefecture + zip.city + zip.town);\r\n            });\r\n            addressCandidate = _.slice(addressCandidate, 0, 5); // 最大５件とする。\r\n            dhtmlx.message({text: address + \"に該当する住所が複数取得されました。もっと絞り込んでください。<BR>\" + addressCandidate.join(\"<BR>\")});\r\n        }\r\n    }\r\n}\r\n/** ------------------------------------------------\r\n *  ■画像アップロードの補助的なメソッド\r\n *   ------------------------------------------------ */\r\nfunction convertOtherImageToOwn(originalImage){\r\n    var URL = $(originalImage).attr(\"src\");\r\n\r\n    var readImg = new Image();\r\n    readImg.crossOrigin = \"Anonymous\";\r\n    var def = $.Deferred();\r\n    readImg.onload = function() {\r\n        var readCanvas = $(\"<canvas>\");\r\n        readCanvas[0].width = this.naturalWidth;\r\n        readCanvas[0].height = this.naturalHeight;\r\n        var readCtx = readCanvas[0].getContext(\"2d\");\r\n        readCtx.drawImage(this, 0, 0);\r\n        var data = readCanvas[0].toDataURL(\"image/jpeg\", 1.0);\r\n\r\n        // FormDataに縮小後の画像データを追加する\r\n        // Blob形式にすることで、サーバ側は従来のままのコードで対応可能\r\n        var blob = dataURLtoBlob(data);\r\n        var fd = new FormData();\r\n        fd.append(\"file\", blob, \"uploadImage.jpg\");\r\n\r\n        // フォームの全ての入力値をFormDataに追加\r\n//        var formAry = $(\"form\").serializeArray()\r\n//        $.each(formAry, function(i, field){\r\n//            fd.append(field[\"name\"], field[\"value\"]);\r\n//        });\r\n\r\n        $.ajax({\r\n            url: \"/imageFile-upload.php?mode=html5&SFA_USER_ID=\" + _ghUser.getGhId(),\r\n            type: \"POST\",\r\n            data: fd,\r\n            dataType: \"json\",\r\n            contentType: false,\r\n            processData: false,\r\n            async: false,\r\n            complete: function(data){\r\n                $(originalImage).attr({\"src\":JSON.parse(data.responseText).name, \"title\":JSON.parse(data.responseText).extra.hostname});\r\n            }\r\n        });\r\n        def.resolve();\r\n    };\r\n    readImg.onerror = function() {\r\n        $(originalImage).attr({\"src\":\"\", \"alt\":URL});\r\n        console.log(\"エラー\", $(originalImage), originalImage);\r\n        def.reject();\r\n    };\r\n\r\n    readImg.src = URL;\r\n    return def.promise();\r\n}\r\n\r\nfunction dataURLtoArrayBuffer(data) {\r\n    var byteString = atob(data.split(\",\")[1]);\r\n    var ab = new ArrayBuffer(byteString.length);\r\n    var ia = new Uint8Array(ab);\r\n    for (var i = 0; i < byteString.length; i++) {\r\n        ia[i] = byteString.charCodeAt(i);\r\n    }\r\n    return ab\r\n}\r\n\r\nfunction dataURLtoBlob(data) {\r\n    var mimeString = data.split(\",\")[0].split(\":\")[1].split(\";\")[0];\r\n    var ab = dataURLtoArrayBuffer(data);\r\n    var bb = (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder);\r\n    if (bb) {\r\n        bb = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder)();\r\n        bb.append(ab);\r\n        return bb.getBlob(mimeString);\r\n    } else {\r\n        bb = new Blob([ab], {\r\n                \"type\": (mimeString)\r\n        });\r\n        return bb;\r\n    }\r\n}\r\n/**\r\n * 処理待ちメソッド\r\n * 使い方は下記の通り。\r\n    $.wait(2000).done(function(){\r\n        console.log(\"2000ミリ秒待ちました\");\r\n    });\r\n */\r\n$.wait = function(msec) {\r\n    // Deferredのインスタンスを作成\r\n    var d = new $.Deferred;\r\n\r\n    setTimeout(function(){\r\n        // 指定時間経過後にresolveしてdeferredを解決する\r\n        d.resolve(msec);\r\n    }, msec);\r\n\r\n    return d.promise();\r\n};\r\n\r\nfunction initialEffectDate(){\r\n    var initialDate = new XDate();\r\n    var threshold = new XDate();\r\n    threshold.setHours(21);\r\n    threshold.setMinutes(45);\r\n    // 9時45分以降の場合、翌日を入力しておく\r\n    if(initialDate >= threshold){\r\n        initialDate.addDays(1);\r\n    }\r\n    return initialDate.toDate();\r\n}\r\n\r\n// ひらがな文字であるか判別する\r\nfunction isHiraganaCode(c){\r\n  return ((c >= 12353 && c <= 12435) || c == 12445 || c == 12446);\r\n}\r\n\r\n// 全角ひらがなを全角カタカナに変換する\r\nfunction hiraganaCodeToKatakanaCode(src){\r\n  // 引数のチェック\r\n  if(src == null)\r\n    return \"\";\r\n\r\n  var str = new String;\r\n  var len = src.length;\r\n  for(var i = 0; i < len; i++)\r\n  {\r\n    var c = src.charCodeAt(i);\r\n    if(isHiraganaCode(c))\r\n      str += String.fromCharCode(c + 96); // ひらがなをカタカナに変換する\r\n    else\r\n      str += src.charAt(i);\r\n  }\r\n\r\n  return str;\r\n}\r\n\r\nfunction toZenkaku(str){\r\n\t//配列を用意する\r\n\thankaku = [\"ｶﾞ\", \"ｷﾞ\", \"ｸﾞ\", \"ｹﾞ\", \"ｺﾞ\", \"ｻﾞ\", \"ｼﾞ\", \"ｽﾞ\", \"ｾﾞ\", \"ｿﾞ\", \"ﾀﾞ\", \"ﾁﾞ\", \"ﾂﾞ\", \"ﾃﾞ\", \"ﾄﾞ\", \"ﾊﾞ\", \"ﾊﾟ\", \"ﾋﾞ\", \"ﾋﾟ\", \"ﾌﾞ\", \"ﾌﾟ\", \"ﾍﾞ\", \"ﾍﾟ\", \"ﾎﾞ\", \"ﾎﾟ\", \"ｳﾞ\", \"ｧ\", \"ｱ\", \"ｨ\", \"ｲ\", \"ｩ\", \"ｳ\", \"ｪ\", \"ｴ\", \"ｫ\", \"ｵ\", \"ｶ\", \"ｷ\", \"ｸ\", \"ｹ\", \"ｺ\", \"ｻ\", \"ｼ\", \"ｽ\", \"ｾ\", \"ｿ\", \"ﾀ\", \"ﾁ\", \"ｯ\", \"ﾂ\", \"ﾃ\", \"ﾄ\", \"ﾅ\", \"ﾆ\", \"ﾇ\", \"ﾈ\", \"ﾉ\", \"ﾊ\", \"ﾋ\", \"ﾌ\", \"ﾍ\", \"ﾎ\", \"ﾏ\", \"ﾐ\", \"ﾑ\", \"ﾒ\", \"ﾓ\", \"ｬ\", \"ﾔ\", \"ｭ\", \"ﾕ\", \"ｮ\", \"ﾖ\", \"ﾗ\", \"ﾘ\", \"ﾙ\", \"ﾚ\", \"ﾛ\", \"ﾜ\", \"ｦ\", \"ﾝ\", \"｡\", \"｢\", \"｣\", \"､\", \"･\", \"ｰ\", \"ﾞ\", \"ﾟ\"];\r\n\tzenkaku  = [\"ガ\", \"ギ\", \"グ\", \"ゲ\", \"ゴ\", \"ザ\", \"ジ\", \"ズ\", \"ゼ\", \"ゾ\", \"ダ\", \"ヂ\", \"ヅ\", \"デ\", \"ド\", \"バ\", \"パ\", \"ビ\", \"ピ\", \"ブ\", \"プ\", \"ベ\", \"ペ\", \"ボ\", \"ポ\", \"ヴ\", \"ァ\", \"ア\", \"ィ\", \"イ\", \"ゥ\", \"ウ\", \"ェ\", \"エ\", \"ォ\", \"オ\", \"カ\", \"キ\", \"ク\", \"ケ\", \"コ\", \"サ\", \"シ\", \"ス\", \"セ\", \"ソ\", \"タ\", \"チ\", \"ッ\", \"ツ\", \"テ\", \"ト\", \"ナ\", \"ニ\", \"ヌ\", \"ネ\", \"ノ\", \"ハ\", \"ヒ\", \"フ\", \"ヘ\", \"ホ\", \"マ\", \"ミ\", \"ム\", \"メ\", \"モ\", \"ャ\", \"ヤ\", \"ュ\", \"ユ\", \"ョ\", \"ヨ\", \"ラ\", \"リ\", \"ル\", \"レ\", \"ロ\", \"ワ\", \"ヲ\", \"ン\", \"。\", \"「\", \"」\", \"、\", \"・\", \"ー\", \"゛\", \"゜\"];\r\n\t//変換開始\r\n\tfor (i=0; i<=88; i++) { //89文字あるのでその分だけ繰り返す\r\n\t\twhile (str.indexOf(hankaku[i]) >= 0){ //該当する半角カナがなくなるまで繰り返す\r\n\t\t\tstr = str.replace(hankaku[i], zenkaku[i]); //半角カナに対応する全角カナに置換する\r\n\t\t}\r\n\t}\r\n\r\n    return str;\r\n}\r\n\r\nfunction getEstimatedItemLabel(name) {\r\n    if (_.isEmpty(name)) {\r\n        return \"入力値\";\r\n    }\r\n    // 項目IDを小文字に正規化\r\n    name = _.trim(name).toLowerCase();\r\n    if (name.indexOf(\"mail\") >= 0) {\r\n        return \"メールアドレス\";\r\n    } else if (name.indexOf(\"tel\") >= 0) {\r\n        return \"TEL\";\r\n    } else if (name.indexOf(\"address\") >= 0) {\r\n        return \"住所\";\r\n    } else {\r\n        return \"入力値\";\r\n    }\r\n}\r\n\r\n/**\r\n * ライブラリの承認ステータスの翻訳を取得します。\r\n */\r\nfunction getLibraryApprovalStatusName(approvalStatus, approvalFlg) {\r\n    if (approvalStatus == _GH.S05F030Lib.APPROVAL_STATUS.ACCEPT) {\r\n        // 承認済みの場合、ライブラリ承認フラグの値を見る。\r\n        return _prop.getPropName(_GH.CODE_DEF.LIB_APPROVAL_FLG, approvalFlg);\r\n    } else {\r\n        return _prop.getPropName(_GH.CODE_DEF.LIB_APPROVAL_STATUS, approvalStatus);\r\n    }\r\n}\r\n\r\n/**\r\n * 日付が指定した日数の範囲内かどうかをチェックする。\r\n * ※ xDate必須\r\n * @param {Date} date 判定する日付\r\n * @param {Number} dayInt 基準となる日数。過去は＋、未来はー\r\n */\r\nfunction isDateInRange(date, dayInt){\r\n    var today = new XDate();\r\n    var effect = new XDate(date);\r\n    return effect.diffDays(today) < dayInt;\r\n}\r\n\r\nfunction registerEntryEnable(effectDate){\r\n    var today = new XDate();\r\n    var effect = new XDate(effectDate);\r\n    return effect.diffDays(today) >= 7;\r\n}\r\n\r\n/**\r\n * 顧客ステータスが「契約」「クレーム」以外の場合は「追客中」にする。\r\n *\r\n */\r\nfunction resetPersonalStatusIfNotContractOrClaim(personalData) {\r\n    if (_.isEmpty(personalData) || !personalData.personalstatus) {\r\n        return;\r\n    }\r\n    var contractStatus = _prop.getValueFromPropName(_GH.CODE_DEF.STATUS, \"契約\");\r\n    var claimStatus = _prop.getValueFromPropName(_GH.CODE_DEF.STATUS, \"クレーム\");\r\n    if(personalData.personalstatus != contractStatus && personalData.personalstatus != claimStatus){\r\n        var nonContactStatus = _prop.getValueFromPropName(_GH.CODE_DEF.STATUS, \"連絡不可\");\r\n        if (personalData.personalstatus == nonContactStatus) {\r\n            // 連絡不可だった場合は、連絡可能とする。\r\n            personalData.telstatus = 1; //電話許可\r\n            personalData.emailstatus = 1; //個別メール許可\r\n        }\r\n        personalData.personalstatus = _prop.getValueFromPropName(_GH.CODE_DEF.STATUS, \"追客中\");\r\n        personalData.nonresponseflg = 0; // 非反響フラグは外す。\r\n    }\r\n}\r\n\r\n/**\r\n * 顧客情報を使って置換タグを置き換える。\r\n */\r\nfunction replaceSFAMailTags(text, custFormData) {\r\n    if (text && custFormData) {\r\n        text = text.replace( /\\{personal_lastName\\}/g , custFormData[\"lastName\"] );\r\n        text = text.replace( /\\{personal_firstName\\}/g , custFormData[\"firstName\"] );\r\n        text = text.replace( /\\{personal_sub_lastName\\}/g , custFormData[\"subLastName\"] );\r\n        text = text.replace( /\\{personal_sub_firstName\\}/g , custFormData[\"subFirstName\"] );\r\n        var emps = (custFormData[\"employFullName\"])? custFormData[\"employFullName\"].split(\" \"): [\"\", \"\"];\r\n        text = text.replace( /\\{myLastName\\}/g , emps[0] );\r\n        text = text.replace( /\\{myFirstName\\}/g , emps[1] );\r\n    }\r\n    return text;\r\n}"

/***/ },
/* 43 */
/*!*****************************************************!*\
  !*** ./class/data/collections/LibListCollection.js ***!
  \*****************************************************/
/***/ function(module, exports) {

	/**
	 * ライブラリデータを保持する。更新時に listener の処理を同時に実行する。
	 */
	module.exports = function (listener, dirId) {
	    "use strict";
	    var that = this;
	
	    this.dirId = dirId;
	    var listeners = [];
	    this.setListener = function(listener){
	        listeners.push(listener);
	    };
	    this.setListener(listener);
	
	    this.create = function(param, winName){
	        var def = $.Deferred();
	        var uri = "library/create";
	        window.dhx4.ajax.query({
	            method : "PUT",
	            url : _GHAPI.SERVER + uri,
	            data : JSON.stringify(param),
	            async : false,
	            headers:{"Content-Type":"application/json"},
	            callback: function(res){ def.resolve(res);}
	        });
	        def.done(function(res) {
	            if(res.xmlDoc.status === 200){
	                param["libraryId"] = JSON.parse(res.xmlDoc.responseText).id;
	                // メールの件名と本文をセッションストレージに保存する。
	                setSS(_GH.S05F030Lib.MAIL_SUB,  param.mailSubject);
	                setSS(_GH.S05F030Lib.MAIL_BODY, param.mailBody);
	                _.forEach(listeners, function(listener){
	                    listener.create();
	                });
	                // MSは承認が必要なため、ウィンドウは閉じない。
	                if (_ghUser.isExp()) {
	                    dhtmlx.message({ type:"info", text: "ライブラリ情報を保存しました。<BR>内容の確認後、承認依頼してください。"});
	                } else {
	                    _ghWins.closeWindow(winName, false);
	                }
	            } else {
	                var message = "サーバーエラーが発生しました。";
	                var params = { 'status' : res.status, 'errorMessage' :message};
	                throw new Error(JSON.stringify({message: message, params: params}));
	            }
	        });
	        return def.promise();
	    };
	
	    this.update = function(param, winName){
	        var uri = "library/update";
	        window.dhx4.ajax.query({
	            method : "PUT",
	            url : _GHAPI.SERVER + uri,
	            data : JSON.stringify(param),
	            async : false,
	            headers:{
	                "Content-Type":"application/json"
	            },
	            callback: function(res){
	                if(res.xmlDoc.status === 200){
	                    // メールの件名と本文をセッションストレージに保存する。
	                    setSS(_GH.S05F030Lib.MAIL_SUB,  param.mailSubject);
	                    setSS(_GH.S05F030Lib.MAIL_BODY, param.mailBody);
	
	                    var nextNode = getJSONSync("library/folder/list/" + dirId);
	
	                    _.forEach(listeners, function(listener){
	                        listener.update();
	                    });
	                    _ghWins.closeWindow(winName, false);
	                } else {
	                    var message = "サーバーエラーが発生しました。";
	                    var params = { 'status' : res.status, 'errorMessage' :message};
	                    throw new Error(JSON.stringify({message: message, params: params}));
	                }
	            }
	        });
	    };
	
	    this.deleteAt = function(selectedId, physicalDelete){
	        if (physicalDelete === true) {
	            delURL("library/delete/" + selectedId, null, function(res){
	                _.forEach(listeners, function(listener){
	                    listener.deleteAt(selectedId, res.xmlDoc.status === 200);
	                });
	            });
	        } else {
	            var response = postSyncURL("library/trashLibrary", {libraryId: selectedId});
	            _.forEach(listeners, function(listener){
	                listener.deleteAt(selectedId, !response.error);
	            });
	        }
	    };
	
	    this.deleteList = function(selectedIdList, physicalDelete){
	        if (physicalDelete === true) {
	            delURL("library/list/delete?" + getArrayQueryParam("libraryIdList", selectedIdList), null, function(res){
	                _.forEach(listeners, function(listener){
	                    listener.deleteAt(selectedIdList, res.xmlDoc.status === 200);
	                });
	            });
	        } else {
	        	var selectedIdsParam = "";
	        	_.forEach(selectedIdList, function(selectedId, index) {
	        		selectedIdsParam += ("&libraryId=" + selectedId);
	        	})
	            var response = postSyncURL("library/trashLibrary", null, null, selectedIdsParam);
	            _.forEach(listeners, function(listener){
	                listener.deleteAt(selectedIdList, !response.error);
	            });
	        }
	    };
	
	    this.move = function(libraryId, libraryDirId){
	        if(that.dirId === libraryDirId){return;}
	
	        var response = postSyncURL("library/move/" + libraryId, {libraryDirId: libraryDirId});
	
	        _.forEach(listeners, function(listener){
	            listener.move(libraryId, libraryDirId, !response.error);
	        });
	    };
	
	    this.moveList = function(libraryIdList, libraryDirId){
	        if(that.dirId === libraryDirId){return;}
	        var selectedIdsParam = "";
	    	_.forEach(libraryIdList, function(selectedId, index) {
	    		selectedIdsParam += ("&libraryIdList=" + selectedId);
	    	})
	        var response = postSyncURL("library/list/move/" + libraryDirId, null, null, selectedIdsParam);
	
	        _.forEach(listeners, function(listener){
	            listener.move(libraryIdList, libraryDirId, !response.error);
	        });
	    };
	}


/***/ },
/* 44 */
/*!***************************************!*\
  !*** ./class/data/models/Schedule.js ***!
  \***************************************/
/***/ function(module, exports) {

	/**
	 * 案内予約情報を保持する。更新時に listener の処理を同時に実行する。
	 */
	module.exports = function Schedule(listeners){
	    "use strict";
	    var that = this;
	
	    var myListeners = [];
	    this.setListener = function(listener){
	        myListeners.push(listener);
	    };
	    _.forEach(listeners, function(l){
	        that.setListener(l);
	    });
	
	
	    /**
	     * 案内予約の追加を行う。リスナーに更新を通知する。
	     */
	    this.append = function(){
	        _.forEach(myListeners, function(listener){
	            if(listener.appendSchedule){listener.appendSchedule();}
	        });
	    };
	
	    /**
	     * 案内予約の更新を行う。リスナーに更新を通知する。
	     */
	    this.update = function(){
	        _.forEach(myListeners, function(listener){
	            if(listener.updateSchedule){listener.updateSchedule();}
	        });
	    };
	};


/***/ },
/* 45 */
/*!***************************!*\
  !*** ./class/EventMst.js ***!
  \***************************/
/***/ function(module, exports) {

	/**
	 * 物件マスタのオブジェクト
	 * @param dhxObject アタッチするためのDHTMLXオブジェクト。
	 */
	module.exports = function EventMst(dhxObject) {
	     var that = this;
	     this.dhxObject = dhxObject;
	
	     this.leftEventGrid;
	     this.eventForm;
	
	     var _CONST = _GH.EVENT_M;
	
	     this.EVENTID = {
	         L_001 : "L_001", //物件新規作成
	         L_003 : "L_003" //物件削除
	     };
	
	     // 物件ツールバーの設定
	     this.initToolbar = function(){
	         var cell = that.dhxObject.cells("a");
	         this.toolbar = cell.attachToolbar();
	         this.toolbar.loadStruct(getTemplatePath(_GH.DATA_PATH.MST_EVENT_TOOLBAR_XML));
	         this.toolbar.setIconSize(_GH.ICON_SIZE);
	         this.toolbar.attachEvent("onClick", function(id){
	             switch (id){
	                 case that.EVENTID.L_001: // 物件新規作成
	                     if (that.eventForm) {
	                         if (!confirm("物件詳細に表示される内容がクリアされますが、よろしいですか？")) {
	                             return;
	                         }
	                     }
	                     that.leftEventGrid.clearSelection();
	                     that.initEventForm(-1);
	                     break;
	             };
	         })
	     };
	
	     // 物件エリア（左）の初期化
	     this.initEventGrid = function() {
	         var cell = that.dhxObject.cells("a");
	         //予め、ページング用のオブジェクトを詰め込んでおく
	         cell.attachHTMLString(_CONST.HTML.EVENT_BODY);
	         cell.appendObject("csList");
	         cell.appendObject("eventrecInfoArea");
	         cell.appendObject("eventgridbox");
	         cell.appendObject("eventpagingArea");
	         if (that.leftEventGrid) {
	             that.leftEventGrid.clearAll(true);
	         }
	         that.leftEventGrid = new dhtmlXGridObject("csList");
	         that.leftEventGrid.setImagePath(_GH.PATH_TYPE.DHX_IMGS);
	         that.leftEventGrid.setSkin(_GH.PATH_TYPE.SKIN);
	         that.leftEventGrid.i18n.paging=_GH.FORMAT.GRID_NAV;
	         that.leftEventGrid.enablePaging(true,50,10,"eventgridbox",true,"eventrecInfoArea");
	         that.leftEventGrid.setPagingSkin(_GH.PATH_TYPE.GRID_NAV, _GH.PATH_TYPE.SKIN);
	         that.leftEventGrid.enableAutoWidth(true);
	         /** データロード時のイベント */
	         that.leftEventGrid.attachEvent("onDataReady",function(){
	             that.leftEventGrid.attachHeader((_ghUser.isNon())?
	                     "#text_filter,#text_filter,#text_filter,#text_filter":"#text_filter,#text_filter,#text_filter,#text_filter");// フィルター追加
	             // 表示グリッドを整える。
	             that.resizeWindow(cell, "csList");
	         });
	         loadGridByGet(that.leftEventGrid, _GH.DATA_PATH.MST_EVENT_EVENT_GRID_JSON,  "event/list", "eventId", that.gridDataLogicFunc);
	         /** 行選択時のイベント */
	         that.leftEventGrid.attachEvent("onRowSelect", function(selectedEventId, cInd){
	             console.log("onRowSelect  rId:" + selectedEventId + " cInd:" + cInd);
	             that.initEventForm(selectedEventId);
	         });
	     };
	
	     /**
	      * 画面変更になった際に呼び出される。
	      */
	     this.resizeWindow = function(_cell, csListName) {
	         resizeGridListInLayoutCell(_cell, csListName);
	     };
	
	     // Grid表示用にデータを振り分けるロジック
	     this.gridDataLogicFunc = function(data, id, rowIdx) {
	         var val;
	         switch(id) {
	             case "holdDate":
	                 val = doDateFormatYyyymmdd(null, data[id]);
	                 break;
	             default:
	               val = data[id];
	               break;
	         }
	         return val;
	     };
	     // 物件詳細を初期化する。
	     this.initEventForm = function(eventId) {
	         var cell = that.dhxObject.cells("b");
	         var saveUri = (eventId > 0)? "event/update": "event/regist";
	         that.eventForm = cell.attachForm();
	         that.eventForm.loadStruct(getTemplatePath(_GH.DATA_PATH.MST_EVENT_EVENT_FORM_JSON), "json", function(){
	             $('[name=eventName]').attr("style","margin-left:24px");
	             $('[name=customisedEventId]').attr("style","margin-left:10px");
	             $('[name=eventType]').attr("style","margin-left:22px");
	             $('[name=holdDate]').attr("style","margin-left:49px");
	             $('[name=place]').attr("style","margin-left:61px");
	             $('[name=participant]').attr("style","margin-left:37px");
	             $('[name=memo]').attr("style","margin-left:64px; width:128%" );
	             //事業部
	             this.setItemValue("department", _ghUser.getLoginType());
	
	             if (eventId > 0) {
	                 // 更新：物件IDがある場合は、取得する。
	                 var eventData = getJSONSync("event/id/" + eventId);
	                 this.setFormData(eventData);
	             } else {
	                 //新規の場合は削除の必要がないので、削除ボタンは隠す
	                 this.hideItem("L_003");
	
	             }
	         });
	
	         that.eventForm.attachEvent("onButtonClick", function (name){
	             switch(name) {
	                 case that.EVENTID.L_001 : // 物件情報の保存
	                     that.eventForm.updateValues();
	                     if (that.eventForm.validate()) {
	
	                         var regStr = "^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$";
	                         var checkStartTime = false;
	                         var checkEndTime = false;
	                         var startTime = that.eventForm.getItemValue("startTime");
	                         var endTime = that.eventForm.getItemValue("endTime");
	                         if(startTime != ""){
	                             var reg = new RegExp(regStr,"g");
	                             checkStartTime = reg.test(startTime);
	                         }else{
	                             checkStartTime = true;
	                         }
	
	                         if(endTime != ""){
	                             var reg = new RegExp(regStr,"g");
	                             checkEndTime = reg.test(endTime);
	                         }else{
	                             checkEndTime = true;
	                         }
	
	                         if(!checkStartTime || !checkEndTime){
	                             if(!checkStartTime){
	                                 $('[name=startTime]').attr("style","color:red; width:42px");
	                             }else{
	                                 $('[name=startTime]').attr("style","color:black; width:42px");
	                             }
	                             if(!checkEndTime){
	                                 $('[name=endTime]').attr("style","color:red; width:42px");
	                             }else{
	                                 $('[name=endTime]').attr("style","color:black; width:42px");
	                             }
	                             dhtmlx.message({
	                                 type:"error",
	                                 text: "開催日" + "は必須入力です。"
	                             });
	                         }else{
	                             saveForm(that.eventForm, saveUri, function(){
	                                 that.initEventGrid();
	                                 that.initEventForm(-1);
	                                 dhtmlx.message({text: "物件情報を保存しました。"});
	                             });
	                         }
	
	                     }
	                     break;
	                 case that.EVENTID.L_003 : // 削除
	                     if (confirm("物件を本当に削除しますか？")) {
	                         var callback = function() {
	                             that.leftEventGrid.deleteRow(that.leftEventGrid.getSelectedRowId());
	                             that.initEventForm(-1);
	                             dhtmlx.message({text: "物件情報を削除しました。"});
	                         };
	                         delURL("event/delete/" + eventId, null, callback);
	                     }
	                     break;
	             };
	         });
	         // バリデートエラー時の処理
	         that.eventForm.attachEvent("onValidateError", function (name, value, result){
	             dhtmlx.message({
	                 type:"error",
	                 text: that.eventForm.getItemLabel(name) + "は必須入力です。"
	             });
	         });
	     };
	
	     /**
	      * 初期化する。
	      */
	     this.init = function(){
	         that.dhxObject.cells("a").setText("イベントマスタ");
	         that.dhxObject.cells("b").setText("イベント詳細");
	         var height = (_ghUser.isNon())? 380: 600;
	         that.dhxObject.cells("b").setHeight(height);
	         //that.dhxObject.cells("c").setText("棟・部屋一覧");
	         that.initToolbar();
	         that.initEventGrid();
	     };
	
	
	 };


/***/ },
/* 46 */
/*!*****************************!*\
  !*** ./class/SFAClassIF.js ***!
  \*****************************/
/***/ function(module, exports) {

	/**
	 * 反響ツリーから操作される（処理がつながっている）画面要素の共通インターフェースを定義
	 * ただし、プロパティは持たせないこと。今回の実装方法では正しく動かないため。
	 * また、各実装クラスでIFのメソッドを使う場合はオーバーライドして使うこと。
	 */
	function GHClassIF() {
	}
	/**
	 * 反響ツリーから顧客IDの配列を受け取り、そのデータをもとに情報を表示する。
	 * @param personalIds : array[number]
	 */
	GHClassIF.prototype.showPage = function(personalIds) {
	    console.log("インターフェースのメソッドshowPageが呼び出された", personalIds);
	}

/***/ },
/* 47 */
/*!*********************************************!*\
  !*** ./class/window/RegisterEventWindow.js ***!
  \*********************************************/
/***/ function(module, exports) {

	"use strict";
	
	/**
	 * 問合せ物件登録ウインドウ
	 */
	var RegisterEventWindow = function(showTouNo, processAfterRegister, personalId, entryId){
	    var that = this;
	
	    var setHandler = function(){
	        that.form.attachEvent("onButtonClick", function(name){
	            switch(name){
	                case "L_003":
	                    if (that.form.validate()) {
	                        // 物件の登録
	                        dhtmlx.message({ type:"info", text:"物件の登録"});
	                        that.form.setItemValue("entryId", entryId);
	                        var sendParam = that.form.getFormData();
	                        sendParam.personalId = personalId;
	                        postSyncURL(_GH.URL("ENTRY_EVENT_REGIST"), sendParam);
	                        processAfterRegister();
	                        that.win.setModal(false);
	                        that.win.close();
	                    }
	                    break;
	                default:
	                    break;
	            }
	        });
	
	        that.form.attachEvent("onFocus", function(name, value){
	            switch(name){
	                case "eventName": // Regista番号変更
	                    _ghWins.doEvent(this.getInput("eventId"), this.getInput("eventName"), that.form);
	                    break;
	            };
	        });
	        // validation error process
	        that.form.attachEvent("onValidateError", function (name/*, value, result*/) {
	            dhtmlx.message({
	                type:"error",
	                text: that.form.getItemLabel(name) + "は必須入力です。"
	            });
	        });
	    };
	
	    var initForm = function(){
	        //フォームの作成
	        that.form = that.win.attachForm();
	        var def = $.Deferred();
	        that.form.loadStruct(loadJSON(getTemplatePath(_GH.DATA_PATH.EVENT_ADD_WIN_FORM)), "json", function() {
	            def.resolve();
	        });
	        def.done(function () {
	            // range and evaluation options setting
	            that.form.reloadOptions("eventJoin", _prop.getOptionsWithEmpty(_GH.CODE_DEF.EVENT_JOIN));
	        });
	
	        return def.promise();
	    };
	
	    var initWindow = function(){
	        that.winName = "registerProduction";
	        that.win = _ghWins.ghWins.createWindow(that.winName, 20, 30, 400, 230);
	        that.win.setText("問合せ物件登録ウィンドウ");
	        that.win.hide();
	        that.win.button("park").hide();
	        that.win.button("minmax1").hide();
	        that.win.button("close").attachEvent("onClick", function(){
	            that.win.setModal(false);
	            that.win.hide();
	        });
	        that.win.attachEvent("onClose", function(win){
	            return true;
	        });
	
	    };
	
	    this.init = function(){
	        initWindow();
	        initForm().done(function(){
	            setHandler();
	            that.win.setModal(true);
	            that.win.show();
	        });
	    };
	};


/***/ },
/* 48 */
/*!**********************************************!*\
  !*** ./class/window/ServicesAssetsWindow.js ***!
  \**********************************************/
/***/ function(module, exports) {

	module.exports = function ServicesAssetsWindow(
	    serviceCode, serviceName,
	    assetCode, assetName, assetPrice,
	    afterSelectProc
	){
	    "use strict";
	    var that = this;
	    var servicesGird = null;
	    var assetsGird = null;
	    var _COL = {
	        SELF: 0,
	        SERVICE_NAME: 1,
	        ASSET_NAME: 3,
	        ASSET_PRICE: 4
	    };
	    var initWindow = function(){
	        that.win = _ghWins.ghWins.createWindow("servicesAssetsWindow", 320, 30, 300, 260);
	        that.win.setText("Services - Assets");
	        that.win.setDimension(520, 400);
	        that.win.button("minmax1").hide();
	        that.win.button("park").hide();
	        that.win.button("close").attachEvent("onClick", function(){
	            that.win.setModal(false);
	            that.win.close();
	        });
	        that.win.setModal(true);
	    };
	    var initForm = function(){
	        var def = $.Deferred();
	        that.subForm = that.win.attachForm();
	        that.subForm.loadStruct(getTemplatePath(_GH.DATA_PATH.SERVICES_ASSETS_WIN), "json", function(){
	            servicesGird = new dhtmlXGridObject(that.subForm.getContainer("services"));
	            servicesGird.attachEvent("onDataReady",function(){
	                _.forEach([0, 2, 3, 4], function(idx) { servicesGird.setColumnHidden(idx, true);});
	            });
	            assetsGird = new dhtmlXGridObject(that.subForm.getContainer("assets"));
	            assetsGird.attachEvent("onDataReady",function(){
	                _.forEach([0, 1, 2], function(idx) { assetsGird.setColumnHidden(idx, true);});
	            });
	            that.initGrid(servicesGird, 1, 0);
	        });
	        that.subForm.attachEvent('onButtonClick', function(name, command){
	            switch(name) {
	                case "selectBtn":
	                    var selectServiceGird = (_.isEmpty(servicesGird))? null: servicesGird.getSelectedRowId();
	                    //var originflg = false;
	                    if (_.isEmpty(selectServiceGird)) {
	                        dhtmlx.alert({
	                            title : "Error",
	                            type : "alert-error",
	                            text : "Do not select item"
	                        });
	                        return;
	                    } else {
	                        if (!_.isNull(serviceCode)) serviceCode.value = servicesGird.cells(selectServiceGird, _COL.SELF).getValue();
	                        if (!_.isNull(serviceName)) serviceName.value = servicesGird.cells(selectServiceGird, _COL.SERVICE_NAME).getValue();
	                        /*var origin1 = servicesGird.cells(selectGird, _COL.ORIGIN).getValue();
	                        if(origin1 === "1"){
	                            originflg = true;
	                        }*/
	                    }
	                    var selectAssetGird = (_.isEmpty(assetsGird))? null: assetsGird.getSelectedRowId();
	                    if (!_.isEmpty(selectAssetGird)) {
	                        if (!_.isNull(assetCode)) assetCode.value = assetsGird.cells(selectAssetGird, _COL.SELF).getValue();
	                        if (!_.isNull(assetName)) assetName.value = assetsGird.cells(selectAssetGird, _COL.ASSET_NAME).getValue();
	                        if (!_.isNull(assetPrice)) assetPrice.value = assetsGird.cells(selectAssetGird, _COL.ASSET_PRICE).getValue();
	                        /*var origin2 = resTypeGrid2.cells(selectResType2, _COL.ORIGIN).getValue();
	                        if(origin2 === "1"){
	                            originflg = true;
	                        }*/
	                    } else {
	                        if (!_.isNull(assetCode)) assetCode.value = "";
	                        if (!_.isNull(assetName)) assetName.value = "";
	                        if (!_.isNull(assetPrice)) assetPrice.value = "";
	                    }
	                    if(afterSelectProc && typeof afterSelectProc === "function"){
	                        afterSelectProc(false);
	                    }
	                    that.win.close();
	                    def.resolve();
	                    break;
	            }
	        });
	        return def.promise();
	    };
	
	    this.initGrid = function(grid, level, parentResTypeId) {
	        var previousId;
	        if (!_.isNull(grid)) grid.clearAll(true);
	        grid.attachEvent("onRowSelect", function(selectId, ind){
	            if (selectId === previousId) {
	                return;
	            } else {
	                previousId = selectId;
	            }
	            var parentId = _.parseInt(grid.cells(selectId, _COL.SELF).getValue());
	            if (level == 1) {
	                that.initGrid(assetsGird, 2, parentId);
	            } else{
	                return;
	            }
	        });
	        // get list services by buildingCode
	        var uri = "";
	        loadGridByGet(grid, _GH.DATA_PATH.SERVICES_ASSETS_GRID, uri, "serviceCode");
	    };
	
	    this.init = function(){
	        initWindow();
	        return initForm();
	    };
	};


/***/ },
/* 49 */
/*!***********************************************************************!*\
  !*** C:/building/src/main/webapp/resources/~/raw-loader!./gh.data.js ***!
  \***********************************************************************/
/***/ function(module, exports) {

	module.exports = "/**\r\n * データ通信用のスクリプト\r\n */\r\n// DHTMLX用のパラメータをつけない。\r\nwindow.dhx4.ajax.cache = true;\r\n\r\n// DHTMLX用のAJAXイベント失敗時のイベント\r\nwindow.dhx4.attachEvent(\"onAjaxError\", function(requestObject){\r\n    try{\r\n        var message = is(\"String\", requestObject.responseText)? JSON.parse(requestObject.responseText).message: \"サーバーエラーが発生しました。\";\r\n    } catch(e){\r\n        var message = \"サーバーエラーが発生しました。\";\r\n    }\r\n    var params = { 'status' : requestObject.status, 'errorMessage' :message};\r\n    if (requestObject.status == 204) {\r\n        // 204の場合は、何もしない\r\n        return;\r\n    }\r\n    throw new Error(JSON.stringify({message: message, params: params}));\r\n});\r\n\r\nfunction loadForm(dhxForm, uri, param) {\r\n    console.log(\"loadForm\", dhxForm, _GHAPI.SERVER + uri, param);\r\n    try {\r\n        window.dhx4.ajax.get(_GHAPI.SERVER + uri, function(r){\r\n            var t = null;\r\n            try { t = r.xmlDoc; } catch(e) {}\r\n            if (t != null && t.status.toString() == \"200\") {\r\n                // response is ok\r\n                dhxForm.setFormData(parseJSON(r.xmlDoc.responseText));\r\n            } else {\r\n                // error\r\n                console.log(\"loadFormでエラー\", \"status:\" + t.status, t.statusText);\r\n                dhtmlx.message({ type:\"error\", text:\"サーバ通信に失敗しました。しばらく時間を置いて再度試してください。<br>\"\r\n                    + \"status:\" + t.status + \"[\" + t.statusText + \"]\" });\r\n            }\r\n        });\r\n    } catch(e) {\r\n        console.log(\"フォームデータ取得時にエラーが発生！\", e);\r\n        dhtmlx.message({ type:\"error\", text:\"サーバとの接続ができませんでした。[\" + e.name + \"]\"});\r\n    }\r\n}\r\n\r\n/**\r\n * フォームデータを保存します。\r\n * @param {Object} dhxForm DHTMLXのFormオブジェクト\r\n * @param {String} uri APIのURL\r\n * @param {String] method HTTPメソッド\r\n * @param {Function} afterFunc 成功時に実行する関数\r\n */\r\nfunction saveForm(dhxForm, uri, afterFunc) {\r\n    dhxForm.updateValues();\r\n    console.log(\"saveForm\", dhxForm.getFormData(), uri);\r\n    dhxForm.send(_GHAPI.SERVER + uri, \"post\", function(loader, response){\r\n        var t = null;\r\n        try { t = loader.xmlDoc; } catch(e) {};\r\n        if (t != null && t.status.toString() == \"200\") {\r\n            // response is ok\r\n            console.log(\"saveForm response\", response);\r\n            dhtmlx.message({ type:\"info\", text: \"情報を保存しました。\"});\r\n            if(is(\"Function\", afterFunc)) {\r\n                afterFunc();\r\n            }\r\n        } else {\r\n            try{\r\n                var message = is(\"String\", t.responseText)? JSON.parse(t.responseText).message: \"サーバーエラーが発生しました。\";\r\n            } catch(e){\r\n                var message = \"サーバーエラーが発生しました。\";\r\n            }\r\n            var params = { 'status': t.status, 'errorMessage': message};\r\n            throw new Error(JSON.stringify({message: message, params: params}));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * save form, after save success, call afterFunc with response\r\n * @param {Object} dhxForm DHTMLXのFormオブジェクト\r\n * @param {String} uri APIのURL\r\n * @param {String] method HTTPメソッド\r\n * @param {Function} afterFunc 成功時に実行する関数\r\n */\r\nfunction saveFormAndCallbackWithResponse(dhxForm, uri, afterFunc) {\r\n    dhxForm.updateValues();\r\n    console.log(\"saveForm\", dhxForm.getFormData(), uri);\r\n    dhxForm.send(_GHAPI.SERVER + uri, \"post\", function(loader, response){\r\n        var t = null;\r\n        try { t = loader.xmlDoc; } catch(e) {};\r\n        if (t != null && t.status.toString() == \"200\") {\r\n            // response is ok\r\n            console.log(\"saveForm response\", response);\r\n            dhtmlx.message({ type:\"info\", text: \"情報を保存しました。\"});\r\n            if(is(\"Function\", afterFunc)) {\r\n                afterFunc(response);\r\n            }\r\n        } else {\r\n            try{\r\n                var message = is(\"String\", t.responseText)? JSON.parse(t.responseText).message: \"サーバーエラーが発生しました。\";\r\n            } catch(e){\r\n                var message = \"サーバーエラーが発生しました。\";\r\n            }\r\n            var params = { 'status': t.status, 'errorMessage': message};\r\n            throw new Error(JSON.stringify({message: message, params: params}));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * フォームを伴わないアクセス方法\r\n * (GET形式)\r\n * @param {String} uri URI\r\n * @param {Object} param パラメータ\r\n * @param {Boolean} isParse JSONテキストをオブジェクトにパースするかどうか\r\n * */\r\nfunction accesSyncURL(uri, param, isParse) {\r\n    console.log(\"accesURL\", _GHAPI.SERVER + uri, param);\r\n    var parseFlg = true;\r\n    if(is(\"Boolean\",isParse)){\r\n        parseFlg = isParse;\r\n    }\r\n    var queryString =\"\";\r\n    _.forEach(param, function(value, key, param) {\r\n\r\n        if(queryString == \"\"){\r\n            queryString = \"?\" + key + \"=\" + value;\r\n        }else{\r\n            queryString = queryString + \"&\" + key + \"=\" + value;\r\n        }\r\n        console.log(value + ' : ' + key);\r\n    });\r\n\r\n    var r = window.dhx4.ajax.getSync(_GHAPI.SERVER + uri + encodeURI(queryString));\r\n    var t = null;\r\n    try { t = r.xmlDoc; } catch(e) {};\r\n    if (t != null) {\r\n        // response is ok\r\n        //resJson = parseJSON(r.xmlDoc.responseText);\r\n        if(parseFlg){\r\n            return parseJSON(r.xmlDoc.responseText);\r\n\r\n        }else{\r\n            return r.xmlDoc.responseText;\r\n        }\r\n        console.log(\"HTTP:200 \" + r.xmlDoc.responseText);\r\n    } else {\r\n        var message = is(\"String\", t.responseText)? JSON.parse(t.responseText).message: \"サーバーエラーが発生しました。\";\r\n        var params = { 'status' : t.status, 'errorMessage' :message};\r\n        throw new Error(JSON.stringify({message: message, params: params}));\r\n    }\r\n};\r\n\r\n/**\r\n * フォームを伴わないアクセス方法\r\n * (POST形式)\r\n * @param {String} uri URI\r\n * @param {Object} param パラメータ\r\n * @param {Array} removeParamNames paramの中で対象外となる項目名の配列\r\n * @param {String} additionalQueryParam 追加でつけるクエリ。最後は必ず&で終わること。\r\n * */\r\nfunction postSyncURL(uri, param, removeParamNames, additionalQueryParam){\r\n    console.log(\"postSyncURL\", _GHAPI.SERVER + uri, param, additionalQueryParam);\r\n    try {\r\n        // 追加的なクエリパラメータがあれば、先に足しておく。\r\n        var queryString = additionalQueryParam? additionalQueryParam: \"\";\r\n        _.forEach(param, function(value, key, param) {\r\n            if(removeParamNames && _.indexOf(removeParamNames, key) >= 0) {\r\n                // 使用しないキーの場合は、何もしない\r\n            } else if(queryString == \"\"){\r\n                queryString = key + \"=\" + value;\r\n            }else{\r\n                queryString = queryString + \"&\" + key + \"=\" + value;\r\n            }\r\n        });\r\n        console.log(\"postSyncURLのクエリパラメータ\", queryString);\r\n\r\n        var r = window.dhx4.ajax.postSync(_GHAPI.SERVER + uri, encodeURI(queryString));\r\n        var t = null;\r\n        try { t = r.xmlDoc; } catch(e) {}\r\n        if (t != null && t.status.toString() == \"200\") {\r\n            console.log(\"HTTP:200 \", JSON.parse(r.xmlDoc.responseText));\r\n            return parseJSON(r.xmlDoc.responseText);\r\n        } else {\r\n            // error\r\n            console.log(\"sfa.data.postSyncURLでエラー\", \"status:\" + t.status, t.statusText);\r\n            dhtmlx.message({ type:\"error\", text:\"サーバ通信に失敗しました。しばらく時間を置いて再度試してください。<br>\"\r\n                + \"status:\" + t.status + \"[\" + t.statusText + \"]\" });\r\n            return {error: true,  status: t.status, text: t.statusText};\r\n        }\r\n    } catch(e) {\r\n        console.log(\"データ取得時にエラーが発生！\", e);\r\n        dhtmlx.message({ type:\"error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n        return {error: true,  status: 500, text: e.name};\r\n    }\r\n}\r\n/**\r\n * 指定したURIで削除を実行する。（HTTPのDELETEメソッドを利用する）\r\n * @param uri URI\r\n * @param param パラメータ\r\n * @param callback コールバック\r\n */\r\nfunction delURL(uri, param, callback) {\r\n    console.log(\"削除実行API\", uri, param);\r\n    try {\r\n        window.dhx4.ajax.query({\r\n            method : \"DELETE\",\r\n            url : _GHAPI.SERVER + uri,\r\n            data : param,\r\n            async : false,\r\n            callback : callback,\r\n            headers:{\r\n                \"Content-Type\":\"application/x-www-form-urlencoded; charset=UTF-8\"\r\n            }\r\n        });\r\n    } catch(e) {\r\n        console.log(\"データ削除時にエラーが発生！\", e);\r\n        dhtmlx.message({ type:\"error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n    }\r\n};\r\n/**\r\n * フォームを伴わないアクセス方法\r\n * (PUT形式)\r\n * @param {String} uri URI\r\n * @param {Object} param パラメータ\r\n * @param {Function} callbackFunc コールバックするファンクション\r\n * */\r\nfunction putURL(uri, param, callbackFunc){\r\n\r\n    console.log(\"putURL\", _GHAPI.SERVER + uri, param);\r\n    try {\r\n        var queryString =\"\";\r\n        _.forEach(param, function(value, key, param) {\r\n            if (_.isString(key)) {\r\n                queryString += key + \"=\" + value + \"&\";\r\n            }\r\n        });\r\n        console.log(\"PUTのクエリ\", queryString);\r\n\r\n      var url = _GHAPI.SERVER + uri;\r\n      var res = window.dhx4.ajax.query({\r\n          method : \"PUT\",\r\n          url : url,\r\n          data : queryString,\r\n          async : true,\r\n          callback : function(r){\r\n\r\n              var t = null;\r\n              try { t = r.xmlDoc; } catch(e) {};\r\n              if (t != null && t.status.toString() == \"200\") {\r\n                  if (is(\"Function\", callbackFunc)) {\r\n                      callbackFunc(parseJSON(r.xmlDoc.responseText));\r\n                  }\r\n                  console.log(\"HTTP:200 \" + r.xmlDoc.responseText);\r\n              } else {\r\n                  // error\r\n                  console.log(\"sfa.data.postSyncURLでエラー\", \"status:\" + t.status, t.statusText);\r\n                  dhtmlx.message({ type:\"error\", text:\"サーバ通信に失敗しました。しばらく時間を置いて再度試してください。<br>\"\r\n                      + \"status:\" + t.status + \"[\" + t.statusText + \"]\" });\r\n              }\r\n          },\r\n          headers:{\r\n              \"Content-Type\":\"application/x-www-form-urlencoded; charset=UTF-8\",\r\n              \"LOGIN_TYPE\": _ghUser.getLoginType()\r\n          }\r\n      });\r\n    } catch(e) {\r\n        console.log(\"データ更新時にエラーが発生\", e);\r\n        dhtmlx.message({ type:\"error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n    }\r\n};\r\n/**\r\n * フォームを伴わないアクセス方法\r\n * (PUT形式)\r\n * @param {String} uri URI\r\n * @param {Object} param パラメータ（JSON文字列に変換する）\r\n * @param {Function} callbackFunc コールバックするファンクション\r\n * */\r\nfunction syncPutJSON(uri, param, afterFunc){\r\n\r\n    console.log(\"putURL\", _GHAPI.SERVER + uri, JSON.stringify(param));\r\n    try {\r\n        var res = window.dhx4.ajax.query({\r\n            method : \"PUT\",\r\n            url : _GHAPI.SERVER + uri,\r\n            data : JSON.stringify(param),\r\n            async : false,\r\n            callback: afterFunc,\r\n            headers:{\r\n                \"Content-Type\":\"application/json\"\r\n            }\r\n        });\r\n    } catch(e) {\r\n        console.log(\"データ更新時にエラーが発生\", e);\r\n        dhtmlx.message({ type:\"error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n    }\r\n};\r\n\r\n/**\r\n * GETメソッドでAPIコールを行い、引数のグリッドにデータをロードする。\r\n *\r\n * @param {Object} dhxGrid データをロードさせるGridオブジェクト\r\n * @param {String} templateFileName テンプレートファイル名\r\n * @param {String} uri REST APIにアクセスするためのURI\r\n * @param {String} primaryColName 主キーになるカラム名。それで取得された値はNumberであること。nullの場合は行番号を使う。\r\n * @param {Function} logicFunc Grid表示用にデータを振り分けるロジック関数\r\n *               引数は１行分のデータオブジェクト（key:value), key, 行番号(0始まり)\r\n * @param {Function} afterFunc １行データ取得後の後処理を行う関数。nullの場合は実施しない。\r\n *               引数は１行分の配列[値1, 値2, ・・・]\r\n */\r\nfunction loadGridByGet(dhxGrid, templateFileName, uri, primaryColName, logicFunc, afterFunc) {\r\n    // テンプレートファイルの取得\r\n    var template = loadJSON(getTemplatePath(templateFileName));\r\n    try {\r\n        dhxGrid.clearAll(false); // 行を消す\r\n        // サーバ通信し、データを取得する。\r\n        var r = window.dhx4.ajax.getSync(_GHAPI.SERVER + uri);\r\n        var gridData = commonGridDataAsJSObject(template, r, primaryColName, logicFunc, afterFunc);\r\n        //TODO あとで、下記の処理分もCommonの方に寄せる。\r\n        if (gridData.rows.length === 0) {\r\n            console.log(\"データ取得件数が０件でした\");\r\n        }\r\n        dhxGrid.parse(gridData, \"json\");\r\n    } catch(e) {\r\n        console.log(\"データ取得時にエラーが発生！\", e);\r\n        dhtmlx.alert({ title: \"サーバ通信エラー\", type:\"alert-error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n    }\r\n};\r\n\r\n/**\r\n * POSTメソッドでAPIコールを行い、引数のグリッドにデータをロードする。\r\n *\r\n * @param {Object} dhxGrid データをロードさせるGridオブジェクト\r\n * @param {String} templateFileName テンプレートファイル名\r\n * @param {String} uri REST APIにアクセスするためのURI\r\n * @param {String} primaryColName 主キーになるカラム名。それで取得された値はNumberであること。nullの場合は行番号を使う。\r\n * @param {Function} logicFunc Grid表示用にデータを振り分けるロジック関数\r\n *               引数は１行分のデータオブジェクト（key:value), key, 行番号(0始まり)\r\n * @param {Function} afterFunc １行データ取得後の後処理を行う関数。nullの場合は実施しない。\r\n *               引数は１行分の配列[値1, 値2, ・・・]\r\n */\r\nfunction loadGridByPost(dhxGrid, templateFileName, uri, primaryColName, logicFunc, afterFunc, postPram) {\r\n    // テンプレートファイルの取得\r\n    var template = loadJSON(getTemplatePath(templateFileName));\r\n    try {\r\n        // サーバ通信し、データを取得する。\r\n        var r = window.dhx4.ajax.postSync(_GHAPI.SERVER + uri, postPram);\r\n        var gridData = commonGridDataAsJSObject(template, r, primaryColName, logicFunc, afterFunc);\r\n        //TODO あとで、下記の処理分もCommonの方に寄せる。\r\n        if (gridData.rows.length === 0) {\r\n            console.log(\"データ取得件数が０件でした\");\r\n        }\r\n        dhxGrid.parse(gridData, \"json\");\r\n    } catch(e) {\r\n        console.log(\"データ取得時にエラーが発生！\", e);\r\n        dhtmlx.alert({ title: \"サーバ通信エラー\", type:\"alert-error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n    }\r\n};\r\n\r\n/**\r\n * Gridに読み込ませるためのデータJSONオブジェクトを取得する。\r\n *\r\n * @param {String} templateFileName テンプレートファイル名\r\n * @param {String} uri REST APIにアクセスするためのURI\r\n * @param {String} primaryColName 主キーになるカラム名。それで取得された値はNumberであること。nullの場合は行番号を使う。\r\n * @param {Function} logicFunc Grid表示用にデータを振り分けるロジック関数\r\n *               引数は１行分のデータオブジェクト（key:value), key, 行番号(0始まり)\r\n * @param {Function} afterFunc １行データ取得後の後処理を行う関数。nullの場合は実施しない。\r\n *               引数は１行分の配列[値1, 値2, ・・・]\r\n * @return Grid表示用のJSONオブジェクト\r\n */\r\nfunction getGridDataAsJSObject(templateFileName, uri, primaryColName, logicFunc, afterFunc) {\r\n    // テンプレートファイルの取得\r\n    var template = loadJSON(getTemplatePath(templateFileName));\r\n    try {\r\n        // サーバ通信し、データを取得する。\r\n        var r = window.dhx4.ajax.getSync(_GHAPI.SERVER + uri);\r\n        return commonGridDataAsJSObject(template, r, primaryColName, logicFunc, afterFunc);\r\n    } catch(e) {\r\n        console.log(\"データ取得時にエラーが発生！\", e);\r\n        dhtmlx.alert({ title: \"サーバ通信エラー\", type:\"alert-error\", text:JSON.parse(e[\"message\"])[\"message\"]});\r\n    }\r\n};\r\n\r\n/**\r\n * Gridに読み込ませるためのデータJSONオブジェクトを取得する。\r\n *\r\n * @param {String} templateFileName テンプレートファイル名\r\n * @param {String} uri REST APIにアクセスするためのURI\r\n * @param {String} primaryColName 主キーになるカラム名。それで取得された値はNumberであること。nullの場合は行番号を使う。\r\n * @param {Function} logicFunc Grid表示用にデータを振り分けるロジック関数\r\n *               引数は１行分のデータオブジェクト（key:value), key, 行番号(0始まり)\r\n * @param {Function} afterFunc １行データ取得後の後処理を行う関数。nullの場合は実施しない。\r\n *               引数は１行分の配列[値1, 値2, ・・・]\r\n * @return Grid表示用のJSONオブジェクト\r\n */\r\nfunction commonGridDataAsJSObject(template, r, primaryColName, logicFunc, afterFunc, postPram) {\r\n    var t = null;\r\n    try { t = r.xmlDoc; } catch(e) {};\r\n    if (t != null && t.status.toString() == \"200\") {\r\n        // レスポンスをJSONオブジェクトにする。レスポンスは配列とする。\r\n        var responseData = parseJSON(t.responseText);\r\n\r\n        if(is(\"Array\",responseData)){\r\n            // １件ずつ処理する。\r\n            _.forEach(responseData, function(data, rowIdx) {\r\n                // Grid１行分のデータ構造のテンプレート\r\n                var primaryNo = (is(\"String\", primaryColName))? data[primaryColName]: rowIdx;\r\n                var row = {id: primaryNo, data:[]};\r\n                // テンプレートのHeaderカラムのIDを使って、dataから必要な値を取得する。\r\n                _.forEach(template.head, function(headData, colIdx) {\r\n                    // 振り分けロジックがない場合は、直接値を取得する。\r\n                    if (is(\"Function\", logicFunc)) {\r\n                        row.data.push(logicFunc(data, headData.id, rowIdx));\r\n                    } else {\r\n                        row.data.push(data[headData.id]);\r\n                    }\r\n                });\r\n                if(is(\"Function\", afterFunc)) {\r\n                    template.rows.push(afterFunc(row));\r\n                } else {\r\n                    template.rows.push(row);\r\n                }\r\n            });\r\n        }else{\r\n            // Grid１行分のデータ構造のテンプレート\r\n            var primaryNo = (is(\"String\", primaryColName))? responseData[primaryColName]: 0;\r\n            var row = {id: primaryNo, data:[]};\r\n            // テンプレートのHeaderカラムのIDを使って、dataから必要な値を取得する。\r\n            _.forEach(template.head, function(headData, colIdx) {\r\n                // 振り分けロジックがない場合は、直接値を取得する。\r\n                if (is(\"Function\", logicFunc)) {\r\n                    row.data.push(logicFunc(responseData, headData.id, 0));\r\n                } else {\r\n                    row.data.push(responseData[headData.id]);\r\n                }\r\n            });\r\n            if(is(\"Function\", afterFunc)) {\r\n                template.rows.push(afterFunc(row));\r\n            } else {\r\n                template.rows.push(row);\r\n            }\r\n        }\r\n        console.log(\"Gridに表示するデータ\", template);\r\n        return template;\r\n    } else {\r\n        // error\r\n        console.log(\"ohgHire.data.getGridDataJsonObjectで200以外のレスポンスが返る\", \"status:\" + t.status, t.statusText);\r\n        dhtmlx.alert({ title: \"サーバデータ取得エラー\", type:\"alert-error\", text:\"データ取得に失敗しました。しばらく時間を置いて再度試してください。<br>\"\r\n            + \"status:\" + t.status + \"[\" + t.statusText + \"]\" });\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * GETメソッドでJSONオブジェクトを取得する。\r\n * TODO エラーハンドリング未実装\r\n *\r\n * @param uri {String} URI文字列\r\n * @returns JSON オブジェクト\r\n */\r\nfunction getJSONSync(uri) {\r\n    var r = window.dhx4.ajax.getSync(_GHAPI.SERVER + uri);\r\n    console.log(\"getJSONSync JSON\", r.xmlDoc);\r\n    return window.dhx4.s2j(r.xmlDoc.responseText);\r\n}\r\n\r\n/**\r\n * テンプレートフォルダ内にある内容を文字列として取得する。\r\n * @param {Object} dataPath _GH.DATA_PATHに設定されているオブジェクト\r\n * @returns {String} ファイル内容の文字列\r\n */\r\nfunction getTemplateText(dataPath) {\r\n    try {\r\n        var t = null;\r\n        try {t = window.dhx4.ajax.getSync(getTemplatePath(dataPath)).xmlDoc} catch(e) {};\r\n        if (t !== null && t.status.toString() === \"200\") {\r\n            return t.responseText;\r\n        } else {\r\n            return \"\";\r\n        }\r\n    } catch(e) {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * 担当者にメッセージを送る。\r\n */\r\nfunction sendMessageToEmployee(employeeIds, subject, body) {\r\n    var param = {};\r\n    // 不正な値を取り除く\r\n    _.remove(employeeIds, function(n) { return !(n > 0); });\r\n    _.forEach(employeeIds, function(value, index) {\r\n        if (!_.isNumber(value)) {\r\n            employeeIds[index] = _.parseInt(value);\r\n        }\r\n      });\r\n    // 重複を取り除く\r\n    employeeIds = _.uniq(employeeIds);\r\n    if (employeeIds.length === 0) {\r\n        alert(\"送信対象社員がいないため、メール送信することができませんでした。\");\r\n        return;\r\n    }\r\n    param[\"toEmployeeIdList\"] = employeeIds;\r\n    param[\"subject\"] = subject;\r\n    param[\"body\"] = body.split(\"\\n\").join(\"<BR>\");\r\n    syncPutJSON(\"sendmail/empMessage\", param);\r\n}\r\n\r\n/**\r\n * 対応履歴を直接登録する。\r\n */\r\nfunction registActHitoryByPost(personalId, employeeId, actType, actTypeDetail, actMemo) {\r\n    if (_.isString(personalId)) personalId = _.parseInt(personalId);\r\n    if (!(personalId > 0)) {\r\n        alert(\"顧客が指定されていないため、対応履歴を登録できません。\");\r\n        return;\r\n    }\r\n    if (!(employeeId > 0)) {\r\n        employeeId = _ghUser.getGhId();\r\n    }\r\n    if (!(actType > 0)) {\r\n        alert(\"対応種別が指定されていないため、対応履歴を登録できません。\");\r\n        return;\r\n    }\r\n    var actDate = window.dhx4.date2str(new Date(), \"%Y/%m/%d %H:%i:%s\");\r\n    var param = {\r\n            \"personalId\": personalId,\r\n            \"employeeId\": employeeId,\r\n            \"actType\": actType,\r\n            \"actTypeDetail\": actTypeDetail,\r\n            \"actMemo\": actMemo,\r\n            \"actDateTime\": actDate\r\n    };\r\n    return postSyncURL(\"act/regist\", param);\r\n}"

/***/ }
/******/ ]);
//# sourceMappingURL=schedule.js.map